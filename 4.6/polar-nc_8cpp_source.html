<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFEM: miniapps/meshing/polar-nc.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v4.6.0</span>
   </div>
   <div id="projectbrief">Finite element discretization library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_91a531bd2464e2c6fce2455e0d45f88f.html">miniapps</a></li><li class="navelem"><a class="el" href="dir_bb43f2001ed08bb0604ada2a8b2ee97e.html">meshing</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">polar-nc.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="polar-nc_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2010-2023, Lawrence Livermore National Security, LLC. Produced</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// at the Lawrence Livermore National Laboratory. All Rights reserved. See files</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LICENSE and NOTICE for details. LLNL-CODE-806117.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the MFEM library. For more information and source code</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// availability visit https://mfem.org.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// terms of the BSD-3 license. We welcome feedback and contributions, see file</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// CONTRIBUTING.md for details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//             ----------------------------------------------</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//             Polar NC: Generate polar non-conforming meshes</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//             ----------------------------------------------</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// This miniapp generates a circular sector mesh that consist of quadrilaterals</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// and triangles of similar sizes. The 3D version of the mesh is made of prisms</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// and tetrahedra. The mesh is non-conforming by design, and can optionally be</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// made curvilinear. The elements are ordered along a space-filling curve by</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// default, which makes the mesh ready for parallel non-conforming AMR in MFEM.</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// The implementation also demonstrates how to initialize a non-conforming mesh</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// on the fly by marking hanging nodes with Mesh::AddVertexParents.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// Compile with: make polar-nc</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// Sample runs:  polar-nc --radius 1 --nsteps 10</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//               polar-nc --aspect 2</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//               polar-nc --dim 3 --order 4</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mfem_8hpp.html">mfem.hpp</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacemfem.html">mfem</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">struct </span>Params2</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <span class="keywordtype">double</span> r, dr;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, da;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   Params2() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   Params2(<span class="keywordtype">double</span> r0, <span class="keywordtype">double</span> r1, <span class="keywordtype">double</span> a0, <span class="keywordtype">double</span> a1)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      : r(r0), dr(r1 - r0), <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>(a0), da(a1 - a0) {}</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;};</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#ac978cbbd836083f0adae0a774186d1a5">   49</a></span>&#160;<a class="code" href="classmfem_1_1Mesh.html">Mesh</a>* <a class="code" href="polar-nc_8cpp.html#ac978cbbd836083f0adae0a774186d1a5">Make2D</a>(<span class="keywordtype">int</span> nsteps, <span class="keywordtype">double</span> rstep, <span class="keywordtype">double</span> phi, <span class="keywordtype">double</span> aspect, <span class="keywordtype">int</span> order,</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;             <span class="keywordtype">bool</span> sfc)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>(2, 0, 0);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <span class="keywordtype">int</span> origin = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0.0, 0.0);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="comment">// n is the number of steps in the polar direction</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordtype">int</span> n = 1;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <span class="keywordflow">while</span> (phi * rstep/2 / n * aspect &gt; rstep) { n++; }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordtype">double</span> r = rstep;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="keywordtype">int</span> first = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r, 0.0);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Params2&gt;</a> params;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Pair&lt;int, int&gt;</a>&gt; blocks;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="comment">// create triangles around the origin</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordtype">double</span> prev_alpha = 0.0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordtype">double</span> <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a> = phi * (i+1) / n;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r*cos(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>), r*sin(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a4755087b6a10d3dd3a05d05390d3562e">AddTriangle</a>(origin, first+i, first+i+1);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      params.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(Params2(0, r, prev_alpha, <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      prev_alpha = <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(origin, first, 1);</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(first+n, origin, 2);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; nsteps; k++)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="comment">// m is the number of polar steps of the previous row</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordtype">int</span> m = n;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <span class="keywordtype">int</span> prev_first = first;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordtype">double</span> prev_r = r;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      r += rstep;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordflow">if</span> (phi * (r + prev_r)/2 / n * aspect &lt; rstep * sqrt(2))</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;         <span class="keywordflow">if</span> (k == 1) { blocks.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1Pair.html">Pair&lt;int, int&gt;</a>(mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(), n)); }</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;         first = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r, 0.0);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;         mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(prev_first, first, 1);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;         <span class="comment">// create a row of quads, same number as in previous row</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;         prev_alpha = 0.0;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;         {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a> = phi * (i+1) / n;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r*cos(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>), r*sin(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a2b5fa142fea0b8b987b62093217c2ff1">AddQuad</a>(prev_first+i, first+i, first+i+1, prev_first+i+1);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            params.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(Params2(prev_r, r, prev_alpha, <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            prev_alpha = <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;         }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(first+n, prev_first+n, 2);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// we need to double the number of elements per row</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;         n *= 2;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;         blocks.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1Pair.html">Pair&lt;int, int&gt;</a>(mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(), n));</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;         <span class="comment">// first create hanging vertices</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;         <span class="keywordtype">int</span> hang = 0; <span class="comment">// init to suppress gcc warning</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; i++)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;         {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a> = phi * (2*i+1) / n;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(prev_r*cos(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>), prev_r*sin(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a83cdaa00a258633c9d09419d3a627970">AddVertexParents</a>(<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>, prev_first+i, prev_first+i+1);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (!i) { hang = <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>; }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;         first = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r, 0.0);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a> = prev_first, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = first;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;         mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, 1);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;         <span class="comment">// create a row of quad pairs</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;         prev_alpha = 0.0;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; i++)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;         {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordtype">int</span> c = hang+i, e = <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>+1;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordtype">double</span> alpha_half = phi * (2*i+1) / n;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordtype">int</span> d = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r*cos(alpha_half), r*sin(alpha_half));</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a> = phi * (2*i+2) / n;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">f</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r*cos(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>), r*sin(<a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a2b5fa142fea0b8b987b62093217c2ff1">AddQuad</a>(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, d, c);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a2b5fa142fea0b8b987b62093217c2ff1">AddQuad</a>(c, d, <a class="code" href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">f</a>, e);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a> = e, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = <a class="code" href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">f</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            params.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(Params2(prev_r, r, prev_alpha, alpha_half));</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            params.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(Params2(prev_r, r, alpha_half, <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>));</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            prev_alpha = <a class="code" href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;         }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;         mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, 2);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">AddBdrSegment</a>(first+i, first+i+1, 3);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <span class="comment">// reorder blocks of elements with Grid SFC ordering</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <span class="keywordflow">if</span> (sfc)</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      blocks.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1Pair.html">Pair&lt;int, int&gt;</a>(mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(), 0));</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Params2&gt;</a> new_params(params.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ordering(mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>());</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; blocks[0].one; i++)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         ordering[i] = i;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         new_params[i] = params[i];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> coords;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; blocks.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()-1; i++)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         <span class="keywordtype">int</span> beg = blocks[i].one;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;         <span class="keywordtype">int</span> width = blocks[i].two;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;         <span class="keywordtype">int</span> height = (blocks[i+1].one - blocks[i].one) / width;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#afab9002751a6ab7d1ffa29039ad816ef">NCMesh::GridSfcOrdering2D</a>(width, height, coords);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0, k = 0; j &lt; coords.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); k++, j += 2)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;         {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordtype">int</span> sfc_index = ((i &amp; 1) ? coords[j] : (width-1 - coords[j]))</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            + coords[j+1]*width;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordtype">int</span> old_index = beg + sfc_index;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            ordering[old_index] = beg + k;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            new_params[beg + k] = params[old_index];</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;         }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6c20ae2bb169beb667dd3321f5c5bce8">ReorderElements</a>(ordering, <span class="keyword">false</span>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(params, new_params);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;   mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a16203f41725fb27026e466332362934d">FinalizeMesh</a>();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;   <span class="comment">// create high-order curvature</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   <span class="keywordflow">if</span> (order &gt; 1)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   {</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ae4113e6e1838d76dd3e85f3399adc7da">SetCurvature</a>(order);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="classmfem_1_1GridFunction.html">GridFunction</a> *nodes = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>();</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a> *fes = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>();</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> dofs;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      MFEM_ASSERT(params.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() == mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(), <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;         <span class="keyword">const</span> Params2 &amp;par = params[i];</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1IntegrationRule.html">IntegrationRule</a> &amp;ir = fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6e60ce794202c56cc58d1141deec6905">GetFE</a>(i)-&gt;<a class="code" href="classmfem_1_1FiniteElement.html#a4e98d9b922030b9ef7379855daa81346">GetNodes</a>();</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;         <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aed059a8a2f3fd0481f57a08aecf30059">GetElementBaseGeometry</a>(i);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a2208dc70cb6e6e630f6470f7338a404f">GetElementDofs</a>(i, dofs);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;               r = par.r + ir[j].x * par.dr;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;               <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a> = par.a + ir[j].y * par.da;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               <span class="keywordtype">double</span> rr = ir[j].x + ir[j].y;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;               <span class="keywordflow">if</span> (std::abs(rr) &lt; 1e-12) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;               r = par.r + rr * par.dr;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;               <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a> = par.a + ir[j].y/rr * par.da;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            (*nodes)(fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#af65bf5ab1ec28e808b34113edd28f3cd">DofToVDof</a>(dofs[j], 0)) = r*cos(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            (*nodes)(fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#af65bf5ab1ec28e808b34113edd28f3cd">DofToVDof</a>(dofs[j], 1)) = r*sin(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;         }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      nodes-&gt;<a class="code" href="classmfem_1_1GridFunction.html#ad36c2bed034cf249dd1160a86f588ce2">RestrictConforming</a>();</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="keywordflow">return</span> mesh;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#a2c0cc2347cdb41873a6b0dbc108b15d3">  249</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="polar-nc_8cpp.html#a2c0cc2347cdb41873a6b0dbc108b15d3">pi2</a> = M_PI / 2;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">struct </span>Params3</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordtype">double</span> r, dr;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="keywordtype">double</span> u1, u2, u3;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   <span class="keywordtype">double</span> v1, v2, v3;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   Params3() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   Params3(<span class="keywordtype">double</span> r0, <span class="keywordtype">double</span> r1,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;           <span class="keywordtype">double</span> u1, <span class="keywordtype">double</span> v1, <span class="keywordtype">double</span> u2, <span class="keywordtype">double</span> v2, <span class="keywordtype">double</span> u3, <span class="keywordtype">double</span> v3)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      : r(r0), dr(r1 - r0), u1(u1), u2(u2), u3(u3), v1(v1), v2(v2), v3(v3) {}</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;};</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">struct </span>Vert : <span class="keyword">public</span> <a class="code" href="structmfem_1_1Hashed2.html">Hashed2</a></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;{</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;   <span class="keywordtype">int</span> id;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;};</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">  268</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(<span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2, <span class="keywordtype">double</span> r, <span class="keywordtype">double</span> <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a>, <span class="keywordtype">double</span> v, <span class="keywordtype">bool</span> hanging,</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                 <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh, <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Vert&gt;</a> &amp;hash)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;{</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;   <span class="keywordtype">int</span> vmid = hash.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v1, v2);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <span class="keywordflow">if</span> (vmid &lt; 0)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      vmid = hash.<a class="code" href="classmfem_1_1HashTable.html#a6e94e3678fe908300fc5c8873d3f0bc5">GetId</a>(v1, v2);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordtype">double</span> w = 1.0 - <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> - v;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordtype">double</span> q = r / sqrt(<a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a>*<a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> + v*v + w*w);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(<a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a>*q, v*q, w*q);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span> (hanging) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a83cdaa00a258633c9d09419d3a627970">AddVertexParents</a>(<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>, v1, v2); }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      hash[vmid].id = <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;   }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <span class="keywordflow">return</span> hash[vmid].id;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;}</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">  287</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a>(<span class="keywordtype">int</span> vx1, <span class="keywordtype">int</span> vy1, <span class="keywordtype">int</span> vz1, <span class="keywordtype">int</span> vx2, <span class="keywordtype">int</span> vy2, <span class="keywordtype">int</span> vz2, <span class="keywordtype">int</span> level,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;               <span class="keywordtype">double</span> r1, <span class="keywordtype">double</span> r2, <span class="keywordtype">double</span> u1, <span class="keywordtype">double</span> v1, <span class="keywordtype">double</span> u2, <span class="keywordtype">double</span> v2,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;               <span class="keywordtype">double</span> u3, <span class="keywordtype">double</span> v3, <span class="keywordtype">bool</span> bnd1, <span class="keywordtype">bool</span> bnd2, <span class="keywordtype">bool</span> bnd3, <span class="keywordtype">bool</span> bnd4,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh, <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Vert&gt;</a> &amp;hash, <a class="code" href="classmfem_1_1Array.html">Array&lt;Params3&gt;</a> &amp;params)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;{</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="keywordflow">if</span> (!level)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a312f687de40dca4c6dc9159be8dea1e3">AddWedge</a>(vx1, vy1, vz1, vx2, vy2, vz2);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">if</span> (bnd1) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a1dc124a3649da13fba481c724d8d7032">AddBdrQuad</a>(vx1, vy1, vy2, vx2, 1); }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="keywordflow">if</span> (bnd2) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a1dc124a3649da13fba481c724d8d7032">AddBdrQuad</a>(vy1, vz1, vz2, vy2, 2); }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (bnd3) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a1dc124a3649da13fba481c724d8d7032">AddBdrQuad</a>(vz1, vx1, vx2, vz2, 3); }</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">if</span> (bnd4) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa2abf2f67b36ea9c7812d439cde7808e">AddBdrTriangle</a>(vx2, vy2, vz2, 4); }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      params.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(Params3(r1, r2, u1, v1, u2, v2, u3, v3));</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   }</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;   {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordtype">double</span> u12 = (u1+u2)/2, v12 = (v1+v2)/2;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordtype">double</span> u23 = (u2+u3)/2, v23 = (v2+v3)/2;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="keywordtype">double</span> u31 = (u3+u1)/2, v31 = (v3+v1)/2;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordtype">bool</span> hang = (level == 1);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordtype">int</span> vxy1 = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vx1, vy1, r1, u12, v12, hang, mesh, hash);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordtype">int</span> vyz1 = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vy1, vz1, r1, u23, v23, hang, mesh, hash);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordtype">int</span> vxz1 = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vx1, vz1, r1, u31, v31, hang, mesh, hash);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordtype">int</span> vxy2 = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vx2, vy2, r2, u12, v12, <span class="keyword">false</span>, mesh, hash);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordtype">int</span> vyz2 = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vy2, vz2, r2, u23, v23, <span class="keyword">false</span>, mesh, hash);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordtype">int</span> vxz2 = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vx2, vz2, r2, u31, v31, <span class="keyword">false</span>, mesh, hash);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a>(vx1, vxy1, vxz1, vx2, vxy2, vxz2, level-1,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                r1, r2, u1, v1, u12, v12, u31, v31,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                bnd1, <span class="keyword">false</span>, bnd3, bnd4, mesh, hash, params);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a>(vxy1, vy1, vyz1, vxy2, vy2, vyz2, level-1,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                r1, r2, u12, v12, u2, v2, u23, v23,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                bnd1, bnd2, <span class="keyword">false</span>, bnd4, mesh, hash, params);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a>(vxz1, vyz1, vz1, vxz2, vyz2, vz2, level-1,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                r1, r2, u31, v31, u23, v23, u3, v3,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                <span class="keyword">false</span>, bnd2, bnd3, bnd4, mesh, hash, params);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a>(vyz1, vxz1, vxy1, vyz2, vxz2, vxy2, level-1,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                r1, r2, u23, v23, u31, v31, u12, v12,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, bnd4, mesh, hash, params);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;   }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">  333</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a>(<span class="keywordtype">int</span> origin, <span class="keywordtype">int</span> vx, <span class="keywordtype">int</span> vy, <span class="keywordtype">int</span> vz, <span class="keywordtype">int</span> level, <span class="keywordtype">double</span> r,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="keywordtype">double</span> u1, <span class="keywordtype">double</span> v1, <span class="keywordtype">double</span> u2, <span class="keywordtype">double</span> v2, <span class="keywordtype">double</span> u3, <span class="keywordtype">double</span> v3,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="keywordtype">bool</span> bnd1, <span class="keywordtype">bool</span> bnd2, <span class="keywordtype">bool</span> bnd3, <span class="keywordtype">bool</span> bnd4,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh, <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Vert&gt;</a> &amp;hash, <a class="code" href="classmfem_1_1Array.html">Array&lt;Params3&gt;</a> &amp;params)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keywordflow">if</span> (!level)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6675ff9b61ab5482719380789f1c3aa6">AddTet</a>(origin, vx, vy, vz);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="keywordflow">if</span> (bnd1) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa2abf2f67b36ea9c7812d439cde7808e">AddBdrTriangle</a>(0, vy, vx, 1); }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">if</span> (bnd2) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa2abf2f67b36ea9c7812d439cde7808e">AddBdrTriangle</a>(0, vz, vy, 2); }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">if</span> (bnd3) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa2abf2f67b36ea9c7812d439cde7808e">AddBdrTriangle</a>(0, vx, vz, 3); }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">if</span> (bnd4) { mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa2abf2f67b36ea9c7812d439cde7808e">AddBdrTriangle</a>(vx, vy, vz, 4); }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      params.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(Params3(0, r, u1, v1, u2, v2, u3, v3));</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;   }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keywordtype">double</span> u12 = (u1+u2)/2, v12 = (v1+v2)/2;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordtype">double</span> u23 = (u2+u3)/2, v23 = (v2+v3)/2;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordtype">double</span> u31 = (u3+u1)/2, v31 = (v3+v1)/2;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordtype">int</span> vxy = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vx, vy, r, u12, v12, <span class="keyword">false</span>, mesh, hash);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordtype">int</span> vyz = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vy, vz, r, u23, v23, <span class="keyword">false</span>, mesh, hash);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordtype">int</span> vxz = <a class="code" href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a>(vx, vz, r, u31, v31, <span class="keyword">false</span>, mesh, hash);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a>(origin, vx, vxy, vxz, level-1, r, u1, v1, u12, v12, u31, v31,</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                 bnd1, <span class="keyword">false</span>, bnd3, bnd4, mesh, hash, params);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a>(origin, vxy, vy, vyz, level-1, r, u12, v12, u2, v2, u23, v23,</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                 bnd1, bnd2, <span class="keyword">false</span>, bnd4, mesh, hash, params);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a>(origin, vxz, vyz, vz, level-1, r, u31, v31, u23, v23, u3, v3,</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                 <span class="keyword">false</span>, bnd2, bnd3, bnd4, mesh, hash, params);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a>(origin, vyz, vxz, vxy, level-1, r, u23, v23, u31, v31, u12, v12,</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                 <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, bnd4, mesh, hash, params);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#a22e696b0041c55d08b3bed85ddc56f7d">  370</a></span>&#160;<a class="code" href="classmfem_1_1Mesh.html">Mesh</a>* <a class="code" href="polar-nc_8cpp.html#a22e696b0041c55d08b3bed85ddc56f7d">Make3D</a>(<span class="keywordtype">int</span> nsteps, <span class="keywordtype">double</span> rstep, <span class="keywordtype">double</span> aspect, <span class="keywordtype">int</span> order, <span class="keywordtype">bool</span> sfc)</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>(3, 0, 0);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Vert&gt;</a> hash;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Params3&gt;</a> params;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;   <span class="keywordtype">int</span> origin = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0, 0, 0);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="keywordtype">double</span> r = rstep;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r, 0, 0);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0, r, 0);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordtype">int</span> c = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0, 0, r);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;   <span class="keywordtype">int</span> levels = 0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="keywordflow">while</span> (<a class="code" href="polar-nc_8cpp.html#a2c0cc2347cdb41873a6b0dbc108b15d3">pi2</a> * rstep / (1 &lt;&lt; levels) * aspect &gt; rstep) { levels++; }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <a class="code" href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a>(origin, <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, c, levels, r, 1, 0, 0, 1, 0, 0,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;              <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, (nsteps == 1), mesh, hash, params);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; nsteps; k++)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordtype">double</span> prev_r = r;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      r += rstep;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">if</span> ((prev_r + rstep/2) * <a class="code" href="polar-nc_8cpp.html#a2c0cc2347cdb41873a6b0dbc108b15d3">pi2</a> * aspect / (1 &lt;&lt; levels) &gt; rstep * sqrt(2))</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      {</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         levels++;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordtype">int</span> d = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(r, 0, 0);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="keywordtype">int</span> e = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0, r, 0);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">f</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0, 0, r);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a>(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, c, d, e, <a class="code" href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">f</a>, levels, prev_r, r,</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                1, 0, 0, 1, 0, 0, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, (k == nsteps-1),</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                mesh, hash, params);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a> = d;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = e;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      c = <a class="code" href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">f</a>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="comment">// reorder mesh with Hilbert spatial sort</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="keywordflow">if</span> (sfc)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ordering;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa55f419dcf535780b56285ac17b2c39f">GetHilbertElementOrdering</a>(ordering);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6c20ae2bb169beb667dd3321f5c5bce8">ReorderElements</a>(ordering, <span class="keyword">false</span>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Params3&gt;</a> new_params(params.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ordering.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      {</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;         new_params[ordering[i]] = params[i];</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      }</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(params, new_params);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   }</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a16203f41725fb27026e466332362934d">FinalizeMesh</a>();</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="comment">// create high-order curvature</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">if</span> (order &gt; 1)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ae4113e6e1838d76dd3e85f3399adc7da">SetCurvature</a>(order);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <a class="code" href="classmfem_1_1GridFunction.html">GridFunction</a> *nodes = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>();</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a> *fes = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>();</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> dofs;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      MFEM_ASSERT(params.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() == mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(), <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <span class="keyword">const</span> Params3 &amp;par = params[i];</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1IntegrationRule.html">IntegrationRule</a> &amp;ir = fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6e60ce794202c56cc58d1141deec6905">GetFE</a>(i)-&gt;<a class="code" href="classmfem_1_1FiniteElement.html#a4e98d9b922030b9ef7379855daa81346">GetNodes</a>();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aed059a8a2f3fd0481f57a08aecf30059">GetElementBaseGeometry</a>(i);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a2208dc70cb6e6e630f6470f7338a404f">GetElementDofs</a>(i, dofs);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keyword">const</span> <a class="code" href="classmfem_1_1IntegrationPoint.html">IntegrationPoint</a> &amp;ip = ir[j];</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a>, v, w;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            {</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;               <span class="keywordtype">double</span> l1 = 1.0 - ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a502c0832792bfe2a7b4ac340129f0589">x</a> - ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a1a6f11381e3ad49c5874784d143905ad">y</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;               <span class="keywordtype">double</span> l2 = ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a502c0832792bfe2a7b4ac340129f0589">x</a>, l3 = ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a1a6f11381e3ad49c5874784d143905ad">y</a>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;               <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> = l1 * par.u1 + l2 * par.u2 + l3 * par.u3;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;               v = l1 * par.v1 + l2 * par.v2 + l3 * par.v3;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;               w = 1.0 - <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> - v;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;               r = par.r + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a095f9e965e02969856a04c6957ba6a66">z</a> * par.dr;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;               <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> = ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a502c0832792bfe2a7b4ac340129f0589">x</a> * par.u1 + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a1a6f11381e3ad49c5874784d143905ad">y</a> * par.u2 + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a095f9e965e02969856a04c6957ba6a66">z</a> * par.u3;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               v = ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a502c0832792bfe2a7b4ac340129f0589">x</a> * par.v1 + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a1a6f11381e3ad49c5874784d143905ad">y</a> * par.v2 + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a095f9e965e02969856a04c6957ba6a66">z</a> * par.v3;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;               <span class="keywordtype">double</span> rr = ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a502c0832792bfe2a7b4ac340129f0589">x</a> + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a1a6f11381e3ad49c5874784d143905ad">y</a> + ip.<a class="code" href="classmfem_1_1IntegrationPoint.html#a095f9e965e02969856a04c6957ba6a66">z</a>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;               <span class="keywordflow">if</span> (std::abs(rr) &lt; 1e-12) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;               w = rr - <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> - v;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;               r = par.r + rr * par.dr;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordtype">double</span> q = r / sqrt(<a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a>*<a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a> + v*v + w*w);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            (*nodes)(fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#af65bf5ab1ec28e808b34113edd28f3cd">DofToVDof</a>(dofs[j], 0)) = <a class="code" href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">u</a>*q;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            (*nodes)(fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#af65bf5ab1ec28e808b34113edd28f3cd">DofToVDof</a>(dofs[j], 1)) = v*q;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            (*nodes)(fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#af65bf5ab1ec28e808b34113edd28f3cd">DofToVDof</a>(dofs[j], 2)) = w*q;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;         }</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      }</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      nodes-&gt;<a class="code" href="classmfem_1_1GridFunction.html#ad36c2bed034cf249dd1160a86f588ce2">RestrictConforming</a>();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   }</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   <span class="keywordflow">return</span> mesh;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="polar-nc_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">  486</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="polar-nc_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordtype">int</span> <a class="code" href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a> = 2;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="keywordtype">double</span> <a class="code" href="distance_8cpp.html#a13553aadcae53676a3eef1d83c046c61">radius</a> = 1.0;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordtype">int</span> nsteps = 10;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <span class="keywordtype">double</span> angle = 90;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="keywordtype">double</span> aspect = 1.0;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keywordtype">int</span> order = 2;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keywordtype">bool</span> sfc = <span class="keyword">true</span>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keywordtype">bool</span> visualization = <span class="keyword">true</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="comment">// parse command line</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   <a class="code" href="classmfem_1_1OptionsParser.html">OptionsParser</a> args(argc, argv);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;<a class="code" href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>, <span class="stringliteral">&quot;-d&quot;</span>, <span class="stringliteral">&quot;--dim&quot;</span>, <span class="stringliteral">&quot;Mesh dimension (2 or 3).&quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;<a class="code" href="distance_8cpp.html#a13553aadcae53676a3eef1d83c046c61">radius</a>, <span class="stringliteral">&quot;-r&quot;</span>, <span class="stringliteral">&quot;--radius&quot;</span>, <span class="stringliteral">&quot;Radius of the domain.&quot;</span>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;nsteps, <span class="stringliteral">&quot;-n&quot;</span>, <span class="stringliteral">&quot;--nsteps&quot;</span>,</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                  <span class="stringliteral">&quot;Number of elements along the radial direction&quot;</span>);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;aspect, <span class="stringliteral">&quot;-a&quot;</span>, <span class="stringliteral">&quot;--aspect&quot;</span>,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                  <span class="stringliteral">&quot;Target aspect ratio of the elements.&quot;</span>);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;angle, <span class="stringliteral">&quot;-phi&quot;</span>, <span class="stringliteral">&quot;--phi&quot;</span>, <span class="stringliteral">&quot;Angular range (2D only).&quot;</span>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;order, <span class="stringliteral">&quot;-o&quot;</span>, <span class="stringliteral">&quot;--order&quot;</span>,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                  <span class="stringliteral">&quot;Polynomial degree of mesh curvature.&quot;</span>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;sfc, <span class="stringliteral">&quot;-sfc&quot;</span>, <span class="stringliteral">&quot;--sfc&quot;</span>, <span class="stringliteral">&quot;-no-sfc&quot;</span>, <span class="stringliteral">&quot;--no-sfc&quot;</span>,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                  <span class="stringliteral">&quot;Try to order elements along a space-filling curve.&quot;</span>);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">AddOption</a>(&amp;visualization, <span class="stringliteral">&quot;-vis&quot;</span>, <span class="stringliteral">&quot;--visualization&quot;</span>, <span class="stringliteral">&quot;-no-vis&quot;</span>,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                  <span class="stringliteral">&quot;--no-visualization&quot;</span>,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                  <span class="stringliteral">&quot;Enable or disable GLVis visualization.&quot;</span>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a40c1d9865e6d5f27331951c94ca34b9c">Parse</a>();</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;   <span class="keywordflow">if</span> (!args.<a class="code" href="classmfem_1_1OptionsParser.html#ab568767f32536deedad0fd2608f1343b">Good</a>())</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      args.<a class="code" href="classmfem_1_1OptionsParser.html#a61a6050096a67ab9c738720bfc808d7f">PrintUsage</a>(cout);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   args.<a class="code" href="classmfem_1_1OptionsParser.html#a6472ddf18c64587578e66c232e5db415">PrintOptions</a>(cout);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   <span class="comment">// validate options</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   MFEM_VERIFY(<a class="code" href="distance_8cpp.html#a13553aadcae53676a3eef1d83c046c61">radius</a> &gt; 0, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   MFEM_VERIFY(aspect &gt; 0, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   MFEM_VERIFY(<a class="code" href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a> &gt;= 2 &amp;&amp; <a class="code" href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a> &lt;= 3, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   MFEM_VERIFY(angle &gt; 0 &amp;&amp; angle &lt; 360, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   MFEM_VERIFY(nsteps &gt; 0, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <span class="keywordtype">double</span> phi = angle * M_PI / 180;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   <span class="comment">// generate</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a> == 2)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      mesh = <a class="code" href="polar-nc_8cpp.html#ac978cbbd836083f0adae0a774186d1a5">Make2D</a>(nsteps, <a class="code" href="distance_8cpp.html#a13553aadcae53676a3eef1d83c046c61">radius</a>/nsteps, phi, aspect, order, sfc);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      mesh = <a class="code" href="polar-nc_8cpp.html#a22e696b0041c55d08b3bed85ddc56f7d">Make3D</a>(nsteps, <a class="code" href="distance_8cpp.html#a13553aadcae53676a3eef1d83c046c61">radius</a>/nsteps, aspect, order, sfc);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   <span class="comment">// save the final mesh</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   ofstream ofs(<span class="stringliteral">&quot;polar-nc.mesh&quot;</span>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   ofs.precision(8);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a77b793b23a4bbda8cb05cd29d696dd8a">Print</a>(ofs);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="comment">// output the mesh to GLVis</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="keywordflow">if</span> (visualization)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="namespacemfem.html#afef3742d0aec289ee78ef2160b382928">vishost</a>[] = <span class="stringliteral">&quot;localhost&quot;</span>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordtype">int</span>  <a class="code" href="namespacemfem.html#a0fe1ce8a300fa97584880ea61ff668b6">visport</a>   = 19916;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="classmfem_1_1socketstream.html">socketstream</a> sol_sock(<a class="code" href="namespacemfem.html#afef3742d0aec289ee78ef2160b382928">vishost</a>, <a class="code" href="namespacemfem.html#a0fe1ce8a300fa97584880ea61ff668b6">visport</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      sol_sock.precision(8);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      sol_sock &lt;&lt; <span class="stringliteral">&quot;mesh\n&quot;</span> &lt;&lt; *mesh &lt;&lt; flush;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="keyword">delete</span> mesh;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div><div class="ttc" id="namespacemfem_html_afef3742d0aec289ee78ef2160b382928"><div class="ttname"><a href="namespacemfem.html#afef3742d0aec289ee78ef2160b382928">mfem::vishost</a></div><div class="ttdeci">const char vishost[]</div><div class="ttdef"><b>Definition:</b> <a href="extrapolator_8cpp_source.html#l00021">extrapolator.cpp:21</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_a22e696b0041c55d08b3bed85ddc56f7d"><div class="ttname"><a href="polar-nc_8cpp.html#a22e696b0041c55d08b3bed85ddc56f7d">Make3D</a></div><div class="ttdeci">Mesh * Make3D(int nsteps, double rstep, double aspect, int order, bool sfc)</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00370">polar-nc.cpp:370</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_afab9002751a6ab7d1ffa29039ad816ef"><div class="ttname"><a href="classmfem_1_1NCMesh.html#afab9002751a6ab7d1ffa29039ad816ef">mfem::NCMesh::GridSfcOrdering2D</a></div><div class="ttdeci">static void GridSfcOrdering2D(int width, int height, Array&lt; int &gt; &amp;coords)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04960">ncmesh.cpp:4960</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html"><div class="ttname"><a href="classmfem_1_1Mesh.html">mfem::Mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00052">mesh.hpp:52</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationRule_html"><div class="ttname"><a href="classmfem_1_1IntegrationRule.html">mfem::IntegrationRule</a></div><div class="ttdoc">Class for an integration rule - an Array of IntegrationPoint. </div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00096">intrules.hpp:96</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a350a9fd44c3070d48dd72b40ce9ab1f7"><div class="ttname"><a href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">mfem::Mesh::GetNodalFESpace</a></div><div class="ttdeci">const FiniteElementSpace * GetNodalFESpace() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05630">mesh.cpp:5630</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html"><div class="ttname"><a href="classmfem_1_1GridFunction.html">mfem::GridFunction</a></div><div class="ttdoc">Class for grid function - Vector with associated FE space. </div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8hpp_source.html#l00030">gridfunc.hpp:30</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2b5fa142fea0b8b987b62093217c2ff1"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2b5fa142fea0b8b987b62093217c2ff1">mfem::Mesh::AddQuad</a></div><div class="ttdeci">int AddQuad(int v1, int v2, int v3, int v4, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01694">mesh.cpp:1694</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_a1743546b66a0a93638e6868a32b9912b"><div class="ttname"><a href="polar-nc_8cpp.html#a1743546b66a0a93638e6868a32b9912b">MakeCenter</a></div><div class="ttdeci">void MakeCenter(int origin, int vx, int vy, int vz, int level, double r, double u1, double v1, double u2, double v2, double u3, double v3, bool bnd1, bool bnd2, bool bnd3, bool bnd4, Mesh *mesh, HashTable&lt; Vert &gt; &amp;hash, Array&lt; Params3 &gt; &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00333">polar-nc.cpp:333</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="polar-nc_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00486">polar-nc.cpp:486</a></div></div>
<div class="ttc" id="classmfem_1_1OptionsParser_html_a6472ddf18c64587578e66c232e5db415"><div class="ttname"><a href="classmfem_1_1OptionsParser.html#a6472ddf18c64587578e66c232e5db415">mfem::OptionsParser::PrintOptions</a></div><div class="ttdeci">void PrintOptions(std::ostream &amp;out) const</div><div class="ttdoc">Print the options. </div><div class="ttdef"><b>Definition:</b> <a href="optparser_8cpp_source.html#l00331">optparser.cpp:331</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aed059a8a2f3fd0481f57a08aecf30059"><div class="ttname"><a href="classmfem_1_1Mesh.html#aed059a8a2f3fd0481f57a08aecf30059">mfem::Mesh::GetElementBaseGeometry</a></div><div class="ttdeci">Geometry::Type GetElementBaseGeometry(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01242">mesh.hpp:1242</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_a1c6ebfc517e06f2aa622f7369a682a0c"><div class="ttname"><a href="polar-nc_8cpp.html#a1c6ebfc517e06f2aa622f7369a682a0c">GetMidVertex</a></div><div class="ttdeci">int GetMidVertex(int v1, int v2, double r, double u, double v, bool hanging, Mesh *mesh, HashTable&lt; Vert &gt; &amp;hash)</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00268">polar-nc.cpp:268</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_ad36c2bed034cf249dd1160a86f588ce2"><div class="ttname"><a href="classmfem_1_1GridFunction.html#ad36c2bed034cf249dd1160a86f588ce2">mfem::GridFunction::RestrictConforming</a></div><div class="ttdeci">void RestrictConforming()</div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8cpp_source.html#l01976">gridfunc.cpp:1976</a></div></div>
<div class="ttc" id="classmfem_1_1OptionsParser_html_a61a6050096a67ab9c738720bfc808d7f"><div class="ttname"><a href="classmfem_1_1OptionsParser.html#a61a6050096a67ab9c738720bfc808d7f">mfem::OptionsParser::PrintUsage</a></div><div class="ttdeci">void PrintUsage(std::ostream &amp;out) const</div><div class="ttdoc">Print the usage message. </div><div class="ttdef"><b>Definition:</b> <a href="optparser_8cpp_source.html#l00462">optparser.cpp:462</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4755087b6a10d3dd3a05d05390d3562e"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4755087b6a10d3dd3a05d05390d3562e">mfem::Mesh::AddTriangle</a></div><div class="ttdeci">int AddTriangle(int v1, int v2, int v3, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01680">mesh.cpp:1680</a></div></div>
<div class="ttc" id="classmfem_1_1OptionsParser_html_ab568767f32536deedad0fd2608f1343b"><div class="ttname"><a href="classmfem_1_1OptionsParser.html#ab568767f32536deedad0fd2608f1343b">mfem::OptionsParser::Good</a></div><div class="ttdeci">bool Good() const</div><div class="ttdoc">Return true if the command line options were parsed successfully. </div><div class="ttdef"><b>Definition:</b> <a href="optparser_8hpp_source.html#l00159">optparser.hpp:159</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a6e60ce794202c56cc58d1141deec6905"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a6e60ce794202c56cc58d1141deec6905">mfem::FiniteElementSpace::GetFE</a></div><div class="ttdeci">virtual const FiniteElement * GetFE(int i) const</div><div class="ttdoc">Returns pointer to the FiniteElement in the FiniteElementCollection associated with i&amp;#39;th element in t...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l02841">fespace.cpp:2841</a></div></div>
<div class="ttc" id="structmfem_1_1Hashed2_html"><div class="ttname"><a href="structmfem_1_1Hashed2.html">mfem::Hashed2</a></div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00027">hash.hpp:27</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_a28223010aac55623d1caa18f39bd38d0"><div class="ttname"><a href="polar-nc_8cpp.html#a28223010aac55623d1caa18f39bd38d0">MakeLayer</a></div><div class="ttdeci">void MakeLayer(int vx1, int vy1, int vz1, int vx2, int vy2, int vz2, int level, double r1, double r2, double u1, double v1, double u2, double v2, double u3, double v3, bool bnd1, bool bnd2, bool bnd3, bool bnd4, Mesh *mesh, HashTable&lt; Vert &gt; &amp;hash, Array&lt; Params3 &gt; &amp;params)</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00287">polar-nc.cpp:287</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationPoint_html_a095f9e965e02969856a04c6957ba6a66"><div class="ttname"><a href="classmfem_1_1IntegrationPoint.html#a095f9e965e02969856a04c6957ba6a66">mfem::IntegrationPoint::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00034">intrules.hpp:34</a></div></div>
<div class="ttc" id="namespacemfem_html_a3e1b72acc79db4f175c9136622dab587"><div class="ttname"><a href="namespacemfem.html#a3e1b72acc79db4f175c9136622dab587">mfem::f</a></div><div class="ttdeci">std::function&lt; double(const Vector &amp;)&gt; f(double mass_coeff)</div><div class="ttdef"><b>Definition:</b> <a href="lor__mms_8hpp_source.html#l00030">lor_mms.hpp:30</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aa2abf2f67b36ea9c7812d439cde7808e"><div class="ttname"><a href="classmfem_1_1Mesh.html#aa2abf2f67b36ea9c7812d439cde7808e">mfem::Mesh::AddBdrTriangle</a></div><div class="ttdeci">int AddBdrTriangle(int v1, int v2, int v3, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01857">mesh.cpp:1857</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_ac978cbbd836083f0adae0a774186d1a5"><div class="ttname"><a href="polar-nc_8cpp.html#ac978cbbd836083f0adae0a774186d1a5">Make2D</a></div><div class="ttdeci">Mesh * Make2D(int nsteps, double rstep, double phi, double aspect, int order, bool sfc)</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00049">polar-nc.cpp:49</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ad9950e1768fac1c8ee0a54f219c4a9ba"><div class="ttname"><a href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">mfem::Mesh::AddVertex</a></div><div class="ttdeci">int AddVertex(double x, double y=0.0, double z=0.0)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01626">mesh.cpp:1626</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">mfem::Geometry::SQUARE</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00038">geom.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1OptionsParser_html_a40c1d9865e6d5f27331951c94ca34b9c"><div class="ttname"><a href="classmfem_1_1OptionsParser.html#a40c1d9865e6d5f27331951c94ca34b9c">mfem::OptionsParser::Parse</a></div><div class="ttdeci">void Parse()</div><div class="ttdoc">Parse the command-line options. Note that this function expects all the options provided through the ...</div><div class="ttdef"><b>Definition:</b> <a href="optparser_8cpp_source.html#l00151">optparser.cpp:151</a></div></div>
<div class="ttc" id="namespacemfem_html"><div class="ttname"><a href="namespacemfem.html">mfem</a></div><div class="ttdef"><b>Definition:</b> <a href="CodeDocumentation_8dox_source.html#l00001">CodeDocumentation.dox:1</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a89b4efb149e79a30a8dd194279154dd6"><div class="ttname"><a href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">mfem::Array::Append</a></div><div class="ttdeci">int Append(const T &amp;el)</div><div class="ttdoc">Append element &amp;#39;el&amp;#39; to array, resize if necessary. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00759">array.hpp:759</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00042">lissajous.cpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6675ff9b61ab5482719380789f1c3aa6"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6675ff9b61ab5482719380789f1c3aa6">mfem::Mesh::AddTet</a></div><div class="ttdeci">int AddTet(int v1, int v2, int v3, int v4, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01708">mesh.cpp:1708</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html"><div class="ttname"><a href="classmfem_1_1Array.html">mfem::Array</a></div><div class="ttdef"><b>Definition:</b> <a href="adios2stream_8hpp_source.html#l00044">adios2stream.hpp:44</a></div></div>
<div class="ttc" id="classmfem_1_1Pair_html"><div class="ttname"><a href="classmfem_1_1Pair.html">mfem::Pair</a></div><div class="ttdoc">A pair of objects. </div><div class="ttdef"><b>Definition:</b> <a href="sort__pairs_8hpp_source.html#l00023">sort_pairs.hpp:23</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ae4113e6e1838d76dd3e85f3399adc7da"><div class="ttname"><a href="classmfem_1_1Mesh.html#ae4113e6e1838d76dd3e85f3399adc7da">mfem::Mesh::SetCurvature</a></div><div class="ttdeci">virtual void SetCurvature(int order, bool discont=false, int space_dim=-1, int ordering=1)</div><div class="ttdoc">Set the curvature of the mesh nodes using the given polynomial degree. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05635">mesh.cpp:5635</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a78ce98b7ed0452cbf4bfde3b8f04a0c7"><div class="ttname"><a href="classmfem_1_1Mesh.html#a78ce98b7ed0452cbf4bfde3b8f04a0c7">mfem::Mesh::AddBdrSegment</a></div><div class="ttdeci">int AddBdrSegment(int v1, int v2, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01843">mesh.cpp:1843</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aa55f419dcf535780b56285ac17b2c39f"><div class="ttname"><a href="classmfem_1_1Mesh.html#aa55f419dcf535780b56285ac17b2c39f">mfem::Mesh::GetHilbertElementOrdering</a></div><div class="ttdeci">void GetHilbertElementOrdering(Array&lt; int &gt; &amp;ordering)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02217">mesh.cpp:2217</a></div></div>
<div class="ttc" id="namespacemfem_html_a0fe1ce8a300fa97584880ea61ff668b6"><div class="ttname"><a href="namespacemfem.html#a0fe1ce8a300fa97584880ea61ff668b6">mfem::visport</a></div><div class="ttdeci">const int visport</div><div class="ttdef"><b>Definition:</b> <a href="extrapolator_8cpp_source.html#l00022">extrapolator.cpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1socketstream_html"><div class="ttname"><a href="classmfem_1_1socketstream.html">mfem::socketstream</a></div><div class="ttdef"><b>Definition:</b> <a href="socketstream_8hpp_source.html#l00210">socketstream.hpp:210</a></div></div>
<div class="ttc" id="classmfem_1_1OptionsParser_html"><div class="ttname"><a href="classmfem_1_1OptionsParser.html">mfem::OptionsParser</a></div><div class="ttdef"><b>Definition:</b> <a href="optparser_8hpp_source.html#l00031">optparser.hpp:31</a></div></div>
<div class="ttc" id="namespacemfem_html_a005eac4b7840fa2691b6e57be1546d14"><div class="ttname"><a href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a></div><div class="ttdeci">void Swap(Array&lt; T &gt; &amp;, Array&lt; T &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00638">array.hpp:638</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a16203f41725fb27026e466332362934d"><div class="ttname"><a href="classmfem_1_1Mesh.html#a16203f41725fb27026e466332362934d">mfem::Mesh::FinalizeMesh</a></div><div class="ttdeci">void FinalizeMesh(int refine=0, bool fix_orientation=true)</div><div class="ttdoc">Finalize the construction of any type of Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02938">mesh.cpp:2938</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationPoint_html_a1a6f11381e3ad49c5874784d143905ad"><div class="ttname"><a href="classmfem_1_1IntegrationPoint.html#a1a6f11381e3ad49c5874784d143905ad">mfem::IntegrationPoint::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00034">intrules.hpp:34</a></div></div>
<div class="ttc" id="mfem_8hpp_html"><div class="ttname"><a href="mfem_8hpp.html">mfem.hpp</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html">mfem::FiniteElementSpace</a></div><div class="ttdoc">Class FiniteElementSpace - responsible for providing FEM view of the mesh, mainly managing the set of...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00219">fespace.hpp:219</a></div></div>
<div class="ttc" id="classmfem_1_1OptionsParser_html_a89d9b7f6e802eee842a4405279ec49f8"><div class="ttname"><a href="classmfem_1_1OptionsParser.html#a89d9b7f6e802eee842a4405279ec49f8">mfem::OptionsParser::AddOption</a></div><div class="ttdeci">void AddOption(bool *var, const char *enable_short_name, const char *enable_long_name, const char *disable_short_name, const char *disable_long_name, const char *description, bool required=false)</div><div class="ttdoc">Add a boolean option and set &amp;#39;var&amp;#39; to receive the value. Enable/disable tags are used to set the bool...</div><div class="ttdef"><b>Definition:</b> <a href="optparser_8hpp_source.html#l00082">optparser.hpp:82</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1dc124a3649da13fba481c724d8d7032"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1dc124a3649da13fba481c724d8d7032">mfem::Mesh::AddBdrQuad</a></div><div class="ttdeci">int AddBdrQuad(int v1, int v2, int v3, int v4, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01871">mesh.cpp:1871</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a2208dc70cb6e6e630f6470f7338a404f"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a2208dc70cb6e6e630f6470f7338a404f">mfem::FiniteElementSpace::GetElementDofs</a></div><div class="ttdeci">virtual DofTransformation * GetElementDofs(int elem, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdoc">Returns indices of degrees of freedom of element &amp;#39;elem&amp;#39;. The returned indices are offsets into an ldo...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l02731">fespace.cpp:2731</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a641d7dd01d6982be04d7c8410e2eafe8"><div class="ttname"><a href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">mfem::Mesh::GetNE</a></div><div class="ttdeci">int GetNE() const</div><div class="ttdoc">Returns number of elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01086">mesh.hpp:1086</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1031d0e0a97a340abfe0a6ab9e831045"><div class="ttname"><a href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a></div><div class="ttdeci">double a</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00041">lissajous.cpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationPoint_html"><div class="ttname"><a href="classmfem_1_1IntegrationPoint.html">mfem::IntegrationPoint</a></div><div class="ttdoc">Class for integration point with weight. </div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00031">intrules.hpp:31</a></div></div>
<div class="ttc" id="distance_8cpp_html_a13553aadcae53676a3eef1d83c046c61"><div class="ttname"><a href="distance_8cpp.html#a13553aadcae53676a3eef1d83c046c61">radius</a></div><div class="ttdeci">const double radius</div><div class="ttdef"><b>Definition:</b> <a href="distance_8cpp_source.html#l00107">distance.cpp:107</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_html_aaf649a33105192742e99dce91d139f25"><div class="ttname"><a href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">mfem::HashTable::FindId</a></div><div class="ttdeci">int FindId(int p1, int p2) const</div><div class="ttdoc">Find id of item whose parents are p1, p2... Return -1 if it doesn&amp;#39;t exist. </div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00700">hash.hpp:700</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6c20ae2bb169beb667dd3321f5c5bce8"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6c20ae2bb169beb667dd3321f5c5bce8">mfem::Mesh::ReorderElements</a></div><div class="ttdeci">void ReorderElements(const Array&lt; int &gt; &amp;ordering, bool reorder_vertices=true)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02269">mesh.cpp:2269</a></div></div>
<div class="ttc" id="ex24_8cpp_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="ex24_8cpp_source.html#l00053">ex24.cpp:53</a></div></div>
<div class="ttc" id="life_8cpp_html_a3b0ebfb1ea55d7ef281731142fe7e93d"><div class="ttname"><a href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a></div><div class="ttdeci">int index(int i, int j, int nx, int ny)</div><div class="ttdef"><b>Definition:</b> <a href="life_8cpp_source.html#l00235">life.cpp:235</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a5efef8b3cd9f7f35f89bb8330e76d120"><div class="ttname"><a href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">mfem::Array::Size</a></div><div class="ttdeci">int Size() const</div><div class="ttdoc">Return the logical size of the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00141">array.hpp:141</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a312f687de40dca4c6dc9159be8dea1e3"><div class="ttname"><a href="classmfem_1_1Mesh.html#a312f687de40dca4c6dc9159be8dea1e3">mfem::Mesh::AddWedge</a></div><div class="ttdeci">int AddWedge(int v1, int v2, int v3, int v4, int v5, int v6, int attr=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01729">mesh.cpp:1729</a></div></div>
<div class="ttc" id="polar-nc_8cpp_html_a2c0cc2347cdb41873a6b0dbc108b15d3"><div class="ttname"><a href="polar-nc_8cpp.html#a2c0cc2347cdb41873a6b0dbc108b15d3">pi2</a></div><div class="ttdeci">const double pi2</div><div class="ttdef"><b>Definition:</b> <a href="polar-nc_8cpp_source.html#l00249">polar-nc.cpp:249</a></div></div>
<div class="ttc" id="ex15_8cpp_html_adeedc97114c5a704906c8e26bdbd2451"><div class="ttname"><a href="ex15_8cpp.html#adeedc97114c5a704906c8e26bdbd2451">alpha</a></div><div class="ttdeci">const double alpha</div><div class="ttdef"><b>Definition:</b> <a href="ex15_8cpp_source.html#l00369">ex15.cpp:369</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_af65bf5ab1ec28e808b34113edd28f3cd"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#af65bf5ab1ec28e808b34113edd28f3cd">mfem::FiniteElementSpace::DofToVDof</a></div><div class="ttdeci">int DofToVDof(int dof, int vd, int ndofs=-1) const</div><div class="ttdoc">Compute a single vdof corresponding to the index dof and the vector index vd. </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l00251">fespace.cpp:251</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a77b793b23a4bbda8cb05cd29d696dd8a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a77b793b23a4bbda8cb05cd29d696dd8a">mfem::Mesh::Print</a></div><div class="ttdeci">virtual void Print(std::ostream &amp;os=mfem::out) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l02011">mesh.hpp:2011</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">mfem::Geometry::PRISM</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00038">geom.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_html_a6e94e3678fe908300fc5c8873d3f0bc5"><div class="ttname"><a href="classmfem_1_1HashTable.html#a6e94e3678fe908300fc5c8873d3f0bc5">mfem::HashTable::GetId</a></div><div class="ttdeci">int GetId(int p1, int p2)</div><div class="ttdoc">Get id of item whose parents are p1, p2... Create it if it doesn&amp;#39;t exist. </div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00609">hash.hpp:609</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a9a0fa5f0dbca754e36437b13ae6b158f"><div class="ttname"><a href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">mfem::Mesh::GetNodes</a></div><div class="ttdeci">void GetNodes(Vector &amp;node_coord) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l08302">mesh.cpp:8302</a></div></div>
<div class="ttc" id="namespacemfem_html_a602b817d5a403240b59b6eb51d349406"><div class="ttname"><a href="namespacemfem.html#a602b817d5a403240b59b6eb51d349406">mfem::u</a></div><div class="ttdeci">double u(const Vector &amp;xvec)</div><div class="ttdef"><b>Definition:</b> <a href="lor__mms_8hpp_source.html#l00022">lor_mms.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationPoint_html_a502c0832792bfe2a7b4ac340129f0589"><div class="ttname"><a href="classmfem_1_1IntegrationPoint.html#a502c0832792bfe2a7b4ac340129f0589">mfem::IntegrationPoint::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00034">intrules.hpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElement_html_a4e98d9b922030b9ef7379855daa81346"><div class="ttname"><a href="classmfem_1_1FiniteElement.html#a4e98d9b922030b9ef7379855daa81346">mfem::FiniteElement::GetNodes</a></div><div class="ttdeci">const IntegrationRule &amp; GetNodes() const</div><div class="ttdoc">Get a const reference to the nodes of the element. </div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8hpp_source.html#l00389">fe_base.hpp:389</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_html"><div class="ttname"><a href="classmfem_1_1HashTable.html">mfem::HashTable</a></div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00082">hash.hpp:82</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">mfem::Geometry::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00035">geom.hpp:35</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a83cdaa00a258633c9d09419d3a627970"><div class="ttname"><a href="classmfem_1_1Mesh.html#a83cdaa00a258633c9d09419d3a627970">mfem::Mesh::AddVertexParents</a></div><div class="ttdeci">void AddVertexParents(int i, int p1, int p2)</div><div class="ttdoc">Mark vertex i as nonconforming, with parent vertices p1 and p2. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01650">mesh.cpp:1650</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 27 2023 14:52:34 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
