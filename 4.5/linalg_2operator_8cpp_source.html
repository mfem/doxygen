<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MFEM: linalg/operator.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v4.5.1</span>
   </div>
   <div id="projectbrief">Finite element discretization library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c1845e5bf011c2136883d0d7188f50e9.html">linalg</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">operator.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="linalg_2operator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2010-2022, Lawrence Livermore National Security, LLC. Produced</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// at the Lawrence Livermore National Laboratory. All Rights reserved. See files</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LICENSE and NOTICE for details. LLNL-CODE-806117.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the MFEM library. For more information and source code</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// availability visit https://mfem.org.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// terms of the BSD-3 license. We welcome feedback and contributions, see file</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// CONTRIBUTING.md for details.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="vector_8hpp.html">vector.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;operator.hpp&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;../general/forall.hpp&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">namespace </span>mfem</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#af05141bf6d86d28444889d58216dc7ed">   22</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#af05141bf6d86d28444889d58216dc7ed">Operator::InitTVectors</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Po, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Ri,</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Pi,</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                            <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                            <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;X, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;B)<span class="keyword"> const</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">IsIdentityProlongation</a>(Po))</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      <span class="comment">// Variational restriction with Po</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;      B.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(Po-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>(), <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      Po-&gt;<a class="code" href="classmfem_1_1Operator.html#a2d8a7d98fd35870efb23db6e0472894b">MultTranspose</a>(b, B);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <span class="comment">// B points to same data as b</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      B.<a class="code" href="classmfem_1_1Vector.html#af4f29f4223296c6c07500ff7428309ba">MakeRef</a>(b, 0, b.<a class="code" href="classmfem_1_1Vector.html#ae46321466f5d68a25b6d8264bc1b08b5">Size</a>());</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">IsIdentityProlongation</a>(Pi))</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="comment">// Variational restriction with Ri</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      X.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(Ri-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(), x);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      Ri-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(x, X);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="comment">// X points to same data as x</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      X.<a class="code" href="classmfem_1_1Vector.html#af4f29f4223296c6c07500ff7428309ba">MakeRef</a>(x, 0, x.<a class="code" href="classmfem_1_1Vector.html#ae46321466f5d68a25b6d8264bc1b08b5">Size</a>());</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a110b300f31b8142d809fc32a37b1547e">   51</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a110b300f31b8142d809fc32a37b1547e">Operator::FormLinearSystem</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;ess_tdof_list,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                <a class="code" href="classmfem_1_1Operator.html">Operator</a>* &amp;Aout, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;X, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;B,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                <span class="keywordtype">int</span> copy_interior)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *P = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">GetProlongation</a>();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *R = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a79aca30fcf346fe6057ec409d0b1461d">GetRestriction</a>();</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#af05141bf6d86d28444889d58216dc7ed">InitTVectors</a>(P, R, P, x, b, X, B);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   <span class="keywordflow">if</span> (!copy_interior) { X.<a class="code" href="classmfem_1_1Vector.html#aab941790a2f15dd6dafcba2446078599">SetSubVectorComplement</a>(ess_tdof_list, 0.0); }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html">ConstrainedOperator</a> *constrainedA;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#a0e93d5e7be66d3d54bfeb26e8f2d2c74">FormConstrainedSystemOperator</a>(ess_tdof_list, constrainedA);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   constrainedA-&gt;<a class="code" href="classmfem_1_1ConstrainedOperator.html#a5a9eee45416d1b38ab41d4b4ff846326">EliminateRHS</a>(X, B);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   Aout = constrainedA;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a059ebb07070744a542a6fec3ea04a84b">   68</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a059ebb07070744a542a6fec3ea04a84b">Operator::FormRectangularLinearSystem</a>(</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;trial_tdof_list,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;test_tdof_list, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="classmfem_1_1Operator.html">Operator</a>* &amp;Aout, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;X, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;B)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Pi = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">GetProlongation</a>();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Po = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a680658a766b75b188ea3d87fb8a1c759">GetOutputProlongation</a>();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Ri = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a79aca30fcf346fe6057ec409d0b1461d">GetRestriction</a>();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#af05141bf6d86d28444889d58216dc7ed">InitTVectors</a>(Po, Ri, Pi, x, b, X, B);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html">RectangularConstrainedOperator</a> *constrainedA;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#ae17b1734b2b2bbbc3b13810f90f3f398">FormRectangularConstrainedSystemOperator</a>(trial_tdof_list, test_tdof_list,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                                            constrainedA);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   constrainedA-&gt;<a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#ab0a79aa153058f611e08a1bd0d2a8af0">EliminateRHS</a>(X, B);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   Aout = constrainedA;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#abad756b327262545c350d7280cc22643">   85</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#abad756b327262545c350d7280cc22643">Operator::RecoverFEMSolution</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;X, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   <span class="comment">// Same for Rectangular and Square operators</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *P = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">GetProlongation</a>();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">IsIdentityProlongation</a>(P))</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <span class="comment">// Apply conforming prolongation</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      x.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(P-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      P-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(X, x);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="comment">// X and x point to the same data</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="comment">// If the validity flags of X&#39;s Memory were changed (e.g. if it was moved</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="comment">// to device memory) then we need to tell x about that.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      x.<a class="code" href="classmfem_1_1Vector.html#a59d5de869d41deae20269ae4b697065a">SyncMemory</a>(X);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#ab860076188a32acbd2f1a7d428aba00d">  105</a></span>&#160;<a class="code" href="classmfem_1_1Operator.html">Operator</a> * <a class="code" href="classmfem_1_1Operator.html#ab860076188a32acbd2f1a7d428aba00d">Operator::SetupRAP</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Pi, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Po)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <a class="code" href="classmfem_1_1Operator.html">Operator</a> *rap;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">IsIdentityProlongation</a>(Pi))</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">IsIdentityProlongation</a>(Po))</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         rap = <span class="keyword">new</span> <a class="code" href="classmfem_1_1RAPOperator.html">RAPOperator</a>(*Po, *<span class="keyword">this</span>, *Pi);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;         rap = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ProductOperator.html">ProductOperator</a>(<span class="keyword">this</span>, Pi, <span class="keyword">false</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">IsIdentityProlongation</a>(Po))</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;         <a class="code" href="classmfem_1_1TransposeOperator.html">TransposeOperator</a> * PoT = <span class="keyword">new</span> <a class="code" href="classmfem_1_1TransposeOperator.html">TransposeOperator</a>(Po);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;         rap = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ProductOperator.html">ProductOperator</a>(PoT, <span class="keyword">this</span>, <span class="keyword">true</span>,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;         rap = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;   <span class="keywordflow">return</span> rap;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a0e93d5e7be66d3d54bfeb26e8f2d2c74">  134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a0e93d5e7be66d3d54bfeb26e8f2d2c74">Operator::FormConstrainedSystemOperator</a>(</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;ess_tdof_list, <a class="code" href="classmfem_1_1ConstrainedOperator.html">ConstrainedOperator</a>* &amp;Aout)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *P = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">GetProlongation</a>();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <a class="code" href="classmfem_1_1Operator.html">Operator</a> *rap = <a class="code" href="classmfem_1_1Operator.html#ab860076188a32acbd2f1a7d428aba00d">SetupRAP</a>(P, P);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="comment">// Impose the boundary conditions through a ConstrainedOperator, which owns</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="comment">// the rap operator when P and R are non-trivial</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html">ConstrainedOperator</a> *A = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ConstrainedOperator.html">ConstrainedOperator</a>(rap, ess_tdof_list,</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                                    rap != <span class="keyword">this</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   Aout = A;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#ae17b1734b2b2bbbc3b13810f90f3f398">  147</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#ae17b1734b2b2bbbc3b13810f90f3f398">Operator::FormRectangularConstrainedSystemOperator</a>(</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;trial_tdof_list, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;test_tdof_list,</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html">RectangularConstrainedOperator</a>* &amp;Aout)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Pi = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">GetProlongation</a>();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Po = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a680658a766b75b188ea3d87fb8a1c759">GetOutputProlongation</a>();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <a class="code" href="classmfem_1_1Operator.html">Operator</a> *rap = <a class="code" href="classmfem_1_1Operator.html#ab860076188a32acbd2f1a7d428aba00d">SetupRAP</a>(Pi, Po);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">// Impose the boundary conditions through a RectangularConstrainedOperator,</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="comment">// which owns the rap operator when P and R are non-trivial</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html">RectangularConstrainedOperator</a> *A</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      = <span class="keyword">new</span> <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html">RectangularConstrainedOperator</a>(rap,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                           trial_tdof_list, test_tdof_list,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                           rap != <span class="keyword">this</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   Aout = A;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a22c2496db1f13189e4c915627c12d94a">  164</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a22c2496db1f13189e4c915627c12d94a">Operator::FormSystemOperator</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;ess_tdof_list,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                  <a class="code" href="classmfem_1_1Operator.html">Operator</a>* &amp;Aout)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;{</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html">ConstrainedOperator</a> *A;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#a0e93d5e7be66d3d54bfeb26e8f2d2c74">FormConstrainedSystemOperator</a>(ess_tdof_list, A);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   Aout = A;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#ab275cd1cdcff5ce31e8ea1842585dd19">  172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#ab275cd1cdcff5ce31e8ea1842585dd19">Operator::FormRectangularSystemOperator</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;trial_tdof_list,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;test_tdof_list,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                                             <a class="code" href="classmfem_1_1Operator.html">Operator</a>* &amp;Aout)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html">RectangularConstrainedOperator</a> *A;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#ae17b1734b2b2bbbc3b13810f90f3f398">FormRectangularConstrainedSystemOperator</a>(trial_tdof_list, test_tdof_list, A);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   Aout = A;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;}</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a4626fca8e92c602f67122b283860db93">  181</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a4626fca8e92c602f67122b283860db93">Operator::FormDiscreteOperator</a>(<a class="code" href="classmfem_1_1Operator.html">Operator</a>* &amp;Aout)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;{</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Pin  = this-&gt;<a class="code" href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">GetProlongation</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *Rout = this-&gt;<a class="code" href="classmfem_1_1Operator.html#ad595ad2ea6e806fafa14141b4591b98f">GetOutputRestriction</a>();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   Aout = <span class="keyword">new</span> <a class="code" href="classmfem_1_1TripleProductOperator.html">TripleProductOperator</a>(Rout, <span class="keyword">this</span>, Pin,<span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a4ade1793b4efc7060337795f07ab28c9">  188</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a4ade1793b4efc7060337795f07ab28c9">Operator::PrintMatlab</a>(std::ostream &amp; os, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> m)<span class="keyword"> const</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   <span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   <span class="keywordflow">if</span> (n == 0) { n = <a class="code" href="classmfem_1_1Operator.html#a19823327e636510bfcd9f8c5e4bf48fa">width</a>; }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   <span class="keywordflow">if</span> (m == 0) { m = <a class="code" href="classmfem_1_1Operator.html#a62d74ad697f481c1e139404ca892afa6">height</a>; }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> x(n), y(m);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   x = 0.0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;   os &lt;&lt; setiosflags(ios::scientific | ios::showpos);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      x(i) = 1.0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(x, y);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; m; j++)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         <span class="keywordflow">if</span> (y(j) != 0)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            os &lt;&lt; j+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; y(j) &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;         }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      x(i) = 0.0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classmfem_1_1Operator.html#a21a5d95afecd499e775b4f76300debd2">  213</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1Operator.html#a4ade1793b4efc7060337795f07ab28c9">Operator::PrintMatlab</a>(std::ostream &amp;os)<span class="keyword"> const</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <a class="code" href="classmfem_1_1Operator.html#a4ade1793b4efc7060337795f07ab28c9">PrintMatlab</a>(os, <a class="code" href="classmfem_1_1Operator.html#a19823327e636510bfcd9f8c5e4bf48fa">width</a>, <a class="code" href="classmfem_1_1Operator.html#a62d74ad697f481c1e139404ca892afa6">height</a>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#abd2e462cdf596d10c5fba154a1a59a72">  219</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#abd2e462cdf596d10c5fba154a1a59a72">TimeDependentOperator::ExplicitMult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::ExplicitMult() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#aeb1b46d7d1f8f03c0ced4a89c5587e2f">  224</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#aeb1b46d7d1f8f03c0ced4a89c5587e2f">TimeDependentOperator::ImplicitMult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                         <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::ImplicitMult() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#ac1ae0abebb9788d39366a8d2f5c178e5">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#ac1ae0abebb9788d39366a8d2f5c178e5">TimeDependentOperator::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::Mult() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#a355f2e3d814516044791b3ad25f5d81a">  235</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#a355f2e3d814516044791b3ad25f5d81a">TimeDependentOperator::ImplicitSolve</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                          <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;)</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::ImplicitSolve() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;}</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#ad8551121998316364eba6d7e5db0dfd6">  241</a></span>&#160;<a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;<a class="code" href="classmfem_1_1TimeDependentOperator.html#ad8551121998316364eba6d7e5db0dfd6">TimeDependentOperator::GetImplicitGradient</a>(</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <span class="keywordtype">double</span>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::GetImplicitGradient() is &quot;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;              <span class="stringliteral">&quot;not overridden!&quot;</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;<span class="keyword">&gt;</span>(<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;<span class="keyword">&gt;</span>(*this));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#af10942e8fd919ca961716ba4da2799ff">  249</a></span>&#160;<a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;<a class="code" href="classmfem_1_1TimeDependentOperator.html#af10942e8fd919ca961716ba4da2799ff">TimeDependentOperator::GetExplicitGradient</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;)<span class="keyword"> const</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::GetExplicitGradient() is &quot;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;              <span class="stringliteral">&quot;not overridden!&quot;</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;<span class="keyword">&gt;</span>(<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;<span class="keyword">&gt;</span>(*this));</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#ae1d4a78f19ecfac318d6733589e4d5d5">  256</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#ae1d4a78f19ecfac318d6733589e4d5d5">TimeDependentOperator::SUNImplicitSetup</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                            <span class="keywordtype">int</span>, <span class="keywordtype">int</span> *, <span class="keywordtype">double</span>)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;{</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::SUNImplicitSetup() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keywordflow">return</span> (-1);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#a4303d50b04590a0e6afc890cec18f58d">  264</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#a4303d50b04590a0e6afc890cec18f58d">TimeDependentOperator::SUNImplicitSolve</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <span class="keywordtype">double</span>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::SUNImplicitSolve() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keywordflow">return</span> (-1);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#a7c10a565ad546c610fd0cf01260a572f">  270</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#a7c10a565ad546c610fd0cf01260a572f">TimeDependentOperator::SUNMassSetup</a>()</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;{</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::SUNMassSetup() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">return</span> (-1);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#aed2af294d6f808d90cfa5f42fbc7d833">  276</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#aed2af294d6f808d90cfa5f42fbc7d833">TimeDependentOperator::SUNMassSolve</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <span class="keywordtype">double</span>)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::SUNMassSolve() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;   <span class="keywordflow">return</span> (-1);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="line" href="classmfem_1_1TimeDependentOperator.html#a603fa10f2f5d0508b164b93f322ff7d6">  282</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1TimeDependentOperator.html#a603fa10f2f5d0508b164b93f322ff7d6">TimeDependentOperator::SUNMassMult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;{</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;TimeDependentOperator::SUNMassMult() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">return</span> (-1);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="classmfem_1_1SecondOrderTimeDependentOperator.html#a4b8b87ee96e953006cabfc77523377c6">  289</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1SecondOrderTimeDependentOperator.html#a4b8b87ee96e953006cabfc77523377c6">SecondOrderTimeDependentOperator::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;dxdt,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                            <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;y)<span class="keyword"> const</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;SecondOrderTimeDependentOperator::Mult() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classmfem_1_1SecondOrderTimeDependentOperator.html#a71b8e8f19dacc1c49d068ccba49856bd">  296</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1SecondOrderTimeDependentOperator.html#a71b8e8f19dacc1c49d068ccba49856bd">SecondOrderTimeDependentOperator::ImplicitSolve</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> dt0,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">double</span> dt1,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                     <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                     <span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;dxdt,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                     <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;k)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;SecondOrderTimeDependentOperator::ImplicitSolve() is not overridden!&quot;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classmfem_1_1ProductOperator.html#a7d0033819d91da6a064b307be0aa1f66">  306</a></span>&#160;<a class="code" href="classmfem_1_1ProductOperator.html#a7d0033819d91da6a064b307be0aa1f66">ProductOperator::ProductOperator</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *A, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *B,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                 <span class="keywordtype">bool</span> ownA, <span class="keywordtype">bool</span> ownB)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;   : <a class="code" href="classmfem_1_1Operator.html">Operator</a>(A-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(), B-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>()),</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;     A(A), B(B), ownA(ownA), ownB(ownB), z(A-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>())</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   MFEM_VERIFY(A-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>() == B-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(),</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;               <span class="stringliteral">&quot;incompatible Operators: A-&gt;Width() = &quot;</span> &lt;&lt; A-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>()</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;, B-&gt;Height() = &quot;</span> &lt;&lt; B-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Solver.html">Solver</a>* SolverB = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Solver.html">Solver</a>*<span class="keyword">&gt;</span>(B);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">if</span> (SolverB)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;         MFEM_VERIFY(!(SolverB-&gt;<a class="code" href="classmfem_1_1Solver.html#a272712697efa5927c3ce6bbd076845fb">iterative_mode</a>),</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                     <span class="stringliteral">&quot;Operator B of a ProductOperator should not be in iterative mode&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="classmfem_1_1ProductOperator.html#ae4f3151cff8f0c9a5fbde91a98dd463c">  325</a></span>&#160;<a class="code" href="classmfem_1_1ProductOperator.html#ae4f3151cff8f0c9a5fbde91a98dd463c">ProductOperator::~ProductOperator</a>()</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;{</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   <span class="keywordflow">if</span> (ownA) { <span class="keyword">delete</span> A; }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keywordflow">if</span> (ownB) { <span class="keyword">delete</span> B; }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classmfem_1_1RAPOperator.html#a769d421be3becf733685ec2ee673e02e">  332</a></span>&#160;<a class="code" href="classmfem_1_1RAPOperator.html#a769d421be3becf733685ec2ee673e02e">RAPOperator::RAPOperator</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;Rt_, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;A_,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> &amp;P_)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   : <a class="code" href="classmfem_1_1Operator.html">Operator</a>(Rt_.Width(), P_.Width()), Rt(Rt_), A(A_), P(P_)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   MFEM_VERIFY(Rt.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>() == A.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(),</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;               <span class="stringliteral">&quot;incompatible Operators: Rt.Height() = &quot;</span> &lt;&lt; Rt.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>()</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;, A.Height() = &quot;</span> &lt;&lt; A.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   MFEM_VERIFY(A.<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>() == P.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(),</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;               <span class="stringliteral">&quot;incompatible Operators: A.Width() = &quot;</span> &lt;&lt; A.<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>()</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;, P.Height() = &quot;</span> &lt;&lt; P.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>());</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Solver.html">Solver</a>* SolverA = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Solver.html">Solver</a>*<span class="keyword">&gt;</span>(&amp;A);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">if</span> (SolverA)</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         MFEM_VERIFY(!(SolverA-&gt;<a class="code" href="classmfem_1_1Solver.html#a272712697efa5927c3ce6bbd076845fb">iterative_mode</a>),</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                     <span class="stringliteral">&quot;Operator A of an RAPOperator should not be in iterative mode&quot;</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Solver.html">Solver</a>* SolverP = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Solver.html">Solver</a>*<span class="keyword">&gt;</span>(&amp;P);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">if</span> (SolverP)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;         MFEM_VERIFY(!(SolverP-&gt;<a class="code" href="classmfem_1_1Solver.html#a272712697efa5927c3ce6bbd076845fb">iterative_mode</a>),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                     <span class="stringliteral">&quot;Operator P of an RAPOperator should not be in iterative mode&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   mem_class = Rt.<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>()*P.<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <a class="code" href="namespacemfem.html#adb01975babc73b14adfe02bf6a7c77f6">MemoryType</a> mem_type = <a class="code" href="namespacemfem.html#a76ab5f9d46bb5419fb8f1b65ab307b45">GetMemoryType</a>(A.<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>()*mem_class);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   Px.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(P.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(), mem_type);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   APx.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(A.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(), mem_type);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="classmfem_1_1TripleProductOperator.html#a887858500b819b83dbc16fe9c9cf555f">  366</a></span>&#160;<a class="code" href="classmfem_1_1TripleProductOperator.html#a887858500b819b83dbc16fe9c9cf555f">TripleProductOperator::TripleProductOperator</a>(</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *A, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *B, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Operator.html">Operator</a> *C,</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordtype">bool</span> ownA, <span class="keywordtype">bool</span> ownB, <span class="keywordtype">bool</span> ownC)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   : <a class="code" href="classmfem_1_1Operator.html">Operator</a>(A-&gt;Height(), C-&gt;Width())</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   , A(A), B(B), C(C)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;   , ownA(ownA), ownB(ownB), ownC(ownC)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   MFEM_VERIFY(A-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>() == B-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(),</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;               <span class="stringliteral">&quot;incompatible Operators: A-&gt;Width() = &quot;</span> &lt;&lt; A-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>()</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;, B-&gt;Height() = &quot;</span> &lt;&lt; B-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>());</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;   MFEM_VERIFY(B-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>() == C-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(),</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;               <span class="stringliteral">&quot;incompatible Operators: B-&gt;Width() = &quot;</span> &lt;&lt; B-&gt;<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>()</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;, C-&gt;Height() = &quot;</span> &lt;&lt; C-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>());</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Solver.html">Solver</a>* SolverB = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Solver.html">Solver</a>*<span class="keyword">&gt;</span>(B);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">if</span> (SolverB)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;         MFEM_VERIFY(!(SolverB-&gt;<a class="code" href="classmfem_1_1Solver.html#a272712697efa5927c3ce6bbd076845fb">iterative_mode</a>),</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                     <span class="stringliteral">&quot;Operator B of a TripleProductOperator should not be in iterative mode&quot;</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Solver.html">Solver</a>* SolverC = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classmfem_1_1Solver.html">Solver</a>*<span class="keyword">&gt;</span>(C);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (SolverC)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;         MFEM_VERIFY(!(SolverC-&gt;<a class="code" href="classmfem_1_1Solver.html#a272712697efa5927c3ce6bbd076845fb">iterative_mode</a>),</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                     <span class="stringliteral">&quot;Operator C of a TripleProductOperator should not be in iterative mode&quot;</span>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   mem_class = A-&gt;<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>()*C-&gt;<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <a class="code" href="namespacemfem.html#adb01975babc73b14adfe02bf6a7c77f6">MemoryType</a> mem_type = <a class="code" href="namespacemfem.html#a76ab5f9d46bb5419fb8f1b65ab307b45">GetMemoryType</a>(mem_class*B-&gt;<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>());</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   t1.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(C-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(), mem_type);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   t2.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(B-&gt;<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(), mem_type);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="classmfem_1_1TripleProductOperator.html#a9669d9b6f86dbc467f07ab084392a9bc">  402</a></span>&#160;<a class="code" href="classmfem_1_1TripleProductOperator.html#a9669d9b6f86dbc467f07ab084392a9bc">TripleProductOperator::~TripleProductOperator</a>()</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;{</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordflow">if</span> (ownA) { <span class="keyword">delete</span> A; }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordflow">if</span> (ownB) { <span class="keyword">delete</span> B; }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="keywordflow">if</span> (ownC) { <span class="keyword">delete</span> C; }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="classmfem_1_1ConstrainedOperator.html#a646d05362bd91107ac36210b68e61e49">  410</a></span>&#160;<a class="code" href="classmfem_1_1ConstrainedOperator.html#a646d05362bd91107ac36210b68e61e49">ConstrainedOperator::ConstrainedOperator</a>(<a class="code" href="classmfem_1_1Operator.html">Operator</a> *A, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;list,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                         <span class="keywordtype">bool</span> own_A_,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                         <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5">DiagonalPolicy</a> diag_policy_)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   : <a class="code" href="classmfem_1_1Operator.html">Operator</a>(A-&gt;Height(), A-&gt;Width()), A(A), own_A(own_A_),</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;     diag_policy(diag_policy_)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="comment">// &#39;mem_class&#39; should work with A-&gt;Mult() and MFEM_FORALL():</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#ac028b17fccf6cf2a6ef9ef6b9b47a912">mem_class</a> = A-&gt;<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>()*<a class="code" href="classmfem_1_1Device.html#abd8048091a97559d782a9d069ee1e53c">Device::GetDeviceMemoryClass</a>();</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <a class="code" href="namespacemfem.html#adb01975babc73b14adfe02bf6a7c77f6">MemoryType</a> mem_type = <a class="code" href="namespacemfem.html#a76ab5f9d46bb5419fb8f1b65ab307b45">GetMemoryType</a>(<a class="code" href="classmfem_1_1ConstrainedOperator.html#ac028b17fccf6cf2a6ef9ef6b9b47a912">mem_class</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   list.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>(); <span class="comment">// TODO: just ensure &#39;list&#39; is registered, no need to copy it</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a7f0770ecb717feb309f278800f65a416">MakeRef</a>(list);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="comment">// typically z and w are large vectors, so store them on the device</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a>.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(<a class="code" href="classmfem_1_1Operator.html#a62d74ad697f481c1e139404ca892afa6">height</a>, mem_type); <a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a>.<a class="code" href="classmfem_1_1Vector.html#a6bfb58c0aaea5cd94b369e0390bbca4f">UseDevice</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#aae82923af0810282546d6ed093801e0e">w</a>.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(<a class="code" href="classmfem_1_1Operator.html#a62d74ad697f481c1e139404ca892afa6">height</a>, mem_type); <a class="code" href="classmfem_1_1ConstrainedOperator.html#aae82923af0810282546d6ed093801e0e">w</a>.<a class="code" href="classmfem_1_1Vector.html#a6bfb58c0aaea5cd94b369e0390bbca4f">UseDevice</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;}</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classmfem_1_1ConstrainedOperator.html#a4f1ed6e45fbfbee08c21c50ee0c6e441">  426</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ConstrainedOperator.html#a4f1ed6e45fbfbee08c21c50ee0c6e441">ConstrainedOperator::AssembleDiagonal</a>(<a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;diag)<span class="keyword"> const</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#a415607249084d6206f6e5b70991b2b8a">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a241b3c491eb58783bdbb3daf01cc2ab6">AssembleDiagonal</a>(diag);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ConstrainedOperator.html#a9d771af745d54b54e82b23a3d983f910">diag_policy</a> == <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5acef0ffcbba7e9a349433b39fda7f9373">DIAG_KEEP</a>) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> csz = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keyword">auto</span> d_diag = diag.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1ConstrainedOperator.html#a9d771af745d54b54e82b23a3d983f910">diag_policy</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;   {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5a3aa9b65b076574e05157430abf4b76e2">DIAG_ONE</a>:</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;         MFEM_FORALL(i, csz,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = idx[i];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            d_diag[id] = 1.0;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         });</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5aff3f5ed6e5c730828cd33f138ec3ada1">DIAG_ZERO</a>:</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         MFEM_FORALL(i, csz,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = idx[i];</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            d_diag[id] = 0.0;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         });</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;unknown diagonal policy&quot;</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classmfem_1_1ConstrainedOperator.html#a5a9eee45416d1b38ab41d4b4ff846326">  457</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ConstrainedOperator.html#a5a9eee45416d1b38ab41d4b4ff846326">ConstrainedOperator::EliminateRHS</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#aae82923af0810282546d6ed093801e0e">w</a> = 0.0;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> csz = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="keyword">auto</span> d_x = x.<a class="code" href="classmfem_1_1Vector.html#aca242c6173b3353c23213bc891162f6e">Read</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   <span class="comment">// Use read+write access - we are modifying sub-vector of w</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   <span class="keyword">auto</span> d_w = <a class="code" href="classmfem_1_1ConstrainedOperator.html#aae82923af0810282546d6ed093801e0e">w</a>.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   MFEM_FORALL(i, csz,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = idx[i];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      d_w[id] = d_x[id];</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   });</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="comment">// A.AddMult(w, b, -1.0); // if available to all Operators</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#a415607249084d6206f6e5b70991b2b8a">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(<a class="code" href="classmfem_1_1ConstrainedOperator.html#aae82923af0810282546d6ed093801e0e">w</a>, <a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   b -= <a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <span class="comment">// Use read+write access - we are modifying sub-vector of b</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="keyword">auto</span> d_b = b.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   MFEM_FORALL(i, csz,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = idx[i];</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      d_b[id] = d_x[id];</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   });</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;}</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="classmfem_1_1ConstrainedOperator.html#a402949ba62b76e50e9d5636f8ce62cb8">  484</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ConstrainedOperator.html#a402949ba62b76e50e9d5636f8ce62cb8">ConstrainedOperator::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;y)<span class="keyword"> const</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> csz = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keywordflow">if</span> (csz == 0)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <a class="code" href="classmfem_1_1ConstrainedOperator.html#a415607249084d6206f6e5b70991b2b8a">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(x, y);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a> = x;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">constraint_list</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="comment">// Use read+write access - we are modifying sub-vector of z</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="keyword">auto</span> d_z = <a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a>.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   MFEM_FORALL(i, csz, d_z[idx[i]] = 0.0;);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   <a class="code" href="classmfem_1_1ConstrainedOperator.html#a415607249084d6206f6e5b70991b2b8a">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(<a class="code" href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">z</a>, y);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   <span class="keyword">auto</span> d_x = x.<a class="code" href="classmfem_1_1Vector.html#aca242c6173b3353c23213bc891162f6e">Read</a>();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <span class="comment">// Use read+write access - we are modifying sub-vector of y</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   <span class="keyword">auto</span> d_y = y.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1ConstrainedOperator.html#a9d771af745d54b54e82b23a3d983f910">diag_policy</a>)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5a3aa9b65b076574e05157430abf4b76e2">DIAG_ONE</a>:</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;         MFEM_FORALL(i, csz,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = idx[i];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            d_y[id] = d_x[id];</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;         });</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5aff3f5ed6e5c730828cd33f138ec3ada1">DIAG_ZERO</a>:</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;         MFEM_FORALL(i, csz,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;         {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = idx[i];</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            d_y[id] = 0.0;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         });</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5acef0ffcbba7e9a349433b39fda7f9373">DIAG_KEEP</a>:</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;         <span class="comment">// Needs action of the operator diagonal on vector</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;         <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;ConstrainedOperator::Mult #1&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;ConstrainedOperator::Mult #2&quot;</span>);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classmfem_1_1RectangularConstrainedOperator.html#a099439bf8bf7dd0f685f3d113083e917">  531</a></span>&#160;<a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a099439bf8bf7dd0f685f3d113083e917">RectangularConstrainedOperator::RectangularConstrainedOperator</a>(</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <a class="code" href="classmfem_1_1Operator.html">Operator</a> *A,</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;trial_list,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;test_list,</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <span class="keywordtype">bool</span> own_A_)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   : <a class="code" href="classmfem_1_1Operator.html">Operator</a>(A-&gt;Height(), A-&gt;Width()), A(A), own_A(own_A_)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="comment">// &#39;mem_class&#39; should work with A-&gt;Mult() and MFEM_FORALL():</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a39276da84838c7af809677dee4bd84b5">mem_class</a> = A-&gt;<a class="code" href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">GetMemoryClass</a>()*<a class="code" href="classmfem_1_1Device.html#a0f70ea97e2c123c86c5d902ac9564090">Device::GetMemoryClass</a>();</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <a class="code" href="namespacemfem.html#adb01975babc73b14adfe02bf6a7c77f6">MemoryType</a> mem_type = <a class="code" href="namespacemfem.html#a76ab5f9d46bb5419fb8f1b65ab307b45">GetMemoryType</a>(<a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a39276da84838c7af809677dee4bd84b5">mem_class</a>);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;   trial_list.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>(); <span class="comment">// TODO: just ensure &#39;list&#39; is registered, no need to copy it</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;   test_list.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>(); <span class="comment">// TODO: just ensure &#39;list&#39; is registered, no need to copy it</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a7f0770ecb717feb309f278800f65a416">MakeRef</a>(trial_list);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a7f0770ecb717feb309f278800f65a416">MakeRef</a>(test_list);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="comment">// typically z and w are large vectors, so store them on the device</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a>.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(<a class="code" href="classmfem_1_1Operator.html#a62d74ad697f481c1e139404ca892afa6">height</a>, mem_type); <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a>.<a class="code" href="classmfem_1_1Vector.html#a6bfb58c0aaea5cd94b369e0390bbca4f">UseDevice</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a>.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(<a class="code" href="classmfem_1_1Operator.html#a19823327e636510bfcd9f8c5e4bf48fa">width</a>, mem_type); <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a>.<a class="code" href="classmfem_1_1Vector.html#a6bfb58c0aaea5cd94b369e0390bbca4f">UseDevice</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="classmfem_1_1RectangularConstrainedOperator.html#ab0a79aa153058f611e08a1bd0d2a8af0">  550</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#ab0a79aa153058f611e08a1bd0d2a8af0">RectangularConstrainedOperator::EliminateRHS</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x,</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                                  <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a> = 0.0;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> trial_csz = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="keyword">auto</span> trial_idx = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="keyword">auto</span> d_x = x.<a class="code" href="classmfem_1_1Vector.html#aca242c6173b3353c23213bc891162f6e">Read</a>();</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="comment">// Use read+write access - we are modifying sub-vector of w</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="keyword">auto</span> d_w = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a>.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   MFEM_FORALL(i, trial_csz,</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = trial_idx[i];</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      d_w[id] = d_x[id];</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   });</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="comment">// A.AddMult(w, b, -1.0); // if available to all Operators</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a648dc512026248f9cc94c30e6fe502a3">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(<a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a>, <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a>);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   b -= <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> test_csz = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="keyword">auto</span> test_idx = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keyword">auto</span> d_b = b.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   MFEM_FORALL(i, test_csz, d_b[test_idx[i]] = 0.0;);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;}</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="classmfem_1_1RectangularConstrainedOperator.html#a0ee61333333244753c73e76ce65f139d">  575</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a0ee61333333244753c73e76ce65f139d">RectangularConstrainedOperator::Mult</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;y)<span class="keyword"> const</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> trial_csz = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> test_csz = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="keywordflow">if</span> (trial_csz == 0)</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   {</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a648dc512026248f9cc94c30e6fe502a3">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(x, y);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a> = x;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="comment">// Use read+write access - we are modifying sub-vector of w</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keyword">auto</span> d_w = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a>.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      MFEM_FORALL(i, trial_csz, d_w[idx[i]] = 0.0;);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a648dc512026248f9cc94c30e6fe502a3">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(<a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">w</a>, y);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="keywordflow">if</span> (test_csz != 0)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keyword">auto</span> d_y = y.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      MFEM_FORALL(i, test_csz, d_y[idx[i]] = 0.0;);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;   }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="classmfem_1_1RectangularConstrainedOperator.html#a94dd5e9aa594262d3ecd641dea764150">  603</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a94dd5e9aa594262d3ecd641dea764150">RectangularConstrainedOperator::MultTranspose</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;x,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                                   <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;y)<span class="keyword"> const</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> trial_csz = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> test_csz = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;   <span class="keywordflow">if</span> (test_csz == 0)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a648dc512026248f9cc94c30e6fe502a3">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a2d8a7d98fd35870efb23db6e0472894b">MultTranspose</a>(x, y);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;   }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a> = x;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">test_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">// Use read+write access - we are modifying sub-vector of z</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="keyword">auto</span> d_z = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a>.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      MFEM_FORALL(i, test_csz, d_z[idx[i]] = 0.0;);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a648dc512026248f9cc94c30e6fe502a3">A</a>-&gt;<a class="code" href="classmfem_1_1Operator.html#a2d8a7d98fd35870efb23db6e0472894b">MultTranspose</a>(<a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">z</a>, y);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <span class="keywordflow">if</span> (trial_csz != 0)</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keyword">auto</span> idx = <a class="code" href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">trial_constraints</a>.<a class="code" href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">Read</a>();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keyword">auto</span> d_y = y.<a class="code" href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">ReadWrite</a>();</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      MFEM_FORALL(i, trial_csz, d_y[idx[i]] = 0.0;);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;}</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="classmfem_1_1PowerMethod.html#a6713b65f7951c894f29b3ff5f17f4377">  632</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classmfem_1_1PowerMethod.html#a6713b65f7951c894f29b3ff5f17f4377">PowerMethod::EstimateLargestEigenvalue</a>(<a class="code" href="classmfem_1_1Operator.html">Operator</a>&amp; opr, <a class="code" href="classmfem_1_1Vector.html">Vector</a>&amp; v0,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                                              <span class="keywordtype">int</span> numSteps, <span class="keywordtype">double</span> tolerance, <span class="keywordtype">int</span> seed)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;{</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   v1.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(v0.<a class="code" href="classmfem_1_1Vector.html#ae46321466f5d68a25b6d8264bc1b08b5">Size</a>());</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   <span class="keywordflow">if</span> (seed != 0)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   {</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      v0.<a class="code" href="classmfem_1_1Vector.html#a00311453114bf70ddcd35a773f193e78">Randomize</a>(seed);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   <span class="keywordtype">double</span> eigenvalue = 1.0;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iter = 0; iter &lt; numSteps; ++iter)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keywordtype">double</span> normV0;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="preprocessor">#ifdef MFEM_USE_MPI</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (comm != MPI_COMM_NULL)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         normV0 = <a class="code" href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">InnerProduct</a>(comm, v0, v0);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         normV0 = <a class="code" href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">InnerProduct</a>(v0, v0);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor"></span>      normV0 = <a class="code" href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">InnerProduct</a>(v0, v0);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      v0 /= sqrt(normV0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      opr.<a class="code" href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">Mult</a>(v0, v1);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordtype">double</span> eigenvalueNew;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor">#ifdef MFEM_USE_MPI</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">if</span> (comm != MPI_COMM_NULL)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         eigenvalueNew = <a class="code" href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">InnerProduct</a>(comm, v0, v1);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;         eigenvalueNew = <a class="code" href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">InnerProduct</a>(v0, v1);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="preprocessor"></span>      eigenvalueNew = <a class="code" href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">InnerProduct</a>(v0, v1);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor"></span>      <span class="keywordtype">double</span> diff = std::abs((eigenvalueNew - eigenvalue) / eigenvalue);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      eigenvalue = eigenvalueNew;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      std::swap(v0, v1);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">if</span> (diff &lt; tolerance)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordflow">return</span> eigenvalue;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;}</div>
<div class="ttc" id="classmfem_1_1Device_html_a0f70ea97e2c123c86c5d902ac9564090"><div class="ttname"><a href="classmfem_1_1Device.html#a0f70ea97e2c123c86c5d902ac9564090">mfem::Device::GetMemoryClass</a></div><div class="ttdeci">static MemoryClass GetMemoryClass()</div><div class="ttdoc">(DEPRECATED) Equivalent to GetDeviceMemoryClass(). </div><div class="ttdef"><b>Definition:</b> <a href="device_8hpp_source.html#l00285">device.hpp:285</a></div></div>
<div class="ttc" id="classmfem_1_1SecondOrderTimeDependentOperator_html_a4b8b87ee96e953006cabfc77523377c6"><div class="ttname"><a href="classmfem_1_1SecondOrderTimeDependentOperator.html#a4b8b87ee96e953006cabfc77523377c6">mfem::SecondOrderTimeDependentOperator::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, const Vector &amp;dxdt, Vector &amp;y) const </div><div class="ttdoc">Perform the action of the operator: y = k = f(x,@ dxdt, t), where k solves the algebraic equation F(x...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00289">operator.cpp:289</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a813eda5c8de9bfcbf06f89adaff1f8ff"><div class="ttname"><a href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">mfem::Array::Size</a></div><div class="ttdeci">int Size() const </div><div class="ttdoc">Return the logical size of the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00138">array.hpp:138</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ab275cd1cdcff5ce31e8ea1842585dd19"><div class="ttname"><a href="classmfem_1_1Operator.html#ab275cd1cdcff5ce31e8ea1842585dd19">mfem::Operator::FormRectangularSystemOperator</a></div><div class="ttdeci">void FormRectangularSystemOperator(const Array&lt; int &gt; &amp;trial_tdof_list, const Array&lt; int &gt; &amp;test_tdof_list, Operator *&amp;A)</div><div class="ttdoc">Return in A a parallel (on truedofs) version of this rectangular operator (including constraints)...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00172">operator.cpp:172</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a646d05362bd91107ac36210b68e61e49"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a646d05362bd91107ac36210b68e61e49">mfem::ConstrainedOperator::ConstrainedOperator</a></div><div class="ttdeci">ConstrainedOperator(Operator *A, const Array&lt; int &gt; &amp;list, bool own_A=false, DiagonalPolicy diag_policy=DIAG_ONE)</div><div class="ttdoc">Constructor from a general Operator and a list of essential indices/dofs. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00410">operator.cpp:410</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a648dc512026248f9cc94c30e6fe502a3"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a648dc512026248f9cc94c30e6fe502a3">mfem::RectangularConstrainedOperator::A</a></div><div class="ttdeci">Operator * A</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00915">operator.hpp:915</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a1e9b16fe7938a41d528447ea9cbcfe4c"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a1e9b16fe7938a41d528447ea9cbcfe4c">mfem::RectangularConstrainedOperator::w</a></div><div class="ttdeci">Vector w</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00917">operator.hpp:917</a></div></div>
<div class="ttc" id="classmfem_1_1ProductOperator_html_ae4f3151cff8f0c9a5fbde91a98dd463c"><div class="ttname"><a href="classmfem_1_1ProductOperator.html#ae4f3151cff8f0c9a5fbde91a98dd463c">mfem::ProductOperator::~ProductOperator</a></div><div class="ttdeci">virtual ~ProductOperator()</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00325">operator.cpp:325</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a4f1ed6e45fbfbee08c21c50ee0c6e441"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a4f1ed6e45fbfbee08c21c50ee0c6e441">mfem::ConstrainedOperator::AssembleDiagonal</a></div><div class="ttdeci">virtual void AssembleDiagonal(Vector &amp;diag) const </div><div class="ttdoc">Diagonal of A, modified according to the used DiagonalPolicy. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00426">operator.cpp:426</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a23bb3c5c32590af0e0095fdb28629539"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a23bb3c5c32590af0e0095fdb28629539">mfem::ConstrainedOperator::constraint_list</a></div><div class="ttdeci">Array&lt; int &gt; constraint_list</div><div class="ttdoc">List of constrained indices/dofs. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00848">operator.hpp:848</a></div></div>
<div class="ttc" id="classmfem_1_1SecondOrderTimeDependentOperator_html_a71b8e8f19dacc1c49d068ccba49856bd"><div class="ttname"><a href="classmfem_1_1SecondOrderTimeDependentOperator.html#a71b8e8f19dacc1c49d068ccba49856bd">mfem::SecondOrderTimeDependentOperator::ImplicitSolve</a></div><div class="ttdeci">virtual void ImplicitSolve(const double fac0, const double fac1, const Vector &amp;x, const Vector &amp;dxdt, Vector &amp;k)</div><div class="ttdoc">Solve the equation: k = f(x + fac0 k, dxdt + fac1 k, t), for the unknown k at the current time t...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00296">operator.cpp:296</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_ac1e67bd3ee82db59573950d19897c149"><div class="ttname"><a href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">mfem::Vector::SetSize</a></div><div class="ttdeci">void SetSize(int s)</div><div class="ttdoc">Resize the vector to size s. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00513">vector.hpp:513</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_a355f2e3d814516044791b3ad25f5d81a"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#a355f2e3d814516044791b3ad25f5d81a">mfem::TimeDependentOperator::ImplicitSolve</a></div><div class="ttdeci">virtual void ImplicitSolve(const double dt, const Vector &amp;x, Vector &amp;k)</div><div class="ttdoc">Solve the equation: k = f(x + dt k, t), for the unknown k at the current time t. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00235">operator.cpp:235</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ab0eaacccbad37071f14d9bc9431acbce"><div class="ttname"><a href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">mfem::Operator::Width</a></div><div class="ttdeci">int Width() const </div><div class="ttdoc">Get the width (size of input) of the Operator. Synonym with NumCols(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00073">operator.hpp:73</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a39276da84838c7af809677dee4bd84b5"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a39276da84838c7af809677dee4bd84b5">mfem::RectangularConstrainedOperator::mem_class</a></div><div class="ttdeci">MemoryClass mem_class</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00918">operator.hpp:918</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a402949ba62b76e50e9d5636f8ce62cb8"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a402949ba62b76e50e9d5636f8ce62cb8">mfem::ConstrainedOperator::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const </div><div class="ttdoc">Constrained operator action. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00484">operator.cpp:484</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_af10942e8fd919ca961716ba4da2799ff"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#af10942e8fd919ca961716ba4da2799ff">mfem::TimeDependentOperator::GetExplicitGradient</a></div><div class="ttdeci">virtual Operator &amp; GetExplicitGradient(const Vector &amp;x) const </div><div class="ttdoc">Return an Operator representing dG/dx at the given point x and the currently set time. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00249">operator.cpp:249</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_ae46321466f5d68a25b6d8264bc1b08b5"><div class="ttname"><a href="classmfem_1_1Vector.html#ae46321466f5d68a25b6d8264bc1b08b5">mfem::Vector::Size</a></div><div class="ttdeci">int Size() const </div><div class="ttdoc">Returns the size of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00200">vector.hpp:200</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a680658a766b75b188ea3d87fb8a1c759"><div class="ttname"><a href="classmfem_1_1Operator.html#a680658a766b75b188ea3d87fb8a1c759">mfem::Operator::GetOutputProlongation</a></div><div class="ttdeci">virtual const Operator * GetOutputProlongation() const </div><div class="ttdoc">Prolongation operator from linear algebra (linear system) vectors, to output vectors for the operator...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00122">operator.hpp:122</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_ab0a79aa153058f611e08a1bd0d2a8af0"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#ab0a79aa153058f611e08a1bd0d2a8af0">mfem::RectangularConstrainedOperator::EliminateRHS</a></div><div class="ttdeci">void EliminateRHS(const Vector &amp;x, Vector &amp;b) const </div><div class="ttdoc">Eliminate columns corresponding to &amp;quot;essential boundary condition&amp;quot; values specified in x from the give...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00550">operator.cpp:550</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a4626fca8e92c602f67122b283860db93"><div class="ttname"><a href="classmfem_1_1Operator.html#a4626fca8e92c602f67122b283860db93">mfem::Operator::FormDiscreteOperator</a></div><div class="ttdeci">void FormDiscreteOperator(Operator *&amp;A)</div><div class="ttdoc">Return in A a parallel (on truedofs) version of this rectangular operator. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00181">operator.cpp:181</a></div></div>
<div class="ttc" id="classmfem_1_1ProductOperator_html_a7d0033819d91da6a064b307be0aa1f66"><div class="ttname"><a href="classmfem_1_1ProductOperator.html#a7d0033819d91da6a064b307be0aa1f66">mfem::ProductOperator::ProductOperator</a></div><div class="ttdeci">ProductOperator(const Operator *A, const Operator *B, bool ownA, bool ownB)</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00306">operator.cpp:306</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a700c3008b5ab43155cdfd279c8360472"><div class="ttname"><a href="classmfem_1_1Operator.html#a700c3008b5ab43155cdfd279c8360472">mfem::Operator::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const =0</div><div class="ttdoc">Operator application: y=A(x). </div></div>
<div class="ttc" id="classmfem_1_1Solver_html_a272712697efa5927c3ce6bbd076845fb"><div class="ttname"><a href="classmfem_1_1Solver.html#a272712697efa5927c3ce6bbd076845fb">mfem::Solver::iterative_mode</a></div><div class="ttdeci">bool iterative_mode</div><div class="ttdoc">If true, use the second argument of Mult() as an initial guess. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00659">operator.hpp:659</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_a00311453114bf70ddcd35a773f193e78"><div class="ttname"><a href="classmfem_1_1Vector.html#a00311453114bf70ddcd35a773f193e78">mfem::Vector::Randomize</a></div><div class="ttdeci">void Randomize(int seed=0)</div><div class="ttdoc">Set random values in the vector. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8cpp_source.html#l00785">vector.cpp:785</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_a6bfb58c0aaea5cd94b369e0390bbca4f"><div class="ttname"><a href="classmfem_1_1Vector.html#a6bfb58c0aaea5cd94b369e0390bbca4f">mfem::Vector::UseDevice</a></div><div class="ttdeci">virtual void UseDevice(bool use_dev) const </div><div class="ttdoc">Enable execution of Vector operations using the mfem::Device. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00118">vector.hpp:118</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a2d8a7d98fd35870efb23db6e0472894b"><div class="ttname"><a href="classmfem_1_1Operator.html#a2d8a7d98fd35870efb23db6e0472894b">mfem::Operator::MultTranspose</a></div><div class="ttdeci">virtual void MultTranspose(const Vector &amp;x, Vector &amp;y) const </div><div class="ttdoc">Action of the transpose operator: y=A^t(x). The default behavior in class Operator is to generate an ...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00094">operator.hpp:94</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ae17b1734b2b2bbbc3b13810f90f3f398"><div class="ttname"><a href="classmfem_1_1Operator.html#ae17b1734b2b2bbbc3b13810f90f3f398">mfem::Operator::FormRectangularConstrainedSystemOperator</a></div><div class="ttdeci">void FormRectangularConstrainedSystemOperator(const Array&lt; int &gt; &amp;trial_tdof_list, const Array&lt; int &gt; &amp;test_tdof_list, RectangularConstrainedOperator *&amp;Aout)</div><div class="ttdoc">see FormRectangularSystemOperator() </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00147">operator.cpp:147</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a1402cc5891e8b666019ccca1b17d11a2"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a1402cc5891e8b666019ccca1b17d11a2">mfem::RectangularConstrainedOperator::test_constraints</a></div><div class="ttdeci">Array&lt; int &gt; test_constraints</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00914">operator.hpp:914</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_a4303d50b04590a0e6afc890cec18f58d"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#a4303d50b04590a0e6afc890cec18f58d">mfem::TimeDependentOperator::SUNImplicitSolve</a></div><div class="ttdeci">virtual int SUNImplicitSolve(const Vector &amp;b, Vector &amp;x, double tol)</div><div class="ttdoc">Solve the ODE linear system  as setup by the method SUNImplicitSetup(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00264">operator.cpp:264</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_abd2e462cdf596d10c5fba154a1a59a72"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#abd2e462cdf596d10c5fba154a1a59a72">mfem::TimeDependentOperator::ExplicitMult</a></div><div class="ttdeci">virtual void ExplicitMult(const Vector &amp;x, Vector &amp;y) const </div><div class="ttdoc">Perform the action of the explicit part of the operator, G: y = G(x, t) where t is the current time...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00219">operator.cpp:219</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a059ebb07070744a542a6fec3ea04a84b"><div class="ttname"><a href="classmfem_1_1Operator.html#a059ebb07070744a542a6fec3ea04a84b">mfem::Operator::FormRectangularLinearSystem</a></div><div class="ttdeci">void FormRectangularLinearSystem(const Array&lt; int &gt; &amp;trial_tdof_list, const Array&lt; int &gt; &amp;test_tdof_list, Vector &amp;x, Vector &amp;b, Operator *&amp;A, Vector &amp;X, Vector &amp;B)</div><div class="ttdoc">Form a column-constrained linear system using a matrix-free approach. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00068">operator.cpp:68</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a84b566f740fe45068a8b54f595aa3b4e"><div class="ttname"><a href="classmfem_1_1Operator.html#a84b566f740fe45068a8b54f595aa3b4e">mfem::Operator::GetProlongation</a></div><div class="ttdeci">virtual const Operator * GetProlongation() const </div><div class="ttdoc">Prolongation operator from linear algebra (linear system) vectors, to input vectors for the operator...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00116">operator.hpp:116</a></div></div>
<div class="ttc" id="classmfem_1_1ProductOperator_html"><div class="ttname"><a href="classmfem_1_1ProductOperator.html">mfem::ProductOperator</a></div><div class="ttdoc">General product operator: x -&amp;gt; (A*B)(x) = A(B(x)). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00747">operator.hpp:747</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a99d91417c9690ac2c8fe708b7b52f789"><div class="ttname"><a href="classmfem_1_1Operator.html#a99d91417c9690ac2c8fe708b7b52f789">mfem::Operator::GetMemoryClass</a></div><div class="ttdeci">virtual MemoryClass GetMemoryClass() const </div><div class="ttdoc">Return the MemoryClass preferred by the Operator. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00087">operator.hpp:87</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_afbea58230a3ed2a23908cab4551ff583"><div class="ttname"><a href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">mfem::Operator::Height</a></div><div class="ttdeci">int Height() const </div><div class="ttdoc">Get the height (size of output) of the Operator. Synonym with NumRows(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00067">operator.hpp:67</a></div></div>
<div class="ttc" id="classmfem_1_1Device_html_abd8048091a97559d782a9d069ee1e53c"><div class="ttname"><a href="classmfem_1_1Device.html#abd8048091a97559d782a9d069ee1e53c">mfem::Device::GetDeviceMemoryClass</a></div><div class="ttdeci">static MemoryClass GetDeviceMemoryClass()</div><div class="ttdoc">Get the current Device MemoryClass. This is the MemoryClass used by most MFEM device kernels to acces...</div><div class="ttdef"><b>Definition:</b> <a href="device_8hpp_source.html#l00281">device.hpp:281</a></div></div>
<div class="ttc" id="namespacemfem_html_abd1b6105cb4110752ec41c956c18d198"><div class="ttname"><a href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem::mfem_error</a></div><div class="ttdeci">void mfem_error(const char *msg)</div><div class="ttdoc">Function called when an error is encountered. Used by the macros MFEM_ABORT, MFEM_ASSERT, MFEM_VERIFY. </div><div class="ttdef"><b>Definition:</b> <a href="error_8cpp_source.html#l00154">error.cpp:154</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a0e93d5e7be66d3d54bfeb26e8f2d2c74"><div class="ttname"><a href="classmfem_1_1Operator.html#a0e93d5e7be66d3d54bfeb26e8f2d2c74">mfem::Operator::FormConstrainedSystemOperator</a></div><div class="ttdeci">void FormConstrainedSystemOperator(const Array&lt; int &gt; &amp;ess_tdof_list, ConstrainedOperator *&amp;Aout)</div><div class="ttdoc">see FormSystemOperator() </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00134">operator.cpp:134</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00042">lissajous.cpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html"><div class="ttname"><a href="classmfem_1_1Array.html">mfem::Array&lt; int &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_a7c10a565ad546c610fd0cf01260a572f"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#a7c10a565ad546c610fd0cf01260a572f">mfem::TimeDependentOperator::SUNMassSetup</a></div><div class="ttdeci">virtual int SUNMassSetup()</div><div class="ttdoc">Setup the mass matrix in the ODE system  . </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00270">operator.cpp:270</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a32fe7d5d0768b3b35ef597a32171d370"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a32fe7d5d0768b3b35ef597a32171d370">mfem::RectangularConstrainedOperator::z</a></div><div class="ttdeci">Vector z</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00917">operator.hpp:917</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_ac028b17fccf6cf2a6ef9ef6b9b47a912"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#ac028b17fccf6cf2a6ef9ef6b9b47a912">mfem::ConstrainedOperator::mem_class</a></div><div class="ttdeci">MemoryClass mem_class</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00852">operator.hpp:852</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a36c78fb2a325fa53845d64a4ae91202d"><div class="ttname"><a href="classmfem_1_1Array.html#a36c78fb2a325fa53845d64a4ae91202d">mfem::Array::Read</a></div><div class="ttdeci">const T * Read(bool on_dev=true) const </div><div class="ttdoc">Shortcut for mfem::Read(a.GetMemory(), a.Size(), on_dev). </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00304">array.hpp:304</a></div></div>
<div class="ttc" id="classmfem_1_1RAPOperator_html"><div class="ttname"><a href="classmfem_1_1RAPOperator.html">mfem::RAPOperator</a></div><div class="ttdoc">The operator x -&amp;gt; R*A*P*x constructed through the actions of R^T, A and P. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00767">operator.hpp:767</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a94dd5e9aa594262d3ecd641dea764150"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a94dd5e9aa594262d3ecd641dea764150">mfem::RectangularConstrainedOperator::MultTranspose</a></div><div class="ttdeci">virtual void MultTranspose(const Vector &amp;x, Vector &amp;y) const </div><div class="ttdoc">Action of the transpose operator: y=A^t(x). The default behavior in class Operator is to generate an ...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00603">operator.cpp:603</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a0ee61333333244753c73e76ce65f139d"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a0ee61333333244753c73e76ce65f139d">mfem::RectangularConstrainedOperator::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const </div><div class="ttdoc">Rectangular-constrained operator action. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00575">operator.cpp:575</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a7f3e99434bf268ccbaae6863fe5e6bb5a3aa9b65b076574e05157430abf4b76e2"><div class="ttname"><a href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5a3aa9b65b076574e05157430abf4b76e2">mfem::Operator::DIAG_ONE</a></div><div class="ttdoc">Set the diagonal value to one. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00050">operator.hpp:50</a></div></div>
<div class="ttc" id="classmfem_1_1RAPOperator_html_a769d421be3becf733685ec2ee673e02e"><div class="ttname"><a href="classmfem_1_1RAPOperator.html#a769d421be3becf733685ec2ee673e02e">mfem::RAPOperator::RAPOperator</a></div><div class="ttdeci">RAPOperator(const Operator &amp;Rt_, const Operator &amp;A_, const Operator &amp;P_)</div><div class="ttdoc">Construct the RAP operator given R^T, A and P. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00332">operator.cpp:332</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a79aca30fcf346fe6057ec409d0b1461d"><div class="ttname"><a href="classmfem_1_1Operator.html#a79aca30fcf346fe6057ec409d0b1461d">mfem::Operator::GetRestriction</a></div><div class="ttdeci">virtual const Operator * GetRestriction() const </div><div class="ttdoc">Restriction operator from input vectors for the operator to linear algebra (linear system) vectors...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00119">operator.hpp:119</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_a59d5de869d41deae20269ae4b697065a"><div class="ttname"><a href="classmfem_1_1Vector.html#a59d5de869d41deae20269ae4b697065a">mfem::Vector::SyncMemory</a></div><div class="ttdeci">void SyncMemory(const Vector &amp;v) const </div><div class="ttdoc">Update the memory location of the vector to match v. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00242">vector.hpp:242</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_aab941790a2f15dd6dafcba2446078599"><div class="ttname"><a href="classmfem_1_1Vector.html#aab941790a2f15dd6dafcba2446078599">mfem::Vector::SetSubVectorComplement</a></div><div class="ttdeci">void SetSubVectorComplement(const Array&lt; int &gt; &amp;dofs, const double val)</div><div class="ttdoc">Set all vector entries NOT in the dofs Array to the given val. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8cpp_source.html#l00708">vector.cpp:708</a></div></div>
<div class="ttc" id="namespacemfem_html_a7c6a603b8553000d256e9398ac65aec2"><div class="ttname"><a href="namespacemfem.html#a7c6a603b8553000d256e9398ac65aec2">mfem::IsIdentityProlongation</a></div><div class="ttdeci">bool IsIdentityProlongation(const Operator *P)</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00693">operator.hpp:693</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a3c8be428f6d1702a70250cbdda32e502"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a3c8be428f6d1702a70250cbdda32e502">mfem::RectangularConstrainedOperator::trial_constraints</a></div><div class="ttdeci">Array&lt; int &gt; trial_constraints</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00914">operator.hpp:914</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_aed2af294d6f808d90cfa5f42fbc7d833"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#aed2af294d6f808d90cfa5f42fbc7d833">mfem::TimeDependentOperator::SUNMassSolve</a></div><div class="ttdeci">virtual int SUNMassSolve(const Vector &amp;b, Vector &amp;x, double tol)</div><div class="ttdoc">Solve the mass matrix linear system  as setup by the method SUNMassSetup(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00276">operator.cpp:276</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_aae82923af0810282546d6ed093801e0e"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#aae82923af0810282546d6ed093801e0e">mfem::ConstrainedOperator::w</a></div><div class="ttdeci">Vector w</div><div class="ttdoc">Auxiliary vectors. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00851">operator.hpp:851</a></div></div>
<div class="ttc" id="namespacemfem_html_adb01975babc73b14adfe02bf6a7c77f6"><div class="ttname"><a href="namespacemfem.html#adb01975babc73b14adfe02bf6a7c77f6">mfem::MemoryType</a></div><div class="ttdeci">MemoryType</div><div class="ttdoc">Memory types supported by MFEM. </div><div class="ttdef"><b>Definition:</b> <a href="mem__manager_8hpp_source.html#l00031">mem_manager.hpp:31</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_af05141bf6d86d28444889d58216dc7ed"><div class="ttname"><a href="classmfem_1_1Operator.html#af05141bf6d86d28444889d58216dc7ed">mfem::Operator::InitTVectors</a></div><div class="ttdeci">void InitTVectors(const Operator *Po, const Operator *Ri, const Operator *Pi, Vector &amp;x, Vector &amp;b, Vector &amp;X, Vector &amp;B) const </div><div class="ttdoc">Initializes memory for true vectors of linear system. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00022">operator.cpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_ad8551121998316364eba6d7e5db0dfd6"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#ad8551121998316364eba6d7e5db0dfd6">mfem::TimeDependentOperator::GetImplicitGradient</a></div><div class="ttdeci">virtual Operator &amp; GetImplicitGradient(const Vector &amp;x, const Vector &amp;k, double shift) const </div><div class="ttdoc">Return an Operator representing (dF/dk shift + dF/dx) at the given x, k, and the currently set time...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00241">operator.cpp:241</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a110b300f31b8142d809fc32a37b1547e"><div class="ttname"><a href="classmfem_1_1Operator.html#a110b300f31b8142d809fc32a37b1547e">mfem::Operator::FormLinearSystem</a></div><div class="ttdeci">void FormLinearSystem(const Array&lt; int &gt; &amp;ess_tdof_list, Vector &amp;x, Vector &amp;b, Operator *&amp;A, Vector &amp;X, Vector &amp;B, int copy_interior=0)</div><div class="ttdoc">Form a constrained linear system using a matrix-free approach. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00051">operator.cpp:51</a></div></div>
<div class="ttc" id="classmfem_1_1TransposeOperator_html"><div class="ttname"><a href="classmfem_1_1TransposeOperator.html">mfem::TransposeOperator</a></div><div class="ttdoc">The transpose of a given operator. Switches the roles of the methods Mult() and MultTranspose(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00722">operator.hpp:722</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_abad756b327262545c350d7280cc22643"><div class="ttname"><a href="classmfem_1_1Operator.html#abad756b327262545c350d7280cc22643">mfem::Operator::RecoverFEMSolution</a></div><div class="ttdeci">virtual void RecoverFEMSolution(const Vector &amp;X, const Vector &amp;b, Vector &amp;x)</div><div class="ttdoc">Reconstruct a solution vector x (e.g. a GridFunction) from the solution X of a constrained linear sys...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00085">operator.cpp:85</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a62d74ad697f481c1e139404ca892afa6"><div class="ttname"><a href="classmfem_1_1Operator.html#a62d74ad697f481c1e139404ca892afa6">mfem::Operator::height</a></div><div class="ttdeci">int height</div><div class="ttdoc">Dimension of the output / number of rows in the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00027">operator.hpp:27</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_aeb1b46d7d1f8f03c0ced4a89c5587e2f"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#aeb1b46d7d1f8f03c0ced4a89c5587e2f">mfem::TimeDependentOperator::ImplicitMult</a></div><div class="ttdeci">virtual void ImplicitMult(const Vector &amp;x, const Vector &amp;k, Vector &amp;y) const </div><div class="ttdoc">Perform the action of the implicit part of the operator, F: y = F(x, k, t) where t is the current tim...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00224">operator.cpp:224</a></div></div>
<div class="ttc" id="namespacemfem_html_a2d8adc02f62bd3c762aecc66f0fd5772"><div class="ttname"><a href="namespacemfem.html#a2d8adc02f62bd3c762aecc66f0fd5772">mfem::InnerProduct</a></div><div class="ttdeci">double InnerProduct(HypreParVector *x, HypreParVector *y)</div><div class="ttdef"><b>Definition:</b> <a href="hypre_8cpp_source.html#l00413">hypre.cpp:413</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_ac68643baf361843877968cc1ba2f1735"><div class="ttname"><a href="classmfem_1_1Vector.html#ac68643baf361843877968cc1ba2f1735">mfem::Vector::ReadWrite</a></div><div class="ttdeci">virtual double * ReadWrite(bool on_dev=true)</div><div class="ttdoc">Shortcut for mfem::ReadWrite(vec.GetMemory(), vec.Size(), on_dev). </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00465">vector.hpp:465</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html">mfem::RectangularConstrainedOperator</a></div><div class="ttdoc">Rectangular Operator for imposing essential boundary conditions on the input space using only the act...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00911">operator.hpp:911</a></div></div>
<div class="ttc" id="vector_8hpp_html"><div class="ttname"><a href="vector_8hpp.html">vector.hpp</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a241b3c491eb58783bdbb3daf01cc2ab6"><div class="ttname"><a href="classmfem_1_1Operator.html#a241b3c491eb58783bdbb3daf01cc2ab6">mfem::Operator::AssembleDiagonal</a></div><div class="ttdeci">virtual void AssembleDiagonal(Vector &amp;diag) const </div><div class="ttdoc">Computes the diagonal entries into diag. Typically, this operation only makes sense for linear Operat...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00108">operator.hpp:108</a></div></div>
<div class="ttc" id="classmfem_1_1TripleProductOperator_html_a9669d9b6f86dbc467f07ab084392a9bc"><div class="ttname"><a href="classmfem_1_1TripleProductOperator.html#a9669d9b6f86dbc467f07ab084392a9bc">mfem::TripleProductOperator::~TripleProductOperator</a></div><div class="ttdeci">virtual ~TripleProductOperator()</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00402">operator.cpp:402</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a5a9eee45416d1b38ab41d4b4ff846326"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a5a9eee45416d1b38ab41d4b4ff846326">mfem::ConstrainedOperator::EliminateRHS</a></div><div class="ttdeci">void EliminateRHS(const Vector &amp;x, Vector &amp;b) const </div><div class="ttdoc">Eliminate &amp;quot;essential boundary condition&amp;quot; values specified in x from the given right-hand side b...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00457">operator.cpp:457</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a7f3e99434bf268ccbaae6863fe5e6bb5acef0ffcbba7e9a349433b39fda7f9373"><div class="ttname"><a href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5acef0ffcbba7e9a349433b39fda7f9373">mfem::Operator::DIAG_KEEP</a></div><div class="ttdoc">Keep the diagonal value. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00051">operator.hpp:51</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a22c2496db1f13189e4c915627c12d94a"><div class="ttname"><a href="classmfem_1_1Operator.html#a22c2496db1f13189e4c915627c12d94a">mfem::Operator::FormSystemOperator</a></div><div class="ttdeci">void FormSystemOperator(const Array&lt; int &gt; &amp;ess_tdof_list, Operator *&amp;A)</div><div class="ttdoc">Return in A a parallel (on truedofs) version of this square operator. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00164">operator.cpp:164</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a7f3e99434bf268ccbaae6863fe5e6bb5"><div class="ttname"><a href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5">mfem::Operator::DiagonalPolicy</a></div><div class="ttdeci">DiagonalPolicy</div><div class="ttdoc">Defines operator diagonal policy upon elimination of rows and/or columns. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00047">operator.hpp:47</a></div></div>
<div class="ttc" id="classmfem_1_1TripleProductOperator_html"><div class="ttname"><a href="classmfem_1_1TripleProductOperator.html">mfem::TripleProductOperator</a></div><div class="ttdoc">General triple product operator x -&amp;gt; A*B*C*x, with ownership of the factors. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00811">operator.hpp:811</a></div></div>
<div class="ttc" id="namespacemfem_html_a76ab5f9d46bb5419fb8f1b65ab307b45"><div class="ttname"><a href="namespacemfem.html#a76ab5f9d46bb5419fb8f1b65ab307b45">mfem::GetMemoryType</a></div><div class="ttdeci">MemoryType GetMemoryType(MemoryClass mc)</div><div class="ttdoc">Return a suitable MemoryType for a given MemoryClass. </div><div class="ttdef"><b>Definition:</b> <a href="mem__manager_8cpp_source.html#l00055">mem_manager.cpp:55</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_ae1d4a78f19ecfac318d6733589e4d5d5"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#ae1d4a78f19ecfac318d6733589e4d5d5">mfem::TimeDependentOperator::SUNImplicitSetup</a></div><div class="ttdeci">virtual int SUNImplicitSetup(const Vector &amp;x, const Vector &amp;fx, int jok, int *jcur, double gamma)</div><div class="ttdoc">Setup the ODE linear system  or , where . </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00256">operator.cpp:256</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_ac1ae0abebb9788d39366a8d2f5c178e5"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#ac1ae0abebb9788d39366a8d2f5c178e5">mfem::TimeDependentOperator::Mult</a></div><div class="ttdeci">virtual void Mult(const Vector &amp;x, Vector &amp;y) const </div><div class="ttdoc">Perform the action of the operator: y = k = f(x, t), where k solves the algebraic equation F(x...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00230">operator.cpp:230</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a04e7c6af8b1cdfe1953c0855a534a31b"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a04e7c6af8b1cdfe1953c0855a534a31b">mfem::ConstrainedOperator::z</a></div><div class="ttdeci">Vector z</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00851">operator.hpp:851</a></div></div>
<div class="ttc" id="classmfem_1_1TripleProductOperator_html_a887858500b819b83dbc16fe9c9cf555f"><div class="ttname"><a href="classmfem_1_1TripleProductOperator.html#a887858500b819b83dbc16fe9c9cf555f">mfem::TripleProductOperator::TripleProductOperator</a></div><div class="ttdeci">TripleProductOperator(const Operator *A, const Operator *B, const Operator *C, bool ownA, bool ownB, bool ownC)</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00366">operator.cpp:366</a></div></div>
<div class="ttc" id="classmfem_1_1TimeDependentOperator_html_a603fa10f2f5d0508b164b93f322ff7d6"><div class="ttname"><a href="classmfem_1_1TimeDependentOperator.html#a603fa10f2f5d0508b164b93f322ff7d6">mfem::TimeDependentOperator::SUNMassMult</a></div><div class="ttdeci">virtual int SUNMassMult(const Vector &amp;x, Vector &amp;v)</div><div class="ttdoc">Compute the mass matrix-vector product  . </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00282">operator.cpp:282</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a4ade1793b4efc7060337795f07ab28c9"><div class="ttname"><a href="classmfem_1_1Operator.html#a4ade1793b4efc7060337795f07ab28c9">mfem::Operator::PrintMatlab</a></div><div class="ttdeci">void PrintMatlab(std::ostream &amp;out, int n, int m=0) const </div><div class="ttdoc">Prints operator with input size n and output size m in Matlab format. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00188">operator.cpp:188</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ab860076188a32acbd2f1a7d428aba00d"><div class="ttname"><a href="classmfem_1_1Operator.html#ab860076188a32acbd2f1a7d428aba00d">mfem::Operator::SetupRAP</a></div><div class="ttdeci">Operator * SetupRAP(const Operator *Pi, const Operator *Po)</div><div class="ttdoc">Returns RAP Operator of this, using input/output Prolongation matrices Pi corresponds to &amp;quot;P&amp;quot;...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00105">operator.cpp:105</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a7f0770ecb717feb309f278800f65a416"><div class="ttname"><a href="classmfem_1_1Array.html#a7f0770ecb717feb309f278800f65a416">mfem::Array::MakeRef</a></div><div class="ttdeci">void MakeRef(T *, int)</div><div class="ttdoc">Make this Array a reference to a pointer. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00864">array.hpp:864</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html"><div class="ttname"><a href="classmfem_1_1Vector.html">mfem::Vector</a></div><div class="ttdoc">Vector data type. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00060">vector.hpp:60</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_af4f29f4223296c6c07500ff7428309ba"><div class="ttname"><a href="classmfem_1_1Vector.html#af4f29f4223296c6c07500ff7428309ba">mfem::Vector::MakeRef</a></div><div class="ttdeci">void MakeRef(Vector &amp;base, int offset, int size)</div><div class="ttdoc">Reset the Vector to be a reference to a sub-vector of base. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00577">vector.hpp:577</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a9d771af745d54b54e82b23a3d983f910"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a9d771af745d54b54e82b23a3d983f910">mfem::ConstrainedOperator::diag_policy</a></div><div class="ttdeci">DiagonalPolicy diag_policy</div><div class="ttdoc">Diagonal policy for constrained dofs. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00853">operator.hpp:853</a></div></div>
<div class="ttc" id="classmfem_1_1Solver_html"><div class="ttname"><a href="classmfem_1_1Solver.html">mfem::Solver</a></div><div class="ttdoc">Base class for solvers. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00655">operator.hpp:655</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html_a415607249084d6206f6e5b70991b2b8a"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html#a415607249084d6206f6e5b70991b2b8a">mfem::ConstrainedOperator::A</a></div><div class="ttdeci">Operator * A</div><div class="ttdoc">The unconstrained Operator. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00849">operator.hpp:849</a></div></div>
<div class="ttc" id="classmfem_1_1ConstrainedOperator_html"><div class="ttname"><a href="classmfem_1_1ConstrainedOperator.html">mfem::ConstrainedOperator</a></div><div class="ttdoc">Square Operator for imposing essential boundary conditions using only the action, Mult()...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00845">operator.hpp:845</a></div></div>
<div class="ttc" id="classmfem_1_1PowerMethod_html_a6713b65f7951c894f29b3ff5f17f4377"><div class="ttname"><a href="classmfem_1_1PowerMethod.html#a6713b65f7951c894f29b3ff5f17f4377">mfem::PowerMethod::EstimateLargestEigenvalue</a></div><div class="ttdeci">double EstimateLargestEigenvalue(Operator &amp;opr, Vector &amp;v0, int numSteps=10, double tolerance=1e-8, int seed=12345)</div><div class="ttdoc">Returns an estimate of the largest eigenvalue of the operator opr using the iterative power method...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00632">operator.cpp:632</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html"><div class="ttname"><a href="classmfem_1_1Operator.html">mfem::Operator</a></div><div class="ttdoc">Abstract operator. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00024">operator.hpp:24</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_aca242c6173b3353c23213bc891162f6e"><div class="ttname"><a href="classmfem_1_1Vector.html#aca242c6173b3353c23213bc891162f6e">mfem::Vector::Read</a></div><div class="ttdeci">virtual const double * Read(bool on_dev=true) const </div><div class="ttdoc">Shortcut for mfem::Read(vec.GetMemory(), vec.Size(), on_dev). </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00449">vector.hpp:449</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a7f3e99434bf268ccbaae6863fe5e6bb5aff3f5ed6e5c730828cd33f138ec3ada1"><div class="ttname"><a href="classmfem_1_1Operator.html#a7f3e99434bf268ccbaae6863fe5e6bb5aff3f5ed6e5c730828cd33f138ec3ada1">mfem::Operator::DIAG_ZERO</a></div><div class="ttdoc">Set the diagonal value to zero. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00049">operator.hpp:49</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a19823327e636510bfcd9f8c5e4bf48fa"><div class="ttname"><a href="classmfem_1_1Operator.html#a19823327e636510bfcd9f8c5e4bf48fa">mfem::Operator::width</a></div><div class="ttdeci">int width</div><div class="ttdoc">Dimension of the input / number of columns in the matrix. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00028">operator.hpp:28</a></div></div>
<div class="ttc" id="classmfem_1_1RectangularConstrainedOperator_html_a099439bf8bf7dd0f685f3d113083e917"><div class="ttname"><a href="classmfem_1_1RectangularConstrainedOperator.html#a099439bf8bf7dd0f685f3d113083e917">mfem::RectangularConstrainedOperator::RectangularConstrainedOperator</a></div><div class="ttdeci">RectangularConstrainedOperator(Operator *A, const Array&lt; int &gt; &amp;trial_list, const Array&lt; int &gt; &amp;test_list, bool own_A=false)</div><div class="ttdoc">Constructor from a general Operator and a list of essential indices/dofs. </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8cpp_source.html#l00531">operator.cpp:531</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ad595ad2ea6e806fafa14141b4591b98f"><div class="ttname"><a href="classmfem_1_1Operator.html#ad595ad2ea6e806fafa14141b4591b98f">mfem::Operator::GetOutputRestriction</a></div><div class="ttdeci">virtual const Operator * GetOutputRestriction() const </div><div class="ttdoc">Restriction operator from output vectors for the operator to linear algebra (linear system) vectors...</div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00133">operator.hpp:133</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 7 2022 10:41:47 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
