<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MFEM: nurbs.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v2.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_22e7892454e350ae265aec98296a27f7.html">mfem</a>      </li>
      <li class="navelem"><a class="el" href="dir_d28a5d018614a7d4a6235264984fd359.html">mesh</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">nurbs.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="nurbs_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (c) 2010, Lawrence Livermore National Security, LLC. Produced at</span>
<a name="l00002"></a>00002 <span class="comment">// the Lawrence Livermore National Laboratory. LLNL-CODE-443211. All Rights</span>
<a name="l00003"></a>00003 <span class="comment">// reserved. See file COPYRIGHT for details.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This file is part of the MFEM library. For more information and source code</span>
<a name="l00006"></a>00006 <span class="comment">// availability see http://mfem.googlecode.com.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span>
<a name="l00009"></a>00009 <span class="comment">// terms of the GNU Lesser General Public License (as published by the Free</span>
<a name="l00010"></a>00010 <span class="comment">// Software Foundation) version 2.1 dated February 1999.</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;../fem/fem.hpp&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">KnotVector::MaxOrder</a> = 10;
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="classKnotVector.html#a71d04e08558c9361227a07c517691ec4">00017</a> <a class="code" href="classKnotVector.html#a422bb29b158e8d25645de4217008577b" title="Create KnotVector.">KnotVector::KnotVector</a>(istream &amp;input)
<a name="l00018"></a>00018 {
<a name="l00019"></a>00019    input &gt;&gt; <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> &gt;&gt; <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a>;
<a name="l00020"></a>00020    <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#ab81369435143fa2e5898c36542fffee2" title="Reads a vector from multpile files.">Load</a>(input, NumOfControlPoints + <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> + 1);
<a name="l00021"></a>00021    <a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">GetElements</a>();
<a name="l00022"></a>00022 }
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="classKnotVector.html#a3803d4a34a547596edc2e2ae0faff4db">00024</a> <a class="code" href="classKnotVector.html#a422bb29b158e8d25645de4217008577b" title="Create KnotVector.">KnotVector::KnotVector</a>(<span class="keywordtype">int</span> Order_, <span class="keywordtype">int</span> NCP)
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026    <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> = Order_;
<a name="l00027"></a>00027    <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> = NCP;
<a name="l00028"></a>00028    <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> + <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> + 1);
<a name="l00029"></a>00029 
<a name="l00030"></a>00030    <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a> = -1.;
<a name="l00031"></a>00031 }
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="classKnotVector.html#aad65afe457b0c309c4c50f88f594127f">00033</a> <a class="code" href="classKnotVector.html">KnotVector</a> &amp;<a class="code" href="classKnotVector.html#aad65afe457b0c309c4c50f88f594127f">KnotVector::operator=</a>(<span class="keyword">const</span> <a class="code" href="classKnotVector.html">KnotVector</a> &amp;kv)
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035    <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> = kv.<a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>;
<a name="l00036"></a>00036    <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> = kv.<a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a>;
<a name="l00037"></a>00037    <a class="code" href="classKnotVector.html#a39d2630542bd6e0c5c339ecadaac1f88">NumOfElements</a> = kv.<a class="code" href="classKnotVector.html#a39d2630542bd6e0c5c339ecadaac1f88">NumOfElements</a>;
<a name="l00038"></a>00038    <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a> = kv.<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>;
<a name="l00039"></a>00039    <span class="comment">// alternatively, re-compute NumOfElements</span>
<a name="l00040"></a>00040    <span class="comment">// GetElements();</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classKnotVector.html#a49af64a9d2f6514ec718e7c9b1a891c2">00045</a> <a class="code" href="classKnotVector.html">KnotVector</a> *<a class="code" href="classKnotVector.html#a49af64a9d2f6514ec718e7c9b1a891c2">KnotVector::DegreeElevate</a>(<span class="keywordtype">int</span> t)<span class="keyword"> const</span>
<a name="l00046"></a>00046 <span class="keyword"></span>{
<a name="l00047"></a>00047    <span class="keywordflow">if</span> (t &lt; 0)
<a name="l00048"></a>00048       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;KnotVector::DegreeElevate :\n&quot;</span>
<a name="l00049"></a>00049                  <span class="stringliteral">&quot; Parent KnotVector order higher than child&quot;</span>);
<a name="l00050"></a>00050 
<a name="l00051"></a>00051    <span class="keywordtype">int</span> nOrder = <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> + t;
<a name="l00052"></a>00052    <a class="code" href="classKnotVector.html">KnotVector</a> *newkv = <span class="keyword">new</span> <a class="code" href="classKnotVector.html#a422bb29b158e8d25645de4217008577b" title="Create KnotVector.">KnotVector</a>(nOrder, <a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() + t);
<a name="l00053"></a>00053 
<a name="l00054"></a>00054    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= nOrder; i++)
<a name="l00055"></a>00055    {
<a name="l00056"></a>00056       (*newkv)[i] = <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(0);
<a name="l00057"></a>00057    }
<a name="l00058"></a>00058    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = nOrder + 1; i &lt; newkv-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>(); i++)
<a name="l00059"></a>00059    {
<a name="l00060"></a>00060       (*newkv)[i] = <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i - t);
<a name="l00061"></a>00061    }
<a name="l00062"></a>00062    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= nOrder; i++)
<a name="l00063"></a>00063    {
<a name="l00064"></a>00064       (*newkv)[newkv-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() + i] = <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>()-1);
<a name="l00065"></a>00065    }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067    newkv-&gt;<a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">GetElements</a>();
<a name="l00068"></a>00068 
<a name="l00069"></a>00069    <span class="keywordflow">return</span> newkv;
<a name="l00070"></a>00070 }
<a name="l00071"></a>00071 
<a name="l00072"></a><a class="code" href="classKnotVector.html#ae05a882fe687126ab580217c2504591f">00072</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#ae05a882fe687126ab580217c2504591f">KnotVector::UniformRefinement</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;newknots)<span class="keyword"> const</span>
<a name="l00073"></a>00073 <span class="keyword"></span>{
<a name="l00074"></a>00074    newknots.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classKnotVector.html#a39d2630542bd6e0c5c339ecadaac1f88">NumOfElements</a>);
<a name="l00075"></a>00075    <span class="keywordtype">int</span> j = 0;
<a name="l00076"></a>00076    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>()-1; i++)
<a name="l00077"></a>00077    {
<a name="l00078"></a>00078       <span class="keywordflow">if</span> (<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i) != <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i+1))
<a name="l00079"></a>00079       {
<a name="l00080"></a>00080          newknots(j) = 0.5*(<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i) + <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i+1));
<a name="l00081"></a>00081          j++;
<a name="l00082"></a>00082       }
<a name="l00083"></a>00083    }
<a name="l00084"></a>00084 }
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974">00086</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">KnotVector::GetElements</a>()
<a name="l00087"></a>00087 {
<a name="l00088"></a>00088    <a class="code" href="classKnotVector.html#a39d2630542bd6e0c5c339ecadaac1f88">NumOfElements</a> = 0;
<a name="l00089"></a>00089    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>; i &lt; <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a>; i++)
<a name="l00090"></a>00090    {
<a name="l00091"></a>00091       <span class="keywordflow">if</span> (<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i) != <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i+1))
<a name="l00092"></a>00092       {
<a name="l00093"></a>00093          <a class="code" href="classKnotVector.html#a39d2630542bd6e0c5c339ecadaac1f88">NumOfElements</a>++;
<a name="l00094"></a>00094       }
<a name="l00095"></a>00095    }
<a name="l00096"></a>00096 }
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="classKnotVector.html#a5b529d3ed9d6b1d480ad225cf9fced05">00098</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#a5b529d3ed9d6b1d480ad225cf9fced05">KnotVector::Flip</a>()
<a name="l00099"></a>00099 {
<a name="l00100"></a>00100    <span class="keywordtype">double</span> apb = <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(0) + <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>()-1);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102    <span class="keywordtype">int</span> ns = (<a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> - <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>)/2;
<a name="l00103"></a>00103    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= ns; i++)
<a name="l00104"></a>00104    {
<a name="l00105"></a>00105       <span class="keywordtype">double</span> tmp = apb - <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> + i);
<a name="l00106"></a>00106       <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> + i) = apb - <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> - i);
<a name="l00107"></a>00107       <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> - i) = tmp;
<a name="l00108"></a>00108    }
<a name="l00109"></a>00109 }
<a name="l00110"></a>00110 
<a name="l00111"></a><a class="code" href="classKnotVector.html#a5f4485da514c2305cdf3d3c2d1b76bd4">00111</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#a5f4485da514c2305cdf3d3c2d1b76bd4">KnotVector::Print</a>(ostream &amp;out)<span class="keyword"> const</span>
<a name="l00112"></a>00112 <span class="keyword"></span>{
<a name="l00113"></a>00113    out &lt;&lt; <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> &lt;&lt; <span class="charliteral">&#39; &#39;</span>;
<a name="l00114"></a>00114    <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#adf967646f20e7a903b856b859f38a15d" title="Prints vector to stream out.">Print</a>(out, <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>());
<a name="l00115"></a>00115 }
<a name="l00116"></a>00116 
<a name="l00117"></a>00117 <span class="comment">// Routine from &quot;The NURBS book&quot; - 2nd ed - Piegl and Tiller</span>
<a name="l00118"></a><a class="code" href="classKnotVector.html#ad88400f1a6cc8434f568966c31b08e2b">00118</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#ad88400f1a6cc8434f568966c31b08e2b">KnotVector::CalcShape</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape, <span class="keywordtype">int</span> i, <span class="keywordtype">double</span> xi)
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120    <span class="keywordtype">int</span>    p = <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>;
<a name="l00121"></a>00121    <span class="keywordtype">int</span>    ip = (i &gt;= 0) ? (i + p) : (-1 - i + p);
<a name="l00122"></a>00122    <span class="keywordtype">double</span> u = <a class="code" href="classKnotVector.html#ae00f3fcf4398344d0ad3786a0780796e">getKnotLocation</a>((i &gt;= 0) ? xi : 1. - xi, ip), saved, tmp;
<a name="l00123"></a>00123    <span class="keywordtype">double</span> left[<a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>+1], right[<a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>+1];
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00126"></a>00126 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (p &gt; <a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>)
<a name="l00127"></a>00127       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;KnotVector::CalcShape : Order &gt; MaxOrder!&quot;</span>);
<a name="l00128"></a>00128 <span class="preprocessor">#endif</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a>00130    shape(0) = 1.;
<a name="l00131"></a>00131    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt;= p; ++j)
<a name="l00132"></a>00132    {
<a name="l00133"></a>00133       left[j]  = u - <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip+1-j);
<a name="l00134"></a>00134       right[j] = <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip+j) - u;
<a name="l00135"></a>00135       saved    = 0.;
<a name="l00136"></a>00136       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; j; ++r)
<a name="l00137"></a>00137       {
<a name="l00138"></a>00138          tmp      = shape(r)/(right[r+1] + left[j-r]);
<a name="l00139"></a>00139          shape(r) = saved + right[r+1]*tmp;
<a name="l00140"></a>00140          saved    = left[j-r]*tmp;
<a name="l00141"></a>00141       }
<a name="l00142"></a>00142       shape(j) = saved;
<a name="l00143"></a>00143    }
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">// Routine from &quot;The NURBS book&quot; - 2nd ed - Piegl and Tiller</span>
<a name="l00147"></a><a class="code" href="classKnotVector.html#ad15d812f0c9366efe09739281a0c63e2">00147</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#ad15d812f0c9366efe09739281a0c63e2">KnotVector::CalcDShape</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;grad, <span class="keywordtype">int</span> i, <span class="keywordtype">double</span> xi)
<a name="l00148"></a>00148 {
<a name="l00149"></a>00149    <span class="keywordtype">int</span>    p = <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>, rk, pk;
<a name="l00150"></a>00150    <span class="keywordtype">int</span>    ip = (i &gt;= 0) ? (i + p) : (-1 - i + p);
<a name="l00151"></a>00151    <span class="keywordtype">double</span> u = <a class="code" href="classKnotVector.html#ae00f3fcf4398344d0ad3786a0780796e">getKnotLocation</a>((i &gt;= 0) ? xi : 1. - xi, ip), temp, saved, d;
<a name="l00152"></a>00152    <span class="keywordtype">double</span> ndu[<a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>+1][<a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>+1], left[<a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>+1], right[<a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>+1];
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00155"></a>00155 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (p &gt; <a class="code" href="classKnotVector.html#aed4fcbe8df5381b2c711a255c1594062">MaxOrder</a>)
<a name="l00156"></a>00156       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;KnotVector::CalcDShape : Order &gt; MaxOrder!&quot;</span>);
<a name="l00157"></a>00157 <span class="preprocessor">#endif</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>
<a name="l00159"></a>00159    ndu[0][0] = 1.0;
<a name="l00160"></a>00160    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt;= p; j++)
<a name="l00161"></a>00161    {
<a name="l00162"></a>00162       left[j] = u - <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip-j+1);
<a name="l00163"></a>00163       right[j] = <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip+j) - u;
<a name="l00164"></a>00164       saved = 0.0;
<a name="l00165"></a>00165       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; j; r++)
<a name="l00166"></a>00166       {
<a name="l00167"></a>00167          ndu[j][r] = right[r+1] + left[j-r];
<a name="l00168"></a>00168          temp = ndu[r][j-1]/ndu[j][r];
<a name="l00169"></a>00169          ndu[r][j] = saved + right[r+1]*temp;
<a name="l00170"></a>00170          saved = left[j-r]*temp;
<a name="l00171"></a>00171       }
<a name="l00172"></a>00172       ndu[j][j] = saved;
<a name="l00173"></a>00173    }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt;= p; ++r)
<a name="l00176"></a>00176    {
<a name="l00177"></a>00177       d = 0.0;
<a name="l00178"></a>00178       rk = r-1;
<a name="l00179"></a>00179       pk = p-1;
<a name="l00180"></a>00180       <span class="keywordflow">if</span> (r &gt;= 1)
<a name="l00181"></a>00181       {
<a name="l00182"></a>00182          d = ndu[rk][pk]/ndu[p][rk];
<a name="l00183"></a>00183       }
<a name="l00184"></a>00184       <span class="keywordflow">if</span> (r &lt;= pk)
<a name="l00185"></a>00185       {
<a name="l00186"></a>00186          d -= ndu[r][pk]/ndu[p][r];
<a name="l00187"></a>00187       }
<a name="l00188"></a>00188       grad(r) = d;
<a name="l00189"></a>00189    }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191    <span class="keywordflow">if</span> (i &gt;= 0)
<a name="l00192"></a>00192       grad *= p*(<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip+1) - <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip));
<a name="l00193"></a>00193    <span class="keywordflow">else</span>
<a name="l00194"></a>00194       grad *= p*(<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip) - <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(ip+1));
<a name="l00195"></a>00195 }
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="classKnotVector.html#a574c387d7428f66558e62c013a02f8bd">00197</a> <span class="keywordtype">int</span> <a class="code" href="classKnotVector.html#a574c387d7428f66558e62c013a02f8bd">KnotVector::findKnotSpan</a>(<span class="keywordtype">double</span> u)<span class="keyword"> const</span>
<a name="l00198"></a>00198 <span class="keyword"></span>{
<a name="l00199"></a>00199    <span class="keywordtype">int</span> low, mid, high;
<a name="l00200"></a>00200 
<a name="l00201"></a>00201    <span class="keywordflow">if</span> (u == <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(<a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a>+<a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>))
<a name="l00202"></a>00202    {
<a name="l00203"></a>00203       mid = <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a>;
<a name="l00204"></a>00204    }
<a name="l00205"></a>00205    <span class="keywordflow">else</span>
<a name="l00206"></a>00206    {
<a name="l00207"></a>00207       low = <a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a>;
<a name="l00208"></a>00208       high = <a class="code" href="classKnotVector.html#a872f6694ae498e707f973e06a40fb3c1">NumOfControlPoints</a> + 1;
<a name="l00209"></a>00209       mid = (low + high)/2;
<a name="l00210"></a>00210       <span class="keywordflow">while</span> ( (u &lt; <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(mid-1)) || (u &gt; <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(mid)) )
<a name="l00211"></a>00211       {
<a name="l00212"></a>00212          <span class="keywordflow">if</span> (u &lt; <a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(mid-1))
<a name="l00213"></a>00213          {
<a name="l00214"></a>00214             high = mid;
<a name="l00215"></a>00215          }
<a name="l00216"></a>00216          <span class="keywordflow">else</span>
<a name="l00217"></a>00217          {
<a name="l00218"></a>00218             low = mid;
<a name="l00219"></a>00219          }
<a name="l00220"></a>00220          mid = (low + high)/2;
<a name="l00221"></a>00221       }
<a name="l00222"></a>00222    }
<a name="l00223"></a>00223    <span class="keywordflow">return</span> mid;
<a name="l00224"></a>00224 }
<a name="l00225"></a>00225 
<a name="l00226"></a><a class="code" href="classKnotVector.html#ad5b64b74e9a6219663ad3f6543ff3b3d">00226</a> <span class="keywordtype">void</span> <a class="code" href="classKnotVector.html#ad5b64b74e9a6219663ad3f6543ff3b3d">KnotVector::Difference</a>(<span class="keyword">const</span> <a class="code" href="classKnotVector.html">KnotVector</a> &amp;kv, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;diff)<span class="keyword"> const</span>
<a name="l00227"></a>00227 <span class="keyword"></span>{
<a name="l00228"></a>00228    <span class="keywordflow">if</span> (<a class="code" href="classKnotVector.html#a7da25c59ee994e8f0390c2b1933ac200">Order</a> != kv.<a class="code" href="classKnotVector.html#aeaa6833a60235116e4ae653761dcbfde">GetOrder</a>())
<a name="l00229"></a>00229    {
<a name="l00230"></a>00230       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;KnotVector::Difference :\n&quot;</span>
<a name="l00231"></a>00231                  <span class="stringliteral">&quot; Can not compare knot vectors with different orders!&quot;</span>);
<a name="l00232"></a>00232    }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234    <span class="keywordtype">int</span> s = kv.<a class="code" href="classKnotVector.html#a04c4e14c5afbc938c996fd2eaf9cc95e">Size</a>() - <a class="code" href="classKnotVector.html#a04c4e14c5afbc938c996fd2eaf9cc95e">Size</a>();
<a name="l00235"></a>00235    <span class="keywordflow">if</span> (s &lt; 0)
<a name="l00236"></a>00236    {
<a name="l00237"></a>00237       kv.<a class="code" href="classKnotVector.html#ad5b64b74e9a6219663ad3f6543ff3b3d">Difference</a>(*<span class="keyword">this</span>, diff);
<a name="l00238"></a>00238       <span class="keywordflow">return</span>;
<a name="l00239"></a>00239    }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241    diff.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(s);
<a name="l00242"></a>00242 
<a name="l00243"></a>00243    s = 0;
<a name="l00244"></a>00244    <span class="keywordtype">int</span> i = 0;
<a name="l00245"></a>00245    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv.<a class="code" href="classKnotVector.html#a04c4e14c5afbc938c996fd2eaf9cc95e">Size</a>(); j++)
<a name="l00246"></a>00246    {
<a name="l00247"></a>00247       <span class="keywordflow">if</span> (<a class="code" href="classKnotVector.html#a7f30e183963a23505e5f218b1ec13ee7">knot</a>(i) == kv[j])
<a name="l00248"></a>00248       {
<a name="l00249"></a>00249          i++;
<a name="l00250"></a>00250       }
<a name="l00251"></a>00251       <span class="keywordflow">else</span>
<a name="l00252"></a>00252       {
<a name="l00253"></a>00253          diff(s) = kv[j];
<a name="l00254"></a>00254          s++;
<a name="l00255"></a>00255       }
<a name="l00256"></a>00256    }
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">00260</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">NURBSPatch::init</a>(<span class="keywordtype">int</span> dim_)
<a name="l00261"></a>00261 {
<a name="l00262"></a>00262    <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a> = dim_;
<a name="l00263"></a>00263    <a class="code" href="classNURBSPatch.html#a41a0652f02f3843f12b8ca659427571e">sd</a> = <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a> = -1;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 2)
<a name="l00266"></a>00266    {
<a name="l00267"></a>00267       <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a> = <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[0]-&gt;GetNCP();
<a name="l00268"></a>00268       <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a> = <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[1]-&gt;GetNCP();
<a name="l00269"></a>00269       <a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a> = -1;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271       <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>];
<a name="l00272"></a>00272 
<a name="l00273"></a>00273 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00274"></a>00274 <span class="preprocessor"></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>; i++)
<a name="l00275"></a>00275          <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[i] = -999.99;
<a name="l00276"></a>00276 <span class="preprocessor">#endif</span>
<a name="l00277"></a>00277 <span class="preprocessor"></span>   }
<a name="l00278"></a>00278    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 3)
<a name="l00279"></a>00279    {
<a name="l00280"></a>00280       <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a> = <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[0]-&gt;GetNCP();
<a name="l00281"></a>00281       <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a> = <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[1]-&gt;GetNCP();
<a name="l00282"></a>00282       <a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a> = <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[2]-&gt;GetNCP();
<a name="l00283"></a>00283 
<a name="l00284"></a>00284       <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>];
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00287"></a>00287 <span class="preprocessor"></span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>; i++)
<a name="l00288"></a>00288          <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[i] = -999.99;
<a name="l00289"></a>00289 <span class="preprocessor">#endif</span>
<a name="l00290"></a>00290 <span class="preprocessor"></span>   }
<a name="l00291"></a>00291    <span class="keywordflow">else</span>
<a name="l00292"></a>00292    {
<a name="l00293"></a>00293       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::init : Wrond dimension of knotvectors!&quot;</span>);
<a name="l00294"></a>00294    }
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a><a class="code" href="classNURBSPatch.html#affca655c8206dd167de6532c45064928">00297</a> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch::NURBSPatch</a>(istream &amp;input)
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299    <span class="keywordtype">int</span> pdim, dim, size = 1;
<a name="l00300"></a>00300    <span class="keywordtype">string</span> ident;
<a name="l00301"></a>00301 
<a name="l00302"></a>00302    input &gt;&gt; ws &gt;&gt; ident &gt;&gt; pdim; <span class="comment">// knotvectors</span>
<a name="l00303"></a>00303    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(pdim);
<a name="l00304"></a>00304    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pdim; i++)
<a name="l00305"></a>00305    {
<a name="l00306"></a>00306       <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(input);
<a name="l00307"></a>00307       size *= <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]-&gt;GetNCP();
<a name="l00308"></a>00308    }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    input &gt;&gt; ws &gt;&gt; ident &gt;&gt; dim; <span class="comment">// dimension</span>
<a name="l00311"></a>00311    <a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">init</a>(dim + 1);
<a name="l00312"></a>00312 
<a name="l00313"></a>00313    input &gt;&gt; ws &gt;&gt; ident; <span class="comment">// controlpoints (homogeneous coordinates)</span>
<a name="l00314"></a>00314    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0, i = 0; i &lt; size; i++)
<a name="l00315"></a>00315       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt;= dim; d++, j++)
<a name="l00316"></a>00316          input &gt;&gt; <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[j];
<a name="l00317"></a>00317 }
<a name="l00318"></a>00318 
<a name="l00319"></a><a class="code" href="classNURBSPatch.html#af1403b5e1282e2f544227919a9a4e3e1">00319</a> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch::NURBSPatch</a>(<a class="code" href="classKnotVector.html">KnotVector</a> *kv0, <a class="code" href="classKnotVector.html">KnotVector</a> *kv1, <span class="keywordtype">int</span> dim_)
<a name="l00320"></a>00320 {
<a name="l00321"></a>00321    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(2);
<a name="l00322"></a>00322    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[0] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*kv0);
<a name="l00323"></a>00323    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[1] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*kv1);
<a name="l00324"></a>00324    <a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">init</a>(dim_);
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="classNURBSPatch.html#abb7fa874e123ed00ed5b7323d72e572b">00327</a> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch::NURBSPatch</a>(<a class="code" href="classKnotVector.html">KnotVector</a> *kv0, <a class="code" href="classKnotVector.html">KnotVector</a> *kv1, <a class="code" href="classKnotVector.html">KnotVector</a> *kv2,
<a name="l00328"></a>00328                        <span class="keywordtype">int</span> dim_)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(3);
<a name="l00331"></a>00331    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[0] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*kv0);
<a name="l00332"></a>00332    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[1] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*kv1);
<a name="l00333"></a>00333    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[2] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*kv2);
<a name="l00334"></a>00334    <a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">init</a>(dim_);
<a name="l00335"></a>00335 }
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="classNURBSPatch.html#a3f197718d2ae66889705445cfa0ace1d">00337</a> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch::NURBSPatch</a>(<a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> &amp;kv_,  <span class="keywordtype">int</span> dim_)
<a name="l00338"></a>00338 {
<a name="l00339"></a>00339    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(kv_.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>());
<a name="l00340"></a>00340    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00341"></a>00341       <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*kv_[i]);
<a name="l00342"></a>00342    <a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">init</a>(dim_);
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">00345</a> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch::NURBSPatch</a>(<a class="code" href="classNURBSPatch.html">NURBSPatch</a> *parent, <span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> Order, <span class="keywordtype">int</span> NCP)
<a name="l00346"></a>00346 {
<a name="l00347"></a>00347    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(parent-&gt;<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>());
<a name="l00348"></a>00348    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00349"></a>00349       <span class="keywordflow">if</span> (i != dir)
<a name="l00350"></a>00350          <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*parent-&gt;<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]);
<a name="l00351"></a>00351       <span class="keywordflow">else</span>
<a name="l00352"></a>00352          <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(Order, NCP);
<a name="l00353"></a>00353    <a class="code" href="classNURBSPatch.html#a32b9f7a51a825b42a1386729e105bf5c">init</a>(parent-&gt;<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>);
<a name="l00354"></a>00354 }
<a name="l00355"></a>00355 
<a name="l00356"></a><a class="code" href="classNURBSPatch.html#ad8f2bbccb7534092ae678ea4f17a11a3">00356</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#ad8f2bbccb7534092ae678ea4f17a11a3">NURBSPatch::swap</a>(<a class="code" href="classNURBSPatch.html">NURBSPatch</a> *np)
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> != NULL)
<a name="l00359"></a>00359       <span class="keyword">delete</span> [] <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00362"></a>00362    {
<a name="l00363"></a>00363       <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]) <span class="keyword">delete</span> <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i];
<a name="l00364"></a>00364    }
<a name="l00365"></a>00365 
<a name="l00366"></a>00366    <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> = np-&gt;<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>;
<a name="l00367"></a>00367    np-&gt;<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>);
<a name="l00368"></a>00368 
<a name="l00369"></a>00369    <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>  = np-&gt;<a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>;
<a name="l00370"></a>00370    <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>  = np-&gt;<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>;
<a name="l00371"></a>00371    <a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>  = np-&gt;<a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>;
<a name="l00372"></a>00372    <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a> = np-&gt;<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00373"></a>00373 
<a name="l00374"></a>00374    np-&gt;<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> = NULL;
<a name="l00375"></a>00375    np-&gt;<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(0);
<a name="l00376"></a>00376 
<a name="l00377"></a>00377    <span class="keyword">delete</span> np;
<a name="l00378"></a>00378 }
<a name="l00379"></a>00379 
<a name="l00380"></a><a class="code" href="classNURBSPatch.html#a8290e55f11f5af3117bcd6c5c22a2665">00380</a> <a class="code" href="classNURBSPatch.html#a8290e55f11f5af3117bcd6c5c22a2665">NURBSPatch::~NURBSPatch</a>()
<a name="l00381"></a>00381 {
<a name="l00382"></a>00382    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> != NULL)
<a name="l00383"></a>00383       <span class="keyword">delete</span> [] <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>;
<a name="l00384"></a>00384 
<a name="l00385"></a>00385    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00386"></a>00386    {
<a name="l00387"></a>00387       <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]) <span class="keyword">delete</span> <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i];
<a name="l00388"></a>00388    }
<a name="l00389"></a>00389 }
<a name="l00390"></a>00390 
<a name="l00391"></a><a class="code" href="classNURBSPatch.html#a40c48de40ef7ff6d19b958b9e4335c65">00391</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a40c48de40ef7ff6d19b958b9e4335c65">NURBSPatch::Print</a>(ostream &amp;out)
<a name="l00392"></a>00392 {
<a name="l00393"></a>00393    <span class="keywordtype">int</span> size = 1;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395    out &lt;&lt; <span class="stringliteral">&quot;knotvectors\n&quot;</span> &lt;&lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00396"></a>00396    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00397"></a>00397    {
<a name="l00398"></a>00398       <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]-&gt;<a class="code" href="classArray.html#a2000e610a94979cdaeb0677b42370c0e" title="Prints array to stream with width elements per row.">Print</a>(out);
<a name="l00399"></a>00399       size *= <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]-&gt;GetNCP();
<a name="l00400"></a>00400    }
<a name="l00401"></a>00401 
<a name="l00402"></a>00402    out &lt;&lt; <span class="stringliteral">&quot;\ndimension\n&quot;</span> &lt;&lt; <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a> - 1
<a name="l00403"></a>00403        &lt;&lt; <span class="stringliteral">&quot;\n\ncontrolpoints\n&quot;</span>;
<a name="l00404"></a>00404    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0, i = 0; i &lt; size; i++)
<a name="l00405"></a>00405    {
<a name="l00406"></a>00406       out &lt;&lt; <a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[j++];
<a name="l00407"></a>00407       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 1; d &lt; <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>; d++)
<a name="l00408"></a>00408          out &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; data[j++];
<a name="l00409"></a>00409       out &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00410"></a>00410    }
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 
<a name="l00413"></a><a class="code" href="classNURBSPatch.html#a73e3ad7da378498c924c88012d2451e5">00413</a> <span class="keywordtype">int</span> <a class="code" href="classNURBSPatch.html#a73e3ad7da378498c924c88012d2451e5">NURBSPatch::SetLoopDirection</a>(<span class="keywordtype">int</span> dir)
<a name="l00414"></a>00414 {
<a name="l00415"></a>00415    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a> == -1)
<a name="l00416"></a>00416    {
<a name="l00417"></a>00417       <span class="keywordflow">if</span> (dir == 0)
<a name="l00418"></a>00418       {
<a name="l00419"></a>00419          <a class="code" href="classNURBSPatch.html#a41a0652f02f3843f12b8ca659427571e">sd</a> = <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00420"></a>00420          <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a> = <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422          <span class="keywordflow">return</span> <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00423"></a>00423       }
<a name="l00424"></a>00424       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == 1)
<a name="l00425"></a>00425       {
<a name="l00426"></a>00426          <a class="code" href="classNURBSPatch.html#a41a0652f02f3843f12b8ca659427571e">sd</a> = <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00427"></a>00427          <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a> = <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429          <span class="keywordflow">return</span> <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00430"></a>00430       }
<a name="l00431"></a>00431       <span class="keywordflow">else</span>
<a name="l00432"></a>00432       {
<a name="l00433"></a>00433          cerr &lt;&lt; <span class="stringliteral">&quot;NURBSPatch::SetLoopDirection :\n&quot;</span>
<a name="l00434"></a>00434             <span class="stringliteral">&quot; Direction error in 2D patch, dir = &quot;</span> &lt;&lt; dir &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00435"></a>00435          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00436"></a>00436       }
<a name="l00437"></a>00437    }
<a name="l00438"></a>00438    <span class="keywordflow">else</span>
<a name="l00439"></a>00439    {
<a name="l00440"></a>00440       <span class="keywordflow">if</span> (dir == 0)
<a name="l00441"></a>00441       {
<a name="l00442"></a>00442          <a class="code" href="classNURBSPatch.html#a41a0652f02f3843f12b8ca659427571e">sd</a> = <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00443"></a>00443          <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a> = <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445          <span class="keywordflow">return</span> <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00446"></a>00446       }
<a name="l00447"></a>00447       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == 1)
<a name="l00448"></a>00448       {
<a name="l00449"></a>00449          <a class="code" href="classNURBSPatch.html#a41a0652f02f3843f12b8ca659427571e">sd</a> = <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00450"></a>00450          <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a> = <a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>;
<a name="l00451"></a>00451 
<a name="l00452"></a>00452          <span class="keywordflow">return</span> <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00453"></a>00453       }
<a name="l00454"></a>00454       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == 2)
<a name="l00455"></a>00455       {
<a name="l00456"></a>00456          <a class="code" href="classNURBSPatch.html#a41a0652f02f3843f12b8ca659427571e">sd</a> = <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00457"></a>00457          <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a> = <a class="code" href="classNURBSPatch.html#aaffa9e3106af32ec041968529108cd9c">nk</a>;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459          <span class="keywordflow">return</span> <a class="code" href="classNURBSPatch.html#a070a84e4d47b8f124d1f754bc85fee37">ni</a>*<a class="code" href="classNURBSPatch.html#ab4487c6405122f7ff4277ca225c492b7">nj</a>*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00460"></a>00460       }
<a name="l00461"></a>00461       <span class="keywordflow">else</span>
<a name="l00462"></a>00462       {
<a name="l00463"></a>00463          cerr &lt;&lt; <span class="stringliteral">&quot;NURBSPatch::SetLoopDirection :\n&quot;</span>
<a name="l00464"></a>00464             <span class="stringliteral">&quot; Direction error in 3D patch, dir = &quot;</span> &lt;&lt; dir &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l00465"></a>00465          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00466"></a>00466       }
<a name="l00467"></a>00467    }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469    <span class="keywordflow">return</span> -1;
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a><a class="code" href="classNURBSPatch.html#abecdb4672666c8a5aef2de9e419c941a">00472</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#abecdb4672666c8a5aef2de9e419c941a">NURBSPatch::UniformRefinement</a>()
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> newknots;
<a name="l00475"></a>00475    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); dir++)
<a name="l00476"></a>00476    {
<a name="l00477"></a>00477       <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;UniformRefinement(newknots);
<a name="l00478"></a>00478       <a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(dir, newknots);
<a name="l00479"></a>00479    }
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 
<a name="l00482"></a><a class="code" href="classNURBSPatch.html#a3c355ec68b69156e8d902c20b7856e09">00482</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">NURBSPatch::KnotInsert</a>(<a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> &amp;newkv)
<a name="l00483"></a>00483 {
<a name="l00484"></a>00484    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); dir++)
<a name="l00485"></a>00485    {
<a name="l00486"></a>00486       <a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(dir, *newkv[dir]);
<a name="l00487"></a>00487    }
<a name="l00488"></a>00488 }
<a name="l00489"></a>00489 
<a name="l00490"></a><a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">00490</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">NURBSPatch::KnotInsert</a>(<span class="keywordtype">int</span> dir, <span class="keyword">const</span> <a class="code" href="classKnotVector.html">KnotVector</a> &amp;newkv)
<a name="l00491"></a>00491 {
<a name="l00492"></a>00492    <span class="keywordflow">if</span> (dir &gt;= <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() || dir &lt; 0)
<a name="l00493"></a>00493       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::KnotInsert : Incorrect direction!&quot;</span>);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495    <span class="keywordtype">int</span> t = newkv.<a class="code" href="classKnotVector.html#aeaa6833a60235116e4ae653761dcbfde">GetOrder</a>() - <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;GetOrder();
<a name="l00496"></a>00496 
<a name="l00497"></a>00497    <span class="keywordflow">if</span> (t &gt; 0)
<a name="l00498"></a>00498    {
<a name="l00499"></a>00499       <a class="code" href="classNURBSPatch.html#ac84bbde1fbcd9a6b25ed343add2b9928">DegreeElevate</a>(dir, t);
<a name="l00500"></a>00500    }
<a name="l00501"></a>00501    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t &lt; 0)
<a name="l00502"></a>00502    {
<a name="l00503"></a>00503       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::KnotInsert : Incorrect order!&quot;</span>);
<a name="l00504"></a>00504    }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> diff;
<a name="l00507"></a>00507    <a class="code" href="classNURBSPatch.html#a600160235618190bd0d0dd2d6ca04f73">GetKV</a>(dir)-&gt;<a class="code" href="classKnotVector.html#ad5b64b74e9a6219663ad3f6543ff3b3d">Difference</a>(newkv, diff);
<a name="l00508"></a>00508    <span class="keywordflow">if</span> (diff.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() &gt; 0)
<a name="l00509"></a>00509    {
<a name="l00510"></a>00510       <a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(dir, diff);
<a name="l00511"></a>00511    }
<a name="l00512"></a>00512 }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">// Routine from &quot;The NURBS book&quot; - 2nd ed - Piegl and Tiller</span>
<a name="l00515"></a><a class="code" href="classNURBSPatch.html#a372ccb26f1c21383750ec58906a0fa24">00515</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">NURBSPatch::KnotInsert</a>(<span class="keywordtype">int</span> dir, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;knot)
<a name="l00516"></a>00516 {
<a name="l00517"></a>00517    <span class="keywordflow">if</span> (dir &gt;= <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() || dir &lt; 0)
<a name="l00518"></a>00518       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::KnotInsert : Incorrect direction!&quot;</span>);
<a name="l00519"></a>00519 
<a name="l00520"></a>00520    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;oldp  = *<span class="keyword">this</span>;
<a name="l00521"></a>00521    <a class="code" href="classKnotVector.html">KnotVector</a> &amp;oldkv = *<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir];
<a name="l00522"></a>00522 
<a name="l00523"></a>00523    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *newpatch = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch</a>(<span class="keyword">this</span>, dir, oldkv.<a class="code" href="classKnotVector.html#aeaa6833a60235116e4ae653761dcbfde">GetOrder</a>(),
<a name="l00524"></a>00524                                          oldkv.<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() + knot.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>());
<a name="l00525"></a>00525    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;newp  = *newpatch;
<a name="l00526"></a>00526    <a class="code" href="classKnotVector.html">KnotVector</a> &amp;newkv = *newp.GetKV(dir);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528    <span class="keywordtype">int</span> size = oldp.<a class="code" href="classNURBSPatch.html#a73e3ad7da378498c924c88012d2451e5">SetLoopDirection</a>(dir);
<a name="l00529"></a>00529    <span class="keywordflow">if</span> (size != newp.SetLoopDirection(dir))
<a name="l00530"></a>00530       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::KnotInsert : Size mismatch!&quot;</span>);
<a name="l00531"></a>00531 
<a name="l00532"></a>00532    <span class="keywordtype">int</span> rr = knot.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() - 1;
<a name="l00533"></a>00533    <span class="keywordtype">int</span> a  = oldkv.<a class="code" href="classKnotVector.html#a574c387d7428f66558e62c013a02f8bd">findKnotSpan</a>(knot(0))  - 1;
<a name="l00534"></a>00534    <span class="keywordtype">int</span> b  = oldkv.<a class="code" href="classKnotVector.html#a574c387d7428f66558e62c013a02f8bd">findKnotSpan</a>(knot(rr)) - 1;
<a name="l00535"></a>00535    <span class="keywordtype">int</span> pl = oldkv.<a class="code" href="classKnotVector.html#aeaa6833a60235116e4ae653761dcbfde">GetOrder</a>();
<a name="l00536"></a>00536    <span class="keywordtype">int</span> ml = oldkv.<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>();
<a name="l00537"></a>00537 
<a name="l00538"></a>00538    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= a; j++)
<a name="l00539"></a>00539    {
<a name="l00540"></a>00540       newkv[j] = oldkv[j];
<a name="l00541"></a>00541    }
<a name="l00542"></a>00542    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = b+pl; j &lt;= ml+pl; j++)
<a name="l00543"></a>00543    {
<a name="l00544"></a>00544       newkv[j+rr+1] = oldkv[j];
<a name="l00545"></a>00545    }
<a name="l00546"></a>00546    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= (a-pl); k++)
<a name="l00547"></a>00547    {
<a name="l00548"></a>00548       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; size; ll++)
<a name="l00549"></a>00549          newp(k,ll) = oldp(k,ll);
<a name="l00550"></a>00550    }
<a name="l00551"></a>00551    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = (b-1); k &lt; ml; k++)
<a name="l00552"></a>00552    {
<a name="l00553"></a>00553       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; size; ll++)
<a name="l00554"></a>00554          newp(k+rr+1,ll) = oldp(k,ll);
<a name="l00555"></a>00555    }
<a name="l00556"></a>00556 
<a name="l00557"></a>00557    <span class="keywordtype">int</span> i = b+pl-1;
<a name="l00558"></a>00558    <span class="keywordtype">int</span> k = b+pl+rr;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = rr; j &gt;= 0; j--)
<a name="l00561"></a>00561    {
<a name="l00562"></a>00562       <span class="keywordflow">while</span> ( (knot(j) &lt;= oldkv[i]) &amp;&amp; (i &gt; a) )
<a name="l00563"></a>00563       {
<a name="l00564"></a>00564          newkv[k] = oldkv[i];
<a name="l00565"></a>00565          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; size; ll++)
<a name="l00566"></a>00566             newp(k-pl-1,ll) = oldp(i-pl-1,ll);
<a name="l00567"></a>00567 
<a name="l00568"></a>00568          k--;
<a name="l00569"></a>00569          i--;
<a name="l00570"></a>00570       }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; size; ll++)
<a name="l00573"></a>00573          newp(k-pl-1,ll) = newp(k-pl,ll);
<a name="l00574"></a>00574 
<a name="l00575"></a>00575       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l = 1; l &lt;= pl; l++)
<a name="l00576"></a>00576       {
<a name="l00577"></a>00577          <span class="keywordtype">int</span> ind = k-pl+l;
<a name="l00578"></a>00578          <span class="keywordtype">double</span> alfa = newkv[k+l] - knot(j);
<a name="l00579"></a>00579          <span class="keywordflow">if</span> (fabs(alfa) == 0.0)
<a name="l00580"></a>00580          {
<a name="l00581"></a>00581             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; size; ll++)
<a name="l00582"></a>00582                newp(ind-1,ll) = newp(ind,ll);
<a name="l00583"></a>00583          }
<a name="l00584"></a>00584          <span class="keywordflow">else</span>
<a name="l00585"></a>00585          {
<a name="l00586"></a>00586             alfa = alfa/(newkv[k+l] - oldkv[i-pl+l]);
<a name="l00587"></a>00587             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; size; ll++)
<a name="l00588"></a>00588                newp(ind-1,ll) = alfa*newp(ind-1,ll) + (1.0-alfa)*newp(ind,ll);
<a name="l00589"></a>00589          }
<a name="l00590"></a>00590       }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592       newkv[k] = knot(j);
<a name="l00593"></a>00593       k--;
<a name="l00594"></a>00594    }
<a name="l00595"></a>00595 
<a name="l00596"></a>00596    newkv.<a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">GetElements</a>();
<a name="l00597"></a>00597 
<a name="l00598"></a>00598    <a class="code" href="classNURBSPatch.html#ad8f2bbccb7534092ae678ea4f17a11a3">swap</a>(newpatch);
<a name="l00599"></a>00599 }
<a name="l00600"></a>00600 
<a name="l00601"></a><a class="code" href="classNURBSPatch.html#a42f441e3ee3f1078e25ec02b91fefc31">00601</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#ac84bbde1fbcd9a6b25ed343add2b9928">NURBSPatch::DegreeElevate</a>(<span class="keywordtype">int</span> t)
<a name="l00602"></a>00602 {
<a name="l00603"></a>00603    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); dir++)
<a name="l00604"></a>00604    {
<a name="l00605"></a>00605       <a class="code" href="classNURBSPatch.html#ac84bbde1fbcd9a6b25ed343add2b9928">DegreeElevate</a>(dir, t);
<a name="l00606"></a>00606    }
<a name="l00607"></a>00607 }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609 <span class="comment">// Routine from &quot;The NURBS book&quot; - 2nd ed - Piegl and Tiller</span>
<a name="l00610"></a><a class="code" href="classNURBSPatch.html#ac84bbde1fbcd9a6b25ed343add2b9928">00610</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#ac84bbde1fbcd9a6b25ed343add2b9928">NURBSPatch::DegreeElevate</a>(<span class="keywordtype">int</span> dir, <span class="keywordtype">int</span> t)
<a name="l00611"></a>00611 {
<a name="l00612"></a>00612    <span class="keywordflow">if</span> (dir &gt;= <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() || dir &lt; 0)
<a name="l00613"></a>00613       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::DegreeElevate : Incorrect direction!&quot;</span>);
<a name="l00614"></a>00614 
<a name="l00615"></a>00615    <span class="keywordtype">int</span> i, j, k, kj, mpi, mul, mh, kind, cind, first, last;
<a name="l00616"></a>00616    <span class="keywordtype">int</span> r, a, b, oldr, save, s, tr, lbz, rbz, l;
<a name="l00617"></a>00617    <span class="keywordtype">double</span> inv, ua, ub, numer, alf, den, bet, gam;
<a name="l00618"></a>00618 
<a name="l00619"></a>00619    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;oldp  = *<span class="keyword">this</span>;
<a name="l00620"></a>00620    <a class="code" href="classKnotVector.html">KnotVector</a> &amp;oldkv = *<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir];
<a name="l00621"></a>00621 
<a name="l00622"></a>00622    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *newpatch = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch</a>(<span class="keyword">this</span>, dir, oldkv.<a class="code" href="classKnotVector.html#aeaa6833a60235116e4ae653761dcbfde">GetOrder</a>() + t,
<a name="l00623"></a>00623                                          oldkv.<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() + oldkv.<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>()*t);
<a name="l00624"></a>00624    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;newp  = *newpatch;
<a name="l00625"></a>00625    <a class="code" href="classKnotVector.html">KnotVector</a> &amp;newkv = *newp.GetKV(dir);
<a name="l00626"></a>00626 
<a name="l00627"></a>00627    <span class="keywordtype">int</span> size = oldp.<a class="code" href="classNURBSPatch.html#a73e3ad7da378498c924c88012d2451e5">SetLoopDirection</a>(dir);
<a name="l00628"></a>00628    <span class="keywordflow">if</span> (size != newp.SetLoopDirection(dir))
<a name="l00629"></a>00629       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::DegreeElevate : Size mismatch!&quot;</span>);
<a name="l00630"></a>00630 
<a name="l00631"></a>00631    <span class="keywordtype">int</span> p = oldkv.<a class="code" href="classKnotVector.html#aeaa6833a60235116e4ae653761dcbfde">GetOrder</a>();
<a name="l00632"></a>00632    <span class="keywordtype">int</span> n = oldkv.<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>()-1;
<a name="l00633"></a>00633 
<a name="l00634"></a>00634    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> bezalfs (p+t+1, p+1);
<a name="l00635"></a>00635    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> bpts    (p+1,   size);
<a name="l00636"></a>00636    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> ebpts   (p+t+1, size);
<a name="l00637"></a>00637    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> nextbpts(p-1,   size);
<a name="l00638"></a>00638    <a class="code" href="classVector.html" title="Vector data type.">Vector</a>      alphas  (p-1);
<a name="l00639"></a>00639 
<a name="l00640"></a>00640    <span class="keywordtype">int</span> m = n + p + 1;
<a name="l00641"></a>00641    <span class="keywordtype">int</span> ph = p + t;
<a name="l00642"></a>00642    <span class="keywordtype">int</span> ph2 = ph/2;
<a name="l00643"></a>00643 
<a name="l00644"></a>00644    {
<a name="l00645"></a>00645       <a class="code" href="classArray2D.html">Array2D&lt;int&gt;</a> binom(ph+1, ph+1);
<a name="l00646"></a>00646       <span class="keywordflow">for</span> (i = 0; i &lt;= ph; i++)
<a name="l00647"></a>00647       {
<a name="l00648"></a>00648          binom(i,0) = binom(i,i) = 1;
<a name="l00649"></a>00649          <span class="keywordflow">for</span> (j = 1; j &lt; i; j++)
<a name="l00650"></a>00650             binom(i,j) = binom(i-1,j) + binom(i-1,j-1);
<a name="l00651"></a>00651       }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653       bezalfs(0,0)  = 1.0;
<a name="l00654"></a>00654       bezalfs(ph,p) = 1.0;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656       <span class="keywordflow">for</span> (i = 1; i &lt;= ph2; i++)
<a name="l00657"></a>00657       {
<a name="l00658"></a>00658          inv = 1.0/binom(ph,i);
<a name="l00659"></a>00659          mpi = min(p,i);
<a name="l00660"></a>00660          <span class="keywordflow">for</span> (j = max(0,i-t); j &lt;= mpi; j++)
<a name="l00661"></a>00661          {
<a name="l00662"></a>00662             bezalfs(i,j) = inv*binom(p,j)*binom(t,i-j);
<a name="l00663"></a>00663          }
<a name="l00664"></a>00664       }
<a name="l00665"></a>00665    }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667    <span class="keywordflow">for</span> (i = ph2+1; i &lt; ph; i++)
<a name="l00668"></a>00668    {
<a name="l00669"></a>00669       mpi = min(p,i);
<a name="l00670"></a>00670       <span class="keywordflow">for</span> (j = max(0,i-t); j &lt;= mpi; j++)
<a name="l00671"></a>00671       {
<a name="l00672"></a>00672          bezalfs(i,j) = bezalfs(ph-i,p-j);
<a name="l00673"></a>00673       }
<a name="l00674"></a>00674    }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676    mh = ph;
<a name="l00677"></a>00677    kind = ph + 1;
<a name="l00678"></a>00678    r = -1;
<a name="l00679"></a>00679    a = p;
<a name="l00680"></a>00680    b = p + 1;
<a name="l00681"></a>00681    cind = 1;
<a name="l00682"></a>00682    ua = oldkv[0];
<a name="l00683"></a>00683    <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00684"></a>00684       newp(0,l) = oldp(0,l);
<a name="l00685"></a>00685    <span class="keywordflow">for</span> (i = 0; i &lt;= ph; i++)
<a name="l00686"></a>00686       newkv[i] = ua;
<a name="l00687"></a>00687 
<a name="l00688"></a>00688    <span class="keywordflow">for</span> (i = 0; i &lt;= p; i++)
<a name="l00689"></a>00689    {
<a name="l00690"></a>00690       <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00691"></a>00691          bpts(i,l) = oldp(i,l);
<a name="l00692"></a>00692    }
<a name="l00693"></a>00693 
<a name="l00694"></a>00694    <span class="keywordflow">while</span> (b &lt; m)
<a name="l00695"></a>00695    {
<a name="l00696"></a>00696       i = b;
<a name="l00697"></a>00697       <span class="keywordflow">while</span> (b &lt; m &amp;&amp; oldkv[b] == oldkv[b+1])  b++;
<a name="l00698"></a>00698 
<a name="l00699"></a>00699       mul = b-i+1;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701       mh = mh + mul + t;
<a name="l00702"></a>00702       ub = oldkv[b];
<a name="l00703"></a>00703       oldr = r;
<a name="l00704"></a>00704       r = p-mul;
<a name="l00705"></a>00705       <span class="keywordflow">if</span> (oldr &gt; 0) lbz = (oldr+2)/2;
<a name="l00706"></a>00706       <span class="keywordflow">else</span>          lbz = 1;
<a name="l00707"></a>00707 
<a name="l00708"></a>00708       <span class="keywordflow">if</span> (r &gt; 0) rbz = ph-(r+1)/2;
<a name="l00709"></a>00709       <span class="keywordflow">else</span>       rbz = ph;
<a name="l00710"></a>00710 
<a name="l00711"></a>00711       <span class="keywordflow">if</span> (r &gt; 0)
<a name="l00712"></a>00712       {
<a name="l00713"></a>00713          numer = ub - ua;
<a name="l00714"></a>00714          <span class="keywordflow">for</span> (k = p ; k &gt; mul; k--)
<a name="l00715"></a>00715             alphas[k-mul-1] = numer/(oldkv[a+k]-ua);
<a name="l00716"></a>00716 
<a name="l00717"></a>00717          <span class="keywordflow">for</span> (j = 1; j &lt;= r; j++)
<a name="l00718"></a>00718          {
<a name="l00719"></a>00719             save = r-j;
<a name="l00720"></a>00720             s = mul+j;
<a name="l00721"></a>00721             <span class="keywordflow">for</span> (k = p; k &gt;= s; k--)
<a name="l00722"></a>00722             {
<a name="l00723"></a>00723                <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00724"></a>00724                   bpts(k,l) = (alphas[k-s]*bpts(k,l) +
<a name="l00725"></a>00725                                (1.0-alphas[k-s])*bpts(k-1,l));
<a name="l00726"></a>00726             }
<a name="l00727"></a>00727             <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00728"></a>00728                nextbpts(save,l) = bpts(p,l);
<a name="l00729"></a>00729          }
<a name="l00730"></a>00730       }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732       <span class="keywordflow">for</span> (i = lbz; i &lt;= ph; i++)
<a name="l00733"></a>00733       {
<a name="l00734"></a>00734          <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00735"></a>00735             ebpts(i,l) = 0.0;
<a name="l00736"></a>00736          mpi = min(p,i);
<a name="l00737"></a>00737          <span class="keywordflow">for</span> (j = max(0,i-t); j &lt;= mpi; j++)
<a name="l00738"></a>00738          {
<a name="l00739"></a>00739             <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00740"></a>00740                ebpts(i,l) += bezalfs(i,j)*bpts(j,l);
<a name="l00741"></a>00741          }
<a name="l00742"></a>00742       }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744       <span class="keywordflow">if</span> (oldr &gt; 1)
<a name="l00745"></a>00745       {
<a name="l00746"></a>00746          first = kind-2;
<a name="l00747"></a>00747          last = kind;
<a name="l00748"></a>00748          den = ub-ua;
<a name="l00749"></a>00749          bet = (ub-newkv[kind-1])/den;
<a name="l00750"></a>00750 
<a name="l00751"></a>00751          <span class="keywordflow">for</span> (tr = 1; tr &lt; oldr; tr++)
<a name="l00752"></a>00752          {
<a name="l00753"></a>00753             i = first;
<a name="l00754"></a>00754             j = last;
<a name="l00755"></a>00755             kj = j-kind+1;
<a name="l00756"></a>00756             <span class="keywordflow">while</span> (j-i &gt; tr)
<a name="l00757"></a>00757             {
<a name="l00758"></a>00758                <span class="keywordflow">if</span> (i &lt; cind)
<a name="l00759"></a>00759                {
<a name="l00760"></a>00760                   alf = (ub-newkv[i])/(ua-newkv[i]);
<a name="l00761"></a>00761                   <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00762"></a>00762                      newp(i,l) = alf*newp(i,l)-(1.0-alf)*newp(i-1,l);
<a name="l00763"></a>00763                }
<a name="l00764"></a>00764                <span class="keywordflow">if</span> (j &gt;= lbz)
<a name="l00765"></a>00765                {
<a name="l00766"></a>00766                   <span class="keywordflow">if</span> ((j-tr) &lt;= (kind-ph+oldr))
<a name="l00767"></a>00767                   {
<a name="l00768"></a>00768                      gam = (ub-newkv[j-tr])/den;
<a name="l00769"></a>00769                      <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00770"></a>00770                         ebpts(kj,l) = gam*ebpts(kj,l) + (1.0-gam)*ebpts(kj+1,l);
<a name="l00771"></a>00771                   }
<a name="l00772"></a>00772                   <span class="keywordflow">else</span>
<a name="l00773"></a>00773                   {
<a name="l00774"></a>00774                      <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00775"></a>00775                         ebpts(kj,l) = bet*ebpts(kj,l) + (1.0-bet)*ebpts(kj+1,l);
<a name="l00776"></a>00776                   }
<a name="l00777"></a>00777                }
<a name="l00778"></a>00778                i = i+1;
<a name="l00779"></a>00779                j = j-1;
<a name="l00780"></a>00780                kj = kj-1;
<a name="l00781"></a>00781             }
<a name="l00782"></a>00782             first--;
<a name="l00783"></a>00783             last++;
<a name="l00784"></a>00784          }
<a name="l00785"></a>00785       }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787       <span class="keywordflow">if</span> (a != p)
<a name="l00788"></a>00788       {
<a name="l00789"></a>00789          <span class="keywordflow">for</span> (i = 0; i &lt; (ph-oldr); i++)
<a name="l00790"></a>00790          {
<a name="l00791"></a>00791             newkv[kind] = ua;
<a name="l00792"></a>00792             kind = kind+1;
<a name="l00793"></a>00793          }
<a name="l00794"></a>00794       }
<a name="l00795"></a>00795       <span class="keywordflow">for</span> (j = lbz; j &lt;= rbz; j++)
<a name="l00796"></a>00796       {
<a name="l00797"></a>00797          <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00798"></a>00798             newp(cind,l) =  ebpts(j,l);
<a name="l00799"></a>00799          cind = cind +1;
<a name="l00800"></a>00800       }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802       <span class="keywordflow">if</span> (b &lt; m)
<a name="l00803"></a>00803       {
<a name="l00804"></a>00804          <span class="keywordflow">for</span> (j = 0; j &lt;r; j++)
<a name="l00805"></a>00805             <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00806"></a>00806                bpts(j,l) = nextbpts(j,l);
<a name="l00807"></a>00807 
<a name="l00808"></a>00808          <span class="keywordflow">for</span> (j = r; j &lt;= p; j++)
<a name="l00809"></a>00809             <span class="keywordflow">for</span> (l = 0; l &lt; size; l++)
<a name="l00810"></a>00810                bpts(j,l) = oldp(b-p+j,l);
<a name="l00811"></a>00811 
<a name="l00812"></a>00812          a = b;
<a name="l00813"></a>00813          b = b+1;
<a name="l00814"></a>00814          ua = ub;
<a name="l00815"></a>00815       }
<a name="l00816"></a>00816       <span class="keywordflow">else</span>
<a name="l00817"></a>00817       {
<a name="l00818"></a>00818          <span class="keywordflow">for</span> (i = 0; i &lt;= ph; i++)
<a name="l00819"></a>00819             newkv[kind+i] = ub;
<a name="l00820"></a>00820       }
<a name="l00821"></a>00821    }
<a name="l00822"></a>00822    newkv.<a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">GetElements</a>();
<a name="l00823"></a>00823 
<a name="l00824"></a>00824    <a class="code" href="classNURBSPatch.html#ad8f2bbccb7534092ae678ea4f17a11a3">swap</a>(newpatch);
<a name="l00825"></a>00825 }
<a name="l00826"></a>00826 
<a name="l00827"></a><a class="code" href="classNURBSPatch.html#a5710211d82e00442cd5b040a782ff65e">00827</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a5710211d82e00442cd5b040a782ff65e">NURBSPatch::FlipDirection</a>(<span class="keywordtype">int</span> dir)
<a name="l00828"></a>00828 {
<a name="l00829"></a>00829    <span class="keywordtype">int</span> size = <a class="code" href="classNURBSPatch.html#a73e3ad7da378498c924c88012d2451e5">SetLoopDirection</a>(dir);
<a name="l00830"></a>00830 
<a name="l00831"></a>00831    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a>/2; <span class="keywordtype">id</span>++)
<a name="l00832"></a>00832       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00833"></a>00833          Swap&lt;double&gt;((*<span class="keyword">this</span>)(<span class="keywordtype">id</span>,i), (*<span class="keyword">this</span>)(<a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a>-1-<span class="keywordtype">id</span>,i));
<a name="l00834"></a>00834    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;Flip();
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a><a class="code" href="classNURBSPatch.html#afd51aa5111b149fda9f33190346d9b5e">00837</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#afd51aa5111b149fda9f33190346d9b5e">NURBSPatch::SwapDirections</a>(<span class="keywordtype">int</span> dir1, <span class="keywordtype">int</span> dir2)
<a name="l00838"></a>00838 {
<a name="l00839"></a>00839    <span class="keywordflow">if</span> (abs(dir1-dir2) == 2)
<a name="l00840"></a>00840       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::SwapDirections :&quot;</span>
<a name="l00841"></a>00841                  <span class="stringliteral">&quot; directions 0 and 2 are not supported!&quot;</span>);
<a name="l00842"></a>00842 
<a name="l00843"></a>00843    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> nkv;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845    <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(nkv);
<a name="l00846"></a>00846    Swap&lt;KnotVector *&gt;(nkv[dir1], nkv[dir2]);
<a name="l00847"></a>00847    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *newpatch = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html#a47324f81e01e6a81cdb25f7fe292fbbd">NURBSPatch</a>(nkv, <a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>);
<a name="l00848"></a>00848 
<a name="l00849"></a>00849    <span class="keywordtype">int</span> size = <a class="code" href="classNURBSPatch.html#a73e3ad7da378498c924c88012d2451e5">SetLoopDirection</a>(dir1);
<a name="l00850"></a>00850    newpatch-&gt;SetLoopDirection(dir2);
<a name="l00851"></a>00851 
<a name="l00852"></a>00852    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; <a class="code" href="classNURBSPatch.html#a7278ec4f33f6a84ef70d503bdc6302bc">nd</a>; <span class="keywordtype">id</span>++)
<a name="l00853"></a>00853       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00854"></a>00854          (*newpatch)(id,i) = (*<span class="keyword">this</span>)(id,i);
<a name="l00855"></a>00855 
<a name="l00856"></a>00856    <a class="code" href="classNURBSPatch.html#ad8f2bbccb7534092ae678ea4f17a11a3">swap</a>(newpatch);
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a><a class="code" href="classNURBSPatch.html#a94996a2c9bbbe48975da56a1bf9e6346">00859</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a94996a2c9bbbe48975da56a1bf9e6346">NURBSPatch::Get3DRotationMatrix</a>(<span class="keywordtype">double</span> n[], <span class="keywordtype">double</span> angle, <span class="keywordtype">double</span> r,
<a name="l00860"></a>00860                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;T)
<a name="l00861"></a>00861 {
<a name="l00862"></a>00862    <span class="keywordtype">double</span> c, s, c1;
<a name="l00863"></a>00863    <span class="keywordtype">double</span> l2 = n[0]*n[0] + n[1]*n[1] + n[2]*n[2];
<a name="l00864"></a>00864    <span class="keywordtype">double</span> l = sqrt(l2);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866    <span class="keywordflow">if</span> (fabs(angle) == M_PI_2)
<a name="l00867"></a>00867    {
<a name="l00868"></a>00868       s = r*copysign(1., angle);
<a name="l00869"></a>00869       c = 0.;
<a name="l00870"></a>00870       c1 = -1.;
<a name="l00871"></a>00871    }
<a name="l00872"></a>00872    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fabs(angle) == M_PI)
<a name="l00873"></a>00873    {
<a name="l00874"></a>00874       s = 0.;
<a name="l00875"></a>00875       c = -r;
<a name="l00876"></a>00876       c1 = c - 1.;
<a name="l00877"></a>00877    }
<a name="l00878"></a>00878    <span class="keywordflow">else</span>
<a name="l00879"></a>00879    {
<a name="l00880"></a>00880       s = r*sin(angle);
<a name="l00881"></a>00881       c = r*cos(angle);
<a name="l00882"></a>00882       c1 = c - 1.;
<a name="l00883"></a>00883    }
<a name="l00884"></a>00884 
<a name="l00885"></a>00885    T.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(3);
<a name="l00886"></a>00886 
<a name="l00887"></a>00887    T(0,0) =  (n[0]*n[0] + (n[1]*n[1] + n[2]*n[2])*c)/l2;
<a name="l00888"></a>00888    T(0,1) = -(n[0]*n[1]*c1)/l2 - (n[2]*s)/l;
<a name="l00889"></a>00889    T(0,2) = -(n[0]*n[2]*c1)/l2 + (n[1]*s)/l;
<a name="l00890"></a>00890    T(1,0) = -(n[0]*n[1]*c1)/l2 + (n[2]*s)/l;
<a name="l00891"></a>00891    T(1,1) =  (n[1]*n[1] + (n[0]*n[0] + n[2]*n[2])*c)/l2;
<a name="l00892"></a>00892    T(1,2) = -(n[1]*n[2]*c1)/l2 - (n[0]*s)/l;
<a name="l00893"></a>00893    T(2,0) = -(n[0]*n[2]*c1)/l2 - (n[1]*s)/l;
<a name="l00894"></a>00894    T(2,1) = -(n[1]*n[2]*c1)/l2 + (n[0]*s)/l;
<a name="l00895"></a>00895    T(2,2) =  (n[2]*n[2] + (n[0]*n[0] + n[1]*n[1])*c)/l2;
<a name="l00896"></a>00896 }
<a name="l00897"></a>00897 
<a name="l00898"></a><a class="code" href="classNURBSPatch.html#a4d26d4afdd4cafb4df75f894e7fcd8ec">00898</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatch.html#a4d26d4afdd4cafb4df75f894e7fcd8ec">NURBSPatch::Rotate3D</a>(<span class="keywordtype">double</span> n[], <span class="keywordtype">double</span> angle)
<a name="l00899"></a>00899 {
<a name="l00900"></a>00900    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a> != 4)
<a name="l00901"></a>00901       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSPatch::Rotate3D : not a NURBSPatch in 3D!&quot;</span>);
<a name="l00902"></a>00902 
<a name="l00903"></a>00903    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> T(3);
<a name="l00904"></a>00904    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> x(3), y(NULL, 3);
<a name="l00905"></a>00905 
<a name="l00906"></a>00906    <a class="code" href="classNURBSPatch.html#a94996a2c9bbbe48975da56a1bf9e6346">Get3DRotationMatrix</a>(n, angle, 1., T);
<a name="l00907"></a>00907 
<a name="l00908"></a>00908    <span class="keywordtype">int</span> size = 1;
<a name="l00909"></a>00909    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00910"></a>00910       size *= <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]-&gt;GetNCP();
<a name="l00911"></a>00911 
<a name="l00912"></a>00912    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00913"></a>00913    {
<a name="l00914"></a>00914       y.<a class="code" href="classVector.html#a8796799b2ea1faf5b551a5a751b47ddb">SetData</a>(<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> + i*<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>);
<a name="l00915"></a>00915       x = y;
<a name="l00916"></a>00916       T.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(x, y);
<a name="l00917"></a>00917    }
<a name="l00918"></a>00918 }
<a name="l00919"></a>00919 
<a name="l00920"></a><a class="code" href="classNURBSPatch.html#aa3460c28d1625b5d2f48864b29194e70">00920</a> <span class="keywordtype">int</span> <a class="code" href="classNURBSPatch.html#aa3460c28d1625b5d2f48864b29194e70">NURBSPatch::MakeUniformDegree</a>()
<a name="l00921"></a>00921 {
<a name="l00922"></a>00922    <span class="keywordtype">int</span> maxd = -1;
<a name="l00923"></a>00923 
<a name="l00924"></a>00924    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); dir++)
<a name="l00925"></a>00925       <span class="keywordflow">if</span> (maxd &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;GetOrder())
<a name="l00926"></a>00926          maxd = <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;GetOrder();
<a name="l00927"></a>00927 
<a name="l00928"></a>00928    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dir = 0; dir &lt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); dir++)
<a name="l00929"></a>00929       <span class="keywordflow">if</span> (maxd &gt; <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;GetOrder())
<a name="l00930"></a>00930          <a class="code" href="classNURBSPatch.html#ac84bbde1fbcd9a6b25ed343add2b9928">DegreeElevate</a>(dir, maxd - <a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[dir]-&gt;GetOrder());
<a name="l00931"></a>00931 
<a name="l00932"></a>00932    <span class="keywordflow">return</span> maxd;
<a name="l00933"></a>00933 }
<a name="l00934"></a>00934 
<a name="l00935"></a><a class="code" href="nurbs_8cpp.html#afb307dfcefb981d9d9f22b246664886f">00935</a> <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *<a class="code" href="nurbs_8cpp.html#afb307dfcefb981d9d9f22b246664886f">Interpolate</a>(<a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;p1, <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;p2)
<a name="l00936"></a>00936 {
<a name="l00937"></a>00937    <span class="keywordflow">if</span> (p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() != p2.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() || p1.<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a> != p2.<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>)
<a name="l00938"></a>00938       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;Interpolate(NURBSPatch &amp;, NURBSPatch &amp;)&quot;</span>);
<a name="l00939"></a>00939 
<a name="l00940"></a>00940    <span class="keywordtype">int</span> size = 1, dim = p1.<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a>;
<a name="l00941"></a>00941    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() + 1);
<a name="l00942"></a>00942 
<a name="l00943"></a>00943    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00944"></a>00944    {
<a name="l00945"></a>00945       <span class="keywordflow">if</span> (p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]-&gt;GetOrder() &lt; p2.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]-&gt;GetOrder())
<a name="l00946"></a>00946       {
<a name="l00947"></a>00947          p1.<a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(i, *p2.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]);
<a name="l00948"></a>00948          p2.<a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(i, *p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]);
<a name="l00949"></a>00949       }
<a name="l00950"></a>00950       <span class="keywordflow">else</span>
<a name="l00951"></a>00951       {
<a name="l00952"></a>00952          p2.<a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(i, *p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]);
<a name="l00953"></a>00953          p1.<a class="code" href="classNURBSPatch.html#a4cce96b8ddf4797f88ea2a885a7874ca">KnotInsert</a>(i, *p2.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i]);
<a name="l00954"></a>00954       }
<a name="l00955"></a>00955       kv[i] = p1.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i];
<a name="l00956"></a>00956       size *= kv[i]-&gt;GetNCP();
<a name="l00957"></a>00957    }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959    kv.<a class="code" href="classArray.html#af6ae597080f3fbeaa9066a5773b6e271" title="Return the last element in the array.">Last</a>() = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(1, 2);
<a name="l00960"></a>00960    <a class="code" href="classKnotVector.html">KnotVector</a> &amp;nkv = *kv.Last();
<a name="l00961"></a>00961    nkv[0] = nkv[1] = 0.0;
<a name="l00962"></a>00962    nkv[2] = nkv[3] = 1.0;
<a name="l00963"></a>00963    nkv.<a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">GetElements</a>();
<a name="l00964"></a>00964 
<a name="l00965"></a>00965    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *patch = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html">NURBSPatch</a>(kv, dim);
<a name="l00966"></a>00966    <span class="keyword">delete</span> kv.Last();
<a name="l00967"></a>00967 
<a name="l00968"></a>00968    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l00969"></a>00969    {
<a name="l00970"></a>00970       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; dim; d++)
<a name="l00971"></a>00971       {
<a name="l00972"></a>00972          patch-&gt;<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[i*dim+d] = p1.<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[i*dim+d];
<a name="l00973"></a>00973          patch-&gt;<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[(i+size)*dim+d] = p2.<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>[i*dim+d];
<a name="l00974"></a>00974       }
<a name="l00975"></a>00975    }
<a name="l00976"></a>00976 
<a name="l00977"></a>00977    <span class="keywordflow">return</span> patch;
<a name="l00978"></a>00978 }
<a name="l00979"></a>00979 
<a name="l00980"></a><a class="code" href="nurbs_8cpp.html#aae54f47045f45914c190e1c564e41f96">00980</a> <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *<a class="code" href="nurbs_8cpp.html#aae54f47045f45914c190e1c564e41f96">Revolve3D</a>(<a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;patch, <span class="keywordtype">double</span> n[], <span class="keywordtype">double</span> ang, <span class="keywordtype">int</span> times)
<a name="l00981"></a>00981 {
<a name="l00982"></a>00982    <span class="keywordflow">if</span> (patch.<a class="code" href="classNURBSPatch.html#a84ee24a140fc53a59334044f2da2b07e">Dim</a> != 4)
<a name="l00983"></a>00983       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;Revolve3D(NURBSPatch &amp;, double [], double)&quot;</span>);
<a name="l00984"></a>00984 
<a name="l00985"></a>00985    <span class="keywordtype">int</span> size = 1, ns;
<a name="l00986"></a>00986    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> nkv(patch.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() + 1);
<a name="l00987"></a>00987 
<a name="l00988"></a>00988    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; patch.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00989"></a>00989    {
<a name="l00990"></a>00990       nkv[i] = patch.<a class="code" href="classNURBSPatch.html#a107c3a285fb31fc9cfd1606e33fa6b9b">kv</a>[i];
<a name="l00991"></a>00991       size *= nkv[i]-&gt;GetNCP();
<a name="l00992"></a>00992    }
<a name="l00993"></a>00993    ns = 2*times + 1;
<a name="l00994"></a>00994    nkv.<a class="code" href="classArray.html#af6ae597080f3fbeaa9066a5773b6e271" title="Return the last element in the array.">Last</a>() = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(2, ns);
<a name="l00995"></a>00995    <a class="code" href="classKnotVector.html">KnotVector</a> &amp;lkv = *nkv.Last();
<a name="l00996"></a>00996    lkv[0] = lkv[1] = lkv[2] = 0.0;
<a name="l00997"></a>00997    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; times; i++)
<a name="l00998"></a>00998       lkv[2*i+1] = lkv[2*i+2] = i;
<a name="l00999"></a>00999    lkv[ns] = lkv[ns+1] = lkv[ns+2] = times;
<a name="l01000"></a>01000    lkv.<a class="code" href="classKnotVector.html#a56d380731705ac7a4e197e04fac93974" title="Count the number of elements.">GetElements</a>();
<a name="l01001"></a>01001    <a class="code" href="classNURBSPatch.html">NURBSPatch</a> *newpatch = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html">NURBSPatch</a>(nkv, 4);
<a name="l01002"></a>01002    <span class="keyword">delete</span> nkv.Last();
<a name="l01003"></a>01003 
<a name="l01004"></a>01004    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> T(3), T2(3);
<a name="l01005"></a>01005    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> u(NULL, 3), v(NULL, 3);
<a name="l01006"></a>01006 
<a name="l01007"></a>01007    <a class="code" href="classNURBSPatch.html#a94996a2c9bbbe48975da56a1bf9e6346">NURBSPatch::Get3DRotationMatrix</a>(n, ang, 1., T);
<a name="l01008"></a>01008    <span class="keywordtype">double</span> c = cos(ang/2);
<a name="l01009"></a>01009    <a class="code" href="classNURBSPatch.html#a94996a2c9bbbe48975da56a1bf9e6346">NURBSPatch::Get3DRotationMatrix</a>(n, ang/2, 1./c, T2);
<a name="l01010"></a>01010    T2 *= c;
<a name="l01011"></a>01011 
<a name="l01012"></a>01012    <span class="keywordtype">double</span> *op = patch.<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a>, *np;
<a name="l01013"></a>01013    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; size; i++)
<a name="l01014"></a>01014    {
<a name="l01015"></a>01015       np = newpatch-&gt;<a class="code" href="classNURBSPatch.html#a9108c772f2f6b67c14b8432cf23f3302">data</a> + 4*i;
<a name="l01016"></a>01016       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)
<a name="l01017"></a>01017          np[j] = op[j];
<a name="l01018"></a>01018       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; times; j++)
<a name="l01019"></a>01019       {
<a name="l01020"></a>01020          u.SetData(np);
<a name="l01021"></a>01021          v.<a class="code" href="classVector.html#a8796799b2ea1faf5b551a5a751b47ddb">SetData</a>(np += 4*size);
<a name="l01022"></a>01022          T2.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(u, v);
<a name="l01023"></a>01023          v[3] = c*u[3];
<a name="l01024"></a>01024          v.<a class="code" href="classVector.html#a8796799b2ea1faf5b551a5a751b47ddb">SetData</a>(np += 4*size);
<a name="l01025"></a>01025          T.Mult(u, v);
<a name="l01026"></a>01026          v[3] = u[3];
<a name="l01027"></a>01027       }
<a name="l01028"></a>01028       op += 4;
<a name="l01029"></a>01029    }
<a name="l01030"></a>01030 
<a name="l01031"></a>01031    <span class="keywordflow">return</span> newpatch;
<a name="l01032"></a>01032 }
<a name="l01033"></a>01033 
<a name="l01034"></a>01034 
<a name="l01035"></a>01035 <span class="comment">// from mesh.cpp</span>
<a name="l01036"></a>01036 <span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code" href="mesh_8cpp.html#aa40be394965a0e6c047d6581597b0143">skip_comment_lines</a>(istream &amp;, <span class="keyword">const</span> <span class="keywordtype">char</span>);
<a name="l01037"></a>01037 
<a name="l01038"></a><a class="code" href="classNURBSExtension.html#a4e511806336fbfa4d849fdf854c02419">01038</a> <a class="code" href="classNURBSExtension.html#a81b2bd9053206c62fe511e809cd6bc5a">NURBSExtension::NURBSExtension</a>(istream &amp;input)
<a name="l01039"></a>01039 {
<a name="l01040"></a>01040    <span class="comment">// Read topology</span>
<a name="l01041"></a>01041    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a> = <span class="keyword">new</span> <a class="code" href="classMesh.html">Mesh</a>;
<a name="l01042"></a>01042    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a0a601695bd73427e079f19e05bc4b074" title="Read NURBS patch/macro-element mesh.">LoadPatchTopo</a>(input, <a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>);
<a name="l01043"></a>01043    <a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 1;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045    <a class="code" href="classNURBSExtension.html#a55e52e7b0645c1c37b63407d38367bb1">CheckPatches</a>();
<a name="l01046"></a>01046    <span class="comment">// CheckBdrPatches();</span>
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    <a class="code" href="mesh_8cpp.html#aa40be394965a0e6c047d6581597b0143">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);
<a name="l01049"></a>01049 
<a name="l01050"></a>01050    <span class="comment">// Read knotvectors or patches</span>
<a name="l01051"></a>01051    <span class="keywordtype">string</span> ident;
<a name="l01052"></a>01052    input &gt;&gt; ws &gt;&gt; ident; <span class="comment">// &#39;knotvectors&#39; or &#39;patches&#39;</span>
<a name="l01053"></a>01053    <span class="keywordflow">if</span> (ident == <span class="stringliteral">&quot;knotvectors&quot;</span>)
<a name="l01054"></a>01054    {
<a name="l01055"></a>01055       input &gt;&gt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>;
<a name="l01056"></a>01056       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(NumOfKnotVectors);
<a name="l01057"></a>01057       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l01058"></a>01058       {
<a name="l01059"></a>01059          <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(input);
<a name="l01060"></a>01060          <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i]-&gt;<a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>() != <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[0]-&gt;<a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>())
<a name="l01061"></a>01061             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSExtension::NURBSExtension :\n&quot;</span>
<a name="l01062"></a>01062                        <span class="stringliteral">&quot; Variable orders are not supported!&quot;</span>);
<a name="l01063"></a>01063       }
<a name="l01064"></a>01064       <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[0]-&gt;GetOrder();
<a name="l01065"></a>01065    }
<a name="l01066"></a>01066    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ident == <span class="stringliteral">&quot;patches&quot;</span>)
<a name="l01067"></a>01067    {
<a name="l01068"></a>01068       <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>());
<a name="l01069"></a>01069       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); p++)
<a name="l01070"></a>01070       {
<a name="l01071"></a>01071          <a class="code" href="mesh_8cpp.html#aa40be394965a0e6c047d6581597b0143">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);
<a name="l01072"></a>01072          <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p] = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html">NURBSPatch</a>(input);
<a name="l01073"></a>01073       }
<a name="l01074"></a>01074 
<a name="l01075"></a>01075       <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> = 0;
<a name="l01076"></a>01076       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a7fbb3520555d1b8ae2470b55f9412ae7" title="Return the number of edges.">GetNEdges</a>(); i++)
<a name="l01077"></a>01077          <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> &lt; <a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(i))
<a name="l01078"></a>01078             <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> = <a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(i);
<a name="l01079"></a>01079       <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>++;
<a name="l01080"></a>01080       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>);
<a name="l01081"></a>01081       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a> = NULL;
<a name="l01082"></a>01082 
<a name="l01083"></a>01083       <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>, oedge;
<a name="l01084"></a>01084       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); p++)
<a name="l01085"></a>01085       {
<a name="l01086"></a>01086          <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ad64d836e54ad48b8e4d98a4f20f895d4" title="Return the indices and the orientations of all edges of element i.">GetElementEdges</a>(p, edges, oedge);
<a name="l01087"></a>01087          <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01088"></a>01088          {
<a name="l01089"></a>01089             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[0])] == NULL)
<a name="l01090"></a>01090                <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[0])] =
<a name="l01091"></a>01091                   <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;GetKV(0));
<a name="l01092"></a>01092             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[1])] == NULL)
<a name="l01093"></a>01093                <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[1])] =
<a name="l01094"></a>01094                   <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;GetKV(1));
<a name="l01095"></a>01095          }
<a name="l01096"></a>01096          <span class="keywordflow">else</span>
<a name="l01097"></a>01097          {
<a name="l01098"></a>01098             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[0])] == NULL)
<a name="l01099"></a>01099                <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[0])] =
<a name="l01100"></a>01100                   <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;GetKV(0));
<a name="l01101"></a>01101             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[3])] == NULL)
<a name="l01102"></a>01102                <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[3])] =
<a name="l01103"></a>01103                   <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;GetKV(1));
<a name="l01104"></a>01104             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[8])] == NULL)
<a name="l01105"></a>01105                <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[8])] =
<a name="l01106"></a>01106                   <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;GetKV(2));
<a name="l01107"></a>01107          }
<a name="l01108"></a>01108       }
<a name="l01109"></a>01109       <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[0]-&gt;GetOrder();
<a name="l01110"></a>01110    }
<a name="l01111"></a>01111 
<a name="l01112"></a>01112    <a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">GenerateOffsets</a>();
<a name="l01113"></a>01113    <a class="code" href="classNURBSExtension.html#a4ed56f35617596d289b95c619fdfc295">CountElements</a>();
<a name="l01114"></a>01114    <a class="code" href="classNURBSExtension.html#a9d22ac33937a4041ee319df0e94f403e">CountBdrElements</a>();
<a name="l01115"></a>01115    <span class="comment">// NumOfVertices, NumOfElements, NumOfBdrElements, NumOfDofs</span>
<a name="l01116"></a>01116 
<a name="l01117"></a>01117    <a class="code" href="mesh_8cpp.html#aa40be394965a0e6c047d6581597b0143">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);
<a name="l01118"></a>01118 
<a name="l01119"></a>01119    <span class="comment">// Check for a list of mesh elements</span>
<a name="l01120"></a>01120    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 0)
<a name="l01121"></a>01121       input &gt;&gt; ws &gt;&gt; ident;
<a name="l01122"></a>01122    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 0 &amp;&amp; ident == <span class="stringliteral">&quot;mesh_elements&quot;</span>)
<a name="l01123"></a>01123    {
<a name="l01124"></a>01124       input &gt;&gt; <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>;
<a name="l01125"></a>01125       <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a1e64151d349c38b21880f1e6d75907de">GetGNE</a>());
<a name="l01126"></a>01126       <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a> = <span class="keyword">false</span>;
<a name="l01127"></a>01127       <span class="keywordtype">int</span> glob_elem;
<a name="l01128"></a>01128       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>; i++)
<a name="l01129"></a>01129       {
<a name="l01130"></a>01130          input &gt;&gt; glob_elem;
<a name="l01131"></a>01131          <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[glob_elem] = <span class="keyword">true</span>;
<a name="l01132"></a>01132       }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134       <a class="code" href="mesh_8cpp.html#aa40be394965a0e6c047d6581597b0143">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);
<a name="l01135"></a>01135       input &gt;&gt; ws &gt;&gt; ident;
<a name="l01136"></a>01136    }
<a name="l01137"></a>01137    <span class="keywordflow">else</span>
<a name="l01138"></a>01138    {
<a name="l01139"></a>01139       <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a> = <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>;
<a name="l01140"></a>01140       <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>);
<a name="l01141"></a>01141       <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a> = <span class="keyword">true</span>;
<a name="l01142"></a>01142    }
<a name="l01143"></a>01143 
<a name="l01144"></a>01144    <a class="code" href="classNURBSExtension.html#a33aed832cbcf8e58f1f7dadaa27872a6">GenerateActiveVertices</a>();
<a name="l01145"></a>01145    <a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">GenerateElementDofTable</a>();
<a name="l01146"></a>01146    <a class="code" href="classNURBSExtension.html#a99a03b0c2ae3a3eca39129f1e1941cc7">GenerateActiveBdrElems</a>();
<a name="l01147"></a>01147    <a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">GenerateBdrElementDofTable</a>();
<a name="l01148"></a>01148 
<a name="l01149"></a>01149    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 0)
<a name="l01150"></a>01150    {
<a name="l01151"></a>01151       <span class="comment">// weights</span>
<a name="l01152"></a>01152       <span class="keywordflow">if</span> (ident == <span class="stringliteral">&quot;weights&quot;</span>)
<a name="l01153"></a>01153       {
<a name="l01154"></a>01154          <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#ab81369435143fa2e5898c36542fffee2" title="Reads a vector from multpile files.">Load</a>(input, <a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l01155"></a>01155       }
<a name="l01156"></a>01156       <span class="keywordflow">else</span> <span class="comment">// e.g. ident = &quot;unitweights&quot; or &quot;autoweights&quot;</span>
<a name="l01157"></a>01157       {
<a name="l01158"></a>01158          <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l01159"></a>01159          <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a> = 1.0;
<a name="l01160"></a>01160       }
<a name="l01161"></a>01161    }
<a name="l01162"></a>01162 }
<a name="l01163"></a>01163 
<a name="l01164"></a><a class="code" href="classNURBSExtension.html#a83b8720b73b6188f6380f9b75c8f57c4">01164</a> <a class="code" href="classNURBSExtension.html#a81b2bd9053206c62fe511e809cd6bc5a">NURBSExtension::NURBSExtension</a>(<a class="code" href="classNURBSExtension.html">NURBSExtension</a> *parent, <span class="keywordtype">int</span> Order_)
<a name="l01165"></a>01165 {
<a name="l01166"></a>01166    <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = Order_;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>;
<a name="l01169"></a>01169    <a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 0;
<a name="l01170"></a>01170 
<a name="l01171"></a>01171    parent-&gt;<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>);
<a name="l01172"></a>01172 
<a name="l01173"></a>01173    <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a1909a4dd8a03517ea995b3981855e385">GetNKV</a>();
<a name="l01174"></a>01174    <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>);
<a name="l01175"></a>01175    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l01176"></a>01176    {
<a name="l01177"></a>01177       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i] =
<a name="l01178"></a>01178          parent-&gt;<a class="code" href="classNURBSExtension.html#a15a65ddfd713d7b9e81844b0f9577f54">GetKnotVector</a>(i)-&gt;<a class="code" href="classKnotVector.html#a49af64a9d2f6514ec718e7c9b1a891c2">DegreeElevate</a>(<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>-parent-&gt;<a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>());
<a name="l01179"></a>01179    }
<a name="l01180"></a>01180 
<a name="l01181"></a>01181    <span class="comment">// copy some data from parent</span>
<a name="l01182"></a>01182    <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>    = parent-&gt;<a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>;
<a name="l01183"></a>01183    <a class="code" href="classNURBSExtension.html#a769c1875dc688910703134d5648f2a35">NumOfBdrElements</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a769c1875dc688910703134d5648f2a35">NumOfBdrElements</a>;
<a name="l01184"></a>01184 
<a name="l01185"></a>01185    <a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">GenerateOffsets</a>(); <span class="comment">// dof offsets will be different from parent</span>
<a name="l01186"></a>01186 
<a name="l01187"></a>01187    <a class="code" href="classNURBSExtension.html#a8eadbcb47dfa0cb4cd1fc01c629c5ef5">NumOfActiveVertices</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a8eadbcb47dfa0cb4cd1fc01c629c5ef5">NumOfActiveVertices</a>;
<a name="l01188"></a>01188    <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>    = parent-&gt;<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>;
<a name="l01189"></a>01189    <a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>;
<a name="l01190"></a>01190    parent-&gt;<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>);
<a name="l01191"></a>01191    parent-&gt;<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>);
<a name="l01192"></a>01192    parent-&gt;<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>);
<a name="l01193"></a>01193 
<a name="l01194"></a>01194    <a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">GenerateElementDofTable</a>();
<a name="l01195"></a>01195    <a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">GenerateBdrElementDofTable</a>();
<a name="l01196"></a>01196 
<a name="l01197"></a>01197    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l01198"></a>01198    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a> = 1.0;
<a name="l01199"></a>01199 }
<a name="l01200"></a>01200 
<a name="l01201"></a><a class="code" href="classNURBSExtension.html#a317ff06a99f24bf5c5d9e605bd5e7f04">01201</a> <a class="code" href="classNURBSExtension.html#a81b2bd9053206c62fe511e809cd6bc5a">NURBSExtension::NURBSExtension</a>(<a class="code" href="classMesh.html">Mesh</a> *mesh_array[], <span class="keywordtype">int</span> num_pieces)
<a name="l01202"></a>01202 {
<a name="l01203"></a>01203    <a class="code" href="classNURBSExtension.html">NURBSExtension</a> *parent = mesh_array[0]-&gt;<a class="code" href="classMesh.html#ae8d55e6724be37aff3b77ec9fbcff556">NURBSext</a>;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205    <span class="keywordflow">if</span> (!parent-&gt;<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a>)
<a name="l01206"></a>01206       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSExtension::NURBSExtension :\n&quot;</span>
<a name="l01207"></a>01207                  <span class="stringliteral">&quot;  parent does not own the patch topology!&quot;</span>);
<a name="l01208"></a>01208    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>;
<a name="l01209"></a>01209    <a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 1;
<a name="l01210"></a>01210    parent-&gt;<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 0;
<a name="l01211"></a>01211 
<a name="l01212"></a>01212    parent-&gt;<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>);
<a name="l01213"></a>01213 
<a name="l01214"></a>01214    <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>();
<a name="l01215"></a>01215 
<a name="l01216"></a>01216    <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a1909a4dd8a03517ea995b3981855e385">GetNKV</a>();
<a name="l01217"></a>01217    <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>);
<a name="l01218"></a>01218    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l01219"></a>01219    {
<a name="l01220"></a>01220       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*parent-&gt;<a class="code" href="classNURBSExtension.html#a15a65ddfd713d7b9e81844b0f9577f54">GetKnotVector</a>(i));
<a name="l01221"></a>01221    }
<a name="l01222"></a>01222 
<a name="l01223"></a>01223    <a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">GenerateOffsets</a>();
<a name="l01224"></a>01224    <a class="code" href="classNURBSExtension.html#a4ed56f35617596d289b95c619fdfc295">CountElements</a>();
<a name="l01225"></a>01225    <a class="code" href="classNURBSExtension.html#a9d22ac33937a4041ee319df0e94f403e">CountBdrElements</a>();
<a name="l01226"></a>01226 
<a name="l01227"></a>01227    <span class="comment">// assuming the meshes define a partitioning of all the elements</span>
<a name="l01228"></a>01228    <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a> = <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>;
<a name="l01229"></a>01229    <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>);
<a name="l01230"></a>01230    <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a> = <span class="keyword">true</span>;
<a name="l01231"></a>01231 
<a name="l01232"></a>01232    <a class="code" href="classNURBSExtension.html#a33aed832cbcf8e58f1f7dadaa27872a6">GenerateActiveVertices</a>();
<a name="l01233"></a>01233    <a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">GenerateElementDofTable</a>();
<a name="l01234"></a>01234    <a class="code" href="classNURBSExtension.html#a99a03b0c2ae3a3eca39129f1e1941cc7">GenerateActiveBdrElems</a>();
<a name="l01235"></a>01235    <a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">GenerateBdrElementDofTable</a>();
<a name="l01236"></a>01236 
<a name="l01237"></a>01237    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l01238"></a>01238    <a class="code" href="classNURBSExtension.html#a4c2d531892b4dde21095eb97965cacc1">MergeWeights</a>(mesh_array, num_pieces);
<a name="l01239"></a>01239 }
<a name="l01240"></a>01240 
<a name="l01241"></a><a class="code" href="classNURBSExtension.html#a2b81a03398d1ea136ff0bb306e414006">01241</a> <a class="code" href="classNURBSExtension.html#a2b81a03398d1ea136ff0bb306e414006" title="Destroy a NURBSExtension.">NURBSExtension::~NURBSExtension</a>()
<a name="l01242"></a>01242 {
<a name="l01243"></a>01243    <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>;
<a name="l01244"></a>01244    <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>;
<a name="l01245"></a>01245 
<a name="l01246"></a>01246    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l01247"></a>01247       <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i];
<a name="l01248"></a>01248 
<a name="l01249"></a>01249    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l01250"></a>01250       <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[i];
<a name="l01251"></a>01251 
<a name="l01252"></a>01252    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a>)
<a name="l01253"></a>01253       <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>;
<a name="l01254"></a>01254 }
<a name="l01255"></a>01255 
<a name="l01256"></a><a class="code" href="classNURBSExtension.html#a72a124610b3189e0dbaeaa2093254e6b">01256</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a72a124610b3189e0dbaeaa2093254e6b">NURBSExtension::Print</a>(ostream &amp;out)<span class="keyword"> const</span>
<a name="l01257"></a>01257 <span class="keyword"></span>{
<a name="l01258"></a>01258    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a999f2dce211e4118603748813e28882b">PrintTopo</a>(out, <a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>);
<a name="l01259"></a>01259    out &lt;&lt; <span class="stringliteral">&quot;\nknotvectors\n&quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01260"></a>01260    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l01261"></a>01261    {
<a name="l01262"></a>01262       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i]-&gt;<a class="code" href="classArray.html#a2000e610a94979cdaeb0677b42370c0e" title="Prints array to stream with width elements per row.">Print</a>(out);
<a name="l01263"></a>01263    }
<a name="l01264"></a>01264 
<a name="l01265"></a>01265    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a> &lt; <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>)
<a name="l01266"></a>01266    {
<a name="l01267"></a>01267       out &lt;&lt; <span class="stringliteral">&quot;\nmesh_elements\n&quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01268"></a>01268       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>; i++)
<a name="l01269"></a>01269          <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[i])
<a name="l01270"></a>01270             out &lt;&lt; i &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01271"></a>01271    }
<a name="l01272"></a>01272 
<a name="l01273"></a>01273    out &lt;&lt; <span class="stringliteral">&quot;\nweights\n&quot;</span>;
<a name="l01274"></a>01274    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#adf967646f20e7a903b856b859f38a15d" title="Prints vector to stream out.">Print</a>(out, 1);
<a name="l01275"></a>01275 }
<a name="l01276"></a>01276 
<a name="l01277"></a><a class="code" href="classNURBSExtension.html#a1dbe288c87f1cba421121acf908e9c3c">01277</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a1dbe288c87f1cba421121acf908e9c3c">NURBSExtension::PrintCharacteristics</a>(ostream &amp;out)
<a name="l01278"></a>01278 {
<a name="l01279"></a>01279    out &lt;&lt;
<a name="l01280"></a>01280       <span class="stringliteral">&quot;NURBS Mesh entity sizes:\n&quot;</span>
<a name="l01281"></a>01281       <span class="stringliteral">&quot;Dimension           = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01282"></a>01282       <span class="stringliteral">&quot;Order               = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01283"></a>01283       <span class="stringliteral">&quot;NumOfKnotVectors    = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a1909a4dd8a03517ea995b3981855e385">GetNKV</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01284"></a>01284       <span class="stringliteral">&quot;NumOfPatches        = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01285"></a>01285       <span class="stringliteral">&quot;NumOfBdrPatches     = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01286"></a>01286       <span class="stringliteral">&quot;NumOfVertices       = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#aa4396c5c62c6938c64c527de13b94fac">GetGNV</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01287"></a>01287       <span class="stringliteral">&quot;NumOfElements       = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a1e64151d349c38b21880f1e6d75907de">GetGNE</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01288"></a>01288       <span class="stringliteral">&quot;NumOfBdrElements    = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a37379baa6cbaaad34f89740ac5410a1c">GetGNBE</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01289"></a>01289       <span class="stringliteral">&quot;NumOfDofs           = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a2c6b3f4268dfaa0f0a0369a59fa776ce">GetNTotalDof</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01290"></a>01290       <span class="stringliteral">&quot;NumOfActiveVertices = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a542aa527c3ca2e57064d2b0526b845f6">GetNV</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01291"></a>01291       <span class="stringliteral">&quot;NumOfActiveElems    = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01292"></a>01292       <span class="stringliteral">&quot;NumOfActiveBdrElems = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#a6db4f05b433f8af16621a487fb59876e">GetNBE</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>
<a name="l01293"></a>01293       <span class="stringliteral">&quot;NumOfActiveDofs     = &quot;</span> &lt;&lt; <a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01294"></a>01294    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l01295"></a>01295    {
<a name="l01296"></a>01296       out &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; i + 1 &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;
<a name="l01297"></a>01297       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i]-&gt;<a class="code" href="classArray.html#a2000e610a94979cdaeb0677b42370c0e" title="Prints array to stream with width elements per row.">Print</a>(out);
<a name="l01298"></a>01298    }
<a name="l01299"></a>01299    cout &lt;&lt; endl;
<a name="l01300"></a>01300 }
<a name="l01301"></a>01301 
<a name="l01302"></a><a class="code" href="classNURBSExtension.html#a33aed832cbcf8e58f1f7dadaa27872a6">01302</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a33aed832cbcf8e58f1f7dadaa27872a6">NURBSExtension::GenerateActiveVertices</a>()
<a name="l01303"></a>01303 {
<a name="l01304"></a>01304    <span class="keywordtype">int</span> vert[8], nv, g_el, nx, ny, nz, dim = <a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>();
<a name="l01305"></a>01305 
<a name="l01306"></a>01306    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01307"></a>01307    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[3];
<a name="l01308"></a>01308 
<a name="l01309"></a>01309    g_el = 0;
<a name="l01310"></a>01310    <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#aa4396c5c62c6938c64c527de13b94fac">GetGNV</a>());
<a name="l01311"></a>01311    <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a> = -1;
<a name="l01312"></a>01312    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01313"></a>01313    {
<a name="l01314"></a>01314       p2g.<a class="code" href="classNURBSPatchMap.html#ac51964077cdb3ad121f8d49c0dff5d9e">SetPatchVertexMap</a>(p, kv);
<a name="l01315"></a>01315 
<a name="l01316"></a>01316       nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>();
<a name="l01317"></a>01317       ny = p2g.<a class="code" href="classNURBSPatchMap.html#abdc2aced71b86ee6440c86489d136847">ny</a>();
<a name="l01318"></a>01318       nz = (dim == 3) ? p2g.<a class="code" href="classNURBSPatchMap.html#adb9516a3b9f5c3bb30434ecb4c4581ab">nz</a>() : 1;
<a name="l01319"></a>01319 
<a name="l01320"></a>01320       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nz; k++)
<a name="l01321"></a>01321       {
<a name="l01322"></a>01322          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ny; j++)
<a name="l01323"></a>01323          {
<a name="l01324"></a>01324             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nx; i++)
<a name="l01325"></a>01325             {
<a name="l01326"></a>01326                <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[g_el])
<a name="l01327"></a>01327                {
<a name="l01328"></a>01328                   <span class="keywordflow">if</span> (dim == 2)
<a name="l01329"></a>01329                   {
<a name="l01330"></a>01330                      vert[0] = p2g(i,  j  );
<a name="l01331"></a>01331                      vert[1] = p2g(i+1,j  );
<a name="l01332"></a>01332                      vert[2] = p2g(i+1,j+1);
<a name="l01333"></a>01333                      vert[3] = p2g(i,  j+1);
<a name="l01334"></a>01334                      nv = 4;
<a name="l01335"></a>01335                   }
<a name="l01336"></a>01336                   <span class="keywordflow">else</span>
<a name="l01337"></a>01337                   {
<a name="l01338"></a>01338                      vert[0] = p2g(i,  j,  k);
<a name="l01339"></a>01339                      vert[1] = p2g(i+1,j,  k);
<a name="l01340"></a>01340                      vert[2] = p2g(i+1,j+1,k);
<a name="l01341"></a>01341                      vert[3] = p2g(i,  j+1,k);
<a name="l01342"></a>01342 
<a name="l01343"></a>01343                      vert[4] = p2g(i,  j,  k+1);
<a name="l01344"></a>01344                      vert[5] = p2g(i+1,j,  k+1);
<a name="l01345"></a>01345                      vert[6] = p2g(i+1,j+1,k+1);
<a name="l01346"></a>01346                      vert[7] = p2g(i,  j+1,k+1);
<a name="l01347"></a>01347                      nv = 8;
<a name="l01348"></a>01348                   }
<a name="l01349"></a>01349 
<a name="l01350"></a>01350                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; nv; v++)
<a name="l01351"></a>01351                      <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[vert[v]] = 1;
<a name="l01352"></a>01352                }
<a name="l01353"></a>01353                g_el++;
<a name="l01354"></a>01354             }
<a name="l01355"></a>01355          }
<a name="l01356"></a>01356       }
<a name="l01357"></a>01357    }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359    <a class="code" href="classNURBSExtension.html#a8eadbcb47dfa0cb4cd1fc01c629c5ef5">NumOfActiveVertices</a> = 0;
<a name="l01360"></a>01360    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#aa4396c5c62c6938c64c527de13b94fac">GetGNV</a>(); i++)
<a name="l01361"></a>01361       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[i] == 1)
<a name="l01362"></a>01362          <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[i] = <a class="code" href="classNURBSExtension.html#a8eadbcb47dfa0cb4cd1fc01c629c5ef5">NumOfActiveVertices</a>++;
<a name="l01363"></a>01363 }
<a name="l01364"></a>01364 
<a name="l01365"></a><a class="code" href="classNURBSExtension.html#a99a03b0c2ae3a3eca39129f1e1941cc7">01365</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a99a03b0c2ae3a3eca39129f1e1941cc7">NURBSExtension::GenerateActiveBdrElems</a>()
<a name="l01366"></a>01366 {
<a name="l01367"></a>01367    <span class="keywordtype">int</span> dim = <a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>();
<a name="l01368"></a>01368    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(dim);
<a name="l01369"></a>01369 
<a name="l01370"></a>01370    <a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a37379baa6cbaaad34f89740ac5410a1c">GetGNBE</a>());
<a name="l01371"></a>01371    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1e64151d349c38b21880f1e6d75907de">GetGNE</a>() == <a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>())
<a name="l01372"></a>01372    {
<a name="l01373"></a>01373       <a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a> = <span class="keyword">true</span>;
<a name="l01374"></a>01374       <a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a> = <a class="code" href="classNURBSExtension.html#a37379baa6cbaaad34f89740ac5410a1c">GetGNBE</a>();
<a name="l01375"></a>01375       <span class="keywordflow">return</span>;
<a name="l01376"></a>01376    }
<a name="l01377"></a>01377    <a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a> = <span class="keyword">false</span>;
<a name="l01378"></a>01378    <a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a> = 0;
<a name="l01379"></a>01379    <span class="comment">// the mesh will generate the actual boundary including boundary</span>
<a name="l01380"></a>01380    <span class="comment">// elements that are not on boundary patches. we use this for</span>
<a name="l01381"></a>01381    <span class="comment">// visialization of processor boundaries</span>
<a name="l01382"></a>01382 
<a name="l01383"></a>01383    <span class="comment">// TODO: generate actual boundary?</span>
<a name="l01384"></a>01384 }
<a name="l01385"></a>01385 
<a name="l01386"></a>01386 
<a name="l01387"></a><a class="code" href="classNURBSExtension.html#a4c2d531892b4dde21095eb97965cacc1">01387</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a4c2d531892b4dde21095eb97965cacc1">NURBSExtension::MergeWeights</a>(<a class="code" href="classMesh.html">Mesh</a> *mesh_array[], <span class="keywordtype">int</span> num_pieces)
<a name="l01388"></a>01388 {
<a name="l01389"></a>01389    <a class="code" href="classArray.html">Array&lt;int&gt;</a> lelem_elem;
<a name="l01390"></a>01390 
<a name="l01391"></a>01391    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_pieces; i++)
<a name="l01392"></a>01392    {
<a name="l01393"></a>01393       <a class="code" href="classNURBSExtension.html">NURBSExtension</a> *lext = mesh_array[i]-&gt;<a class="code" href="classMesh.html#ae8d55e6724be37aff3b77ec9fbcff556">NURBSext</a>;
<a name="l01394"></a>01394 
<a name="l01395"></a>01395       lext-&gt;<a class="code" href="classNURBSExtension.html#a582750744f34a41f77d8be9fc34d1c3f">GetElementLocalToGlobal</a>(lelem_elem);
<a name="l01396"></a>01396 
<a name="l01397"></a>01397       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lel = 0; lel &lt; lext-&gt;<a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>(); lel++)
<a name="l01398"></a>01398       {
<a name="l01399"></a>01399          <span class="keywordtype">int</span> gel = lelem_elem[lel];
<a name="l01400"></a>01400 
<a name="l01401"></a>01401          <span class="keywordtype">int</span> nd = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#aa545ece6d05545a66cf42810e158c489">RowSize</a>(gel);
<a name="l01402"></a>01402          <span class="keywordtype">int</span> *gdofs = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(gel);
<a name="l01403"></a>01403          <span class="keywordtype">int</span> *ldofs = lext-&gt;<a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(lel);
<a name="l01404"></a>01404          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nd; j++)
<a name="l01405"></a>01405             <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(gdofs[j]) = lext-&gt;<a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(ldofs[j]);
<a name="l01406"></a>01406       }
<a name="l01407"></a>01407    }
<a name="l01408"></a>01408 }
<a name="l01409"></a>01409 
<a name="l01410"></a><a class="code" href="classNURBSExtension.html#ab729a4cb9bdaa5d28a7a0562786073c2">01410</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#ab729a4cb9bdaa5d28a7a0562786073c2">NURBSExtension::MergeGridFunctions</a>(
<a name="l01411"></a>01411    <a class="code" href="classGridFunction.html" title="Class for grid function - Vector with asociated FE space.">GridFunction</a> *gf_array[], <span class="keywordtype">int</span> num_pieces, <a class="code" href="classGridFunction.html" title="Class for grid function - Vector with asociated FE space.">GridFunction</a> &amp;merged)
<a name="l01412"></a>01412 {
<a name="l01413"></a>01413    <a class="code" href="classFiniteElementSpace.html" title="Abstract finite element space.">FiniteElementSpace</a> *gfes = merged.<a class="code" href="classGridFunction.html#a6b31d45d8ab7917db5e1173686ed2968">FESpace</a>();
<a name="l01414"></a>01414    <a class="code" href="classArray.html">Array&lt;int&gt;</a> lelem_elem, dofs;
<a name="l01415"></a>01415    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> lvec;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_pieces; i++)
<a name="l01418"></a>01418    {
<a name="l01419"></a>01419       <a class="code" href="classFiniteElementSpace.html" title="Abstract finite element space.">FiniteElementSpace</a> *lfes = gf_array[i]-&gt;<a class="code" href="classGridFunction.html#a6b31d45d8ab7917db5e1173686ed2968">FESpace</a>();
<a name="l01420"></a>01420       <a class="code" href="classNURBSExtension.html">NURBSExtension</a> *lext = lfes-&gt;<a class="code" href="classFiniteElementSpace.html#af94936ea008e6e1f7b6600a627164582" title="Returns the mesh.">GetMesh</a>()-&gt;<a class="code" href="classMesh.html#ae8d55e6724be37aff3b77ec9fbcff556">NURBSext</a>;
<a name="l01421"></a>01421 
<a name="l01422"></a>01422       lext-&gt;<a class="code" href="classNURBSExtension.html#a582750744f34a41f77d8be9fc34d1c3f">GetElementLocalToGlobal</a>(lelem_elem);
<a name="l01423"></a>01423 
<a name="l01424"></a>01424       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lel = 0; lel &lt; lext-&gt;<a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>(); lel++)
<a name="l01425"></a>01425       {
<a name="l01426"></a>01426          lfes-&gt;<a class="code" href="classFiniteElementSpace.html#a5a940d53000fa449cce79fd614b46da8" title="Returns indexes of degrees of freedom in array dofs for i&#39;th element.">GetElementVDofs</a>(lel, dofs);
<a name="l01427"></a>01427          gf_array[i]-&gt;<a class="code" href="classVector.html#ab9f417235f435b9cafc1c7caf99ea2f6">GetSubVector</a>(dofs, lvec);
<a name="l01428"></a>01428 
<a name="l01429"></a>01429          gfes-&gt;<a class="code" href="classFiniteElementSpace.html#a5a940d53000fa449cce79fd614b46da8" title="Returns indexes of degrees of freedom in array dofs for i&#39;th element.">GetElementVDofs</a>(lelem_elem[lel], dofs);
<a name="l01430"></a>01430          merged.<a class="code" href="classVector.html#ac5ba98844eb09dc0a74e34f9a77da564">SetSubVector</a>(dofs, lvec);
<a name="l01431"></a>01431       }
<a name="l01432"></a>01432    }
<a name="l01433"></a>01433 }
<a name="l01434"></a>01434 
<a name="l01435"></a><a class="code" href="classNURBSExtension.html#a55e52e7b0645c1c37b63407d38367bb1">01435</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a55e52e7b0645c1c37b63407d38367bb1">NURBSExtension::CheckPatches</a>()
<a name="l01436"></a>01436 {
<a name="l01437"></a>01437    <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>;
<a name="l01438"></a>01438    <a class="code" href="classArray.html">Array&lt;int&gt;</a> oedge;
<a name="l01439"></a>01439 
<a name="l01440"></a>01440    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01441"></a>01441    {
<a name="l01442"></a>01442       <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ad64d836e54ad48b8e4d98a4f20f895d4" title="Return the indices and the orientations of all edges of element i.">GetElementEdges</a>(p, edges, oedge);
<a name="l01443"></a>01443 
<a name="l01444"></a>01444       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edges.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l01445"></a>01445       {
<a name="l01446"></a>01446          edges[i] = <a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>[edges[i]];
<a name="l01447"></a>01447          <span class="keywordflow">if</span> (oedge[i] &lt; 0)
<a name="l01448"></a>01448             edges[i] = -1 - edges[i];
<a name="l01449"></a>01449       }
<a name="l01450"></a>01450 
<a name="l01451"></a>01451       <span class="keywordflow">if</span> ((<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2 &amp;&amp;
<a name="l01452"></a>01452            (edges[0] != -1 - edges[2] || edges[1] != -1 - edges[3])) ||
<a name="l01453"></a>01453 
<a name="l01454"></a>01454           (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 3 &amp;&amp;
<a name="l01455"></a>01455            (edges[0] != edges[2] || edges[0] != edges[4] ||
<a name="l01456"></a>01456             edges[0] != edges[6] || edges[1] != edges[3] ||
<a name="l01457"></a>01457             edges[1] != edges[5] || edges[1] != edges[7] ||
<a name="l01458"></a>01458             edges[8] != edges[9] || edges[8] != edges[10] ||
<a name="l01459"></a>01459             edges[8] != edges[11])))
<a name="l01460"></a>01460       {
<a name="l01461"></a>01461          cerr &lt;&lt; <span class="stringliteral">&quot;NURBSExtension::CheckPatch (patch = &quot;</span> &lt;&lt; p
<a name="l01462"></a>01462               &lt;&lt; <span class="stringliteral">&quot;)\n  Inconsistent edge-to-knot mapping!\n&quot;</span>;
<a name="l01463"></a>01463          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l01464"></a>01464       }
<a name="l01465"></a>01465 
<a name="l01466"></a>01466       <span class="keywordflow">if</span> ((<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2 &amp;&amp;
<a name="l01467"></a>01467            (edges[0] &lt; 0 || edges[1] &lt; 0)) ||
<a name="l01468"></a>01468 
<a name="l01469"></a>01469           (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 3 &amp;&amp;
<a name="l01470"></a>01470            (edges[0] &lt; 0 || edges[3] &lt; 0 || edges[8] &lt; 0)))
<a name="l01471"></a>01471       {
<a name="l01472"></a>01472          cerr &lt;&lt; <span class="stringliteral">&quot;NURBSExtension::CheckPatch (patch = &quot;</span> &lt;&lt; p
<a name="l01473"></a>01473               &lt;&lt; <span class="stringliteral">&quot;) : Bad orientation!\n&quot;</span>;
<a name="l01474"></a>01474          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l01475"></a>01475       }
<a name="l01476"></a>01476    }
<a name="l01477"></a>01477 }
<a name="l01478"></a>01478 
<a name="l01479"></a><a class="code" href="classNURBSExtension.html#a492c9e5a81ea1ffe48067588e0af3fb7">01479</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a492c9e5a81ea1ffe48067588e0af3fb7">NURBSExtension::CheckBdrPatches</a>()
<a name="l01480"></a>01480 {
<a name="l01481"></a>01481    <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>;
<a name="l01482"></a>01482    <a class="code" href="classArray.html">Array&lt;int&gt;</a> oedge;
<a name="l01483"></a>01483 
<a name="l01484"></a>01484    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>(); p++)
<a name="l01485"></a>01485    {
<a name="l01486"></a>01486       <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a81b2e6ff28d3040e8932bbbe7bf664be" title="Return the indices and the orientations of all edges of bdr element i.">GetBdrElementEdges</a>(p, edges, oedge);
<a name="l01487"></a>01487 
<a name="l01488"></a>01488       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edges.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l01489"></a>01489       {
<a name="l01490"></a>01490          edges[i] = <a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>[edges[i]];
<a name="l01491"></a>01491          <span class="keywordflow">if</span> (oedge[i] &lt; 0)
<a name="l01492"></a>01492             edges[i] = -1 - edges[i];
<a name="l01493"></a>01493       }
<a name="l01494"></a>01494 
<a name="l01495"></a>01495       <span class="keywordflow">if</span> ((<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2 &amp;&amp; (edges[0] &lt; 0)) ||
<a name="l01496"></a>01496           (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 3 &amp;&amp; (edges[0] &lt; 0 || edges[1] &lt; 0)))
<a name="l01497"></a>01497       {
<a name="l01498"></a>01498          cerr &lt;&lt; <span class="stringliteral">&quot;NURBSExtension::CheckBdrPatch (boundary patch = &quot;</span>
<a name="l01499"></a>01499               &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;) : Bad orientation!\n&quot;</span>;
<a name="l01500"></a>01500          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l01501"></a>01501       }
<a name="l01502"></a>01502    }
<a name="l01503"></a>01503 }
<a name="l01504"></a>01504 
<a name="l01505"></a><a class="code" href="classNURBSExtension.html#af3b10dc9e4148b48d90498261c22dbe2">01505</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#af3b10dc9e4148b48d90498261c22dbe2">NURBSExtension::GetPatchKnotVectors</a>(<span class="keywordtype">int</span> p, <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> &amp;kv)
<a name="l01506"></a>01506 {
<a name="l01507"></a>01507    <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>;
<a name="l01508"></a>01508    <a class="code" href="classArray.html">Array&lt;int&gt;</a> orient;
<a name="l01509"></a>01509 
<a name="l01510"></a>01510    kv.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>());
<a name="l01511"></a>01511    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ad64d836e54ad48b8e4d98a4f20f895d4" title="Return the indices and the orientations of all edges of element i.">GetElementEdges</a>(p, edges, orient);
<a name="l01512"></a>01512 
<a name="l01513"></a>01513    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01514"></a>01514    {
<a name="l01515"></a>01515       kv[0] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0]);
<a name="l01516"></a>01516       kv[1] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[1]);
<a name="l01517"></a>01517    }
<a name="l01518"></a>01518    <span class="keywordflow">else</span>
<a name="l01519"></a>01519    {
<a name="l01520"></a>01520       kv[0] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0]);
<a name="l01521"></a>01521       kv[1] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[3]);
<a name="l01522"></a>01522       kv[2] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[8]);
<a name="l01523"></a>01523    }
<a name="l01524"></a>01524 }
<a name="l01525"></a>01525 
<a name="l01526"></a><a class="code" href="classNURBSExtension.html#ac94f2ac1e2c7ca6e18394b40545abe87">01526</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#ac94f2ac1e2c7ca6e18394b40545abe87">NURBSExtension::GetBdrPatchKnotVectors</a>(<span class="keywordtype">int</span> p, <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> &amp;kv)
<a name="l01527"></a>01527 {
<a name="l01528"></a>01528    <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>;
<a name="l01529"></a>01529    <a class="code" href="classArray.html">Array&lt;int&gt;</a> orient;
<a name="l01530"></a>01530 
<a name="l01531"></a>01531    kv.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() - 1);
<a name="l01532"></a>01532    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a81b2e6ff28d3040e8932bbbe7bf664be" title="Return the indices and the orientations of all edges of bdr element i.">GetBdrElementEdges</a>(p, edges, orient);
<a name="l01533"></a>01533 
<a name="l01534"></a>01534    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01535"></a>01535    {
<a name="l01536"></a>01536       kv[0] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0]);
<a name="l01537"></a>01537    }
<a name="l01538"></a>01538    <span class="keywordflow">else</span>
<a name="l01539"></a>01539    {
<a name="l01540"></a>01540       kv[0] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0]);
<a name="l01541"></a>01541       kv[1] = <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[1]);
<a name="l01542"></a>01542    }
<a name="l01543"></a>01543 }
<a name="l01544"></a>01544 
<a name="l01545"></a><a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">01545</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">NURBSExtension::GenerateOffsets</a>()
<a name="l01546"></a>01546 {
<a name="l01547"></a>01547    <span class="keywordtype">int</span> nv = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ac2d12b05fea355a064bb01252c04b461" title="Returns number of vertices.">GetNV</a>();
<a name="l01548"></a>01548    <span class="keywordtype">int</span> ne = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a7fbb3520555d1b8ae2470b55f9412ae7" title="Return the number of edges.">GetNEdges</a>();
<a name="l01549"></a>01549    <span class="keywordtype">int</span> nf = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a8d62b1e35070e17a642a76de423480ac">GetNFaces</a>();
<a name="l01550"></a>01550    <span class="keywordtype">int</span> np = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ab6b8177d6bde4dffb5a03d4944cf4465" title="Returns number of elements.">GetNE</a>();
<a name="l01551"></a>01551    <span class="keywordtype">int</span> meshCounter, spaceCounter, dim = <a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>();
<a name="l01552"></a>01552 
<a name="l01553"></a>01553    <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>;
<a name="l01554"></a>01554    <a class="code" href="classArray.html">Array&lt;int&gt;</a> orient;
<a name="l01555"></a>01555 
<a name="l01556"></a>01556    <a class="code" href="classNURBSExtension.html#a8595e29dd7ff9f0b0e3cf774d322e481">v_meshOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nv);
<a name="l01557"></a>01557    <a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(ne);
<a name="l01558"></a>01558    <a class="code" href="classNURBSExtension.html#a9dbd9c98dfcb9c452e59dae6d76cc4d6">f_meshOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nf);
<a name="l01559"></a>01559    <a class="code" href="classNURBSExtension.html#ab0d640285d9a090cbbf74284cf0d5471">p_meshOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(np);
<a name="l01560"></a>01560 
<a name="l01561"></a>01561    <a class="code" href="classNURBSExtension.html#a119ef907f1232beb4609e4f004a0d714">v_spaceOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nv);
<a name="l01562"></a>01562    <a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(ne);
<a name="l01563"></a>01563    <a class="code" href="classNURBSExtension.html#a7b5ad39811917018a0a5cdb00dafc497">f_spaceOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nf);
<a name="l01564"></a>01564    <a class="code" href="classNURBSExtension.html#a4fb455a9e4a49dcb3534b999c48c1972">p_spaceOffsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(np);
<a name="l01565"></a>01565 
<a name="l01566"></a>01566    <span class="comment">// Get vertex offsets</span>
<a name="l01567"></a>01567    <span class="keywordflow">for</span> (meshCounter = 0; meshCounter &lt; nv; meshCounter++)
<a name="l01568"></a>01568    {
<a name="l01569"></a>01569       <a class="code" href="classNURBSExtension.html#a8595e29dd7ff9f0b0e3cf774d322e481">v_meshOffsets</a>[meshCounter]  = meshCounter;
<a name="l01570"></a>01570       <a class="code" href="classNURBSExtension.html#a119ef907f1232beb4609e4f004a0d714">v_spaceOffsets</a>[meshCounter] = meshCounter;
<a name="l01571"></a>01571    }
<a name="l01572"></a>01572    spaceCounter = meshCounter;
<a name="l01573"></a>01573 
<a name="l01574"></a>01574    <span class="comment">// Get edge offsets</span>
<a name="l01575"></a>01575    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; ne; e++)
<a name="l01576"></a>01576    {
<a name="l01577"></a>01577       <a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>[e]  = meshCounter;
<a name="l01578"></a>01578       <a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>[e] = spaceCounter;
<a name="l01579"></a>01579       meshCounter  += <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(e)-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1;
<a name="l01580"></a>01580       spaceCounter += <a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(e)-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2;
<a name="l01581"></a>01581    }
<a name="l01582"></a>01582 
<a name="l01583"></a>01583    <span class="comment">// Get face offsets</span>
<a name="l01584"></a>01584    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; nf; f++)
<a name="l01585"></a>01585    {
<a name="l01586"></a>01586       <a class="code" href="classNURBSExtension.html#a9dbd9c98dfcb9c452e59dae6d76cc4d6">f_meshOffsets</a>[f]  = meshCounter;
<a name="l01587"></a>01587       <a class="code" href="classNURBSExtension.html#a7b5ad39811917018a0a5cdb00dafc497">f_spaceOffsets</a>[f] = spaceCounter;
<a name="l01588"></a>01588 
<a name="l01589"></a>01589       <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#adebd86309b825aef04a1fdb897466bac" title="Return the indices and the orientations of all edges of face i.">GetFaceEdges</a>(f, edges, orient);
<a name="l01590"></a>01590 
<a name="l01591"></a>01591       meshCounter +=
<a name="l01592"></a>01592          (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1) *
<a name="l01593"></a>01593          (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[1])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1);
<a name="l01594"></a>01594       spaceCounter +=
<a name="l01595"></a>01595          (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2) *
<a name="l01596"></a>01596          (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[1])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2);
<a name="l01597"></a>01597    }
<a name="l01598"></a>01598 
<a name="l01599"></a>01599    <span class="comment">// Get patch offsets</span>
<a name="l01600"></a>01600    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; np; p++)
<a name="l01601"></a>01601    {
<a name="l01602"></a>01602       <a class="code" href="classNURBSExtension.html#ab0d640285d9a090cbbf74284cf0d5471">p_meshOffsets</a>[p]  = meshCounter;
<a name="l01603"></a>01603       <a class="code" href="classNURBSExtension.html#a4fb455a9e4a49dcb3534b999c48c1972">p_spaceOffsets</a>[p] = spaceCounter;
<a name="l01604"></a>01604 
<a name="l01605"></a>01605       <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ad64d836e54ad48b8e4d98a4f20f895d4" title="Return the indices and the orientations of all edges of element i.">GetElementEdges</a>(p, edges, orient);
<a name="l01606"></a>01606 
<a name="l01607"></a>01607       <span class="keywordflow">if</span> (dim == 2)
<a name="l01608"></a>01608       {
<a name="l01609"></a>01609          meshCounter +=
<a name="l01610"></a>01610             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1) *
<a name="l01611"></a>01611             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[1])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1);
<a name="l01612"></a>01612          spaceCounter +=
<a name="l01613"></a>01613             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2) *
<a name="l01614"></a>01614             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[1])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2);
<a name="l01615"></a>01615       }
<a name="l01616"></a>01616       <span class="keywordflow">else</span>
<a name="l01617"></a>01617       {
<a name="l01618"></a>01618          meshCounter +=
<a name="l01619"></a>01619             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1) *
<a name="l01620"></a>01620             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[3])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1) *
<a name="l01621"></a>01621             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[8])-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1);
<a name="l01622"></a>01622          spaceCounter +=
<a name="l01623"></a>01623             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[0])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2) *
<a name="l01624"></a>01624             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[3])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2) *
<a name="l01625"></a>01625             (<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(edges[8])-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2);
<a name="l01626"></a>01626       }
<a name="l01627"></a>01627    }
<a name="l01628"></a>01628    <a class="code" href="classNURBSExtension.html#a4069cab4a7af66eeff9409e6fd9a793d">NumOfVertices</a> = meshCounter;
<a name="l01629"></a>01629    <a class="code" href="classNURBSExtension.html#a7a42a1bc08bf609e01b1af1ee1856b4d">NumOfDofs</a>     = spaceCounter;
<a name="l01630"></a>01630 }
<a name="l01631"></a>01631 
<a name="l01632"></a><a class="code" href="classNURBSExtension.html#a4ed56f35617596d289b95c619fdfc295">01632</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a4ed56f35617596d289b95c619fdfc295">NURBSExtension::CountElements</a>()
<a name="l01633"></a>01633 {
<a name="l01634"></a>01634    <span class="keywordtype">int</span> dim = <a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>();
<a name="l01635"></a>01635    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(dim);
<a name="l01636"></a>01636 
<a name="l01637"></a>01637    <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a> = 0;
<a name="l01638"></a>01638    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01639"></a>01639    {
<a name="l01640"></a>01640       <a class="code" href="classNURBSExtension.html#af3b10dc9e4148b48d90498261c22dbe2">GetPatchKnotVectors</a>(p, kv);
<a name="l01641"></a>01641 
<a name="l01642"></a>01642       <span class="keywordtype">int</span> ne = kv[0]-&gt;GetNE();
<a name="l01643"></a>01643       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 1; d &lt; dim; d++)
<a name="l01644"></a>01644          ne *= kv[d]-&gt;<a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>();
<a name="l01645"></a>01645 
<a name="l01646"></a>01646       <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a> += ne;
<a name="l01647"></a>01647    }
<a name="l01648"></a>01648 }
<a name="l01649"></a>01649 
<a name="l01650"></a><a class="code" href="classNURBSExtension.html#a9d22ac33937a4041ee319df0e94f403e">01650</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a9d22ac33937a4041ee319df0e94f403e">NURBSExtension::CountBdrElements</a>()
<a name="l01651"></a>01651 {
<a name="l01652"></a>01652    <span class="keywordtype">int</span> dim = <a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() - 1;
<a name="l01653"></a>01653    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(dim);
<a name="l01654"></a>01654 
<a name="l01655"></a>01655    <a class="code" href="classNURBSExtension.html#a769c1875dc688910703134d5648f2a35">NumOfBdrElements</a> = 0;
<a name="l01656"></a>01656    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>(); p++)
<a name="l01657"></a>01657    {
<a name="l01658"></a>01658       <a class="code" href="classNURBSExtension.html#ac94f2ac1e2c7ca6e18394b40545abe87">GetBdrPatchKnotVectors</a>(p, kv);
<a name="l01659"></a>01659 
<a name="l01660"></a>01660       <span class="keywordtype">int</span> ne = kv[0]-&gt;GetNE();
<a name="l01661"></a>01661       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 1; d &lt; dim; d++)
<a name="l01662"></a>01662          ne *= kv[d]-&gt;<a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>();
<a name="l01663"></a>01663 
<a name="l01664"></a>01664       <a class="code" href="classNURBSExtension.html#a769c1875dc688910703134d5648f2a35">NumOfBdrElements</a> += ne;
<a name="l01665"></a>01665    }
<a name="l01666"></a>01666 }
<a name="l01667"></a>01667 
<a name="l01668"></a><a class="code" href="classNURBSExtension.html#a0963602eb1a0f9463d2c3efacc598e03">01668</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a0963602eb1a0f9463d2c3efacc598e03">NURBSExtension::GetElementTopo</a>(<a class="code" href="classArray.html">Array&lt;Element *&gt;</a> &amp;elements)
<a name="l01669"></a>01669 {
<a name="l01670"></a>01670    elements.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>());
<a name="l01671"></a>01671 
<a name="l01672"></a>01672    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01673"></a>01673    {
<a name="l01674"></a>01674       <a class="code" href="classNURBSExtension.html#a448c00abf0dae55aeb2c11323b52e495">Get2DElementTopo</a>(elements);
<a name="l01675"></a>01675    }
<a name="l01676"></a>01676    <span class="keywordflow">else</span>
<a name="l01677"></a>01677    {
<a name="l01678"></a>01678       <a class="code" href="classNURBSExtension.html#a3ad8125edcfb1a1f8765db052c507d59">Get3DElementTopo</a>(elements);
<a name="l01679"></a>01679    }
<a name="l01680"></a>01680 }
<a name="l01681"></a>01681 
<a name="l01682"></a><a class="code" href="classNURBSExtension.html#a448c00abf0dae55aeb2c11323b52e495">01682</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a448c00abf0dae55aeb2c11323b52e495">NURBSExtension::Get2DElementTopo</a>(<a class="code" href="classArray.html">Array&lt;Element *&gt;</a> &amp;elements)
<a name="l01683"></a>01683 {
<a name="l01684"></a>01684    <span class="keywordtype">int</span> el = 0;
<a name="l01685"></a>01685    <span class="keywordtype">int</span> eg = 0;
<a name="l01686"></a>01686    <span class="keywordtype">int</span> ind[4];
<a name="l01687"></a>01687    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01688"></a>01688    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[2];
<a name="l01689"></a>01689 
<a name="l01690"></a>01690    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01691"></a>01691    {
<a name="l01692"></a>01692       p2g.<a class="code" href="classNURBSPatchMap.html#ac51964077cdb3ad121f8d49c0dff5d9e">SetPatchVertexMap</a>(p, kv);
<a name="l01693"></a>01693       <span class="keywordtype">int</span> nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>();
<a name="l01694"></a>01694       <span class="keywordtype">int</span> ny = p2g.<a class="code" href="classNURBSPatchMap.html#abdc2aced71b86ee6440c86489d136847">ny</a>();
<a name="l01695"></a>01695 
<a name="l01696"></a>01696       <span class="keywordtype">int</span> patch_attr = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a35ab1c95997e210669cd98e3005f5801" title="Return the attribute of element i.">GetAttribute</a>(p);
<a name="l01697"></a>01697 
<a name="l01698"></a>01698       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ny; j++)
<a name="l01699"></a>01699       {
<a name="l01700"></a>01700          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nx; i++)
<a name="l01701"></a>01701          {
<a name="l01702"></a>01702             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[eg])
<a name="l01703"></a>01703             {
<a name="l01704"></a>01704                ind[0] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i,  j  )];
<a name="l01705"></a>01705                ind[1] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i+1,j  )];
<a name="l01706"></a>01706                ind[2] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i+1,j+1)];
<a name="l01707"></a>01707                ind[3] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i,  j+1)];
<a name="l01708"></a>01708 
<a name="l01709"></a>01709                elements[el] = <span class="keyword">new</span> <a class="code" href="classQuadrilateral.html" title="Data type quadrilateral element.">Quadrilateral</a>(ind, patch_attr);
<a name="l01710"></a>01710                el++;
<a name="l01711"></a>01711             }
<a name="l01712"></a>01712             eg++;
<a name="l01713"></a>01713          }
<a name="l01714"></a>01714       }
<a name="l01715"></a>01715    }
<a name="l01716"></a>01716 }
<a name="l01717"></a>01717 
<a name="l01718"></a><a class="code" href="classNURBSExtension.html#a3ad8125edcfb1a1f8765db052c507d59">01718</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a3ad8125edcfb1a1f8765db052c507d59">NURBSExtension::Get3DElementTopo</a>(<a class="code" href="classArray.html">Array&lt;Element *&gt;</a> &amp;elements)
<a name="l01719"></a>01719 {
<a name="l01720"></a>01720    <span class="keywordtype">int</span> el = 0;
<a name="l01721"></a>01721    <span class="keywordtype">int</span> eg = 0;
<a name="l01722"></a>01722    <span class="keywordtype">int</span> ind[8];
<a name="l01723"></a>01723    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01724"></a>01724    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[3];
<a name="l01725"></a>01725 
<a name="l01726"></a>01726    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01727"></a>01727    {
<a name="l01728"></a>01728       p2g.<a class="code" href="classNURBSPatchMap.html#ac51964077cdb3ad121f8d49c0dff5d9e">SetPatchVertexMap</a>(p, kv);
<a name="l01729"></a>01729       <span class="keywordtype">int</span> nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>();
<a name="l01730"></a>01730       <span class="keywordtype">int</span> ny = p2g.<a class="code" href="classNURBSPatchMap.html#abdc2aced71b86ee6440c86489d136847">ny</a>();
<a name="l01731"></a>01731       <span class="keywordtype">int</span> nz = p2g.<a class="code" href="classNURBSPatchMap.html#adb9516a3b9f5c3bb30434ecb4c4581ab">nz</a>();
<a name="l01732"></a>01732 
<a name="l01733"></a>01733       <span class="keywordtype">int</span> patch_attr = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a35ab1c95997e210669cd98e3005f5801" title="Return the attribute of element i.">GetAttribute</a>(p);
<a name="l01734"></a>01734 
<a name="l01735"></a>01735       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nz; k++)
<a name="l01736"></a>01736       {
<a name="l01737"></a>01737          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ny; j++)
<a name="l01738"></a>01738          {
<a name="l01739"></a>01739             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nx; i++)
<a name="l01740"></a>01740             {
<a name="l01741"></a>01741                <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[eg])
<a name="l01742"></a>01742                {
<a name="l01743"></a>01743                   ind[0] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i,  j,  k)];
<a name="l01744"></a>01744                   ind[1] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i+1,j,  k)];
<a name="l01745"></a>01745                   ind[2] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i+1,j+1,k)];
<a name="l01746"></a>01746                   ind[3] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i,  j+1,k)];
<a name="l01747"></a>01747 
<a name="l01748"></a>01748                   ind[4] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i,  j,  k+1)];
<a name="l01749"></a>01749                   ind[5] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i+1,j,  k+1)];
<a name="l01750"></a>01750                   ind[6] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i+1,j+1,k+1)];
<a name="l01751"></a>01751                   ind[7] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(i,  j+1,k+1)];
<a name="l01752"></a>01752 
<a name="l01753"></a>01753                   elements[el] = <span class="keyword">new</span> <a class="code" href="classHexahedron.html" title="Data type hexahedron element.">Hexahedron</a>(ind, patch_attr);
<a name="l01754"></a>01754                   el++;
<a name="l01755"></a>01755                }
<a name="l01756"></a>01756                eg++;
<a name="l01757"></a>01757             }
<a name="l01758"></a>01758          }
<a name="l01759"></a>01759       }
<a name="l01760"></a>01760    }
<a name="l01761"></a>01761 }
<a name="l01762"></a>01762 
<a name="l01763"></a><a class="code" href="classNURBSExtension.html#a4197f0fd9c64bf71ff733e1b89ee19cc">01763</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a4197f0fd9c64bf71ff733e1b89ee19cc">NURBSExtension::GetBdrElementTopo</a>(<a class="code" href="classArray.html">Array&lt;Element *&gt;</a> &amp;boundary)
<a name="l01764"></a>01764 {
<a name="l01765"></a>01765    boundary.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a6db4f05b433f8af16621a487fb59876e">GetNBE</a>());
<a name="l01766"></a>01766 
<a name="l01767"></a>01767    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01768"></a>01768    {
<a name="l01769"></a>01769       <a class="code" href="classNURBSExtension.html#aa88f6718d28b8dd3595421b073026ef8">Get2DBdrElementTopo</a>(boundary);
<a name="l01770"></a>01770    }
<a name="l01771"></a>01771    <span class="keywordflow">else</span>
<a name="l01772"></a>01772    {
<a name="l01773"></a>01773       <a class="code" href="classNURBSExtension.html#a158998eec6da06f3cb6ee6bfb1864a31">Get3DBdrElementTopo</a>(boundary);
<a name="l01774"></a>01774    }
<a name="l01775"></a>01775 }
<a name="l01776"></a>01776 
<a name="l01777"></a><a class="code" href="classNURBSExtension.html#aa88f6718d28b8dd3595421b073026ef8">01777</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#aa88f6718d28b8dd3595421b073026ef8">NURBSExtension::Get2DBdrElementTopo</a>(<a class="code" href="classArray.html">Array&lt;Element *&gt;</a> &amp;boundary)
<a name="l01778"></a>01778 {
<a name="l01779"></a>01779    <span class="keywordtype">int</span> g_be, l_be;
<a name="l01780"></a>01780    <span class="keywordtype">int</span> ind[2], okv[1];
<a name="l01781"></a>01781    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01782"></a>01782    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[1];
<a name="l01783"></a>01783 
<a name="l01784"></a>01784    g_be = l_be = 0;
<a name="l01785"></a>01785    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>(); b++)
<a name="l01786"></a>01786    {
<a name="l01787"></a>01787       p2g.<a class="code" href="classNURBSPatchMap.html#aee9b51e56c6be00221d87614998d40d6">SetBdrPatchVertexMap</a>(b, kv, okv);
<a name="l01788"></a>01788       <span class="keywordtype">int</span> nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>();
<a name="l01789"></a>01789 
<a name="l01790"></a>01790       <span class="keywordtype">int</span> bdr_patch_attr = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a06e3bb58d826c52302e26faef8a84414" title="Return the attribute of boundary element i.">GetBdrAttribute</a>(b);
<a name="l01791"></a>01791 
<a name="l01792"></a>01792       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nx; i++)
<a name="l01793"></a>01793       {
<a name="l01794"></a>01794          <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>[g_be])
<a name="l01795"></a>01795          {
<a name="l01796"></a>01796             <span class="keywordtype">int</span> _i = (okv[0] &gt;= 0) ? i : (nx - 1 - i);
<a name="l01797"></a>01797             ind[0] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g[_i  ]];
<a name="l01798"></a>01798             ind[1] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g[_i+1]];
<a name="l01799"></a>01799 
<a name="l01800"></a>01800             boundary[l_be] = <span class="keyword">new</span> <a class="code" href="classSegment.html" title="Data type line segment element.">Segment</a>(ind, bdr_patch_attr);
<a name="l01801"></a>01801             l_be++;
<a name="l01802"></a>01802          }
<a name="l01803"></a>01803          g_be++;
<a name="l01804"></a>01804       }
<a name="l01805"></a>01805    }
<a name="l01806"></a>01806 }
<a name="l01807"></a>01807 
<a name="l01808"></a><a class="code" href="classNURBSExtension.html#a158998eec6da06f3cb6ee6bfb1864a31">01808</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a158998eec6da06f3cb6ee6bfb1864a31">NURBSExtension::Get3DBdrElementTopo</a>(<a class="code" href="classArray.html">Array&lt;Element *&gt;</a> &amp;boundary)
<a name="l01809"></a>01809 {
<a name="l01810"></a>01810    <span class="keywordtype">int</span> g_be, l_be;
<a name="l01811"></a>01811    <span class="keywordtype">int</span> ind[4], okv[2];
<a name="l01812"></a>01812    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01813"></a>01813    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[2];
<a name="l01814"></a>01814 
<a name="l01815"></a>01815    g_be = l_be = 0;
<a name="l01816"></a>01816    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>(); b++)
<a name="l01817"></a>01817    {
<a name="l01818"></a>01818       p2g.<a class="code" href="classNURBSPatchMap.html#aee9b51e56c6be00221d87614998d40d6">SetBdrPatchVertexMap</a>(b, kv, okv);
<a name="l01819"></a>01819       <span class="keywordtype">int</span> nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>();
<a name="l01820"></a>01820       <span class="keywordtype">int</span> ny = p2g.<a class="code" href="classNURBSPatchMap.html#abdc2aced71b86ee6440c86489d136847">ny</a>();
<a name="l01821"></a>01821 
<a name="l01822"></a>01822       <span class="keywordtype">int</span> bdr_patch_attr = <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a06e3bb58d826c52302e26faef8a84414" title="Return the attribute of boundary element i.">GetBdrAttribute</a>(b);
<a name="l01823"></a>01823 
<a name="l01824"></a>01824       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ny; j++)
<a name="l01825"></a>01825       {
<a name="l01826"></a>01826          <span class="keywordtype">int</span> _j = (okv[1] &gt;= 0) ? j : (ny - 1 - j);
<a name="l01827"></a>01827          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nx; i++)
<a name="l01828"></a>01828          {
<a name="l01829"></a>01829             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>[g_be])
<a name="l01830"></a>01830             {
<a name="l01831"></a>01831                <span class="keywordtype">int</span> _i = (okv[0] &gt;= 0) ? i : (nx - 1 - i);
<a name="l01832"></a>01832                ind[0] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(_i,  _j  )];
<a name="l01833"></a>01833                ind[1] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(_i+1,_j  )];
<a name="l01834"></a>01834                ind[2] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(_i+1,_j+1)];
<a name="l01835"></a>01835                ind[3] = <a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[p2g(_i,  _j+1)];
<a name="l01836"></a>01836 
<a name="l01837"></a>01837                boundary[l_be] = <span class="keyword">new</span> <a class="code" href="classQuadrilateral.html" title="Data type quadrilateral element.">Quadrilateral</a>(ind, bdr_patch_attr);
<a name="l01838"></a>01838                l_be++;
<a name="l01839"></a>01839             }
<a name="l01840"></a>01840             g_be++;
<a name="l01841"></a>01841          }
<a name="l01842"></a>01842       }
<a name="l01843"></a>01843    }
<a name="l01844"></a>01844 }
<a name="l01845"></a>01845 
<a name="l01846"></a><a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">01846</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">NURBSExtension::GenerateElementDofTable</a>()
<a name="l01847"></a>01847 {
<a name="l01848"></a>01848    <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a2c6b3f4268dfaa0f0a0369a59fa776ce">GetNTotalDof</a>());
<a name="l01849"></a>01849    <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a> = 0;
<a name="l01850"></a>01850 
<a name="l01851"></a>01851    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01852"></a>01852    {
<a name="l01853"></a>01853       <a class="code" href="classNURBSExtension.html#a759f58e54a9704b019ae59bbc9c9aeae">Generate2DElementDofTable</a>();
<a name="l01854"></a>01854    }
<a name="l01855"></a>01855    <span class="keywordflow">else</span>
<a name="l01856"></a>01856    {
<a name="l01857"></a>01857       <a class="code" href="classNURBSExtension.html#a15604dc7f1cfcb7716950471a9a050f8">Generate3DElementDofTable</a>();
<a name="l01858"></a>01858    }
<a name="l01859"></a>01859 
<a name="l01860"></a>01860    <a class="code" href="classNURBSExtension.html#a2fd6927eb6593a01354f0e89b8b4ddf4">NumOfActiveDofs</a> = 0;
<a name="l01861"></a>01861    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classNURBSExtension.html#a2c6b3f4268dfaa0f0a0369a59fa776ce">GetNTotalDof</a>(); d++)
<a name="l01862"></a>01862       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>[d])
<a name="l01863"></a>01863       {
<a name="l01864"></a>01864          <a class="code" href="classNURBSExtension.html#a2fd6927eb6593a01354f0e89b8b4ddf4">NumOfActiveDofs</a>++;
<a name="l01865"></a>01865          <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>[d] = <a class="code" href="classNURBSExtension.html#a2fd6927eb6593a01354f0e89b8b4ddf4">NumOfActiveDofs</a>;
<a name="l01866"></a>01866       }
<a name="l01867"></a>01867 
<a name="l01868"></a>01868    <span class="keywordtype">int</span> *dof = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>();
<a name="l01869"></a>01869    <span class="keywordtype">int</span> ndof = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#a6d896f9c079aabc1ce8c94982d34c6e2">Size_of_connections</a>();
<a name="l01870"></a>01870    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ndof; i++)
<a name="l01871"></a>01871    {
<a name="l01872"></a>01872       dof[i] = <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>[dof[i]] - 1;
<a name="l01873"></a>01873    }
<a name="l01874"></a>01874 }
<a name="l01875"></a>01875 
<a name="l01876"></a><a class="code" href="classNURBSExtension.html#a759f58e54a9704b019ae59bbc9c9aeae">01876</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a759f58e54a9704b019ae59bbc9c9aeae">NURBSExtension::Generate2DElementDofTable</a>()
<a name="l01877"></a>01877 {
<a name="l01878"></a>01878    <span class="keywordtype">int</span> el = 0;
<a name="l01879"></a>01879    <span class="keywordtype">int</span> eg = 0;
<a name="l01880"></a>01880    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[2];
<a name="l01881"></a>01881    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01882"></a>01882 
<a name="l01883"></a>01883    <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a> = <span class="keyword">new</span> <a class="code" href="classTable.html">Table</a>(<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>, (<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1)*(<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1));
<a name="l01884"></a>01884    <a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>);
<a name="l01885"></a>01885    <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>.<a class="code" href="classArray2D.html#a309fb63dd5c239ba6b842440513befea">SetSize</a>(<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>, 2);
<a name="l01886"></a>01886 
<a name="l01887"></a>01887    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01888"></a>01888    {
<a name="l01889"></a>01889       p2g.<a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">SetPatchDofMap</a>(p, kv);
<a name="l01890"></a>01890 
<a name="l01891"></a>01891       <span class="comment">// Load dofs</span>
<a name="l01892"></a>01892       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); j++)
<a name="l01893"></a>01893       {
<a name="l01894"></a>01894          <span class="keywordflow">if</span> (kv[1]-&gt;isElement(j))
<a name="l01895"></a>01895          {
<a name="l01896"></a>01896             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); i++)
<a name="l01897"></a>01897             {
<a name="l01898"></a>01898                <span class="keywordflow">if</span> (kv[0]-&gt;isElement(i))
<a name="l01899"></a>01899                {
<a name="l01900"></a>01900                   <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[eg])
<a name="l01901"></a>01901                   {
<a name="l01902"></a>01902                      <span class="keywordtype">int</span> *dofs = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(el);
<a name="l01903"></a>01903                      <span class="keywordtype">int</span> idx = 0;
<a name="l01904"></a>01904                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; jj++)
<a name="l01905"></a>01905                      {
<a name="l01906"></a>01906                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; ii++)
<a name="l01907"></a>01907                         {
<a name="l01908"></a>01908                            dofs[idx] = p2g(i+ii,j+jj);
<a name="l01909"></a>01909                            <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>[dofs[idx]] = 1;
<a name="l01910"></a>01910                            idx++;
<a name="l01911"></a>01911                         }
<a name="l01912"></a>01912                      }
<a name="l01913"></a>01913                      <a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>[el] = p;
<a name="l01914"></a>01914                      <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>(el,0) = i;
<a name="l01915"></a>01915                      <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>(el,1) = j;
<a name="l01916"></a>01916 
<a name="l01917"></a>01917                      el++;
<a name="l01918"></a>01918                   }
<a name="l01919"></a>01919                   eg++;
<a name="l01920"></a>01920                }
<a name="l01921"></a>01921             }
<a name="l01922"></a>01922          }
<a name="l01923"></a>01923       }
<a name="l01924"></a>01924    }
<a name="l01925"></a>01925 }
<a name="l01926"></a>01926 
<a name="l01927"></a><a class="code" href="classNURBSExtension.html#a15604dc7f1cfcb7716950471a9a050f8">01927</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a15604dc7f1cfcb7716950471a9a050f8">NURBSExtension::Generate3DElementDofTable</a>()
<a name="l01928"></a>01928 {
<a name="l01929"></a>01929    <span class="keywordtype">int</span> el = 0;
<a name="l01930"></a>01930    <span class="keywordtype">int</span> eg = 0;
<a name="l01931"></a>01931    <span class="keywordtype">int</span> idx;
<a name="l01932"></a>01932    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[3];
<a name="l01933"></a>01933    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l01934"></a>01934 
<a name="l01935"></a>01935    <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a> = <span class="keyword">new</span> <a class="code" href="classTable.html">Table</a>(<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>, (<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1)*(<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1)*(<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1));
<a name="l01936"></a>01936    <a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>);
<a name="l01937"></a>01937    <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>.<a class="code" href="classArray2D.html#a309fb63dd5c239ba6b842440513befea">SetSize</a>(<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>, 3);
<a name="l01938"></a>01938 
<a name="l01939"></a>01939    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l01940"></a>01940    {
<a name="l01941"></a>01941       p2g.<a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">SetPatchDofMap</a>(p, kv);
<a name="l01942"></a>01942 
<a name="l01943"></a>01943       <span class="comment">// Load dofs</span>
<a name="l01944"></a>01944       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; kv[2]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); k++)
<a name="l01945"></a>01945       {
<a name="l01946"></a>01946          <span class="keywordflow">if</span> (kv[2]-&gt;isElement(k))
<a name="l01947"></a>01947          {
<a name="l01948"></a>01948             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); j++)
<a name="l01949"></a>01949             {
<a name="l01950"></a>01950                <span class="keywordflow">if</span> (kv[1]-&gt;isElement(j))
<a name="l01951"></a>01951                {
<a name="l01952"></a>01952                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); i++)
<a name="l01953"></a>01953                   {
<a name="l01954"></a>01954                      <span class="keywordflow">if</span> (kv[0]-&gt;isElement(i))
<a name="l01955"></a>01955                      {
<a name="l01956"></a>01956                         <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[eg])
<a name="l01957"></a>01957                         {
<a name="l01958"></a>01958                            idx = 0;
<a name="l01959"></a>01959                            <span class="keywordtype">int</span> *dofs = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(el);
<a name="l01960"></a>01960                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; kk++)
<a name="l01961"></a>01961                            {
<a name="l01962"></a>01962                               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; jj++)
<a name="l01963"></a>01963                               {
<a name="l01964"></a>01964                                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; ii++)
<a name="l01965"></a>01965                                  {
<a name="l01966"></a>01966                                     dofs[idx] = p2g(i+ii,j+jj,k+kk);
<a name="l01967"></a>01967                                     <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>[dofs[idx]] = 1;
<a name="l01968"></a>01968                                     idx++;
<a name="l01969"></a>01969                                  }
<a name="l01970"></a>01970                               }
<a name="l01971"></a>01971                            }
<a name="l01972"></a>01972 
<a name="l01973"></a>01973                            <a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>[el] = p;
<a name="l01974"></a>01974                            <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>(el,0) = i;
<a name="l01975"></a>01975                            <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>(el,1) = j;
<a name="l01976"></a>01976                            <a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>(el,2) = k;
<a name="l01977"></a>01977 
<a name="l01978"></a>01978                            el++;
<a name="l01979"></a>01979                         }
<a name="l01980"></a>01980                         eg++;
<a name="l01981"></a>01981                      }
<a name="l01982"></a>01982                   }
<a name="l01983"></a>01983                }
<a name="l01984"></a>01984             }
<a name="l01985"></a>01985          }
<a name="l01986"></a>01986       }
<a name="l01987"></a>01987    }
<a name="l01988"></a>01988 }
<a name="l01989"></a>01989 
<a name="l01990"></a><a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">01990</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">NURBSExtension::GenerateBdrElementDofTable</a>()
<a name="l01991"></a>01991 {
<a name="l01992"></a>01992    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l01993"></a>01993    {
<a name="l01994"></a>01994       <a class="code" href="classNURBSExtension.html#ac7e28cb6d6f2cd209c45b6cb16e976d7">Generate2DBdrElementDofTable</a>();
<a name="l01995"></a>01995    }
<a name="l01996"></a>01996    <span class="keywordflow">else</span>
<a name="l01997"></a>01997    {
<a name="l01998"></a>01998       <a class="code" href="classNURBSExtension.html#a1d3bdcc6e1aed80252151a0e5f6a7f10">Generate3DBdrElementDofTable</a>();
<a name="l01999"></a>01999    }
<a name="l02000"></a>02000 
<a name="l02001"></a>02001    <span class="keywordtype">int</span> *dof = <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>-&gt;<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>();
<a name="l02002"></a>02002    <span class="keywordtype">int</span> ndof = <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>-&gt;<a class="code" href="classTable.html#a6d896f9c079aabc1ce8c94982d34c6e2">Size_of_connections</a>();
<a name="l02003"></a>02003    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ndof; i++)
<a name="l02004"></a>02004    {
<a name="l02005"></a>02005       dof[i] = <a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>[dof[i]] - 1;
<a name="l02006"></a>02006    }
<a name="l02007"></a>02007 }
<a name="l02008"></a>02008 
<a name="l02009"></a><a class="code" href="classNURBSExtension.html#ac7e28cb6d6f2cd209c45b6cb16e976d7">02009</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#ac7e28cb6d6f2cd209c45b6cb16e976d7">NURBSExtension::Generate2DBdrElementDofTable</a>()
<a name="l02010"></a>02010 {
<a name="l02011"></a>02011    <span class="keywordtype">int</span> gbe = 0;
<a name="l02012"></a>02012    <span class="keywordtype">int</span> lbe = 0, okv[1];
<a name="l02013"></a>02013    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[1];
<a name="l02014"></a>02014    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02015"></a>02015 
<a name="l02016"></a>02016    <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a> = <span class="keyword">new</span> <a class="code" href="classTable.html">Table</a>(<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>, <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1);
<a name="l02017"></a>02017    <a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>);
<a name="l02018"></a>02018    <a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>.<a class="code" href="classArray2D.html#a309fb63dd5c239ba6b842440513befea">SetSize</a>(<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>, 1);
<a name="l02019"></a>02019 
<a name="l02020"></a>02020    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>(); b++)
<a name="l02021"></a>02021    {
<a name="l02022"></a>02022       p2g.<a class="code" href="classNURBSPatchMap.html#a36595b0f23a9b2286196ff5360378181">SetBdrPatchDofMap</a>(b, kv, okv);
<a name="l02023"></a>02023       <span class="keywordtype">int</span> nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>(); <span class="comment">// NCP-1</span>
<a name="l02024"></a>02024 
<a name="l02025"></a>02025       <span class="comment">// Load dofs</span>
<a name="l02026"></a>02026       <span class="keywordtype">int</span> nks0 = kv[0]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>();
<a name="l02027"></a>02027       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nks0; i++)
<a name="l02028"></a>02028       {
<a name="l02029"></a>02029          <span class="keywordflow">if</span> (kv[0]-&gt;isElement(i))
<a name="l02030"></a>02030          {
<a name="l02031"></a>02031             <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>[gbe])
<a name="l02032"></a>02032             {
<a name="l02033"></a>02033                <span class="keywordtype">int</span> *dofs = <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(lbe);
<a name="l02034"></a>02034                <span class="keywordtype">int</span> idx = 0;
<a name="l02035"></a>02035                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; ii++)
<a name="l02036"></a>02036                {
<a name="l02037"></a>02037                   dofs[idx] = p2g[(okv[0] &gt;= 0) ? (i+ii) : (nx-i-ii)];
<a name="l02038"></a>02038                   idx++;
<a name="l02039"></a>02039                }
<a name="l02040"></a>02040                <a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>[lbe] = b;
<a name="l02041"></a>02041                <a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>(lbe,0) = (okv[0] &gt;= 0) ? i : (-1-i);
<a name="l02042"></a>02042                lbe++;
<a name="l02043"></a>02043             }
<a name="l02044"></a>02044             gbe++;
<a name="l02045"></a>02045          }
<a name="l02046"></a>02046       }
<a name="l02047"></a>02047    }
<a name="l02048"></a>02048 }
<a name="l02049"></a>02049 
<a name="l02050"></a><a class="code" href="classNURBSExtension.html#a1d3bdcc6e1aed80252151a0e5f6a7f10">02050</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a1d3bdcc6e1aed80252151a0e5f6a7f10">NURBSExtension::Generate3DBdrElementDofTable</a>()
<a name="l02051"></a>02051 {
<a name="l02052"></a>02052    <span class="keywordtype">int</span> gbe = 0;
<a name="l02053"></a>02053    <span class="keywordtype">int</span> lbe = 0, okv[2];
<a name="l02054"></a>02054    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[2];
<a name="l02055"></a>02055    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02056"></a>02056 
<a name="l02057"></a>02057    <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a> = <span class="keyword">new</span> <a class="code" href="classTable.html">Table</a>(<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>, (<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1)*(<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> + 1));
<a name="l02058"></a>02058    <a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>);
<a name="l02059"></a>02059    <a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>.<a class="code" href="classArray2D.html#a309fb63dd5c239ba6b842440513befea">SetSize</a>(<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>, 2);
<a name="l02060"></a>02060 
<a name="l02061"></a>02061    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; <a class="code" href="classNURBSExtension.html#a32f1024ebea219b09e754acafe9763fe">GetNBP</a>(); b++)
<a name="l02062"></a>02062    {
<a name="l02063"></a>02063       p2g.<a class="code" href="classNURBSPatchMap.html#a36595b0f23a9b2286196ff5360378181">SetBdrPatchDofMap</a>(b, kv, okv);
<a name="l02064"></a>02064       <span class="keywordtype">int</span> nx = p2g.<a class="code" href="classNURBSPatchMap.html#a30039cced415d8a745451c9cf9b582ce">nx</a>(); <span class="comment">// NCP0-1</span>
<a name="l02065"></a>02065       <span class="keywordtype">int</span> ny = p2g.<a class="code" href="classNURBSPatchMap.html#abdc2aced71b86ee6440c86489d136847">ny</a>(); <span class="comment">// NCP1-1</span>
<a name="l02066"></a>02066 
<a name="l02067"></a>02067       <span class="comment">// Load dofs</span>
<a name="l02068"></a>02068       <span class="keywordtype">int</span> nks0 = kv[0]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>();
<a name="l02069"></a>02069       <span class="keywordtype">int</span> nks1 = kv[1]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>();
<a name="l02070"></a>02070       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nks1; j++)
<a name="l02071"></a>02071       {
<a name="l02072"></a>02072          <span class="keywordflow">if</span> (kv[1]-&gt;isElement(j))
<a name="l02073"></a>02073          {
<a name="l02074"></a>02074             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nks0; i++)
<a name="l02075"></a>02075             {
<a name="l02076"></a>02076                <span class="keywordflow">if</span> (kv[0]-&gt;isElement(i))
<a name="l02077"></a>02077                {
<a name="l02078"></a>02078                   <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>[gbe])
<a name="l02079"></a>02079                   {
<a name="l02080"></a>02080                      <span class="keywordtype">int</span> *dofs = <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(lbe);
<a name="l02081"></a>02081                      <span class="keywordtype">int</span> idx = 0;
<a name="l02082"></a>02082                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; jj++)
<a name="l02083"></a>02083                      {
<a name="l02084"></a>02084                         <span class="keywordtype">int</span> _jj = (okv[1] &gt;= 0) ? (j+jj) : (ny-j-jj);
<a name="l02085"></a>02085                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt;= <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>; ii++)
<a name="l02086"></a>02086                         {
<a name="l02087"></a>02087                            <span class="keywordtype">int</span> _ii = (okv[0] &gt;= 0) ? (i+ii) : (nx-i-ii);
<a name="l02088"></a>02088                            dofs[idx] = p2g(_ii,_jj);
<a name="l02089"></a>02089                            idx++;
<a name="l02090"></a>02090                         }
<a name="l02091"></a>02091                      }
<a name="l02092"></a>02092                      <a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>[lbe] = b;
<a name="l02093"></a>02093                      <a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>(lbe,0) = (okv[0] &gt;= 0) ? i : (-1-i);
<a name="l02094"></a>02094                      <a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>(lbe,1) = (okv[1] &gt;= 0) ? j : (-1-j);
<a name="l02095"></a>02095                      lbe++;
<a name="l02096"></a>02096                   }
<a name="l02097"></a>02097                   gbe++;
<a name="l02098"></a>02098                }
<a name="l02099"></a>02099             }
<a name="l02100"></a>02100          }
<a name="l02101"></a>02101       }
<a name="l02102"></a>02102    }
<a name="l02103"></a>02103 }
<a name="l02104"></a>02104 
<a name="l02105"></a><a class="code" href="classNURBSExtension.html#aa1e19f427b6b32697c40136fd2af0027">02105</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#aa1e19f427b6b32697c40136fd2af0027">NURBSExtension::GetVertexLocalToGlobal</a>(<a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;lvert_vert)
<a name="l02106"></a>02106 {
<a name="l02107"></a>02107    lvert_vert.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a542aa527c3ca2e57064d2b0526b845f6">GetNV</a>());
<a name="l02108"></a>02108    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gv = 0; gv &lt; <a class="code" href="classNURBSExtension.html#aa4396c5c62c6938c64c527de13b94fac">GetGNV</a>(); gv++)
<a name="l02109"></a>02109       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[gv] &gt;= 0)
<a name="l02110"></a>02110          lvert_vert[<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>[gv]] = gv;
<a name="l02111"></a>02111 }
<a name="l02112"></a>02112 
<a name="l02113"></a><a class="code" href="classNURBSExtension.html#a582750744f34a41f77d8be9fc34d1c3f">02113</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a582750744f34a41f77d8be9fc34d1c3f">NURBSExtension::GetElementLocalToGlobal</a>(<a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;lelem_elem)
<a name="l02114"></a>02114 {
<a name="l02115"></a>02115    lelem_elem.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a5cc0b57ffe860befc9aa2de19ed97ba4">GetNE</a>());
<a name="l02116"></a>02116    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> le = 0, ge = 0; ge &lt; <a class="code" href="classNURBSExtension.html#a1e64151d349c38b21880f1e6d75907de">GetGNE</a>(); ge++)
<a name="l02117"></a>02117       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[ge])
<a name="l02118"></a>02118          lelem_elem[le++] = ge;
<a name="l02119"></a>02119 }
<a name="l02120"></a>02120 
<a name="l02121"></a><a class="code" href="classNURBSExtension.html#a709d766a0661b125babdefa7914dc5c8">02121</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a709d766a0661b125babdefa7914dc5c8">NURBSExtension::LoadFE</a>(<span class="keywordtype">int</span> i, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> *FE)
<a name="l02122"></a>02122 {
<a name="l02123"></a>02123    <span class="keyword">const</span> <a class="code" href="classNURBSFiniteElement.html">NURBSFiniteElement</a> *NURBSFE =
<a name="l02124"></a>02124       <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classNURBSFiniteElement.html">NURBSFiniteElement</a> *<span class="keyword">&gt;</span>(FE);
<a name="l02125"></a>02125 
<a name="l02126"></a>02126    <span class="keywordflow">if</span> (NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a8375fe784436331a2bb234fb946f305c">GetElement</a>() != i)
<a name="l02127"></a>02127    {
<a name="l02128"></a>02128       <a class="code" href="classArray.html">Array&lt;int&gt;</a> dofs;
<a name="l02129"></a>02129       NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#ac6de86073c936b2015b4b9d4962c5111">SetIJK</a>(<a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>.<a class="code" href="classArray2D.html#a05d591664ab4d89130e2954297088224">GetRow</a>(i));
<a name="l02130"></a>02130       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>[i] != NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#ad3c39d359197ba24340390175c07f36d">GetPatch</a>())
<a name="l02131"></a>02131       {
<a name="l02132"></a>02132          <a class="code" href="classNURBSExtension.html#af3b10dc9e4148b48d90498261c22dbe2">GetPatchKnotVectors</a>(<a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>[i], NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a6cc067322190a9d36d6ff50a3315e530">KnotVectors</a>());
<a name="l02133"></a>02133          NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a8a66d4c711062556c02f6d8b18583f68">SetPatch</a>(<a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>[i]);
<a name="l02134"></a>02134       }
<a name="l02135"></a>02135       <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(i, dofs);
<a name="l02136"></a>02136       <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#ab9f417235f435b9cafc1c7caf99ea2f6">GetSubVector</a>(dofs, NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#acbdef2c8be7a13da78fe40c07f86f995">Weights</a>());
<a name="l02137"></a>02137       NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a50bbc1aa46d19bf8c34c4ebc20b0dab1">SetElement</a>(i);
<a name="l02138"></a>02138    }
<a name="l02139"></a>02139 }
<a name="l02140"></a>02140 
<a name="l02141"></a><a class="code" href="classNURBSExtension.html#a3cff0d27318fc4f9b9552ce80d758f12">02141</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a3cff0d27318fc4f9b9552ce80d758f12">NURBSExtension::LoadBE</a>(<span class="keywordtype">int</span> i, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> *BE)
<a name="l02142"></a>02142 {
<a name="l02143"></a>02143    <span class="keyword">const</span> <a class="code" href="classNURBSFiniteElement.html">NURBSFiniteElement</a> *NURBSFE =
<a name="l02144"></a>02144       <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classNURBSFiniteElement.html">NURBSFiniteElement</a> *<span class="keyword">&gt;</span>(BE);
<a name="l02145"></a>02145 
<a name="l02146"></a>02146    <span class="keywordflow">if</span> (NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a8375fe784436331a2bb234fb946f305c">GetElement</a>() != i)
<a name="l02147"></a>02147    {
<a name="l02148"></a>02148       <a class="code" href="classArray.html">Array&lt;int&gt;</a> dofs;
<a name="l02149"></a>02149       NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#ac6de86073c936b2015b4b9d4962c5111">SetIJK</a>(<a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>.<a class="code" href="classArray2D.html#a05d591664ab4d89130e2954297088224">GetRow</a>(i));
<a name="l02150"></a>02150       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>[i] != NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#ad3c39d359197ba24340390175c07f36d">GetPatch</a>())
<a name="l02151"></a>02151       {
<a name="l02152"></a>02152          <a class="code" href="classNURBSExtension.html#ac94f2ac1e2c7ca6e18394b40545abe87">GetBdrPatchKnotVectors</a>(<a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>[i], NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a6cc067322190a9d36d6ff50a3315e530">KnotVectors</a>());
<a name="l02153"></a>02153          NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a8a66d4c711062556c02f6d8b18583f68">SetPatch</a>(<a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>[i]);
<a name="l02154"></a>02154       }
<a name="l02155"></a>02155       <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(i, dofs);
<a name="l02156"></a>02156       <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#ab9f417235f435b9cafc1c7caf99ea2f6">GetSubVector</a>(dofs, NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#acbdef2c8be7a13da78fe40c07f86f995">Weights</a>());
<a name="l02157"></a>02157       NURBSFE-&gt;<a class="code" href="classNURBSFiniteElement.html#a50bbc1aa46d19bf8c34c4ebc20b0dab1">SetElement</a>(i);
<a name="l02158"></a>02158    }
<a name="l02159"></a>02159 }
<a name="l02160"></a>02160 
<a name="l02161"></a><a class="code" href="classNURBSExtension.html#a374816ad96577aba847eebba988b2536">02161</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a374816ad96577aba847eebba988b2536">NURBSExtension::ConvertToPatches</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;Nodes)
<a name="l02162"></a>02162 {
<a name="l02163"></a>02163    <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>;
<a name="l02164"></a>02164    <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>;
<a name="l02165"></a>02165 
<a name="l02166"></a>02166    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 0)
<a name="l02167"></a>02167       <a class="code" href="classNURBSExtension.html#a305cdeb7e9451247a29b3ceaf5905a50">GetPatchNets</a>(Nodes);
<a name="l02168"></a>02168 }
<a name="l02169"></a>02169 
<a name="l02170"></a><a class="code" href="classNURBSExtension.html#a325381eb679a9989cdd8d720b3b8a5d8">02170</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a325381eb679a9989cdd8d720b3b8a5d8">NURBSExtension::SetCoordsFromPatches</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;Nodes)
<a name="l02171"></a>02171 {
<a name="l02172"></a>02172    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 0) <span class="keywordflow">return</span>;
<a name="l02173"></a>02173 
<a name="l02174"></a>02174    <a class="code" href="classNURBSExtension.html#aa5022cffd31b3073ac95490350907886">SetSolutionVector</a>(Nodes);
<a name="l02175"></a>02175    <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(0);
<a name="l02176"></a>02176 }
<a name="l02177"></a>02177 
<a name="l02178"></a><a class="code" href="classNURBSExtension.html#a26e429ea013401c2a5bbea6b12f96371">02178</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a26e429ea013401c2a5bbea6b12f96371">NURBSExtension::SetKnotsFromPatches</a>()
<a name="l02179"></a>02179 {
<a name="l02180"></a>02180    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() == 0)
<a name="l02181"></a>02181       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSExtension::SetKnotsFromPatches :&quot;</span>
<a name="l02182"></a>02182                  <span class="stringliteral">&quot; No patches available!&quot;</span>);
<a name="l02183"></a>02183 
<a name="l02184"></a>02184    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv;
<a name="l02185"></a>02185 
<a name="l02186"></a>02186    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); p++)
<a name="l02187"></a>02187    {
<a name="l02188"></a>02188       <a class="code" href="classNURBSExtension.html#af3b10dc9e4148b48d90498261c22dbe2">GetPatchKnotVectors</a>(p, kv);
<a name="l02189"></a>02189 
<a name="l02190"></a>02190       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02191"></a>02191          *kv[i] = *<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;GetKV(i);
<a name="l02192"></a>02192    }
<a name="l02193"></a>02193 
<a name="l02194"></a>02194    <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[0]-&gt;GetOrder();
<a name="l02195"></a>02195    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l02196"></a>02196    {
<a name="l02197"></a>02197       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> != <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i]-&gt;<a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>())
<a name="l02198"></a>02198          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;NURBSExtension::Reset :\n&quot;</span>
<a name="l02199"></a>02199                     <span class="stringliteral">&quot; Variable orders are not supported!&quot;</span>);
<a name="l02200"></a>02200    }
<a name="l02201"></a>02201 
<a name="l02202"></a>02202    <a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">GenerateOffsets</a>();
<a name="l02203"></a>02203    <a class="code" href="classNURBSExtension.html#a4ed56f35617596d289b95c619fdfc295">CountElements</a>();
<a name="l02204"></a>02204    <a class="code" href="classNURBSExtension.html#a9d22ac33937a4041ee319df0e94f403e">CountBdrElements</a>();
<a name="l02205"></a>02205 
<a name="l02206"></a>02206    <span class="comment">// all elements must be active</span>
<a name="l02207"></a>02207    <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a> = <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>;
<a name="l02208"></a>02208    <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>);
<a name="l02209"></a>02209    <a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a> = <span class="keyword">true</span>;
<a name="l02210"></a>02210 
<a name="l02211"></a>02211    <a class="code" href="classNURBSExtension.html#a33aed832cbcf8e58f1f7dadaa27872a6">GenerateActiveVertices</a>();
<a name="l02212"></a>02212    <a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">GenerateElementDofTable</a>();
<a name="l02213"></a>02213    <a class="code" href="classNURBSExtension.html#a99a03b0c2ae3a3eca39129f1e1941cc7">GenerateActiveBdrElems</a>();
<a name="l02214"></a>02214    <a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">GenerateBdrElementDofTable</a>();
<a name="l02215"></a>02215 }
<a name="l02216"></a>02216 
<a name="l02217"></a><a class="code" href="classNURBSExtension.html#ad7b345f4fc2db023140e3992fc09a923">02217</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#ad7b345f4fc2db023140e3992fc09a923">NURBSExtension::DegreeElevate</a>(<span class="keywordtype">int</span> t)
<a name="l02218"></a>02218 {
<a name="l02219"></a>02219    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); p++)
<a name="l02220"></a>02220    {
<a name="l02221"></a>02221       <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;DegreeElevate(t);
<a name="l02222"></a>02222    }
<a name="l02223"></a>02223 }
<a name="l02224"></a>02224 
<a name="l02225"></a><a class="code" href="classNURBSExtension.html#a73def7ea3c74ce49dd599e8149307bc3">02225</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a73def7ea3c74ce49dd599e8149307bc3">NURBSExtension::UniformRefinement</a>()
<a name="l02226"></a>02226 {
<a name="l02227"></a>02227    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); p++)
<a name="l02228"></a>02228    {
<a name="l02229"></a>02229       <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;UniformRefinement();
<a name="l02230"></a>02230    }
<a name="l02231"></a>02231 }
<a name="l02232"></a>02232 
<a name="l02233"></a><a class="code" href="classNURBSExtension.html#a7a62f5b3699c11eb253110055eed09d5">02233</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a7a62f5b3699c11eb253110055eed09d5">NURBSExtension::KnotInsert</a>(<a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> &amp;kv)
<a name="l02234"></a>02234 {
<a name="l02235"></a>02235    <a class="code" href="classArray.html">Array&lt;int&gt;</a> <a class="code" href="classTetrahedron.html#a6f4ba2681d5c8a01506b1236a9198545">edges</a>;
<a name="l02236"></a>02236    <a class="code" href="classArray.html">Array&lt;int&gt;</a> orient;
<a name="l02237"></a>02237 
<a name="l02238"></a>02238    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> pkv(<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>());
<a name="l02239"></a>02239 
<a name="l02240"></a>02240    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); p++)
<a name="l02241"></a>02241    {
<a name="l02242"></a>02242       <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ad64d836e54ad48b8e4d98a4f20f895d4" title="Return the indices and the orientations of all edges of element i.">GetElementEdges</a>(p, edges, orient);
<a name="l02243"></a>02243 
<a name="l02244"></a>02244       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>()==2)
<a name="l02245"></a>02245       {
<a name="l02246"></a>02246          pkv[0] = kv[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[0])];
<a name="l02247"></a>02247          pkv[1] = kv[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[1])];
<a name="l02248"></a>02248       }
<a name="l02249"></a>02249       <span class="keywordflow">else</span>
<a name="l02250"></a>02250       {
<a name="l02251"></a>02251          pkv[0] = kv[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[0])];
<a name="l02252"></a>02252          pkv[1] = kv[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[3])];
<a name="l02253"></a>02253          pkv[2] = kv[<a class="code" href="classNURBSExtension.html#a073670046787aa0477e866fee18caafa">KnotInd</a>(edges[8])];
<a name="l02254"></a>02254       }
<a name="l02255"></a>02255 
<a name="l02256"></a>02256       <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p]-&gt;KnotInsert(pkv);
<a name="l02257"></a>02257    }
<a name="l02258"></a>02258 }
<a name="l02259"></a>02259 
<a name="l02260"></a><a class="code" href="classNURBSExtension.html#a305cdeb7e9451247a29b3ceaf5905a50">02260</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a305cdeb7e9451247a29b3ceaf5905a50">NURBSExtension::GetPatchNets</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;coords)
<a name="l02261"></a>02261 {
<a name="l02262"></a>02262    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l02263"></a>02263    {
<a name="l02264"></a>02264       <a class="code" href="classNURBSExtension.html#a097305e30daebd2df8ac7bbe6354b014">Get2DPatchNets</a>(coords);
<a name="l02265"></a>02265    }
<a name="l02266"></a>02266    <span class="keywordflow">else</span>
<a name="l02267"></a>02267    {
<a name="l02268"></a>02268       <a class="code" href="classNURBSExtension.html#aed3dd1f169c9ea1f2159e7b2052dd5de">Get3DPatchNets</a>(coords);
<a name="l02269"></a>02269    }
<a name="l02270"></a>02270 }
<a name="l02271"></a>02271 
<a name="l02272"></a><a class="code" href="classNURBSExtension.html#a097305e30daebd2df8ac7bbe6354b014">02272</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a097305e30daebd2df8ac7bbe6354b014">NURBSExtension::Get2DPatchNets</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;coords)
<a name="l02273"></a>02273 {
<a name="l02274"></a>02274    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(2);
<a name="l02275"></a>02275    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02276"></a>02276 
<a name="l02277"></a>02277    <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>());
<a name="l02278"></a>02278    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l02279"></a>02279    {
<a name="l02280"></a>02280       p2g.<a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">SetPatchDofMap</a>(p, kv);
<a name="l02281"></a>02281       <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p] = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html">NURBSPatch</a>(kv, 2+1);
<a name="l02282"></a>02282       <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;Patch = *<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p];
<a name="l02283"></a>02283 
<a name="l02284"></a>02284       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;GetNCP(); j++)
<a name="l02285"></a>02285       {
<a name="l02286"></a>02286          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;GetNCP(); i++)
<a name="l02287"></a>02287          {
<a name="l02288"></a>02288             <span class="keywordtype">int</span> l = p2g(i,j);
<a name="l02289"></a>02289             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 2; d++)
<a name="l02290"></a>02290             {
<a name="l02291"></a>02291                Patch(i,j,d) = coords(l*2 + d)*<a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(l);
<a name="l02292"></a>02292             }
<a name="l02293"></a>02293             Patch(i,j,2) = <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(l);
<a name="l02294"></a>02294          }
<a name="l02295"></a>02295       }
<a name="l02296"></a>02296    }
<a name="l02297"></a>02297 }
<a name="l02298"></a>02298 
<a name="l02299"></a><a class="code" href="classNURBSExtension.html#aed3dd1f169c9ea1f2159e7b2052dd5de">02299</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#aed3dd1f169c9ea1f2159e7b2052dd5de">NURBSExtension::Get3DPatchNets</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;coords)
<a name="l02300"></a>02300 {
<a name="l02301"></a>02301    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(3);
<a name="l02302"></a>02302    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02303"></a>02303 
<a name="l02304"></a>02304    <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>());
<a name="l02305"></a>02305    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l02306"></a>02306    {
<a name="l02307"></a>02307       p2g.<a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">SetPatchDofMap</a>(p, kv);
<a name="l02308"></a>02308       <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p] = <span class="keyword">new</span> <a class="code" href="classNURBSPatch.html">NURBSPatch</a>(kv, 3+1);
<a name="l02309"></a>02309       <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;Patch = *<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p];
<a name="l02310"></a>02310 
<a name="l02311"></a>02311       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; kv[2]-&gt;GetNCP(); k++)
<a name="l02312"></a>02312       {
<a name="l02313"></a>02313          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;GetNCP(); j++)
<a name="l02314"></a>02314          {
<a name="l02315"></a>02315             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;GetNCP(); i++)
<a name="l02316"></a>02316             {
<a name="l02317"></a>02317                <span class="keywordtype">int</span> l = p2g(i,j,k);
<a name="l02318"></a>02318                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 3; d++)
<a name="l02319"></a>02319                {
<a name="l02320"></a>02320                   Patch(i,j,k,d) = coords(l*3 + d)*<a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(l);
<a name="l02321"></a>02321                }
<a name="l02322"></a>02322                Patch(i,j,k,3) = <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(l);
<a name="l02323"></a>02323             }
<a name="l02324"></a>02324          }
<a name="l02325"></a>02325       }
<a name="l02326"></a>02326    }
<a name="l02327"></a>02327 }
<a name="l02328"></a>02328 
<a name="l02329"></a><a class="code" href="classNURBSExtension.html#aa5022cffd31b3073ac95490350907886">02329</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#aa5022cffd31b3073ac95490350907886">NURBSExtension::SetSolutionVector</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;coords)
<a name="l02330"></a>02330 {
<a name="l02331"></a>02331    <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l02332"></a>02332    {
<a name="l02333"></a>02333       <a class="code" href="classNURBSExtension.html#ac7116c9f138f7d4513d1e2f474ec4d8f">Set2DSolutionVector</a>(coords);
<a name="l02334"></a>02334    }
<a name="l02335"></a>02335    <span class="keywordflow">else</span>
<a name="l02336"></a>02336    {
<a name="l02337"></a>02337       <a class="code" href="classNURBSExtension.html#a99221d500ed3c701589ee7d3343d7671">Set3DSolutionVector</a>(coords);
<a name="l02338"></a>02338    }
<a name="l02339"></a>02339 }
<a name="l02340"></a>02340 
<a name="l02341"></a><a class="code" href="classNURBSExtension.html#ac7116c9f138f7d4513d1e2f474ec4d8f">02341</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#ac7116c9f138f7d4513d1e2f474ec4d8f">NURBSExtension::Set2DSolutionVector</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;coords)
<a name="l02342"></a>02342 {
<a name="l02343"></a>02343    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(2);
<a name="l02344"></a>02344    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02345"></a>02345 
<a name="l02346"></a>02346    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l02347"></a>02347    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l02348"></a>02348    {
<a name="l02349"></a>02349       p2g.<a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">SetPatchDofMap</a>(p, kv);
<a name="l02350"></a>02350       <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;Patch = *<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p];
<a name="l02351"></a>02351 
<a name="l02352"></a>02352       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;GetNCP(); j++)
<a name="l02353"></a>02353       {
<a name="l02354"></a>02354          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;GetNCP(); i++)
<a name="l02355"></a>02355          {
<a name="l02356"></a>02356             <span class="keywordtype">int</span> l = p2g(i,j);
<a name="l02357"></a>02357             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 2; d++)
<a name="l02358"></a>02358             {
<a name="l02359"></a>02359                coords(l*2 + d) = Patch(i,j,d)/Patch(i,j,2);
<a name="l02360"></a>02360             }
<a name="l02361"></a>02361             <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(l) = Patch(i,j,2);
<a name="l02362"></a>02362          }
<a name="l02363"></a>02363       }
<a name="l02364"></a>02364       <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p];
<a name="l02365"></a>02365    }
<a name="l02366"></a>02366 }
<a name="l02367"></a>02367 
<a name="l02368"></a><a class="code" href="classNURBSExtension.html#a99221d500ed3c701589ee7d3343d7671">02368</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSExtension.html#a99221d500ed3c701589ee7d3343d7671">NURBSExtension::Set3DSolutionVector</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;coords)
<a name="l02369"></a>02369 {
<a name="l02370"></a>02370    <a class="code" href="classArray.html">Array&lt;KnotVector *&gt;</a> kv(3);
<a name="l02371"></a>02371    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02372"></a>02372 
<a name="l02373"></a>02373    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l02374"></a>02374    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; <a class="code" href="classNURBSExtension.html#a55b177edc29dd924be573c1685e04eba">GetNP</a>(); p++)
<a name="l02375"></a>02375    {
<a name="l02376"></a>02376       p2g.<a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">SetPatchDofMap</a>(p, kv);
<a name="l02377"></a>02377       <a class="code" href="classNURBSPatch.html">NURBSPatch</a> &amp;Patch = *<a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p];
<a name="l02378"></a>02378 
<a name="l02379"></a>02379       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; kv[2]-&gt;GetNCP(); k++)
<a name="l02380"></a>02380       {
<a name="l02381"></a>02381          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;GetNCP(); j++)
<a name="l02382"></a>02382          {
<a name="l02383"></a>02383             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;GetNCP(); i++)
<a name="l02384"></a>02384             {
<a name="l02385"></a>02385                <span class="keywordtype">int</span> l = p2g(i,j,k);
<a name="l02386"></a>02386                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; 3; d++)
<a name="l02387"></a>02387                {
<a name="l02388"></a>02388                   coords(l*3 + d) = Patch(i,j,k,d)/Patch(i,j,k,3);
<a name="l02389"></a>02389                }
<a name="l02390"></a>02390                <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(l) = Patch(i,j,k,3);
<a name="l02391"></a>02391             }
<a name="l02392"></a>02392          }
<a name="l02393"></a>02393       }
<a name="l02394"></a>02394       <span class="keyword">delete</span> <a class="code" href="classNURBSExtension.html#a9eef0b02cdf9ebfb3d168290a8785d61">patches</a>[p];
<a name="l02395"></a>02395    }
<a name="l02396"></a>02396 }
<a name="l02397"></a>02397 
<a name="l02398"></a>02398 
<a name="l02399"></a>02399 <span class="preprocessor">#ifdef MFEM_USE_MPI</span>
<a name="l02400"></a>02400 <span class="preprocessor"></span>ParNURBSExtension::ParNURBSExtension(MPI_Comm comm, <a class="code" href="classNURBSExtension.html">NURBSExtension</a> *parent,
<a name="l02401"></a>02401                                      <span class="keywordtype">int</span> *part, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;bool&gt;</a> &amp;active_bel)
<a name="l02402"></a>02402    : gtopo(comm)
<a name="l02403"></a>02403 {
<a name="l02404"></a>02404    <span class="keywordflow">if</span> (parent-&gt;<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a> &lt; parent-&gt;<a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>)
<a name="l02405"></a>02405       <span class="comment">// SetActive (BuildGroups?) and the way the weights are copied</span>
<a name="l02406"></a>02406       <span class="comment">// do not support this case</span>
<a name="l02407"></a>02407       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;ParNURBSExtension::ParNURBSExtension :\n&quot;</span>
<a name="l02408"></a>02408                  <span class="stringliteral">&quot; all elements in the parent must be active!&quot;</span>);
<a name="l02409"></a>02409 
<a name="l02410"></a>02410    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>;
<a name="l02411"></a>02411    <span class="comment">// steal ownership of patchTopo from the &#39;parent&#39; NURBS extension</span>
<a name="l02412"></a>02412    <span class="keywordflow">if</span> (!parent-&gt;<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a>)
<a name="l02413"></a>02413       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;ParNURBSExtension::ParNURBSExtension :\n&quot;</span>
<a name="l02414"></a>02414                  <span class="stringliteral">&quot;  parent does not own the patch topology!&quot;</span>);
<a name="l02415"></a>02415    <a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 1;
<a name="l02416"></a>02416    parent-&gt;<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 0;
<a name="l02417"></a>02417 
<a name="l02418"></a>02418    parent-&gt;<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>);
<a name="l02419"></a>02419 
<a name="l02420"></a>02420    <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a26da9ef1d391b6d4bc0d436f6f8d90f6">GetOrder</a>();
<a name="l02421"></a>02421 
<a name="l02422"></a>02422    <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a1909a4dd8a03517ea995b3981855e385">GetNKV</a>();
<a name="l02423"></a>02423    <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>);
<a name="l02424"></a>02424    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>; i++)
<a name="l02425"></a>02425    {
<a name="l02426"></a>02426       <a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>[i] = <span class="keyword">new</span> <a class="code" href="classKnotVector.html">KnotVector</a>(*parent-&gt;<a class="code" href="classNURBSExtension.html#a15a65ddfd713d7b9e81844b0f9577f54">GetKnotVector</a>(i));
<a name="l02427"></a>02427    }
<a name="l02428"></a>02428 
<a name="l02429"></a>02429    <a class="code" href="classNURBSExtension.html#aec37f652035d4cadff15d64252e02a79">GenerateOffsets</a>();
<a name="l02430"></a>02430    <a class="code" href="classNURBSExtension.html#a4ed56f35617596d289b95c619fdfc295">CountElements</a>();
<a name="l02431"></a>02431    <a class="code" href="classNURBSExtension.html#a9d22ac33937a4041ee319df0e94f403e">CountBdrElements</a>();
<a name="l02432"></a>02432 
<a name="l02433"></a>02433    partitioning = part;
<a name="l02434"></a>02434    SetActive(partitioning, active_bel);
<a name="l02435"></a>02435 
<a name="l02436"></a>02436    <a class="code" href="classNURBSExtension.html#a33aed832cbcf8e58f1f7dadaa27872a6">GenerateActiveVertices</a>();
<a name="l02437"></a>02437    <a class="code" href="classNURBSExtension.html#a0b44bc198ed8308f2b793dc9d8469418">GenerateElementDofTable</a>();
<a name="l02438"></a>02438    <span class="comment">// GenerateActiveBdrElems(); // done by SetActive for now</span>
<a name="l02439"></a>02439    <a class="code" href="classNURBSExtension.html#a47f8cb6e872d9dc1736851c1af9642f5">GenerateBdrElementDofTable</a>();
<a name="l02440"></a>02440 
<a name="l02441"></a>02441    <a class="code" href="classTable.html">Table</a> *serial_elem_dof = parent-&gt;<a class="code" href="classNURBSExtension.html#a6daf5be9142a52c91da45a735fc8f4fc">GetElementDofTable</a>();
<a name="l02442"></a>02442    BuildGroups(partitioning, *serial_elem_dof);
<a name="l02443"></a>02443 
<a name="l02444"></a>02444    <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classNURBSExtension.html#ac1d92b98aa4203cb0c88b170ffcab1ab">GetNDof</a>());
<a name="l02445"></a>02445    <span class="comment">// copy weights from parent</span>
<a name="l02446"></a>02446    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gel = 0, lel = 0; gel &lt; <a class="code" href="classNURBSExtension.html#a1e64151d349c38b21880f1e6d75907de">GetGNE</a>(); gel++)
<a name="l02447"></a>02447    {
<a name="l02448"></a>02448       <span class="keywordflow">if</span> (<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>[gel])
<a name="l02449"></a>02449       {
<a name="l02450"></a>02450          <span class="keywordtype">int</span>  ndofs = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#aa545ece6d05545a66cf42810e158c489">RowSize</a>(lel);
<a name="l02451"></a>02451          <span class="keywordtype">int</span> *ldofs = <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(lel);
<a name="l02452"></a>02452          <span class="keywordtype">int</span> *gdofs = serial_elem_dof-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(gel);
<a name="l02453"></a>02453          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ndofs; i++)
<a name="l02454"></a>02454             <a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(ldofs[i]) = parent-&gt;<a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>(gdofs[i]);
<a name="l02455"></a>02455          lel++;
<a name="l02456"></a>02456       }
<a name="l02457"></a>02457    }
<a name="l02458"></a>02458 }
<a name="l02459"></a>02459 
<a name="l02460"></a>02460 ParNURBSExtension::ParNURBSExtension(<a class="code" href="classNURBSExtension.html">NURBSExtension</a> *parent,
<a name="l02461"></a>02461                                      ParNURBSExtension *par_parent)
<a name="l02462"></a>02462    : gtopo(par_parent-&gt;gtopo.GetComm())
<a name="l02463"></a>02463 {
<a name="l02464"></a>02464    <span class="comment">// steal all data from parent</span>
<a name="l02465"></a>02465    <a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a75844371257d5f3e05247daf38eb91e2">Order</a>;
<a name="l02466"></a>02466 
<a name="l02467"></a>02467    <a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>;
<a name="l02468"></a>02468    <a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a>;
<a name="l02469"></a>02469    parent-&gt;<a class="code" href="classNURBSExtension.html#a619c9b0bdf06c0342fbe8aa4d5127766">own_topo</a> = 0;
<a name="l02470"></a>02470 
<a name="l02471"></a>02471    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a8517b909cbf051f3a107734b8d85ba94">edge_to_knot</a>);
<a name="l02472"></a>02472 
<a name="l02473"></a>02473    NumOfKnotVectors = parent-&gt;<a class="code" href="classNURBSExtension.html#a48642d3aee4ddafbbb0fac095d85e6e1">NumOfKnotVectors</a>;
<a name="l02474"></a>02474    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a337bca1948c72672935d1e79a6735152">knotVectors</a>);
<a name="l02475"></a>02475 
<a name="l02476"></a>02476    <a class="code" href="classNURBSExtension.html#a4069cab4a7af66eeff9409e6fd9a793d">NumOfVertices</a>    = parent-&gt;<a class="code" href="classNURBSExtension.html#a4069cab4a7af66eeff9409e6fd9a793d">NumOfVertices</a>;
<a name="l02477"></a>02477    <a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>    = parent-&gt;<a class="code" href="classNURBSExtension.html#a498e935dc50cf6def65c1a752810259d">NumOfElements</a>;
<a name="l02478"></a>02478    <a class="code" href="classNURBSExtension.html#a769c1875dc688910703134d5648f2a35">NumOfBdrElements</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a769c1875dc688910703134d5648f2a35">NumOfBdrElements</a>;
<a name="l02479"></a>02479    <a class="code" href="classNURBSExtension.html#a7a42a1bc08bf609e01b1af1ee1856b4d">NumOfDofs</a>        = parent-&gt;<a class="code" href="classNURBSExtension.html#a7a42a1bc08bf609e01b1af1ee1856b4d">NumOfDofs</a>;
<a name="l02480"></a>02480 
<a name="l02481"></a>02481    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a8595e29dd7ff9f0b0e3cf774d322e481">v_meshOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a8595e29dd7ff9f0b0e3cf774d322e481">v_meshOffsets</a>);
<a name="l02482"></a>02482    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>);
<a name="l02483"></a>02483    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a9dbd9c98dfcb9c452e59dae6d76cc4d6">f_meshOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a9dbd9c98dfcb9c452e59dae6d76cc4d6">f_meshOffsets</a>);
<a name="l02484"></a>02484    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#ab0d640285d9a090cbbf74284cf0d5471">p_meshOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#ab0d640285d9a090cbbf74284cf0d5471">p_meshOffsets</a>);
<a name="l02485"></a>02485 
<a name="l02486"></a>02486    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a119ef907f1232beb4609e4f004a0d714">v_spaceOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a119ef907f1232beb4609e4f004a0d714">v_spaceOffsets</a>);
<a name="l02487"></a>02487    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>);
<a name="l02488"></a>02488    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a7b5ad39811917018a0a5cdb00dafc497">f_spaceOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a7b5ad39811917018a0a5cdb00dafc497">f_spaceOffsets</a>);
<a name="l02489"></a>02489    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a4fb455a9e4a49dcb3534b999c48c1972">p_spaceOffsets</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a4fb455a9e4a49dcb3534b999c48c1972">p_spaceOffsets</a>);
<a name="l02490"></a>02490 
<a name="l02491"></a>02491    <a class="code" href="classNURBSExtension.html#a8eadbcb47dfa0cb4cd1fc01c629c5ef5">NumOfActiveVertices</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a8eadbcb47dfa0cb4cd1fc01c629c5ef5">NumOfActiveVertices</a>;
<a name="l02492"></a>02492    <a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>    = parent-&gt;<a class="code" href="classNURBSExtension.html#a1bb651e4aa45f2fb4e584d570943ee1a">NumOfActiveElems</a>;
<a name="l02493"></a>02493    <a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#aad0c20e810a8a0d4390416351d5b9794">NumOfActiveBdrElems</a>;
<a name="l02494"></a>02494    <a class="code" href="classNURBSExtension.html#a2fd6927eb6593a01354f0e89b8b4ddf4">NumOfActiveDofs</a>     = parent-&gt;<a class="code" href="classNURBSExtension.html#a2fd6927eb6593a01354f0e89b8b4ddf4">NumOfActiveDofs</a>;
<a name="l02495"></a>02495 
<a name="l02496"></a>02496    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a52334e1380a6d1c6fe5f3b96a23f0deb">activeVert</a>);
<a name="l02497"></a>02497    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a1cbc39d6bb67677251419caebc18e12c">activeElem</a>);
<a name="l02498"></a>02498    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a5812abb241a3549e4be08d367024c653">activeBdrElem</a>);
<a name="l02499"></a>02499    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#ae2cd067fda6d1f94739aa47a322cf298">activeDof</a>);
<a name="l02500"></a>02500 
<a name="l02501"></a>02501    <a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>  = parent-&gt;<a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a>;
<a name="l02502"></a>02502    <a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a>;
<a name="l02503"></a>02503    parent-&gt;<a class="code" href="classNURBSExtension.html#a22d9d76d35dd588b46361c23d3205d33">el_dof</a> = parent-&gt;<a class="code" href="classNURBSExtension.html#a1f93d4eaf29e9fccb8ba51c7e6393eec">bel_dof</a> = NULL;
<a name="l02504"></a>02504 
<a name="l02505"></a>02505    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a8e479055056ca621ff66aa6ef86c7806">el_to_patch</a>);
<a name="l02506"></a>02506    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a24f9b7eea88240a751bc7b873a524aef">bel_to_patch</a>);
<a name="l02507"></a>02507    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a64d2f52d9a59923a038b9953b7ce6357">el_to_IJK</a>);
<a name="l02508"></a>02508    <a class="code" href="array_8hpp.html#a3212a2f5f146e37be27e12653d87c464">Swap</a>(<a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>, parent-&gt;<a class="code" href="classNURBSExtension.html#a45fb8fb6bd5666b296a40d063b85fb30">bel_to_IJK</a>);
<a name="l02509"></a>02509 
<a name="l02510"></a>02510    <a class="code" href="vector_8cpp.html#ad728c7d6719e3a3aedbf94cc81919044">swap</a>(&amp;<a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>, &amp;parent-&gt;<a class="code" href="classNURBSExtension.html#a94d5b01f6d7e5a228103299a4e8a13d7">weights</a>);
<a name="l02511"></a>02511 
<a name="l02512"></a>02512    <span class="keyword">delete</span> parent;
<a name="l02513"></a>02513 
<a name="l02514"></a>02514    partitioning = NULL;
<a name="l02515"></a>02515 
<a name="l02516"></a>02516 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02517"></a>02517 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (par_parent-&gt;partitioning == NULL)
<a name="l02518"></a>02518       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;ParNURBSExtension::ParNURBSExtension :\n&quot;</span>
<a name="l02519"></a>02519                  <span class="stringliteral">&quot; parent ParNURBSExtension has no partitioning!&quot;</span>);
<a name="l02520"></a>02520 <span class="preprocessor">#endif</span>
<a name="l02521"></a>02521 <span class="preprocessor"></span>
<a name="l02522"></a>02522    <a class="code" href="classTable.html">Table</a> *serial_elem_dof = GetGlobalElementDofTable();
<a name="l02523"></a>02523    BuildGroups(par_parent-&gt;partitioning, *serial_elem_dof);
<a name="l02524"></a>02524    <span class="keyword">delete</span> serial_elem_dof;
<a name="l02525"></a>02525 }
<a name="l02526"></a>02526 
<a name="l02527"></a>02527 <a class="code" href="classTable.html">Table</a> *ParNURBSExtension::GetGlobalElementDofTable()
<a name="l02528"></a>02528 {
<a name="l02529"></a>02529    <span class="keywordflow">if</span> (Dimension() == 2)
<a name="l02530"></a>02530       <span class="keywordflow">return</span> Get2DGlobalElementDofTable();
<a name="l02531"></a>02531    <span class="keywordflow">else</span>
<a name="l02532"></a>02532       <span class="keywordflow">return</span> Get3DGlobalElementDofTable();
<a name="l02533"></a>02533 }
<a name="l02534"></a>02534 
<a name="l02535"></a>02535 <a class="code" href="classTable.html">Table</a> *ParNURBSExtension::Get2DGlobalElementDofTable()
<a name="l02536"></a>02536 {
<a name="l02537"></a>02537    <span class="keywordtype">int</span> el = 0;
<a name="l02538"></a>02538    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[2];
<a name="l02539"></a>02539    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02540"></a>02540 
<a name="l02541"></a>02541    <a class="code" href="classTable.html">Table</a> *gel_dof = <span class="keyword">new</span> <a class="code" href="classTable.html">Table</a>(GetGNE(), (Order + 1)*(Order + 1));
<a name="l02542"></a>02542 
<a name="l02543"></a>02543    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; GetNP(); p++)
<a name="l02544"></a>02544    {
<a name="l02545"></a>02545       p2g.SetPatchDofMap(p, kv);
<a name="l02546"></a>02546 
<a name="l02547"></a>02547       <span class="comment">// Load dofs</span>
<a name="l02548"></a>02548       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); j++)
<a name="l02549"></a>02549       {
<a name="l02550"></a>02550          <span class="keywordflow">if</span> (kv[1]-&gt;isElement(j))
<a name="l02551"></a>02551          {
<a name="l02552"></a>02552             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); i++)
<a name="l02553"></a>02553             {
<a name="l02554"></a>02554                <span class="keywordflow">if</span> (kv[0]-&gt;isElement(i))
<a name="l02555"></a>02555                {
<a name="l02556"></a>02556                   <span class="keywordtype">int</span> *dofs = gel_dof-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(el);
<a name="l02557"></a>02557                   <span class="keywordtype">int</span> idx = 0;
<a name="l02558"></a>02558                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt;= Order; jj++)
<a name="l02559"></a>02559                   {
<a name="l02560"></a>02560                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt;= Order; ii++)
<a name="l02561"></a>02561                      {
<a name="l02562"></a>02562                         dofs[idx] = p2g(i+ii,j+jj);
<a name="l02563"></a>02563                         idx++;
<a name="l02564"></a>02564                      }
<a name="l02565"></a>02565                   }
<a name="l02566"></a>02566                   el++;
<a name="l02567"></a>02567                }
<a name="l02568"></a>02568             }
<a name="l02569"></a>02569          }
<a name="l02570"></a>02570       }
<a name="l02571"></a>02571    }
<a name="l02572"></a>02572    <span class="keywordflow">return</span> gel_dof;
<a name="l02573"></a>02573 }
<a name="l02574"></a>02574 
<a name="l02575"></a>02575 <a class="code" href="classTable.html">Table</a> *ParNURBSExtension::Get3DGlobalElementDofTable()
<a name="l02576"></a>02576 {
<a name="l02577"></a>02577    <span class="keywordtype">int</span> el = 0;
<a name="l02578"></a>02578    <a class="code" href="classKnotVector.html">KnotVector</a> *kv[3];
<a name="l02579"></a>02579    <a class="code" href="classNURBSPatchMap.html">NURBSPatchMap</a> p2g(<span class="keyword">this</span>);
<a name="l02580"></a>02580 
<a name="l02581"></a>02581    <a class="code" href="classTable.html">Table</a> *gel_dof = <span class="keyword">new</span> <a class="code" href="classTable.html">Table</a>(GetGNE(), (Order + 1)*(Order + 1)*(Order + 1));
<a name="l02582"></a>02582 
<a name="l02583"></a>02583    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> p = 0; p &lt; GetNP(); p++)
<a name="l02584"></a>02584    {
<a name="l02585"></a>02585       p2g.SetPatchDofMap(p, kv);
<a name="l02586"></a>02586 
<a name="l02587"></a>02587       <span class="comment">// Load dofs</span>
<a name="l02588"></a>02588       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; kv[2]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); k++)
<a name="l02589"></a>02589       {
<a name="l02590"></a>02590          <span class="keywordflow">if</span> (kv[2]-&gt;isElement(k))
<a name="l02591"></a>02591          {
<a name="l02592"></a>02592             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; kv[1]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); j++)
<a name="l02593"></a>02593             {
<a name="l02594"></a>02594                <span class="keywordflow">if</span> (kv[1]-&gt;isElement(j))
<a name="l02595"></a>02595                {
<a name="l02596"></a>02596                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; kv[0]-&gt;<a class="code" href="classKnotVector.html#af9f2e3a6f87b74f5a014d479febb4552">GetNKS</a>(); i++)
<a name="l02597"></a>02597                   {
<a name="l02598"></a>02598                      <span class="keywordflow">if</span> (kv[0]-&gt;isElement(i))
<a name="l02599"></a>02599                      {
<a name="l02600"></a>02600                         <span class="keywordtype">int</span> *dofs = gel_dof-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(el);
<a name="l02601"></a>02601                         <span class="keywordtype">int</span> idx = 0;
<a name="l02602"></a>02602                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk &lt;= Order; kk++)
<a name="l02603"></a>02603                         {
<a name="l02604"></a>02604                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt;= Order; jj++)
<a name="l02605"></a>02605                            {
<a name="l02606"></a>02606                               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt;= Order; ii++)
<a name="l02607"></a>02607                               {
<a name="l02608"></a>02608                                  dofs[idx] = p2g(i+ii,j+jj,k+kk);
<a name="l02609"></a>02609                                  idx++;
<a name="l02610"></a>02610                               }
<a name="l02611"></a>02611                            }
<a name="l02612"></a>02612                         }
<a name="l02613"></a>02613                         el++;
<a name="l02614"></a>02614                      }
<a name="l02615"></a>02615                   }
<a name="l02616"></a>02616                }
<a name="l02617"></a>02617             }
<a name="l02618"></a>02618          }
<a name="l02619"></a>02619       }
<a name="l02620"></a>02620    }
<a name="l02621"></a>02621    <span class="keywordflow">return</span> gel_dof;
<a name="l02622"></a>02622 }
<a name="l02623"></a>02623 
<a name="l02624"></a>02624 <span class="keywordtype">void</span> ParNURBSExtension::SetActive(<span class="keywordtype">int</span> *_partitioning,
<a name="l02625"></a>02625                                   <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;bool&gt;</a> &amp;active_bel)
<a name="l02626"></a>02626 {
<a name="l02627"></a>02627    activeElem.<a class="code" href="classTable.html#adc83dc5cc639d0b6f7a01f030a886eb9" title="Set the size and the number of connections for the table.">SetSize</a>(GetGNE());
<a name="l02628"></a>02628    activeElem = <span class="keyword">false</span>;
<a name="l02629"></a>02629    NumOfActiveElems = 0;
<a name="l02630"></a>02630    <span class="keywordtype">int</span> MyRank = gtopo.MyRank();
<a name="l02631"></a>02631    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; GetGNE(); i++)
<a name="l02632"></a>02632       <span class="keywordflow">if</span> (_partitioning[i] == MyRank)
<a name="l02633"></a>02633       {
<a name="l02634"></a>02634          activeElem[i] = <span class="keyword">true</span>;
<a name="l02635"></a>02635          NumOfActiveElems++;
<a name="l02636"></a>02636       }
<a name="l02637"></a>02637 
<a name="l02638"></a>02638    active_bel.<a class="code" href="classArray.html#ab912d7d7883970c43f87b7f18fd34334" title="Create a copy of the current array.">Copy</a>(activeBdrElem);
<a name="l02639"></a>02639    NumOfActiveBdrElems = 0;
<a name="l02640"></a>02640    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; GetGNBE(); i++)
<a name="l02641"></a>02641       <span class="keywordflow">if</span> (activeBdrElem[i])
<a name="l02642"></a>02642          NumOfActiveBdrElems++;
<a name="l02643"></a>02643 }
<a name="l02644"></a>02644 
<a name="l02645"></a>02645 <span class="keywordtype">void</span> ParNURBSExtension::BuildGroups(<span class="keywordtype">int</span> *_partitioning, <span class="keyword">const</span> <a class="code" href="classTable.html">Table</a> &amp;elem_dof)
<a name="l02646"></a>02646 {
<a name="l02647"></a>02647    <a class="code" href="classTable.html">Table</a> dof_proc;
<a name="l02648"></a>02648 
<a name="l02649"></a>02649    <a class="code" href="classListOfIntegerSets.html" title="List of integer sets.">ListOfIntegerSets</a>  groups;
<a name="l02650"></a>02650    <a class="code" href="classIntegerSet.html" title="A set of integers.">IntegerSet</a>         group;
<a name="l02651"></a>02651 
<a name="l02652"></a>02652    <a class="code" href="table_8cpp.html#aa2ebc1538c040bb6f74c4ad9ca623c5b" title="Transpose a Table.">Transpose</a>(elem_dof, dof_proc); <span class="comment">// dof_proc is dof_elem</span>
<a name="l02653"></a>02653    <span class="comment">// convert elements to processors</span>
<a name="l02654"></a>02654    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dof_proc.<a class="code" href="classTable.html#a6d896f9c079aabc1ce8c94982d34c6e2">Size_of_connections</a>(); i++)
<a name="l02655"></a>02655       dof_proc.<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>()[i] = _partitioning[dof_proc.<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>()[i]];
<a name="l02656"></a>02656 
<a name="l02657"></a>02657    <span class="comment">// the first group is the local one</span>
<a name="l02658"></a>02658    <span class="keywordtype">int</span> MyRank = gtopo.MyRank();
<a name="l02659"></a>02659    group.<a class="code" href="classIntegerSet.html#a8f40220c5ea9c2e61c7ec62e34805d92">Recreate</a>(1, &amp;MyRank);
<a name="l02660"></a>02660    groups.<a class="code" href="classListOfIntegerSets.html#ab1d80195ce4c95b5cbb06228408dfa4f">Insert</a>(group);
<a name="l02661"></a>02661 
<a name="l02662"></a>02662    <span class="keywordtype">int</span> dof = 0;
<a name="l02663"></a>02663    ldof_group.SetSize(GetNDof());
<a name="l02664"></a>02664    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; GetNTotalDof(); d++)
<a name="l02665"></a>02665       <span class="keywordflow">if</span> (activeDof[d])
<a name="l02666"></a>02666       {
<a name="l02667"></a>02667          group.<a class="code" href="classIntegerSet.html#a8f40220c5ea9c2e61c7ec62e34805d92">Recreate</a>(dof_proc.<a class="code" href="classTable.html#aa545ece6d05545a66cf42810e158c489">RowSize</a>(d), dof_proc.<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(d));
<a name="l02668"></a>02668          ldof_group[dof] = groups.<a class="code" href="classListOfIntegerSets.html#ab1d80195ce4c95b5cbb06228408dfa4f">Insert</a>(group);
<a name="l02669"></a>02669 
<a name="l02670"></a>02670          dof++;
<a name="l02671"></a>02671       }
<a name="l02672"></a>02672 
<a name="l02673"></a>02673    gtopo.Create(groups, 1822);
<a name="l02674"></a>02674 }
<a name="l02675"></a>02675 <span class="preprocessor">#endif</span>
<a name="l02676"></a>02676 <span class="preprocessor"></span>
<a name="l02677"></a>02677 
<a name="l02678"></a><a class="code" href="classNURBSPatchMap.html#a9622b42f7c63520a43776e48da7cd960">02678</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatchMap.html#a9622b42f7c63520a43776e48da7cd960">NURBSPatchMap::GetPatchKnotVectors</a>(<span class="keywordtype">int</span> p, <a class="code" href="classKnotVector.html">KnotVector</a> *kv[])
<a name="l02679"></a>02679 {
<a name="l02680"></a>02680    <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a74e6fc7cca416877e717d48e310e3676" title="Returns the indices of the dofs of element i.">GetElementVertices</a>(p, <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>);
<a name="l02681"></a>02681    <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#ad64d836e54ad48b8e4d98a4f20f895d4" title="Return the indices and the orientations of all edges of element i.">GetElementEdges</a>(p, <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>, <a class="code" href="classNURBSPatchMap.html#a9deae18058c74513d57e3f30e4b3316e">oedge</a>);
<a name="l02682"></a>02682    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l02683"></a>02683    {
<a name="l02684"></a>02684       kv[0] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[0]);
<a name="l02685"></a>02685       kv[1] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[1]);
<a name="l02686"></a>02686    }
<a name="l02687"></a>02687    <span class="keywordflow">else</span>
<a name="l02688"></a>02688    {
<a name="l02689"></a>02689       <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a40934dec2479305126f3612aeb308d03" title="Return the indices and the orientations of all faces of element i.">GetElementFaces</a>(p, <a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>, <a class="code" href="classNURBSPatchMap.html#afadf87e288b0aa46beb3d5912e8ddbce">oface</a>);
<a name="l02690"></a>02690 
<a name="l02691"></a>02691       kv[0] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[0]);
<a name="l02692"></a>02692       kv[1] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[3]);
<a name="l02693"></a>02693       kv[2] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[8]);
<a name="l02694"></a>02694    }
<a name="l02695"></a>02695    <a class="code" href="classNURBSPatchMap.html#a0b206b63a1d34c2a305a257ac0246301">opatch</a> = 0;
<a name="l02696"></a>02696 }
<a name="l02697"></a>02697 
<a name="l02698"></a><a class="code" href="classNURBSPatchMap.html#aee7ac2350f266b4292a4b7b67cd85f1d">02698</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatchMap.html#aee7ac2350f266b4292a4b7b67cd85f1d">NURBSPatchMap::GetBdrPatchKnotVectors</a>(<span class="keywordtype">int</span> p, <a class="code" href="classKnotVector.html">KnotVector</a> *kv[], <span class="keywordtype">int</span> *okv)
<a name="l02699"></a>02699 {
<a name="l02700"></a>02700    <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#accf532a6480d1fc7d4f67ab260917982" title="Returns the indices of the dofs of boundary element i.">GetBdrElementVertices</a>(p, <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>);
<a name="l02701"></a>02701    <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a81b2e6ff28d3040e8932bbbe7bf664be" title="Return the indices and the orientations of all edges of bdr element i.">GetBdrElementEdges</a>(p, <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>, <a class="code" href="classNURBSPatchMap.html#a9deae18058c74513d57e3f30e4b3316e">oedge</a>);
<a name="l02702"></a>02702    kv[0] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[0], <a class="code" href="classNURBSPatchMap.html#a9deae18058c74513d57e3f30e4b3316e">oedge</a>[0], &amp;okv[0]);
<a name="l02703"></a>02703    <span class="keywordflow">if</span> (<a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 3)
<a name="l02704"></a>02704    {
<a name="l02705"></a>02705       <a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(1);
<a name="l02706"></a>02706       <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a5a19671b7ca269f736b30174dc8bc4c7">patchTopo</a>-&gt;<a class="code" href="classMesh.html#a7bda503ec66421ba62c5afc02a707ac8" title="Return the index and the orientation of the face of bdr element i. (3D)">GetBdrElementFace</a>(p, &amp;<a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[0], &amp;<a class="code" href="classNURBSPatchMap.html#a0b206b63a1d34c2a305a257ac0246301">opatch</a>);
<a name="l02707"></a>02707       kv[1] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a847dfe529da81aea575478c9df313455">KnotVec</a>(<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[1], <a class="code" href="classNURBSPatchMap.html#a9deae18058c74513d57e3f30e4b3316e">oedge</a>[1], &amp;okv[1]);
<a name="l02708"></a>02708    }
<a name="l02709"></a>02709    <span class="keywordflow">else</span>
<a name="l02710"></a>02710       <a class="code" href="classNURBSPatchMap.html#a0b206b63a1d34c2a305a257ac0246301">opatch</a> = <a class="code" href="classNURBSPatchMap.html#a9deae18058c74513d57e3f30e4b3316e">oedge</a>[0];
<a name="l02711"></a>02711 }
<a name="l02712"></a>02712 
<a name="l02713"></a><a class="code" href="classNURBSPatchMap.html#ac51964077cdb3ad121f8d49c0dff5d9e">02713</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatchMap.html#ac51964077cdb3ad121f8d49c0dff5d9e">NURBSPatchMap::SetPatchVertexMap</a>(<span class="keywordtype">int</span> p, <a class="code" href="classKnotVector.html">KnotVector</a> *kv[])
<a name="l02714"></a>02714 {
<a name="l02715"></a>02715    <a class="code" href="classNURBSPatchMap.html#a9622b42f7c63520a43776e48da7cd960">GetPatchKnotVectors</a>(p, kv);
<a name="l02716"></a>02716 
<a name="l02717"></a>02717    <a class="code" href="classNURBSPatchMap.html#a63a1c7cc171fd23b43cbe51009a9f67b">I</a> = kv[0]-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1;
<a name="l02718"></a>02718    <a class="code" href="classNURBSPatchMap.html#adc1fd4cb01f1e51a09cfdd6259b37744">J</a> = kv[1]-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1;
<a name="l02719"></a>02719 
<a name="l02720"></a>02720    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02721"></a>02721       <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a8595e29dd7ff9f0b0e3cf774d322e481">v_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i]];
<a name="l02722"></a>02722 
<a name="l02723"></a>02723    for (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02724"></a>02724       <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i]];
<a name="l02725"></a>02725 
<a name="l02726"></a>02726    if (<a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 3)
<a name="l02727"></a>02727    {
<a name="l02728"></a>02728       <a class="code" href="classNURBSPatchMap.html#a7bf46758bd01271484c38d7b958aea37">K</a> = kv[2]-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1;
<a name="l02729"></a>02729 
<a name="l02730"></a>02730       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02731"></a>02731          <a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a9dbd9c98dfcb9c452e59dae6d76cc4d6">f_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[i]];
<a name="l02732"></a>02732    }
<a name="l02733"></a>02733 
<a name="l02734"></a>02734    <a class="code" href="classNURBSPatchMap.html#ae0a9ad0e45ac38136dabe1101dd12bdd">pOffset</a> = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#ab0d640285d9a090cbbf74284cf0d5471">p_meshOffsets</a>[p];
<a name="l02735"></a>02735 }
<a name="l02736"></a>02736 
<a name="l02737"></a><a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">02737</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatchMap.html#af3e4827bdb598974cf0074f40584cd21">NURBSPatchMap::SetPatchDofMap</a>(<span class="keywordtype">int</span> p, <a class="code" href="classKnotVector.html">KnotVector</a> *kv[])
<a name="l02738"></a>02738 {
<a name="l02739"></a>02739    <a class="code" href="classNURBSPatchMap.html#a9622b42f7c63520a43776e48da7cd960">GetPatchKnotVectors</a>(p, kv);
<a name="l02740"></a>02740 
<a name="l02741"></a>02741    <a class="code" href="classNURBSPatchMap.html#a63a1c7cc171fd23b43cbe51009a9f67b">I</a> = kv[0]-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2;
<a name="l02742"></a>02742    <a class="code" href="classNURBSPatchMap.html#adc1fd4cb01f1e51a09cfdd6259b37744">J</a> = kv[1]-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2;
<a name="l02743"></a>02743 
<a name="l02744"></a>02744    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02745"></a>02745       <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a119ef907f1232beb4609e4f004a0d714">v_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i]];
<a name="l02746"></a>02746 
<a name="l02747"></a>02747    for (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02748"></a>02748       <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i]];
<a name="l02749"></a>02749 
<a name="l02750"></a>02750    if (<a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 3)
<a name="l02751"></a>02751    {
<a name="l02752"></a>02752       <a class="code" href="classNURBSPatchMap.html#a7bf46758bd01271484c38d7b958aea37">K</a> = kv[2]-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2;
<a name="l02753"></a>02753 
<a name="l02754"></a>02754       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02755"></a>02755          <a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a7b5ad39811917018a0a5cdb00dafc497">f_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[i]];
<a name="l02756"></a>02756    }
<a name="l02757"></a>02757 
<a name="l02758"></a>02758    <a class="code" href="classNURBSPatchMap.html#ae0a9ad0e45ac38136dabe1101dd12bdd">pOffset</a> = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a4fb455a9e4a49dcb3534b999c48c1972">p_spaceOffsets</a>[p];
<a name="l02759"></a>02759 }
<a name="l02760"></a>02760 
<a name="l02761"></a><a class="code" href="classNURBSPatchMap.html#aee9b51e56c6be00221d87614998d40d6">02761</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatchMap.html#aee9b51e56c6be00221d87614998d40d6">NURBSPatchMap::SetBdrPatchVertexMap</a>(<span class="keywordtype">int</span> p, <a class="code" href="classKnotVector.html">KnotVector</a> *kv[], <span class="keywordtype">int</span> *okv)
<a name="l02762"></a>02762 {
<a name="l02763"></a>02763    <a class="code" href="classNURBSPatchMap.html#aee7ac2350f266b4292a4b7b67cd85f1d">GetBdrPatchKnotVectors</a>(p, kv, okv);
<a name="l02764"></a>02764 
<a name="l02765"></a>02765    <a class="code" href="classNURBSPatchMap.html#a63a1c7cc171fd23b43cbe51009a9f67b">I</a> = kv[0]-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1;
<a name="l02766"></a>02766 
<a name="l02767"></a>02767    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02768"></a>02768       <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a8595e29dd7ff9f0b0e3cf774d322e481">v_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i]];
<a name="l02769"></a>02769 
<a name="l02770"></a>02770    if (<a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l02771"></a>02771    {
<a name="l02772"></a>02772       <a class="code" href="classNURBSPatchMap.html#ae0a9ad0e45ac38136dabe1101dd12bdd">pOffset</a> = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[0]];
<a name="l02773"></a>02773    }
<a name="l02774"></a>02774    <span class="keywordflow">else</span>
<a name="l02775"></a>02775    {
<a name="l02776"></a>02776       <a class="code" href="classNURBSPatchMap.html#adc1fd4cb01f1e51a09cfdd6259b37744">J</a> = kv[1]-&gt;<a class="code" href="classKnotVector.html#a8a5272147dffeb8cbef74a34995b0975">GetNE</a>() - 1;
<a name="l02777"></a>02777 
<a name="l02778"></a>02778       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02779"></a>02779          <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a4aa59195f2cd38c4033ed8acf592afc0">e_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i]];
<a name="l02780"></a>02780 
<a name="l02781"></a>02781       <a class="code" href="classNURBSPatchMap.html#ae0a9ad0e45ac38136dabe1101dd12bdd">pOffset</a> = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a9dbd9c98dfcb9c452e59dae6d76cc4d6">f_meshOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[0]];
<a name="l02782"></a>02782    }
<a name="l02783"></a>02783 }
<a name="l02784"></a>02784 
<a name="l02785"></a><a class="code" href="classNURBSPatchMap.html#a36595b0f23a9b2286196ff5360378181">02785</a> <span class="keywordtype">void</span> <a class="code" href="classNURBSPatchMap.html#a36595b0f23a9b2286196ff5360378181">NURBSPatchMap::SetBdrPatchDofMap</a>(<span class="keywordtype">int</span> p, <a class="code" href="classKnotVector.html">KnotVector</a> *kv[],  <span class="keywordtype">int</span> *okv)
<a name="l02786"></a>02786 {
<a name="l02787"></a>02787    <a class="code" href="classNURBSPatchMap.html#aee7ac2350f266b4292a4b7b67cd85f1d">GetBdrPatchKnotVectors</a>(p, kv, okv);
<a name="l02788"></a>02788 
<a name="l02789"></a>02789    <a class="code" href="classNURBSPatchMap.html#a63a1c7cc171fd23b43cbe51009a9f67b">I</a> = kv[0]-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2;
<a name="l02790"></a>02790 
<a name="l02791"></a>02791    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02792"></a>02792       <a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a119ef907f1232beb4609e4f004a0d714">v_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a6aa216750b1581e905a97e0fe29ebed4">verts</a>[i]];
<a name="l02793"></a>02793 
<a name="l02794"></a>02794    if (<a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a3d92f76ea32e125f94bc44fec3544b21">Dimension</a>() == 2)
<a name="l02795"></a>02795    {
<a name="l02796"></a>02796       <a class="code" href="classNURBSPatchMap.html#ae0a9ad0e45ac38136dabe1101dd12bdd">pOffset</a> = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[0]];
<a name="l02797"></a>02797    }
<a name="l02798"></a>02798    <span class="keywordflow">else</span>
<a name="l02799"></a>02799    {
<a name="l02800"></a>02800       <a class="code" href="classNURBSPatchMap.html#adc1fd4cb01f1e51a09cfdd6259b37744">J</a> = kv[1]-&gt;<a class="code" href="classKnotVector.html#a51bb31f4264cf438fe3292395a2651fb">GetNCP</a>() - 2;
<a name="l02801"></a>02801 
<a name="l02802"></a>02802       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l02803"></a>02803          <a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i] = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a2a3dee5afd726ea0892878c6b50541b4">e_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#acd6fef2f24e4e4dbd8114a3ca8b648fa">edges</a>[i]];
<a name="l02804"></a>02804 
<a name="l02805"></a>02805       <a class="code" href="classNURBSPatchMap.html#ae0a9ad0e45ac38136dabe1101dd12bdd">pOffset</a> = <a class="code" href="classNURBSPatchMap.html#ae4a4e370687f2698739855887f92657b">Ext</a>-&gt;<a class="code" href="classNURBSExtension.html#a7b5ad39811917018a0a5cdb00dafc497">f_spaceOffsets</a>[<a class="code" href="classNURBSPatchMap.html#a3f2a1e5c59a47f059163e0f05853bf9f">faces</a>[0]];
<a name="l02806"></a>02806    }
<a name="l02807"></a>02807 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 2 2012 16:18:17 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
