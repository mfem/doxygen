<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>MFEM: fe.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v2.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_22e7892454e350ae265aec98296a27f7.html">mfem</a>      </li>
      <li class="navelem"><a class="el" href="dir_69750015eed5bb6fc5e8920de8ff3573.html">fem</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">fe.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fe_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (c) 2010, Lawrence Livermore National Security, LLC. Produced at</span>
<a name="l00002"></a>00002 <span class="comment">// the Lawrence Livermore National Laboratory. LLNL-CODE-443211. All Rights</span>
<a name="l00003"></a>00003 <span class="comment">// reserved. See file COPYRIGHT for details.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This file is part of the MFEM library. For more information and source code</span>
<a name="l00006"></a>00006 <span class="comment">// availability see http://mfem.googlecode.com.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span>
<a name="l00009"></a>00009 <span class="comment">// terms of the GNU Lesser General Public License (as published by the Free</span>
<a name="l00010"></a>00010 <span class="comment">// Software Foundation) version 2.1 dated February 1999.</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="comment">// Finite Element classes</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;<a class="code" href="fem_8hpp.html">fem.hpp</a>&quot;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="classFiniteElement.html#adedb7eb508beb70dd8ecc17f7c60359a">00017</a> <a class="code" href="classFiniteElement.html#adedb7eb508beb70dd8ecc17f7c60359a">FiniteElement::FiniteElement</a>(<span class="keywordtype">int</span> D, <span class="keywordtype">int</span> G, <span class="keywordtype">int</span> Do, <span class="keywordtype">int</span> O, <span class="keywordtype">int</span> F)
<a name="l00018"></a>00018    : Nodes(Do)
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020    <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a> = D ; <a class="code" href="classFiniteElement.html#a178546c2f93a447870e7864f0e2bec52">GeomType</a> = G ; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a> = Do ; <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> = O ; <a class="code" href="classFiniteElement.html#a20bf31ecc444c5d8a36d7829860f9fab">FuncSpace</a> = F;
<a name="l00021"></a>00021    <a class="code" href="classFiniteElement.html#a6e70edb7e8a86b469ae20506c1f13fdc">RangeType</a> = <a class="code" href="classFiniteElement.html#a030e0d3d87cb0ac3f0b349714e3b9a5fa3afcffa9d89012968db7e7c4b73c2d51">SCALAR</a>;
<a name="l00022"></a>00022 }
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">00024</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">FiniteElement::CalcVShape</a> (
<a name="l00025"></a>00025    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00026"></a>00026 <span class="keyword"></span>{
<a name="l00027"></a>00027    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::CalcVShape (...)\n&quot;</span>
<a name="l00028"></a>00028                <span class="stringliteral">&quot;   is not implemented for this class!&quot;</span>);
<a name="l00029"></a>00029 }
<a name="l00030"></a>00030 
<a name="l00031"></a><a class="code" href="classFiniteElement.html#ac6bf4d09e2203317e187633bbb02c51c">00031</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">FiniteElement::CalcVShape</a> (
<a name="l00032"></a>00032    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00033"></a>00033 <span class="keyword"></span>{
<a name="l00034"></a>00034    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::CalcVShape 2 (...)\n&quot;</span>
<a name="l00035"></a>00035                <span class="stringliteral">&quot;   is not implemented for this class!&quot;</span>);
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="classFiniteElement.html#ac5bf14e5efc8525a7505c1f97008f11c">00038</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#ac5bf14e5efc8525a7505c1f97008f11c">FiniteElement::CalcDivShape</a> (
<a name="l00039"></a>00039    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l00040"></a>00040 <span class="keyword"></span>{
<a name="l00041"></a>00041    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::CalcDivShape (...)\n&quot;</span>
<a name="l00042"></a>00042                <span class="stringliteral">&quot;   is not implemented for this class!&quot;</span>);
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="classFiniteElement.html#a9a6e6ab4b00065f89788db5b64756556">00045</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#a9a6e6ab4b00065f89788db5b64756556">FiniteElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00046"></a>00046                                   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"> const</span>
<a name="l00047"></a>00047 <span class="keyword"></span>{
<a name="l00048"></a>00048    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::CalcCurlShape (...)\n&quot;</span>
<a name="l00049"></a>00049                <span class="stringliteral">&quot;   is not implemented for this class!&quot;</span>);
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="classFiniteElement.html#a1d206d74f29a68950c31983a66a8a45f">00052</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#a1d206d74f29a68950c31983a66a8a45f">FiniteElement::GetFaceDofs</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> **dofs, <span class="keywordtype">int</span> *ndofs)<span class="keyword"> const</span>
<a name="l00053"></a>00053 <span class="keyword"></span>{
<a name="l00054"></a>00054    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::GetFaceDofs (...)&quot;</span>);
<a name="l00055"></a>00055 }
<a name="l00056"></a>00056 
<a name="l00057"></a><a class="code" href="classFiniteElement.html#a9ec054237c5692edeb7039e89c91d118">00057</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#a9ec054237c5692edeb7039e89c91d118">FiniteElement::CalcHessian</a> (<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00058"></a>00058                                  <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;h)<span class="keyword"> const</span>
<a name="l00059"></a>00059 <span class="keyword"></span>{
<a name="l00060"></a>00060    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::CalcHessian (...) is not overloaded !&quot;</span>);
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classFiniteElement.html#af605e4954cd82e6d9d1c71915858a831">00063</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#af605e4954cd82e6d9d1c71915858a831">FiniteElement::GetLocalInterpolation</a> (<a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00064"></a>00064                                            <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00065"></a>00065 <span class="keyword"></span>{
<a name="l00066"></a>00066    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;GetLocalInterpolation (...) is not overloaded !&quot;</span>);
<a name="l00067"></a>00067 }
<a name="l00068"></a>00068 
<a name="l00069"></a><a class="code" href="classFiniteElement.html#ad8c44173c0fa313ae674c306fb35b6ab">00069</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#ad8c44173c0fa313ae674c306fb35b6ab">FiniteElement::Project</a> (
<a name="l00070"></a>00070    <a class="code" href="classCoefficient.html" title="Base class Coefficient.">Coefficient</a> &amp;coeff, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00071"></a>00071 <span class="keyword"></span>{
<a name="l00072"></a>00072    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::Project (...) is not overloaded !&quot;</span>);
<a name="l00073"></a>00073 }
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="classFiniteElement.html#a25c7edb5c3e2272f45f8212338816a24">00075</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#ad8c44173c0fa313ae674c306fb35b6ab">FiniteElement::Project</a> (
<a name="l00076"></a>00076    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00077"></a>00077 <span class="keyword"></span>{
<a name="l00078"></a>00078    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;FiniteElement::Project (...) (vector) is not overloaded !&quot;</span>);
<a name="l00079"></a>00079 }
<a name="l00080"></a>00080 
<a name="l00081"></a><a class="code" href="classFiniteElement.html#a96926a0c5bc16c5da7428995ae7aa5e2">00081</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#a96926a0c5bc16c5da7428995ae7aa5e2">FiniteElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00082"></a>00082 <span class="keyword"></span>{
<a name="l00083"></a>00083    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;FiniteElement::ProjectDelta(...) is not implemented for &quot;</span>
<a name="l00084"></a>00084               <span class="stringliteral">&quot;this element!&quot;</span>);
<a name="l00085"></a>00085 }
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="classFiniteElement.html#a995cc7b5afc47f85c56012be953d55fe">00087</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#ad8c44173c0fa313ae674c306fb35b6ab">FiniteElement::Project</a>(
<a name="l00088"></a>00088    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00089"></a>00089 <span class="keyword"></span>{
<a name="l00090"></a>00090    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;FiniteElement::Project(...) (fe version) is not implemented &quot;</span>
<a name="l00091"></a>00091               <span class="stringliteral">&quot;for this element!&quot;</span>);
<a name="l00092"></a>00092 }
<a name="l00093"></a>00093 
<a name="l00094"></a><a class="code" href="classFiniteElement.html#ad4b096e57fe0865b7e95de49929d86c4">00094</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#ad4b096e57fe0865b7e95de49929d86c4">FiniteElement::ProjectGrad</a>(
<a name="l00095"></a>00095    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00096"></a>00096    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;grad)<span class="keyword"> const</span>
<a name="l00097"></a>00097 <span class="keyword"></span>{
<a name="l00098"></a>00098    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;FiniteElement::ProjectGrad(...) is not implemented for &quot;</span>
<a name="l00099"></a>00099               <span class="stringliteral">&quot;this element!&quot;</span>);
<a name="l00100"></a>00100 }
<a name="l00101"></a>00101 
<a name="l00102"></a><a class="code" href="classFiniteElement.html#ada2b04d3796166d8b9ea53b914190dac">00102</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#ada2b04d3796166d8b9ea53b914190dac">FiniteElement::ProjectCurl</a>(
<a name="l00103"></a>00103    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00104"></a>00104    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl)<span class="keyword"> const</span>
<a name="l00105"></a>00105 <span class="keyword"></span>{
<a name="l00106"></a>00106    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;FiniteElement::ProjectCurl(...) is not implemented for &quot;</span>
<a name="l00107"></a>00107               <span class="stringliteral">&quot;this element!&quot;</span>);
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a><a class="code" href="classFiniteElement.html#adaf6e14f324bd6ed13263432c77f6eb9">00110</a> <span class="keywordtype">void</span> <a class="code" href="classFiniteElement.html#adaf6e14f324bd6ed13263432c77f6eb9">FiniteElement::ProjectDiv</a>(
<a name="l00111"></a>00111    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00112"></a>00112    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;div)<span class="keyword"> const</span>
<a name="l00113"></a>00113 <span class="keyword"></span>{
<a name="l00114"></a>00114    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;FiniteElement::ProjectDiv(...) is not implemented for &quot;</span>
<a name="l00115"></a>00115               <span class="stringliteral">&quot;this element!&quot;</span>);
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="classNodalFiniteElement.html#a187e33dbd2d008a8fe2b9e014a79151d">00119</a> <span class="keywordtype">void</span> <a class="code" href="classNodalFiniteElement.html#a187e33dbd2d008a8fe2b9e014a79151d">NodalFiniteElement::NodalLocalInterpolation</a> (
<a name="l00120"></a>00120    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I,
<a name="l00121"></a>00121    <span class="keyword">const</span> <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a> &amp;fine_fe)<span class="keyword"> const</span>
<a name="l00122"></a>00122 <span class="keyword"></span>{
<a name="l00123"></a>00123    <span class="keywordtype">double</span> v[3];
<a name="l00124"></a>00124    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> vv (v, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00125"></a>00125    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> f_ip;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classNodalFiniteElement.html#af9de02fb751a55f533da91ceebb6df28">c_shape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l00129"></a>00129 <span class="preprocessor">#endif</span>
<a name="l00130"></a>00130 <span class="preprocessor"></span>
<a name="l00131"></a>00131    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fine_fe.<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; i++)
<a name="l00132"></a>00132    {
<a name="l00133"></a>00133       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (fine_fe.<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (i), vv);
<a name="l00134"></a>00134       f_ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = v[0];
<a name="l00135"></a>00135       <span class="keywordflow">if</span> (<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a> &gt; 1) { f_ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = v[1]; <span class="keywordflow">if</span> (<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a> &gt; 2) f_ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = v[2]; }
<a name="l00136"></a>00136       <a class="code" href="classFiniteElement.html#a15ade321354be573fba66f58930d0890">CalcShape</a> (f_ip, c_shape);
<a name="l00137"></a>00137       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; j++)
<a name="l00138"></a>00138          <span class="keywordflow">if</span> (fabs (I (i,j) = c_shape (j)) &lt; 1.0e-12)
<a name="l00139"></a>00139             I (i,j) = 0.0;
<a name="l00140"></a>00140    }
<a name="l00141"></a>00141 }
<a name="l00142"></a>00142 
<a name="l00143"></a><a class="code" href="classNodalFiniteElement.html#a9d2647eb8d4ffd17499940f65f30ab05">00143</a> <span class="keywordtype">void</span> <a class="code" href="classNodalFiniteElement.html#a9d2647eb8d4ffd17499940f65f30ab05">NodalFiniteElement::Project</a> (
<a name="l00144"></a>00144    <a class="code" href="classCoefficient.html" title="Base class Coefficient.">Coefficient</a> &amp;coeff, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00145"></a>00145 <span class="keyword"></span>{
<a name="l00146"></a>00146    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; i++)
<a name="l00147"></a>00147    {
<a name="l00148"></a>00148       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i);
<a name="l00149"></a>00149       <span class="comment">// some coefficients expect that Trans.IntPoint is the same</span>
<a name="l00150"></a>00150       <span class="comment">// as the second argument of Eval</span>
<a name="l00151"></a>00151       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l00152"></a>00152       dofs(i) = coeff.<a class="code" href="classCoefficient.html#ab7a931de5049e9572ddd4401492ae3e7">Eval</a> (Trans, ip);
<a name="l00153"></a>00153    }
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="classNodalFiniteElement.html#a1a9e04a444f9012c3aa7f77a7e1e4c34">00156</a> <span class="keywordtype">void</span> <a class="code" href="classNodalFiniteElement.html#a9d2647eb8d4ffd17499940f65f30ab05">NodalFiniteElement::Project</a> (
<a name="l00157"></a>00157    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00158"></a>00158    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00159"></a>00159 <span class="keyword"></span>{
<a name="l00160"></a>00160    <span class="keywordtype">double</span> v[3];
<a name="l00161"></a>00161    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> x (v, vc.<a class="code" href="classVectorCoefficient.html#a40d2281e54de4ff6bbc327f570f2f76c" title="Returns dimension of the vector.">GetVDim</a>());
<a name="l00162"></a>00162 
<a name="l00163"></a>00163    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; i++)
<a name="l00164"></a>00164    {
<a name="l00165"></a>00165       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i);
<a name="l00166"></a>00166       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l00167"></a>00167       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (x, Trans, ip);
<a name="l00168"></a>00168       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; x.Size(); j++)
<a name="l00169"></a>00169          dofs(Dof*j+i) = v[j];
<a name="l00170"></a>00170    }
<a name="l00171"></a>00171 }
<a name="l00172"></a>00172 
<a name="l00173"></a><a class="code" href="classNodalFiniteElement.html#a3e0b9e4f7e4de9003f245e2dde0d8cee">00173</a> <span class="keywordtype">void</span> <a class="code" href="classNodalFiniteElement.html#a9d2647eb8d4ffd17499940f65f30ab05">NodalFiniteElement::Project</a>(
<a name="l00174"></a>00174    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00175"></a>00175 <span class="keyword"></span>{
<a name="l00176"></a>00176    <span class="keywordflow">if</span> (fe.<a class="code" href="classFiniteElement.html#a49b621144c49bdaae72b478dcee7c855">GetRangeType</a>() == <a class="code" href="classFiniteElement.html#a030e0d3d87cb0ac3f0b349714e3b9a5fa3afcffa9d89012968db7e7c4b73c2d51">SCALAR</a>)
<a name="l00177"></a>00177    {
<a name="l00178"></a>00178       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> shape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00179"></a>00179 
<a name="l00180"></a>00180       I.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00181"></a>00181       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00182"></a>00182       {
<a name="l00183"></a>00183          fe.<a class="code" href="classFiniteElement.html#a15ade321354be573fba66f58930d0890">CalcShape</a>(<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), shape);
<a name="l00184"></a>00184          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; shape.Size(); j++)
<a name="l00185"></a>00185             I(k,j) = (fabs(shape(j)) &lt; 1e-12) ? 0.0 : shape(j);
<a name="l00186"></a>00186       }
<a name="l00187"></a>00187    }
<a name="l00188"></a>00188    <span class="keywordflow">else</span>
<a name="l00189"></a>00189    {
<a name="l00190"></a>00190       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> vshape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>(), <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192       I.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>*<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00193"></a>00193       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00194"></a>00194       {
<a name="l00195"></a>00195          Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k));
<a name="l00196"></a>00196          fe.<a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">CalcVShape</a>(Trans, vshape);
<a name="l00197"></a>00197          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; vshape.Height(); j++)
<a name="l00198"></a>00198             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; vshape.Width(); d++)
<a name="l00199"></a>00199                I(k+d*Dof,j) = vshape(j,d);
<a name="l00200"></a>00200       }
<a name="l00201"></a>00201    }
<a name="l00202"></a>00202 }
<a name="l00203"></a>00203 
<a name="l00204"></a><a class="code" href="classNodalFiniteElement.html#a5051095eff195a24857b682834bb5a40">00204</a> <span class="keywordtype">void</span> <a class="code" href="classNodalFiniteElement.html#a5051095eff195a24857b682834bb5a40">NodalFiniteElement::ProjectGrad</a>(
<a name="l00205"></a>00205    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00206"></a>00206    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;grad)<span class="keyword"> const</span>
<a name="l00207"></a>00207 <span class="keyword"></span>{
<a name="l00208"></a>00208    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> dshape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>(), <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>), grad_k(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>(), <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>), Jinv(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00209"></a>00209 
<a name="l00210"></a>00210    grad.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>*<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00211"></a>00211    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00212"></a>00212    {
<a name="l00213"></a>00213       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l00214"></a>00214       fe.<a class="code" href="classFiniteElement.html#a4ee7f132abb6b65544a58392159ee02f">CalcDShape</a>(ip, dshape);
<a name="l00215"></a>00215       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l00216"></a>00216       <a class="code" href="densemat_8cpp.html#a09d751eab1fcea49b9ea5ef04ee9ab39">CalcInverse</a>(Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), Jinv);
<a name="l00217"></a>00217       <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(dshape, Jinv, grad_k);
<a name="l00218"></a>00218       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; grad_k.Height(); j++)
<a name="l00219"></a>00219          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>; d++)
<a name="l00220"></a>00220             grad(k+d*Dof,j) = grad_k(j,d);
<a name="l00221"></a>00221    }
<a name="l00222"></a>00222 }
<a name="l00223"></a>00223 
<a name="l00224"></a><a class="code" href="classNodalFiniteElement.html#a835437e72f2b498a03e129cdb91104df">00224</a> <span class="keywordtype">void</span> <a class="code" href="classNodalFiniteElement.html#a835437e72f2b498a03e129cdb91104df">NodalFiniteElement::ProjectDiv</a>(
<a name="l00225"></a>00225    <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe,<a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00226"></a>00226    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;div)<span class="keyword"> const</span>
<a name="l00227"></a>00227 <span class="keyword"></span>{
<a name="l00228"></a>00228    <span class="keywordtype">double</span> detJ;
<a name="l00229"></a>00229    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> div_shape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00230"></a>00230 
<a name="l00231"></a>00231    div.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00232"></a>00232    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00233"></a>00233    {
<a name="l00234"></a>00234       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l00235"></a>00235       fe.<a class="code" href="classFiniteElement.html#ac5bf14e5efc8525a7505c1f97008f11c">CalcDivShape</a>(ip, div_shape);
<a name="l00236"></a>00236       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l00237"></a>00237       detJ = Trans.<a class="code" href="classElementTransformation.html#a78c58ee5092b3237955c508690085c2b">Weight</a>();
<a name="l00238"></a>00238       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; div_shape.Size(); j++)
<a name="l00239"></a>00239          div(k,j) = (fabs(div_shape(j)) &lt; 1e-12) ? 0.0 : div_shape(j)/detJ;
<a name="l00240"></a>00240    }
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="classVectorFiniteElement.html#afe697d31a9dd3bff33be06920d52ed1f">00243</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#afe697d31a9dd3bff33be06920d52ed1f" title="Overrides the scalar CalcShape function to print an error.">VectorFiniteElement::CalcShape</a> (
<a name="l00244"></a>00244    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape )<span class="keyword"> const</span>
<a name="l00245"></a>00245 <span class="keyword"></span>{
<a name="l00246"></a>00246    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;Error: Cannot use scalar CalcShape(...) function with\n&quot;</span>
<a name="l00247"></a>00247                <span class="stringliteral">&quot;   VectorFiniteElements!&quot;</span>);
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="classVectorFiniteElement.html#a61dd1222dcdfb7a9901f5cf1355c430e">00250</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a61dd1222dcdfb7a9901f5cf1355c430e" title="Overrides the scalar CalcDShape function to print an error.">VectorFiniteElement::CalcDShape</a> (
<a name="l00251"></a>00251    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape )<span class="keyword"> const</span>
<a name="l00252"></a>00252 <span class="keyword"></span>{
<a name="l00253"></a>00253    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;Error: Cannot use scalar CalcDShape(...) function with\n&quot;</span>
<a name="l00254"></a>00254                <span class="stringliteral">&quot;   VectorFiniteElements!&quot;</span>);
<a name="l00255"></a>00255 }
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="classVectorFiniteElement.html#aaddb16ed17b219b4a81120ac23bedb50">00257</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#aaddb16ed17b219b4a81120ac23bedb50">VectorFiniteElement::CalcVShape_RT</a> (
<a name="l00258"></a>00258    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00259"></a>00259 <span class="keyword"></span>{
<a name="l00260"></a>00260 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00262"></a>00262 <span class="preprocessor">#endif</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span>   <a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">CalcVShape</a>(Trans.<a class="code" href="classElementTransformation.html#a98052521a86639c22fb7e36018737b62">GetIntPoint</a>(), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265    <a class="code" href="densemat_8cpp.html#a3dc24d8ce5abb3ec8b6a55ff524cb0f5" title="Multiply a matrix A with the transpose of a matrix B: A*Bt.">MultABt</a>(vshape, Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), shape);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267    shape *= (1.0 / Trans.<a class="code" href="classElementTransformation.html#a78c58ee5092b3237955c508690085c2b">Weight</a>());
<a name="l00268"></a>00268 }
<a name="l00269"></a>00269 
<a name="l00270"></a><a class="code" href="classVectorFiniteElement.html#ad06dc1fc16b1c6b63277b5248def6875">00270</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#ad06dc1fc16b1c6b63277b5248def6875">VectorFiniteElement::CalcVShape_ND</a> (
<a name="l00271"></a>00271    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00272"></a>00272 <span class="keyword"></span>{
<a name="l00273"></a>00273    <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;J = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>();
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00276"></a>00276 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00277"></a>00277    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(J.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(), J.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>());
<a name="l00278"></a>00278 <span class="preprocessor">#else</span>
<a name="l00279"></a>00279 <span class="preprocessor"></span>   <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(J.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(), J.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>());
<a name="l00280"></a>00280 <span class="preprocessor">#endif</span>
<a name="l00281"></a>00281 <span class="preprocessor"></span>
<a name="l00282"></a>00282    <a class="code" href="densemat_8cpp.html#a09d751eab1fcea49b9ea5ef04ee9ab39">CalcInverse</a>(J, <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l00283"></a>00283 
<a name="l00284"></a>00284    <a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">CalcVShape</a>(Trans.<a class="code" href="classElementTransformation.html#a98052521a86639c22fb7e36018737b62">GetIntPoint</a>(), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(vshape, <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>, shape);
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a><a class="code" href="classVectorFiniteElement.html#a935b444791e20d935a3c42421dad4ccb">00289</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a935b444791e20d935a3c42421dad4ccb">VectorFiniteElement::Project_RT</a>(
<a name="l00290"></a>00290    <span class="keyword">const</span> <span class="keywordtype">double</span> *nk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2n,
<a name="l00291"></a>00291    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00292"></a>00292 <span class="keyword"></span>{
<a name="l00293"></a>00293    <span class="keywordtype">double</span> vk[3];
<a name="l00294"></a>00294    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk(vk, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00295"></a>00295 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00296"></a>00296 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00297"></a>00297 <span class="preprocessor">#endif</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span>
<a name="l00299"></a>00299    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00300"></a>00300    {
<a name="l00301"></a>00301       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k));
<a name="l00302"></a>00302       <span class="comment">// set Jinv = |J| J^{-1} = adj(J)</span>
<a name="l00303"></a>00303       <a class="code" href="densemat_8cpp.html#aa277ac8940fbea0e2218599d85e08a55" title="Calculate the adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugate</a>(Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l00304"></a>00304 
<a name="l00305"></a>00305       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a>(xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k));
<a name="l00306"></a>00306       <span class="comment">// dof_k = nk^t adj(J) xk</span>
<a name="l00307"></a>00307       dofs(k) = Jinv.<a class="code" href="classDenseMatrix.html#a4c8ba579e74434cd8904501caceb0a14" title="Compute y^t A x.">InnerProduct</a>(vk, nk + d2n[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00308"></a>00308    }
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="classVectorFiniteElement.html#a04cbe00fc7a9c5c1c53431b1b11b30d3">00311</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a935b444791e20d935a3c42421dad4ccb">VectorFiniteElement::Project_RT</a>(
<a name="l00312"></a>00312    <span class="keyword">const</span> <span class="keywordtype">double</span> *nk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2n, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe,
<a name="l00313"></a>00313    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00314"></a>00314 <span class="keyword"></span>{
<a name="l00315"></a>00315    <span class="keywordflow">if</span> (fe.<a class="code" href="classFiniteElement.html#a49b621144c49bdaae72b478dcee7c855">GetRangeType</a>() == <a class="code" href="classFiniteElement.html#a030e0d3d87cb0ac3f0b349714e3b9a5fa3afcffa9d89012968db7e7c4b73c2d51">SCALAR</a>)
<a name="l00316"></a>00316    {
<a name="l00317"></a>00317       <span class="keywordtype">double</span> vk[3];
<a name="l00318"></a>00318       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> shape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00319"></a>00319 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00320"></a>00320 <span class="preprocessor"></span>      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00321"></a>00321 <span class="preprocessor">#endif</span>
<a name="l00322"></a>00322 <span class="preprocessor"></span>
<a name="l00323"></a>00323       I.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>*fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00324"></a>00324       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00325"></a>00325       {
<a name="l00326"></a>00326          <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l00327"></a>00327 
<a name="l00328"></a>00328          fe.<a class="code" href="classFiniteElement.html#a15ade321354be573fba66f58930d0890">CalcShape</a>(ip, shape);
<a name="l00329"></a>00329          Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l00330"></a>00330          <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a>(Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l00331"></a>00331          Jinv.Mult(nk + d2n[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, vk);
<a name="l00332"></a>00332 
<a name="l00333"></a>00333          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; shape.Size(); j++)
<a name="l00334"></a>00334          {
<a name="l00335"></a>00335             <span class="keywordtype">double</span> s = shape(j);
<a name="l00336"></a>00336             <span class="keywordflow">if</span> (fabs(s) &lt; 1e-12)
<a name="l00337"></a>00337                s = 0.0;
<a name="l00338"></a>00338             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>; d++)
<a name="l00339"></a>00339                I(k,j+d*shape.Size()) = s*vk[d];
<a name="l00340"></a>00340          }
<a name="l00341"></a>00341       }
<a name="l00342"></a>00342    }
<a name="l00343"></a>00343    <span class="keywordflow">else</span>
<a name="l00344"></a>00344    {
<a name="l00345"></a>00345       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;VectorFiniteElement::Project_RT (fe version)&quot;</span>);
<a name="l00346"></a>00346    }
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="classVectorFiniteElement.html#a583cf95bbd317bdc7e7e3fd65e234252">00349</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a583cf95bbd317bdc7e7e3fd65e234252">VectorFiniteElement::ProjectGrad_RT</a>(
<a name="l00350"></a>00350    <span class="keyword">const</span> <span class="keywordtype">double</span> *nk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2n, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe,
<a name="l00351"></a>00351    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;grad)<span class="keyword"> const</span>
<a name="l00352"></a>00352 <span class="keyword"></span>{
<a name="l00353"></a>00353    <span class="keywordflow">if</span> (<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a> != 2)
<a name="l00354"></a>00354       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;VectorFiniteElement::ProjectGrad_RT works only in 2D!&quot;</span>);
<a name="l00355"></a>00355 
<a name="l00356"></a>00356    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> dshape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>(), fe.<a class="code" href="classFiniteElement.html#aecbaefe82ec91c88d9222e3f56954afb" title="Returns the space dimension for the finite element.">GetDim</a>());
<a name="l00357"></a>00357    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> grad_k(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00358"></a>00358    <span class="keywordtype">double</span> tk[2];
<a name="l00359"></a>00359 
<a name="l00360"></a>00360    grad.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00361"></a>00361    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00362"></a>00362    {
<a name="l00363"></a>00363       fe.<a class="code" href="classFiniteElement.html#a4ee7f132abb6b65544a58392159ee02f">CalcDShape</a>(<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), dshape);
<a name="l00364"></a>00364       tk[0] = nk[d2n[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>+1];
<a name="l00365"></a>00365       tk[1] = -nk[d2n[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>];
<a name="l00366"></a>00366       dshape.Mult(tk, grad_k);
<a name="l00367"></a>00367       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; grad_k.Size(); j++)
<a name="l00368"></a>00368          grad(k,j) = (fabs(grad_k(j)) &lt; 1e-12) ? 0.0 : grad_k(j);
<a name="l00369"></a>00369    }
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="classVectorFiniteElement.html#adea8c399c2626214efbcc8d7c1bf758e">00372</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#adea8c399c2626214efbcc8d7c1bf758e">VectorFiniteElement::ProjectCurl_RT</a>(
<a name="l00373"></a>00373    <span class="keyword">const</span> <span class="keywordtype">double</span> *nk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2n, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe,
<a name="l00374"></a>00374    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl)<span class="keyword"> const</span>
<a name="l00375"></a>00375 <span class="keyword"></span>{
<a name="l00376"></a>00376    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> curl_shape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>(), <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00377"></a>00377    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> curl_k(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00378"></a>00378 
<a name="l00379"></a>00379    curl.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00380"></a>00380    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00381"></a>00381    {
<a name="l00382"></a>00382       fe.<a class="code" href="classFiniteElement.html#a9a6e6ab4b00065f89788db5b64756556">CalcCurlShape</a>(<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), curl_shape);
<a name="l00383"></a>00383       curl_shape.Mult(nk + d2n[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, curl_k);
<a name="l00384"></a>00384       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; curl_k.Size(); j++)
<a name="l00385"></a>00385          curl(k,j) = (fabs(curl_k(j)) &lt; 1e-12) ? 0.0 : curl_k(j);
<a name="l00386"></a>00386    }
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00389"></a><a class="code" href="classVectorFiniteElement.html#a7dc9c6c3b9af37235949c78aa506fe83">00389</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a7dc9c6c3b9af37235949c78aa506fe83">VectorFiniteElement::Project_ND</a>(
<a name="l00390"></a>00390    <span class="keyword">const</span> <span class="keywordtype">double</span> *tk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2t,
<a name="l00391"></a>00391    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00392"></a>00392 <span class="keyword"></span>{
<a name="l00393"></a>00393    <span class="keywordtype">double</span> vk[3];
<a name="l00394"></a>00394    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk(vk, vc.<a class="code" href="classVectorCoefficient.html#a40d2281e54de4ff6bbc327f570f2f76c" title="Returns dimension of the vector.">GetVDim</a>());
<a name="l00395"></a>00395 
<a name="l00396"></a>00396    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00397"></a>00397    {
<a name="l00398"></a>00398       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k));
<a name="l00399"></a>00399 
<a name="l00400"></a>00400       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a>(xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k));
<a name="l00401"></a>00401       <span class="comment">// dof_k = xk^t J tk</span>
<a name="l00402"></a>00402       dofs(k) = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>().<a class="code" href="classDenseMatrix.html#a4c8ba579e74434cd8904501caceb0a14" title="Compute y^t A x.">InnerProduct</a>(tk + d2t[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, vk);
<a name="l00403"></a>00403    }
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a><a class="code" href="classVectorFiniteElement.html#aecea81ce38da54ae5527c25898c64f1f">00406</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a7dc9c6c3b9af37235949c78aa506fe83">VectorFiniteElement::Project_ND</a>(
<a name="l00407"></a>00407    <span class="keyword">const</span> <span class="keywordtype">double</span> *tk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2t, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe,
<a name="l00408"></a>00408    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00409"></a>00409 <span class="keyword"></span>{
<a name="l00410"></a>00410    <span class="keywordflow">if</span> (fe.<a class="code" href="classFiniteElement.html#a49b621144c49bdaae72b478dcee7c855">GetRangeType</a>() == <a class="code" href="classFiniteElement.html#a030e0d3d87cb0ac3f0b349714e3b9a5fa3afcffa9d89012968db7e7c4b73c2d51">SCALAR</a>)
<a name="l00411"></a>00411    {
<a name="l00412"></a>00412       <span class="keywordtype">double</span> vk[3];
<a name="l00413"></a>00413       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> shape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00414"></a>00414 
<a name="l00415"></a>00415       I.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>*fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00416"></a>00416       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00417"></a>00417       {
<a name="l00418"></a>00418          <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420          fe.<a class="code" href="classFiniteElement.html#a15ade321354be573fba66f58930d0890">CalcShape</a>(ip, shape);
<a name="l00421"></a>00421          Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l00422"></a>00422          Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>().<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(tk + d2t[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, vk);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; shape.Size(); j++)
<a name="l00425"></a>00425          {
<a name="l00426"></a>00426             <span class="keywordtype">double</span> s = shape(j);
<a name="l00427"></a>00427             <span class="keywordflow">if</span> (fabs(s) &lt; 1e-12)
<a name="l00428"></a>00428                s = 0.0;
<a name="l00429"></a>00429             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>; d++)
<a name="l00430"></a>00430                I(k, j + d*shape.Size()) = s*vk[d];
<a name="l00431"></a>00431          }
<a name="l00432"></a>00432       }
<a name="l00433"></a>00433    }
<a name="l00434"></a>00434    <span class="keywordflow">else</span>
<a name="l00435"></a>00435    {
<a name="l00436"></a>00436       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;VectorFiniteElement::Project_ND (fe version)&quot;</span>);
<a name="l00437"></a>00437    }
<a name="l00438"></a>00438 }
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="classVectorFiniteElement.html#a6d31cab1982748100d3773995a67e842">00440</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a6d31cab1982748100d3773995a67e842">VectorFiniteElement::ProjectGrad_ND</a>(
<a name="l00441"></a>00441    <span class="keyword">const</span> <span class="keywordtype">double</span> *tk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2t, <span class="keyword">const</span> <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a> &amp;fe,
<a name="l00442"></a>00442    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;grad)<span class="keyword"> const</span>
<a name="l00443"></a>00443 <span class="keyword"></span>{
<a name="l00444"></a>00444    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> dshape(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>(), fe.<a class="code" href="classFiniteElement.html#aecbaefe82ec91c88d9222e3f56954afb" title="Returns the space dimension for the finite element.">GetDim</a>());
<a name="l00445"></a>00445    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> grad_k(fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00446"></a>00446 
<a name="l00447"></a>00447    grad.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, fe.<a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>());
<a name="l00448"></a>00448    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00449"></a>00449    {
<a name="l00450"></a>00450       fe.<a class="code" href="classFiniteElement.html#a4ee7f132abb6b65544a58392159ee02f">CalcDShape</a>(<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), dshape);
<a name="l00451"></a>00451       dshape.Mult(tk + d2t[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, grad_k);
<a name="l00452"></a>00452       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; grad_k.Size(); j++)
<a name="l00453"></a>00453          grad(k,j) = (fabs(grad_k(j)) &lt; 1e-12) ? 0.0 : grad_k(j);
<a name="l00454"></a>00454    }
<a name="l00455"></a>00455 }
<a name="l00456"></a>00456 
<a name="l00457"></a><a class="code" href="classVectorFiniteElement.html#a27557dd58104c0e3c53a4733216ce10f">00457</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a27557dd58104c0e3c53a4733216ce10f">VectorFiniteElement::LocalInterpolation_RT</a>(
<a name="l00458"></a>00458    <span class="keyword">const</span> <span class="keywordtype">double</span> *nk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2n, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00459"></a>00459    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00460"></a>00460 <span class="keyword"></span>{
<a name="l00461"></a>00461    <span class="keywordtype">double</span> vk[3];
<a name="l00462"></a>00462    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk(vk, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00463"></a>00463    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l00464"></a>00464 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00466"></a>00466    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00467"></a>00467 <span class="preprocessor">#endif</span>
<a name="l00468"></a>00468 <span class="preprocessor"></span>
<a name="l00469"></a>00469    <span class="comment">// assuming Trans is linear; this should be ok for all refinement types</span>
<a name="l00470"></a>00470    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;<a class="code" href="geom_8cpp.html#a63ba6a9fe969f5faa64d753f582011ca">Geometries</a>.<a class="code" href="classGeometry.html#aaa919e8cd6baac67ec0898f4d7fadc26">GetCenter</a>(<a class="code" href="classFiniteElement.html#a178546c2f93a447870e7864f0e2bec52">GeomType</a>));
<a name="l00471"></a>00471    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l00472"></a>00472    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a>(Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l00473"></a>00473    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00474"></a>00474    {
<a name="l00475"></a>00475       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a>(<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), xk);
<a name="l00476"></a>00476       ip.<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(vk);
<a name="l00477"></a>00477       <a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">CalcVShape</a>(ip, vshape);
<a name="l00478"></a>00478       <span class="comment">// xk = |J| J^{-t} n_k</span>
<a name="l00479"></a>00479       Jinv.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(nk + d2n[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, vk);
<a name="l00480"></a>00480       <span class="comment">// I_k = vshape_k.adj(J)^t.n_k, k=1,...,Dof</span>
<a name="l00481"></a>00481       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; j++)
<a name="l00482"></a>00482       {
<a name="l00483"></a>00483          <span class="keywordtype">double</span> Ikj = 0.;
<a name="l00484"></a>00484          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>; i++)
<a name="l00485"></a>00485             Ikj += <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j, i) * vk[i];
<a name="l00486"></a>00486          I(k, j) = (fabs(Ikj) &lt; 1e-12) ? 0.0 : Ikj;
<a name="l00487"></a>00487       }
<a name="l00488"></a>00488    }
<a name="l00489"></a>00489 }
<a name="l00490"></a>00490 
<a name="l00491"></a><a class="code" href="classVectorFiniteElement.html#a9f74dc994ce0641c07004cfe47a65d37">00491</a> <span class="keywordtype">void</span> <a class="code" href="classVectorFiniteElement.html#a9f74dc994ce0641c07004cfe47a65d37">VectorFiniteElement::LocalInterpolation_ND</a>(
<a name="l00492"></a>00492    <span class="keyword">const</span> <span class="keywordtype">double</span> *tk, <span class="keyword">const</span> <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;d2t, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l00493"></a>00493    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l00494"></a>00494 <span class="keyword"></span>{
<a name="l00495"></a>00495    <span class="keywordtype">double</span> vk[3];
<a name="l00496"></a>00496    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk(vk, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00497"></a>00497    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l00498"></a>00498 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l00499"></a>00499 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l00500"></a>00500 <span class="preprocessor">#endif</span>
<a name="l00501"></a>00501 <span class="preprocessor"></span>
<a name="l00502"></a>00502    <span class="comment">// assuming Trans is linear; this should be ok for all refinement types</span>
<a name="l00503"></a>00503    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;<a class="code" href="geom_8cpp.html#a63ba6a9fe969f5faa64d753f582011ca">Geometries</a>.<a class="code" href="classGeometry.html#aaa919e8cd6baac67ec0898f4d7fadc26">GetCenter</a>(<a class="code" href="classFiniteElement.html#a178546c2f93a447870e7864f0e2bec52">GeomType</a>));
<a name="l00504"></a>00504    <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;J = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>();
<a name="l00505"></a>00505    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l00506"></a>00506    {
<a name="l00507"></a>00507       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a>(<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), xk);
<a name="l00508"></a>00508       ip.<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(vk);
<a name="l00509"></a>00509       <a class="code" href="classFiniteElement.html#a06703623cb0917534007a824c31a4932">CalcVShape</a>(ip, vshape);
<a name="l00510"></a>00510       <span class="comment">// xk = J t_k</span>
<a name="l00511"></a>00511       J.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(tk + d2t[k]*<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>, vk);
<a name="l00512"></a>00512       <span class="comment">// I_k = vshape_k.J.t_k, k=1,...,Dof</span>
<a name="l00513"></a>00513       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; j++)
<a name="l00514"></a>00514       {
<a name="l00515"></a>00515          <span class="keywordtype">double</span> Ikj = 0.;
<a name="l00516"></a>00516          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>; i++)
<a name="l00517"></a>00517             Ikj += <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j, i) * vk[i];
<a name="l00518"></a>00518          I(k, j) = (fabs(Ikj) &lt; 1e-12) ? 0.0 : Ikj;
<a name="l00519"></a>00519       }
<a name="l00520"></a>00520    }
<a name="l00521"></a>00521 }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 
<a name="l00524"></a><a class="code" href="classPointFiniteElement.html#abf64ae63b866dc7add2f9dfed646f93e">00524</a> <a class="code" href="classPointFiniteElement.html#abf64ae63b866dc7add2f9dfed646f93e">PointFiniteElement::PointFiniteElement</a>()
<a name="l00525"></a>00525    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(0, <a class="code" href="classGeometry.html">Geometry</a>::POINT, 1, 0)
<a name="l00526"></a>00526 {
<a name="l00527"></a>00527    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a><a class="code" href="classPointFiniteElement.html#a8c4a6ba606c281f5d0ad68a3c7478005">00530</a> <span class="keywordtype">void</span> <a class="code" href="classPointFiniteElement.html#a8c4a6ba606c281f5d0ad68a3c7478005">PointFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00531"></a>00531                                    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00532"></a>00532 <span class="keyword"></span>{
<a name="l00533"></a>00533    shape(0) = 1.;
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a><a class="code" href="classPointFiniteElement.html#a1fe7a179370e509acf03b3c5bf75d7a1">00536</a> <span class="keywordtype">void</span> <a class="code" href="classPointFiniteElement.html#a1fe7a179370e509acf03b3c5bf75d7a1">PointFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00537"></a>00537                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00538"></a>00538 <span class="keyword"></span>{
<a name="l00539"></a>00539    <span class="comment">// doesn&#39;t make sense</span>
<a name="l00540"></a>00540 }
<a name="l00541"></a>00541 
<a name="l00542"></a><a class="code" href="classLinear1DFiniteElement.html#ab7e58a15ff7ccfcb855cf2cfbeb4f013">00542</a> <a class="code" href="classLinear1DFiniteElement.html#ab7e58a15ff7ccfcb855cf2cfbeb4f013" title="Construct a linear FE on interval.">Linear1DFiniteElement::Linear1DFiniteElement</a>()
<a name="l00543"></a>00543    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 2, 1)
<a name="l00544"></a>00544 {
<a name="l00545"></a>00545    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00546"></a>00546    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00547"></a>00547 }
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="classLinear1DFiniteElement.html#a578b20b3725f4d42db153b7a11eb8924">00549</a> <span class="keywordtype">void</span> <a class="code" href="classLinear1DFiniteElement.html#a578b20b3725f4d42db153b7a11eb8924">Linear1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00550"></a>00550                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00551"></a>00551 <span class="keyword"></span>{
<a name="l00552"></a>00552    shape(0) = 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00553"></a>00553    shape(1) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00554"></a>00554 }
<a name="l00555"></a>00555 
<a name="l00556"></a><a class="code" href="classLinear1DFiniteElement.html#ab9e98c019584e7383e9e1ac1deeaae65">00556</a> <span class="keywordtype">void</span> <a class="code" href="classLinear1DFiniteElement.html#ab9e98c019584e7383e9e1ac1deeaae65">Linear1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00557"></a>00557                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00558"></a>00558 <span class="keyword"></span>{
<a name="l00559"></a>00559    dshape(0,0) = -1.;
<a name="l00560"></a>00560    dshape(1,0) =  1.;
<a name="l00561"></a>00561 }
<a name="l00562"></a>00562 
<a name="l00563"></a><a class="code" href="classLinear2DFiniteElement.html#a4f16bac9d74549c5756b81bc2366a71a">00563</a> <a class="code" href="classLinear2DFiniteElement.html#a4f16bac9d74549c5756b81bc2366a71a" title="Construct a linear FE on triangle.">Linear2DFiniteElement::Linear2DFiniteElement</a>()
<a name="l00564"></a>00564    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 3, 1)
<a name="l00565"></a>00565 {
<a name="l00566"></a>00566    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00567"></a>00567    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00568"></a>00568    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00569"></a>00569    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00570"></a>00570    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00571"></a>00571    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a><a class="code" href="classLinear2DFiniteElement.html#a188b47e6ecffa229cdd38df7244fc5b7">00574</a> <span class="keywordtype">void</span> <a class="code" href="classLinear2DFiniteElement.html#a188b47e6ecffa229cdd38df7244fc5b7">Linear2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00575"></a>00575                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00576"></a>00576 <span class="keyword"></span>{
<a name="l00577"></a>00577    shape(0) = 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00578"></a>00578    shape(1) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00579"></a>00579    shape(2) = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00580"></a>00580 }
<a name="l00581"></a>00581 
<a name="l00582"></a><a class="code" href="classLinear2DFiniteElement.html#a1905bb9da8f99d2243028accbf15e318">00582</a> <span class="keywordtype">void</span> <a class="code" href="classLinear2DFiniteElement.html#a1905bb9da8f99d2243028accbf15e318">Linear2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00583"></a>00583                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00584"></a>00584 <span class="keyword"></span>{
<a name="l00585"></a>00585    dshape(0,0) = -1.; dshape(0,1) = -1.;
<a name="l00586"></a>00586    dshape(1,0) =  1.; dshape(1,1) =  0.;
<a name="l00587"></a>00587    dshape(2,0) =  0.; dshape(2,1) =  1.;
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a><a class="code" href="classBiLinear2DFiniteElement.html#a3efa55a4ac86e24fbe53d9ad9fe2d7c1">00590</a> <a class="code" href="classBiLinear2DFiniteElement.html#a3efa55a4ac86e24fbe53d9ad9fe2d7c1" title="Construct a bilinear FE on quadrilateral.">BiLinear2DFiniteElement::BiLinear2DFiniteElement</a>()
<a name="l00591"></a>00591    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE , 4, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l00592"></a>00592 {
<a name="l00593"></a>00593    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00594"></a>00594    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00595"></a>00595    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00596"></a>00596    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00597"></a>00597    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00598"></a>00598    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00599"></a>00599    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00600"></a>00600    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00603"></a><a class="code" href="classBiLinear2DFiniteElement.html#ab944959301c950f810e6e19f67f5b654">00603</a> <span class="keywordtype">void</span> <a class="code" href="classBiLinear2DFiniteElement.html#ab944959301c950f810e6e19f67f5b654">BiLinear2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00604"></a>00604                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00605"></a>00605 <span class="keyword"></span>{
<a name="l00606"></a>00606    shape(0) = (1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>) * (1. - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>) ;
<a name="l00607"></a>00607    shape(1) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> * (1. - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>) ;
<a name="l00608"></a>00608    shape(2) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> * ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> ;
<a name="l00609"></a>00609    shape(3) = (1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>) * ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> ;
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00612"></a><a class="code" href="classBiLinear2DFiniteElement.html#aa450942e338d03bbcb21807cc675addb">00612</a> <span class="keywordtype">void</span> <a class="code" href="classBiLinear2DFiniteElement.html#aa450942e338d03bbcb21807cc675addb">BiLinear2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00613"></a>00613                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00614"></a>00614 <span class="keyword"></span>{
<a name="l00615"></a>00615    dshape(0,0) = -1. + ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>; dshape(0,1) = -1. + ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> ;
<a name="l00616"></a>00616    dshape(1,0) =  1. - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>; dshape(1,1) = -ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> ;
<a name="l00617"></a>00617    dshape(2,0) =  ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> ;     dshape(2,1) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> ;
<a name="l00618"></a>00618    dshape(3,0) = -ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> ;     dshape(3,1) = 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> ;
<a name="l00619"></a>00619 }
<a name="l00620"></a>00620 
<a name="l00621"></a><a class="code" href="classBiLinear2DFiniteElement.html#a97d1059302f28b087ff5993ba67a5312">00621</a> <span class="keywordtype">void</span> <a class="code" href="classBiLinear2DFiniteElement.html#a97d1059302f28b087ff5993ba67a5312">BiLinear2DFiniteElement::CalcHessian</a>(
<a name="l00622"></a>00622    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;h)<span class="keyword"> const</span>
<a name="l00623"></a>00623 <span class="keyword"></span>{
<a name="l00624"></a>00624    h( 0,0) = 0.;   h( 0,1) =  1.;   h( 0,2) = 0.;
<a name="l00625"></a>00625    h( 1,0) = 0.;   h( 1,1) = -1.;   h( 1,2) = 0.;
<a name="l00626"></a>00626    h( 2,0) = 0.;   h( 2,1) =  1.;   h( 2,2) = 0.;
<a name="l00627"></a>00627    h( 3,0) = 0.;   h( 3,1) = -1.;   h( 3,2) = 0.;
<a name="l00628"></a>00628 }
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 
<a name="l00631"></a><a class="code" href="classGaussLinear2DFiniteElement.html#a2d847381932094fc11881e18d23ba8e4">00631</a> <a class="code" href="classGaussLinear2DFiniteElement.html#a2d847381932094fc11881e18d23ba8e4">GaussLinear2DFiniteElement::GaussLinear2DFiniteElement</a>()
<a name="l00632"></a>00632    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 3, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk)
<a name="l00633"></a>00633 {
<a name="l00634"></a>00634    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./6.;
<a name="l00635"></a>00635    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./6.;
<a name="l00636"></a>00636    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l00637"></a>00637    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./6.;
<a name="l00638"></a>00638    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./6.;
<a name="l00639"></a>00639    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l00640"></a>00640 }
<a name="l00641"></a>00641 
<a name="l00642"></a><a class="code" href="classGaussLinear2DFiniteElement.html#af126f1033c37038dc6deddcf083b838f">00642</a> <span class="keywordtype">void</span> <a class="code" href="classGaussLinear2DFiniteElement.html#af126f1033c37038dc6deddcf083b838f">GaussLinear2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00643"></a>00643                                            <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00644"></a>00644 <span class="keyword"></span>{
<a name="l00645"></a>00645    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647    shape(0) = 5./3. - 2. * (x + y);
<a name="l00648"></a>00648    shape(1) = 2. * (x - 1./6.);
<a name="l00649"></a>00649    shape(2) = 2. * (y - 1./6.);
<a name="l00650"></a>00650 }
<a name="l00651"></a>00651 
<a name="l00652"></a><a class="code" href="classGaussLinear2DFiniteElement.html#a77f2fb5ee94ff3dfeb5e60ddb80d2798">00652</a> <span class="keywordtype">void</span> <a class="code" href="classGaussLinear2DFiniteElement.html#a77f2fb5ee94ff3dfeb5e60ddb80d2798">GaussLinear2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00653"></a>00653                                             <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00654"></a>00654 <span class="keyword"></span>{
<a name="l00655"></a>00655    dshape(0,0) = -2.;  dshape(0,1) = -2.;
<a name="l00656"></a>00656    dshape(1,0) =  2.;  dshape(1,1) =  0.;
<a name="l00657"></a>00657    dshape(2,0) =  0.;  dshape(2,1) =  2.;
<a name="l00658"></a>00658 }
<a name="l00659"></a>00659 
<a name="l00660"></a><a class="code" href="classGaussLinear2DFiniteElement.html#a83f9fc99c26ffac881ec6fba46f8eb46">00660</a> <span class="keywordtype">void</span> <a class="code" href="classGaussLinear2DFiniteElement.html#a83f9fc99c26ffac881ec6fba46f8eb46">GaussLinear2DFiniteElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00661"></a>00661 <span class="keyword"></span>{
<a name="l00662"></a>00662    dofs(vertex)       = 2./3.;
<a name="l00663"></a>00663    dofs((vertex+1)%3) = 1./6.;
<a name="l00664"></a>00664    dofs((vertex+2)%3) = 1./6.;
<a name="l00665"></a>00665 }
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 <span class="comment">// 0.5-0.5/sqrt(3) and 0.5+0.5/sqrt(3)</span>
<a name="l00669"></a>00669 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">GaussBiLinear2DFiniteElement::p</a>[] =
<a name="l00670"></a>00670 { 0.2113248654051871177454256, 0.7886751345948128822545744 };
<a name="l00671"></a>00671 
<a name="l00672"></a><a class="code" href="classGaussBiLinear2DFiniteElement.html#a1bb8ef9eea3f9fcc1fb2e289575c2560">00672</a> <a class="code" href="classGaussBiLinear2DFiniteElement.html#a1bb8ef9eea3f9fcc1fb2e289575c2560">GaussBiLinear2DFiniteElement::GaussBiLinear2DFiniteElement</a>()
<a name="l00673"></a>00673    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 4, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l00674"></a>00674 {
<a name="l00675"></a>00675    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0];
<a name="l00676"></a>00676    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0];
<a name="l00677"></a>00677    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1];
<a name="l00678"></a>00678    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0];
<a name="l00679"></a>00679    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1];
<a name="l00680"></a>00680    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1];
<a name="l00681"></a>00681    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0];
<a name="l00682"></a>00682    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1];
<a name="l00683"></a>00683 }
<a name="l00684"></a>00684 
<a name="l00685"></a><a class="code" href="classGaussBiLinear2DFiniteElement.html#ac1739d30e1a37aca25516455dfadef76">00685</a> <span class="keywordtype">void</span> <a class="code" href="classGaussBiLinear2DFiniteElement.html#ac1739d30e1a37aca25516455dfadef76">GaussBiLinear2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00686"></a>00686                                              <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00687"></a>00687 <span class="keyword"></span>{
<a name="l00688"></a>00688    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    shape(0) = 3. * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1] - x) * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1] - y);
<a name="l00691"></a>00691    shape(1) = 3. * (x - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0]) * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1] - y);
<a name="l00692"></a>00692    shape(2) = 3. * (x - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0]) * (y - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0]);
<a name="l00693"></a>00693    shape(3) = 3. * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1] - x) * (y - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0]);
<a name="l00694"></a>00694 }
<a name="l00695"></a>00695 
<a name="l00696"></a><a class="code" href="classGaussBiLinear2DFiniteElement.html#a557a74464720096516f756fede783614">00696</a> <span class="keywordtype">void</span> <a class="code" href="classGaussBiLinear2DFiniteElement.html#a557a74464720096516f756fede783614">GaussBiLinear2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00697"></a>00697                                               <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00698"></a>00698 <span class="keyword"></span>{
<a name="l00699"></a>00699    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701    dshape(0,0) = 3. * (y - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1]);  dshape(0,1) = 3. * (x - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1]);
<a name="l00702"></a>00702    dshape(1,0) = 3. * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1] - y);  dshape(1,1) = 3. * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0] - x);
<a name="l00703"></a>00703    dshape(2,0) = 3. * (y - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0]);  dshape(2,1) = 3. * (x - <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0]);
<a name="l00704"></a>00704    dshape(3,0) = 3. * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[0] - y);  dshape(3,1) = 3. * (<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1] - x);
<a name="l00705"></a>00705 }
<a name="l00706"></a>00706 
<a name="l00707"></a><a class="code" href="classGaussBiLinear2DFiniteElement.html#ace07ef47e8cbe55a8706f9fb0ca4e08d">00707</a> <span class="keywordtype">void</span> <a class="code" href="classGaussBiLinear2DFiniteElement.html#ace07ef47e8cbe55a8706f9fb0ca4e08d">GaussBiLinear2DFiniteElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00708"></a>00708 <span class="keyword"></span>{
<a name="l00709"></a>00709 <span class="preprocessor">#if 1</span>
<a name="l00710"></a>00710 <span class="preprocessor"></span>   dofs(vertex)       = <a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1]*<a class="code" href="classGaussBiLinear2DFiniteElement.html#ae25521aad6a7a3da0d350e548ff6d6db">p</a>[1];
<a name="l00711"></a>00711    dofs((vertex+1)%4) = p[0]*p[1];
<a name="l00712"></a>00712    dofs((vertex+2)%4) = p[0]*p[0];
<a name="l00713"></a>00713    dofs((vertex+3)%4) = p[0]*p[1];
<a name="l00714"></a>00714 <span class="preprocessor">#else</span>
<a name="l00715"></a>00715 <span class="preprocessor"></span>   dofs = 1.0;
<a name="l00716"></a>00716 <span class="preprocessor">#endif</span>
<a name="l00717"></a>00717 <span class="preprocessor"></span>}
<a name="l00718"></a>00718 
<a name="l00719"></a>00719 
<a name="l00720"></a><a class="code" href="classP1OnQuadFiniteElement.html#af3c42a36455ac97efefceb07ded22637">00720</a> <a class="code" href="classP1OnQuadFiniteElement.html#af3c42a36455ac97efefceb07ded22637">P1OnQuadFiniteElement::P1OnQuadFiniteElement</a>()
<a name="l00721"></a>00721    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE , 3, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l00722"></a>00722 {
<a name="l00723"></a>00723    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00724"></a>00724    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00725"></a>00725    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00726"></a>00726    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00727"></a>00727    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00728"></a>00728    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00729"></a>00729 }
<a name="l00730"></a>00730 
<a name="l00731"></a><a class="code" href="classP1OnQuadFiniteElement.html#a89e03ed0c9a71017908785e571276a40">00731</a> <span class="keywordtype">void</span> <a class="code" href="classP1OnQuadFiniteElement.html#a89e03ed0c9a71017908785e571276a40">P1OnQuadFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00732"></a>00732                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00733"></a>00733 <span class="keyword"></span>{
<a name="l00734"></a>00734    shape(0) = 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00735"></a>00735    shape(1) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00736"></a>00736    shape(2) = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00737"></a>00737 }
<a name="l00738"></a>00738 
<a name="l00739"></a><a class="code" href="classP1OnQuadFiniteElement.html#af69e71cef3b26d036a63ea2504dd5449">00739</a> <span class="keywordtype">void</span> <a class="code" href="classP1OnQuadFiniteElement.html#af69e71cef3b26d036a63ea2504dd5449">P1OnQuadFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00740"></a>00740                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00741"></a>00741 <span class="keyword"></span>{
<a name="l00742"></a>00742    dshape(0,0) = -1.; dshape(0,1) = -1.;
<a name="l00743"></a>00743    dshape(1,0) =  1.; dshape(1,1) =  0.;
<a name="l00744"></a>00744    dshape(2,0) =  0.; dshape(2,1) =  1.;
<a name="l00745"></a>00745 }
<a name="l00746"></a>00746 
<a name="l00747"></a>00747 
<a name="l00748"></a><a class="code" href="classQuad1DFiniteElement.html#afe073e50601d9660c121353074fbe4d6">00748</a> <a class="code" href="classQuad1DFiniteElement.html#afe073e50601d9660c121353074fbe4d6" title="Construct a quadratic FE on interval.">Quad1DFiniteElement::Quad1DFiniteElement</a>()
<a name="l00749"></a>00749    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 3, 2)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00752"></a>00752    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00753"></a>00753    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00754"></a>00754 }
<a name="l00755"></a>00755 
<a name="l00756"></a><a class="code" href="classQuad1DFiniteElement.html#a9d7916587288e5de26694fb1beacbfbd">00756</a> <span class="keywordtype">void</span> <a class="code" href="classQuad1DFiniteElement.html#a9d7916587288e5de26694fb1beacbfbd">Quad1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00757"></a>00757                                     <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00758"></a>00758 <span class="keyword"></span>{
<a name="l00759"></a>00759    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00760"></a>00760    <span class="keywordtype">double</span> l1 = 1.0 - x, l2 = x, l3 = 2. * x - 1.;
<a name="l00761"></a>00761 
<a name="l00762"></a>00762    shape(0) = l1 * (-l3);
<a name="l00763"></a>00763    shape(1) = l2 * l3;
<a name="l00764"></a>00764    shape(2) = 4. * l1 * l2;
<a name="l00765"></a>00765 }
<a name="l00766"></a>00766 
<a name="l00767"></a><a class="code" href="classQuad1DFiniteElement.html#aef4a31b92f4913390089c6ccfc921f46">00767</a> <span class="keywordtype">void</span> <a class="code" href="classQuad1DFiniteElement.html#aef4a31b92f4913390089c6ccfc921f46">Quad1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00768"></a>00768                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00769"></a>00769 <span class="keyword"></span>{
<a name="l00770"></a>00770    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772    dshape(0,0) = 4. * x - 3.;
<a name="l00773"></a>00773    dshape(1,0) = 4. * x - 1.;
<a name="l00774"></a>00774    dshape(2,0) = 4. - 8. * x;
<a name="l00775"></a>00775 }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 
<a name="l00778"></a><a class="code" href="classQuadPos1DFiniteElement.html#a0d4c75eadba561c8ae8625799b659251">00778</a> <a class="code" href="classQuadPos1DFiniteElement.html#a0d4c75eadba561c8ae8625799b659251">QuadPos1DFiniteElement::QuadPos1DFiniteElement</a>()
<a name="l00779"></a>00779    : <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 3, 2)
<a name="l00780"></a>00780 {
<a name="l00781"></a>00781    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00782"></a>00782    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00783"></a>00783    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00784"></a>00784 }
<a name="l00785"></a>00785 
<a name="l00786"></a><a class="code" href="classQuadPos1DFiniteElement.html#ac5b71dd247f679fb13a3b92e74a9fbbb">00786</a> <span class="keywordtype">void</span> <a class="code" href="classQuadPos1DFiniteElement.html#ac5b71dd247f679fb13a3b92e74a9fbbb">QuadPos1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00787"></a>00787                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00788"></a>00788 <span class="keyword"></span>{
<a name="l00789"></a>00789    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, x1 = 1. - x;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791    shape(0) = x1 * x1;
<a name="l00792"></a>00792    shape(1) = x * x;
<a name="l00793"></a>00793    shape(2) = 2. * x * x1;
<a name="l00794"></a>00794 }
<a name="l00795"></a>00795 
<a name="l00796"></a><a class="code" href="classQuadPos1DFiniteElement.html#ab0a824c16700dd1562502a5f153b2ee6">00796</a> <span class="keywordtype">void</span> <a class="code" href="classQuadPos1DFiniteElement.html#ab0a824c16700dd1562502a5f153b2ee6">QuadPos1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00797"></a>00797                                         <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00798"></a>00798 <span class="keyword"></span>{
<a name="l00799"></a>00799    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l00800"></a>00800 
<a name="l00801"></a>00801    dshape(0,0) = 2. * x - 2.;
<a name="l00802"></a>00802    dshape(1,0) = 2. * x;
<a name="l00803"></a>00803    dshape(2,0) = 2. - 4. * x;
<a name="l00804"></a>00804 }
<a name="l00805"></a>00805 
<a name="l00806"></a><a class="code" href="classQuad2DFiniteElement.html#a9c58151dd6a7f034e817a945696fd61e">00806</a> <a class="code" href="classQuad2DFiniteElement.html#a9c58151dd6a7f034e817a945696fd61e" title="Construct a quadratic FE on triangle.">Quad2DFiniteElement::Quad2DFiniteElement</a>()
<a name="l00807"></a>00807    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 6, 2)
<a name="l00808"></a>00808 {
<a name="l00809"></a>00809    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00810"></a>00810    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00811"></a>00811    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00812"></a>00812    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00813"></a>00813    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00814"></a>00814    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00815"></a>00815    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00816"></a>00816    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00817"></a>00817    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00818"></a>00818    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l00819"></a>00819    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00820"></a>00820    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l00821"></a>00821 }
<a name="l00822"></a>00822 
<a name="l00823"></a><a class="code" href="classQuad2DFiniteElement.html#aaf710d492dfbb995e57a372fdd0497b4">00823</a> <span class="keywordtype">void</span> <a class="code" href="classQuad2DFiniteElement.html#aaf710d492dfbb995e57a372fdd0497b4">Quad2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00824"></a>00824                                     <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00825"></a>00825 <span class="keyword"></span>{
<a name="l00826"></a>00826    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00827"></a>00827    <span class="keywordtype">double</span> l1 = 1.-x-y, l2 = x, l3 = y;
<a name="l00828"></a>00828 
<a name="l00829"></a>00829    shape(0) = l1 * (2. * l1 - 1.);
<a name="l00830"></a>00830    shape(1) = l2 * (2. * l2 - 1.);
<a name="l00831"></a>00831    shape(2) = l3 * (2. * l3 - 1.);
<a name="l00832"></a>00832    shape(3) = 4. * l1 * l2;
<a name="l00833"></a>00833    shape(4) = 4. * l2 * l3;
<a name="l00834"></a>00834    shape(5) = 4. * l3 * l1;
<a name="l00835"></a>00835 }
<a name="l00836"></a>00836 
<a name="l00837"></a><a class="code" href="classQuad2DFiniteElement.html#a6874cf8d5915fd934c86d8533b7856b3">00837</a> <span class="keywordtype">void</span> <a class="code" href="classQuad2DFiniteElement.html#a6874cf8d5915fd934c86d8533b7856b3">Quad2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00838"></a>00838                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00839"></a>00839 <span class="keyword"></span>{
<a name="l00840"></a>00840    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00841"></a>00841 
<a name="l00842"></a>00842    dshape(0,0) =
<a name="l00843"></a>00843       dshape(0,1) = 4. * (x + y) - 3.;
<a name="l00844"></a>00844 
<a name="l00845"></a>00845    dshape(1,0) = 4. * x - 1.;
<a name="l00846"></a>00846    dshape(1,1) = 0.;
<a name="l00847"></a>00847 
<a name="l00848"></a>00848    dshape(2,0) = 0.;
<a name="l00849"></a>00849    dshape(2,1) = 4. * y - 1.;
<a name="l00850"></a>00850 
<a name="l00851"></a>00851    dshape(3,0) = -4. * (2. * x + y - 1.);
<a name="l00852"></a>00852    dshape(3,1) = -4. * x;
<a name="l00853"></a>00853 
<a name="l00854"></a>00854    dshape(4,0) = 4. * y;
<a name="l00855"></a>00855    dshape(4,1) = 4. * x;
<a name="l00856"></a>00856 
<a name="l00857"></a>00857    dshape(5,0) = -4. * y;
<a name="l00858"></a>00858    dshape(5,1) = -4. * (x + 2. * y - 1.);
<a name="l00859"></a>00859 }
<a name="l00860"></a>00860 
<a name="l00861"></a><a class="code" href="classQuad2DFiniteElement.html#a7d6e8d3768f76e9ce901daf46340d192">00861</a> <span class="keywordtype">void</span> <a class="code" href="classQuad2DFiniteElement.html#a7d6e8d3768f76e9ce901daf46340d192">Quad2DFiniteElement::CalcHessian</a> (<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00862"></a>00862                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;h)<span class="keyword"> const</span>
<a name="l00863"></a>00863 <span class="keyword"></span>{
<a name="l00864"></a>00864    h(0,0) = 4.;
<a name="l00865"></a>00865    h(0,1) = 4.;
<a name="l00866"></a>00866    h(0,2) = 4.;
<a name="l00867"></a>00867 
<a name="l00868"></a>00868    h(1,0) = 4.;
<a name="l00869"></a>00869    h(1,1) = 0.;
<a name="l00870"></a>00870    h(1,2) = 0.;
<a name="l00871"></a>00871 
<a name="l00872"></a>00872    h(2,0) = 0.;
<a name="l00873"></a>00873    h(2,1) = 0.;
<a name="l00874"></a>00874    h(2,2) = 4.;
<a name="l00875"></a>00875 
<a name="l00876"></a>00876    h(3,0) = -8.;
<a name="l00877"></a>00877    h(3,1) = -4.;
<a name="l00878"></a>00878    h(3,2) =  0.;
<a name="l00879"></a>00879 
<a name="l00880"></a>00880    h(4,0) = 0.;
<a name="l00881"></a>00881    h(4,1) = 4.;
<a name="l00882"></a>00882    h(4,2) = 0.;
<a name="l00883"></a>00883 
<a name="l00884"></a>00884    h(5,0) =  0.;
<a name="l00885"></a>00885    h(5,1) = -4.;
<a name="l00886"></a>00886    h(5,2) = -8.;
<a name="l00887"></a>00887 }
<a name="l00888"></a>00888 
<a name="l00889"></a><a class="code" href="classQuad2DFiniteElement.html#af0b5a9beef00793d4072b6ed79be75cb">00889</a> <span class="keywordtype">void</span> <a class="code" href="classQuad2DFiniteElement.html#af0b5a9beef00793d4072b6ed79be75cb">Quad2DFiniteElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00890"></a>00890 <span class="keyword"></span>{
<a name="l00891"></a>00891 <span class="preprocessor">#if 0</span>
<a name="l00892"></a>00892 <span class="preprocessor"></span>   dofs = 1.;
<a name="l00893"></a>00893 <span class="preprocessor">#else</span>
<a name="l00894"></a>00894 <span class="preprocessor"></span>   dofs = 0.;
<a name="l00895"></a>00895    dofs(vertex) = 1.;
<a name="l00896"></a>00896    <span class="keywordflow">switch</span> (vertex)
<a name="l00897"></a>00897    {
<a name="l00898"></a>00898    <span class="keywordflow">case</span> 0: dofs(3) = 0.25; dofs(5) = 0.25; <span class="keywordflow">break</span>;
<a name="l00899"></a>00899    <span class="keywordflow">case</span> 1: dofs(3) = 0.25; dofs(4) = 0.25; <span class="keywordflow">break</span>;
<a name="l00900"></a>00900    <span class="keywordflow">case</span> 2: dofs(4) = 0.25; dofs(5) = 0.25; <span class="keywordflow">break</span>;
<a name="l00901"></a>00901    }
<a name="l00902"></a>00902 <span class="preprocessor">#endif</span>
<a name="l00903"></a>00903 <span class="preprocessor"></span>}
<a name="l00904"></a>00904 
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">GaussQuad2DFiniteElement::p</a>[] =
<a name="l00907"></a>00907 { 0.0915762135097707434595714634022015, 0.445948490915964886318329253883051 };
<a name="l00908"></a>00908 
<a name="l00909"></a><a class="code" href="classGaussQuad2DFiniteElement.html#a23e23a334295ee69e9bc234a1429c7b3">00909</a> <a class="code" href="classGaussQuad2DFiniteElement.html#a23e23a334295ee69e9bc234a1429c7b3">GaussQuad2DFiniteElement::GaussQuad2DFiniteElement</a>()
<a name="l00910"></a>00910    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 6, 2), A(6), D(6,2), pol(6)
<a name="l00911"></a>00911 {
<a name="l00912"></a>00912    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[0];
<a name="l00913"></a>00913    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[0];
<a name="l00914"></a>00914    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1. - 2. * <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[0];
<a name="l00915"></a>00915    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[0];
<a name="l00916"></a>00916    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[0];
<a name="l00917"></a>00917    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1. - 2. * <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[0];
<a name="l00918"></a>00918    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[1];
<a name="l00919"></a>00919    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[1];
<a name="l00920"></a>00920    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1. - 2. * <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[1];
<a name="l00921"></a>00921    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[1];
<a name="l00922"></a>00922    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[1];
<a name="l00923"></a>00923    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1. - 2. * <a class="code" href="classGaussQuad2DFiniteElement.html#a02aa7cc19f21f5c31d92022acf1b25db">p</a>[1];
<a name="l00924"></a>00924 
<a name="l00925"></a>00925    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++)
<a name="l00926"></a>00926    {
<a name="l00927"></a>00927       <span class="keyword">const</span> <span class="keywordtype">double</span> x = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00928"></a>00928       <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>(0,i) = 1.;
<a name="l00929"></a>00929       <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>(1,i) = x;
<a name="l00930"></a>00930       <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>(2,i) = y;
<a name="l00931"></a>00931       <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>(3,i) = x * x;
<a name="l00932"></a>00932       <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>(4,i) = x * y;
<a name="l00933"></a>00933       <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>(5,i) = y * y;
<a name="l00934"></a>00934    }
<a name="l00935"></a>00935 
<a name="l00936"></a>00936    <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l00937"></a>00937 }
<a name="l00938"></a>00938 
<a name="l00939"></a><a class="code" href="classGaussQuad2DFiniteElement.html#a27affe23b77cc6396b096c9d3c84168b">00939</a> <span class="keywordtype">void</span> <a class="code" href="classGaussQuad2DFiniteElement.html#a27affe23b77cc6396b096c9d3c84168b">GaussQuad2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00940"></a>00940                                          <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00941"></a>00941 <span class="keyword"></span>{
<a name="l00942"></a>00942    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00943"></a>00943    <a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>(0) = 1.;
<a name="l00944"></a>00944    <a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>(1) = x;
<a name="l00945"></a>00945    <a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>(2) = y;
<a name="l00946"></a>00946    <a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>(3) = x * x;
<a name="l00947"></a>00947    <a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>(4) = x * y;
<a name="l00948"></a>00948    <a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>(5) = y * y;
<a name="l00949"></a>00949 
<a name="l00950"></a>00950    <a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(<a class="code" href="classGaussQuad2DFiniteElement.html#a418e4aede25a2185293afa74896df049">pol</a>, shape);
<a name="l00951"></a>00951 }
<a name="l00952"></a>00952 
<a name="l00953"></a><a class="code" href="classGaussQuad2DFiniteElement.html#ad72ca53cc6646772258f6b1724627e07">00953</a> <span class="keywordtype">void</span> <a class="code" href="classGaussQuad2DFiniteElement.html#ad72ca53cc6646772258f6b1724627e07">GaussQuad2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00954"></a>00954                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l00955"></a>00955 <span class="keyword"></span>{
<a name="l00956"></a>00956    <span class="keyword">const</span> <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00957"></a>00957    <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(0,0) = 0.;      <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(0,1) = 0.;
<a name="l00958"></a>00958    <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(1,0) = 1.;      <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(1,1) = 0.;
<a name="l00959"></a>00959    <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(2,0) = 0.;      <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(2,1) = 1.;
<a name="l00960"></a>00960    <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(3,0) = 2. *  x; <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(3,1) = 0.;
<a name="l00961"></a>00961    <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(4,0) = y;       <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(4,1) = x;
<a name="l00962"></a>00962    <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(5,0) = 0.;      <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>(5,1) = 2. * y;
<a name="l00963"></a>00963 
<a name="l00964"></a>00964    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classGaussQuad2DFiniteElement.html#a84dea6df3e600561b527e3ae0de627b3">A</a>, <a class="code" href="classGaussQuad2DFiniteElement.html#a94970bccfc4ec49e0fd11a8ff5335724">D</a>, dshape);
<a name="l00965"></a>00965 }
<a name="l00966"></a>00966 
<a name="l00967"></a>00967 
<a name="l00968"></a><a class="code" href="classBiQuad2DFiniteElement.html#af2f11718a802e7b0e7bae2dc795b7682">00968</a> <a class="code" href="classBiQuad2DFiniteElement.html#af2f11718a802e7b0e7bae2dc795b7682" title="Construct a biquadratic FE on quadrilateral.">BiQuad2DFiniteElement::BiQuad2DFiniteElement</a>()
<a name="l00969"></a>00969    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 9, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l00970"></a>00970 {
<a name="l00971"></a>00971    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00972"></a>00972    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00973"></a>00973    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00974"></a>00974    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00975"></a>00975    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00976"></a>00976    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00977"></a>00977    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00978"></a>00978    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00979"></a>00979    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00980"></a>00980    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l00981"></a>00981    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l00982"></a>00982    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l00983"></a>00983    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00984"></a>00984    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l00985"></a>00985    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l00986"></a>00986    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l00987"></a>00987    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l00988"></a>00988    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l00989"></a>00989 }
<a name="l00990"></a>00990 
<a name="l00991"></a><a class="code" href="classBiQuad2DFiniteElement.html#a07611a6977e2cf3455f31a0db204bdfb">00991</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuad2DFiniteElement.html#a07611a6977e2cf3455f31a0db204bdfb">BiQuad2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l00992"></a>00992                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l00993"></a>00993 <span class="keyword"></span>{
<a name="l00994"></a>00994    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l00995"></a>00995    <span class="keywordtype">double</span> l1x, l2x, l3x, l1y, l2y, l3y;
<a name="l00996"></a>00996 
<a name="l00997"></a>00997    l1x = (x - 1.) * (2. * x - 1);
<a name="l00998"></a>00998    l2x = 4. * x * (1. - x);
<a name="l00999"></a>00999    l3x = x * (2. * x - 1.);
<a name="l01000"></a>01000    l1y = (y - 1.) * (2. * y - 1);
<a name="l01001"></a>01001    l2y = 4. * y * (1. - y);
<a name="l01002"></a>01002    l3y = y * (2. * y - 1.);
<a name="l01003"></a>01003 
<a name="l01004"></a>01004    shape(0) = l1x * l1y;
<a name="l01005"></a>01005    shape(4) = l2x * l1y;
<a name="l01006"></a>01006    shape(1) = l3x * l1y;
<a name="l01007"></a>01007    shape(7) = l1x * l2y;
<a name="l01008"></a>01008    shape(8) = l2x * l2y;
<a name="l01009"></a>01009    shape(5) = l3x * l2y;
<a name="l01010"></a>01010    shape(3) = l1x * l3y;
<a name="l01011"></a>01011    shape(6) = l2x * l3y;
<a name="l01012"></a>01012    shape(2) = l3x * l3y;
<a name="l01013"></a>01013 }
<a name="l01014"></a>01014 
<a name="l01015"></a><a class="code" href="classBiQuad2DFiniteElement.html#adeb25126e16065215d777c550cd9ccd6">01015</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuad2DFiniteElement.html#adeb25126e16065215d777c550cd9ccd6">BiQuad2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01016"></a>01016                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01017"></a>01017 <span class="keyword"></span>{
<a name="l01018"></a>01018    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01019"></a>01019    <span class="keywordtype">double</span> l1x, l2x, l3x, l1y, l2y, l3y;
<a name="l01020"></a>01020    <span class="keywordtype">double</span> d1x, d2x, d3x, d1y, d2y, d3y;
<a name="l01021"></a>01021 
<a name="l01022"></a>01022    l1x = (x - 1.) * (2. * x - 1);
<a name="l01023"></a>01023    l2x = 4. * x * (1. - x);
<a name="l01024"></a>01024    l3x = x * (2. * x - 1.);
<a name="l01025"></a>01025    l1y = (y - 1.) * (2. * y - 1);
<a name="l01026"></a>01026    l2y = 4. * y * (1. - y);
<a name="l01027"></a>01027    l3y = y * (2. * y - 1.);
<a name="l01028"></a>01028 
<a name="l01029"></a>01029    d1x = 4. * x - 3.;
<a name="l01030"></a>01030    d2x = 4. - 8. * x;
<a name="l01031"></a>01031    d3x = 4. * x - 1.;
<a name="l01032"></a>01032    d1y = 4. * y - 3.;
<a name="l01033"></a>01033    d2y = 4. - 8. * y;
<a name="l01034"></a>01034    d3y = 4. * y - 1.;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036    dshape(0,0) = d1x * l1y;
<a name="l01037"></a>01037    dshape(0,1) = l1x * d1y;
<a name="l01038"></a>01038 
<a name="l01039"></a>01039    dshape(4,0) = d2x * l1y;
<a name="l01040"></a>01040    dshape(4,1) = l2x * d1y;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042    dshape(1,0) = d3x * l1y;
<a name="l01043"></a>01043    dshape(1,1) = l3x * d1y;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045    dshape(7,0) = d1x * l2y;
<a name="l01046"></a>01046    dshape(7,1) = l1x * d2y;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048    dshape(8,0) = d2x * l2y;
<a name="l01049"></a>01049    dshape(8,1) = l2x * d2y;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051    dshape(5,0) = d3x * l2y;
<a name="l01052"></a>01052    dshape(5,1) = l3x * d2y;
<a name="l01053"></a>01053 
<a name="l01054"></a>01054    dshape(3,0) = d1x * l3y;
<a name="l01055"></a>01055    dshape(3,1) = l1x * d3y;
<a name="l01056"></a>01056 
<a name="l01057"></a>01057    dshape(6,0) = d2x * l3y;
<a name="l01058"></a>01058    dshape(6,1) = l2x * d3y;
<a name="l01059"></a>01059 
<a name="l01060"></a>01060    dshape(2,0) = d3x * l3y;
<a name="l01061"></a>01061    dshape(2,1) = l3x * d3y;
<a name="l01062"></a>01062 }
<a name="l01063"></a>01063 
<a name="l01064"></a><a class="code" href="classBiQuad2DFiniteElement.html#a5fff8ac01ccc5c24513a63d614deca73">01064</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuad2DFiniteElement.html#a5fff8ac01ccc5c24513a63d614deca73">BiQuad2DFiniteElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l01065"></a>01065 <span class="keyword"></span>{
<a name="l01066"></a>01066 <span class="preprocessor">#if 0</span>
<a name="l01067"></a>01067 <span class="preprocessor"></span>   dofs = 1.;
<a name="l01068"></a>01068 <span class="preprocessor">#else</span>
<a name="l01069"></a>01069 <span class="preprocessor"></span>   dofs = 0.;
<a name="l01070"></a>01070    dofs(vertex) = 1.;
<a name="l01071"></a>01071    <span class="keywordflow">switch</span> (vertex)
<a name="l01072"></a>01072    {
<a name="l01073"></a>01073    <span class="keywordflow">case</span> 0: dofs(4) = 0.25; dofs(7) = 0.25; <span class="keywordflow">break</span>;
<a name="l01074"></a>01074    <span class="keywordflow">case</span> 1: dofs(4) = 0.25; dofs(5) = 0.25; <span class="keywordflow">break</span>;
<a name="l01075"></a>01075    <span class="keywordflow">case</span> 2: dofs(5) = 0.25; dofs(6) = 0.25; <span class="keywordflow">break</span>;
<a name="l01076"></a>01076    <span class="keywordflow">case</span> 3: dofs(6) = 0.25; dofs(7) = 0.25; <span class="keywordflow">break</span>;
<a name="l01077"></a>01077    }
<a name="l01078"></a>01078    dofs(8) = 1./16.;
<a name="l01079"></a>01079 <span class="preprocessor">#endif</span>
<a name="l01080"></a>01080 <span class="preprocessor"></span>}
<a name="l01081"></a>01081 
<a name="l01082"></a><a class="code" href="classBiQuadPos2DFiniteElement.html#a76376bece90e90b2a773c812cb6346d8">01082</a> <a class="code" href="classBiQuadPos2DFiniteElement.html#a76376bece90e90b2a773c812cb6346d8">BiQuadPos2DFiniteElement::BiQuadPos2DFiniteElement</a>()
<a name="l01083"></a>01083    : <a class="code" href="classFiniteElement.html" title="Abstract class for Finite Elements.">FiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 9, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l01084"></a>01084 {
<a name="l01085"></a>01085    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01086"></a>01086    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01087"></a>01087    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01088"></a>01088    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01089"></a>01089    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01090"></a>01090    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l01091"></a>01091    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01092"></a>01092    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l01093"></a>01093    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01094"></a>01094    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01095"></a>01095    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01096"></a>01096    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01097"></a>01097    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01098"></a>01098    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l01099"></a>01099    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01100"></a>01100    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01101"></a>01101    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01102"></a>01102    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01103"></a>01103 }
<a name="l01104"></a>01104 
<a name="l01105"></a><a class="code" href="classBiQuadPos2DFiniteElement.html#ae54a875f8c5d441c9e30498a0a49faae">01105</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuadPos2DFiniteElement.html#ae54a875f8c5d441c9e30498a0a49faae">BiQuadPos2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01106"></a>01106                                          <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01107"></a>01107 <span class="keyword"></span>{
<a name="l01108"></a>01108    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01109"></a>01109    <span class="keywordtype">double</span> l1x, l2x, l3x, l1y, l2y, l3y;
<a name="l01110"></a>01110 
<a name="l01111"></a>01111    l1x = (1. - x) * (1. - x);
<a name="l01112"></a>01112    l2x = 2. * x * (1. - x);
<a name="l01113"></a>01113    l3x = x * x;
<a name="l01114"></a>01114    l1y = (1. - y) * (1. - y);
<a name="l01115"></a>01115    l2y = 2. * y * (1. - y);
<a name="l01116"></a>01116    l3y = y * y;
<a name="l01117"></a>01117 
<a name="l01118"></a>01118    shape(0) = l1x * l1y;
<a name="l01119"></a>01119    shape(4) = l2x * l1y;
<a name="l01120"></a>01120    shape(1) = l3x * l1y;
<a name="l01121"></a>01121    shape(7) = l1x * l2y;
<a name="l01122"></a>01122    shape(8) = l2x * l2y;
<a name="l01123"></a>01123    shape(5) = l3x * l2y;
<a name="l01124"></a>01124    shape(3) = l1x * l3y;
<a name="l01125"></a>01125    shape(6) = l2x * l3y;
<a name="l01126"></a>01126    shape(2) = l3x * l3y;
<a name="l01127"></a>01127 }
<a name="l01128"></a>01128 
<a name="l01129"></a><a class="code" href="classBiQuadPos2DFiniteElement.html#a6670eb45d56d705a335752009b0a33d4">01129</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuadPos2DFiniteElement.html#a6670eb45d56d705a335752009b0a33d4">BiQuadPos2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01130"></a>01130                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01131"></a>01131 <span class="keyword"></span>{
<a name="l01132"></a>01132    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01133"></a>01133    <span class="keywordtype">double</span> l1x, l2x, l3x, l1y, l2y, l3y;
<a name="l01134"></a>01134    <span class="keywordtype">double</span> d1x, d2x, d3x, d1y, d2y, d3y;
<a name="l01135"></a>01135 
<a name="l01136"></a>01136    l1x = (1. - x) * (1. - x);
<a name="l01137"></a>01137    l2x = 2. * x * (1. - x);
<a name="l01138"></a>01138    l3x = x * x;
<a name="l01139"></a>01139    l1y = (1. - y) * (1. - y);
<a name="l01140"></a>01140    l2y = 2. * y * (1. - y);
<a name="l01141"></a>01141    l3y = y * y;
<a name="l01142"></a>01142 
<a name="l01143"></a>01143    d1x = 2. * x - 2.;
<a name="l01144"></a>01144    d2x = 2. - 4. * x;
<a name="l01145"></a>01145    d3x = 2. * x;
<a name="l01146"></a>01146    d1y = 2. * y - 2.;
<a name="l01147"></a>01147    d2y = 2. - 4. * y;
<a name="l01148"></a>01148    d3y = 2. * y;
<a name="l01149"></a>01149 
<a name="l01150"></a>01150    dshape(0,0) = d1x * l1y;
<a name="l01151"></a>01151    dshape(0,1) = l1x * d1y;
<a name="l01152"></a>01152 
<a name="l01153"></a>01153    dshape(4,0) = d2x * l1y;
<a name="l01154"></a>01154    dshape(4,1) = l2x * d1y;
<a name="l01155"></a>01155 
<a name="l01156"></a>01156    dshape(1,0) = d3x * l1y;
<a name="l01157"></a>01157    dshape(1,1) = l3x * d1y;
<a name="l01158"></a>01158 
<a name="l01159"></a>01159    dshape(7,0) = d1x * l2y;
<a name="l01160"></a>01160    dshape(7,1) = l1x * d2y;
<a name="l01161"></a>01161 
<a name="l01162"></a>01162    dshape(8,0) = d2x * l2y;
<a name="l01163"></a>01163    dshape(8,1) = l2x * d2y;
<a name="l01164"></a>01164 
<a name="l01165"></a>01165    dshape(5,0) = d3x * l2y;
<a name="l01166"></a>01166    dshape(5,1) = l3x * d2y;
<a name="l01167"></a>01167 
<a name="l01168"></a>01168    dshape(3,0) = d1x * l3y;
<a name="l01169"></a>01169    dshape(3,1) = l1x * d3y;
<a name="l01170"></a>01170 
<a name="l01171"></a>01171    dshape(6,0) = d2x * l3y;
<a name="l01172"></a>01172    dshape(6,1) = l2x * d3y;
<a name="l01173"></a>01173 
<a name="l01174"></a>01174    dshape(2,0) = d3x * l3y;
<a name="l01175"></a>01175    dshape(2,1) = l3x * d3y;
<a name="l01176"></a>01176 }
<a name="l01177"></a>01177 
<a name="l01178"></a><a class="code" href="classBiQuadPos2DFiniteElement.html#a22671eb9eb7809804613d78e913d3a65">01178</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuadPos2DFiniteElement.html#a22671eb9eb7809804613d78e913d3a65">BiQuadPos2DFiniteElement::Project</a>(
<a name="l01179"></a>01179    <a class="code" href="classCoefficient.html" title="Base class Coefficient.">Coefficient</a> &amp;coeff, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l01180"></a>01180 <span class="keyword"></span>{
<a name="l01181"></a>01181    <span class="keywordtype">double</span> *d = dofs;
<a name="l01182"></a>01182 
<a name="l01183"></a>01183    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++)
<a name="l01184"></a>01184    {
<a name="l01185"></a>01185       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i);
<a name="l01186"></a>01186       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l01187"></a>01187       d[i] = coeff.<a class="code" href="classCoefficient.html#ab7a931de5049e9572ddd4401492ae3e7">Eval</a>(Trans, ip);
<a name="l01188"></a>01188    }
<a name="l01189"></a>01189    d[4] = 2. * d[4] - 0.5 * (d[0] + d[1]);
<a name="l01190"></a>01190    d[5] = 2. * d[5] - 0.5 * (d[1] + d[2]);
<a name="l01191"></a>01191    d[6] = 2. * d[6] - 0.5 * (d[2] + d[3]);
<a name="l01192"></a>01192    d[7] = 2. * d[7] - 0.5 * (d[3] + d[0]);
<a name="l01193"></a>01193    d[8] = 4. * d[8] - 0.5 * (d[4] + d[5] + d[6] + d[7]) -
<a name="l01194"></a>01194       0.25 * (d[0] + d[1] + d[2] + d[3]);
<a name="l01195"></a>01195 }
<a name="l01196"></a>01196 
<a name="l01197"></a><a class="code" href="classBiQuadPos2DFiniteElement.html#a7bbc430e41275af6a448c1123358697f">01197</a> <span class="keywordtype">void</span> <a class="code" href="classBiQuadPos2DFiniteElement.html#a22671eb9eb7809804613d78e913d3a65">BiQuadPos2DFiniteElement::Project</a> (
<a name="l01198"></a>01198    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l01199"></a>01199    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l01200"></a>01200 <span class="keyword"></span>{
<a name="l01201"></a>01201    <span class="keywordtype">double</span> v[3];
<a name="l01202"></a>01202    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> x (v, vc.<a class="code" href="classVectorCoefficient.html#a40d2281e54de4ff6bbc327f570f2f76c" title="Returns dimension of the vector.">GetVDim</a>());
<a name="l01203"></a>01203 
<a name="l01204"></a>01204    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 9; i++)
<a name="l01205"></a>01205    {
<a name="l01206"></a>01206       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i);
<a name="l01207"></a>01207       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a>(&amp;ip);
<a name="l01208"></a>01208       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (x, Trans, ip);
<a name="l01209"></a>01209       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; x.Size(); j++)
<a name="l01210"></a>01210          dofs(9*j+i) = v[j];
<a name="l01211"></a>01211    }
<a name="l01212"></a>01212    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; x.Size(); j++)
<a name="l01213"></a>01213    {
<a name="l01214"></a>01214       <span class="keywordtype">double</span> *d = &amp;dofs(9*j);
<a name="l01215"></a>01215 
<a name="l01216"></a>01216       d[4] = 2. * d[4] - 0.5 * (d[0] + d[1]);
<a name="l01217"></a>01217       d[5] = 2. * d[5] - 0.5 * (d[1] + d[2]);
<a name="l01218"></a>01218       d[6] = 2. * d[6] - 0.5 * (d[2] + d[3]);
<a name="l01219"></a>01219       d[7] = 2. * d[7] - 0.5 * (d[3] + d[0]);
<a name="l01220"></a>01220       d[8] = 4. * d[8] - 0.5 * (d[4] + d[5] + d[6] + d[7]) -
<a name="l01221"></a>01221          0.25 * (d[0] + d[1] + d[2] + d[3]);
<a name="l01222"></a>01222    }
<a name="l01223"></a>01223 }
<a name="l01224"></a>01224 
<a name="l01225"></a>01225 
<a name="l01226"></a><a class="code" href="classGaussBiQuad2DFiniteElement.html#af01fda3afdd614401487f2a2b3556c28">01226</a> <a class="code" href="classGaussBiQuad2DFiniteElement.html#af01fda3afdd614401487f2a2b3556c28">GaussBiQuad2DFiniteElement::GaussBiQuad2DFiniteElement</a>()
<a name="l01227"></a>01227    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 9, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l01228"></a>01228 {
<a name="l01229"></a>01229    <span class="keyword">const</span> <span class="keywordtype">double</span> p1 = 0.5*(1.-sqrt(3./5.));
<a name="l01230"></a>01230 
<a name="l01231"></a>01231    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = p1;
<a name="l01232"></a>01232    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = p1;
<a name="l01233"></a>01233    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01234"></a>01234    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = p1;
<a name="l01235"></a>01235    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.-p1;
<a name="l01236"></a>01236    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = p1;
<a name="l01237"></a>01237    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = p1;
<a name="l01238"></a>01238    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01239"></a>01239    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01240"></a>01240    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01241"></a>01241    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.-p1;
<a name="l01242"></a>01242    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01243"></a>01243    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = p1;
<a name="l01244"></a>01244    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.-p1;
<a name="l01245"></a>01245    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01246"></a>01246    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.-p1;
<a name="l01247"></a>01247    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.-p1;
<a name="l01248"></a>01248    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.-p1;
<a name="l01249"></a>01249 }
<a name="l01250"></a>01250 
<a name="l01251"></a><a class="code" href="classGaussBiQuad2DFiniteElement.html#a1aa1432b0dccc870c18b26a9578b3597">01251</a> <span class="keywordtype">void</span> <a class="code" href="classGaussBiQuad2DFiniteElement.html#a1aa1432b0dccc870c18b26a9578b3597">GaussBiQuad2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01252"></a>01252                                            <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01253"></a>01253 <span class="keyword"></span>{
<a name="l01254"></a>01254    <span class="keyword">const</span> <span class="keywordtype">double</span> a = sqrt(5./3.);
<a name="l01255"></a>01255    <span class="keyword">const</span> <span class="keywordtype">double</span> p1 = 0.5*(1.-sqrt(3./5.));
<a name="l01256"></a>01256 
<a name="l01257"></a>01257    <span class="keywordtype">double</span> x = a*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>-p1), y = a*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>-p1);
<a name="l01258"></a>01258    <span class="keywordtype">double</span> l1x, l2x, l3x, l1y, l2y, l3y;
<a name="l01259"></a>01259 
<a name="l01260"></a>01260    l1x = (x - 1.) * (2. * x - 1);
<a name="l01261"></a>01261    l2x = 4. * x * (1. - x);
<a name="l01262"></a>01262    l3x = x * (2. * x - 1.);
<a name="l01263"></a>01263    l1y = (y - 1.) * (2. * y - 1);
<a name="l01264"></a>01264    l2y = 4. * y * (1. - y);
<a name="l01265"></a>01265    l3y = y * (2. * y - 1.);
<a name="l01266"></a>01266 
<a name="l01267"></a>01267    shape(0) = l1x * l1y;
<a name="l01268"></a>01268    shape(4) = l2x * l1y;
<a name="l01269"></a>01269    shape(1) = l3x * l1y;
<a name="l01270"></a>01270    shape(7) = l1x * l2y;
<a name="l01271"></a>01271    shape(8) = l2x * l2y;
<a name="l01272"></a>01272    shape(5) = l3x * l2y;
<a name="l01273"></a>01273    shape(3) = l1x * l3y;
<a name="l01274"></a>01274    shape(6) = l2x * l3y;
<a name="l01275"></a>01275    shape(2) = l3x * l3y;
<a name="l01276"></a>01276 }
<a name="l01277"></a>01277 
<a name="l01278"></a><a class="code" href="classGaussBiQuad2DFiniteElement.html#adae789f0151f82fcc4bba06ffc50940e">01278</a> <span class="keywordtype">void</span> <a class="code" href="classGaussBiQuad2DFiniteElement.html#adae789f0151f82fcc4bba06ffc50940e">GaussBiQuad2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01279"></a>01279                                             <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01280"></a>01280 <span class="keyword"></span>{
<a name="l01281"></a>01281    <span class="keyword">const</span> <span class="keywordtype">double</span> a = sqrt(5./3.);
<a name="l01282"></a>01282    <span class="keyword">const</span> <span class="keywordtype">double</span> p1 = 0.5*(1.-sqrt(3./5.));
<a name="l01283"></a>01283 
<a name="l01284"></a>01284    <span class="keywordtype">double</span> x = a*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>-p1), y = a*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>-p1);
<a name="l01285"></a>01285    <span class="keywordtype">double</span> l1x, l2x, l3x, l1y, l2y, l3y;
<a name="l01286"></a>01286    <span class="keywordtype">double</span> d1x, d2x, d3x, d1y, d2y, d3y;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288    l1x = (x - 1.) * (2. * x - 1);
<a name="l01289"></a>01289    l2x = 4. * x * (1. - x);
<a name="l01290"></a>01290    l3x = x * (2. * x - 1.);
<a name="l01291"></a>01291    l1y = (y - 1.) * (2. * y - 1);
<a name="l01292"></a>01292    l2y = 4. * y * (1. - y);
<a name="l01293"></a>01293    l3y = y * (2. * y - 1.);
<a name="l01294"></a>01294 
<a name="l01295"></a>01295    d1x = a * (4. * x - 3.);
<a name="l01296"></a>01296    d2x = a * (4. - 8. * x);
<a name="l01297"></a>01297    d3x = a * (4. * x - 1.);
<a name="l01298"></a>01298    d1y = a * (4. * y - 3.);
<a name="l01299"></a>01299    d2y = a * (4. - 8. * y);
<a name="l01300"></a>01300    d3y = a * (4. * y - 1.);
<a name="l01301"></a>01301 
<a name="l01302"></a>01302    dshape(0,0) = d1x * l1y;
<a name="l01303"></a>01303    dshape(0,1) = l1x * d1y;
<a name="l01304"></a>01304 
<a name="l01305"></a>01305    dshape(4,0) = d2x * l1y;
<a name="l01306"></a>01306    dshape(4,1) = l2x * d1y;
<a name="l01307"></a>01307 
<a name="l01308"></a>01308    dshape(1,0) = d3x * l1y;
<a name="l01309"></a>01309    dshape(1,1) = l3x * d1y;
<a name="l01310"></a>01310 
<a name="l01311"></a>01311    dshape(7,0) = d1x * l2y;
<a name="l01312"></a>01312    dshape(7,1) = l1x * d2y;
<a name="l01313"></a>01313 
<a name="l01314"></a>01314    dshape(8,0) = d2x * l2y;
<a name="l01315"></a>01315    dshape(8,1) = l2x * d2y;
<a name="l01316"></a>01316 
<a name="l01317"></a>01317    dshape(5,0) = d3x * l2y;
<a name="l01318"></a>01318    dshape(5,1) = l3x * d2y;
<a name="l01319"></a>01319 
<a name="l01320"></a>01320    dshape(3,0) = d1x * l3y;
<a name="l01321"></a>01321    dshape(3,1) = l1x * d3y;
<a name="l01322"></a>01322 
<a name="l01323"></a>01323    dshape(6,0) = d2x * l3y;
<a name="l01324"></a>01324    dshape(6,1) = l2x * d3y;
<a name="l01325"></a>01325 
<a name="l01326"></a>01326    dshape(2,0) = d3x * l3y;
<a name="l01327"></a>01327    dshape(2,1) = l3x * d3y;
<a name="l01328"></a>01328 }
<a name="l01329"></a>01329 
<a name="l01330"></a><a class="code" href="classBiCubic2DFiniteElement.html#a402b267ac2a143d2b7a9686d5d8021d4">01330</a> <a class="code" href="classBiCubic2DFiniteElement.html#a402b267ac2a143d2b7a9686d5d8021d4">BiCubic2DFiniteElement::BiCubic2DFiniteElement</a>()
<a name="l01331"></a>01331    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 16, 3, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l01332"></a>01332 {
<a name="l01333"></a>01333    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.;
<a name="l01334"></a>01334    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.;
<a name="l01335"></a>01335    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.;
<a name="l01336"></a>01336    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.;
<a name="l01337"></a>01337    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.;
<a name="l01338"></a>01338    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.;
<a name="l01339"></a>01339    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.;
<a name="l01340"></a>01340    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.;
<a name="l01341"></a>01341    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l01342"></a>01342    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.;
<a name="l01343"></a>01343    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l01344"></a>01344    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.;
<a name="l01345"></a>01345    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.;
<a name="l01346"></a>01346    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l01347"></a>01347    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.;
<a name="l01348"></a>01348    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l01349"></a>01349    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l01350"></a>01350    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.;
<a name="l01351"></a>01351    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l01352"></a>01352    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.;
<a name="l01353"></a>01353    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.;
<a name="l01354"></a>01354    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l01355"></a>01355    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.;
<a name="l01356"></a>01356    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l01357"></a>01357    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l01358"></a>01358    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l01359"></a>01359    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l01360"></a>01360    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l01361"></a>01361    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l01362"></a>01362    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l01363"></a>01363    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l01364"></a>01364    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l01365"></a>01365 }
<a name="l01366"></a>01366 
<a name="l01367"></a><a class="code" href="classBiCubic2DFiniteElement.html#abe25cf9439e0eca4fa24236586c516d7">01367</a> <span class="keywordtype">void</span> <a class="code" href="classBiCubic2DFiniteElement.html#abe25cf9439e0eca4fa24236586c516d7">BiCubic2DFiniteElement::CalcShape</a>(
<a name="l01368"></a>01368    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01369"></a>01369 <span class="keyword"></span>{
<a name="l01370"></a>01370    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01371"></a>01371 
<a name="l01372"></a>01372    <span class="keywordtype">double</span> w1x, w2x, w3x, w1y, w2y, w3y;
<a name="l01373"></a>01373    <span class="keywordtype">double</span> l0x, l1x, l2x, l3x, l0y, l1y, l2y, l3y;
<a name="l01374"></a>01374 
<a name="l01375"></a>01375    w1x = x - 1./3.; w2x = x - 2./3.; w3x = x - 1.;
<a name="l01376"></a>01376    w1y = y - 1./3.; w2y = y - 2./3.; w3y = y - 1.;
<a name="l01377"></a>01377 
<a name="l01378"></a>01378    l0x = (- 4.5) * w1x * w2x * w3x;
<a name="l01379"></a>01379    l1x = ( 13.5) *   x * w2x * w3x;
<a name="l01380"></a>01380    l2x = (-13.5) *   x * w1x * w3x;
<a name="l01381"></a>01381    l3x = (  4.5) *   x * w1x * w2x;
<a name="l01382"></a>01382 
<a name="l01383"></a>01383    l0y = (- 4.5) * w1y * w2y * w3y;
<a name="l01384"></a>01384    l1y = ( 13.5) *   y * w2y * w3y;
<a name="l01385"></a>01385    l2y = (-13.5) *   y * w1y * w3y;
<a name="l01386"></a>01386    l3y = (  4.5) *   y * w1y * w2y;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388    shape(0)  = l0x * l0y;
<a name="l01389"></a>01389    shape(1)  = l3x * l0y;
<a name="l01390"></a>01390    shape(2)  = l3x * l3y;
<a name="l01391"></a>01391    shape(3)  = l0x * l3y;
<a name="l01392"></a>01392    shape(4)  = l1x * l0y;
<a name="l01393"></a>01393    shape(5)  = l2x * l0y;
<a name="l01394"></a>01394    shape(6)  = l3x * l1y;
<a name="l01395"></a>01395    shape(7)  = l3x * l2y;
<a name="l01396"></a>01396    shape(8)  = l2x * l3y;
<a name="l01397"></a>01397    shape(9)  = l1x * l3y;
<a name="l01398"></a>01398    shape(10) = l0x * l2y;
<a name="l01399"></a>01399    shape(11) = l0x * l1y;
<a name="l01400"></a>01400    shape(12) = l1x * l1y;
<a name="l01401"></a>01401    shape(13) = l2x * l1y;
<a name="l01402"></a>01402    shape(14) = l1x * l2y;
<a name="l01403"></a>01403    shape(15) = l2x * l2y;
<a name="l01404"></a>01404 }
<a name="l01405"></a>01405 
<a name="l01406"></a><a class="code" href="classBiCubic2DFiniteElement.html#afd2f2aa9703e225087a828b748148565">01406</a> <span class="keywordtype">void</span> <a class="code" href="classBiCubic2DFiniteElement.html#afd2f2aa9703e225087a828b748148565">BiCubic2DFiniteElement::CalcDShape</a>(
<a name="l01407"></a>01407    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01408"></a>01408 <span class="keyword"></span>{
<a name="l01409"></a>01409    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01410"></a>01410 
<a name="l01411"></a>01411    <span class="keywordtype">double</span> w1x, w2x, w3x, w1y, w2y, w3y;
<a name="l01412"></a>01412    <span class="keywordtype">double</span> l0x, l1x, l2x, l3x, l0y, l1y, l2y, l3y;
<a name="l01413"></a>01413    <span class="keywordtype">double</span> d0x, d1x, d2x, d3x, d0y, d1y, d2y, d3y;
<a name="l01414"></a>01414 
<a name="l01415"></a>01415    w1x = x - 1./3.; w2x = x - 2./3.; w3x = x - 1.;
<a name="l01416"></a>01416    w1y = y - 1./3.; w2y = y - 2./3.; w3y = y - 1.;
<a name="l01417"></a>01417 
<a name="l01418"></a>01418    l0x = (- 4.5) * w1x * w2x * w3x;
<a name="l01419"></a>01419    l1x = ( 13.5) *   x * w2x * w3x;
<a name="l01420"></a>01420    l2x = (-13.5) *   x * w1x * w3x;
<a name="l01421"></a>01421    l3x = (  4.5) *   x * w1x * w2x;
<a name="l01422"></a>01422 
<a name="l01423"></a>01423    l0y = (- 4.5) * w1y * w2y * w3y;
<a name="l01424"></a>01424    l1y = ( 13.5) *   y * w2y * w3y;
<a name="l01425"></a>01425    l2y = (-13.5) *   y * w1y * w3y;
<a name="l01426"></a>01426    l3y = (  4.5) *   y * w1y * w2y;
<a name="l01427"></a>01427 
<a name="l01428"></a>01428    d0x = -5.5 + ( 18. - 13.5 * x) * x;
<a name="l01429"></a>01429    d1x =  9.  + (-45. + 40.5 * x) * x;
<a name="l01430"></a>01430    d2x = -4.5 + ( 36. - 40.5 * x) * x;
<a name="l01431"></a>01431    d3x =  1.  + (- 9. + 13.5 * x) * x;
<a name="l01432"></a>01432 
<a name="l01433"></a>01433    d0y = -5.5 + ( 18. - 13.5 * y) * y;
<a name="l01434"></a>01434    d1y =  9.  + (-45. + 40.5 * y) * y;
<a name="l01435"></a>01435    d2y = -4.5 + ( 36. - 40.5 * y) * y;
<a name="l01436"></a>01436    d3y =  1.  + (- 9. + 13.5 * y) * y;
<a name="l01437"></a>01437 
<a name="l01438"></a>01438    dshape( 0,0) = d0x * l0y;   dshape( 0,1) = l0x * d0y;
<a name="l01439"></a>01439    dshape( 1,0) = d3x * l0y;   dshape( 1,1) = l3x * d0y;
<a name="l01440"></a>01440    dshape( 2,0) = d3x * l3y;   dshape( 2,1) = l3x * d3y;
<a name="l01441"></a>01441    dshape( 3,0) = d0x * l3y;   dshape( 3,1) = l0x * d3y;
<a name="l01442"></a>01442    dshape( 4,0) = d1x * l0y;   dshape( 4,1) = l1x * d0y;
<a name="l01443"></a>01443    dshape( 5,0) = d2x * l0y;   dshape( 5,1) = l2x * d0y;
<a name="l01444"></a>01444    dshape( 6,0) = d3x * l1y;   dshape( 6,1) = l3x * d1y;
<a name="l01445"></a>01445    dshape( 7,0) = d3x * l2y;   dshape( 7,1) = l3x * d2y;
<a name="l01446"></a>01446    dshape( 8,0) = d2x * l3y;   dshape( 8,1) = l2x * d3y;
<a name="l01447"></a>01447    dshape( 9,0) = d1x * l3y;   dshape( 9,1) = l1x * d3y;
<a name="l01448"></a>01448    dshape(10,0) = d0x * l2y;   dshape(10,1) = l0x * d2y;
<a name="l01449"></a>01449    dshape(11,0) = d0x * l1y;   dshape(11,1) = l0x * d1y;
<a name="l01450"></a>01450    dshape(12,0) = d1x * l1y;   dshape(12,1) = l1x * d1y;
<a name="l01451"></a>01451    dshape(13,0) = d2x * l1y;   dshape(13,1) = l2x * d1y;
<a name="l01452"></a>01452    dshape(14,0) = d1x * l2y;   dshape(14,1) = l1x * d2y;
<a name="l01453"></a>01453    dshape(15,0) = d2x * l2y;   dshape(15,1) = l2x * d2y;
<a name="l01454"></a>01454 }
<a name="l01455"></a>01455 
<a name="l01456"></a><a class="code" href="classBiCubic2DFiniteElement.html#ad9d4f82821cb1fac25877ff93da23265">01456</a> <span class="keywordtype">void</span> <a class="code" href="classBiCubic2DFiniteElement.html#ad9d4f82821cb1fac25877ff93da23265">BiCubic2DFiniteElement::CalcHessian</a>(
<a name="l01457"></a>01457    <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;h)<span class="keyword"> const</span>
<a name="l01458"></a>01458 <span class="keyword"></span>{
<a name="l01459"></a>01459    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01460"></a>01460 
<a name="l01461"></a>01461    <span class="keywordtype">double</span> w1x, w2x, w3x, w1y, w2y, w3y;
<a name="l01462"></a>01462    <span class="keywordtype">double</span> l0x, l1x, l2x, l3x, l0y, l1y, l2y, l3y;
<a name="l01463"></a>01463    <span class="keywordtype">double</span> d0x, d1x, d2x, d3x, d0y, d1y, d2y, d3y;
<a name="l01464"></a>01464    <span class="keywordtype">double</span> h0x, h1x, h2x, h3x, h0y, h1y, h2y, h3y;
<a name="l01465"></a>01465 
<a name="l01466"></a>01466    w1x = x - 1./3.; w2x = x - 2./3.; w3x = x - 1.;
<a name="l01467"></a>01467    w1y = y - 1./3.; w2y = y - 2./3.; w3y = y - 1.;
<a name="l01468"></a>01468 
<a name="l01469"></a>01469    l0x = (- 4.5) * w1x * w2x * w3x;
<a name="l01470"></a>01470    l1x = ( 13.5) *   x * w2x * w3x;
<a name="l01471"></a>01471    l2x = (-13.5) *   x * w1x * w3x;
<a name="l01472"></a>01472    l3x = (  4.5) *   x * w1x * w2x;
<a name="l01473"></a>01473 
<a name="l01474"></a>01474    l0y = (- 4.5) * w1y * w2y * w3y;
<a name="l01475"></a>01475    l1y = ( 13.5) *   y * w2y * w3y;
<a name="l01476"></a>01476    l2y = (-13.5) *   y * w1y * w3y;
<a name="l01477"></a>01477    l3y = (  4.5) *   y * w1y * w2y;
<a name="l01478"></a>01478 
<a name="l01479"></a>01479    d0x = -5.5 + ( 18. - 13.5 * x) * x;
<a name="l01480"></a>01480    d1x =  9.  + (-45. + 40.5 * x) * x;
<a name="l01481"></a>01481    d2x = -4.5 + ( 36. - 40.5 * x) * x;
<a name="l01482"></a>01482    d3x =  1.  + (- 9. + 13.5 * x) * x;
<a name="l01483"></a>01483 
<a name="l01484"></a>01484    d0y = -5.5 + ( 18. - 13.5 * y) * y;
<a name="l01485"></a>01485    d1y =  9.  + (-45. + 40.5 * y) * y;
<a name="l01486"></a>01486    d2y = -4.5 + ( 36. - 40.5 * y) * y;
<a name="l01487"></a>01487    d3y =  1.  + (- 9. + 13.5 * y) * y;
<a name="l01488"></a>01488 
<a name="l01489"></a>01489    h0x = -27. * x + 18.;
<a name="l01490"></a>01490    h1x =  81. * x - 45.;
<a name="l01491"></a>01491    h2x = -81. * x + 36.;
<a name="l01492"></a>01492    h3x =  27. * x -  9.;
<a name="l01493"></a>01493 
<a name="l01494"></a>01494    h0y = -27. * y + 18.;
<a name="l01495"></a>01495    h1y =  81. * y - 45.;
<a name="l01496"></a>01496    h2y = -81. * y + 36.;
<a name="l01497"></a>01497    h3y =  27. * y -  9.;
<a name="l01498"></a>01498 
<a name="l01499"></a>01499    h( 0,0) = h0x * l0y;   h( 0,1) = d0x * d0y;   h( 0,2) = l0x * h0y;
<a name="l01500"></a>01500    h( 1,0) = h3x * l0y;   h( 1,1) = d3x * d0y;   h( 1,2) = l3x * h0y;
<a name="l01501"></a>01501    h( 2,0) = h3x * l3y;   h( 2,1) = d3x * d3y;   h( 2,2) = l3x * h3y;
<a name="l01502"></a>01502    h( 3,0) = h0x * l3y;   h( 3,1) = d0x * d3y;   h( 3,2) = l0x * h3y;
<a name="l01503"></a>01503    h( 4,0) = h1x * l0y;   h( 4,1) = d1x * d0y;   h( 4,2) = l1x * h0y;
<a name="l01504"></a>01504    h( 5,0) = h2x * l0y;   h( 5,1) = d2x * d0y;   h( 5,2) = l2x * h0y;
<a name="l01505"></a>01505    h( 6,0) = h3x * l1y;   h( 6,1) = d3x * d1y;   h( 6,2) = l3x * h1y;
<a name="l01506"></a>01506    h( 7,0) = h3x * l2y;   h( 7,1) = d3x * d2y;   h( 7,2) = l3x * h2y;
<a name="l01507"></a>01507    h( 8,0) = h2x * l3y;   h( 8,1) = d2x * d3y;   h( 8,2) = l2x * h3y;
<a name="l01508"></a>01508    h( 9,0) = h1x * l3y;   h( 9,1) = d1x * d3y;   h( 9,2) = l1x * h3y;
<a name="l01509"></a>01509    h(10,0) = h0x * l2y;   h(10,1) = d0x * d2y;   h(10,2) = l0x * h2y;
<a name="l01510"></a>01510    h(11,0) = h0x * l1y;   h(11,1) = d0x * d1y;   h(11,2) = l0x * h1y;
<a name="l01511"></a>01511    h(12,0) = h1x * l1y;   h(12,1) = d1x * d1y;   h(12,2) = l1x * h1y;
<a name="l01512"></a>01512    h(13,0) = h2x * l1y;   h(13,1) = d2x * d1y;   h(13,2) = l2x * h1y;
<a name="l01513"></a>01513    h(14,0) = h1x * l2y;   h(14,1) = d1x * d2y;   h(14,2) = l1x * h2y;
<a name="l01514"></a>01514    h(15,0) = h2x * l2y;   h(15,1) = d2x * d2y;   h(15,2) = l2x * h2y;
<a name="l01515"></a>01515 }
<a name="l01516"></a>01516 
<a name="l01517"></a>01517 
<a name="l01518"></a><a class="code" href="classCubic1DFiniteElement.html#a729386f473825b54d9a7a4ef1d72e4e6">01518</a> <a class="code" href="classCubic1DFiniteElement.html#a729386f473825b54d9a7a4ef1d72e4e6">Cubic1DFiniteElement::Cubic1DFiniteElement</a>()
<a name="l01519"></a>01519    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 4, 3)
<a name="l01520"></a>01520 {
<a name="l01521"></a>01521    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01522"></a>01522    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01523"></a>01523    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l01524"></a>01524    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.66666666666666666667;
<a name="l01525"></a>01525 }
<a name="l01526"></a>01526 
<a name="l01527"></a><a class="code" href="classCubic1DFiniteElement.html#abd567fc4d3d67acccd1a82136bfcd038">01527</a> <span class="keywordtype">void</span> <a class="code" href="classCubic1DFiniteElement.html#abd567fc4d3d67acccd1a82136bfcd038">Cubic1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01528"></a>01528                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01529"></a>01529 <span class="keyword"></span>{
<a name="l01530"></a>01530    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l01531"></a>01531    <span class="keywordtype">double</span> l1 = x,
<a name="l01532"></a>01532       l2 = (1.0-x),
<a name="l01533"></a>01533       l3 = (0.33333333333333333333-x),
<a name="l01534"></a>01534       l4 = (0.66666666666666666667-x);
<a name="l01535"></a>01535 
<a name="l01536"></a>01536    shape(0) =   4.5 * l2 * l3 * l4;
<a name="l01537"></a>01537    shape(1) =   4.5 * l1 * l3 * l4;
<a name="l01538"></a>01538    shape(2) =  13.5 * l1 * l2 * l4;
<a name="l01539"></a>01539    shape(3) = -13.5 * l1 * l2 * l3;
<a name="l01540"></a>01540 }
<a name="l01541"></a>01541 
<a name="l01542"></a><a class="code" href="classCubic1DFiniteElement.html#adc9ae2a03f1c92be6fa055b187b84dac">01542</a> <span class="keywordtype">void</span> <a class="code" href="classCubic1DFiniteElement.html#adc9ae2a03f1c92be6fa055b187b84dac">Cubic1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01543"></a>01543                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01544"></a>01544 <span class="keyword"></span>{
<a name="l01545"></a>01545    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l01546"></a>01546 
<a name="l01547"></a>01547    dshape(0,0) = -5.5 + x * (18. - 13.5 * x);
<a name="l01548"></a>01548    dshape(1,0) = 1. - x * (9. - 13.5 * x);
<a name="l01549"></a>01549    dshape(2,0) = 9. - x * (45. - 40.5 * x);
<a name="l01550"></a>01550    dshape(3,0) = -4.5 + x * (36. - 40.5 * x);
<a name="l01551"></a>01551 }
<a name="l01552"></a>01552 
<a name="l01553"></a>01553 
<a name="l01554"></a><a class="code" href="classCubic2DFiniteElement.html#a2cee580c75dfc16832ab3fe3de7b022f">01554</a> <a class="code" href="classCubic2DFiniteElement.html#a2cee580c75dfc16832ab3fe3de7b022f">Cubic2DFiniteElement::Cubic2DFiniteElement</a>()
<a name="l01555"></a>01555    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 10, 3)
<a name="l01556"></a>01556 {
<a name="l01557"></a>01557    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01558"></a>01558    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01559"></a>01559    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01560"></a>01560    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01561"></a>01561    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01562"></a>01562    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l01563"></a>01563    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l01564"></a>01564    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01565"></a>01565    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.66666666666666666667;
<a name="l01566"></a>01566    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01567"></a>01567    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.66666666666666666667;
<a name="l01568"></a>01568    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l01569"></a>01569    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l01570"></a>01570    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.66666666666666666667;
<a name="l01571"></a>01571    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01572"></a>01572    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.66666666666666666667;
<a name="l01573"></a>01573    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01574"></a>01574    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l01575"></a>01575    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l01576"></a>01576    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l01577"></a>01577 }
<a name="l01578"></a>01578 
<a name="l01579"></a><a class="code" href="classCubic2DFiniteElement.html#a36288986d189f6f3ae31b734fe34786f">01579</a> <span class="keywordtype">void</span> <a class="code" href="classCubic2DFiniteElement.html#a36288986d189f6f3ae31b734fe34786f">Cubic2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01580"></a>01580                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01581"></a>01581 <span class="keyword"></span>{
<a name="l01582"></a>01582    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01583"></a>01583    <span class="keywordtype">double</span> l1 = (-1. + x + y),
<a name="l01584"></a>01584       lx = (-1. + 3.*x),
<a name="l01585"></a>01585       ly = (-1. + 3.*y);
<a name="l01586"></a>01586 
<a name="l01587"></a>01587    shape(0) = -0.5*l1*(3.*l1 + 1.)*(3.*l1 + 2.);
<a name="l01588"></a>01588    shape(1) =  0.5*x*(lx - 1.)*lx;
<a name="l01589"></a>01589    shape(2) =  0.5*y*(-1. + ly)*ly;
<a name="l01590"></a>01590    shape(3) =  4.5*x*l1*(3.*l1 + 1.);
<a name="l01591"></a>01591    shape(4) = -4.5*x*lx*l1;
<a name="l01592"></a>01592    shape(5) =  4.5*x*lx*y;
<a name="l01593"></a>01593    shape(6) =  4.5*x*y*ly;
<a name="l01594"></a>01594    shape(7) = -4.5*y*l1*ly;
<a name="l01595"></a>01595    shape(8) =  4.5*y*l1*(1. + 3.*l1);
<a name="l01596"></a>01596    shape(9) = -27.*x*y*l1;
<a name="l01597"></a>01597 }
<a name="l01598"></a>01598 
<a name="l01599"></a><a class="code" href="classCubic2DFiniteElement.html#a56c5809b3a5eff065906153e58d166ee">01599</a> <span class="keywordtype">void</span> <a class="code" href="classCubic2DFiniteElement.html#a56c5809b3a5eff065906153e58d166ee">Cubic2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01600"></a>01600                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01601"></a>01601 <span class="keyword"></span>{
<a name="l01602"></a>01602    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01603"></a>01603 
<a name="l01604"></a>01604    dshape(0,0) =  0.5*(-11. + 36.*y - 9.*(x*(-4. + 3.*x) + 6.*x*y + 3.*y*y));
<a name="l01605"></a>01605    dshape(1,0) =  1. + 4.5*x*(-2. + 3.*x);
<a name="l01606"></a>01606    dshape(2,0) =  0.;
<a name="l01607"></a>01607    dshape(3,0) =  4.5*(2. + 9.*x*x - 5.*y + 3.*y*y + 2.*x*(-5. + 6.*y));
<a name="l01608"></a>01608    dshape(4,0) = -4.5*(1. - 1.*y + x*(-8. + 9.*x + 6.*y));
<a name="l01609"></a>01609    dshape(5,0) =  4.5*(-1. + 6.*x)*y;
<a name="l01610"></a>01610    dshape(6,0) =  4.5*y*(-1. + 3.*y);
<a name="l01611"></a>01611    dshape(7,0) =  4.5*(1. - 3.*y)*y;
<a name="l01612"></a>01612    dshape(8,0) =  4.5*y*(-5. + 6.*x + 6.*y);
<a name="l01613"></a>01613    dshape(9,0) =  -27.*y*(-1. + 2.*x + y);
<a name="l01614"></a>01614 
<a name="l01615"></a>01615    dshape(0,1) =  0.5*(-11. + 36.*y - 9.*(x*(-4. + 3.*x) + 6.*x*y + 3.*y*y));
<a name="l01616"></a>01616    dshape(1,1) =  0.;
<a name="l01617"></a>01617    dshape(2,1) =  1. + 4.5*y*(-2. + 3.*y);
<a name="l01618"></a>01618    dshape(3,1) =  4.5*x*(-5. + 6.*x + 6.*y);
<a name="l01619"></a>01619    dshape(4,1) =  4.5*(1. - 3.*x)*x;
<a name="l01620"></a>01620    dshape(5,1) =  4.5*x*(-1. + 3.*x);
<a name="l01621"></a>01621    dshape(6,1) =  4.5*x*(-1. + 6.*y);
<a name="l01622"></a>01622    dshape(7,1) = -4.5*(1. + x*(-1. + 6.*y) + y*(-8. + 9.*y));
<a name="l01623"></a>01623    dshape(8,1) =  4.5*(2. + 3.*x*x + y*(-10. + 9.*y) + x*(-5. + 12.*y));
<a name="l01624"></a>01624    dshape(9,1) = -27.*x*(-1. + x + 2.*y);
<a name="l01625"></a>01625 }
<a name="l01626"></a>01626 
<a name="l01627"></a><a class="code" href="classCubic2DFiniteElement.html#a905c8bde93d134f5a2913e05cb85e2a8">01627</a> <span class="keywordtype">void</span> <a class="code" href="classCubic2DFiniteElement.html#a905c8bde93d134f5a2913e05cb85e2a8">Cubic2DFiniteElement::CalcHessian</a> (<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01628"></a>01628                                         <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;h)<span class="keyword"> const</span>
<a name="l01629"></a>01629 <span class="keyword"></span>{
<a name="l01630"></a>01630    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01631"></a>01631 
<a name="l01632"></a>01632    h(0,0) = 18.-27.*(x+y);
<a name="l01633"></a>01633    h(0,1) = 18.-27.*(x+y);
<a name="l01634"></a>01634    h(0,2) = 18.-27.*(x+y);
<a name="l01635"></a>01635 
<a name="l01636"></a>01636    h(1,0) = -9.+27.*x;
<a name="l01637"></a>01637    h(1,1) = 0.;
<a name="l01638"></a>01638    h(1,2) = 0.;
<a name="l01639"></a>01639 
<a name="l01640"></a>01640    h(2,0) = 0.;
<a name="l01641"></a>01641    h(2,1) = 0.;
<a name="l01642"></a>01642    h(2,2) = -9.+27.*y;
<a name="l01643"></a>01643 
<a name="l01644"></a>01644    h(3,0) = -45.+81.*x+54.*y;
<a name="l01645"></a>01645    h(3,1) = -22.5+54.*x+27.*y;
<a name="l01646"></a>01646    h(3,2) = 27.*x;
<a name="l01647"></a>01647 
<a name="l01648"></a>01648    h(4,0) = 36.-81.*x-27.*y;
<a name="l01649"></a>01649    h(4,1) = 4.5-27.*x;
<a name="l01650"></a>01650    h(4,2) = 0.;
<a name="l01651"></a>01651 
<a name="l01652"></a>01652    h(5,0) = 27.*y;
<a name="l01653"></a>01653    h(5,1) = -4.5+27.*x;
<a name="l01654"></a>01654    h(5,2) = 0.;
<a name="l01655"></a>01655 
<a name="l01656"></a>01656    h(6,0) = 0.;
<a name="l01657"></a>01657    h(6,1) = -4.5+27.*y;
<a name="l01658"></a>01658    h(6,2) = 27.*x;
<a name="l01659"></a>01659 
<a name="l01660"></a>01660    h(7,0) = 0.;
<a name="l01661"></a>01661    h(7,1) = 4.5-27.*y;
<a name="l01662"></a>01662    h(7,2) = 36.-27.*x-81.*y;
<a name="l01663"></a>01663 
<a name="l01664"></a>01664    h(8,0) = 27.*y;
<a name="l01665"></a>01665    h(8,1) = -22.5+27.*x+54.*y;
<a name="l01666"></a>01666    h(8,2) = -45.+54.*x+81.*y;
<a name="l01667"></a>01667 
<a name="l01668"></a>01668    h(9,0) = -54.*y;
<a name="l01669"></a>01669    h(9,1) = 27.-54.*(x+y);
<a name="l01670"></a>01670    h(9,2) = -54.*x;
<a name="l01671"></a>01671 }
<a name="l01672"></a>01672 
<a name="l01673"></a>01673 
<a name="l01674"></a><a class="code" href="classCubic3DFiniteElement.html#a33502b39aa35a9aed42b57acfb6eb685">01674</a> <a class="code" href="classCubic3DFiniteElement.html#a33502b39aa35a9aed42b57acfb6eb685" title="Construct a cubic FE on tetrahedron.">Cubic3DFiniteElement::Cubic3DFiniteElement</a>()
<a name="l01675"></a>01675    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 20, 3)
<a name="l01676"></a>01676 {
<a name="l01677"></a>01677    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01678"></a>01678    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01679"></a>01679    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01680"></a>01680    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.;
<a name="l01681"></a>01681    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01682"></a>01682    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01683"></a>01683    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01684"></a>01684    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.;
<a name="l01685"></a>01685    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01686"></a>01686    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01687"></a>01687    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01688"></a>01688    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.;
<a name="l01689"></a>01689    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.3333333333333333333333333333;
<a name="l01690"></a>01690    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01691"></a>01691    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01692"></a>01692    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.6666666666666666666666666667;
<a name="l01693"></a>01693    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01694"></a>01694    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01695"></a>01695    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01696"></a>01696    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.3333333333333333333333333333;
<a name="l01697"></a>01697    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01698"></a>01698    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01699"></a>01699    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.6666666666666666666666666667;
<a name="l01700"></a>01700    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01701"></a>01701    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01702"></a>01702    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01703"></a>01703    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.3333333333333333333333333333;
<a name="l01704"></a>01704    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01705"></a>01705    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01706"></a>01706    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.6666666666666666666666666667;
<a name="l01707"></a>01707    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.6666666666666666666666666667;
<a name="l01708"></a>01708    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.3333333333333333333333333333;
<a name="l01709"></a>01709    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01710"></a>01710    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.3333333333333333333333333333;
<a name="l01711"></a>01711    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.6666666666666666666666666667;
<a name="l01712"></a>01712    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01713"></a>01713    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.6666666666666666666666666667;
<a name="l01714"></a>01714    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01715"></a>01715    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.3333333333333333333333333333;
<a name="l01716"></a>01716    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.3333333333333333333333333333;
<a name="l01717"></a>01717    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01718"></a>01718    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.6666666666666666666666666667;
<a name="l01719"></a>01719    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01720"></a>01720    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.6666666666666666666666666667;
<a name="l01721"></a>01721    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.3333333333333333333333333333;
<a name="l01722"></a>01722    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01723"></a>01723    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.3333333333333333333333333333;
<a name="l01724"></a>01724    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.6666666666666666666666666667;
<a name="l01725"></a>01725    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.3333333333333333333333333333;
<a name="l01726"></a>01726    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.3333333333333333333333333333;
<a name="l01727"></a>01727    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.3333333333333333333333333333;
<a name="l01728"></a>01728    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0;
<a name="l01729"></a>01729    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.3333333333333333333333333333;
<a name="l01730"></a>01730    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.3333333333333333333333333333;
<a name="l01731"></a>01731    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.3333333333333333333333333333;
<a name="l01732"></a>01732    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0;
<a name="l01733"></a>01733    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.3333333333333333333333333333;
<a name="l01734"></a>01734    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.3333333333333333333333333333;
<a name="l01735"></a>01735    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.3333333333333333333333333333;
<a name="l01736"></a>01736    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0;
<a name="l01737"></a>01737 }
<a name="l01738"></a>01738 
<a name="l01739"></a><a class="code" href="classCubic3DFiniteElement.html#a9575d5a2829ec54b55abb36e22820314">01739</a> <span class="keywordtype">void</span> <a class="code" href="classCubic3DFiniteElement.html#a9575d5a2829ec54b55abb36e22820314">Cubic3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01740"></a>01740                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01741"></a>01741 <span class="keyword"></span>{
<a name="l01742"></a>01742    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l01743"></a>01743 
<a name="l01744"></a>01744    shape(0) = -((-1 + x + y + z)*(-2 + 3*x + 3*y + 3*z)*
<a name="l01745"></a>01745                 (-1 + 3*x + 3*y + 3*z))/2.;
<a name="l01746"></a>01746    shape(4) = (9*x*(-1 + x + y + z)*(-2 + 3*x + 3*y + 3*z))/2.;
<a name="l01747"></a>01747    shape(5) = (-9*x*(-1 + 3*x)*(-1 + x + y + z))/2.;
<a name="l01748"></a>01748    shape(1) = (x*(2 + 9*(-1 + x)*x))/2.;
<a name="l01749"></a>01749    shape(6) = (9*y*(-1 + x + y + z)*(-2 + 3*x + 3*y + 3*z))/2.;
<a name="l01750"></a>01750    shape(19) = -27*x*y*(-1 + x + y + z);
<a name="l01751"></a>01751    shape(10) = (9*x*(-1 + 3*x)*y)/2.;
<a name="l01752"></a>01752    shape(7) = (-9*y*(-1 + 3*y)*(-1 + x + y + z))/2.;
<a name="l01753"></a>01753    shape(11) = (9*x*y*(-1 + 3*y))/2.;
<a name="l01754"></a>01754    shape(2) = (y*(2 + 9*(-1 + y)*y))/2.;
<a name="l01755"></a>01755    shape(8) = (9*z*(-1 + x + y + z)*(-2 + 3*x + 3*y + 3*z))/2.;
<a name="l01756"></a>01756    shape(18) = -27*x*z*(-1 + x + y + z);
<a name="l01757"></a>01757    shape(12) = (9*x*(-1 + 3*x)*z)/2.;
<a name="l01758"></a>01758    shape(17) = -27*y*z*(-1 + x + y + z);
<a name="l01759"></a>01759    shape(16) = 27*x*y*z;
<a name="l01760"></a>01760    shape(14) = (9*y*(-1 + 3*y)*z)/2.;
<a name="l01761"></a>01761    shape(9) = (-9*z*(-1 + x + y + z)*(-1 + 3*z))/2.;
<a name="l01762"></a>01762    shape(13) = (9*x*z*(-1 + 3*z))/2.;
<a name="l01763"></a>01763    shape(15) = (9*y*z*(-1 + 3*z))/2.;
<a name="l01764"></a>01764    shape(3) = (z*(2 + 9*(-1 + z)*z))/2.;
<a name="l01765"></a>01765 }
<a name="l01766"></a>01766 
<a name="l01767"></a><a class="code" href="classCubic3DFiniteElement.html#ace1dbad10ec3227a5466783d93dac067">01767</a> <span class="keywordtype">void</span> <a class="code" href="classCubic3DFiniteElement.html#ace1dbad10ec3227a5466783d93dac067">Cubic3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01768"></a>01768                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01769"></a>01769 <span class="keyword"></span>{
<a name="l01770"></a>01770    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l01771"></a>01771 
<a name="l01772"></a>01772    dshape(0,0) = (-11 + 36*y + 36*z - 9*(3*pow(x,2) + 3*pow(y + z,2) +
<a name="l01773"></a>01773                                          x*(-4 + 6*y + 6*z)))/2.;
<a name="l01774"></a>01774    dshape(0,1) = (-11 + 36*y + 36*z - 9*(3*pow(x,2) + 3*pow(y + z,2) +
<a name="l01775"></a>01775                                          x*(-4 + 6*y + 6*z)))/2.;
<a name="l01776"></a>01776    dshape(0,2) = (-11 + 36*y + 36*z - 9*(3*pow(x,2) + 3*pow(y + z,2) +
<a name="l01777"></a>01777                                          x*(-4 + 6*y + 6*z)))/2.;
<a name="l01778"></a>01778    dshape(4,0) = (9*(9*pow(x,2) + (-1 + y + z)*(-2 + 3*y + 3*z) +
<a name="l01779"></a>01779                      2*x*(-5 + 6*y + 6*z)))/2.;
<a name="l01780"></a>01780    dshape(4,1) = (9*x*(-5 + 6*x + 6*y + 6*z))/2.;
<a name="l01781"></a>01781    dshape(4,2) = (9*x*(-5 + 6*x + 6*y + 6*z))/2.;
<a name="l01782"></a>01782    dshape(5,0) = (-9*(1 - y - z + x*(-8 + 9*x + 6*y + 6*z)))/2.;
<a name="l01783"></a>01783    dshape(5,1) = (9*(1 - 3*x)*x)/2.;
<a name="l01784"></a>01784    dshape(5,2) = (9*(1 - 3*x)*x)/2.;
<a name="l01785"></a>01785    dshape(1,0) = 1 + (9*x*(-2 + 3*x))/2.;
<a name="l01786"></a>01786    dshape(1,1) = 0;
<a name="l01787"></a>01787    dshape(1,2) = 0;
<a name="l01788"></a>01788    dshape(6,0) = (9*y*(-5 + 6*x + 6*y + 6*z))/2.;
<a name="l01789"></a>01789    dshape(6,1) = (9*(2 + 3*pow(x,2) - 10*y - 5*z + 3*(y + z)*(3*y + z) +
<a name="l01790"></a>01790                      x*(-5 + 12*y + 6*z)))/2.;
<a name="l01791"></a>01791    dshape(6,2) = (9*y*(-5 + 6*x + 6*y + 6*z))/2.;
<a name="l01792"></a>01792    dshape(19,0) = -27*y*(-1 + 2*x + y + z);
<a name="l01793"></a>01793    dshape(19,1) = -27*x*(-1 + x + 2*y + z);
<a name="l01794"></a>01794    dshape(19,2) = -27*x*y;
<a name="l01795"></a>01795    dshape(10,0) = (9*(-1 + 6*x)*y)/2.;
<a name="l01796"></a>01796    dshape(10,1) = (9*x*(-1 + 3*x))/2.;
<a name="l01797"></a>01797    dshape(10,2) = 0;
<a name="l01798"></a>01798    dshape(7,0) = (9*(1 - 3*y)*y)/2.;
<a name="l01799"></a>01799    dshape(7,1) = (-9*(1 + x*(-1 + 6*y) - z + y*(-8 + 9*y + 6*z)))/2.;
<a name="l01800"></a>01800    dshape(7,2) = (9*(1 - 3*y)*y)/2.;
<a name="l01801"></a>01801    dshape(11,0) = (9*y*(-1 + 3*y))/2.;
<a name="l01802"></a>01802    dshape(11,1) = (9*x*(-1 + 6*y))/2.;
<a name="l01803"></a>01803    dshape(11,2) = 0;
<a name="l01804"></a>01804    dshape(2,0) = 0;
<a name="l01805"></a>01805    dshape(2,1) = 1 + (9*y*(-2 + 3*y))/2.;
<a name="l01806"></a>01806    dshape(2,2) = 0;
<a name="l01807"></a>01807    dshape(8,0) = (9*z*(-5 + 6*x + 6*y + 6*z))/2.;
<a name="l01808"></a>01808    dshape(8,1) = (9*z*(-5 + 6*x + 6*y + 6*z))/2.;
<a name="l01809"></a>01809    dshape(8,2) = (9*(2 + 3*pow(x,2) - 5*y - 10*z + 3*(y + z)*(y + 3*z) +
<a name="l01810"></a>01810                      x*(-5 + 6*y + 12*z)))/2.;
<a name="l01811"></a>01811    dshape(18,0) = -27*z*(-1 + 2*x + y + z);
<a name="l01812"></a>01812    dshape(18,1) = -27*x*z;
<a name="l01813"></a>01813    dshape(18,2) = -27*x*(-1 + x + y + 2*z);
<a name="l01814"></a>01814    dshape(12,0) = (9*(-1 + 6*x)*z)/2.;
<a name="l01815"></a>01815    dshape(12,1) = 0;
<a name="l01816"></a>01816    dshape(12,2) = (9*x*(-1 + 3*x))/2.;
<a name="l01817"></a>01817    dshape(17,0) = -27*y*z;
<a name="l01818"></a>01818    dshape(17,1) = -27*z*(-1 + x + 2*y + z);
<a name="l01819"></a>01819    dshape(17,2) = -27*y*(-1 + x + y + 2*z);
<a name="l01820"></a>01820    dshape(16,0) = 27*y*z;
<a name="l01821"></a>01821    dshape(16,1) = 27*x*z;
<a name="l01822"></a>01822    dshape(16,2) = 27*x*y;
<a name="l01823"></a>01823    dshape(14,0) = 0;
<a name="l01824"></a>01824    dshape(14,1) = (9*(-1 + 6*y)*z)/2.;
<a name="l01825"></a>01825    dshape(14,2) = (9*y*(-1 + 3*y))/2.;
<a name="l01826"></a>01826    dshape(9,0) = (9*(1 - 3*z)*z)/2.;
<a name="l01827"></a>01827    dshape(9,1) = (9*(1 - 3*z)*z)/2.;
<a name="l01828"></a>01828    dshape(9,2) = (9*(-1 + x + y + 8*z - 6*(x + y)*z - 9*pow(z,2)))/2.;
<a name="l01829"></a>01829    dshape(13,0) = (9*z*(-1 + 3*z))/2.;
<a name="l01830"></a>01830    dshape(13,1) = 0;
<a name="l01831"></a>01831    dshape(13,2) = (9*x*(-1 + 6*z))/2.;
<a name="l01832"></a>01832    dshape(15,0) = 0;
<a name="l01833"></a>01833    dshape(15,1) = (9*z*(-1 + 3*z))/2.;
<a name="l01834"></a>01834    dshape(15,2) = (9*y*(-1 + 6*z))/2.;
<a name="l01835"></a>01835    dshape(3,0) = 0;
<a name="l01836"></a>01836    dshape(3,1) = 0;
<a name="l01837"></a>01837    dshape(3,2) = 1 + (9*z*(-2 + 3*z))/2.;
<a name="l01838"></a>01838 }
<a name="l01839"></a>01839 
<a name="l01840"></a>01840 
<a name="l01841"></a><a class="code" href="classP0TriangleFiniteElement.html#a6f4a5f9953bea096eb47a3594bc6cff2">01841</a> <a class="code" href="classP0TriangleFiniteElement.html#a6f4a5f9953bea096eb47a3594bc6cff2" title="Construct P0 triangle finite element.">P0TriangleFiniteElement::P0TriangleFiniteElement</a>()
<a name="l01842"></a>01842    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE , 1, 0)
<a name="l01843"></a>01843 {
<a name="l01844"></a>01844    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.333333333333333333;
<a name="l01845"></a>01845    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.333333333333333333;
<a name="l01846"></a>01846 }
<a name="l01847"></a>01847 
<a name="l01848"></a><a class="code" href="classP0TriangleFiniteElement.html#a0bfa7906cdd5b76b49f7023e58bf1b98">01848</a> <span class="keywordtype">void</span> <a class="code" href="classP0TriangleFiniteElement.html#a0bfa7906cdd5b76b49f7023e58bf1b98" title="evaluate shape function - constant 1">P0TriangleFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01849"></a>01849                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01850"></a>01850 <span class="keyword"></span>{
<a name="l01851"></a>01851    shape(0) = 1.0;
<a name="l01852"></a>01852 }
<a name="l01853"></a>01853 
<a name="l01854"></a><a class="code" href="classP0TriangleFiniteElement.html#a18e2ecbebf3a7417a1e8e2082c3602d7">01854</a> <span class="keywordtype">void</span> <a class="code" href="classP0TriangleFiniteElement.html#a18e2ecbebf3a7417a1e8e2082c3602d7" title="evaluate derivatives of shape function - constant 0">P0TriangleFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01855"></a>01855                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01856"></a>01856 <span class="keyword"></span>{
<a name="l01857"></a>01857    dshape(0,0) = 0.0;
<a name="l01858"></a>01858    dshape(0,1) = 0.0;
<a name="l01859"></a>01859 }
<a name="l01860"></a>01860 
<a name="l01861"></a>01861 
<a name="l01862"></a><a class="code" href="classP0QuadFiniteElement.html#ad351e2ea1ea1c29061655fd49d55f37d">01862</a> <a class="code" href="classP0QuadFiniteElement.html#ad351e2ea1ea1c29061655fd49d55f37d">P0QuadFiniteElement::P0QuadFiniteElement</a>()
<a name="l01863"></a>01863    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE , 1, 0, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l01864"></a>01864 {
<a name="l01865"></a>01865    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01866"></a>01866    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01867"></a>01867 }
<a name="l01868"></a>01868 
<a name="l01869"></a><a class="code" href="classP0QuadFiniteElement.html#afc005aac6fa35ac55c323c5e3c774344">01869</a> <span class="keywordtype">void</span> <a class="code" href="classP0QuadFiniteElement.html#afc005aac6fa35ac55c323c5e3c774344">P0QuadFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01870"></a>01870                                     <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01871"></a>01871 <span class="keyword"></span>{
<a name="l01872"></a>01872    shape(0) = 1.0;
<a name="l01873"></a>01873 }
<a name="l01874"></a>01874 
<a name="l01875"></a><a class="code" href="classP0QuadFiniteElement.html#aa24e9a3a55e7e35e16ecd7951e555be0">01875</a> <span class="keywordtype">void</span> <a class="code" href="classP0QuadFiniteElement.html#aa24e9a3a55e7e35e16ecd7951e555be0">P0QuadFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01876"></a>01876                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01877"></a>01877 <span class="keyword"></span>{
<a name="l01878"></a>01878    dshape(0,0) = 0.0;
<a name="l01879"></a>01879    dshape(0,1) = 0.0;
<a name="l01880"></a>01880 }
<a name="l01881"></a>01881 
<a name="l01882"></a>01882 
<a name="l01883"></a><a class="code" href="classLinear3DFiniteElement.html#a60b07882f1ce4b204480056c5842b38c">01883</a> <a class="code" href="classLinear3DFiniteElement.html#a60b07882f1ce4b204480056c5842b38c" title="Construct a linear FE on tetrahedron.">Linear3DFiniteElement::Linear3DFiniteElement</a>()
<a name="l01884"></a>01884    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 4, 1)
<a name="l01885"></a>01885 {
<a name="l01886"></a>01886    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01887"></a>01887    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01888"></a>01888    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01889"></a>01889    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01890"></a>01890    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01891"></a>01891    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01892"></a>01892    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01893"></a>01893    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l01894"></a>01894    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01895"></a>01895    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01896"></a>01896    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01897"></a>01897    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l01898"></a>01898 }
<a name="l01899"></a>01899 
<a name="l01900"></a><a class="code" href="classLinear3DFiniteElement.html#a4c1ba3e8636470e86a3fca4af8e44492">01900</a> <span class="keywordtype">void</span> <a class="code" href="classLinear3DFiniteElement.html#a4c1ba3e8636470e86a3fca4af8e44492">Linear3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01901"></a>01901                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01902"></a>01902 <span class="keyword"></span>{
<a name="l01903"></a>01903    shape(0) = 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l01904"></a>01904    shape(1) = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l01905"></a>01905    shape(2) = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01906"></a>01906    shape(3) = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l01907"></a>01907 }
<a name="l01908"></a>01908 
<a name="l01909"></a><a class="code" href="classLinear3DFiniteElement.html#a91844bd49069907aa0600d3f99ab0337">01909</a> <span class="keywordtype">void</span> <a class="code" href="classLinear3DFiniteElement.html#a91844bd49069907aa0600d3f99ab0337">Linear3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01910"></a>01910                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01911"></a>01911 <span class="keyword"></span>{
<a name="l01912"></a>01912    <span class="keywordflow">if</span> (dshape.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == 4)
<a name="l01913"></a>01913    {
<a name="l01914"></a>01914       <span class="keywordtype">double</span> *A = &amp;dshape(0,0);
<a name="l01915"></a>01915       A[0] = -1.; A[4] = -1.; A[8]  = -1.;
<a name="l01916"></a>01916       A[1] =  1.; A[5] =  0.; A[9]  =  0.;
<a name="l01917"></a>01917       A[2] =  0.; A[6] =  1.; A[10] =  0.;
<a name="l01918"></a>01918       A[3] =  0.; A[7] =  0.; A[11] =  1.;
<a name="l01919"></a>01919    }
<a name="l01920"></a>01920    <span class="keywordflow">else</span>
<a name="l01921"></a>01921    {
<a name="l01922"></a>01922       dshape(0,0) = -1.; dshape(0,1) = -1.; dshape(0,2) = -1.;
<a name="l01923"></a>01923       dshape(1,0) =  1.; dshape(1,1) =  0.; dshape(1,2) =  0.;
<a name="l01924"></a>01924       dshape(2,0) =  0.; dshape(2,1) =  1.; dshape(2,2) =  0.;
<a name="l01925"></a>01925       dshape(3,0) =  0.; dshape(3,1) =  0.; dshape(3,2) =  1.;
<a name="l01926"></a>01926    }
<a name="l01927"></a>01927 }
<a name="l01928"></a>01928 
<a name="l01929"></a><a class="code" href="classLinear3DFiniteElement.html#acc615bfeb4d2a41fd4f2083be13a5ab2">01929</a> <span class="keywordtype">void</span> <a class="code" href="classLinear3DFiniteElement.html#acc615bfeb4d2a41fd4f2083be13a5ab2">Linear3DFiniteElement::GetFaceDofs</a> (<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> **dofs, <span class="keywordtype">int</span> *ndofs)<span class="keyword"></span>
<a name="l01930"></a>01930 <span class="keyword">   const</span>
<a name="l01931"></a>01931 <span class="keyword"></span>{
<a name="l01932"></a>01932    <span class="keyword">static</span> <span class="keywordtype">int</span> face_dofs[4][3] = {{1, 2, 3}, {0, 2, 3}, {0, 1, 3}, {0, 1, 2}};
<a name="l01933"></a>01933 
<a name="l01934"></a>01934    *ndofs = 3;
<a name="l01935"></a>01935    *dofs  = face_dofs[face];
<a name="l01936"></a>01936 }
<a name="l01937"></a>01937 
<a name="l01938"></a>01938 
<a name="l01939"></a><a class="code" href="classQuadratic3DFiniteElement.html#a25e10c58cc0bf551b5f858323dbeff24">01939</a> <a class="code" href="classQuadratic3DFiniteElement.html#a25e10c58cc0bf551b5f858323dbeff24" title="Construct a quadratic FE on tetrahedron.">Quadratic3DFiniteElement::Quadratic3DFiniteElement</a>()
<a name="l01940"></a>01940    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 10, 2)
<a name="l01941"></a>01941 {
<a name="l01942"></a>01942    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01943"></a>01943    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01944"></a>01944    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01945"></a>01945    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l01946"></a>01946    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01947"></a>01947    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01948"></a>01948    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01949"></a>01949    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l01950"></a>01950    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01951"></a>01951    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01952"></a>01952    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01953"></a>01953    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l01954"></a>01954    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01955"></a>01955    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01956"></a>01956    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01957"></a>01957    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01958"></a>01958    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01959"></a>01959    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01960"></a>01960    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01961"></a>01961    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01962"></a>01962    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l01963"></a>01963    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01964"></a>01964    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01965"></a>01965    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l01966"></a>01966    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l01967"></a>01967    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l01968"></a>01968    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l01969"></a>01969    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l01970"></a>01970    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l01971"></a>01971    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l01972"></a>01972 }
<a name="l01973"></a>01973 
<a name="l01974"></a><a class="code" href="classQuadratic3DFiniteElement.html#a776a77121c7a29f2d08037e8de923148">01974</a> <span class="keywordtype">void</span> <a class="code" href="classQuadratic3DFiniteElement.html#a776a77121c7a29f2d08037e8de923148">Quadratic3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01975"></a>01975                                          <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l01976"></a>01976 <span class="keyword"></span>{
<a name="l01977"></a>01977    <span class="keywordtype">double</span> L0, L1, L2, L3;
<a name="l01978"></a>01978 
<a name="l01979"></a>01979    L0 = 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l01980"></a>01980    L1 = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l01981"></a>01981    L2 = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l01982"></a>01982    L3 = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l01983"></a>01983 
<a name="l01984"></a>01984    shape(0) = L0 * ( 2.0 * L0 - 1.0 );
<a name="l01985"></a>01985    shape(1) = L1 * ( 2.0 * L1 - 1.0 );
<a name="l01986"></a>01986    shape(2) = L2 * ( 2.0 * L2 - 1.0 );
<a name="l01987"></a>01987    shape(3) = L3 * ( 2.0 * L3 - 1.0 );
<a name="l01988"></a>01988    shape(4) = 4.0 * L0 * L1;
<a name="l01989"></a>01989    shape(5) = 4.0 * L0 * L2;
<a name="l01990"></a>01990    shape(6) = 4.0 * L0 * L3;
<a name="l01991"></a>01991    shape(7) = 4.0 * L1 * L2;
<a name="l01992"></a>01992    shape(8) = 4.0 * L1 * L3;
<a name="l01993"></a>01993    shape(9) = 4.0 * L2 * L3;
<a name="l01994"></a>01994 }
<a name="l01995"></a>01995 
<a name="l01996"></a><a class="code" href="classQuadratic3DFiniteElement.html#a6a72502952d37ff2c49192350a5e3e3d">01996</a> <span class="keywordtype">void</span> <a class="code" href="classQuadratic3DFiniteElement.html#a6a72502952d37ff2c49192350a5e3e3d">Quadratic3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l01997"></a>01997                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l01998"></a>01998 <span class="keyword"></span>{
<a name="l01999"></a>01999    <span class="keywordtype">double</span> x, y, z, L0;
<a name="l02000"></a>02000 
<a name="l02001"></a>02001    x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l02002"></a>02002    y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02003"></a>02003    z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l02004"></a>02004    L0 = 1.0 - x - y - z;
<a name="l02005"></a>02005 
<a name="l02006"></a>02006    dshape(0,0) = dshape(0,1) = dshape(0,2) = 1.0 - 4.0 * L0;
<a name="l02007"></a>02007    dshape(1,0) = -1.0 + 4.0 * x; dshape(1,1) = 0.0; dshape(1,2) = 0.0;
<a name="l02008"></a>02008    dshape(2,0) = 0.0; dshape(2,1) = -1.0 + 4.0 * y; dshape(2,2) = 0.0;
<a name="l02009"></a>02009    dshape(3,0) = dshape(3,1) = 0.0; dshape(3,2) = -1.0 + 4.0 * z;
<a name="l02010"></a>02010    dshape(4,0) = 4.0 * (L0 - x); dshape(4,1) = dshape(4,2) = -4.0 * x;
<a name="l02011"></a>02011    dshape(5,0) = dshape(5,2) = -4.0 * y; dshape(5,1) = 4.0 * (L0 - y);
<a name="l02012"></a>02012    dshape(6,0) = dshape(6,1) = -4.0 * z; dshape(6,2) = 4.0 * (L0 - z);
<a name="l02013"></a>02013    dshape(7,0) = 4.0 * y; dshape(7,1) = 4.0 * x; dshape(7,2) = 0.0;
<a name="l02014"></a>02014    dshape(8,0) = 4.0 * z; dshape(8,1) = 0.0; dshape(8,2) = 4.0 * x;
<a name="l02015"></a>02015    dshape(9,0) = 0.0; dshape(9,1) = 4.0 * z; dshape(9,2) = 4.0 * y;
<a name="l02016"></a>02016 }
<a name="l02017"></a>02017 
<a name="l02018"></a><a class="code" href="classTriLinear3DFiniteElement.html#a05d2aaedbed187bc6b644a96ab17ed68">02018</a> <a class="code" href="classTriLinear3DFiniteElement.html#a05d2aaedbed187bc6b644a96ab17ed68" title="Construct a tri-linear FE on cube.">TriLinear3DFiniteElement::TriLinear3DFiniteElement</a>()
<a name="l02019"></a>02019    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 8, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l02020"></a>02020 {
<a name="l02021"></a>02021    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02022"></a>02022    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02023"></a>02023    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l02024"></a>02024 
<a name="l02025"></a>02025    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l02026"></a>02026    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02027"></a>02027    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l02028"></a>02028 
<a name="l02029"></a>02029    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l02030"></a>02030    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l02031"></a>02031    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l02032"></a>02032 
<a name="l02033"></a>02033    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02034"></a>02034    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l02035"></a>02035    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l02036"></a>02036 
<a name="l02037"></a>02037    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02038"></a>02038    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02039"></a>02039    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l02040"></a>02040 
<a name="l02041"></a>02041    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l02042"></a>02042    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02043"></a>02043    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l02044"></a>02044 
<a name="l02045"></a>02045    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l02046"></a>02046    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l02047"></a>02047    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l02048"></a>02048 
<a name="l02049"></a>02049    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02050"></a>02050    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l02051"></a>02051    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l02052"></a>02052 }
<a name="l02053"></a>02053 
<a name="l02054"></a><a class="code" href="classTriLinear3DFiniteElement.html#af3e103e95f00279c27b89db5cfbe3efa">02054</a> <span class="keywordtype">void</span> <a class="code" href="classTriLinear3DFiniteElement.html#af3e103e95f00279c27b89db5cfbe3efa">TriLinear3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02055"></a>02055                                          <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02056"></a>02056 <span class="keyword"></span>{
<a name="l02057"></a>02057    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l02058"></a>02058    <span class="keywordtype">double</span> ox = 1.-x, oy = 1.-y, oz = 1.-z;
<a name="l02059"></a>02059 
<a name="l02060"></a>02060    shape(0) = ox * oy * oz;
<a name="l02061"></a>02061    shape(1) =  x * oy * oz;
<a name="l02062"></a>02062    shape(2) =  x *  y * oz;
<a name="l02063"></a>02063    shape(3) = ox *  y * oz;
<a name="l02064"></a>02064    shape(4) = ox * oy *  z;
<a name="l02065"></a>02065    shape(5) =  x * oy *  z;
<a name="l02066"></a>02066    shape(6) =  x *  y *  z;
<a name="l02067"></a>02067    shape(7) = ox *  y *  z;
<a name="l02068"></a>02068 }
<a name="l02069"></a>02069 
<a name="l02070"></a><a class="code" href="classTriLinear3DFiniteElement.html#a7c9af910e7613290c287f80aaa67b609">02070</a> <span class="keywordtype">void</span> <a class="code" href="classTriLinear3DFiniteElement.html#a7c9af910e7613290c287f80aaa67b609">TriLinear3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02071"></a>02071                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l02072"></a>02072 <span class="keyword"></span>{
<a name="l02073"></a>02073    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l02074"></a>02074    <span class="keywordtype">double</span> ox = 1.-x, oy = 1.-y, oz = 1.-z;
<a name="l02075"></a>02075 
<a name="l02076"></a>02076    dshape(0,0) = - oy * oz;
<a name="l02077"></a>02077    dshape(0,1) = - ox * oz;
<a name="l02078"></a>02078    dshape(0,2) = - ox * oy;
<a name="l02079"></a>02079 
<a name="l02080"></a>02080    dshape(1,0) =   oy * oz;
<a name="l02081"></a>02081    dshape(1,1) = -  x * oz;
<a name="l02082"></a>02082    dshape(1,2) = -  x * oy;
<a name="l02083"></a>02083 
<a name="l02084"></a>02084    dshape(2,0) =    y * oz;
<a name="l02085"></a>02085    dshape(2,1) =    x * oz;
<a name="l02086"></a>02086    dshape(2,2) = -  x *  y;
<a name="l02087"></a>02087 
<a name="l02088"></a>02088    dshape(3,0) = -  y * oz;
<a name="l02089"></a>02089    dshape(3,1) =   ox * oz;
<a name="l02090"></a>02090    dshape(3,2) = - ox *  y;
<a name="l02091"></a>02091 
<a name="l02092"></a>02092    dshape(4,0) = - oy *  z;
<a name="l02093"></a>02093    dshape(4,1) = - ox *  z;
<a name="l02094"></a>02094    dshape(4,2) =   ox * oy;
<a name="l02095"></a>02095 
<a name="l02096"></a>02096    dshape(5,0) =   oy *  z;
<a name="l02097"></a>02097    dshape(5,1) = -  x *  z;
<a name="l02098"></a>02098    dshape(5,2) =    x * oy;
<a name="l02099"></a>02099 
<a name="l02100"></a>02100    dshape(6,0) =    y *  z;
<a name="l02101"></a>02101    dshape(6,1) =    x *  z;
<a name="l02102"></a>02102    dshape(6,2) =    x *  y;
<a name="l02103"></a>02103 
<a name="l02104"></a>02104    dshape(7,0) = -  y *  z;
<a name="l02105"></a>02105    dshape(7,1) =   ox *  z;
<a name="l02106"></a>02106    dshape(7,2) =   ox *  y;
<a name="l02107"></a>02107 }
<a name="l02108"></a>02108 
<a name="l02109"></a><a class="code" href="classP0SegmentFiniteElement.html#ac2de91340f391fb6ae7ccfa83b02c7a6">02109</a> <a class="code" href="classP0SegmentFiniteElement.html#ac2de91340f391fb6ae7ccfa83b02c7a6">P0SegmentFiniteElement::P0SegmentFiniteElement</a>(<span class="keywordtype">int</span> Ord)
<a name="l02110"></a>02110    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT , 1, Ord)  <span class="comment">// defaul Ord = 0</span>
<a name="l02111"></a>02111 {
<a name="l02112"></a>02112    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02113"></a>02113 }
<a name="l02114"></a>02114 
<a name="l02115"></a><a class="code" href="classP0SegmentFiniteElement.html#a527d8c57b7c6a5d0aad7685ad7fad63b">02115</a> <span class="keywordtype">void</span> <a class="code" href="classP0SegmentFiniteElement.html#a527d8c57b7c6a5d0aad7685ad7fad63b">P0SegmentFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02116"></a>02116                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02117"></a>02117 <span class="keyword"></span>{
<a name="l02118"></a>02118    shape(0) = 1.0;
<a name="l02119"></a>02119 }
<a name="l02120"></a>02120 
<a name="l02121"></a><a class="code" href="classP0SegmentFiniteElement.html#a63be148eb5f117daf04dcb28682f1fb7">02121</a> <span class="keywordtype">void</span> <a class="code" href="classP0SegmentFiniteElement.html#a63be148eb5f117daf04dcb28682f1fb7">P0SegmentFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02122"></a>02122                                         <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l02123"></a>02123 <span class="keyword"></span>{
<a name="l02124"></a>02124    dshape(0,0) = 0.0;
<a name="l02125"></a>02125 }
<a name="l02126"></a>02126 
<a name="l02127"></a><a class="code" href="classCrouzeixRaviartFiniteElement.html#a2486fd5db961a5c89c8a17edaa15fb29">02127</a> <a class="code" href="classCrouzeixRaviartFiniteElement.html#a2486fd5db961a5c89c8a17edaa15fb29">CrouzeixRaviartFiniteElement::CrouzeixRaviartFiniteElement</a>()
<a name="l02128"></a>02128    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE , 3, 1)
<a name="l02129"></a>02129 {
<a name="l02130"></a>02130    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02131"></a>02131    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02132"></a>02132    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02133"></a>02133    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02134"></a>02134    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02135"></a>02135    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02136"></a>02136 }
<a name="l02137"></a>02137 
<a name="l02138"></a><a class="code" href="classCrouzeixRaviartFiniteElement.html#a0435ae3e02142e4d780f27ef92d479d8">02138</a> <span class="keywordtype">void</span> <a class="code" href="classCrouzeixRaviartFiniteElement.html#a0435ae3e02142e4d780f27ef92d479d8">CrouzeixRaviartFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02139"></a>02139                                              <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02140"></a>02140 <span class="keyword"></span>{
<a name="l02141"></a>02141    shape(0) =  1.0 - 2.0 * ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02142"></a>02142    shape(1) = -1.0 + 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> + ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l02143"></a>02143    shape(2) =  1.0 - 2.0 * ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l02144"></a>02144 }
<a name="l02145"></a>02145 
<a name="l02146"></a><a class="code" href="classCrouzeixRaviartFiniteElement.html#a74ee7e1c46b339cc1db0ead5b662de3f">02146</a> <span class="keywordtype">void</span> <a class="code" href="classCrouzeixRaviartFiniteElement.html#a74ee7e1c46b339cc1db0ead5b662de3f">CrouzeixRaviartFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02147"></a>02147                                               <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l02148"></a>02148 <span class="keyword"></span>{
<a name="l02149"></a>02149    dshape(0,0) =  0.0; dshape(0,1) = -2.0;
<a name="l02150"></a>02150    dshape(1,0) =  2.0; dshape(1,1) =  2.0;
<a name="l02151"></a>02151    dshape(2,0) = -2.0; dshape(2,1) =  0.0;
<a name="l02152"></a>02152 }
<a name="l02153"></a>02153 
<a name="l02154"></a><a class="code" href="classCrouzeixRaviartQuadFiniteElement.html#ad9629727f8d509eac5ae2033699b816e">02154</a> <a class="code" href="classCrouzeixRaviartQuadFiniteElement.html#ad9629727f8d509eac5ae2033699b816e">CrouzeixRaviartQuadFiniteElement::CrouzeixRaviartQuadFiniteElement</a>()
<a name="l02155"></a>02155 <span class="comment">// the FunctionSpace should be rotated (45 degrees) Q_1</span>
<a name="l02156"></a>02156 <span class="comment">// i.e. the span of { 1, x, y, x^2 - y^2 }</span>
<a name="l02157"></a>02157    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE , 4, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l02158"></a>02158 
<a name="l02159"></a>02159 {
<a name="l02160"></a>02160    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02161"></a>02161    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02162"></a>02162    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l02163"></a>02163    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02164"></a>02164    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02165"></a>02165    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l02166"></a>02166    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02167"></a>02167    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02168"></a>02168 }
<a name="l02169"></a>02169 
<a name="l02170"></a><a class="code" href="classCrouzeixRaviartQuadFiniteElement.html#a3fa3abc95f03d5ab9b55eeb3d9f94152">02170</a> <span class="keywordtype">void</span> <a class="code" href="classCrouzeixRaviartQuadFiniteElement.html#a3fa3abc95f03d5ab9b55eeb3d9f94152">CrouzeixRaviartQuadFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02171"></a>02171                                                  <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02172"></a>02172 <span class="keyword"></span>{
<a name="l02173"></a>02173    <span class="keyword">const</span> <span class="keywordtype">double</span> l1 = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>+ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>-0.5, l2 = 1.-l1, l3 = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>-ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>+0.5, l4 = 1.-l3;
<a name="l02174"></a>02174 
<a name="l02175"></a>02175    shape(0) = l2 * l3;
<a name="l02176"></a>02176    shape(1) = l1 * l3;
<a name="l02177"></a>02177    shape(2) = l1 * l4;
<a name="l02178"></a>02178    shape(3) = l2 * l4;
<a name="l02179"></a>02179 }
<a name="l02180"></a>02180 
<a name="l02181"></a><a class="code" href="classCrouzeixRaviartQuadFiniteElement.html#adfc6d684584b325d532b14262fbfcdc8">02181</a> <span class="keywordtype">void</span> <a class="code" href="classCrouzeixRaviartQuadFiniteElement.html#adfc6d684584b325d532b14262fbfcdc8">CrouzeixRaviartQuadFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02182"></a>02182                                                   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l02183"></a>02183 <span class="keyword"></span>{
<a name="l02184"></a>02184    <span class="keyword">const</span> <span class="keywordtype">double</span> x2 = 2.*ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y2 = 2.*ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02185"></a>02185 
<a name="l02186"></a>02186    dshape(0,0) =  1. - x2; dshape(0,1) = -2. + y2;
<a name="l02187"></a>02187    dshape(1,0) =       x2; dshape(1,1) =  1. - y2;
<a name="l02188"></a>02188    dshape(2,0) =  1. - x2; dshape(2,1) =       y2;
<a name="l02189"></a>02189    dshape(3,0) = -2. + x2; dshape(3,1) =  1. - y2;
<a name="l02190"></a>02190 }
<a name="l02191"></a>02191 
<a name="l02192"></a>02192 
<a name="l02193"></a><a class="code" href="classRT0TriangleFiniteElement.html#afc8415ad26208ad47ec61e2bc6aa7dd7">02193</a> <a class="code" href="classRT0TriangleFiniteElement.html#afc8415ad26208ad47ec61e2bc6aa7dd7">RT0TriangleFiniteElement::RT0TriangleFiniteElement</a>()
<a name="l02194"></a>02194    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 3, 1)
<a name="l02195"></a>02195 {
<a name="l02196"></a>02196    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02197"></a>02197    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02198"></a>02198    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02199"></a>02199    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02200"></a>02200    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02201"></a>02201    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02202"></a>02202 }
<a name="l02203"></a>02203 
<a name="l02204"></a><a class="code" href="classRT0TriangleFiniteElement.html#a26c93acaa6dbe2aa83ee6a4dd4780fe7">02204</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TriangleFiniteElement.html#a26c93acaa6dbe2aa83ee6a4dd4780fe7">RT0TriangleFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02205"></a>02205                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02206"></a>02206 <span class="keyword"></span>{
<a name="l02207"></a>02207    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02208"></a>02208 
<a name="l02209"></a>02209    shape(0,0) = x;
<a name="l02210"></a>02210    shape(0,1) = y - 1.;
<a name="l02211"></a>02211    shape(1,0) = x;
<a name="l02212"></a>02212    shape(1,1) = y;
<a name="l02213"></a>02213    shape(2,0) = x - 1.;
<a name="l02214"></a>02214    shape(2,1) = y;
<a name="l02215"></a>02215 }
<a name="l02216"></a>02216 
<a name="l02217"></a><a class="code" href="classRT0TriangleFiniteElement.html#af8d2c3c6b2f84751b718db54f10012ab">02217</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TriangleFiniteElement.html#af8d2c3c6b2f84751b718db54f10012ab">RT0TriangleFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02218"></a>02218                                             <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l02219"></a>02219 <span class="keyword"></span>{
<a name="l02220"></a>02220    divshape(0) = 2.;
<a name="l02221"></a>02221    divshape(1) = 2.;
<a name="l02222"></a>02222    divshape(2) = 2.;
<a name="l02223"></a>02223 }
<a name="l02224"></a>02224 
<a name="l02225"></a>02225 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">RT0TriangleFiniteElement::nk</a>[3][2] =
<a name="l02226"></a>02226 { {0, -1}, {1, 1}, {-1, 0} };
<a name="l02227"></a>02227 
<a name="l02228"></a><a class="code" href="classRT0TriangleFiniteElement.html#a6b8b48b59b9b450925f9ea8f514bb704">02228</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TriangleFiniteElement.html#a6b8b48b59b9b450925f9ea8f514bb704">RT0TriangleFiniteElement::GetLocalInterpolation</a> (
<a name="l02229"></a>02229    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l02230"></a>02230 <span class="keyword"></span>{
<a name="l02231"></a>02231    <span class="keywordtype">int</span> k, j;
<a name="l02232"></a>02232 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02233"></a>02233 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02234"></a>02234    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02235"></a>02235 <span class="preprocessor">#endif</span>
<a name="l02236"></a>02236 <span class="preprocessor"></span>
<a name="l02237"></a>02237 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02238"></a>02238 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++)
<a name="l02239"></a>02239    {
<a name="l02240"></a>02240       <a class="code" href="classRT0TriangleFiniteElement.html#a26c93acaa6dbe2aa83ee6a4dd4780fe7">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l02241"></a>02241       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)
<a name="l02242"></a>02242       {
<a name="l02243"></a>02243          <span class="keywordtype">double</span> d = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][1];
<a name="l02244"></a>02244          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l02245"></a>02245          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l02246"></a>02246          {
<a name="l02247"></a>02247             cerr &lt;&lt; <span class="stringliteral">&quot;RT0TriangleFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l02248"></a>02248                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l02249"></a>02249             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l02250"></a>02250          }
<a name="l02251"></a>02251       }
<a name="l02252"></a>02252    }
<a name="l02253"></a>02253 <span class="preprocessor">#endif</span>
<a name="l02254"></a>02254 <span class="preprocessor"></span>
<a name="l02255"></a>02255    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l02256"></a>02256    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02257"></a>02257    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l02258"></a>02258    <span class="comment">// Trans must be linear</span>
<a name="l02259"></a>02259    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02260"></a>02260    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02261"></a>02261    <span class="keywordtype">double</span> vk[2];
<a name="l02262"></a>02262    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02263"></a>02263 
<a name="l02264"></a>02264    <span class="keywordflow">for</span> (k = 0; k &lt; 3; k++)
<a name="l02265"></a>02265    {
<a name="l02266"></a>02266       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l02267"></a>02267       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1];
<a name="l02268"></a>02268       <a class="code" href="classRT0TriangleFiniteElement.html#a26c93acaa6dbe2aa83ee6a4dd4780fe7">CalcVShape</a> (ip, vshape);
<a name="l02269"></a>02269       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l02270"></a>02270       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][1];
<a name="l02271"></a>02271       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1];
<a name="l02272"></a>02272       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)
<a name="l02273"></a>02273          <span class="keywordflow">if</span> (fabs (I(k,j) = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]) &lt; 1.0e-12)
<a name="l02274"></a>02274             I(k,j) = 0.0;
<a name="l02275"></a>02275    }
<a name="l02276"></a>02276 }
<a name="l02277"></a>02277 
<a name="l02278"></a><a class="code" href="classRT0TriangleFiniteElement.html#aaebae1ea677f277ad010094e065e905c">02278</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TriangleFiniteElement.html#aaebae1ea677f277ad010094e065e905c">RT0TriangleFiniteElement::Project</a> (
<a name="l02279"></a>02279    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l02280"></a>02280    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l02281"></a>02281 <span class="keyword"></span>{
<a name="l02282"></a>02282    <span class="keywordtype">double</span> vk[2];
<a name="l02283"></a>02283    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02284"></a>02284 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02285"></a>02285 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02286"></a>02286 <span class="preprocessor">#endif</span>
<a name="l02287"></a>02287 <span class="preprocessor"></span>
<a name="l02288"></a>02288    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 3; k++)
<a name="l02289"></a>02289    {
<a name="l02290"></a>02290       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02291"></a>02291       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02292"></a>02292       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02293"></a>02293 
<a name="l02294"></a>02294       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02295"></a>02295       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l02296"></a>02296       dofs(k) = (vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][1] ) +
<a name="l02297"></a>02297                  vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT0TriangleFiniteElement.html#ae998469a1522d4f9c3191382e1ff30e7">nk</a>[k][1] ));
<a name="l02298"></a>02298    }
<a name="l02299"></a>02299 }
<a name="l02300"></a>02300 
<a name="l02301"></a><a class="code" href="classRT0QuadFiniteElement.html#a46535621b1910975ed97dcda26f8a116">02301</a> <a class="code" href="classRT0QuadFiniteElement.html#a46535621b1910975ed97dcda26f8a116">RT0QuadFiniteElement::RT0QuadFiniteElement</a>()
<a name="l02302"></a>02302    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 4, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l02303"></a>02303 {
<a name="l02304"></a>02304    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02305"></a>02305    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02306"></a>02306    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l02307"></a>02307    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02308"></a>02308    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02309"></a>02309    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l02310"></a>02310    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02311"></a>02311    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02312"></a>02312 }
<a name="l02313"></a>02313 
<a name="l02314"></a><a class="code" href="classRT0QuadFiniteElement.html#a9683ee1e32a8512092d45d9326e5abd8">02314</a> <span class="keywordtype">void</span> <a class="code" href="classRT0QuadFiniteElement.html#a9683ee1e32a8512092d45d9326e5abd8">RT0QuadFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02315"></a>02315                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02316"></a>02316 <span class="keyword"></span>{
<a name="l02317"></a>02317    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02318"></a>02318 
<a name="l02319"></a>02319    shape(0,0) = 0;
<a name="l02320"></a>02320    shape(0,1) = y - 1.;
<a name="l02321"></a>02321    shape(1,0) = x;
<a name="l02322"></a>02322    shape(1,1) = 0;
<a name="l02323"></a>02323    shape(2,0) = 0;
<a name="l02324"></a>02324    shape(2,1) = y;
<a name="l02325"></a>02325    shape(3,0) = x - 1.;
<a name="l02326"></a>02326    shape(3,1) = 0;
<a name="l02327"></a>02327 }
<a name="l02328"></a>02328 
<a name="l02329"></a><a class="code" href="classRT0QuadFiniteElement.html#a5ceb7edd22af5dc211fc4cef5b19f18c">02329</a> <span class="keywordtype">void</span> <a class="code" href="classRT0QuadFiniteElement.html#a5ceb7edd22af5dc211fc4cef5b19f18c">RT0QuadFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02330"></a>02330                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l02331"></a>02331 <span class="keyword"></span>{
<a name="l02332"></a>02332    divshape(0) = 1.;
<a name="l02333"></a>02333    divshape(1) = 1.;
<a name="l02334"></a>02334    divshape(2) = 1.;
<a name="l02335"></a>02335    divshape(3) = 1.;
<a name="l02336"></a>02336 }
<a name="l02337"></a>02337 
<a name="l02338"></a>02338 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">RT0QuadFiniteElement::nk</a>[4][2] =
<a name="l02339"></a>02339 { {0, -1}, {1, 0}, {0, 1}, {-1, 0} };
<a name="l02340"></a>02340 
<a name="l02341"></a><a class="code" href="classRT0QuadFiniteElement.html#a4406562c2312cde53c0c16c8f30adb24">02341</a> <span class="keywordtype">void</span> <a class="code" href="classRT0QuadFiniteElement.html#a4406562c2312cde53c0c16c8f30adb24">RT0QuadFiniteElement::GetLocalInterpolation</a> (
<a name="l02342"></a>02342    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l02343"></a>02343 <span class="keyword"></span>{
<a name="l02344"></a>02344    <span class="keywordtype">int</span> k, j;
<a name="l02345"></a>02345 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02346"></a>02346 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02347"></a>02347    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02348"></a>02348 <span class="preprocessor">#endif</span>
<a name="l02349"></a>02349 <span class="preprocessor"></span>
<a name="l02350"></a>02350 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02351"></a>02351 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 4; k++)
<a name="l02352"></a>02352    {
<a name="l02353"></a>02353       <a class="code" href="classRT0QuadFiniteElement.html#a9683ee1e32a8512092d45d9326e5abd8">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l02354"></a>02354       <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l02355"></a>02355       {
<a name="l02356"></a>02356          <span class="keywordtype">double</span> d = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][1];
<a name="l02357"></a>02357          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l02358"></a>02358          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l02359"></a>02359          {
<a name="l02360"></a>02360             cerr &lt;&lt; <span class="stringliteral">&quot;RT0QuadFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l02361"></a>02361                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l02362"></a>02362             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l02363"></a>02363          }
<a name="l02364"></a>02364       }
<a name="l02365"></a>02365    }
<a name="l02366"></a>02366 <span class="preprocessor">#endif</span>
<a name="l02367"></a>02367 <span class="preprocessor"></span>
<a name="l02368"></a>02368    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l02369"></a>02369    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02370"></a>02370    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l02371"></a>02371    <span class="comment">// Trans must be linear (more to have embedding?)</span>
<a name="l02372"></a>02372    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02373"></a>02373    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02374"></a>02374    <span class="keywordtype">double</span> vk[2];
<a name="l02375"></a>02375    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02376"></a>02376 
<a name="l02377"></a>02377    <span class="keywordflow">for</span> (k = 0; k &lt; 4; k++)
<a name="l02378"></a>02378    {
<a name="l02379"></a>02379       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l02380"></a>02380       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1];
<a name="l02381"></a>02381       <a class="code" href="classRT0QuadFiniteElement.html#a9683ee1e32a8512092d45d9326e5abd8">CalcVShape</a> (ip, vshape);
<a name="l02382"></a>02382       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l02383"></a>02383       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][1];
<a name="l02384"></a>02384       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1];
<a name="l02385"></a>02385       <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l02386"></a>02386          <span class="keywordflow">if</span> (fabs (I(k,j) = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]) &lt; 1.0e-12)
<a name="l02387"></a>02387             I(k,j) = 0.0;
<a name="l02388"></a>02388    }
<a name="l02389"></a>02389 }
<a name="l02390"></a>02390 
<a name="l02391"></a><a class="code" href="classRT0QuadFiniteElement.html#a1a2b1a72098ea493d68b92c2372daf52">02391</a> <span class="keywordtype">void</span> <a class="code" href="classRT0QuadFiniteElement.html#a1a2b1a72098ea493d68b92c2372daf52">RT0QuadFiniteElement::Project</a> (
<a name="l02392"></a>02392    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l02393"></a>02393    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l02394"></a>02394 <span class="keyword"></span>{
<a name="l02395"></a>02395    <span class="keywordtype">double</span> vk[2];
<a name="l02396"></a>02396    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02397"></a>02397 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02398"></a>02398 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02399"></a>02399 <span class="preprocessor">#endif</span>
<a name="l02400"></a>02400 <span class="preprocessor"></span>
<a name="l02401"></a>02401    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 4; k++)
<a name="l02402"></a>02402    {
<a name="l02403"></a>02403       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02404"></a>02404       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02405"></a>02405       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02406"></a>02406 
<a name="l02407"></a>02407       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02408"></a>02408       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l02409"></a>02409       dofs(k) = (vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][1] ) +
<a name="l02410"></a>02410                  vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT0QuadFiniteElement.html#a26c5d595b2dd0bf05301754870734085">nk</a>[k][1] ));
<a name="l02411"></a>02411    }
<a name="l02412"></a>02412 }
<a name="l02413"></a>02413 
<a name="l02414"></a><a class="code" href="classRT1TriangleFiniteElement.html#a5772d45118c0a4f14d11159a0fa6c787">02414</a> <a class="code" href="classRT1TriangleFiniteElement.html#a5772d45118c0a4f14d11159a0fa6c787">RT1TriangleFiniteElement::RT1TriangleFiniteElement</a>()
<a name="l02415"></a>02415    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 8, 2)
<a name="l02416"></a>02416 {
<a name="l02417"></a>02417    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l02418"></a>02418    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02419"></a>02419    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.66666666666666666667;
<a name="l02420"></a>02420    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02421"></a>02421    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.66666666666666666667;
<a name="l02422"></a>02422    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l02423"></a>02423    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l02424"></a>02424    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.66666666666666666667;
<a name="l02425"></a>02425    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02426"></a>02426    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.66666666666666666667;
<a name="l02427"></a>02427    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02428"></a>02428    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l02429"></a>02429    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l02430"></a>02430    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l02431"></a>02431    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l02432"></a>02432    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l02433"></a>02433 }
<a name="l02434"></a>02434 
<a name="l02435"></a><a class="code" href="classRT1TriangleFiniteElement.html#a6c97707304e2559abcc5d7f262f04a07">02435</a> <span class="keywordtype">void</span> <a class="code" href="classRT1TriangleFiniteElement.html#a6c97707304e2559abcc5d7f262f04a07">RT1TriangleFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02436"></a>02436                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02437"></a>02437 <span class="keyword"></span>{
<a name="l02438"></a>02438    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02439"></a>02439 
<a name="l02440"></a>02440    shape(0,0) = -2 * x * (-1 + x + 2 * y);
<a name="l02441"></a>02441    shape(0,1) = -2 * (-1 + y) * (-1 + x + 2 * y);
<a name="l02442"></a>02442    shape(1,0) =  2 * x * (x - y);
<a name="l02443"></a>02443    shape(1,1) =  2 * (x - y) * (-1 + y);
<a name="l02444"></a>02444    shape(2,0) =  2 * x * (-1 + 2 * x + y);
<a name="l02445"></a>02445    shape(2,1) =  2 * y * (-1 + 2 * x + y);
<a name="l02446"></a>02446    shape(3,0) =  2 * x * (-1 + x + 2 * y);
<a name="l02447"></a>02447    shape(3,1) =  2 * y * (-1 + x + 2 * y);
<a name="l02448"></a>02448    shape(4,0) = -2 * (-1 + x) * (x - y);
<a name="l02449"></a>02449    shape(4,1) =  2 * y * (-x + y);
<a name="l02450"></a>02450    shape(5,0) = -2 * (-1 + x) * (-1 + 2 * x + y);
<a name="l02451"></a>02451    shape(5,1) = -2 * y * (-1 + 2 * x + y);
<a name="l02452"></a>02452    shape(6,0) = -3 * x * (-2 + 2 * x + y);
<a name="l02453"></a>02453    shape(6,1) = -3 * y * (-1 + 2 * x + y);
<a name="l02454"></a>02454    shape(7,0) = -3 * x * (-1 + x + 2 * y);
<a name="l02455"></a>02455    shape(7,1) = -3 * y * (-2 + x + 2 * y);
<a name="l02456"></a>02456 }
<a name="l02457"></a>02457 
<a name="l02458"></a><a class="code" href="classRT1TriangleFiniteElement.html#aaee323cad4759ea76d5e9b5c2acac245">02458</a> <span class="keywordtype">void</span> <a class="code" href="classRT1TriangleFiniteElement.html#aaee323cad4759ea76d5e9b5c2acac245">RT1TriangleFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02459"></a>02459                                             <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l02460"></a>02460 <span class="keyword"></span>{
<a name="l02461"></a>02461    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02462"></a>02462 
<a name="l02463"></a>02463    divshape(0) = -2 * (-4 + 3 * x + 6 * y);
<a name="l02464"></a>02464    divshape(1) =  2 + 6 * x - 6 * y;
<a name="l02465"></a>02465    divshape(2) = -4 + 12 * x + 6 * y;
<a name="l02466"></a>02466    divshape(3) = -4 + 6 * x + 12 * y;
<a name="l02467"></a>02467    divshape(4) =  2 - 6 * x + 6 * y;
<a name="l02468"></a>02468    divshape(5) = -2 * (-4 + 6 * x + 3 * y);
<a name="l02469"></a>02469    divshape(6) = -9 * (-1 + 2 * x + y);
<a name="l02470"></a>02470    divshape(7) = -9 * (-1 + x + 2 * y);
<a name="l02471"></a>02471 }
<a name="l02472"></a>02472 
<a name="l02473"></a>02473 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">RT1TriangleFiniteElement::nk</a>[8][2] =
<a name="l02474"></a>02474 {
<a name="l02475"></a>02475    { 0,-1}, { 0,-1},
<a name="l02476"></a>02476    { 1, 1}, { 1, 1},
<a name="l02477"></a>02477    {-1, 0}, {-1, 0},
<a name="l02478"></a>02478    { 1, 0}, { 0, 1}
<a name="l02479"></a>02479 };
<a name="l02480"></a>02480 
<a name="l02481"></a><a class="code" href="classRT1TriangleFiniteElement.html#a032a721cfd013f8c053376c3b8962c27">02481</a> <span class="keywordtype">void</span> <a class="code" href="classRT1TriangleFiniteElement.html#a032a721cfd013f8c053376c3b8962c27">RT1TriangleFiniteElement::GetLocalInterpolation</a> (
<a name="l02482"></a>02482    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l02483"></a>02483 <span class="keyword"></span>{
<a name="l02484"></a>02484    <span class="keywordtype">int</span> k, j;
<a name="l02485"></a>02485 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02486"></a>02486 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02487"></a>02487    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02488"></a>02488 <span class="preprocessor">#endif</span>
<a name="l02489"></a>02489 <span class="preprocessor"></span>
<a name="l02490"></a>02490 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02491"></a>02491 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 8; k++)
<a name="l02492"></a>02492    {
<a name="l02493"></a>02493       <a class="code" href="classRT1TriangleFiniteElement.html#a6c97707304e2559abcc5d7f262f04a07">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l02494"></a>02494       <span class="keywordflow">for</span> (j = 0; j &lt; 8; j++)
<a name="l02495"></a>02495       {
<a name="l02496"></a>02496          <span class="keywordtype">double</span> d = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][1];
<a name="l02497"></a>02497          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l02498"></a>02498          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l02499"></a>02499          {
<a name="l02500"></a>02500             cerr &lt;&lt; <span class="stringliteral">&quot;RT1QuadFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l02501"></a>02501                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l02502"></a>02502             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l02503"></a>02503          }
<a name="l02504"></a>02504       }
<a name="l02505"></a>02505    }
<a name="l02506"></a>02506 <span class="preprocessor">#endif</span>
<a name="l02507"></a>02507 <span class="preprocessor"></span>
<a name="l02508"></a>02508    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l02509"></a>02509    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02510"></a>02510    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l02511"></a>02511    <span class="comment">// Trans must be linear (more to have embedding?)</span>
<a name="l02512"></a>02512    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02513"></a>02513    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02514"></a>02514    <span class="keywordtype">double</span> vk[2];
<a name="l02515"></a>02515    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02516"></a>02516 
<a name="l02517"></a>02517    <span class="keywordflow">for</span> (k = 0; k &lt; 8; k++)
<a name="l02518"></a>02518    {
<a name="l02519"></a>02519       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l02520"></a>02520       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1];
<a name="l02521"></a>02521       <a class="code" href="classRT1TriangleFiniteElement.html#a6c97707304e2559abcc5d7f262f04a07">CalcVShape</a> (ip, vshape);
<a name="l02522"></a>02522       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l02523"></a>02523       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][1];
<a name="l02524"></a>02524       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1];
<a name="l02525"></a>02525       <span class="keywordflow">for</span> (j = 0; j &lt; 8; j++)
<a name="l02526"></a>02526          <span class="keywordflow">if</span> (fabs (I(k,j) = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]) &lt; 1.0e-12)
<a name="l02527"></a>02527             I(k,j) = 0.0;
<a name="l02528"></a>02528    }
<a name="l02529"></a>02529 }
<a name="l02530"></a>02530 
<a name="l02531"></a><a class="code" href="classRT1TriangleFiniteElement.html#a4fdeee09f3c51f64172981a837d44980">02531</a> <span class="keywordtype">void</span> <a class="code" href="classRT1TriangleFiniteElement.html#a4fdeee09f3c51f64172981a837d44980">RT1TriangleFiniteElement::Project</a> (
<a name="l02532"></a>02532    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l02533"></a>02533 <span class="keyword"></span>{
<a name="l02534"></a>02534    <span class="keywordtype">double</span> vk[2];
<a name="l02535"></a>02535    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02536"></a>02536 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02537"></a>02537 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02538"></a>02538 <span class="preprocessor">#endif</span>
<a name="l02539"></a>02539 <span class="preprocessor"></span>
<a name="l02540"></a>02540    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 8; k++)
<a name="l02541"></a>02541    {
<a name="l02542"></a>02542       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02543"></a>02543       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02544"></a>02544       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02545"></a>02545 
<a name="l02546"></a>02546       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02547"></a>02547       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l02548"></a>02548       dofs(k) = (vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][1] ) +
<a name="l02549"></a>02549                  vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT1TriangleFiniteElement.html#ab88eebd2e0d21ef1a03b611545ff3510">nk</a>[k][1] ));
<a name="l02550"></a>02550       dofs(k) *= 0.5;
<a name="l02551"></a>02551    }
<a name="l02552"></a>02552 }
<a name="l02553"></a>02553 
<a name="l02554"></a><a class="code" href="classRT1QuadFiniteElement.html#a393f0464dcc8bcb49efe60be1abb110d">02554</a> <a class="code" href="classRT1QuadFiniteElement.html#a393f0464dcc8bcb49efe60be1abb110d">RT1QuadFiniteElement::RT1QuadFiniteElement</a>()
<a name="l02555"></a>02555    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 12, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l02556"></a>02556 {
<a name="l02557"></a>02557    <span class="comment">// y = 0</span>
<a name="l02558"></a>02558    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1./3.;
<a name="l02559"></a>02559    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.0;
<a name="l02560"></a>02560    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 2./3.;
<a name="l02561"></a>02561    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.0;
<a name="l02562"></a>02562    <span class="comment">// x = 1</span>
<a name="l02563"></a>02563    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1.0;
<a name="l02564"></a>02564    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1./3.;
<a name="l02565"></a>02565    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1.0;
<a name="l02566"></a>02566    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 2./3.;
<a name="l02567"></a>02567    <span class="comment">// y = 1</span>
<a name="l02568"></a>02568    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 2./3.;
<a name="l02569"></a>02569    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1.0;
<a name="l02570"></a>02570    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1./3.;
<a name="l02571"></a>02571    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1.0;
<a name="l02572"></a>02572    <span class="comment">// x = 0</span>
<a name="l02573"></a>02573    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 0.0;
<a name="l02574"></a>02574    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 2./3.;
<a name="l02575"></a>02575    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 0.0;
<a name="l02576"></a>02576    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1./3.;
<a name="l02577"></a>02577    <span class="comment">// x = 0.5 (interior)</span>
<a name="l02578"></a>02578    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 0.5;
<a name="l02579"></a>02579    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1./3.;
<a name="l02580"></a>02580    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 0.5;
<a name="l02581"></a>02581    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 2./3.;
<a name="l02582"></a>02582    <span class="comment">// y = 0.5 (interior)</span>
<a name="l02583"></a>02583    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l02584"></a>02584    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02585"></a>02585    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l02586"></a>02586    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02587"></a>02587 }
<a name="l02588"></a>02588 
<a name="l02589"></a><a class="code" href="classRT1QuadFiniteElement.html#af6547363dc091ae96d9fa074fdbcaae7">02589</a> <span class="keywordtype">void</span> <a class="code" href="classRT1QuadFiniteElement.html#af6547363dc091ae96d9fa074fdbcaae7">RT1QuadFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02590"></a>02590                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02591"></a>02591 <span class="keyword"></span>{
<a name="l02592"></a>02592    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02593"></a>02593 
<a name="l02594"></a>02594    <span class="comment">// y = 0</span>
<a name="l02595"></a>02595    shape(0,0)  = 0;
<a name="l02596"></a>02596    shape(0,1)  = -( 1. - 3.*y + 2.*y*y)*( 2. - 3.*x);
<a name="l02597"></a>02597    shape(1,0)  = 0;
<a name="l02598"></a>02598    shape(1,1)  = -( 1. - 3.*y + 2.*y*y)*(-1. + 3.*x);
<a name="l02599"></a>02599    <span class="comment">// x = 1</span>
<a name="l02600"></a>02600    shape(2,0)  = (-x + 2.*x*x)*( 2. - 3.*y);
<a name="l02601"></a>02601    shape(2,1)  = 0;
<a name="l02602"></a>02602    shape(3,0)  = (-x + 2.*x*x)*(-1. + 3.*y);
<a name="l02603"></a>02603    shape(3,1)  = 0;
<a name="l02604"></a>02604    <span class="comment">// y = 1</span>
<a name="l02605"></a>02605    shape(4,0)  = 0;
<a name="l02606"></a>02606    shape(4,1)  = (-y + 2.*y*y)*(-1. + 3.*x);
<a name="l02607"></a>02607    shape(5,0)  = 0;
<a name="l02608"></a>02608    shape(5,1)  = (-y + 2.*y*y)*( 2. - 3.*x);
<a name="l02609"></a>02609    <span class="comment">// x = 0</span>
<a name="l02610"></a>02610    shape(6,0)  = -(1. - 3.*x + 2.*x*x)*(-1. + 3.*y);
<a name="l02611"></a>02611    shape(6,1)  = 0;
<a name="l02612"></a>02612    shape(7,0)  = -(1. - 3.*x + 2.*x*x)*( 2. - 3.*y);
<a name="l02613"></a>02613    shape(7,1)  = 0;
<a name="l02614"></a>02614    <span class="comment">// x = 0.5 (interior)</span>
<a name="l02615"></a>02615    shape(8,0)  = (4.*x - 4.*x*x)*( 2. - 3.*y);
<a name="l02616"></a>02616    shape(8,1)  = 0;
<a name="l02617"></a>02617    shape(9,0)  = (4.*x - 4.*x*x)*(-1. + 3.*y);
<a name="l02618"></a>02618    shape(9,1)  = 0;
<a name="l02619"></a>02619    <span class="comment">// y = 0.5 (interior)</span>
<a name="l02620"></a>02620    shape(10,0) = 0;
<a name="l02621"></a>02621    shape(10,1) = (4.*y - 4.*y*y)*( 2. - 3.*x);
<a name="l02622"></a>02622    shape(11,0) = 0;
<a name="l02623"></a>02623    shape(11,1) = (4.*y - 4.*y*y)*(-1. + 3.*x);
<a name="l02624"></a>02624 }
<a name="l02625"></a>02625 
<a name="l02626"></a><a class="code" href="classRT1QuadFiniteElement.html#a012437e5cb56a467acb62011b290c84f">02626</a> <span class="keywordtype">void</span> <a class="code" href="classRT1QuadFiniteElement.html#a012437e5cb56a467acb62011b290c84f">RT1QuadFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02627"></a>02627                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l02628"></a>02628 <span class="keyword"></span>{
<a name="l02629"></a>02629    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02630"></a>02630 
<a name="l02631"></a>02631    divshape(0)  = -(-3. + 4.*y)*( 2. - 3.*x);
<a name="l02632"></a>02632    divshape(1)  = -(-3. + 4.*y)*(-1. + 3.*x);
<a name="l02633"></a>02633    divshape(2)  = (-1. + 4.*x)*( 2. - 3.*y);
<a name="l02634"></a>02634    divshape(3)  = (-1. + 4.*x)*(-1. + 3.*y);
<a name="l02635"></a>02635    divshape(4)  = (-1. + 4.*y)*(-1. + 3.*x);
<a name="l02636"></a>02636    divshape(5)  = (-1. + 4.*y)*( 2. - 3.*x);
<a name="l02637"></a>02637    divshape(6)  = -(-3. + 4.*x)*(-1. + 3.*y);
<a name="l02638"></a>02638    divshape(7)  = -(-3. + 4.*x)*( 2. - 3.*y);
<a name="l02639"></a>02639    divshape(8)  = ( 4. - 8.*x)*( 2. - 3.*y);
<a name="l02640"></a>02640    divshape(9)  = ( 4. - 8.*x)*(-1. + 3.*y);
<a name="l02641"></a>02641    divshape(10) = ( 4. - 8.*y)*( 2. - 3.*x);
<a name="l02642"></a>02642    divshape(11) = ( 4. - 8.*y)*(-1. + 3.*x);
<a name="l02643"></a>02643 }
<a name="l02644"></a>02644 
<a name="l02645"></a>02645 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">RT1QuadFiniteElement::nk</a>[12][2] =
<a name="l02646"></a>02646 {
<a name="l02647"></a>02647    <span class="comment">// y = 0</span>
<a name="l02648"></a>02648    {0,-1}, {0,-1},
<a name="l02649"></a>02649    <span class="comment">// X = 1</span>
<a name="l02650"></a>02650    {1, 0}, {1, 0},
<a name="l02651"></a>02651    <span class="comment">// y = 1</span>
<a name="l02652"></a>02652    {0, 1}, {0, 1},
<a name="l02653"></a>02653    <span class="comment">// x = 0</span>
<a name="l02654"></a>02654    {-1,0}, {-1,0},
<a name="l02655"></a>02655    <span class="comment">// x = 0.5 (interior)</span>
<a name="l02656"></a>02656    {1, 0}, {1, 0},
<a name="l02657"></a>02657    <span class="comment">// y = 0.5 (interior)</span>
<a name="l02658"></a>02658    {0, 1}, {0, 1}
<a name="l02659"></a>02659 };
<a name="l02660"></a>02660 
<a name="l02661"></a><a class="code" href="classRT1QuadFiniteElement.html#abe657e6b779aa805f3ddf9455b324013">02661</a> <span class="keywordtype">void</span> <a class="code" href="classRT1QuadFiniteElement.html#abe657e6b779aa805f3ddf9455b324013">RT1QuadFiniteElement::GetLocalInterpolation</a> (
<a name="l02662"></a>02662    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l02663"></a>02663 <span class="keyword"></span>{
<a name="l02664"></a>02664    <span class="keywordtype">int</span> k, j;
<a name="l02665"></a>02665 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02666"></a>02666 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02667"></a>02667    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02668"></a>02668 <span class="preprocessor">#endif</span>
<a name="l02669"></a>02669 <span class="preprocessor"></span>
<a name="l02670"></a>02670 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02671"></a>02671 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 12; k++)
<a name="l02672"></a>02672    {
<a name="l02673"></a>02673       <a class="code" href="classRT1QuadFiniteElement.html#af6547363dc091ae96d9fa074fdbcaae7">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l02674"></a>02674       <span class="keywordflow">for</span> (j = 0; j &lt; 12; j++)
<a name="l02675"></a>02675       {
<a name="l02676"></a>02676          <span class="keywordtype">double</span> d = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][1];
<a name="l02677"></a>02677          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l02678"></a>02678          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l02679"></a>02679          {
<a name="l02680"></a>02680             cerr &lt;&lt; <span class="stringliteral">&quot;RT1QuadFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l02681"></a>02681                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l02682"></a>02682             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l02683"></a>02683          }
<a name="l02684"></a>02684       }
<a name="l02685"></a>02685    }
<a name="l02686"></a>02686 <span class="preprocessor">#endif</span>
<a name="l02687"></a>02687 <span class="preprocessor"></span>
<a name="l02688"></a>02688    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l02689"></a>02689    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02690"></a>02690    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l02691"></a>02691    <span class="comment">// Trans must be linear (more to have embedding?)</span>
<a name="l02692"></a>02692    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02693"></a>02693    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02694"></a>02694    <span class="keywordtype">double</span> vk[2];
<a name="l02695"></a>02695    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02696"></a>02696 
<a name="l02697"></a>02697    <span class="keywordflow">for</span> (k = 0; k &lt; 12; k++)
<a name="l02698"></a>02698    {
<a name="l02699"></a>02699       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l02700"></a>02700       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1];
<a name="l02701"></a>02701       <a class="code" href="classRT1QuadFiniteElement.html#af6547363dc091ae96d9fa074fdbcaae7">CalcVShape</a> (ip, vshape);
<a name="l02702"></a>02702       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l02703"></a>02703       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][1];
<a name="l02704"></a>02704       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1];
<a name="l02705"></a>02705       <span class="keywordflow">for</span> (j = 0; j &lt; 12; j++)
<a name="l02706"></a>02706          <span class="keywordflow">if</span> (fabs (I(k,j) = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]) &lt; 1.0e-12)
<a name="l02707"></a>02707             I(k,j) = 0.0;
<a name="l02708"></a>02708    }
<a name="l02709"></a>02709 }
<a name="l02710"></a>02710 
<a name="l02711"></a><a class="code" href="classRT1QuadFiniteElement.html#ae78fe3896c8f47718e3090d3bbd59d55">02711</a> <span class="keywordtype">void</span> <a class="code" href="classRT1QuadFiniteElement.html#ae78fe3896c8f47718e3090d3bbd59d55">RT1QuadFiniteElement::Project</a> (
<a name="l02712"></a>02712    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l02713"></a>02713 <span class="keyword"></span>{
<a name="l02714"></a>02714    <span class="keywordtype">double</span> vk[2];
<a name="l02715"></a>02715    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l02716"></a>02716 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l02717"></a>02717 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l02718"></a>02718 <span class="preprocessor">#endif</span>
<a name="l02719"></a>02719 <span class="preprocessor"></span>
<a name="l02720"></a>02720    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 12; k++)
<a name="l02721"></a>02721    {
<a name="l02722"></a>02722       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02723"></a>02723       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l02724"></a>02724       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l02725"></a>02725 
<a name="l02726"></a>02726       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l02727"></a>02727       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l02728"></a>02728       dofs(k) = (vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][1] ) +
<a name="l02729"></a>02729                  vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT1QuadFiniteElement.html#afabd4265e0d89317ef5e1203e231d85a">nk</a>[k][1] ));
<a name="l02730"></a>02730    }
<a name="l02731"></a>02731 }
<a name="l02732"></a>02732 
<a name="l02733"></a>02733 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT2TriangleFiniteElement.html#a10739ba1468273ddae02dd4f5018031e">RT2TriangleFiniteElement::M</a>[15][15] =
<a name="l02734"></a>02734 {{ 0, -5.3237900077244501311, 5.3237900077244501311, 16.647580015448900262,
<a name="l02735"></a>02735    0, 24.442740046346700787, -16.647580015448900262, -12.,
<a name="l02736"></a>02736    -19.118950038622250656, -47.237900077244501311, 0, -34.414110069520051180,
<a name="l02737"></a>02737    12., 30.590320061795601049, 15.295160030897800524},
<a name="l02738"></a>02738  { 0, 1.5, -1.5, -15., 0, 2.625, 15., 15., -4.125, 30., 0, -14.625, -15.,
<a name="l02739"></a>02739    -15., 10.5},
<a name="l02740"></a>02740  { 0, -0.67620999227554986889, 0.67620999227554986889, 7.3524199845510997378,
<a name="l02741"></a>02741    0, -3.4427400463467007866, -7.3524199845510997378, -12.,
<a name="l02742"></a>02742    4.1189500386222506555, -0.76209992275549868892, 0, 7.4141100695200511800,
<a name="l02743"></a>02743    12., -6.5903200617956010489, -3.2951600308978005244},
<a name="l02744"></a>02744  { 0, 0, 1.5, 0, 0, 1.5, -11.471370023173350393, 0, 2.4713700231733503933,
<a name="l02745"></a>02745    -11.471370023173350393, 0, 2.4713700231733503933, 15.295160030897800524,
<a name="l02746"></a>02746    0, -3.2951600308978005244},
<a name="l02747"></a>02747  { 0, 0, 4.875, 0, 0, 4.875, -16.875, 0, -16.875, -16.875, 0, -16.875, 10.5,
<a name="l02748"></a>02748    36., 10.5},
<a name="l02749"></a>02749  { 0, 0, 1.5, 0, 0, 1.5, 2.4713700231733503933, 0, -11.471370023173350393,
<a name="l02750"></a>02750    2.4713700231733503933, 0, -11.471370023173350393, -3.2951600308978005244,
<a name="l02751"></a>02751    0, 15.295160030897800524},
<a name="l02752"></a>02752  { -0.67620999227554986889, 0, -3.4427400463467007866, 0,
<a name="l02753"></a>02753    7.3524199845510997378, 0.67620999227554986889, 7.4141100695200511800, 0,
<a name="l02754"></a>02754    -0.76209992275549868892, 4.1189500386222506555, -12.,
<a name="l02755"></a>02755    -7.3524199845510997378, -3.2951600308978005244, -6.5903200617956010489,
<a name="l02756"></a>02756    12.},
<a name="l02757"></a>02757  { 1.5, 0, 2.625, 0, -15., -1.5, -14.625, 0, 30., -4.125, 15., 15., 10.5,
<a name="l02758"></a>02758    -15., -15.},
<a name="l02759"></a>02759  { -5.3237900077244501311, 0, 24.442740046346700787, 0, 16.647580015448900262,
<a name="l02760"></a>02760    5.3237900077244501311, -34.414110069520051180, 0, -47.237900077244501311,
<a name="l02761"></a>02761    -19.118950038622250656, -12., -16.647580015448900262, 15.295160030897800524,
<a name="l02762"></a>02762    30.590320061795601049, 12.},
<a name="l02763"></a>02763  { 0, 0, 18., 0, 0, 6., -42., 0, -30., -26., 0, -14., 24., 32., 8.},
<a name="l02764"></a>02764  { 0, 0, 6., 0, 0, 18., -14., 0, -26., -30., 0, -42., 8., 32., 24.},
<a name="l02765"></a>02765  { 0, 0, -6., 0, 0, -4., 30., 0, 4., 22., 0, 4., -24., -16., 0},
<a name="l02766"></a>02766  { 0, 0, -4., 0, 0, -8., 20., 0, 8., 36., 0, 8., -16., -32., 0},
<a name="l02767"></a>02767  { 0, 0, -8., 0, 0, -4., 8., 0, 36., 8., 0, 20., 0, -32., -16.},
<a name="l02768"></a>02768  { 0, 0, -4., 0, 0, -6., 4., 0, 22., 4., 0, 30., 0, -16., -24.}
<a name="l02769"></a>02769 };
<a name="l02770"></a>02770 
<a name="l02771"></a><a class="code" href="classRT2TriangleFiniteElement.html#ab8900c2846932e43807c695d276cd10b">02771</a> <a class="code" href="classRT2TriangleFiniteElement.html#ab8900c2846932e43807c695d276cd10b">RT2TriangleFiniteElement::RT2TriangleFiniteElement</a>()
<a name="l02772"></a>02772    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 15, 3)
<a name="l02773"></a>02773 {
<a name="l02774"></a>02774    <span class="keyword">const</span> <span class="keywordtype">double</span> p = 0.11270166537925831148;
<a name="l02775"></a>02775 
<a name="l02776"></a>02776    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = p;
<a name="l02777"></a>02777    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02778"></a>02778    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02779"></a>02779    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02780"></a>02780    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.-p;
<a name="l02781"></a>02781    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l02782"></a>02782    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.-p;
<a name="l02783"></a>02783    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = p;
<a name="l02784"></a>02784    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02785"></a>02785    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02786"></a>02786    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = p;
<a name="l02787"></a>02787    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.-p;
<a name="l02788"></a>02788    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02789"></a>02789    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.-p;
<a name="l02790"></a>02790    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02791"></a>02791    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02792"></a>02792    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l02793"></a>02793    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = p;
<a name="l02794"></a>02794    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 0.25;
<a name="l02795"></a>02795    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.25;
<a name="l02796"></a>02796    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.25;
<a name="l02797"></a>02797    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.25;
<a name="l02798"></a>02798    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02799"></a>02799    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.25;
<a name="l02800"></a>02800    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l02801"></a>02801    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.25;
<a name="l02802"></a>02802    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.25;
<a name="l02803"></a>02803    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02804"></a>02804    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.25;
<a name="l02805"></a>02805    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l02806"></a>02806 }
<a name="l02807"></a>02807 
<a name="l02808"></a><a class="code" href="classRT2TriangleFiniteElement.html#ac0b6fdd65add171424cd7542afcd0f52">02808</a> <span class="keywordtype">void</span> <a class="code" href="classRT2TriangleFiniteElement.html#ac0b6fdd65add171424cd7542afcd0f52">RT2TriangleFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02809"></a>02809                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02810"></a>02810 <span class="keyword"></span>{
<a name="l02811"></a>02811    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02812"></a>02812 
<a name="l02813"></a>02813    <span class="keywordtype">double</span> Bx[15] = {1., 0., x, 0., y, 0., x*x, 0., x*y, 0., y*y, 0., x*x*x,
<a name="l02814"></a>02814                     x*x*y, x*y*y};
<a name="l02815"></a>02815    <span class="keywordtype">double</span> By[15] = {0., 1., 0., x, 0., y, 0., x*x, 0., x*y, 0., y*y,
<a name="l02816"></a>02816                     x*x*y, x*y*y, y*y*y};
<a name="l02817"></a>02817 
<a name="l02818"></a>02818    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 15; i++)
<a name="l02819"></a>02819    {
<a name="l02820"></a>02820       <span class="keywordtype">double</span> cx = 0.0, cy = 0.0;
<a name="l02821"></a>02821       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 15; j++)
<a name="l02822"></a>02822       {
<a name="l02823"></a>02823          cx += <a class="code" href="classRT2TriangleFiniteElement.html#a10739ba1468273ddae02dd4f5018031e">M</a>[i][j] * Bx[j];
<a name="l02824"></a>02824          cy += <a class="code" href="classRT2TriangleFiniteElement.html#a10739ba1468273ddae02dd4f5018031e">M</a>[i][j] * By[j];
<a name="l02825"></a>02825       }
<a name="l02826"></a>02826       shape(i,0) = cx;
<a name="l02827"></a>02827       shape(i,1) = cy;
<a name="l02828"></a>02828    }
<a name="l02829"></a>02829 }
<a name="l02830"></a>02830 
<a name="l02831"></a><a class="code" href="classRT2TriangleFiniteElement.html#a631a43501923fc47f27efdbcd7ebeb23">02831</a> <span class="keywordtype">void</span> <a class="code" href="classRT2TriangleFiniteElement.html#a631a43501923fc47f27efdbcd7ebeb23">RT2TriangleFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02832"></a>02832                                             <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l02833"></a>02833 <span class="keyword"></span>{
<a name="l02834"></a>02834    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02835"></a>02835 
<a name="l02836"></a>02836    <span class="keywordtype">double</span> DivB[15] = {0., 0., 1., 0., 0., 1., 2.*x, 0., y, x, 0., 2.*y,
<a name="l02837"></a>02837                       4.*x*x, 4.*x*y, 4.*y*y};
<a name="l02838"></a>02838 
<a name="l02839"></a>02839    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 15; i++)
<a name="l02840"></a>02840    {
<a name="l02841"></a>02841       <span class="keywordtype">double</span> div = 0.0;
<a name="l02842"></a>02842       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 15; j++)
<a name="l02843"></a>02843          div += <a class="code" href="classRT2TriangleFiniteElement.html#a10739ba1468273ddae02dd4f5018031e">M</a>[i][j] * DivB[j];
<a name="l02844"></a>02844       divshape(i) = div;
<a name="l02845"></a>02845    }
<a name="l02846"></a>02846 }
<a name="l02847"></a>02847 
<a name="l02848"></a>02848 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">RT2QuadFiniteElement::pt</a>[4] = {0.,1./3.,2./3.,1.};
<a name="l02849"></a>02849 
<a name="l02850"></a>02850 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">RT2QuadFiniteElement::dpt</a>[3] = {0.25,0.5,0.75};
<a name="l02851"></a>02851 
<a name="l02852"></a><a class="code" href="classRT2QuadFiniteElement.html#a169756ae54e1293b05c2de405dda0515">02852</a> <a class="code" href="classRT2QuadFiniteElement.html#a169756ae54e1293b05c2de405dda0515">RT2QuadFiniteElement::RT2QuadFiniteElement</a>()
<a name="l02853"></a>02853    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 24, 3, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l02854"></a>02854 {
<a name="l02855"></a>02855    <span class="comment">// y = 0 (pt[0])</span>
<a name="l02856"></a>02856    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0];
<a name="l02857"></a>02857    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0];
<a name="l02858"></a>02858    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0];
<a name="l02859"></a>02859    <span class="comment">// x = 1 (pt[3])</span>
<a name="l02860"></a>02860    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];
<a name="l02861"></a>02861    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];
<a name="l02862"></a>02862    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];
<a name="l02863"></a>02863    <span class="comment">// y = 1 (pt[3])</span>
<a name="l02864"></a>02864    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3];
<a name="l02865"></a>02865    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3];
<a name="l02866"></a>02866    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3];
<a name="l02867"></a>02867    <span class="comment">// x = 0 (pt[0])</span>
<a name="l02868"></a>02868    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];
<a name="l02869"></a>02869    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];
<a name="l02870"></a>02870    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];
<a name="l02871"></a>02871    <span class="comment">// x = pt[1] (interior)</span>
<a name="l02872"></a>02872    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];
<a name="l02873"></a>02873    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];
<a name="l02874"></a>02874    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];
<a name="l02875"></a>02875    <span class="comment">// x = pt[2] (interior)</span>
<a name="l02876"></a>02876    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];
<a name="l02877"></a>02877    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];
<a name="l02878"></a>02878    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];
<a name="l02879"></a>02879    <span class="comment">// y = pt[1] (interior)</span>
<a name="l02880"></a>02880    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];
<a name="l02881"></a>02881    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];
<a name="l02882"></a>02882    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(20).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(20).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];
<a name="l02883"></a>02883    <span class="comment">// y = pt[2] (interior)</span>
<a name="l02884"></a>02884    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(21).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(21).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2];
<a name="l02885"></a>02885    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(22).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(22).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2];
<a name="l02886"></a>02886    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(23).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2];  <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(23).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2];
<a name="l02887"></a>02887 }
<a name="l02888"></a>02888 
<a name="l02889"></a><a class="code" href="classRT2QuadFiniteElement.html#ab192704621949cf9793a0a2eb4ecfe60">02889</a> <span class="keywordtype">void</span> <a class="code" href="classRT2QuadFiniteElement.html#ab192704621949cf9793a0a2eb4ecfe60">RT2QuadFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02890"></a>02890                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l02891"></a>02891 <span class="keyword"></span>{
<a name="l02892"></a>02892    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02893"></a>02893 
<a name="l02894"></a>02894    <span class="keywordtype">double</span> ax0 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0] - x;
<a name="l02895"></a>02895    <span class="keywordtype">double</span> ax1 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1] - x;
<a name="l02896"></a>02896    <span class="keywordtype">double</span> ax2 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2] - x;
<a name="l02897"></a>02897    <span class="keywordtype">double</span> ax3 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3] - x;
<a name="l02898"></a>02898 
<a name="l02899"></a>02899    <span class="keywordtype">double</span> by0 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0] - y;
<a name="l02900"></a>02900    <span class="keywordtype">double</span> by1 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1] - y;
<a name="l02901"></a>02901    <span class="keywordtype">double</span> by2 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2] - y;
<a name="l02902"></a>02902 
<a name="l02903"></a>02903    <span class="keywordtype">double</span> ay0 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0] - y;
<a name="l02904"></a>02904    <span class="keywordtype">double</span> ay1 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1] - y;
<a name="l02905"></a>02905    <span class="keywordtype">double</span> ay2 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[2] - y;
<a name="l02906"></a>02906    <span class="keywordtype">double</span> ay3 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[3] - y;
<a name="l02907"></a>02907 
<a name="l02908"></a>02908    <span class="keywordtype">double</span> bx0 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0] - x;
<a name="l02909"></a>02909    <span class="keywordtype">double</span> bx1 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1] - x;
<a name="l02910"></a>02910    <span class="keywordtype">double</span> bx2 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2] - x;
<a name="l02911"></a>02911 
<a name="l02912"></a>02912    <span class="keywordtype">double</span> A01 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0] -  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];
<a name="l02913"></a>02913    <span class="keywordtype">double</span> A02 =  pt[0] -  pt[2];
<a name="l02914"></a>02914    <span class="keywordtype">double</span> A12 =  pt[1] -  pt[2];
<a name="l02915"></a>02915    <span class="keywordtype">double</span> A03 =  pt[0] -  pt[3];
<a name="l02916"></a>02916    <span class="keywordtype">double</span> A13 =  pt[1] -  pt[3];
<a name="l02917"></a>02917    <span class="keywordtype">double</span> A23 =  pt[2] -  pt[3];
<a name="l02918"></a>02918 
<a name="l02919"></a>02919    <span class="keywordtype">double</span> B01 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0] - <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];
<a name="l02920"></a>02920    <span class="keywordtype">double</span> B02 = dpt[0] - dpt[2];
<a name="l02921"></a>02921    <span class="keywordtype">double</span> B12 = dpt[1] - dpt[2];
<a name="l02922"></a>02922 
<a name="l02923"></a>02923    <span class="keywordtype">double</span> tx0 =  (bx1*bx2)/(B01*B02);
<a name="l02924"></a>02924    <span class="keywordtype">double</span> tx1 = -(bx0*bx2)/(B01*B12);
<a name="l02925"></a>02925    <span class="keywordtype">double</span> tx2 =  (bx0*bx1)/(B02*B12);
<a name="l02926"></a>02926 
<a name="l02927"></a>02927    <span class="keywordtype">double</span> ty0 =  (by1*by2)/(B01*B02);
<a name="l02928"></a>02928    <span class="keywordtype">double</span> ty1 = -(by0*by2)/(B01*B12);
<a name="l02929"></a>02929    <span class="keywordtype">double</span> ty2 =  (by0*by1)/(B02*B12);
<a name="l02930"></a>02930 
<a name="l02931"></a>02931    <span class="comment">// y = 0 (p[0])</span>
<a name="l02932"></a>02932    shape(0,  0) =  0;
<a name="l02933"></a>02933    shape(0,  1) =  (ay1*ay2*ay3)/(A01*A02*A03)*tx0;
<a name="l02934"></a>02934    shape(1,  0) =  0;
<a name="l02935"></a>02935    shape(1,  1) =  (ay1*ay2*ay3)/(A01*A02*A03)*tx1;
<a name="l02936"></a>02936    shape(2,  0) =  0;
<a name="l02937"></a>02937    shape(2,  1) =  (ay1*ay2*ay3)/(A01*A02*A03)*tx2;
<a name="l02938"></a>02938    <span class="comment">// x = 1 (p[3])</span>
<a name="l02939"></a>02939    shape(3,  0) =  (ax0*ax1*ax2)/(A03*A13*A23)*ty0;
<a name="l02940"></a>02940    shape(3,  1) =  0;
<a name="l02941"></a>02941    shape(4,  0) =  (ax0*ax1*ax2)/(A03*A13*A23)*ty1;
<a name="l02942"></a>02942    shape(4,  1) =  0;
<a name="l02943"></a>02943    shape(5,  0) =  (ax0*ax1*ax2)/(A03*A13*A23)*ty2;
<a name="l02944"></a>02944    shape(5,  1) =  0;
<a name="l02945"></a>02945    <span class="comment">// y = 1 (p[3])</span>
<a name="l02946"></a>02946    shape(6,  0) =  0;
<a name="l02947"></a>02947    shape(6,  1) =  (ay0*ay1*ay2)/(A03*A13*A23)*tx2;
<a name="l02948"></a>02948    shape(7,  0) =  0;
<a name="l02949"></a>02949    shape(7,  1) =  (ay0*ay1*ay2)/(A03*A13*A23)*tx1;
<a name="l02950"></a>02950    shape(8,  0) =  0;
<a name="l02951"></a>02951    shape(8,  1) =  (ay0*ay1*ay2)/(A03*A13*A23)*tx0;
<a name="l02952"></a>02952    <span class="comment">// x = 0 (p[0])</span>
<a name="l02953"></a>02953    shape(9,  0) =  (ax1*ax2*ax3)/(A01*A02*A03)*ty2;
<a name="l02954"></a>02954    shape(9,  1) =  0;
<a name="l02955"></a>02955    shape(10, 0) =  (ax1*ax2*ax3)/(A01*A02*A03)*ty1;
<a name="l02956"></a>02956    shape(10, 1) =  0;
<a name="l02957"></a>02957    shape(11, 0) =  (ax1*ax2*ax3)/(A01*A02*A03)*ty0;
<a name="l02958"></a>02958    shape(11, 1) =  0;
<a name="l02959"></a>02959    <span class="comment">// x = p[1] (interior)</span>
<a name="l02960"></a>02960    shape(12, 0) =  (ax0*ax2*ax3)/(A01*A12*A13)*ty0;
<a name="l02961"></a>02961    shape(12, 1) =  0;
<a name="l02962"></a>02962    shape(13, 0) =  (ax0*ax2*ax3)/(A01*A12*A13)*ty1;
<a name="l02963"></a>02963    shape(13, 1) =  0;
<a name="l02964"></a>02964    shape(14, 0) =  (ax0*ax2*ax3)/(A01*A12*A13)*ty2;
<a name="l02965"></a>02965    shape(14, 1) =  0;
<a name="l02966"></a>02966    <span class="comment">// x = p[2] (interior)</span>
<a name="l02967"></a>02967    shape(15, 0) = -(ax0*ax1*ax3)/(A02*A12*A23)*ty0;
<a name="l02968"></a>02968    shape(15, 1) =  0;
<a name="l02969"></a>02969    shape(16, 0) = -(ax0*ax1*ax3)/(A02*A12*A23)*ty1;
<a name="l02970"></a>02970    shape(16, 1) =  0;
<a name="l02971"></a>02971    shape(17, 0) = -(ax0*ax1*ax3)/(A02*A12*A23)*ty2;
<a name="l02972"></a>02972    shape(17, 1) =  0;
<a name="l02973"></a>02973    <span class="comment">// y = p[1] (interior)</span>
<a name="l02974"></a>02974    shape(18, 0) =  0;
<a name="l02975"></a>02975    shape(18, 1) =  (ay0*ay2*ay3)/(A01*A12*A13)*tx0;
<a name="l02976"></a>02976    shape(19, 0) =  0;
<a name="l02977"></a>02977    shape(19, 1) =  (ay0*ay2*ay3)/(A01*A12*A13)*tx1;
<a name="l02978"></a>02978    shape(20, 0) =  0;
<a name="l02979"></a>02979    shape(20, 1) =  (ay0*ay2*ay3)/(A01*A12*A13)*tx2;
<a name="l02980"></a>02980    <span class="comment">// y = p[2] (interior)</span>
<a name="l02981"></a>02981    shape(21, 0) =  0;
<a name="l02982"></a>02982    shape(21, 1) = -(ay0*ay1*ay3)/(A02*A12*A23)*tx0;
<a name="l02983"></a>02983    shape(22, 0) =  0;
<a name="l02984"></a>02984    shape(22, 1) = -(ay0*ay1*ay3)/(A02*A12*A23)*tx1;
<a name="l02985"></a>02985    shape(23, 0) =  0;
<a name="l02986"></a>02986    shape(23, 1) = -(ay0*ay1*ay3)/(A02*A12*A23)*tx2;
<a name="l02987"></a>02987 }
<a name="l02988"></a>02988 
<a name="l02989"></a><a class="code" href="classRT2QuadFiniteElement.html#a8cfc990a63fed5941c3e73122ee2c59a">02989</a> <span class="keywordtype">void</span> <a class="code" href="classRT2QuadFiniteElement.html#a8cfc990a63fed5941c3e73122ee2c59a">RT2QuadFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l02990"></a>02990                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l02991"></a>02991 <span class="keyword"></span>{
<a name="l02992"></a>02992    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l02993"></a>02993 
<a name="l02994"></a>02994    <span class="keywordtype">double</span> a01 =  <a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[0]*<a class="code" href="classRT2QuadFiniteElement.html#a1698e0aacac89025a41ca7e498f71a80">pt</a>[1];
<a name="l02995"></a>02995    <span class="keywordtype">double</span> a02 =  pt[0]*pt[2];
<a name="l02996"></a>02996    <span class="keywordtype">double</span> a12 =  pt[1]*pt[2];
<a name="l02997"></a>02997    <span class="keywordtype">double</span> a03 =  pt[0]*pt[3];
<a name="l02998"></a>02998    <span class="keywordtype">double</span> a13 =  pt[1]*pt[3];
<a name="l02999"></a>02999    <span class="keywordtype">double</span> a23 =  pt[2]*pt[3];
<a name="l03000"></a>03000 
<a name="l03001"></a>03001    <span class="keywordtype">double</span> bx0 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0] - x;
<a name="l03002"></a>03002    <span class="keywordtype">double</span> bx1 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1] - x;
<a name="l03003"></a>03003    <span class="keywordtype">double</span> bx2 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2] - x;
<a name="l03004"></a>03004 
<a name="l03005"></a>03005    <span class="keywordtype">double</span> by0 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0] - y;
<a name="l03006"></a>03006    <span class="keywordtype">double</span> by1 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1] - y;
<a name="l03007"></a>03007    <span class="keywordtype">double</span> by2 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[2] - y;
<a name="l03008"></a>03008 
<a name="l03009"></a>03009    <span class="keywordtype">double</span> A01 =  pt[0] -  pt[1];
<a name="l03010"></a>03010    <span class="keywordtype">double</span> A02 =  pt[0] -  pt[2];
<a name="l03011"></a>03011    <span class="keywordtype">double</span> A12 =  pt[1] -  pt[2];
<a name="l03012"></a>03012    <span class="keywordtype">double</span> A03 =  pt[0] -  pt[3];
<a name="l03013"></a>03013    <span class="keywordtype">double</span> A13 =  pt[1] -  pt[3];
<a name="l03014"></a>03014    <span class="keywordtype">double</span> A23 =  pt[2] -  pt[3];
<a name="l03015"></a>03015 
<a name="l03016"></a>03016    <span class="keywordtype">double</span> A012 = pt[0] + pt[1] + pt[2];
<a name="l03017"></a>03017    <span class="keywordtype">double</span> A013 = pt[0] + pt[1] + pt[3];
<a name="l03018"></a>03018    <span class="keywordtype">double</span> A023 = pt[0] + pt[2] + pt[3];
<a name="l03019"></a>03019    <span class="keywordtype">double</span> A123 = pt[1] + pt[2] + pt[3];
<a name="l03020"></a>03020 
<a name="l03021"></a>03021    <span class="keywordtype">double</span> B01 = <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[0] - <a class="code" href="classRT2QuadFiniteElement.html#a524359d624616b3282c8c74dd9e8a665">dpt</a>[1];
<a name="l03022"></a>03022    <span class="keywordtype">double</span> B02 = dpt[0] - dpt[2];
<a name="l03023"></a>03023    <span class="keywordtype">double</span> B12 = dpt[1] - dpt[2];
<a name="l03024"></a>03024 
<a name="l03025"></a>03025    <span class="keywordtype">double</span> tx0 =  (bx1*bx2)/(B01*B02);
<a name="l03026"></a>03026    <span class="keywordtype">double</span> tx1 = -(bx0*bx2)/(B01*B12);
<a name="l03027"></a>03027    <span class="keywordtype">double</span> tx2 =  (bx0*bx1)/(B02*B12);
<a name="l03028"></a>03028 
<a name="l03029"></a>03029    <span class="keywordtype">double</span> ty0 =  (by1*by2)/(B01*B02);
<a name="l03030"></a>03030    <span class="keywordtype">double</span> ty1 = -(by0*by2)/(B01*B12);
<a name="l03031"></a>03031    <span class="keywordtype">double</span> ty2 =  (by0*by1)/(B02*B12);
<a name="l03032"></a>03032 
<a name="l03033"></a>03033    <span class="comment">// y = 0 (p[0])</span>
<a name="l03034"></a>03034    divshape(0)  = -(a12 + a13 + a23 - 2.*A123*y + 3.*y*y)/(A01*A02*A03)*tx0;
<a name="l03035"></a>03035    divshape(1)  = -(a12 + a13 + a23 - 2.*A123*y + 3.*y*y)/(A01*A02*A03)*tx1;
<a name="l03036"></a>03036    divshape(2)  = -(a12 + a13 + a23 - 2.*A123*y + 3.*y*y)/(A01*A02*A03)*tx2;
<a name="l03037"></a>03037    <span class="comment">// x = 1 (p[3])</span>
<a name="l03038"></a>03038    divshape(3)  = -(a01 + a02 + a12 - 2.*A012*x + 3.*x*x)/(A03*A13*A23)*ty0;
<a name="l03039"></a>03039    divshape(4)  = -(a01 + a02 + a12 - 2.*A012*x + 3.*x*x)/(A03*A13*A23)*ty1;
<a name="l03040"></a>03040    divshape(5)  = -(a01 + a02 + a12 - 2.*A012*x + 3.*x*x)/(A03*A13*A23)*ty2;
<a name="l03041"></a>03041    <span class="comment">// y = 1 (p[3])</span>
<a name="l03042"></a>03042    divshape(6)  = -(a01 + a02 + a12 - 2.*A012*y + 3.*y*y)/(A03*A13*A23)*tx2;
<a name="l03043"></a>03043    divshape(7)  = -(a01 + a02 + a12 - 2.*A012*y + 3.*y*y)/(A03*A13*A23)*tx1;
<a name="l03044"></a>03044    divshape(8)  = -(a01 + a02 + a12 - 2.*A012*y + 3.*y*y)/(A03*A13*A23)*tx0;
<a name="l03045"></a>03045    <span class="comment">// x = 0 (p[0])</span>
<a name="l03046"></a>03046    divshape(9)  = -(a12 + a13 + a23 - 2.*A123*x + 3.*x*x)/(A01*A02*A03)*ty2;
<a name="l03047"></a>03047    divshape(10) = -(a12 + a13 + a23 - 2.*A123*x + 3.*x*x)/(A01*A02*A03)*ty1;
<a name="l03048"></a>03048    divshape(11) = -(a12 + a13 + a23 - 2.*A123*x + 3.*x*x)/(A01*A02*A03)*ty0;
<a name="l03049"></a>03049    <span class="comment">// x = p[1] (interior)</span>
<a name="l03050"></a>03050    divshape(12) = -(a02 + a03 + a23 - 2.*A023*x + 3.*x*x)/(A01*A12*A13)*ty0;
<a name="l03051"></a>03051    divshape(13) = -(a02 + a03 + a23 - 2.*A023*x + 3.*x*x)/(A01*A12*A13)*ty1;
<a name="l03052"></a>03052    divshape(14) = -(a02 + a03 + a23 - 2.*A023*x + 3.*x*x)/(A01*A12*A13)*ty2;
<a name="l03053"></a>03053    <span class="comment">// x = p[2] (interior)</span>
<a name="l03054"></a>03054    divshape(15) =  (a01 + a03 + a13 - 2.*A013*x + 3.*x*x)/(A02*A12*A23)*ty0;
<a name="l03055"></a>03055    divshape(16) =  (a01 + a03 + a13 - 2.*A013*x + 3.*x*x)/(A02*A12*A23)*ty1;
<a name="l03056"></a>03056    divshape(17) =  (a01 + a03 + a13 - 2.*A013*x + 3.*x*x)/(A02*A12*A23)*ty2;
<a name="l03057"></a>03057    <span class="comment">// y = p[1] (interior)</span>
<a name="l03058"></a>03058    divshape(18) = -(a02 + a03 + a23 - 2.*A023*y + 3.*y*y)/(A01*A12*A13)*tx0;
<a name="l03059"></a>03059    divshape(19) = -(a02 + a03 + a23 - 2.*A023*y + 3.*y*y)/(A01*A12*A13)*tx1;
<a name="l03060"></a>03060    divshape(20) = -(a02 + a03 + a23 - 2.*A023*y + 3.*y*y)/(A01*A12*A13)*tx2;
<a name="l03061"></a>03061    <span class="comment">// y = p[2] (interior)</span>
<a name="l03062"></a>03062    divshape(21) =  (a01 + a03 + a13 - 2.*A013*y + 3.*y*y)/(A02*A12*A23)*tx0;
<a name="l03063"></a>03063    divshape(22) =  (a01 + a03 + a13 - 2.*A013*y + 3.*y*y)/(A02*A12*A23)*tx1;
<a name="l03064"></a>03064    divshape(23) =  (a01 + a03 + a13 - 2.*A013*y + 3.*y*y)/(A02*A12*A23)*tx2;
<a name="l03065"></a>03065 }
<a name="l03066"></a>03066 
<a name="l03067"></a>03067 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">RT2QuadFiniteElement::nk</a>[24][2] =
<a name="l03068"></a>03068 {
<a name="l03069"></a>03069    <span class="comment">// y = 0</span>
<a name="l03070"></a>03070    {0,-1}, {0,-1}, {0,-1},
<a name="l03071"></a>03071    <span class="comment">// x = 1</span>
<a name="l03072"></a>03072    {1, 0}, {1, 0}, {1, 0},
<a name="l03073"></a>03073    <span class="comment">// y = 1</span>
<a name="l03074"></a>03074    {0, 1}, {0, 1}, {0, 1},
<a name="l03075"></a>03075    <span class="comment">// x = 0</span>
<a name="l03076"></a>03076    {-1,0}, {-1,0}, {-1,0},
<a name="l03077"></a>03077    <span class="comment">// x = p[1] (interior)</span>
<a name="l03078"></a>03078    {1, 0}, {1, 0}, {1, 0},
<a name="l03079"></a>03079    <span class="comment">// x = p[2] (interior)</span>
<a name="l03080"></a>03080    {1, 0}, {1, 0}, {1, 0},
<a name="l03081"></a>03081    <span class="comment">// y = p[1] (interior)</span>
<a name="l03082"></a>03082    {0, 1}, {0, 1}, {0, 1},
<a name="l03083"></a>03083    <span class="comment">// y = p[1] (interior)</span>
<a name="l03084"></a>03084    {0, 1}, {0, 1}, {0, 1}
<a name="l03085"></a>03085 };
<a name="l03086"></a>03086 
<a name="l03087"></a><a class="code" href="classRT2QuadFiniteElement.html#a513bf9724f7a8bb9b64801c8d21f5ee3">03087</a> <span class="keywordtype">void</span> <a class="code" href="classRT2QuadFiniteElement.html#a513bf9724f7a8bb9b64801c8d21f5ee3">RT2QuadFiniteElement::GetLocalInterpolation</a> (
<a name="l03088"></a>03088    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l03089"></a>03089 <span class="keyword"></span>{
<a name="l03090"></a>03090    <span class="keywordtype">int</span> k, j;
<a name="l03091"></a>03091 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l03092"></a>03092 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l03093"></a>03093    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l03094"></a>03094 <span class="preprocessor">#endif</span>
<a name="l03095"></a>03095 <span class="preprocessor"></span>
<a name="l03096"></a>03096 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l03097"></a>03097 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 24; k++)
<a name="l03098"></a>03098    {
<a name="l03099"></a>03099       <a class="code" href="classRT2QuadFiniteElement.html#ab192704621949cf9793a0a2eb4ecfe60">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l03100"></a>03100       <span class="keywordflow">for</span> (j = 0; j &lt; 24; j++)
<a name="l03101"></a>03101       {
<a name="l03102"></a>03102          <span class="keywordtype">double</span> d = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][1];
<a name="l03103"></a>03103          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l03104"></a>03104          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l03105"></a>03105          {
<a name="l03106"></a>03106             cerr &lt;&lt; <span class="stringliteral">&quot;RT2QuadFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l03107"></a>03107                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l03108"></a>03108             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l03109"></a>03109          }
<a name="l03110"></a>03110       }
<a name="l03111"></a>03111    }
<a name="l03112"></a>03112 <span class="preprocessor">#endif</span>
<a name="l03113"></a>03113 <span class="preprocessor"></span>
<a name="l03114"></a>03114    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l03115"></a>03115    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03116"></a>03116    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l03117"></a>03117    <span class="comment">// Trans must be linear (more to have embedding?)</span>
<a name="l03118"></a>03118    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l03119"></a>03119    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l03120"></a>03120    <span class="keywordtype">double</span> vk[2];
<a name="l03121"></a>03121    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l03122"></a>03122 
<a name="l03123"></a>03123    <span class="keywordflow">for</span> (k = 0; k &lt; 24; k++)
<a name="l03124"></a>03124    {
<a name="l03125"></a>03125       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l03126"></a>03126       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1];
<a name="l03127"></a>03127       <a class="code" href="classRT2QuadFiniteElement.html#ab192704621949cf9793a0a2eb4ecfe60">CalcVShape</a> (ip, vshape);
<a name="l03128"></a>03128       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l03129"></a>03129       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][1];
<a name="l03130"></a>03130       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1];
<a name="l03131"></a>03131       <span class="keywordflow">for</span> (j = 0; j &lt; 24; j++)
<a name="l03132"></a>03132          <span class="keywordflow">if</span> (fabs (I(k,j) = <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]) &lt; 1.0e-12)
<a name="l03133"></a>03133             I(k,j) = 0.0;
<a name="l03134"></a>03134    }
<a name="l03135"></a>03135 }
<a name="l03136"></a>03136 
<a name="l03137"></a><a class="code" href="classRT2QuadFiniteElement.html#ae8dacd3b753204859862c53b5b47067c">03137</a> <span class="keywordtype">void</span> <a class="code" href="classRT2QuadFiniteElement.html#ae8dacd3b753204859862c53b5b47067c">RT2QuadFiniteElement::Project</a> (
<a name="l03138"></a>03138    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l03139"></a>03139 <span class="keyword"></span>{
<a name="l03140"></a>03140    <span class="keywordtype">double</span> vk[2];
<a name="l03141"></a>03141    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 2);
<a name="l03142"></a>03142 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l03143"></a>03143 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l03144"></a>03144 <span class="preprocessor">#endif</span>
<a name="l03145"></a>03145 <span class="preprocessor"></span>
<a name="l03146"></a>03146    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 24; k++)
<a name="l03147"></a>03147    {
<a name="l03148"></a>03148       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l03149"></a>03149       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l03150"></a>03150       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l03151"></a>03151 
<a name="l03152"></a>03152       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l03153"></a>03153       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l03154"></a>03154       dofs(k) = (vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][1] ) +
<a name="l03155"></a>03155                  vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT2QuadFiniteElement.html#ac4bd40e01131123f18514d4fd350ef8f">nk</a>[k][1] ));
<a name="l03156"></a>03156    }
<a name="l03157"></a>03157 }
<a name="l03158"></a>03158 
<a name="l03159"></a><a class="code" href="classP1SegmentFiniteElement.html#a3e84430d079dc54411efd933ea1bd1c9">03159</a> <a class="code" href="classP1SegmentFiniteElement.html#a3e84430d079dc54411efd933ea1bd1c9">P1SegmentFiniteElement::P1SegmentFiniteElement</a>()
<a name="l03160"></a>03160    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 2, 1)
<a name="l03161"></a>03161 {
<a name="l03162"></a>03162    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l03163"></a>03163    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.66666666666666666667;
<a name="l03164"></a>03164 }
<a name="l03165"></a>03165 
<a name="l03166"></a><a class="code" href="classP1SegmentFiniteElement.html#abdad8c0411565143cd227f1366ba6b5a">03166</a> <span class="keywordtype">void</span> <a class="code" href="classP1SegmentFiniteElement.html#abdad8c0411565143cd227f1366ba6b5a">P1SegmentFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03167"></a>03167                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03168"></a>03168 <span class="keyword"></span>{
<a name="l03169"></a>03169    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03170"></a>03170 
<a name="l03171"></a>03171    shape(0) = 2. - 3. * x;
<a name="l03172"></a>03172    shape(1) = 3. * x - 1.;
<a name="l03173"></a>03173 }
<a name="l03174"></a>03174 
<a name="l03175"></a><a class="code" href="classP1SegmentFiniteElement.html#a16fe79c790fd8e6b33206b426c4da991">03175</a> <span class="keywordtype">void</span> <a class="code" href="classP1SegmentFiniteElement.html#a16fe79c790fd8e6b33206b426c4da991">P1SegmentFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03176"></a>03176                                         <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03177"></a>03177 <span class="keyword"></span>{
<a name="l03178"></a>03178    dshape(0,0) = -3.;
<a name="l03179"></a>03179    dshape(1,0) =  3.;
<a name="l03180"></a>03180 }
<a name="l03181"></a>03181 
<a name="l03182"></a>03182 
<a name="l03183"></a><a class="code" href="classP2SegmentFiniteElement.html#a19b0d7dc6a03057a84cb6efe2934f4a5">03183</a> <a class="code" href="classP2SegmentFiniteElement.html#a19b0d7dc6a03057a84cb6efe2934f4a5">P2SegmentFiniteElement::P2SegmentFiniteElement</a>()
<a name="l03184"></a>03184    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 3, 2)
<a name="l03185"></a>03185 {
<a name="l03186"></a>03186    <span class="keyword">const</span> <span class="keywordtype">double</span> p = 0.11270166537925831148;
<a name="l03187"></a>03187 
<a name="l03188"></a>03188    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = p;
<a name="l03189"></a>03189    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03190"></a>03190    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.-p;
<a name="l03191"></a>03191 }
<a name="l03192"></a>03192 
<a name="l03193"></a><a class="code" href="classP2SegmentFiniteElement.html#a401eca1e9b81acb45524138e87be4799">03193</a> <span class="keywordtype">void</span> <a class="code" href="classP2SegmentFiniteElement.html#a401eca1e9b81acb45524138e87be4799">P2SegmentFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03194"></a>03194                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03195"></a>03195 <span class="keyword"></span>{
<a name="l03196"></a>03196    <span class="keyword">const</span> <span class="keywordtype">double</span> p = 0.11270166537925831148;
<a name="l03197"></a>03197    <span class="keyword">const</span> <span class="keywordtype">double</span> w = 1./((1-2*p)*(1-2*p));
<a name="l03198"></a>03198    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03199"></a>03199 
<a name="l03200"></a>03200    shape(0) = (2*x-1)*(x-1+p)*w;
<a name="l03201"></a>03201    shape(1) = 4*(x-1+p)*(p-x)*w;
<a name="l03202"></a>03202    shape(2) = (2*x-1)*(x-p)*w;
<a name="l03203"></a>03203 }
<a name="l03204"></a>03204 
<a name="l03205"></a><a class="code" href="classP2SegmentFiniteElement.html#aeaa25e99662afdcc05a54295a72c39c6">03205</a> <span class="keywordtype">void</span> <a class="code" href="classP2SegmentFiniteElement.html#aeaa25e99662afdcc05a54295a72c39c6">P2SegmentFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03206"></a>03206                                         <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03207"></a>03207 <span class="keyword"></span>{
<a name="l03208"></a>03208    <span class="keyword">const</span> <span class="keywordtype">double</span> p = 0.11270166537925831148;
<a name="l03209"></a>03209    <span class="keyword">const</span> <span class="keywordtype">double</span> w = 1./((1-2*p)*(1-2*p));
<a name="l03210"></a>03210    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03211"></a>03211 
<a name="l03212"></a>03212    dshape(0,0) = (-3+4*x+2*p)*w;
<a name="l03213"></a>03213    dshape(1,0) = (4-8*x)*w;
<a name="l03214"></a>03214    dshape(2,0) = (-1+4*x-2*p)*w;
<a name="l03215"></a>03215 }
<a name="l03216"></a>03216 
<a name="l03217"></a>03217 
<a name="l03218"></a><a class="code" href="classLagrange1DFiniteElement.html#a11af1583adea52b7bbb48542b8fb331f">03218</a> <a class="code" href="classLagrange1DFiniteElement.html#a11af1583adea52b7bbb48542b8fb331f">Lagrange1DFiniteElement::Lagrange1DFiniteElement</a>(<span class="keywordtype">int</span> degree)
<a name="l03219"></a>03219    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, degree+1, degree)
<a name="l03220"></a>03220 {
<a name="l03221"></a>03221    <span class="keywordtype">int</span> i, m = degree;
<a name="l03222"></a>03222 
<a name="l03223"></a>03223    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03224"></a>03224    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03225"></a>03225    <span class="keywordflow">for</span> (i = 1; i &lt; m; i++)
<a name="l03226"></a>03226       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i+1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = double(i) / m;
<a name="l03227"></a>03227 
<a name="l03228"></a>03228    <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(degree+1);
<a name="l03229"></a>03229 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l03230"></a>03230 <span class="preprocessor"></span>   <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(degree+1);
<a name="l03231"></a>03231 <span class="preprocessor">#endif</span>
<a name="l03232"></a>03232 <span class="preprocessor"></span>
<a name="l03233"></a>03233    <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(0) = 1.0;
<a name="l03234"></a>03234    <span class="keywordflow">for</span> (i = 1; i &lt;= m; i++)
<a name="l03235"></a>03235       <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i) = <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i-1) * ( (double)(m) / (double)(i) );
<a name="l03236"></a>03236    <span class="keywordflow">for</span> (i = 0; i &lt; m/2+1; i++)
<a name="l03237"></a>03237       <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(m-i) = ( <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i) *= <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(m-i) );
<a name="l03238"></a>03238    <span class="keywordflow">for</span> (i = m-1; i &gt;= 0; i -= 2)
<a name="l03239"></a>03239       <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i) = -<a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i);
<a name="l03240"></a>03240 }
<a name="l03241"></a>03241 
<a name="l03242"></a><a class="code" href="classLagrange1DFiniteElement.html#a977d0d454f1ce63812edc1ad6bd02ae5">03242</a> <span class="keywordtype">void</span> <a class="code" href="classLagrange1DFiniteElement.html#a977d0d454f1ce63812edc1ad6bd02ae5">Lagrange1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03243"></a>03243                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03244"></a>03244 <span class="keyword"></span>{
<a name="l03245"></a>03245    <span class="keywordtype">double</span> w, wk, x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03246"></a>03246    <span class="keywordtype">int</span> i, k, m = <a class="code" href="classFiniteElement.html#ac80061bcdb8a15aff6e3d437ec0b782d" title="Returns the order of the finite element.">GetOrder</a>();
<a name="l03247"></a>03247 
<a name="l03248"></a>03248 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l03249"></a>03249 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(m+1);
<a name="l03250"></a>03250 <span class="preprocessor">#endif</span>
<a name="l03251"></a>03251 <span class="preprocessor"></span>
<a name="l03252"></a>03252    k = (int) floor ( m * x + 0.5 );
<a name="l03253"></a>03253    wk = 1.0;
<a name="l03254"></a>03254    <span class="keywordflow">for</span> (i = 0; i &lt;= m; i++)
<a name="l03255"></a>03255       <span class="keywordflow">if</span> (i != k)
<a name="l03256"></a>03256          wk *= ( <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i) = x - (double)(i) / m );
<a name="l03257"></a>03257    w = wk * ( <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(k) = x - (double)(k) / m );
<a name="l03258"></a>03258 
<a name="l03259"></a>03259    <span class="keywordflow">if</span> (k != 0)
<a name="l03260"></a>03260       shape(0) = w * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(0) / <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(0);
<a name="l03261"></a>03261    <span class="keywordflow">else</span>
<a name="l03262"></a>03262       shape(0) = wk * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(0);
<a name="l03263"></a>03263    <span class="keywordflow">if</span> (k != m)
<a name="l03264"></a>03264       shape(1) = w * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(m) / <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(m);
<a name="l03265"></a>03265    <span class="keywordflow">else</span>
<a name="l03266"></a>03266       shape(1) = wk * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(k);
<a name="l03267"></a>03267    <span class="keywordflow">for</span> (i = 1; i &lt; m; i++)
<a name="l03268"></a>03268       <span class="keywordflow">if</span> (i != k)
<a name="l03269"></a>03269          shape(i+1) = w * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i) / <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i);
<a name="l03270"></a>03270       <span class="keywordflow">else</span>
<a name="l03271"></a>03271          shape(k+1) = wk * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(k);
<a name="l03272"></a>03272 }
<a name="l03273"></a>03273 
<a name="l03274"></a><a class="code" href="classLagrange1DFiniteElement.html#aff2ebbae3f94b5ec2a013263bc933015">03274</a> <span class="keywordtype">void</span> <a class="code" href="classLagrange1DFiniteElement.html#aff2ebbae3f94b5ec2a013263bc933015">Lagrange1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03275"></a>03275                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03276"></a>03276 <span class="keyword"></span>{
<a name="l03277"></a>03277    <span class="keywordtype">double</span> s, srx, w, wk, x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03278"></a>03278    <span class="keywordtype">int</span> i, k, m = <a class="code" href="classFiniteElement.html#ac80061bcdb8a15aff6e3d437ec0b782d" title="Returns the order of the finite element.">GetOrder</a>();
<a name="l03279"></a>03279 
<a name="l03280"></a>03280 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l03281"></a>03281 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(m+1);
<a name="l03282"></a>03282 <span class="preprocessor">#endif</span>
<a name="l03283"></a>03283 <span class="preprocessor"></span>
<a name="l03284"></a>03284    k = (int) floor ( m * x + 0.5 );
<a name="l03285"></a>03285    wk = 1.0;
<a name="l03286"></a>03286    <span class="keywordflow">for</span> (i = 0; i &lt;= m; i++)
<a name="l03287"></a>03287       <span class="keywordflow">if</span> (i != k)
<a name="l03288"></a>03288          wk *= ( <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i) = x - (double)(i) / m );
<a name="l03289"></a>03289    w = wk * ( <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(k) = x - (double)(k) / m );
<a name="l03290"></a>03290 
<a name="l03291"></a>03291    <span class="keywordflow">for</span> (i = 0; i &lt;= m; i++)
<a name="l03292"></a>03292       <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i) = 1.0 / <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i);
<a name="l03293"></a>03293    srx = 0.0;
<a name="l03294"></a>03294    <span class="keywordflow">for</span> (i = 0; i &lt;= m; i++)
<a name="l03295"></a>03295       <span class="keywordflow">if</span> (i != k)
<a name="l03296"></a>03296          srx += <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i);
<a name="l03297"></a>03297    s = w * srx + wk;
<a name="l03298"></a>03298 
<a name="l03299"></a>03299    <span class="keywordflow">if</span> (k != 0)
<a name="l03300"></a>03300       dshape(0,0) = (s - w * <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(0)) * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(0) * <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(0);
<a name="l03301"></a>03301    <span class="keywordflow">else</span>
<a name="l03302"></a>03302       dshape(0,0) = wk * srx * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(0);
<a name="l03303"></a>03303    <span class="keywordflow">if</span> (k != m)
<a name="l03304"></a>03304       dshape(1,0) = (s - w * <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(m)) * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(m) * <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(m);
<a name="l03305"></a>03305    <span class="keywordflow">else</span>
<a name="l03306"></a>03306       dshape(1,0) = wk * srx * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(k);
<a name="l03307"></a>03307    <span class="keywordflow">for</span> (i = 1; i &lt; m; i++)
<a name="l03308"></a>03308       <span class="keywordflow">if</span> (i != k)
<a name="l03309"></a>03309          dshape(i+1,0) = (s - w * <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i)) * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(i) * <a class="code" href="classLagrange1DFiniteElement.html#ae2cc69b979f9b613af7d4750726f7e48">rxxk</a>(i);
<a name="l03310"></a>03310       <span class="keywordflow">else</span>
<a name="l03311"></a>03311          dshape(k+1,0) = wk * srx * <a class="code" href="classLagrange1DFiniteElement.html#ab93520d35accdfd91fa3fef51c4cd26b">rwk</a>(k);
<a name="l03312"></a>03312 }
<a name="l03313"></a>03313 
<a name="l03314"></a>03314 
<a name="l03315"></a><a class="code" href="classP1TetNonConfFiniteElement.html#a0eb4997ff0432d52f857ee654f30a48e">03315</a> <a class="code" href="classP1TetNonConfFiniteElement.html#a0eb4997ff0432d52f857ee654f30a48e">P1TetNonConfFiniteElement::P1TetNonConfFiniteElement</a>()
<a name="l03316"></a>03316    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 4, 1)
<a name="l03317"></a>03317 {
<a name="l03318"></a>03318    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l03319"></a>03319    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l03320"></a>03320    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.33333333333333333333;
<a name="l03321"></a>03321 
<a name="l03322"></a>03322    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03323"></a>03323    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l03324"></a>03324    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.33333333333333333333;
<a name="l03325"></a>03325 
<a name="l03326"></a>03326    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l03327"></a>03327    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03328"></a>03328    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.33333333333333333333;
<a name="l03329"></a>03329 
<a name="l03330"></a>03330    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l03331"></a>03331    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l03332"></a>03332    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03333"></a>03333 
<a name="l03334"></a>03334 }
<a name="l03335"></a>03335 
<a name="l03336"></a><a class="code" href="classP1TetNonConfFiniteElement.html#a12d697f4685d1c660ef2f65afe54c576">03336</a> <span class="keywordtype">void</span> <a class="code" href="classP1TetNonConfFiniteElement.html#a12d697f4685d1c660ef2f65afe54c576">P1TetNonConfFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03337"></a>03337                                           <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03338"></a>03338 <span class="keyword"></span>{
<a name="l03339"></a>03339    <span class="keywordtype">double</span> L0, L1, L2, L3;
<a name="l03340"></a>03340 
<a name="l03341"></a>03341    L1 = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;  L2 = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;  L3 = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;  L0 = 1.0 - L1 - L2 - L3;
<a name="l03342"></a>03342    shape(0) = 1.0 - 3.0 * L0;
<a name="l03343"></a>03343    shape(1) = 1.0 - 3.0 * L1;
<a name="l03344"></a>03344    shape(2) = 1.0 - 3.0 * L2;
<a name="l03345"></a>03345    shape(3) = 1.0 - 3.0 * L3;
<a name="l03346"></a>03346 }
<a name="l03347"></a>03347 
<a name="l03348"></a><a class="code" href="classP1TetNonConfFiniteElement.html#ac0cce37c35f2e3a94a8f013744753a05">03348</a> <span class="keywordtype">void</span> <a class="code" href="classP1TetNonConfFiniteElement.html#ac0cce37c35f2e3a94a8f013744753a05">P1TetNonConfFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03349"></a>03349                                            <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03350"></a>03350 <span class="keyword"></span>{
<a name="l03351"></a>03351    dshape(0,0) =  3.0; dshape(0,1) =  3.0; dshape(0,2) =  3.0;
<a name="l03352"></a>03352    dshape(1,0) = -3.0; dshape(1,1) =  0.0; dshape(1,2) =  0.0;
<a name="l03353"></a>03353    dshape(2,0) =  0.0; dshape(2,1) = -3.0; dshape(2,2) =  0.0;
<a name="l03354"></a>03354    dshape(3,0) =  0.0; dshape(3,1) =  0.0; dshape(3,2) = -3.0;
<a name="l03355"></a>03355 }
<a name="l03356"></a>03356 
<a name="l03357"></a>03357 
<a name="l03358"></a><a class="code" href="classP0TetFiniteElement.html#ae31b5132631f9df9dfe4db2747acddbc">03358</a> <a class="code" href="classP0TetFiniteElement.html#ae31b5132631f9df9dfe4db2747acddbc">P0TetFiniteElement::P0TetFiniteElement</a>()
<a name="l03359"></a>03359    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON , 1, 0)
<a name="l03360"></a>03360 {
<a name="l03361"></a>03361    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.25;
<a name="l03362"></a>03362    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.25;
<a name="l03363"></a>03363    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.25;
<a name="l03364"></a>03364 }
<a name="l03365"></a>03365 
<a name="l03366"></a><a class="code" href="classP0TetFiniteElement.html#a4ec5304fe7d1a517a0b360441754379b">03366</a> <span class="keywordtype">void</span> <a class="code" href="classP0TetFiniteElement.html#a4ec5304fe7d1a517a0b360441754379b">P0TetFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03367"></a>03367                                    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03368"></a>03368 <span class="keyword"></span>{
<a name="l03369"></a>03369    shape(0) = 1.0;
<a name="l03370"></a>03370 }
<a name="l03371"></a>03371 
<a name="l03372"></a><a class="code" href="classP0TetFiniteElement.html#a0e53edf9fdda84a7dfcce1454159ea10">03372</a> <span class="keywordtype">void</span> <a class="code" href="classP0TetFiniteElement.html#a0e53edf9fdda84a7dfcce1454159ea10">P0TetFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03373"></a>03373                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03374"></a>03374 <span class="keyword"></span>{
<a name="l03375"></a>03375    dshape(0,0) =  0.0; dshape(0,1) =  0.0; dshape(0,2) = 0.0;
<a name="l03376"></a>03376 }
<a name="l03377"></a>03377 
<a name="l03378"></a>03378 
<a name="l03379"></a><a class="code" href="classP0HexFiniteElement.html#a7ae53b51649353213a05865c2d03a09b">03379</a> <a class="code" href="classP0HexFiniteElement.html#a7ae53b51649353213a05865c2d03a09b">P0HexFiniteElement::P0HexFiniteElement</a>()
<a name="l03380"></a>03380    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 1, 0, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l03381"></a>03381 {
<a name="l03382"></a>03382    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03383"></a>03383    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03384"></a>03384    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l03385"></a>03385 }
<a name="l03386"></a>03386 
<a name="l03387"></a><a class="code" href="classP0HexFiniteElement.html#af6361c9d7e6907fe0793ad62fa625ab6">03387</a> <span class="keywordtype">void</span> <a class="code" href="classP0HexFiniteElement.html#af6361c9d7e6907fe0793ad62fa625ab6">P0HexFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03388"></a>03388                                    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03389"></a>03389 <span class="keyword"></span>{
<a name="l03390"></a>03390    shape(0) = 1.0;
<a name="l03391"></a>03391 }
<a name="l03392"></a>03392 
<a name="l03393"></a><a class="code" href="classP0HexFiniteElement.html#addad08559478e90c1289ce3338a1c0f9">03393</a> <span class="keywordtype">void</span> <a class="code" href="classP0HexFiniteElement.html#addad08559478e90c1289ce3338a1c0f9">P0HexFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03394"></a>03394                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03395"></a>03395 <span class="keyword"></span>{
<a name="l03396"></a>03396    dshape(0,0) =  0.0; dshape(0,1) =  0.0; dshape(0,2) = 0.0;
<a name="l03397"></a>03397 }
<a name="l03398"></a>03398 
<a name="l03399"></a>03399 
<a name="l03400"></a><a class="code" href="classLagrangeHexFiniteElement.html#abf5c6753fa8176f292fdc54dbae2342f">03400</a> <a class="code" href="classLagrangeHexFiniteElement.html#abf5c6753fa8176f292fdc54dbae2342f">LagrangeHexFiniteElement::LagrangeHexFiniteElement</a> (<span class="keywordtype">int</span> degree)
<a name="l03401"></a>03401    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, (degree+1)*(degree+1)*(degree+1),
<a name="l03402"></a>03402                         degree, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l03403"></a>03403 {
<a name="l03404"></a>03404    <span class="keywordflow">if</span> (degree == 2)
<a name="l03405"></a>03405    {
<a name="l03406"></a>03406       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>];
<a name="l03407"></a>03407       <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>];
<a name="l03408"></a>03408       <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>];
<a name="l03409"></a>03409       <span class="comment">// nodes</span>
<a name="l03410"></a>03410       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 0] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 0] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 0] = 0;
<a name="l03411"></a>03411       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 1] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 1] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 1] = 0;
<a name="l03412"></a>03412       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 2] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 2] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 2] = 0;
<a name="l03413"></a>03413       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 3] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 3] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 3] = 0;
<a name="l03414"></a>03414       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 4] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 4] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 4] = 1;
<a name="l03415"></a>03415       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 5] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 5] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 5] = 1;
<a name="l03416"></a>03416       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 6] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 6] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 6] = 1;
<a name="l03417"></a>03417       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 7] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 7] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 7] = 1;
<a name="l03418"></a>03418       <span class="comment">// edges</span>
<a name="l03419"></a>03419       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 8] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 8] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 8] = 0;
<a name="l03420"></a>03420       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 9] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 9] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 9] = 0;
<a name="l03421"></a>03421       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[10] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[10] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[10] = 0;
<a name="l03422"></a>03422       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[11] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[11] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[11] = 0;
<a name="l03423"></a>03423       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[12] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[12] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[12] = 1;
<a name="l03424"></a>03424       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[13] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[13] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[13] = 1;
<a name="l03425"></a>03425       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[14] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[14] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[14] = 1;
<a name="l03426"></a>03426       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[15] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[15] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[15] = 1;
<a name="l03427"></a>03427       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[16] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[16] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[16] = 2;
<a name="l03428"></a>03428       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[17] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[17] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[17] = 2;
<a name="l03429"></a>03429       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[18] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[18] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[18] = 2;
<a name="l03430"></a>03430       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[19] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[19] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[19] = 2;
<a name="l03431"></a>03431       <span class="comment">// faces</span>
<a name="l03432"></a>03432       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[20] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[20] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[20] = 0;
<a name="l03433"></a>03433       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[21] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[21] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[21] = 2;
<a name="l03434"></a>03434       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[22] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[22] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[22] = 2;
<a name="l03435"></a>03435       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[23] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[23] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[23] = 2;
<a name="l03436"></a>03436       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[24] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[24] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[24] = 2;
<a name="l03437"></a>03437       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[25] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[25] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[25] = 1;
<a name="l03438"></a>03438       <span class="comment">// element</span>
<a name="l03439"></a>03439       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[26] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[26] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[26] = 2;
<a name="l03440"></a>03440    }
<a name="l03441"></a>03441    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (degree == 3)
<a name="l03442"></a>03442    {
<a name="l03443"></a>03443       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>];
<a name="l03444"></a>03444       <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>];
<a name="l03445"></a>03445       <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>];
<a name="l03446"></a>03446       <span class="comment">// nodes</span>
<a name="l03447"></a>03447       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 0] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 0] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 0] = 0;
<a name="l03448"></a>03448       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 1] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 1] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 1] = 0;
<a name="l03449"></a>03449       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 2] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 2] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 2] = 0;
<a name="l03450"></a>03450       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 3] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 3] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 3] = 0;
<a name="l03451"></a>03451       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 4] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 4] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 4] = 1;
<a name="l03452"></a>03452       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 5] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 5] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 5] = 1;
<a name="l03453"></a>03453       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 6] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 6] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 6] = 1;
<a name="l03454"></a>03454       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 7] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 7] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 7] = 1;
<a name="l03455"></a>03455       <span class="comment">// edges</span>
<a name="l03456"></a>03456       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 8] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 8] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 8] = 0;
<a name="l03457"></a>03457       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[ 9] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[ 9] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[ 9] = 0;
<a name="l03458"></a>03458       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[10] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[10] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[10] = 0;
<a name="l03459"></a>03459       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[11] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[11] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[11] = 0;
<a name="l03460"></a>03460       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[12] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[12] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[12] = 0;
<a name="l03461"></a>03461       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[13] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[13] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[13] = 0;
<a name="l03462"></a>03462       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[14] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[14] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[14] = 0;
<a name="l03463"></a>03463       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[15] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[15] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[15] = 0;
<a name="l03464"></a>03464       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[16] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[16] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[16] = 1;
<a name="l03465"></a>03465       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[17] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[17] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[17] = 1;
<a name="l03466"></a>03466       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[18] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[18] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[18] = 1;
<a name="l03467"></a>03467       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[19] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[19] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[19] = 1;
<a name="l03468"></a>03468       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[20] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[20] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[20] = 1;
<a name="l03469"></a>03469       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[21] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[21] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[21] = 1;
<a name="l03470"></a>03470       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[22] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[22] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[22] = 1;
<a name="l03471"></a>03471       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[23] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[23] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[23] = 1;
<a name="l03472"></a>03472       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[24] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[24] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[24] = 2;
<a name="l03473"></a>03473       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[25] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[25] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[25] = 3;
<a name="l03474"></a>03474       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[26] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[26] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[26] = 2;
<a name="l03475"></a>03475       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[27] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[27] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[27] = 3;
<a name="l03476"></a>03476       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[28] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[28] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[28] = 2;
<a name="l03477"></a>03477       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[29] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[29] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[29] = 3;
<a name="l03478"></a>03478       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[30] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[30] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[30] = 2;
<a name="l03479"></a>03479       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[31] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[31] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[31] = 3;
<a name="l03480"></a>03480       <span class="comment">// faces</span>
<a name="l03481"></a>03481       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[32] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[32] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[32] = 0;
<a name="l03482"></a>03482       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[33] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[33] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[33] = 0;
<a name="l03483"></a>03483       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[34] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[34] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[34] = 0;
<a name="l03484"></a>03484       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[35] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[35] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[35] = 0;
<a name="l03485"></a>03485       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[36] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[36] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[36] = 2;
<a name="l03486"></a>03486       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[37] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[37] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[37] = 2;
<a name="l03487"></a>03487       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[38] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[38] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[38] = 3;
<a name="l03488"></a>03488       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[39] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[39] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[39] = 3;
<a name="l03489"></a>03489       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[40] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[40] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[40] = 2;
<a name="l03490"></a>03490       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[41] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[41] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[41] = 2;
<a name="l03491"></a>03491       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[42] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[42] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[42] = 3;
<a name="l03492"></a>03492       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[43] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[43] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[43] = 3;
<a name="l03493"></a>03493       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[44] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[44] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[44] = 2;
<a name="l03494"></a>03494       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[45] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[45] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[45] = 2;
<a name="l03495"></a>03495       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[46] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[46] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[46] = 3;
<a name="l03496"></a>03496       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[47] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[47] = 1; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[47] = 3;
<a name="l03497"></a>03497       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[48] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[48] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[48] = 2;
<a name="l03498"></a>03498       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[49] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[49] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[49] = 2;
<a name="l03499"></a>03499       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[50] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[50] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[50] = 3;
<a name="l03500"></a>03500       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[51] = 0; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[51] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[51] = 3;
<a name="l03501"></a>03501       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[52] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[52] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[52] = 1;
<a name="l03502"></a>03502       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[53] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[53] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[53] = 1;
<a name="l03503"></a>03503       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[54] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[54] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[54] = 1;
<a name="l03504"></a>03504       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[55] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[55] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[55] = 1;
<a name="l03505"></a>03505       <span class="comment">// element</span>
<a name="l03506"></a>03506       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[56] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[56] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[56] = 2;
<a name="l03507"></a>03507       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[57] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[57] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[57] = 2;
<a name="l03508"></a>03508       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[58] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[58] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[58] = 2;
<a name="l03509"></a>03509       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[59] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[59] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[59] = 2;
<a name="l03510"></a>03510       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[60] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[60] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[60] = 3;
<a name="l03511"></a>03511       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[61] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[61] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[61] = 3;
<a name="l03512"></a>03512       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[62] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[62] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[62] = 3;
<a name="l03513"></a>03513       <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[63] = 2; <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[63] = 3; <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[63] = 3;
<a name="l03514"></a>03514    }
<a name="l03515"></a>03515    <span class="keywordflow">else</span>
<a name="l03516"></a>03516    {
<a name="l03517"></a>03517       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a> (<span class="stringliteral">&quot;LagrangeHexFiniteElement::LagrangeHexFiniteElement&quot;</span>);
<a name="l03518"></a>03518    }
<a name="l03519"></a>03519 
<a name="l03520"></a>03520    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> = <span class="keyword">new</span> <a class="code" href="classLagrange1DFiniteElement.html">Lagrange1DFiniteElement</a>(degree);
<a name="l03521"></a>03521    <a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a> = <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classFiniteElement.html#a067c3ad75885810cdb3b6c1e97bbb0c2" title="Returns the degrees of freedom in the FE space.">GetDof</a>();
<a name="l03522"></a>03522 
<a name="l03523"></a>03523 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l03524"></a>03524 <span class="preprocessor"></span>   <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>);
<a name="l03525"></a>03525    <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>);
<a name="l03526"></a>03526    <a class="code" href="classLagrangeHexFiniteElement.html#aa003285cfa23fc9b91f519e9c48ae7be">shape1dz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>);
<a name="l03527"></a>03527 
<a name="l03528"></a>03528    <a class="code" href="classLagrangeHexFiniteElement.html#a8e784ae4fa57f6d1421cebd8ccb2b7e4">dshape1dx</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>,1);
<a name="l03529"></a>03529    <a class="code" href="classLagrangeHexFiniteElement.html#aab17ed96d3939152a2d3646808379aff">dshape1dy</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>,1);
<a name="l03530"></a>03530    <a class="code" href="classLagrangeHexFiniteElement.html#a81c616717842815e12b3409929fb180f">dshape1dz</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>,1);
<a name="l03531"></a>03531 <span class="preprocessor">#endif</span>
<a name="l03532"></a>03532 <span class="preprocessor"></span>
<a name="l03533"></a>03533    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; n++)
<a name="l03534"></a>03534    {
<a name="l03535"></a>03535       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classFiniteElement.html#a26243076fad3b907f55c6da68a2f0151">GetNodes</a>().<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[n]).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03536"></a>03536       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classFiniteElement.html#a26243076fad3b907f55c6da68a2f0151">GetNodes</a>().<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(<a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[n]).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03537"></a>03537       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classFiniteElement.html#a26243076fad3b907f55c6da68a2f0151">GetNodes</a>().<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[n]).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03538"></a>03538    }
<a name="l03539"></a>03539 }
<a name="l03540"></a>03540 
<a name="l03541"></a><a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">03541</a> <span class="keywordtype">void</span> <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">LagrangeHexFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03542"></a>03542                                          <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03543"></a>03543 <span class="keyword"></span>{
<a name="l03544"></a>03544    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ipy, ipz;
<a name="l03545"></a>03545    ipy.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l03546"></a>03546    ipz.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l03547"></a>03547 
<a name="l03548"></a>03548 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l03549"></a>03549 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>), <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>), <a class="code" href="classLagrangeHexFiniteElement.html#aa003285cfa23fc9b91f519e9c48ae7be">shape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>);
<a name="l03550"></a>03550 <span class="preprocessor">#endif</span>
<a name="l03551"></a>03551 <span class="preprocessor"></span>
<a name="l03552"></a>03552    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">CalcShape</a>(ip,  <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>);
<a name="l03553"></a>03553    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">CalcShape</a>(ipy, <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>);
<a name="l03554"></a>03554    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">CalcShape</a>(ipz, shape1dz);
<a name="l03555"></a>03555 
<a name="l03556"></a>03556    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; n++)
<a name="l03557"></a>03557       shape(n) = <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[n]) *  <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[n]) * <a class="code" href="classLagrangeHexFiniteElement.html#aa003285cfa23fc9b91f519e9c48ae7be">shape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[n]);
<a name="l03558"></a>03558 }
<a name="l03559"></a>03559 
<a name="l03560"></a><a class="code" href="classLagrangeHexFiniteElement.html#a6b5fc2af69e9e16d095943f96d771022">03560</a> <span class="keywordtype">void</span> <a class="code" href="classLagrangeHexFiniteElement.html#a6b5fc2af69e9e16d095943f96d771022">LagrangeHexFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03561"></a>03561                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03562"></a>03562 <span class="keyword"></span>{
<a name="l03563"></a>03563    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ipy, ipz;
<a name="l03564"></a>03564    ipy.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l03565"></a>03565    ipz.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l03566"></a>03566 
<a name="l03567"></a>03567 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l03568"></a>03568 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>), <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>), <a class="code" href="classLagrangeHexFiniteElement.html#aa003285cfa23fc9b91f519e9c48ae7be">shape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>);
<a name="l03569"></a>03569    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classLagrangeHexFiniteElement.html#a8e784ae4fa57f6d1421cebd8ccb2b7e4">dshape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>,1), <a class="code" href="classLagrangeHexFiniteElement.html#aab17ed96d3939152a2d3646808379aff">dshape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>,1), <a class="code" href="classLagrangeHexFiniteElement.html#a81c616717842815e12b3409929fb180f">dshape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a36e89717bb01976837b869957a9fa49d">dof1d</a>,1);
<a name="l03570"></a>03570 <span class="preprocessor">#endif</span>
<a name="l03571"></a>03571 <span class="preprocessor"></span>
<a name="l03572"></a>03572    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">CalcShape</a>(ip,  <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>);
<a name="l03573"></a>03573    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">CalcShape</a>(ipy, <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>);
<a name="l03574"></a>03574    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#af2212af69393e62ea938cd44340421a2">CalcShape</a>(ipz, shape1dz);
<a name="l03575"></a>03575 
<a name="l03576"></a>03576    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#a6b5fc2af69e9e16d095943f96d771022">CalcDShape</a>(ip,  <a class="code" href="classLagrangeHexFiniteElement.html#a8e784ae4fa57f6d1421cebd8ccb2b7e4">dshape1dx</a>);
<a name="l03577"></a>03577    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#a6b5fc2af69e9e16d095943f96d771022">CalcDShape</a>(ipy, <a class="code" href="classLagrangeHexFiniteElement.html#aab17ed96d3939152a2d3646808379aff">dshape1dy</a>);
<a name="l03578"></a>03578    <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a> -&gt; <a class="code" href="classLagrangeHexFiniteElement.html#a6b5fc2af69e9e16d095943f96d771022">CalcDShape</a>(ipz, dshape1dz);
<a name="l03579"></a>03579 
<a name="l03580"></a>03580    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; n++) {
<a name="l03581"></a>03581       dshape(n,0) = <a class="code" href="classLagrangeHexFiniteElement.html#a8e784ae4fa57f6d1421cebd8ccb2b7e4">dshape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[n],0) * <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[n])    * <a class="code" href="classLagrangeHexFiniteElement.html#aa003285cfa23fc9b91f519e9c48ae7be">shape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[n]);
<a name="l03582"></a>03582       dshape(n,1) = <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[n])    * <a class="code" href="classLagrangeHexFiniteElement.html#aab17ed96d3939152a2d3646808379aff">dshape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[n],0) * <a class="code" href="classLagrangeHexFiniteElement.html#aa003285cfa23fc9b91f519e9c48ae7be">shape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[n]);
<a name="l03583"></a>03583       dshape(n,2) = <a class="code" href="classLagrangeHexFiniteElement.html#a1c8417043048226373a79bcc4d8255e4">shape1dx</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>[n])    * <a class="code" href="classLagrangeHexFiniteElement.html#aab96a2c387848e4d6c80b28f63203b9b">shape1dy</a>(<a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>[n])    * <a class="code" href="classLagrangeHexFiniteElement.html#a81c616717842815e12b3409929fb180f">dshape1dz</a>(<a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>[n],0);
<a name="l03584"></a>03584    }
<a name="l03585"></a>03585 }
<a name="l03586"></a>03586 
<a name="l03587"></a><a class="code" href="classLagrangeHexFiniteElement.html#a6322e53e252c087b36a45e4b920b9e09">03587</a> <a class="code" href="classLagrangeHexFiniteElement.html#a6322e53e252c087b36a45e4b920b9e09">LagrangeHexFiniteElement::~LagrangeHexFiniteElement</a> ()
<a name="l03588"></a>03588 {
<a name="l03589"></a>03589    <span class="keyword">delete</span> <a class="code" href="classLagrangeHexFiniteElement.html#a2abcb21a41316b0833339e373f0febfc">fe1d</a>;
<a name="l03590"></a>03590 
<a name="l03591"></a>03591    <span class="keyword">delete</span> [] <a class="code" href="classLagrangeHexFiniteElement.html#a22b013eb8fce27c92c6ac08706dd8395">I</a>;
<a name="l03592"></a>03592    <span class="keyword">delete</span> [] <a class="code" href="classLagrangeHexFiniteElement.html#ab14ecd3594056017cb30eab9b6ec03fb">J</a>;
<a name="l03593"></a>03593    <span class="keyword">delete</span> [] <a class="code" href="classLagrangeHexFiniteElement.html#a561ae4da38aa72131658aa009e826008">K</a>;
<a name="l03594"></a>03594 }
<a name="l03595"></a>03595 
<a name="l03596"></a>03596 
<a name="l03597"></a><a class="code" href="classRefinedLinear1DFiniteElement.html#a32a3ca5d682415465f092b966cf98e2d">03597</a> <a class="code" href="classRefinedLinear1DFiniteElement.html#a32a3ca5d682415465f092b966cf98e2d" title="Construct a quadratic FE on interval.">RefinedLinear1DFiniteElement::RefinedLinear1DFiniteElement</a>()
<a name="l03598"></a>03598    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, 3, 4)
<a name="l03599"></a>03599 {
<a name="l03600"></a>03600    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03601"></a>03601    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03602"></a>03602    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03603"></a>03603 }
<a name="l03604"></a>03604 
<a name="l03605"></a><a class="code" href="classRefinedLinear1DFiniteElement.html#a4e19fe5c8d8216546f5f8236aba4f39b">03605</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedLinear1DFiniteElement.html#a4e19fe5c8d8216546f5f8236aba4f39b">RefinedLinear1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03606"></a>03606                                              <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03607"></a>03607 <span class="keyword"></span>{
<a name="l03608"></a>03608    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03609"></a>03609 
<a name="l03610"></a>03610    <span class="keywordflow">if</span> (x &lt;= 0.5) {
<a name="l03611"></a>03611       shape(0) = 1.0 - 2.0 * x;
<a name="l03612"></a>03612       shape(1) = 0.0;
<a name="l03613"></a>03613       shape(2) = 2.0 * x;
<a name="l03614"></a>03614    } <span class="keywordflow">else</span> {
<a name="l03615"></a>03615       shape(0) = 0.0;
<a name="l03616"></a>03616       shape(1) = 2.0 * x - 1.0;
<a name="l03617"></a>03617       shape(2) = 2.0 - 2.0 * x;
<a name="l03618"></a>03618    }
<a name="l03619"></a>03619 }
<a name="l03620"></a>03620 
<a name="l03621"></a><a class="code" href="classRefinedLinear1DFiniteElement.html#a68cee997156ff06caea73d3aa9ea1ef9">03621</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedLinear1DFiniteElement.html#a68cee997156ff06caea73d3aa9ea1ef9">RefinedLinear1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03622"></a>03622                                               <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03623"></a>03623 <span class="keyword"></span>{
<a name="l03624"></a>03624    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>;
<a name="l03625"></a>03625 
<a name="l03626"></a>03626    <span class="keywordflow">if</span> (x &lt;= 0.5) {
<a name="l03627"></a>03627       dshape(0,0) = - 2.0;
<a name="l03628"></a>03628       dshape(1,0) =   0.0;
<a name="l03629"></a>03629       dshape(2,0) =   2.0;
<a name="l03630"></a>03630    } <span class="keywordflow">else</span> {
<a name="l03631"></a>03631       dshape(0,0) =   0.0;
<a name="l03632"></a>03632       dshape(1,0) =   2.0;
<a name="l03633"></a>03633       dshape(2,0) = - 2.0;
<a name="l03634"></a>03634    }
<a name="l03635"></a>03635 }
<a name="l03636"></a>03636 
<a name="l03637"></a><a class="code" href="classRefinedLinear2DFiniteElement.html#a750ac7f3101f1580c1fb1e0a7931d71f">03637</a> <a class="code" href="classRefinedLinear2DFiniteElement.html#a750ac7f3101f1580c1fb1e0a7931d71f" title="Construct a quadratic FE on triangle.">RefinedLinear2DFiniteElement::RefinedLinear2DFiniteElement</a>()
<a name="l03638"></a>03638    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, 6, 5)
<a name="l03639"></a>03639 {
<a name="l03640"></a>03640    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03641"></a>03641    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03642"></a>03642    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03643"></a>03643    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03644"></a>03644    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03645"></a>03645    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l03646"></a>03646    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03647"></a>03647    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03648"></a>03648    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03649"></a>03649    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03650"></a>03650    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03651"></a>03651    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03652"></a>03652 }
<a name="l03653"></a>03653 
<a name="l03654"></a><a class="code" href="classRefinedLinear2DFiniteElement.html#a2d8532699b7f4c4e0a68af1ddad1532f">03654</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedLinear2DFiniteElement.html#a2d8532699b7f4c4e0a68af1ddad1532f">RefinedLinear2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03655"></a>03655                                              <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03656"></a>03656 <span class="keyword"></span>{
<a name="l03657"></a>03657    <span class="keywordtype">int</span> i;
<a name="l03658"></a>03658 
<a name="l03659"></a>03659    <span class="keywordtype">double</span> L0, L1, L2;
<a name="l03660"></a>03660    L0 = 2.0 * ( 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03661"></a>03661    L1 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> );
<a name="l03662"></a>03662    L2 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03663"></a>03663 
<a name="l03664"></a>03664    <span class="comment">// The reference triangle is split in 4 triangles as follows:</span>
<a name="l03665"></a>03665    <span class="comment">//</span>
<a name="l03666"></a>03666    <span class="comment">// T0 - 0,3,5</span>
<a name="l03667"></a>03667    <span class="comment">// T1 - 1,3,4</span>
<a name="l03668"></a>03668    <span class="comment">// T2 - 2,4,5</span>
<a name="l03669"></a>03669    <span class="comment">// T3 - 3,4,5</span>
<a name="l03670"></a>03670 
<a name="l03671"></a>03671    <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++)
<a name="l03672"></a>03672       shape(i) = 0.0;
<a name="l03673"></a>03673 
<a name="l03674"></a>03674    <span class="keywordflow">if</span> (L0 &gt;= 1.0) { <span class="comment">// T0</span>
<a name="l03675"></a>03675       shape(0) = L0 - 1.0;
<a name="l03676"></a>03676       shape(3) =       L1;
<a name="l03677"></a>03677       shape(5) =       L2;
<a name="l03678"></a>03678    }
<a name="l03679"></a>03679    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L1 &gt;= 1.0) { <span class="comment">// T1</span>
<a name="l03680"></a>03680       shape(3) =       L0;
<a name="l03681"></a>03681       shape(1) = L1 - 1.0;
<a name="l03682"></a>03682       shape(4) =       L2;
<a name="l03683"></a>03683    }
<a name="l03684"></a>03684    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L2 &gt;= 1.0) { <span class="comment">// T2</span>
<a name="l03685"></a>03685       shape(5) =       L0;
<a name="l03686"></a>03686       shape(4) =       L1;
<a name="l03687"></a>03687       shape(2) = L2 - 1.0;
<a name="l03688"></a>03688    }
<a name="l03689"></a>03689    <span class="keywordflow">else</span> { <span class="comment">// T3</span>
<a name="l03690"></a>03690       shape(3) = 1.0 - L2;
<a name="l03691"></a>03691       shape(4) = 1.0 - L0;
<a name="l03692"></a>03692       shape(5) = 1.0 - L1;
<a name="l03693"></a>03693    }
<a name="l03694"></a>03694 }
<a name="l03695"></a>03695 
<a name="l03696"></a><a class="code" href="classRefinedLinear2DFiniteElement.html#a390ac40ad82132ca477f60f213326358">03696</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedLinear2DFiniteElement.html#a390ac40ad82132ca477f60f213326358">RefinedLinear2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03697"></a>03697                                               <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03698"></a>03698 <span class="keyword"></span>{
<a name="l03699"></a>03699    <span class="keywordtype">int</span> i,j;
<a name="l03700"></a>03700 
<a name="l03701"></a>03701    <span class="keywordtype">double</span> L0, L1, L2;
<a name="l03702"></a>03702    L0 = 2.0 * ( 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03703"></a>03703    L1 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> );
<a name="l03704"></a>03704    L2 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03705"></a>03705 
<a name="l03706"></a>03706    <span class="keywordtype">double</span> DL0[2], DL1[2], DL2[2];
<a name="l03707"></a>03707    DL0[0] = -2.0; DL0[1] = -2.0;
<a name="l03708"></a>03708    DL1[0] =  2.0; DL1[1] =  0.0;
<a name="l03709"></a>03709    DL2[0] =  0.0; DL2[1] =  2.0;
<a name="l03710"></a>03710 
<a name="l03711"></a>03711    <span class="keywordflow">for</span> (i = 0; i &lt; 6; i++)
<a name="l03712"></a>03712       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++)
<a name="l03713"></a>03713          dshape(i,j) = 0.0;
<a name="l03714"></a>03714 
<a name="l03715"></a>03715    <span class="keywordflow">if</span> (L0 &gt;= 1.0) { <span class="comment">// T0</span>
<a name="l03716"></a>03716       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l03717"></a>03717          dshape(0,j) = DL0[j];
<a name="l03718"></a>03718          dshape(3,j) = DL1[j];
<a name="l03719"></a>03719          dshape(5,j) = DL2[j];
<a name="l03720"></a>03720       }
<a name="l03721"></a>03721    }
<a name="l03722"></a>03722    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L1 &gt;= 1.0) { <span class="comment">// T1</span>
<a name="l03723"></a>03723       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l03724"></a>03724          dshape(3,j) = DL0[j];
<a name="l03725"></a>03725          dshape(1,j) = DL1[j];
<a name="l03726"></a>03726          dshape(4,j) = DL2[j];
<a name="l03727"></a>03727       }
<a name="l03728"></a>03728    }
<a name="l03729"></a>03729    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L2 &gt;= 1.0) { <span class="comment">// T2</span>
<a name="l03730"></a>03730       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l03731"></a>03731          dshape(5,j) = DL0[j];
<a name="l03732"></a>03732          dshape(4,j) = DL1[j];
<a name="l03733"></a>03733          dshape(2,j) = DL2[j];
<a name="l03734"></a>03734       }
<a name="l03735"></a>03735    }
<a name="l03736"></a>03736    <span class="keywordflow">else</span> { <span class="comment">// T3</span>
<a name="l03737"></a>03737       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++) {
<a name="l03738"></a>03738          dshape(3,j) = - DL2[j];
<a name="l03739"></a>03739          dshape(4,j) = - DL0[j];
<a name="l03740"></a>03740          dshape(5,j) = - DL1[j];
<a name="l03741"></a>03741       }
<a name="l03742"></a>03742    }
<a name="l03743"></a>03743 }
<a name="l03744"></a>03744 
<a name="l03745"></a><a class="code" href="classRefinedLinear3DFiniteElement.html#af2606b521c0c896af385777c0dd390a4">03745</a> <a class="code" href="classRefinedLinear3DFiniteElement.html#af2606b521c0c896af385777c0dd390a4" title="Construct a quadratic FE on tetrahedron.">RefinedLinear3DFiniteElement::RefinedLinear3DFiniteElement</a>()
<a name="l03746"></a>03746    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 10, 4)
<a name="l03747"></a>03747 {
<a name="l03748"></a>03748    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03749"></a>03749    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03750"></a>03750    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03751"></a>03751    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03752"></a>03752    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03753"></a>03753    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03754"></a>03754    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03755"></a>03755    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l03756"></a>03756    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03757"></a>03757    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03758"></a>03758    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03759"></a>03759    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l03760"></a>03760    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03761"></a>03761    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03762"></a>03762    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03763"></a>03763    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03764"></a>03764    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03765"></a>03765    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03766"></a>03766    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03767"></a>03767    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03768"></a>03768    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l03769"></a>03769    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03770"></a>03770    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03771"></a>03771    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l03772"></a>03772    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03773"></a>03773    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03774"></a>03774    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l03775"></a>03775    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03776"></a>03776    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03777"></a>03777    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l03778"></a>03778 }
<a name="l03779"></a>03779 
<a name="l03780"></a><a class="code" href="classRefinedLinear3DFiniteElement.html#ac42bdff1dc2a126140239ecd377095a4">03780</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedLinear3DFiniteElement.html#ac42bdff1dc2a126140239ecd377095a4">RefinedLinear3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03781"></a>03781                                              <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03782"></a>03782 <span class="keyword"></span>{
<a name="l03783"></a>03783    <span class="keywordtype">int</span> i;
<a name="l03784"></a>03784 
<a name="l03785"></a>03785    <span class="keywordtype">double</span> L0, L1, L2, L3, L4, L5;
<a name="l03786"></a>03786    L0 = 2.0 * ( 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> );
<a name="l03787"></a>03787    L1 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> );
<a name="l03788"></a>03788    L2 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03789"></a>03789    L3 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> );
<a name="l03790"></a>03790    L4 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> + ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03791"></a>03791    L5 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> + ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> );
<a name="l03792"></a>03792 
<a name="l03793"></a>03793    <span class="comment">// The reference tetrahedron is split in 8 tetrahedra as follows:</span>
<a name="l03794"></a>03794    <span class="comment">//</span>
<a name="l03795"></a>03795    <span class="comment">// T0 - 0,4,5,6</span>
<a name="l03796"></a>03796    <span class="comment">// T1 - 1,4,7,8</span>
<a name="l03797"></a>03797    <span class="comment">// T2 - 2,5,7,9</span>
<a name="l03798"></a>03798    <span class="comment">// T3 - 3,6,8,9</span>
<a name="l03799"></a>03799    <span class="comment">// T4 - 4,5,6,8</span>
<a name="l03800"></a>03800    <span class="comment">// T5 - 4,5,7,8</span>
<a name="l03801"></a>03801    <span class="comment">// T6 - 5,6,8,9</span>
<a name="l03802"></a>03802    <span class="comment">// T7 - 5,7,8,9</span>
<a name="l03803"></a>03803 
<a name="l03804"></a>03804    <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++)
<a name="l03805"></a>03805       shape(i) = 0.0;
<a name="l03806"></a>03806 
<a name="l03807"></a>03807    <span class="keywordflow">if</span> (L0 &gt;= 1.0) { <span class="comment">// T0</span>
<a name="l03808"></a>03808       shape(0) = L0 - 1.0;
<a name="l03809"></a>03809       shape(4) =       L1;
<a name="l03810"></a>03810       shape(5) =       L2;
<a name="l03811"></a>03811       shape(6) =       L3;
<a name="l03812"></a>03812    }
<a name="l03813"></a>03813    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L1 &gt;= 1.0) { <span class="comment">// T1</span>
<a name="l03814"></a>03814       shape(4) =       L0;
<a name="l03815"></a>03815       shape(1) = L1 - 1.0;
<a name="l03816"></a>03816       shape(7) =       L2;
<a name="l03817"></a>03817       shape(8) =       L3;
<a name="l03818"></a>03818    }
<a name="l03819"></a>03819    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L2 &gt;= 1.0) { <span class="comment">// T2</span>
<a name="l03820"></a>03820       shape(5) =       L0;
<a name="l03821"></a>03821       shape(7) =       L1;
<a name="l03822"></a>03822       shape(2) = L2 - 1.0;
<a name="l03823"></a>03823       shape(9) =       L3;
<a name="l03824"></a>03824    }
<a name="l03825"></a>03825    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L3 &gt;= 1.0) { <span class="comment">// T3</span>
<a name="l03826"></a>03826       shape(6) =       L0;
<a name="l03827"></a>03827       shape(8) =       L1;
<a name="l03828"></a>03828       shape(9) =       L2;
<a name="l03829"></a>03829       shape(3) = L3 - 1.0;
<a name="l03830"></a>03830    }
<a name="l03831"></a>03831    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &lt;= 1.0) &amp;&amp; (L5 &lt;= 1.0)) { <span class="comment">// T4</span>
<a name="l03832"></a>03832       shape(4) = 1.0 - L5;
<a name="l03833"></a>03833       shape(5) =       L2;
<a name="l03834"></a>03834       shape(6) = 1.0 - L4;
<a name="l03835"></a>03835       shape(8) = 1.0 - L0;
<a name="l03836"></a>03836    }
<a name="l03837"></a>03837    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &gt;= 1.0) &amp;&amp; (L5 &lt;= 1.0)) { <span class="comment">// T5</span>
<a name="l03838"></a>03838       shape(4) = 1.0 - L5;
<a name="l03839"></a>03839       shape(5) = 1.0 - L1;
<a name="l03840"></a>03840       shape(7) = L4 - 1.0;
<a name="l03841"></a>03841       shape(8) =       L3;
<a name="l03842"></a>03842    }
<a name="l03843"></a>03843    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &lt;= 1.0) &amp;&amp; (L5 &gt;= 1.0)) { <span class="comment">// T6</span>
<a name="l03844"></a>03844       shape(5) = 1.0 - L3;
<a name="l03845"></a>03845       shape(6) = 1.0 - L4;
<a name="l03846"></a>03846       shape(8) =       L1;
<a name="l03847"></a>03847       shape(9) = L5 - 1.0;
<a name="l03848"></a>03848    }
<a name="l03849"></a>03849    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &gt;= 1.0) &amp;&amp; (L5 &gt;= 1.0)) { <span class="comment">// T7</span>
<a name="l03850"></a>03850       shape(5) =       L0;
<a name="l03851"></a>03851       shape(7) = L4 - 1.0;
<a name="l03852"></a>03852       shape(8) = 1.0 - L2;
<a name="l03853"></a>03853       shape(9) = L5 - 1.0;
<a name="l03854"></a>03854    }
<a name="l03855"></a>03855 }
<a name="l03856"></a>03856 
<a name="l03857"></a><a class="code" href="classRefinedLinear3DFiniteElement.html#a94ee252d8d880375ff3a94778272d374">03857</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedLinear3DFiniteElement.html#a94ee252d8d880375ff3a94778272d374">RefinedLinear3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03858"></a>03858                                               <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l03859"></a>03859 <span class="keyword"></span>{
<a name="l03860"></a>03860    <span class="keywordtype">int</span> i,j;
<a name="l03861"></a>03861 
<a name="l03862"></a>03862    <span class="keywordtype">double</span> L0, L1, L2, L3, L4, L5;
<a name="l03863"></a>03863    L0 = 2.0 * ( 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> );
<a name="l03864"></a>03864    L1 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> );
<a name="l03865"></a>03865    L2 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03866"></a>03866    L3 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> );
<a name="l03867"></a>03867    L4 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> + ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> );
<a name="l03868"></a>03868    L5 = 2.0 * ( ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> + ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> );
<a name="l03869"></a>03869 
<a name="l03870"></a>03870    <span class="keywordtype">double</span> DL0[3], DL1[3], DL2[3], DL3[3], DL4[3], DL5[3];
<a name="l03871"></a>03871    DL0[0] = -2.0; DL0[1] = -2.0; DL0[2] = -2.0;
<a name="l03872"></a>03872    DL1[0] =  2.0; DL1[1] =  0.0; DL1[2] =  0.0;
<a name="l03873"></a>03873    DL2[0] =  0.0; DL2[1] =  2.0; DL2[2] =  0.0;
<a name="l03874"></a>03874    DL3[0] =  0.0; DL3[1] =  0.0; DL3[2] =  2.0;
<a name="l03875"></a>03875    DL4[0] =  2.0; DL4[1] =  2.0; DL4[2] =  0.0;
<a name="l03876"></a>03876    DL5[0] =  0.0; DL5[1] =  2.0; DL5[2] =  2.0;
<a name="l03877"></a>03877 
<a name="l03878"></a>03878    <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++)
<a name="l03879"></a>03879       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)
<a name="l03880"></a>03880          dshape(i,j) = 0.0;
<a name="l03881"></a>03881 
<a name="l03882"></a>03882    <span class="keywordflow">if</span> (L0 &gt;= 1.0) { <span class="comment">// T0</span>
<a name="l03883"></a>03883       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03884"></a>03884          dshape(0,j) = DL0[j];
<a name="l03885"></a>03885          dshape(4,j) = DL1[j];
<a name="l03886"></a>03886          dshape(5,j) = DL2[j];
<a name="l03887"></a>03887          dshape(6,j) = DL3[j];
<a name="l03888"></a>03888       }
<a name="l03889"></a>03889    }
<a name="l03890"></a>03890    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L1 &gt;= 1.0) { <span class="comment">// T1</span>
<a name="l03891"></a>03891       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03892"></a>03892          dshape(4,j) = DL0[j];
<a name="l03893"></a>03893          dshape(1,j) = DL1[j];
<a name="l03894"></a>03894          dshape(7,j) = DL2[j];
<a name="l03895"></a>03895          dshape(8,j) = DL3[j];
<a name="l03896"></a>03896       }
<a name="l03897"></a>03897    }
<a name="l03898"></a>03898    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L2 &gt;= 1.0) { <span class="comment">// T2</span>
<a name="l03899"></a>03899       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03900"></a>03900          dshape(5,j) = DL0[j];
<a name="l03901"></a>03901          dshape(7,j) = DL1[j];
<a name="l03902"></a>03902          dshape(2,j) = DL2[j];
<a name="l03903"></a>03903          dshape(9,j) = DL3[j];
<a name="l03904"></a>03904       }
<a name="l03905"></a>03905    }
<a name="l03906"></a>03906    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (L3 &gt;= 1.0) { <span class="comment">// T3</span>
<a name="l03907"></a>03907       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03908"></a>03908          dshape(6,j) = DL0[j];
<a name="l03909"></a>03909          dshape(8,j) = DL1[j];
<a name="l03910"></a>03910          dshape(9,j) = DL2[j];
<a name="l03911"></a>03911          dshape(3,j) = DL3[j];
<a name="l03912"></a>03912       }
<a name="l03913"></a>03913    }
<a name="l03914"></a>03914    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &lt;= 1.0) &amp;&amp; (L5 &lt;= 1.0)) { <span class="comment">// T4</span>
<a name="l03915"></a>03915       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03916"></a>03916          dshape(4,j) = - DL5[j];
<a name="l03917"></a>03917          dshape(5,j) =   DL2[j];
<a name="l03918"></a>03918          dshape(6,j) = - DL4[j];
<a name="l03919"></a>03919          dshape(8,j) = - DL0[j];
<a name="l03920"></a>03920       }
<a name="l03921"></a>03921    }
<a name="l03922"></a>03922    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &gt;= 1.0) &amp;&amp; (L5 &lt;= 1.0)) { <span class="comment">// T5</span>
<a name="l03923"></a>03923       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03924"></a>03924          dshape(4,j) = - DL5[j];
<a name="l03925"></a>03925          dshape(5,j) = - DL1[j];
<a name="l03926"></a>03926          dshape(7,j) =   DL4[j];
<a name="l03927"></a>03927          dshape(8,j) =   DL3[j];
<a name="l03928"></a>03928       }
<a name="l03929"></a>03929    }
<a name="l03930"></a>03930    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &lt;= 1.0) &amp;&amp; (L5 &gt;= 1.0)) { <span class="comment">// T6</span>
<a name="l03931"></a>03931       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03932"></a>03932          dshape(5,j) = - DL3[j];
<a name="l03933"></a>03933          dshape(6,j) = - DL4[j];
<a name="l03934"></a>03934          dshape(8,j) =   DL1[j];
<a name="l03935"></a>03935          dshape(9,j) =   DL5[j];
<a name="l03936"></a>03936       }
<a name="l03937"></a>03937    }
<a name="l03938"></a>03938    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((L4 &gt;= 1.0) &amp;&amp; (L5 &gt;= 1.0)) { <span class="comment">// T7</span>
<a name="l03939"></a>03939       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++) {
<a name="l03940"></a>03940          dshape(5,j) =   DL0[j];
<a name="l03941"></a>03941          dshape(7,j) =   DL4[j];
<a name="l03942"></a>03942          dshape(8,j) = - DL2[j];
<a name="l03943"></a>03943          dshape(9,j) =   DL5[j];
<a name="l03944"></a>03944       }
<a name="l03945"></a>03945    }
<a name="l03946"></a>03946 }
<a name="l03947"></a>03947 
<a name="l03948"></a>03948 
<a name="l03949"></a><a class="code" href="classRefinedBiLinear2DFiniteElement.html#afa18c99e9f6c468243a8bef8cdd93fe0">03949</a> <a class="code" href="classRefinedBiLinear2DFiniteElement.html#afa18c99e9f6c468243a8bef8cdd93fe0" title="Construct a biquadratic FE on quadrilateral.">RefinedBiLinear2DFiniteElement::RefinedBiLinear2DFiniteElement</a>()
<a name="l03950"></a>03950    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE , 9, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::rQk)
<a name="l03951"></a>03951 {
<a name="l03952"></a>03952    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03953"></a>03953    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03954"></a>03954    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03955"></a>03955    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03956"></a>03956    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03957"></a>03957    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l03958"></a>03958    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03959"></a>03959    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l03960"></a>03960    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03961"></a>03961    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l03962"></a>03962    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l03963"></a>03963    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03964"></a>03964    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03965"></a>03965    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l03966"></a>03966    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l03967"></a>03967    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03968"></a>03968    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l03969"></a>03969    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l03970"></a>03970 }
<a name="l03971"></a>03971 
<a name="l03972"></a><a class="code" href="classRefinedBiLinear2DFiniteElement.html#ab5785562cc6f0c62936b2ae2596a69b4">03972</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedBiLinear2DFiniteElement.html#ab5785562cc6f0c62936b2ae2596a69b4">RefinedBiLinear2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l03973"></a>03973                                                <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l03974"></a>03974 <span class="keyword"></span>{
<a name="l03975"></a>03975    <span class="keywordtype">int</span> i;
<a name="l03976"></a>03976    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l03977"></a>03977    <span class="keywordtype">double</span> Lx, Ly;
<a name="l03978"></a>03978    Lx = 2.0 * ( 1. - x );
<a name="l03979"></a>03979    Ly = 2.0 * ( 1. - y );
<a name="l03980"></a>03980 
<a name="l03981"></a>03981    <span class="comment">// The reference square is split in 4 squares as follows:</span>
<a name="l03982"></a>03982    <span class="comment">//</span>
<a name="l03983"></a>03983    <span class="comment">// T0 - 0,4,7,8</span>
<a name="l03984"></a>03984    <span class="comment">// T1 - 1,4,5,8</span>
<a name="l03985"></a>03985    <span class="comment">// T2 - 2,5,6,8</span>
<a name="l03986"></a>03986    <span class="comment">// T3 - 3,6,7,8</span>
<a name="l03987"></a>03987 
<a name="l03988"></a>03988    <span class="keywordflow">for</span> (i = 0; i &lt; 9; i++)
<a name="l03989"></a>03989       shape(i) = 0.0;
<a name="l03990"></a>03990 
<a name="l03991"></a>03991    <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &lt;= 0.5)) { <span class="comment">// T0</span>
<a name="l03992"></a>03992       shape(0) = (Lx - 1.0) * (Ly - 1.0);
<a name="l03993"></a>03993       shape(4) = (2.0 - Lx) * (Ly - 1.0);
<a name="l03994"></a>03994       shape(8) = (2.0 - Lx) * (2.0 - Ly);
<a name="l03995"></a>03995       shape(7) = (Lx - 1.0) * (2.0 - Ly);
<a name="l03996"></a>03996    }
<a name="l03997"></a>03997    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &lt;= 0.5)) { <span class="comment">// T1</span>
<a name="l03998"></a>03998       shape(4) =        Lx  * (Ly - 1.0);
<a name="l03999"></a>03999       shape(1) = (1.0 - Lx) * (Ly - 1.0);
<a name="l04000"></a>04000       shape(5) = (1.0 - Lx) * (2.0 - Ly);
<a name="l04001"></a>04001       shape(8) =        Lx  * (2.0 - Ly);
<a name="l04002"></a>04002    }
<a name="l04003"></a>04003    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &gt;= 0.5)) { <span class="comment">// T2</span>
<a name="l04004"></a>04004       shape(8) =        Lx  *        Ly ;
<a name="l04005"></a>04005       shape(5) = (1.0 - Lx) *        Ly ;
<a name="l04006"></a>04006       shape(2) = (1.0 - Lx) * (1.0 - Ly);
<a name="l04007"></a>04007       shape(6) =        Lx  * (1.0 - Ly);
<a name="l04008"></a>04008    }
<a name="l04009"></a>04009    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &gt;= 0.5)) { <span class="comment">// T3</span>
<a name="l04010"></a>04010       shape(7) = (Lx - 1.0) *        Ly ;
<a name="l04011"></a>04011       shape(8) = (2.0 - Lx) *        Ly ;
<a name="l04012"></a>04012       shape(6) = (2.0 - Lx) * (1.0 - Ly);
<a name="l04013"></a>04013       shape(3) = (Lx - 1.0) * (1.0 - Ly);
<a name="l04014"></a>04014    }
<a name="l04015"></a>04015 }
<a name="l04016"></a>04016 
<a name="l04017"></a><a class="code" href="classRefinedBiLinear2DFiniteElement.html#af8863917bb1f4c28ab0714db3cc20233">04017</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedBiLinear2DFiniteElement.html#af8863917bb1f4c28ab0714db3cc20233">RefinedBiLinear2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04018"></a>04018                                                 <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l04019"></a>04019 <span class="keyword"></span>{
<a name="l04020"></a>04020    <span class="keywordtype">int</span> i,j;
<a name="l04021"></a>04021    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>;
<a name="l04022"></a>04022    <span class="keywordtype">double</span> Lx, Ly;
<a name="l04023"></a>04023    Lx = 2.0 * ( 1. - x );
<a name="l04024"></a>04024    Ly = 2.0 * ( 1. - y );
<a name="l04025"></a>04025 
<a name="l04026"></a>04026    <span class="keywordflow">for</span> (i = 0; i &lt; 9; i++)
<a name="l04027"></a>04027       <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++)
<a name="l04028"></a>04028          dshape(i,j) = 0.0;
<a name="l04029"></a>04029 
<a name="l04030"></a>04030    <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &lt;= 0.5)) { <span class="comment">// T0</span>
<a name="l04031"></a>04031       dshape(0,0) =  2.0 * (1.0 - Ly);
<a name="l04032"></a>04032       dshape(0,1) =  2.0 * (1.0 - Lx);
<a name="l04033"></a>04033 
<a name="l04034"></a>04034       dshape(4,0) =  2.0 * (Ly - 1.0);
<a name="l04035"></a>04035       dshape(4,1) = -2.0 * (2.0 - Lx);
<a name="l04036"></a>04036 
<a name="l04037"></a>04037       dshape(8,0) =  2.0 * (2.0 - Ly);
<a name="l04038"></a>04038       dshape(8,1) =  2.0 * (2.0 - Lx);
<a name="l04039"></a>04039 
<a name="l04040"></a>04040       dshape(7,0) = -2.0 * (2.0 - Ly);
<a name="l04041"></a>04041       dshape(7,0) =  2.0 * (Lx - 1.0);
<a name="l04042"></a>04042    }
<a name="l04043"></a>04043    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &lt;= 0.5)) { <span class="comment">// T1</span>
<a name="l04044"></a>04044       dshape(4,0) = -2.0 * (Ly - 1.0);
<a name="l04045"></a>04045       dshape(4,1) = -2.0 * Lx;
<a name="l04046"></a>04046 
<a name="l04047"></a>04047       dshape(1,0) =  2.0 * (Ly - 1.0);
<a name="l04048"></a>04048       dshape(1,1) = -2.0 * (1.0 - Lx);
<a name="l04049"></a>04049 
<a name="l04050"></a>04050       dshape(5,0) =  2.0 * (2.0 - Ly);
<a name="l04051"></a>04051       dshape(5,1) =  2.0 * (1.0 - Lx);
<a name="l04052"></a>04052 
<a name="l04053"></a>04053       dshape(8,0) = -2.0 * (2.0 - Ly);
<a name="l04054"></a>04054       dshape(8,1) =  2.0 * Lx;
<a name="l04055"></a>04055    }
<a name="l04056"></a>04056    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &gt;= 0.5)) { <span class="comment">// T2</span>
<a name="l04057"></a>04057       dshape(8,0) = -2.0 * Ly;
<a name="l04058"></a>04058       dshape(8,1) = -2.0 * Lx;
<a name="l04059"></a>04059 
<a name="l04060"></a>04060       dshape(5,0) =  2.0 * Ly;
<a name="l04061"></a>04061       dshape(5,1) = -2.0 * (1.0 - Lx);
<a name="l04062"></a>04062 
<a name="l04063"></a>04063       dshape(2,0) =  2.0 * (1.0 - Ly);
<a name="l04064"></a>04064       dshape(2,1) =  2.0 * (1.0 - Lx);
<a name="l04065"></a>04065 
<a name="l04066"></a>04066       dshape(6,0) = -2.0 * (1.0 - Ly);
<a name="l04067"></a>04067       dshape(6,1) =  2.0 * Lx;
<a name="l04068"></a>04068    }
<a name="l04069"></a>04069    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &gt;= 0.5)) { <span class="comment">// T3</span>
<a name="l04070"></a>04070       dshape(7,0) = -2.0 * Ly;
<a name="l04071"></a>04071       dshape(7,1) = -2.0 * (Lx - 1.0);
<a name="l04072"></a>04072 
<a name="l04073"></a>04073       dshape(8,0) =  2.0 * Ly ;
<a name="l04074"></a>04074       dshape(8,1) = -2.0 * (2.0 - Lx);
<a name="l04075"></a>04075 
<a name="l04076"></a>04076       dshape(6,0) = 2.0 * (1.0 - Ly);
<a name="l04077"></a>04077       dshape(6,1) = 2.0 * (2.0 - Lx);
<a name="l04078"></a>04078 
<a name="l04079"></a>04079       dshape(3,0) = -2.0 * (1.0 - Ly);
<a name="l04080"></a>04080       dshape(3,1) =  2.0 * (Lx - 1.0);
<a name="l04081"></a>04081    }
<a name="l04082"></a>04082 }
<a name="l04083"></a>04083 
<a name="l04084"></a><a class="code" href="classRefinedTriLinear3DFiniteElement.html#a370436fb00d026d88d4638c2a92f3dbc">04084</a> <a class="code" href="classRefinedTriLinear3DFiniteElement.html#a370436fb00d026d88d4638c2a92f3dbc" title="Construct a biquadratic FE on quadrilateral.">RefinedTriLinear3DFiniteElement::RefinedTriLinear3DFiniteElement</a>()
<a name="l04085"></a>04085    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 27, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::rQk)
<a name="l04086"></a>04086 {
<a name="l04087"></a>04087    <span class="keywordtype">double</span> I[27];
<a name="l04088"></a>04088    <span class="keywordtype">double</span> J[27];
<a name="l04089"></a>04089    <span class="keywordtype">double</span> K[27];
<a name="l04090"></a>04090    <span class="comment">// nodes</span>
<a name="l04091"></a>04091    I[ 0] = 0.0; J[ 0] = 0.0; K[ 0] = 0.0;
<a name="l04092"></a>04092    I[ 1] = 1.0; J[ 1] = 0.0; K[ 1] = 0.0;
<a name="l04093"></a>04093    I[ 2] = 1.0; J[ 2] = 1.0; K[ 2] = 0.0;
<a name="l04094"></a>04094    I[ 3] = 0.0; J[ 3] = 1.0; K[ 3] = 0.0;
<a name="l04095"></a>04095    I[ 4] = 0.0; J[ 4] = 0.0; K[ 4] = 1.0;
<a name="l04096"></a>04096    I[ 5] = 1.0; J[ 5] = 0.0; K[ 5] = 1.0;
<a name="l04097"></a>04097    I[ 6] = 1.0; J[ 6] = 1.0; K[ 6] = 1.0;
<a name="l04098"></a>04098    I[ 7] = 0.0; J[ 7] = 1.0; K[ 7] = 1.0;
<a name="l04099"></a>04099    <span class="comment">// edges</span>
<a name="l04100"></a>04100    I[ 8] = 0.5; J[ 8] = 0.0; K[ 8] = 0.0;
<a name="l04101"></a>04101    I[ 9] = 1.0; J[ 9] = 0.5; K[ 9] = 0.0;
<a name="l04102"></a>04102    I[10] = 0.5; J[10] = 1.0; K[10] = 0.0;
<a name="l04103"></a>04103    I[11] = 0.0; J[11] = 0.5; K[11] = 0.0;
<a name="l04104"></a>04104    I[12] = 0.5; J[12] = 0.0; K[12] = 1.0;
<a name="l04105"></a>04105    I[13] = 1.0; J[13] = 0.5; K[13] = 1.0;
<a name="l04106"></a>04106    I[14] = 0.5; J[14] = 1.0; K[14] = 1.0;
<a name="l04107"></a>04107    I[15] = 0.0; J[15] = 0.5; K[15] = 1.0;
<a name="l04108"></a>04108    I[16] = 0.0; J[16] = 0.0; K[16] = 0.5;
<a name="l04109"></a>04109    I[17] = 1.0; J[17] = 0.0; K[17] = 0.5;
<a name="l04110"></a>04110    I[18] = 1.0; J[18] = 1.0; K[18] = 0.5;
<a name="l04111"></a>04111    I[19] = 0.0; J[19] = 1.0; K[19] = 0.5;
<a name="l04112"></a>04112    <span class="comment">// faces</span>
<a name="l04113"></a>04113    I[20] = 0.5; J[20] = 0.5; K[20] = 0.0;
<a name="l04114"></a>04114    I[21] = 0.5; J[21] = 0.0; K[21] = 0.5;
<a name="l04115"></a>04115    I[22] = 1.0; J[22] = 0.5; K[22] = 0.5;
<a name="l04116"></a>04116    I[23] = 0.5; J[23] = 1.0; K[23] = 0.5;
<a name="l04117"></a>04117    I[24] = 0.0; J[24] = 0.5; K[24] = 0.5;
<a name="l04118"></a>04118    I[25] = 0.5; J[25] = 0.5; K[25] = 1.0;
<a name="l04119"></a>04119    <span class="comment">// element</span>
<a name="l04120"></a>04120    I[26] = 0.5; J[26] = 0.5; K[26] = 0.5;
<a name="l04121"></a>04121 
<a name="l04122"></a>04122    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; 27; n++) {
<a name="l04123"></a>04123       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = I[n];
<a name="l04124"></a>04124       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = J[n];
<a name="l04125"></a>04125       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = K[n];
<a name="l04126"></a>04126    }
<a name="l04127"></a>04127 }
<a name="l04128"></a>04128 
<a name="l04129"></a><a class="code" href="classRefinedTriLinear3DFiniteElement.html#ad8e29b0c9dc3ce13c3e25ad1c9574816">04129</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedTriLinear3DFiniteElement.html#ad8e29b0c9dc3ce13c3e25ad1c9574816">RefinedTriLinear3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04130"></a>04130                                                 <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l04131"></a>04131 <span class="keyword"></span>{
<a name="l04132"></a>04132    <span class="keywordtype">int</span> i, N[8];
<a name="l04133"></a>04133    <span class="keywordtype">double</span> Lx, Ly, Lz;
<a name="l04134"></a>04134    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l04135"></a>04135 
<a name="l04136"></a>04136    <span class="keywordflow">for</span> (i = 0; i &lt; 27; i++)
<a name="l04137"></a>04137       shape(i) = 0.0;
<a name="l04138"></a>04138 
<a name="l04139"></a>04139    <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T0</span>
<a name="l04140"></a>04140       Lx = 1.0 - 2.0 * x;
<a name="l04141"></a>04141       Ly = 1.0 - 2.0 * y;
<a name="l04142"></a>04142       Lz = 1.0 - 2.0 * z;
<a name="l04143"></a>04143 
<a name="l04144"></a>04144       N[0] =  0;
<a name="l04145"></a>04145       N[1] =  8;
<a name="l04146"></a>04146       N[2] = 20;
<a name="l04147"></a>04147       N[3] = 11;
<a name="l04148"></a>04148       N[4] = 16;
<a name="l04149"></a>04149       N[5] = 21;
<a name="l04150"></a>04150       N[6] = 26;
<a name="l04151"></a>04151       N[7] = 24;
<a name="l04152"></a>04152    }
<a name="l04153"></a>04153    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T1</span>
<a name="l04154"></a>04154       Lx = 2.0 - 2.0 * x;
<a name="l04155"></a>04155       Ly = 1.0 - 2.0 * y;
<a name="l04156"></a>04156       Lz = 1.0 - 2.0 * z;
<a name="l04157"></a>04157 
<a name="l04158"></a>04158       N[0] =  8;
<a name="l04159"></a>04159       N[1] =  1;
<a name="l04160"></a>04160       N[2] =  9;
<a name="l04161"></a>04161       N[3] = 20;
<a name="l04162"></a>04162       N[4] = 21;
<a name="l04163"></a>04163       N[5] = 17;
<a name="l04164"></a>04164       N[6] = 22;
<a name="l04165"></a>04165       N[7] = 26;
<a name="l04166"></a>04166    }
<a name="l04167"></a>04167    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T2</span>
<a name="l04168"></a>04168       Lx = 2.0 - 2.0 * x;
<a name="l04169"></a>04169       Ly = 2.0 - 2.0 * y;
<a name="l04170"></a>04170       Lz = 1.0 - 2.0 * z;
<a name="l04171"></a>04171 
<a name="l04172"></a>04172       N[0] = 20;
<a name="l04173"></a>04173       N[1] =  9;
<a name="l04174"></a>04174       N[2] =  2;
<a name="l04175"></a>04175       N[3] = 10;
<a name="l04176"></a>04176       N[4] = 26;
<a name="l04177"></a>04177       N[5] = 22;
<a name="l04178"></a>04178       N[6] = 18;
<a name="l04179"></a>04179       N[7] = 23;
<a name="l04180"></a>04180    }
<a name="l04181"></a>04181    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T3</span>
<a name="l04182"></a>04182       Lx = 1.0 - 2.0 * x;
<a name="l04183"></a>04183       Ly = 2.0 - 2.0 * y;
<a name="l04184"></a>04184       Lz = 1.0 - 2.0 * z;
<a name="l04185"></a>04185 
<a name="l04186"></a>04186       N[0] = 11;
<a name="l04187"></a>04187       N[1] = 20;
<a name="l04188"></a>04188       N[2] = 10;
<a name="l04189"></a>04189       N[3] =  3;
<a name="l04190"></a>04190       N[4] = 24;
<a name="l04191"></a>04191       N[5] = 26;
<a name="l04192"></a>04192       N[6] = 23;
<a name="l04193"></a>04193       N[7] = 19;
<a name="l04194"></a>04194    }
<a name="l04195"></a>04195    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T4</span>
<a name="l04196"></a>04196       Lx = 1.0 - 2.0 * x;
<a name="l04197"></a>04197       Ly = 1.0 - 2.0 * y;
<a name="l04198"></a>04198       Lz = 2.0 - 2.0 * z;
<a name="l04199"></a>04199 
<a name="l04200"></a>04200       N[0] = 16;
<a name="l04201"></a>04201       N[1] = 21;
<a name="l04202"></a>04202       N[2] = 26;
<a name="l04203"></a>04203       N[3] = 24;
<a name="l04204"></a>04204       N[4] =  4;
<a name="l04205"></a>04205       N[5] = 12;
<a name="l04206"></a>04206       N[6] = 25;
<a name="l04207"></a>04207       N[7] = 15;
<a name="l04208"></a>04208    }
<a name="l04209"></a>04209    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T5</span>
<a name="l04210"></a>04210       Lx = 2.0 - 2.0 * x;
<a name="l04211"></a>04211       Ly = 1.0 - 2.0 * y;
<a name="l04212"></a>04212       Lz = 2.0 - 2.0 * z;
<a name="l04213"></a>04213 
<a name="l04214"></a>04214       N[0] = 21;
<a name="l04215"></a>04215       N[1] = 17;
<a name="l04216"></a>04216       N[2] = 22;
<a name="l04217"></a>04217       N[3] = 26;
<a name="l04218"></a>04218       N[4] = 12;
<a name="l04219"></a>04219       N[5] =  5;
<a name="l04220"></a>04220       N[6] = 13;
<a name="l04221"></a>04221       N[7] = 25;
<a name="l04222"></a>04222    }
<a name="l04223"></a>04223    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T6</span>
<a name="l04224"></a>04224       Lx = 2.0 - 2.0 * x;
<a name="l04225"></a>04225       Ly = 2.0 - 2.0 * y;
<a name="l04226"></a>04226       Lz = 2.0 - 2.0 * z;
<a name="l04227"></a>04227 
<a name="l04228"></a>04228       N[0] = 26;
<a name="l04229"></a>04229       N[1] = 22;
<a name="l04230"></a>04230       N[2] = 18;
<a name="l04231"></a>04231       N[3] = 23;
<a name="l04232"></a>04232       N[4] = 25;
<a name="l04233"></a>04233       N[5] = 13;
<a name="l04234"></a>04234       N[6] =  6;
<a name="l04235"></a>04235       N[7] = 14;
<a name="l04236"></a>04236    }
<a name="l04237"></a>04237    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T7</span>
<a name="l04238"></a>04238       Lx = 1.0 - 2.0 * x;
<a name="l04239"></a>04239       Ly = 2.0 - 2.0 * y;
<a name="l04240"></a>04240       Lz = 2.0 - 2.0 * z;
<a name="l04241"></a>04241 
<a name="l04242"></a>04242       N[0] = 24;
<a name="l04243"></a>04243       N[1] = 26;
<a name="l04244"></a>04244       N[2] = 23;
<a name="l04245"></a>04245       N[3] = 19;
<a name="l04246"></a>04246       N[4] = 15;
<a name="l04247"></a>04247       N[5] = 25;
<a name="l04248"></a>04248       N[6] = 14;
<a name="l04249"></a>04249       N[7] =  7;
<a name="l04250"></a>04250    }
<a name="l04251"></a>04251 
<a name="l04252"></a>04252    shape(N[0]) = Lx       * Ly       * Lz;
<a name="l04253"></a>04253    shape(N[1]) = (1 - Lx) * Ly       * Lz;
<a name="l04254"></a>04254    shape(N[2]) = (1 - Lx) * (1 - Ly) * Lz;
<a name="l04255"></a>04255    shape(N[3]) = Lx       * (1 - Ly) * Lz;
<a name="l04256"></a>04256    shape(N[4]) = Lx       * Ly       * (1 - Lz);
<a name="l04257"></a>04257    shape(N[5]) = (1 - Lx) * Ly       * (1 - Lz);
<a name="l04258"></a>04258    shape(N[6]) = (1 - Lx) * (1 - Ly) * (1 - Lz);
<a name="l04259"></a>04259    shape(N[7]) = Lx       * (1 - Ly) * (1 - Lz);
<a name="l04260"></a>04260 }
<a name="l04261"></a>04261 
<a name="l04262"></a><a class="code" href="classRefinedTriLinear3DFiniteElement.html#a6514a053f5f7398e5779bd3cf03afeb2">04262</a> <span class="keywordtype">void</span> <a class="code" href="classRefinedTriLinear3DFiniteElement.html#a6514a053f5f7398e5779bd3cf03afeb2">RefinedTriLinear3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04263"></a>04263                                                  <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l04264"></a>04264 <span class="keyword"></span>{
<a name="l04265"></a>04265    <span class="keywordtype">int</span> i, j, N[8];
<a name="l04266"></a>04266    <span class="keywordtype">double</span> Lx, Ly, Lz;
<a name="l04267"></a>04267    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l04268"></a>04268 
<a name="l04269"></a>04269    <span class="keywordflow">for</span> (i = 0; i &lt; 27; i++)
<a name="l04270"></a>04270       <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)
<a name="l04271"></a>04271          dshape(i,j) = 0.0;
<a name="l04272"></a>04272 
<a name="l04273"></a>04273    <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T0</span>
<a name="l04274"></a>04274       Lx = 1.0 - 2.0 * x;
<a name="l04275"></a>04275       Ly = 1.0 - 2.0 * y;
<a name="l04276"></a>04276       Lz = 1.0 - 2.0 * z;
<a name="l04277"></a>04277 
<a name="l04278"></a>04278       N[0] =  0;
<a name="l04279"></a>04279       N[1] =  8;
<a name="l04280"></a>04280       N[2] = 20;
<a name="l04281"></a>04281       N[3] = 11;
<a name="l04282"></a>04282       N[4] = 16;
<a name="l04283"></a>04283       N[5] = 21;
<a name="l04284"></a>04284       N[6] = 26;
<a name="l04285"></a>04285       N[7] = 24;
<a name="l04286"></a>04286    }
<a name="l04287"></a>04287    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T1</span>
<a name="l04288"></a>04288       Lx = 2.0 - 2.0 * x;
<a name="l04289"></a>04289       Ly = 1.0 - 2.0 * y;
<a name="l04290"></a>04290       Lz = 1.0 - 2.0 * z;
<a name="l04291"></a>04291 
<a name="l04292"></a>04292       N[0] =  8;
<a name="l04293"></a>04293       N[1] =  1;
<a name="l04294"></a>04294       N[2] =  9;
<a name="l04295"></a>04295       N[3] = 20;
<a name="l04296"></a>04296       N[4] = 21;
<a name="l04297"></a>04297       N[5] = 17;
<a name="l04298"></a>04298       N[6] = 22;
<a name="l04299"></a>04299       N[7] = 26;
<a name="l04300"></a>04300    }
<a name="l04301"></a>04301    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T2</span>
<a name="l04302"></a>04302       Lx = 2.0 - 2.0 * x;
<a name="l04303"></a>04303       Ly = 2.0 - 2.0 * y;
<a name="l04304"></a>04304       Lz = 1.0 - 2.0 * z;
<a name="l04305"></a>04305 
<a name="l04306"></a>04306       N[0] = 20;
<a name="l04307"></a>04307       N[1] =  9;
<a name="l04308"></a>04308       N[2] =  2;
<a name="l04309"></a>04309       N[3] = 10;
<a name="l04310"></a>04310       N[4] = 26;
<a name="l04311"></a>04311       N[5] = 22;
<a name="l04312"></a>04312       N[6] = 18;
<a name="l04313"></a>04313       N[7] = 23;
<a name="l04314"></a>04314    }
<a name="l04315"></a>04315    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &lt;= 0.5)) { <span class="comment">// T3</span>
<a name="l04316"></a>04316       Lx = 1.0 - 2.0 * x;
<a name="l04317"></a>04317       Ly = 2.0 - 2.0 * y;
<a name="l04318"></a>04318       Lz = 1.0 - 2.0 * z;
<a name="l04319"></a>04319 
<a name="l04320"></a>04320       N[0] = 11;
<a name="l04321"></a>04321       N[1] = 20;
<a name="l04322"></a>04322       N[2] = 10;
<a name="l04323"></a>04323       N[3] =  3;
<a name="l04324"></a>04324       N[4] = 24;
<a name="l04325"></a>04325       N[5] = 26;
<a name="l04326"></a>04326       N[6] = 23;
<a name="l04327"></a>04327       N[7] = 19;
<a name="l04328"></a>04328    }
<a name="l04329"></a>04329    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T4</span>
<a name="l04330"></a>04330       Lx = 1.0 - 2.0 * x;
<a name="l04331"></a>04331       Ly = 1.0 - 2.0 * y;
<a name="l04332"></a>04332       Lz = 2.0 - 2.0 * z;
<a name="l04333"></a>04333 
<a name="l04334"></a>04334       N[0] = 16;
<a name="l04335"></a>04335       N[1] = 21;
<a name="l04336"></a>04336       N[2] = 26;
<a name="l04337"></a>04337       N[3] = 24;
<a name="l04338"></a>04338       N[4] =  4;
<a name="l04339"></a>04339       N[5] = 12;
<a name="l04340"></a>04340       N[6] = 25;
<a name="l04341"></a>04341       N[7] = 15;
<a name="l04342"></a>04342    }
<a name="l04343"></a>04343    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &lt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T5</span>
<a name="l04344"></a>04344       Lx = 2.0 - 2.0 * x;
<a name="l04345"></a>04345       Ly = 1.0 - 2.0 * y;
<a name="l04346"></a>04346       Lz = 2.0 - 2.0 * z;
<a name="l04347"></a>04347 
<a name="l04348"></a>04348       N[0] = 21;
<a name="l04349"></a>04349       N[1] = 17;
<a name="l04350"></a>04350       N[2] = 22;
<a name="l04351"></a>04351       N[3] = 26;
<a name="l04352"></a>04352       N[4] = 12;
<a name="l04353"></a>04353       N[5] =  5;
<a name="l04354"></a>04354       N[6] = 13;
<a name="l04355"></a>04355       N[7] = 25;
<a name="l04356"></a>04356    }
<a name="l04357"></a>04357    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &lt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T6</span>
<a name="l04358"></a>04358       Lx = 2.0 - 2.0 * x;
<a name="l04359"></a>04359       Ly = 2.0 - 2.0 * y;
<a name="l04360"></a>04360       Lz = 2.0 - 2.0 * z;
<a name="l04361"></a>04361 
<a name="l04362"></a>04362       N[0] = 26;
<a name="l04363"></a>04363       N[1] = 22;
<a name="l04364"></a>04364       N[2] = 18;
<a name="l04365"></a>04365       N[3] = 23;
<a name="l04366"></a>04366       N[4] = 25;
<a name="l04367"></a>04367       N[5] = 13;
<a name="l04368"></a>04368       N[6] =  6;
<a name="l04369"></a>04369       N[7] = 14;
<a name="l04370"></a>04370    }
<a name="l04371"></a>04371    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((x &gt;= 0.5) &amp;&amp; (y &gt;= 0.5) &amp;&amp; (z &gt;= 0.5)) { <span class="comment">// T7</span>
<a name="l04372"></a>04372       Lx = 1.0 - 2.0 * x;
<a name="l04373"></a>04373       Ly = 2.0 - 2.0 * y;
<a name="l04374"></a>04374       Lz = 2.0 - 2.0 * z;
<a name="l04375"></a>04375 
<a name="l04376"></a>04376       N[0] = 24;
<a name="l04377"></a>04377       N[1] = 26;
<a name="l04378"></a>04378       N[2] = 23;
<a name="l04379"></a>04379       N[3] = 19;
<a name="l04380"></a>04380       N[4] = 15;
<a name="l04381"></a>04381       N[5] = 25;
<a name="l04382"></a>04382       N[6] = 14;
<a name="l04383"></a>04383       N[7] =  7;
<a name="l04384"></a>04384    }
<a name="l04385"></a>04385 
<a name="l04386"></a>04386    dshape(N[0],0) = -2.0 * Ly       * Lz      ;
<a name="l04387"></a>04387    dshape(N[0],1) = -2.0 * Lx       * Lz      ;
<a name="l04388"></a>04388    dshape(N[0],2) = -2.0 * Lx       * Ly      ;
<a name="l04389"></a>04389 
<a name="l04390"></a>04390    dshape(N[1],0) =  2.0 * Ly       * Lz      ;
<a name="l04391"></a>04391    dshape(N[1],1) = -2.0 * (1 - Lx) * Lz      ;
<a name="l04392"></a>04392    dshape(N[1],2) = -2.0 * (1 - Lx) * Ly      ;
<a name="l04393"></a>04393 
<a name="l04394"></a>04394    dshape(N[2],0) =  2.0 * (1 - Ly) * Lz      ;
<a name="l04395"></a>04395    dshape(N[2],1) =  2.0 * (1 - Lx) * Lz      ;
<a name="l04396"></a>04396    dshape(N[2],2) = -2.0 * (1 - Lx) * (1 - Ly);
<a name="l04397"></a>04397 
<a name="l04398"></a>04398    dshape(N[3],0) = -2.0 * (1 - Ly) * Lz      ;
<a name="l04399"></a>04399    dshape(N[3],1) =  2.0 * Lx       * Lz      ;
<a name="l04400"></a>04400    dshape(N[3],2) = -2.0 * Lx       * (1 - Ly);
<a name="l04401"></a>04401 
<a name="l04402"></a>04402    dshape(N[4],0) = -2.0 * Ly       * (1 - Lz);
<a name="l04403"></a>04403    dshape(N[4],1) = -2.0 * Lx       * (1 - Lz);
<a name="l04404"></a>04404    dshape(N[4],2) =  2.0 * Lx       * Ly      ;
<a name="l04405"></a>04405 
<a name="l04406"></a>04406    dshape(N[5],0) =  2.0 * Ly       * (1 - Lz);
<a name="l04407"></a>04407    dshape(N[5],1) = -2.0 * (1 - Lx) * (1 - Lz);
<a name="l04408"></a>04408    dshape(N[5],2) =  2.0 * (1 - Lx) * Ly      ;
<a name="l04409"></a>04409 
<a name="l04410"></a>04410    dshape(N[6],0) =  2.0 * (1 - Ly) * (1 - Lz);
<a name="l04411"></a>04411    dshape(N[6],1) =  2.0 * (1 - Lx) * (1 - Lz);
<a name="l04412"></a>04412    dshape(N[6],2) =  2.0 * (1 - Lx) * (1 - Ly);
<a name="l04413"></a>04413 
<a name="l04414"></a>04414    dshape(N[7],0) = -2.0 * (1 - Ly) * (1 - Lz);
<a name="l04415"></a>04415    dshape(N[7],1) =  2.0 * Lx       * (1 - Lz);
<a name="l04416"></a>04416    dshape(N[7],2) =  2.0 * Lx       * (1 - Ly);
<a name="l04417"></a>04417 }
<a name="l04418"></a>04418 
<a name="l04419"></a>04419 
<a name="l04420"></a><a class="code" href="classNedelec1HexFiniteElement.html#a2015888f1951f5906a4b9f7aeb8bf7e2">04420</a> <a class="code" href="classNedelec1HexFiniteElement.html#a2015888f1951f5906a4b9f7aeb8bf7e2">Nedelec1HexFiniteElement::Nedelec1HexFiniteElement</a>()
<a name="l04421"></a>04421    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 12, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l04422"></a>04422 {
<a name="l04423"></a>04423    <span class="comment">// not real nodes ...</span>
<a name="l04424"></a>04424    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04425"></a>04425    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04426"></a>04426    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04427"></a>04427 
<a name="l04428"></a>04428    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l04429"></a>04429    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04430"></a>04430    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04431"></a>04431 
<a name="l04432"></a>04432    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04433"></a>04433    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l04434"></a>04434    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04435"></a>04435 
<a name="l04436"></a>04436    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04437"></a>04437    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04438"></a>04438    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04439"></a>04439 
<a name="l04440"></a>04440    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04441"></a>04441    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04442"></a>04442    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l04443"></a>04443 
<a name="l04444"></a>04444    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l04445"></a>04445    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04446"></a>04446    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l04447"></a>04447 
<a name="l04448"></a>04448    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04449"></a>04449    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l04450"></a>04450    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l04451"></a>04451 
<a name="l04452"></a>04452    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04453"></a>04453    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04454"></a>04454    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l04455"></a>04455 
<a name="l04456"></a>04456    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04457"></a>04457    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04458"></a>04458    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04459"></a>04459 
<a name="l04460"></a>04460    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l04461"></a>04461    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04462"></a>04462    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04463"></a>04463 
<a name="l04464"></a>04464    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>= 1.0;
<a name="l04465"></a>04465    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>= 1.0;
<a name="l04466"></a>04466    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>= 0.5;
<a name="l04467"></a>04467 
<a name="l04468"></a>04468    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>= 0.0;
<a name="l04469"></a>04469    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>= 1.0;
<a name="l04470"></a>04470    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>= 0.5;
<a name="l04471"></a>04471 }
<a name="l04472"></a>04472 
<a name="l04473"></a><a class="code" href="classNedelec1HexFiniteElement.html#a248febce186fc9ad7a023e60491cc036">04473</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1HexFiniteElement.html#a248febce186fc9ad7a023e60491cc036">Nedelec1HexFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04474"></a>04474                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l04475"></a>04475 <span class="keyword"></span>{
<a name="l04476"></a>04476    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l04477"></a>04477 
<a name="l04478"></a>04478    shape(0,0) = (1. - y) * (1. - z);
<a name="l04479"></a>04479    shape(0,1) = 0.;
<a name="l04480"></a>04480    shape(0,2) = 0.;
<a name="l04481"></a>04481 
<a name="l04482"></a>04482    shape(2,0) = y * (1. - z);
<a name="l04483"></a>04483    shape(2,1) = 0.;
<a name="l04484"></a>04484    shape(2,2) = 0.;
<a name="l04485"></a>04485 
<a name="l04486"></a>04486    shape(4,0) = z * (1. - y);
<a name="l04487"></a>04487    shape(4,1) = 0.;
<a name="l04488"></a>04488    shape(4,2) = 0.;
<a name="l04489"></a>04489 
<a name="l04490"></a>04490    shape(6,0) = y * z;
<a name="l04491"></a>04491    shape(6,1) = 0.;
<a name="l04492"></a>04492    shape(6,2) = 0.;
<a name="l04493"></a>04493 
<a name="l04494"></a>04494    shape(1,0) = 0.;
<a name="l04495"></a>04495    shape(1,1) = x * (1. - z);
<a name="l04496"></a>04496    shape(1,2) = 0.;
<a name="l04497"></a>04497 
<a name="l04498"></a>04498    shape(3,0) = 0.;
<a name="l04499"></a>04499    shape(3,1) = (1. - x) * (1. - z);
<a name="l04500"></a>04500    shape(3,2) = 0.;
<a name="l04501"></a>04501 
<a name="l04502"></a>04502    shape(5,0) = 0.;
<a name="l04503"></a>04503    shape(5,1) = x * z;
<a name="l04504"></a>04504    shape(5,2) = 0.;
<a name="l04505"></a>04505 
<a name="l04506"></a>04506    shape(7,0) = 0.;
<a name="l04507"></a>04507    shape(7,1) = (1. - x) * z;
<a name="l04508"></a>04508    shape(7,2) = 0.;
<a name="l04509"></a>04509 
<a name="l04510"></a>04510    shape(8,0) = 0.;
<a name="l04511"></a>04511    shape(8,1) = 0.;
<a name="l04512"></a>04512    shape(8,2) = (1. - x) * (1. - y);
<a name="l04513"></a>04513 
<a name="l04514"></a>04514    shape(9,0) = 0.;
<a name="l04515"></a>04515    shape(9,1) = 0.;
<a name="l04516"></a>04516    shape(9,2) = x * (1. - y);
<a name="l04517"></a>04517 
<a name="l04518"></a>04518    shape(10,0) = 0.;
<a name="l04519"></a>04519    shape(10,1) = 0.;
<a name="l04520"></a>04520    shape(10,2) = x * y;
<a name="l04521"></a>04521 
<a name="l04522"></a>04522    shape(11,0) = 0.;
<a name="l04523"></a>04523    shape(11,1) = 0.;
<a name="l04524"></a>04524    shape(11,2) = y * (1. - x);
<a name="l04525"></a>04525 
<a name="l04526"></a>04526 }
<a name="l04527"></a>04527 
<a name="l04528"></a><a class="code" href="classNedelec1HexFiniteElement.html#a0b971523cc39d5c9f4d0475fb93ad97e">04528</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1HexFiniteElement.html#a0b971523cc39d5c9f4d0475fb93ad97e">Nedelec1HexFiniteElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04529"></a>04529                                              <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"></span>
<a name="l04530"></a>04530 <span class="keyword">   const</span>
<a name="l04531"></a>04531 <span class="keyword"></span>{
<a name="l04532"></a>04532    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l04533"></a>04533 
<a name="l04534"></a>04534    curl_shape(0,0) = 0.;
<a name="l04535"></a>04535    curl_shape(0,1) = y - 1.;
<a name="l04536"></a>04536    curl_shape(0,2) = 1. - z;
<a name="l04537"></a>04537 
<a name="l04538"></a>04538    curl_shape(2,0) = 0.;
<a name="l04539"></a>04539    curl_shape(2,1) = -y;
<a name="l04540"></a>04540    curl_shape(2,2) = z - 1.;
<a name="l04541"></a>04541 
<a name="l04542"></a>04542    curl_shape(4,0) = 0;
<a name="l04543"></a>04543    curl_shape(4,1) = 1. - y;
<a name="l04544"></a>04544    curl_shape(4,2) = z;
<a name="l04545"></a>04545 
<a name="l04546"></a>04546    curl_shape(6,0) = 0.;
<a name="l04547"></a>04547    curl_shape(6,1) = y;
<a name="l04548"></a>04548    curl_shape(6,2) = -z;
<a name="l04549"></a>04549 
<a name="l04550"></a>04550    curl_shape(1,0) = x;
<a name="l04551"></a>04551    curl_shape(1,1) = 0.;
<a name="l04552"></a>04552    curl_shape(1,2) = 1. - z;
<a name="l04553"></a>04553 
<a name="l04554"></a>04554    curl_shape(3,0) = 1. - x;
<a name="l04555"></a>04555    curl_shape(3,1) = 0.;
<a name="l04556"></a>04556    curl_shape(3,2) = z - 1.;
<a name="l04557"></a>04557 
<a name="l04558"></a>04558    curl_shape(5,0) = -x;
<a name="l04559"></a>04559    curl_shape(5,1) = 0.;
<a name="l04560"></a>04560    curl_shape(5,2) = z;
<a name="l04561"></a>04561 
<a name="l04562"></a>04562    curl_shape(7,0) = x - 1.;
<a name="l04563"></a>04563    curl_shape(7,1) = 0.;
<a name="l04564"></a>04564    curl_shape(7,2) = -z;
<a name="l04565"></a>04565 
<a name="l04566"></a>04566    curl_shape(8,0) = x - 1.;
<a name="l04567"></a>04567    curl_shape(8,1) = 1. - y;
<a name="l04568"></a>04568    curl_shape(8,2) = 0.;
<a name="l04569"></a>04569 
<a name="l04570"></a>04570    curl_shape(9,0) = -x;
<a name="l04571"></a>04571    curl_shape(9,1) = y - 1.;
<a name="l04572"></a>04572    curl_shape(9,2) = 0;
<a name="l04573"></a>04573 
<a name="l04574"></a>04574    curl_shape(10,0) = x;
<a name="l04575"></a>04575    curl_shape(10,1) = -y;
<a name="l04576"></a>04576    curl_shape(10,2) = 0.;
<a name="l04577"></a>04577 
<a name="l04578"></a>04578    curl_shape(11,0) = 1. - x;
<a name="l04579"></a>04579    curl_shape(11,1) = y;
<a name="l04580"></a>04580    curl_shape(11,2) = 0.;
<a name="l04581"></a>04581 }
<a name="l04582"></a>04582 
<a name="l04583"></a>04583 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">Nedelec1HexFiniteElement::tk</a>[12][3] =
<a name="l04584"></a>04584 {{1,0,0}, {0,1,0}, {1,0,0}, {0,1,0},
<a name="l04585"></a>04585  {1,0,0}, {0,1,0}, {1,0,0}, {0,1,0},
<a name="l04586"></a>04586  {0,0,1}, {0,0,1}, {0,0,1}, {0,0,1}};
<a name="l04587"></a>04587 
<a name="l04588"></a><a class="code" href="classNedelec1HexFiniteElement.html#a5d195e3c68fde7d829ca7405a9aaa348">04588</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1HexFiniteElement.html#a5d195e3c68fde7d829ca7405a9aaa348">Nedelec1HexFiniteElement::GetLocalInterpolation</a> (
<a name="l04589"></a>04589    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l04590"></a>04590 <span class="keyword"></span>{
<a name="l04591"></a>04591    <span class="keywordtype">int</span> k, j;
<a name="l04592"></a>04592 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l04593"></a>04593 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l04594"></a>04594 <span class="preprocessor">#endif</span>
<a name="l04595"></a>04595 <span class="preprocessor"></span>
<a name="l04596"></a>04596 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l04597"></a>04597 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 12; k++)
<a name="l04598"></a>04598    {
<a name="l04599"></a>04599       <a class="code" href="classNedelec1HexFiniteElement.html#a248febce186fc9ad7a023e60491cc036">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l04600"></a>04600       <span class="keywordflow">for</span> (j = 0; j &lt; 12; j++)
<a name="l04601"></a>04601       {
<a name="l04602"></a>04602          <span class="keywordtype">double</span> d = ( <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][0] + <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][1] +
<a name="l04603"></a>04603                       <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][2] );
<a name="l04604"></a>04604          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l04605"></a>04605          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l04606"></a>04606          {
<a name="l04607"></a>04607             cerr &lt;&lt; <span class="stringliteral">&quot;Nedelec1HexFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l04608"></a>04608                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l04609"></a>04609             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l04610"></a>04610          }
<a name="l04611"></a>04611       }
<a name="l04612"></a>04612    }
<a name="l04613"></a>04613 <span class="preprocessor">#endif</span>
<a name="l04614"></a>04614 <span class="preprocessor"></span>
<a name="l04615"></a>04615    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l04616"></a>04616    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04617"></a>04617    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l04618"></a>04618    <span class="comment">// Trans must be linear (more to have embedding?)</span>
<a name="l04619"></a>04619    <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;J = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>();
<a name="l04620"></a>04620    <span class="keywordtype">double</span> vk[3];
<a name="l04621"></a>04621    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l04622"></a>04622 
<a name="l04623"></a>04623    <span class="keywordflow">for</span> (k = 0; k &lt; 12; k++)
<a name="l04624"></a>04624    {
<a name="l04625"></a>04625       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l04626"></a>04626       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1]; ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = vk[2];
<a name="l04627"></a>04627       <a class="code" href="classNedelec1HexFiniteElement.html#a248febce186fc9ad7a023e60491cc036">CalcVShape</a> (ip, vshape);
<a name="l04628"></a>04628       <span class="comment">//  vk = J tk</span>
<a name="l04629"></a>04629       vk[0] = J(0,0)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][0]+J(0,1)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][1]+J(0,2)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][2];
<a name="l04630"></a>04630       vk[1] = J(1,0)*tk[k][0]+J(1,1)*tk[k][1]+J(1,2)*tk[k][2];
<a name="l04631"></a>04631       vk[2] = J(2,0)*tk[k][0]+J(2,1)*tk[k][1]+J(2,2)*tk[k][2];
<a name="l04632"></a>04632       <span class="keywordflow">for</span> (j = 0; j &lt; 12; j++)
<a name="l04633"></a>04633          <span class="keywordflow">if</span> (fabs (I(k,j) = (<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]+
<a name="l04634"></a>04634                              <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*vk[2])) &lt; 1.0e-12)
<a name="l04635"></a>04635             I(k,j) = 0.0;
<a name="l04636"></a>04636    }
<a name="l04637"></a>04637 }
<a name="l04638"></a>04638 
<a name="l04639"></a><a class="code" href="classNedelec1HexFiniteElement.html#ac46c538cb2791f5545e028d162cfc509">04639</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1HexFiniteElement.html#ac46c538cb2791f5545e028d162cfc509">Nedelec1HexFiniteElement::Project</a> (
<a name="l04640"></a>04640    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l04641"></a>04641    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l04642"></a>04642 <span class="keyword"></span>{
<a name="l04643"></a>04643    <span class="keywordtype">double</span> vk[3];
<a name="l04644"></a>04644    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l04645"></a>04645 
<a name="l04646"></a>04646    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 12; k++)
<a name="l04647"></a>04647    {
<a name="l04648"></a>04648       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l04649"></a>04649       <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;J = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>();
<a name="l04650"></a>04650 
<a name="l04651"></a>04651       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l04652"></a>04652       <span class="comment">//  xk^t J tk</span>
<a name="l04653"></a>04653       dofs(k) =
<a name="l04654"></a>04654          vk[0] * ( J(0,0)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][0]+J(0,1)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][1]+J(0,2)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][2] ) +
<a name="l04655"></a>04655          vk[1] * ( J(1,0)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][0]+J(1,1)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][1]+J(1,2)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][2] ) +
<a name="l04656"></a>04656          vk[2] * ( J(2,0)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][0]+J(2,1)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][1]+J(2,2)*<a class="code" href="classNedelec1HexFiniteElement.html#a3274eff7ee039f4ecb84ca5262e9cab4">tk</a>[k][2] );
<a name="l04657"></a>04657    }
<a name="l04658"></a>04658 }
<a name="l04659"></a>04659 
<a name="l04660"></a>04660 
<a name="l04661"></a><a class="code" href="classNedelec1TetFiniteElement.html#a0dad80965d78d621e6a1f2918c3b3f6b">04661</a> <a class="code" href="classNedelec1TetFiniteElement.html#a0dad80965d78d621e6a1f2918c3b3f6b">Nedelec1TetFiniteElement::Nedelec1TetFiniteElement</a>()
<a name="l04662"></a>04662    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 6, 1)
<a name="l04663"></a>04663 {
<a name="l04664"></a>04664    <span class="comment">// not real nodes ...</span>
<a name="l04665"></a>04665    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04666"></a>04666    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04667"></a>04667    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04668"></a>04668 
<a name="l04669"></a>04669    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04670"></a>04670    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04671"></a>04671    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04672"></a>04672 
<a name="l04673"></a>04673    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04674"></a>04674    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04675"></a>04675    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04676"></a>04676 
<a name="l04677"></a>04677    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04678"></a>04678    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04679"></a>04679    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04680"></a>04680 
<a name="l04681"></a>04681    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04682"></a>04682    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04683"></a>04683    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04684"></a>04684 
<a name="l04685"></a>04685    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04686"></a>04686    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04687"></a>04687    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04688"></a>04688 }
<a name="l04689"></a>04689 
<a name="l04690"></a><a class="code" href="classNedelec1TetFiniteElement.html#ad1b91cbb5116042802f4c6521f9a1b4f">04690</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1TetFiniteElement.html#ad1b91cbb5116042802f4c6521f9a1b4f">Nedelec1TetFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04691"></a>04691                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l04692"></a>04692 <span class="keyword"></span>{
<a name="l04693"></a>04693    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l04694"></a>04694 
<a name="l04695"></a>04695    shape(0,0) = 1. - y - z;
<a name="l04696"></a>04696    shape(0,1) = x;
<a name="l04697"></a>04697    shape(0,2) = x;
<a name="l04698"></a>04698 
<a name="l04699"></a>04699    shape(1,0) = y;
<a name="l04700"></a>04700    shape(1,1) = 1. - x - z;
<a name="l04701"></a>04701    shape(1,2) = y;
<a name="l04702"></a>04702 
<a name="l04703"></a>04703    shape(2,0) = z;
<a name="l04704"></a>04704    shape(2,1) = z;
<a name="l04705"></a>04705    shape(2,2) = 1. - x - y;
<a name="l04706"></a>04706 
<a name="l04707"></a>04707    shape(3,0) = -y;
<a name="l04708"></a>04708    shape(3,1) = x;
<a name="l04709"></a>04709    shape(3,2) = 0.;
<a name="l04710"></a>04710 
<a name="l04711"></a>04711    shape(4,0) = -z;
<a name="l04712"></a>04712    shape(4,1) = 0.;
<a name="l04713"></a>04713    shape(4,2) = x;
<a name="l04714"></a>04714 
<a name="l04715"></a>04715    shape(5,0) = 0.;
<a name="l04716"></a>04716    shape(5,1) = -z;
<a name="l04717"></a>04717    shape(5,2) = y;
<a name="l04718"></a>04718 }
<a name="l04719"></a>04719 
<a name="l04720"></a><a class="code" href="classNedelec1TetFiniteElement.html#a5bb8195d191f88b95f6fe12647fd24ab">04720</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1TetFiniteElement.html#a5bb8195d191f88b95f6fe12647fd24ab">Nedelec1TetFiniteElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04721"></a>04721                                              <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"></span>
<a name="l04722"></a>04722 <span class="keyword">   const</span>
<a name="l04723"></a>04723 <span class="keyword"></span>{
<a name="l04724"></a>04724    curl_shape(0,0) =  0.;
<a name="l04725"></a>04725    curl_shape(0,1) = -2.;
<a name="l04726"></a>04726    curl_shape(0,2) =  2.;
<a name="l04727"></a>04727 
<a name="l04728"></a>04728    curl_shape(1,0) =  2.;
<a name="l04729"></a>04729    curl_shape(1,1) =  0.;
<a name="l04730"></a>04730    curl_shape(1,2) = -2.;
<a name="l04731"></a>04731 
<a name="l04732"></a>04732    curl_shape(2,0) = -2.;
<a name="l04733"></a>04733    curl_shape(2,1) =  2.;
<a name="l04734"></a>04734    curl_shape(2,2) =  0.;
<a name="l04735"></a>04735 
<a name="l04736"></a>04736    curl_shape(3,0) = 0.;
<a name="l04737"></a>04737    curl_shape(3,1) = 0.;
<a name="l04738"></a>04738    curl_shape(3,2) = 2.;
<a name="l04739"></a>04739 
<a name="l04740"></a>04740    curl_shape(4,0) =  0.;
<a name="l04741"></a>04741    curl_shape(4,1) = -2.;
<a name="l04742"></a>04742    curl_shape(4,2) =  0.;
<a name="l04743"></a>04743 
<a name="l04744"></a>04744    curl_shape(5,0) = 2.;
<a name="l04745"></a>04745    curl_shape(5,1) = 0.;
<a name="l04746"></a>04746    curl_shape(5,2) = 0.;
<a name="l04747"></a>04747 }
<a name="l04748"></a>04748 
<a name="l04749"></a>04749 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">Nedelec1TetFiniteElement::tk</a>[6][3] =
<a name="l04750"></a>04750 {{1,0,0}, {0,1,0}, {0,0,1}, {-1,1,0}, {-1,0,1}, {0,-1,1}};
<a name="l04751"></a>04751 
<a name="l04752"></a><a class="code" href="classNedelec1TetFiniteElement.html#a5540ae57fb065a9a0aec3c151d5f806b">04752</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1TetFiniteElement.html#a5540ae57fb065a9a0aec3c151d5f806b">Nedelec1TetFiniteElement::GetLocalInterpolation</a> (
<a name="l04753"></a>04753    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l04754"></a>04754 <span class="keyword"></span>{
<a name="l04755"></a>04755    <span class="keywordtype">int</span> k, j;
<a name="l04756"></a>04756 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l04757"></a>04757 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l04758"></a>04758 <span class="preprocessor">#endif</span>
<a name="l04759"></a>04759 <span class="preprocessor"></span>
<a name="l04760"></a>04760 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l04761"></a>04761 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 6; k++)
<a name="l04762"></a>04762    {
<a name="l04763"></a>04763       <a class="code" href="classNedelec1TetFiniteElement.html#ad1b91cbb5116042802f4c6521f9a1b4f">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l04764"></a>04764       <span class="keywordflow">for</span> (j = 0; j &lt; 6; j++)
<a name="l04765"></a>04765       {
<a name="l04766"></a>04766          <span class="keywordtype">double</span> d = ( <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][0] + <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][1] +
<a name="l04767"></a>04767                       <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][2] );
<a name="l04768"></a>04768          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l04769"></a>04769          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l04770"></a>04770          {
<a name="l04771"></a>04771             cerr &lt;&lt; <span class="stringliteral">&quot;Nedelec1TetFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l04772"></a>04772                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l04773"></a>04773             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l04774"></a>04774          }
<a name="l04775"></a>04775       }
<a name="l04776"></a>04776    }
<a name="l04777"></a>04777 <span class="preprocessor">#endif</span>
<a name="l04778"></a>04778 <span class="preprocessor"></span>
<a name="l04779"></a>04779    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l04780"></a>04780    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04781"></a>04781    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l04782"></a>04782    <span class="comment">// Trans must be linear</span>
<a name="l04783"></a>04783    <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;J = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>();
<a name="l04784"></a>04784    <span class="keywordtype">double</span> vk[3];
<a name="l04785"></a>04785    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l04786"></a>04786 
<a name="l04787"></a>04787    <span class="keywordflow">for</span> (k = 0; k &lt; 6; k++)
<a name="l04788"></a>04788    {
<a name="l04789"></a>04789       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l04790"></a>04790       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1]; ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = vk[2];
<a name="l04791"></a>04791       <a class="code" href="classNedelec1TetFiniteElement.html#ad1b91cbb5116042802f4c6521f9a1b4f">CalcVShape</a> (ip, vshape);
<a name="l04792"></a>04792       <span class="comment">//  vk = J tk</span>
<a name="l04793"></a>04793       vk[0] = J(0,0)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][0]+J(0,1)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][1]+J(0,2)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][2];
<a name="l04794"></a>04794       vk[1] = J(1,0)*tk[k][0]+J(1,1)*tk[k][1]+J(1,2)*tk[k][2];
<a name="l04795"></a>04795       vk[2] = J(2,0)*tk[k][0]+J(2,1)*tk[k][1]+J(2,2)*tk[k][2];
<a name="l04796"></a>04796       <span class="keywordflow">for</span> (j = 0; j &lt; 6; j++)
<a name="l04797"></a>04797          <span class="keywordflow">if</span> (fabs (I(k,j) = (<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]+
<a name="l04798"></a>04798                              <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*vk[2])) &lt; 1.0e-12)
<a name="l04799"></a>04799             I(k,j) = 0.0;
<a name="l04800"></a>04800    }
<a name="l04801"></a>04801 }
<a name="l04802"></a>04802 
<a name="l04803"></a><a class="code" href="classNedelec1TetFiniteElement.html#ab34734a5e6a37ab78825c23cd162684b">04803</a> <span class="keywordtype">void</span> <a class="code" href="classNedelec1TetFiniteElement.html#ab34734a5e6a37ab78825c23cd162684b">Nedelec1TetFiniteElement::Project</a> (
<a name="l04804"></a>04804    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l04805"></a>04805    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l04806"></a>04806 <span class="keyword"></span>{
<a name="l04807"></a>04807    <span class="keywordtype">double</span> vk[3];
<a name="l04808"></a>04808    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l04809"></a>04809 
<a name="l04810"></a>04810    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 6; k++)
<a name="l04811"></a>04811    {
<a name="l04812"></a>04812       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l04813"></a>04813       <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;J = Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>();
<a name="l04814"></a>04814 
<a name="l04815"></a>04815       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l04816"></a>04816       <span class="comment">//  xk^t J tk</span>
<a name="l04817"></a>04817       dofs(k) =
<a name="l04818"></a>04818          vk[0] * ( J(0,0)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][0]+J(0,1)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][1]+J(0,2)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][2] ) +
<a name="l04819"></a>04819          vk[1] * ( J(1,0)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][0]+J(1,1)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][1]+J(1,2)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][2] ) +
<a name="l04820"></a>04820          vk[2] * ( J(2,0)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][0]+J(2,1)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][1]+J(2,2)*<a class="code" href="classNedelec1TetFiniteElement.html#a3235a5b6b3a7cfc10aa5e086d9132ceb">tk</a>[k][2] );
<a name="l04821"></a>04821    }
<a name="l04822"></a>04822 }
<a name="l04823"></a>04823 
<a name="l04824"></a><a class="code" href="classRT0HexFiniteElement.html#a8291101d658137eb8c024e217d89ac0a">04824</a> <a class="code" href="classRT0HexFiniteElement.html#a8291101d658137eb8c024e217d89ac0a">RT0HexFiniteElement::RT0HexFiniteElement</a>()
<a name="l04825"></a>04825    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 6, 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l04826"></a>04826 {
<a name="l04827"></a>04827    <span class="comment">// not real nodes ...</span>
<a name="l04828"></a>04828    <span class="comment">// z = 0, y = 0, x = 1, y = 1, x = 0, z = 1</span>
<a name="l04829"></a>04829    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04830"></a>04830    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04831"></a>04831    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04832"></a>04832 
<a name="l04833"></a>04833    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04834"></a>04834    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l04835"></a>04835    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04836"></a>04836 
<a name="l04837"></a>04837    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l04838"></a>04838    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04839"></a>04839    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04840"></a>04840 
<a name="l04841"></a>04841    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04842"></a>04842    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l04843"></a>04843    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04844"></a>04844 
<a name="l04845"></a>04845    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l04846"></a>04846    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04847"></a>04847    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l04848"></a>04848 
<a name="l04849"></a>04849    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l04850"></a>04850    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l04851"></a>04851    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l04852"></a>04852 }
<a name="l04853"></a>04853 
<a name="l04854"></a><a class="code" href="classRT0HexFiniteElement.html#acaec3424447cd9b92303ea40faa7f7b8">04854</a> <span class="keywordtype">void</span> <a class="code" href="classRT0HexFiniteElement.html#acaec3424447cd9b92303ea40faa7f7b8">RT0HexFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04855"></a>04855                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l04856"></a>04856 <span class="keyword"></span>{
<a name="l04857"></a>04857    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l04858"></a>04858    <span class="comment">// z = 0</span>
<a name="l04859"></a>04859    shape(0,0) = 0.;
<a name="l04860"></a>04860    shape(0,1) = 0.;
<a name="l04861"></a>04861    shape(0,2) = z - 1.;
<a name="l04862"></a>04862    <span class="comment">// y = 0</span>
<a name="l04863"></a>04863    shape(1,0) = 0.;
<a name="l04864"></a>04864    shape(1,1) = y - 1.;
<a name="l04865"></a>04865    shape(1,2) = 0.;
<a name="l04866"></a>04866    <span class="comment">// x = 1</span>
<a name="l04867"></a>04867    shape(2,0) = x;
<a name="l04868"></a>04868    shape(2,1) = 0.;
<a name="l04869"></a>04869    shape(2,2) = 0.;
<a name="l04870"></a>04870    <span class="comment">// y = 1</span>
<a name="l04871"></a>04871    shape(3,0) = 0.;
<a name="l04872"></a>04872    shape(3,1) = y;
<a name="l04873"></a>04873    shape(3,2) = 0.;
<a name="l04874"></a>04874    <span class="comment">// x = 0</span>
<a name="l04875"></a>04875    shape(4,0) = x - 1.;
<a name="l04876"></a>04876    shape(4,1) = 0.;
<a name="l04877"></a>04877    shape(4,2) = 0.;
<a name="l04878"></a>04878    <span class="comment">// z = 1</span>
<a name="l04879"></a>04879    shape(5,0) = 0.;
<a name="l04880"></a>04880    shape(5,1) = 0.;
<a name="l04881"></a>04881    shape(5,2) = z;
<a name="l04882"></a>04882 }
<a name="l04883"></a>04883 
<a name="l04884"></a><a class="code" href="classRT0HexFiniteElement.html#a95fcc843324ed5e223c8849cb7cfa81f">04884</a> <span class="keywordtype">void</span> <a class="code" href="classRT0HexFiniteElement.html#a95fcc843324ed5e223c8849cb7cfa81f">RT0HexFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l04885"></a>04885                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l04886"></a>04886 <span class="keyword"></span>{
<a name="l04887"></a>04887    divshape(0) = 1.;
<a name="l04888"></a>04888    divshape(1) = 1.;
<a name="l04889"></a>04889    divshape(2) = 1.;
<a name="l04890"></a>04890    divshape(3) = 1.;
<a name="l04891"></a>04891    divshape(4) = 1.;
<a name="l04892"></a>04892    divshape(5) = 1.;
<a name="l04893"></a>04893 }
<a name="l04894"></a>04894 
<a name="l04895"></a>04895 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">RT0HexFiniteElement::nk</a>[6][3] =
<a name="l04896"></a>04896 {{0,0,-1}, {0,-1,0}, {1,0,0}, {0,1,0}, {-1,0,0}, {0,0,1}};
<a name="l04897"></a>04897 
<a name="l04898"></a><a class="code" href="classRT0HexFiniteElement.html#a9f8368ccdb0c74f3103c3b37dba388f4">04898</a> <span class="keywordtype">void</span> <a class="code" href="classRT0HexFiniteElement.html#a9f8368ccdb0c74f3103c3b37dba388f4">RT0HexFiniteElement::GetLocalInterpolation</a> (
<a name="l04899"></a>04899    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l04900"></a>04900 <span class="keyword"></span>{
<a name="l04901"></a>04901    <span class="keywordtype">int</span> k, j;
<a name="l04902"></a>04902 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l04903"></a>04903 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l04904"></a>04904    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l04905"></a>04905 <span class="preprocessor">#endif</span>
<a name="l04906"></a>04906 <span class="preprocessor"></span>
<a name="l04907"></a>04907 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l04908"></a>04908 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 6; k++)
<a name="l04909"></a>04909    {
<a name="l04910"></a>04910       <a class="code" href="classRT0HexFiniteElement.html#acaec3424447cd9b92303ea40faa7f7b8">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l04911"></a>04911       <span class="keywordflow">for</span> (j = 0; j &lt; 6; j++)
<a name="l04912"></a>04912       {
<a name="l04913"></a>04913          <span class="keywordtype">double</span> d = ( <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][0] + <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][1] +
<a name="l04914"></a>04914                       <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][2] );
<a name="l04915"></a>04915          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l04916"></a>04916          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l04917"></a>04917          {
<a name="l04918"></a>04918             cerr &lt;&lt; <span class="stringliteral">&quot;RT0HexFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l04919"></a>04919                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l04920"></a>04920             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l04921"></a>04921          }
<a name="l04922"></a>04922       }
<a name="l04923"></a>04923    }
<a name="l04924"></a>04924 <span class="preprocessor">#endif</span>
<a name="l04925"></a>04925 <span class="preprocessor"></span>
<a name="l04926"></a>04926    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l04927"></a>04927    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l04928"></a>04928    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l04929"></a>04929    <span class="comment">// Trans must be linear</span>
<a name="l04930"></a>04930    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l04931"></a>04931    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l04932"></a>04932    <span class="keywordtype">double</span> vk[3];
<a name="l04933"></a>04933    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l04934"></a>04934 
<a name="l04935"></a>04935    <span class="keywordflow">for</span> (k = 0; k &lt; 6; k++)
<a name="l04936"></a>04936    {
<a name="l04937"></a>04937       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l04938"></a>04938       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1]; ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = vk[2];
<a name="l04939"></a>04939       <a class="code" href="classRT0HexFiniteElement.html#acaec3424447cd9b92303ea40faa7f7b8">CalcVShape</a> (ip, vshape);
<a name="l04940"></a>04940       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l04941"></a>04941       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,2)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][2];
<a name="l04942"></a>04942       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,2)*nk[k][2];
<a name="l04943"></a>04943       vk[2] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,1)*nk[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,2)*nk[k][2];
<a name="l04944"></a>04944       <span class="keywordflow">for</span> (j = 0; j &lt; 6; j++)
<a name="l04945"></a>04945          <span class="keywordflow">if</span> (fabs (I(k,j) = (<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]+
<a name="l04946"></a>04946                              <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*vk[2])) &lt; 1.0e-12)
<a name="l04947"></a>04947             I(k,j) = 0.0;
<a name="l04948"></a>04948    }
<a name="l04949"></a>04949 }
<a name="l04950"></a>04950 
<a name="l04951"></a><a class="code" href="classRT0HexFiniteElement.html#a66c2548c8ef6821d402b7d7260a04060">04951</a> <span class="keywordtype">void</span> <a class="code" href="classRT0HexFiniteElement.html#a66c2548c8ef6821d402b7d7260a04060">RT0HexFiniteElement::Project</a> (
<a name="l04952"></a>04952    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l04953"></a>04953    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l04954"></a>04954 <span class="keyword"></span>{
<a name="l04955"></a>04955    <span class="keywordtype">double</span> vk[3];
<a name="l04956"></a>04956    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l04957"></a>04957 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l04958"></a>04958 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l04959"></a>04959 <span class="preprocessor">#endif</span>
<a name="l04960"></a>04960 <span class="preprocessor"></span>
<a name="l04961"></a>04961    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 6; k++)
<a name="l04962"></a>04962    {
<a name="l04963"></a>04963       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l04964"></a>04964       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l04965"></a>04965       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l04966"></a>04966 
<a name="l04967"></a>04967       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l04968"></a>04968       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l04969"></a>04969       dofs(k) =
<a name="l04970"></a>04970          vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,2)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][2] ) +
<a name="l04971"></a>04971          vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,2)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][2] ) +
<a name="l04972"></a>04972          vk[2] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,0)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,1)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,2)*<a class="code" href="classRT0HexFiniteElement.html#a00a299ed70164f60c332abe0af0c4f1d">nk</a>[k][2] );
<a name="l04973"></a>04973    }
<a name="l04974"></a>04974 }
<a name="l04975"></a>04975 
<a name="l04976"></a><a class="code" href="classRT1HexFiniteElement.html#aa91c3cf139867b49b94107af9422b729">04976</a> <a class="code" href="classRT1HexFiniteElement.html#aa91c3cf139867b49b94107af9422b729">RT1HexFiniteElement::RT1HexFiniteElement</a>()
<a name="l04977"></a>04977    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 36, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l04978"></a>04978 {
<a name="l04979"></a>04979    <span class="comment">// z = 0</span>
<a name="l04980"></a>04980    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1./3.;
<a name="l04981"></a>04981    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1./3.;
<a name="l04982"></a>04982    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 0.0;
<a name="l04983"></a>04983    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 2./3.;
<a name="l04984"></a>04984    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1./3.;
<a name="l04985"></a>04985    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 0.0;
<a name="l04986"></a>04986    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1./3.;
<a name="l04987"></a>04987    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 2./3.;
<a name="l04988"></a>04988    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 0.0;
<a name="l04989"></a>04989    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 2./3.;
<a name="l04990"></a>04990    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 2./3.;
<a name="l04991"></a>04991    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 0.0;
<a name="l04992"></a>04992    <span class="comment">// y = 0</span>
<a name="l04993"></a>04993    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1./3.;
<a name="l04994"></a>04994    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.0;
<a name="l04995"></a>04995    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 1./3.;
<a name="l04996"></a>04996    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 2./3.;
<a name="l04997"></a>04997    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.0;
<a name="l04998"></a>04998    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 1./3.;
<a name="l04999"></a>04999    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1./3.;
<a name="l05000"></a>05000    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.0;
<a name="l05001"></a>05001    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(6).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 2./3.;
<a name="l05002"></a>05002    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 2./3.;
<a name="l05003"></a>05003    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 0.0;
<a name="l05004"></a>05004    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(7).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 2./3.;
<a name="l05005"></a>05005    <span class="comment">// x = 1</span>
<a name="l05006"></a>05006    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1.0;
<a name="l05007"></a>05007    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 1./3.;
<a name="l05008"></a>05008    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(8).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 1./3.;
<a name="l05009"></a>05009    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>  = 1.0;
<a name="l05010"></a>05010    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>  = 2./3.;
<a name="l05011"></a>05011    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(9).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>  = 1./3.;
<a name="l05012"></a>05012    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l05013"></a>05013    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05014"></a>05014    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(10).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05015"></a>05015    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l05016"></a>05016    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05017"></a>05017    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(11).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05018"></a>05018    <span class="comment">// y = 1</span>
<a name="l05019"></a>05019    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05020"></a>05020    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l05021"></a>05021    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(13).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05022"></a>05022    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05023"></a>05023    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l05024"></a>05024    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(12).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05025"></a>05025    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05026"></a>05026    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l05027"></a>05027    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(15).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05028"></a>05028    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05029"></a>05029    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l05030"></a>05030    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(14).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05031"></a>05031    <span class="comment">// x = 0</span>
<a name="l05032"></a>05032    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l05033"></a>05033    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05034"></a>05034    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(17).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05035"></a>05035    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l05036"></a>05036    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05037"></a>05037    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(16).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05038"></a>05038    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l05039"></a>05039    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05040"></a>05040    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(19).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05041"></a>05041    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l05042"></a>05042    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05043"></a>05043    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(18).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05044"></a>05044    <span class="comment">// z = 1</span>
<a name="l05045"></a>05045    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(20).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05046"></a>05046    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(20).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05047"></a>05047    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(20).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l05048"></a>05048    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(21).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05049"></a>05049    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(21).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05050"></a>05050    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(21).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l05051"></a>05051    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(22).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05052"></a>05052    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(22).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05053"></a>05053    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(22).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l05054"></a>05054    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(23).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05055"></a>05055    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(23).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05056"></a>05056    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(23).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l05057"></a>05057    <span class="comment">// x = 0.5 (interior)</span>
<a name="l05058"></a>05058    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(24).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05059"></a>05059    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(24).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05060"></a>05060    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(24).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05061"></a>05061    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(25).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05062"></a>05062    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(25).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05063"></a>05063    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(25).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05064"></a>05064    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(26).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05065"></a>05065    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(26).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05066"></a>05066    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(26).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05067"></a>05067    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(27).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05068"></a>05068    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(27).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05069"></a>05069    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(27).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05070"></a>05070    <span class="comment">// y = 0.5 (interior)</span>
<a name="l05071"></a>05071    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(28).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05072"></a>05072    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(28).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05073"></a>05073    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(28).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05074"></a>05074    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(29).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05075"></a>05075    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(29).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05076"></a>05076    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(29).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05077"></a>05077    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(30).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05078"></a>05078    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(30).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05079"></a>05079    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(30).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1./3.;
<a name="l05080"></a>05080    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(31).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05081"></a>05081    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(31).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05082"></a>05082    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(31).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 2./3.;
<a name="l05083"></a>05083    <span class="comment">// z = 0.5 (interior)</span>
<a name="l05084"></a>05084    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(32).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05085"></a>05085    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(32).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05086"></a>05086    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(32).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05087"></a>05087    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(33).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1./3.;
<a name="l05088"></a>05088    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(33).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05089"></a>05089    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(33).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05090"></a>05090    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(34).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05091"></a>05091    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(34).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1./3.;
<a name="l05092"></a>05092    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(34).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05093"></a>05093    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(35).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 2./3.;
<a name="l05094"></a>05094    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(35).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 2./3.;
<a name="l05095"></a>05095    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(35).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05096"></a>05096 }
<a name="l05097"></a>05097 
<a name="l05098"></a><a class="code" href="classRT1HexFiniteElement.html#a309155c45dec987abcb04de03e9070de">05098</a> <span class="keywordtype">void</span> <a class="code" href="classRT1HexFiniteElement.html#a309155c45dec987abcb04de03e9070de">RT1HexFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l05099"></a>05099                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l05100"></a>05100 <span class="keyword"></span>{
<a name="l05101"></a>05101    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l05102"></a>05102    <span class="comment">// z = 0</span>
<a name="l05103"></a>05103    shape(2,0)  = 0.;
<a name="l05104"></a>05104    shape(2,1)  = 0.;
<a name="l05105"></a>05105    shape(2,2)  = -(1. - 3.*z + 2.*z*z)*( 2. - 3.*x)*( 2. - 3.*y);
<a name="l05106"></a>05106    shape(3,0)  = 0.;
<a name="l05107"></a>05107    shape(3,1)  = 0.;
<a name="l05108"></a>05108    shape(3,2)  = -(1. - 3.*z + 2.*z*z)*(-1. + 3.*x)*( 2. - 3.*y);
<a name="l05109"></a>05109    shape(0,0)  = 0.;
<a name="l05110"></a>05110    shape(0,1)  = 0.;
<a name="l05111"></a>05111    shape(0,2)  = -(1. - 3.*z + 2.*z*z)*( 2. - 3.*x)*(-1. + 3.*y);
<a name="l05112"></a>05112    shape(1,0)  = 0.;
<a name="l05113"></a>05113    shape(1,1)  = 0.;
<a name="l05114"></a>05114    shape(1,2)  = -(1. - 3.*z + 2.*z*z)*(-1. + 3.*x)*(-1. + 3.*y);
<a name="l05115"></a>05115    <span class="comment">// y = 0</span>
<a name="l05116"></a>05116    shape(4,0)  = 0.;
<a name="l05117"></a>05117    shape(4,1)  = -(1. - 3.*y + 2.*y*y)*( 2. - 3.*x)*( 2. - 3.*z);
<a name="l05118"></a>05118    shape(4,2)  = 0.;
<a name="l05119"></a>05119    shape(5,0)  = 0.;
<a name="l05120"></a>05120    shape(5,1)  = -(1. - 3.*y + 2.*y*y)*(-1. + 3.*x)*( 2. - 3.*z);
<a name="l05121"></a>05121    shape(5,2)  = 0.;
<a name="l05122"></a>05122    shape(6,0)  = 0.;
<a name="l05123"></a>05123    shape(6,1)  = -(1. - 3.*y + 2.*y*y)*( 2. - 3.*x)*(-1. + 3.*z);
<a name="l05124"></a>05124    shape(6,2)  = 0.;
<a name="l05125"></a>05125    shape(7,0)  = 0.;
<a name="l05126"></a>05126    shape(7,1)  = -(1. - 3.*y + 2.*y*y)*(-1. + 3.*x)*(-1. + 3.*z);
<a name="l05127"></a>05127    shape(7,2)  = 0.;
<a name="l05128"></a>05128    <span class="comment">// x = 1</span>
<a name="l05129"></a>05129    shape(8,0)  = (-x + 2.*x*x)*( 2. - 3.*y)*( 2. - 3.*z);
<a name="l05130"></a>05130    shape(8,1)  = 0.;
<a name="l05131"></a>05131    shape(8,2)  = 0.;
<a name="l05132"></a>05132    shape(9,0)  = (-x + 2.*x*x)*(-1. + 3.*y)*( 2. - 3.*z);
<a name="l05133"></a>05133    shape(9,1)  = 0.;
<a name="l05134"></a>05134    shape(9,2)  = 0.;
<a name="l05135"></a>05135    shape(10,0) = (-x + 2.*x*x)*( 2. - 3.*y)*(-1. + 3.*z);
<a name="l05136"></a>05136    shape(10,1) = 0.;
<a name="l05137"></a>05137    shape(10,2) = 0.;
<a name="l05138"></a>05138    shape(11,0) = (-x + 2.*x*x)*(-1. + 3.*y)*(-1. + 3.*z);
<a name="l05139"></a>05139    shape(11,1) = 0.;
<a name="l05140"></a>05140    shape(11,2) = 0.;
<a name="l05141"></a>05141    <span class="comment">// y = 1</span>
<a name="l05142"></a>05142    shape(13,0) = 0.;
<a name="l05143"></a>05143    shape(13,1) = (-y + 2.*y*y)*( 2. - 3.*x)*( 2. - 3.*z);
<a name="l05144"></a>05144    shape(13,2) = 0.;
<a name="l05145"></a>05145    shape(12,0) = 0.;
<a name="l05146"></a>05146    shape(12,1) = (-y + 2.*y*y)*(-1. + 3.*x)*( 2. - 3.*z);
<a name="l05147"></a>05147    shape(12,2) = 0.;
<a name="l05148"></a>05148    shape(15,0) = 0.;
<a name="l05149"></a>05149    shape(15,1) = (-y + 2.*y*y)*( 2. - 3.*x)*(-1. + 3.*z);
<a name="l05150"></a>05150    shape(15,2) = 0.;
<a name="l05151"></a>05151    shape(14,0) = 0.;
<a name="l05152"></a>05152    shape(14,1) = (-y + 2.*y*y)*(-1. + 3.*x)*(-1. + 3.*z);
<a name="l05153"></a>05153    shape(14,2) = 0.;
<a name="l05154"></a>05154    <span class="comment">// x = 0</span>
<a name="l05155"></a>05155    shape(17,0) = -(1. - 3.*x + 2.*x*x)*( 2. - 3.*y)*( 2. - 3.*z);
<a name="l05156"></a>05156    shape(17,1) = 0.;
<a name="l05157"></a>05157    shape(17,2) = 0.;
<a name="l05158"></a>05158    shape(16,0) = -(1. - 3.*x + 2.*x*x)*(-1. + 3.*y)*( 2. - 3.*z);
<a name="l05159"></a>05159    shape(16,1) = 0.;
<a name="l05160"></a>05160    shape(16,2) = 0.;
<a name="l05161"></a>05161    shape(19,0) = -(1. - 3.*x + 2.*x*x)*( 2. - 3.*y)*(-1. + 3.*z);
<a name="l05162"></a>05162    shape(19,1) = 0.;
<a name="l05163"></a>05163    shape(19,2) = 0.;
<a name="l05164"></a>05164    shape(18,0) = -(1. - 3.*x + 2.*x*x)*(-1. + 3.*y)*(-1. + 3.*z);
<a name="l05165"></a>05165    shape(18,1) = 0.;
<a name="l05166"></a>05166    shape(18,2) = 0.;
<a name="l05167"></a>05167    <span class="comment">// z = 1</span>
<a name="l05168"></a>05168    shape(20,0) = 0.;
<a name="l05169"></a>05169    shape(20,1) = 0.;
<a name="l05170"></a>05170    shape(20,2) = (-z + 2.*z*z)*( 2. - 3.*x)*( 2. - 3.*y);
<a name="l05171"></a>05171    shape(21,0) = 0.;
<a name="l05172"></a>05172    shape(21,1) = 0.;
<a name="l05173"></a>05173    shape(21,2) = (-z + 2.*z*z)*(-1. + 3.*x)*( 2. - 3.*y);
<a name="l05174"></a>05174    shape(22,0) = 0.;
<a name="l05175"></a>05175    shape(22,1) = 0.;
<a name="l05176"></a>05176    shape(22,2) = (-z + 2.*z*z)*( 2. - 3.*x)*(-1. + 3.*y);
<a name="l05177"></a>05177    shape(23,0) = 0.;
<a name="l05178"></a>05178    shape(23,1) = 0.;
<a name="l05179"></a>05179    shape(23,2) = (-z + 2.*z*z)*(-1. + 3.*x)*(-1. + 3.*y);
<a name="l05180"></a>05180    <span class="comment">// x = 0.5 (interior)</span>
<a name="l05181"></a>05181    shape(24,0) = (4.*x - 4.*x*x)*( 2. - 3.*y)*( 2. - 3.*z);
<a name="l05182"></a>05182    shape(24,1) = 0.;
<a name="l05183"></a>05183    shape(24,2) = 0.;
<a name="l05184"></a>05184    shape(25,0) = (4.*x - 4.*x*x)*( 2. - 3.*y)*(-1. + 3.*z);
<a name="l05185"></a>05185    shape(25,1) = 0.;
<a name="l05186"></a>05186    shape(25,2) = 0.;
<a name="l05187"></a>05187    shape(26,0) = (4.*x - 4.*x*x)*(-1. + 3.*y)*( 2. - 3.*z);
<a name="l05188"></a>05188    shape(26,1) = 0.;
<a name="l05189"></a>05189    shape(26,2) = 0.;
<a name="l05190"></a>05190    shape(27,0) = (4.*x - 4.*x*x)*(-1. + 3.*y)*(-1. + 3.*z);
<a name="l05191"></a>05191    shape(27,1) = 0.;
<a name="l05192"></a>05192    shape(27,2) = 0.;
<a name="l05193"></a>05193    <span class="comment">// y = 0.5 (interior)</span>
<a name="l05194"></a>05194    shape(28,0) = 0.;
<a name="l05195"></a>05195    shape(28,1) = (4.*y - 4.*y*y)*( 2. - 3.*x)*( 2. - 3.*z);
<a name="l05196"></a>05196    shape(28,2) = 0.;
<a name="l05197"></a>05197    shape(29,0) = 0.;
<a name="l05198"></a>05198    shape(29,1) = (4.*y - 4.*y*y)*( 2. - 3.*x)*(-1. + 3.*z);
<a name="l05199"></a>05199    shape(29,2) = 0.;
<a name="l05200"></a>05200    shape(30,0) = 0.;
<a name="l05201"></a>05201    shape(30,1) = (4.*y - 4.*y*y)*(-1. + 3.*x)*( 2. - 3.*z);
<a name="l05202"></a>05202    shape(30,2) = 0.;
<a name="l05203"></a>05203    shape(31,0) = 0.;
<a name="l05204"></a>05204    shape(31,1) = (4.*y - 4.*y*y)*(-1. + 3.*x)*(-1. + 3.*z);
<a name="l05205"></a>05205    shape(31,2) = 0.;
<a name="l05206"></a>05206    <span class="comment">// z = 0.5 (interior)</span>
<a name="l05207"></a>05207    shape(32,0) = 0.;
<a name="l05208"></a>05208    shape(32,1) = 0.;
<a name="l05209"></a>05209    shape(32,2) = (4.*z - 4.*z*z)*( 2. - 3.*x)*( 2. - 3.*y);
<a name="l05210"></a>05210    shape(33,0) = 0.;
<a name="l05211"></a>05211    shape(33,1) = 0.;
<a name="l05212"></a>05212    shape(33,2) = (4.*z - 4.*z*z)*( 2. - 3.*x)*(-1. + 3.*y);
<a name="l05213"></a>05213    shape(34,0) = 0.;
<a name="l05214"></a>05214    shape(34,1) = 0.;
<a name="l05215"></a>05215    shape(34,2) = (4.*z - 4.*z*z)*(-1. + 3.*x)*( 2. - 3.*y);
<a name="l05216"></a>05216    shape(35,0) = 0.;
<a name="l05217"></a>05217    shape(35,1) = 0.;
<a name="l05218"></a>05218    shape(35,2) = (4.*z - 4.*z*z)*(-1. + 3.*x)*(-1. + 3.*y);
<a name="l05219"></a>05219 }
<a name="l05220"></a>05220 
<a name="l05221"></a><a class="code" href="classRT1HexFiniteElement.html#a978939f77cb057be6aae9a8ce0381b60">05221</a> <span class="keywordtype">void</span> <a class="code" href="classRT1HexFiniteElement.html#a978939f77cb057be6aae9a8ce0381b60">RT1HexFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l05222"></a>05222                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l05223"></a>05223 <span class="keyword"></span>{
<a name="l05224"></a>05224    <span class="keywordtype">double</span> x = ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l05225"></a>05225    <span class="comment">// z = 0</span>
<a name="l05226"></a>05226    divshape(2)  = -(-3. + 4.*z)*( 2. - 3.*x)*( 2. - 3.*y);
<a name="l05227"></a>05227    divshape(3)  = -(-3. + 4.*z)*(-1. + 3.*x)*( 2. - 3.*y);
<a name="l05228"></a>05228    divshape(0)  = -(-3. + 4.*z)*( 2. - 3.*x)*(-1. + 3.*y);
<a name="l05229"></a>05229    divshape(1)  = -(-3. + 4.*z)*(-1. + 3.*x)*(-1. + 3.*y);
<a name="l05230"></a>05230    <span class="comment">// y = 0</span>
<a name="l05231"></a>05231    divshape(4)  = -(-3. + 4.*y)*( 2. - 3.*x)*( 2. - 3.*z);
<a name="l05232"></a>05232    divshape(5)  = -(-3. + 4.*y)*(-1. + 3.*x)*( 2. - 3.*z);
<a name="l05233"></a>05233    divshape(6)  = -(-3. + 4.*y)*( 2. - 3.*x)*(-1. + 3.*z);
<a name="l05234"></a>05234    divshape(7)  = -(-3. + 4.*y)*(-1. + 3.*x)*(-1. + 3.*z);
<a name="l05235"></a>05235    <span class="comment">// x = 1</span>
<a name="l05236"></a>05236    divshape(8)  = (-1. + 4.*x)*( 2. - 3.*y)*( 2. - 3.*z);
<a name="l05237"></a>05237    divshape(9)  = (-1. + 4.*x)*(-1. + 3.*y)*( 2. - 3.*z);
<a name="l05238"></a>05238    divshape(10) = (-1. + 4.*x)*( 2. - 3.*y)*(-1. + 3.*z);
<a name="l05239"></a>05239    divshape(11) = (-1. + 4.*x)*(-1. + 3.*y)*(-1. + 3.*z);
<a name="l05240"></a>05240    <span class="comment">// y = 1</span>
<a name="l05241"></a>05241    divshape(13) = (-1. + 4.*y)*( 2. - 3.*x)*( 2. - 3.*z);
<a name="l05242"></a>05242    divshape(12) = (-1. + 4.*y)*(-1. + 3.*x)*( 2. - 3.*z);
<a name="l05243"></a>05243    divshape(15) = (-1. + 4.*y)*( 2. - 3.*x)*(-1. + 3.*z);
<a name="l05244"></a>05244    divshape(14) = (-1. + 4.*y)*(-1. + 3.*x)*(-1. + 3.*z);
<a name="l05245"></a>05245    <span class="comment">// x = 0</span>
<a name="l05246"></a>05246    divshape(17) = -(-3. + 4.*x)*( 2. - 3.*y)*( 2. - 3.*z);
<a name="l05247"></a>05247    divshape(16) = -(-3. + 4.*x)*(-1. + 3.*y)*( 2. - 3.*z);
<a name="l05248"></a>05248    divshape(19) = -(-3. + 4.*x)*( 2. - 3.*y)*(-1. + 3.*z);
<a name="l05249"></a>05249    divshape(18) = -(-3. + 4.*x)*(-1. + 3.*y)*(-1. + 3.*z);
<a name="l05250"></a>05250    <span class="comment">// z = 1</span>
<a name="l05251"></a>05251    divshape(20) = (-1. + 4.*z)*( 2. - 3.*x)*( 2. - 3.*y);
<a name="l05252"></a>05252    divshape(21) = (-1. + 4.*z)*(-1. + 3.*x)*( 2. - 3.*y);
<a name="l05253"></a>05253    divshape(22) = (-1. + 4.*z)*( 2. - 3.*x)*(-1. + 3.*y);
<a name="l05254"></a>05254    divshape(23) = (-1. + 4.*z)*(-1. + 3.*x)*(-1. + 3.*y);
<a name="l05255"></a>05255    <span class="comment">// x = 0.5 (interior)</span>
<a name="l05256"></a>05256    divshape(24) = ( 4. - 8.*x)*( 2. - 3.*y)*( 2. - 3.*z);
<a name="l05257"></a>05257    divshape(25) = ( 4. - 8.*x)*( 2. - 3.*y)*(-1. + 3.*z);
<a name="l05258"></a>05258    divshape(26) = ( 4. - 8.*x)*(-1. + 3.*y)*( 2. - 3.*z);
<a name="l05259"></a>05259    divshape(27) = ( 4. - 8.*x)*(-1. + 3.*y)*(-1. + 3.*z);
<a name="l05260"></a>05260    <span class="comment">// y = 0.5 (interior)</span>
<a name="l05261"></a>05261    divshape(28) = ( 4. - 8.*y)*( 2. - 3.*x)*( 2. - 3.*z);
<a name="l05262"></a>05262    divshape(29) = ( 4. - 8.*y)*( 2. - 3.*x)*(-1. + 3.*z);
<a name="l05263"></a>05263    divshape(30) = ( 4. - 8.*y)*(-1. + 3.*x)*( 2. - 3.*z);
<a name="l05264"></a>05264    divshape(31) = ( 4. - 8.*y)*(-1. + 3.*x)*(-1. + 3.*z);
<a name="l05265"></a>05265    <span class="comment">// z = 0.5 (interior)</span>
<a name="l05266"></a>05266    divshape(32) = ( 4. - 8.*z)*( 2. - 3.*x)*( 2. - 3.*y);
<a name="l05267"></a>05267    divshape(33) = ( 4. - 8.*z)*( 2. - 3.*x)*(-1. + 3.*y);
<a name="l05268"></a>05268    divshape(34) = ( 4. - 8.*z)*(-1. + 3.*x)*( 2. - 3.*y);
<a name="l05269"></a>05269    divshape(35) = ( 4. - 8.*z)*(-1. + 3.*x)*(-1. + 3.*y);
<a name="l05270"></a>05270 }
<a name="l05271"></a>05271 
<a name="l05272"></a>05272 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">RT1HexFiniteElement::nk</a>[36][3] =
<a name="l05273"></a>05273 {
<a name="l05274"></a>05274    {0, 0,-1}, {0, 0,-1}, {0, 0,-1}, {0, 0,-1},
<a name="l05275"></a>05275    {0,-1, 0}, {0,-1, 0}, {0,-1, 0}, {0,-1, 0},
<a name="l05276"></a>05276    {1, 0, 0}, {1, 0, 0}, {1, 0, 0}, {1, 0, 0},
<a name="l05277"></a>05277    {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0},
<a name="l05278"></a>05278    {-1,0, 0}, {-1,0, 0}, {-1,0, 0}, {-1,0, 0},
<a name="l05279"></a>05279    {0, 0, 1}, {0, 0, 1}, {0, 0, 1}, {0, 0, 1},
<a name="l05280"></a>05280    {1, 0, 0}, {1, 0, 0}, {1, 0, 0}, {1, 0, 0},
<a name="l05281"></a>05281    {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0},
<a name="l05282"></a>05282    {0, 0, 1}, {0, 0, 1}, {0, 0, 1}, {0, 0, 1}
<a name="l05283"></a>05283 };
<a name="l05284"></a>05284 
<a name="l05285"></a><a class="code" href="classRT1HexFiniteElement.html#acf944448ac6d003fedd301be4232b10a">05285</a> <span class="keywordtype">void</span> <a class="code" href="classRT1HexFiniteElement.html#acf944448ac6d003fedd301be4232b10a">RT1HexFiniteElement::GetLocalInterpolation</a> (
<a name="l05286"></a>05286    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l05287"></a>05287 <span class="keyword"></span>{
<a name="l05288"></a>05288    <span class="keywordtype">int</span> k, j;
<a name="l05289"></a>05289 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05290"></a>05290 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l05291"></a>05291    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l05292"></a>05292 <span class="preprocessor">#endif</span>
<a name="l05293"></a>05293 <span class="preprocessor"></span>
<a name="l05294"></a>05294 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l05295"></a>05295 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 36; k++)
<a name="l05296"></a>05296    {
<a name="l05297"></a>05297       <a class="code" href="classRT1HexFiniteElement.html#a309155c45dec987abcb04de03e9070de">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l05298"></a>05298       <span class="keywordflow">for</span> (j = 0; j &lt; 36; j++)
<a name="l05299"></a>05299       {
<a name="l05300"></a>05300          <span class="keywordtype">double</span> d = ( <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][0] + <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][1] +
<a name="l05301"></a>05301                       <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][2] );
<a name="l05302"></a>05302          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l05303"></a>05303          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l05304"></a>05304          {
<a name="l05305"></a>05305             cerr &lt;&lt; <span class="stringliteral">&quot;RT0HexFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l05306"></a>05306                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l05307"></a>05307             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l05308"></a>05308          }
<a name="l05309"></a>05309       }
<a name="l05310"></a>05310    }
<a name="l05311"></a>05311 <span class="preprocessor">#endif</span>
<a name="l05312"></a>05312 <span class="preprocessor"></span>
<a name="l05313"></a>05313    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l05314"></a>05314    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l05315"></a>05315    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l05316"></a>05316    <span class="comment">// Trans must be linear</span>
<a name="l05317"></a>05317    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l05318"></a>05318    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l05319"></a>05319    <span class="keywordtype">double</span> vk[3];
<a name="l05320"></a>05320    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l05321"></a>05321 
<a name="l05322"></a>05322    <span class="keywordflow">for</span> (k = 0; k &lt; 36; k++)
<a name="l05323"></a>05323    {
<a name="l05324"></a>05324       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l05325"></a>05325       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1]; ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = vk[2];
<a name="l05326"></a>05326       <a class="code" href="classRT1HexFiniteElement.html#a309155c45dec987abcb04de03e9070de">CalcVShape</a> (ip, vshape);
<a name="l05327"></a>05327       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l05328"></a>05328       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,2)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][2];
<a name="l05329"></a>05329       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,2)*nk[k][2];
<a name="l05330"></a>05330       vk[2] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,1)*nk[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,2)*nk[k][2];
<a name="l05331"></a>05331       <span class="keywordflow">for</span> (j = 0; j &lt; 36; j++)
<a name="l05332"></a>05332          <span class="keywordflow">if</span> (fabs (I(k,j) = (<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]+
<a name="l05333"></a>05333                              <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*vk[2])) &lt; 1.0e-12)
<a name="l05334"></a>05334             I(k,j) = 0.0;
<a name="l05335"></a>05335    }
<a name="l05336"></a>05336 }
<a name="l05337"></a>05337 
<a name="l05338"></a><a class="code" href="classRT1HexFiniteElement.html#a976cccd6f9c669e384a574022282a4cb">05338</a> <span class="keywordtype">void</span> <a class="code" href="classRT1HexFiniteElement.html#a976cccd6f9c669e384a574022282a4cb">RT1HexFiniteElement::Project</a> (
<a name="l05339"></a>05339    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l05340"></a>05340    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l05341"></a>05341 <span class="keyword"></span>{
<a name="l05342"></a>05342    <span class="keywordtype">double</span> vk[3];
<a name="l05343"></a>05343    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l05344"></a>05344 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05345"></a>05345 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l05346"></a>05346 <span class="preprocessor">#endif</span>
<a name="l05347"></a>05347 <span class="preprocessor"></span>
<a name="l05348"></a>05348    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 36; k++)
<a name="l05349"></a>05349    {
<a name="l05350"></a>05350       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l05351"></a>05351       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l05352"></a>05352       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l05353"></a>05353 
<a name="l05354"></a>05354       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l05355"></a>05355       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l05356"></a>05356       dofs(k) =
<a name="l05357"></a>05357          vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,2)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][2] ) +
<a name="l05358"></a>05358          vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,2)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][2] ) +
<a name="l05359"></a>05359          vk[2] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,0)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,1)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,2)*<a class="code" href="classRT1HexFiniteElement.html#a26206ad618803f57ef22be2740e7d122">nk</a>[k][2] );
<a name="l05360"></a>05360    }
<a name="l05361"></a>05361 }
<a name="l05362"></a>05362 
<a name="l05363"></a><a class="code" href="classRT0TetFiniteElement.html#af26d335fca54540d7633d048a1c1bfcf">05363</a> <a class="code" href="classRT0TetFiniteElement.html#af26d335fca54540d7633d048a1c1bfcf">RT0TetFiniteElement::RT0TetFiniteElement</a>()
<a name="l05364"></a>05364    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a> (3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, 4, 1)
<a name="l05365"></a>05365 {
<a name="l05366"></a>05366    <span class="comment">// not real nodes ...</span>
<a name="l05367"></a>05367    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l05368"></a>05368    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l05369"></a>05369    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.33333333333333333333;
<a name="l05370"></a>05370 
<a name="l05371"></a>05371    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l05372"></a>05372    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l05373"></a>05373    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.33333333333333333333;
<a name="l05374"></a>05374 
<a name="l05375"></a>05375    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l05376"></a>05376    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l05377"></a>05377    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.33333333333333333333;
<a name="l05378"></a>05378 
<a name="l05379"></a>05379    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.33333333333333333333;
<a name="l05380"></a>05380    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.33333333333333333333;
<a name="l05381"></a>05381    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l05382"></a>05382 }
<a name="l05383"></a>05383 
<a name="l05384"></a><a class="code" href="classRT0TetFiniteElement.html#a7f529086904c12f4ec0fcb444d8509b1">05384</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TetFiniteElement.html#a7f529086904c12f4ec0fcb444d8509b1">RT0TetFiniteElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l05385"></a>05385                                      <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l05386"></a>05386 <span class="keyword"></span>{
<a name="l05387"></a>05387    <span class="keywordtype">double</span> x2 = 2.0*ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, y2 = 2.0*ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, z2 = 2.0*ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>;
<a name="l05388"></a>05388 
<a name="l05389"></a>05389    shape(0,0) = x2;
<a name="l05390"></a>05390    shape(0,1) = y2;
<a name="l05391"></a>05391    shape(0,2) = z2;
<a name="l05392"></a>05392 
<a name="l05393"></a>05393    shape(1,0) = x2 - 2.0;
<a name="l05394"></a>05394    shape(1,1) = y2;
<a name="l05395"></a>05395    shape(1,2) = z2;
<a name="l05396"></a>05396 
<a name="l05397"></a>05397    shape(2,0) = x2;
<a name="l05398"></a>05398    shape(2,1) = y2 - 2.0;
<a name="l05399"></a>05399    shape(2,2) = z2;
<a name="l05400"></a>05400 
<a name="l05401"></a>05401    shape(3,0) = x2;
<a name="l05402"></a>05402    shape(3,1) = y2;
<a name="l05403"></a>05403    shape(3,2) = z2 - 2.0;
<a name="l05404"></a>05404 }
<a name="l05405"></a>05405 
<a name="l05406"></a><a class="code" href="classRT0TetFiniteElement.html#a97111070590b8605b5dfa5680a33d0b2">05406</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TetFiniteElement.html#a97111070590b8605b5dfa5680a33d0b2">RT0TetFiniteElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l05407"></a>05407                                        <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l05408"></a>05408 <span class="keyword"></span>{
<a name="l05409"></a>05409    divshape(0) = 6.0;
<a name="l05410"></a>05410    divshape(1) = 6.0;
<a name="l05411"></a>05411    divshape(2) = 6.0;
<a name="l05412"></a>05412    divshape(3) = 6.0;
<a name="l05413"></a>05413 }
<a name="l05414"></a>05414 
<a name="l05415"></a>05415 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">RT0TetFiniteElement::nk</a>[4][3] =
<a name="l05416"></a>05416 {{.5,.5,.5}, {-.5,0,0}, {0,-.5,0}, {0,0,-.5}};
<a name="l05417"></a>05417 
<a name="l05418"></a><a class="code" href="classRT0TetFiniteElement.html#a880864cb1066f40c8e3c23724c2c9479">05418</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TetFiniteElement.html#a880864cb1066f40c8e3c23724c2c9479">RT0TetFiniteElement::GetLocalInterpolation</a> (
<a name="l05419"></a>05419    <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;I)<span class="keyword"> const</span>
<a name="l05420"></a>05420 <span class="keyword"></span>{
<a name="l05421"></a>05421    <span class="keywordtype">int</span> k, j;
<a name="l05422"></a>05422 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05423"></a>05423 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l05424"></a>05424    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l05425"></a>05425 <span class="preprocessor">#endif</span>
<a name="l05426"></a>05426 <span class="preprocessor"></span>
<a name="l05427"></a>05427 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l05428"></a>05428 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (k = 0; k &lt; 4; k++)
<a name="l05429"></a>05429    {
<a name="l05430"></a>05430       <a class="code" href="classRT0TetFiniteElement.html#a7f529086904c12f4ec0fcb444d8509b1">CalcVShape</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k), <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>);
<a name="l05431"></a>05431       <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l05432"></a>05432       {
<a name="l05433"></a>05433          <span class="keywordtype">double</span> d = ( <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][0] + <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][1] +
<a name="l05434"></a>05434                       <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][2] );
<a name="l05435"></a>05435          <span class="keywordflow">if</span> (j == k) d -= 1.0;
<a name="l05436"></a>05436          <span class="keywordflow">if</span> (fabs(d) &gt; 1.0e-12)
<a name="l05437"></a>05437          {
<a name="l05438"></a>05438             cerr &lt;&lt; <span class="stringliteral">&quot;RT0TetFiniteElement::GetLocalInterpolation (...)\n&quot;</span>
<a name="l05439"></a>05439                <span class="stringliteral">&quot; k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;, j = &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, d = &quot;</span> &lt;&lt; d &lt;&lt; endl;
<a name="l05440"></a>05440             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l05441"></a>05441          }
<a name="l05442"></a>05442       }
<a name="l05443"></a>05443    }
<a name="l05444"></a>05444 <span class="preprocessor">#endif</span>
<a name="l05445"></a>05445 <span class="preprocessor"></span>
<a name="l05446"></a>05446    <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> ip;
<a name="l05447"></a>05447    ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l05448"></a>05448    Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;ip);
<a name="l05449"></a>05449    <span class="comment">// Trans must be linear</span>
<a name="l05450"></a>05450    <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l05451"></a>05451    <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l05452"></a>05452    <span class="keywordtype">double</span> vk[3];
<a name="l05453"></a>05453    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l05454"></a>05454 
<a name="l05455"></a>05455    <span class="keywordflow">for</span> (k = 0; k &lt; 4; k++)
<a name="l05456"></a>05456    {
<a name="l05457"></a>05457       Trans.<a class="code" href="classElementTransformation.html#ad45b6952ecf442d315b1dbd8f10d13e9">Transform</a> (<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k), xk);
<a name="l05458"></a>05458       ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = vk[0]; ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = vk[1]; ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = vk[2];
<a name="l05459"></a>05459       <a class="code" href="classRT0TetFiniteElement.html#a7f529086904c12f4ec0fcb444d8509b1">CalcVShape</a> (ip, vshape);
<a name="l05460"></a>05460       <span class="comment">//  vk = |J| J^{-t} nk</span>
<a name="l05461"></a>05461       vk[0] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,2)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][2];
<a name="l05462"></a>05462       vk[1] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*nk[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,2)*nk[k][2];
<a name="l05463"></a>05463       vk[2] = <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,0)*nk[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,1)*nk[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,2)*nk[k][2];
<a name="l05464"></a>05464       <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)
<a name="l05465"></a>05465          <span class="keywordflow">if</span> (fabs (I(k,j) = (<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,0)*vk[0]+<a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,1)*vk[1]+
<a name="l05466"></a>05466                              <a class="code" href="classVectorFiniteElement.html#ae50999142e7e92c71334672fa729ce09">vshape</a>(j,2)*vk[2])) &lt; 1.0e-12)
<a name="l05467"></a>05467             I(k,j) = 0.0;
<a name="l05468"></a>05468    }
<a name="l05469"></a>05469 }
<a name="l05470"></a>05470 
<a name="l05471"></a><a class="code" href="classRT0TetFiniteElement.html#a266a67f74601fba765e5d43feefe538a">05471</a> <span class="keywordtype">void</span> <a class="code" href="classRT0TetFiniteElement.html#a266a67f74601fba765e5d43feefe538a">RT0TetFiniteElement::Project</a> (
<a name="l05472"></a>05472    <a class="code" href="classVectorCoefficient.html">VectorCoefficient</a> &amp;vc, <a class="code" href="classElementTransformation.html">ElementTransformation</a> &amp;Trans,
<a name="l05473"></a>05473    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l05474"></a>05474 <span class="keyword"></span>{
<a name="l05475"></a>05475    <span class="keywordtype">double</span> vk[3];
<a name="l05476"></a>05476    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> xk (vk, 3);
<a name="l05477"></a>05477 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05478"></a>05478 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(<a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l05479"></a>05479 <span class="preprocessor">#endif</span>
<a name="l05480"></a>05480 <span class="preprocessor"></span>
<a name="l05481"></a>05481    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 4; k++)
<a name="l05482"></a>05482    {
<a name="l05483"></a>05483       Trans.<a class="code" href="classElementTransformation.html#a914f72157a1367b21bd4fedd65849c1f">SetIntPoint</a> (&amp;<a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l05484"></a>05484       <span class="comment">// set Jinv = |J| J^{-t} = adj(J)^t</span>
<a name="l05485"></a>05485       <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a> (Trans.<a class="code" href="classElementTransformation.html#a2cdb5703127f0426386f0dcb97893801">Jacobian</a>(), <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>);
<a name="l05486"></a>05486 
<a name="l05487"></a>05487       vc.<a class="code" href="classVectorCoefficient.html#a640bbe63d2d61ec0d0e6b082a10ce969">Eval</a> (xk, Trans, <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a> (k));
<a name="l05488"></a>05488       <span class="comment">//  xk^t |J| J^{-t} nk</span>
<a name="l05489"></a>05489       dofs(k) =
<a name="l05490"></a>05490          vk[0] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,0)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,1)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(0,2)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][2] ) +
<a name="l05491"></a>05491          vk[1] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,0)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,1)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(1,2)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][2] ) +
<a name="l05492"></a>05492          vk[2] * ( <a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,0)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][0]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,1)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][1]+<a class="code" href="classVectorFiniteElement.html#ac41df0325cb49cafe5a75d036e10f1f3">Jinv</a>(2,2)*<a class="code" href="classRT0TetFiniteElement.html#adf6eaa0e0d6d6b844c8a5d357d4d47db">nk</a>[k][2] );
<a name="l05493"></a>05493    }
<a name="l05494"></a>05494 }
<a name="l05495"></a>05495 
<a name="l05496"></a><a class="code" href="classRotTriLinearHexFiniteElement.html#a533c5396e71958790f84654b16705ddc">05496</a> <a class="code" href="classRotTriLinearHexFiniteElement.html#a533c5396e71958790f84654b16705ddc">RotTriLinearHexFiniteElement::RotTriLinearHexFiniteElement</a>()
<a name="l05497"></a>05497    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 6, 2, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk)
<a name="l05498"></a>05498 {
<a name="l05499"></a>05499    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05500"></a>05500    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05501"></a>05501    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.0;
<a name="l05502"></a>05502 
<a name="l05503"></a>05503    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05504"></a>05504    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.0;
<a name="l05505"></a>05505    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05506"></a>05506 
<a name="l05507"></a>05507    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 1.0;
<a name="l05508"></a>05508    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05509"></a>05509    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05510"></a>05510 
<a name="l05511"></a>05511    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05512"></a>05512    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 1.0;
<a name="l05513"></a>05513    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05514"></a>05514 
<a name="l05515"></a>05515    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.0;
<a name="l05516"></a>05516    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05517"></a>05517    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(4).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 0.5;
<a name="l05518"></a>05518 
<a name="l05519"></a>05519    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = 0.5;
<a name="l05520"></a>05520    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> = 0.5;
<a name="l05521"></a>05521    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(5).<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> = 1.0;
<a name="l05522"></a>05522 }
<a name="l05523"></a>05523 
<a name="l05524"></a><a class="code" href="classRotTriLinearHexFiniteElement.html#a997cba65edf51e5686e7714fb9554eb4">05524</a> <span class="keywordtype">void</span> <a class="code" href="classRotTriLinearHexFiniteElement.html#a997cba65edf51e5686e7714fb9554eb4">RotTriLinearHexFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l05525"></a>05525                                              <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l05526"></a>05526 <span class="keyword"></span>{
<a name="l05527"></a>05527    <span class="keywordtype">double</span> x = 2. * ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - 1.;
<a name="l05528"></a>05528    <span class="keywordtype">double</span> y = 2. * ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - 1.;
<a name="l05529"></a>05529    <span class="keywordtype">double</span> z = 2. * ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - 1.;
<a name="l05530"></a>05530    <span class="keywordtype">double</span> f5 = x * x - y * y;
<a name="l05531"></a>05531    <span class="keywordtype">double</span> f6 = y * y - z * z;
<a name="l05532"></a>05532 
<a name="l05533"></a>05533    shape(0) = (1./6.) * (1. - 3. * z -      f5 - 2. * f6);
<a name="l05534"></a>05534    shape(1) = (1./6.) * (1. - 3. * y -      f5 +      f6);
<a name="l05535"></a>05535    shape(2) = (1./6.) * (1. + 3. * x + 2. * f5 +      f6);
<a name="l05536"></a>05536    shape(3) = (1./6.) * (1. + 3. * y -      f5 +      f6);
<a name="l05537"></a>05537    shape(4) = (1./6.) * (1. - 3. * x + 2. * f5 +      f6);
<a name="l05538"></a>05538    shape(5) = (1./6.) * (1. + 3. * z -      f5 - 2. * f6);
<a name="l05539"></a>05539 }
<a name="l05540"></a>05540 
<a name="l05541"></a><a class="code" href="classRotTriLinearHexFiniteElement.html#ad5c58d7c736cdaa1fcc521604b8d9a48">05541</a> <span class="keywordtype">void</span> <a class="code" href="classRotTriLinearHexFiniteElement.html#ad5c58d7c736cdaa1fcc521604b8d9a48">RotTriLinearHexFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l05542"></a>05542                                               <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l05543"></a>05543 <span class="keyword"></span>{
<a name="l05544"></a>05544    <span class="keyword">const</span> <span class="keywordtype">double</span> a = 2./3.;
<a name="l05545"></a>05545 
<a name="l05546"></a>05546    <span class="keywordtype">double</span> xt = a * (1. - 2. * ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l05547"></a>05547    <span class="keywordtype">double</span> yt = a * (1. - 2. * ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l05548"></a>05548    <span class="keywordtype">double</span> zt = a * (1. - 2. * ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>);
<a name="l05549"></a>05549 
<a name="l05550"></a>05550    dshape(0,0) = xt;
<a name="l05551"></a>05551    dshape(0,1) = yt;
<a name="l05552"></a>05552    dshape(0,2) = -1. - 2. * zt;
<a name="l05553"></a>05553 
<a name="l05554"></a>05554    dshape(1,0) = xt;
<a name="l05555"></a>05555    dshape(1,1) = -1. - 2. * yt;
<a name="l05556"></a>05556    dshape(1,2) = zt;
<a name="l05557"></a>05557 
<a name="l05558"></a>05558    dshape(2,0) = 1. - 2. * xt;
<a name="l05559"></a>05559    dshape(2,1) = yt;
<a name="l05560"></a>05560    dshape(2,2) = zt;
<a name="l05561"></a>05561 
<a name="l05562"></a>05562    dshape(3,0) = xt;
<a name="l05563"></a>05563    dshape(3,1) = 1. - 2. * yt;
<a name="l05564"></a>05564    dshape(3,2) = zt;
<a name="l05565"></a>05565 
<a name="l05566"></a>05566    dshape(4,0) = -1. - 2. * xt;
<a name="l05567"></a>05567    dshape(4,1) = yt;
<a name="l05568"></a>05568    dshape(4,2) = zt;
<a name="l05569"></a>05569 
<a name="l05570"></a>05570    dshape(5,0) = xt;
<a name="l05571"></a>05571    dshape(5,1) = yt;
<a name="l05572"></a>05572    dshape(5,2) = 1. - 2. * zt;
<a name="l05573"></a>05573 }
<a name="l05574"></a>05574 
<a name="l05575"></a>05575 
<a name="l05576"></a><a class="code" href="classPoly__1D_1_1Basis.html#a56724e81ecea923c5dbe7572d0709ec1">05576</a> <a class="code" href="classPoly__1D_1_1Basis.html#a56724e81ecea923c5dbe7572d0709ec1">Poly_1D::Basis::Basis</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> *nodes)
<a name="l05577"></a>05577    : A(p + 1)
<a name="l05578"></a>05578 {
<a name="l05579"></a>05579 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05580"></a>05580 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classPoly__1D_1_1Basis.html#ae0f9406936c9e5ea84e287e1bb67bcd0">a</a>(p+1);
<a name="l05581"></a>05581 <span class="preprocessor">#else</span>
<a name="l05582"></a>05582 <span class="preprocessor"></span>   a.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p+1);
<a name="l05583"></a>05583    <a class="code" href="classPoly__1D_1_1Basis.html#a91d434e5fd866dff8643a331345b9623">b</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p+1);
<a name="l05584"></a>05584 <span class="preprocessor">#endif</span>
<a name="l05585"></a>05585 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l05586"></a>05586    {
<a name="l05587"></a>05587       <a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, nodes[i], a);
<a name="l05588"></a>05588       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l05589"></a>05589          <a class="code" href="classPoly__1D_1_1Basis.html#ac15b063e9223e16f21f7f50e447435c3">A</a>(j, i) = <a class="code" href="classPoly__1D_1_1Basis.html#ae0f9406936c9e5ea84e287e1bb67bcd0">a</a>(j);
<a name="l05590"></a>05590    }
<a name="l05591"></a>05591 
<a name="l05592"></a>05592    <a class="code" href="classPoly__1D_1_1Basis.html#ac15b063e9223e16f21f7f50e447435c3">A</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l05593"></a>05593    <span class="comment">// cout &lt;&lt; &quot;Poly_1D::Basis(&quot; &lt;&lt; p &lt;&lt; &quot;,...) : &quot;; A.TestInversion();</span>
<a name="l05594"></a>05594 }
<a name="l05595"></a>05595 
<a name="l05596"></a><a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">05596</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Poly_1D::Basis::Eval</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;u)<span class="keyword"> const</span>
<a name="l05597"></a>05597 <span class="keyword"></span>{
<a name="l05598"></a>05598 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05599"></a>05599 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> a(A.Size());
<a name="l05600"></a>05600 <span class="preprocessor">#endif</span>
<a name="l05601"></a>05601 <span class="preprocessor"></span>   <span class="keyword">const</span> <span class="keywordtype">int</span> p = A.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() - 1;
<a name="l05602"></a>05602    <a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, x, a);
<a name="l05603"></a>05603    A.Mult(a, u);
<a name="l05604"></a>05604 }
<a name="l05605"></a>05605 
<a name="l05606"></a><a class="code" href="classPoly__1D_1_1Basis.html#a493274c18d4cc6ec52fe6ad67fee2d79">05606</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Poly_1D::Basis::Eval</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;u, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;d)<span class="keyword"> const</span>
<a name="l05607"></a>05607 <span class="keyword"></span>{
<a name="l05608"></a>05608 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l05609"></a>05609 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> a(A.Size()), b(A.Size());
<a name="l05610"></a>05610 <span class="preprocessor">#endif</span>
<a name="l05611"></a>05611 <span class="preprocessor"></span>   <span class="keyword">const</span> <span class="keywordtype">int</span> p = A.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() - 1;
<a name="l05612"></a>05612    <a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, x, a, b);
<a name="l05613"></a>05613    A.Mult(a, u);
<a name="l05614"></a>05614    A.Mult(b, d);
<a name="l05615"></a>05615 }
<a name="l05616"></a>05616 
<a name="l05617"></a><a class="code" href="classPoly__1D.html#a48591aec4055567dd0a31318b6385f31">05617</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a48591aec4055567dd0a31318b6385f31">Poly_1D::UniformPoints</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keywordtype">double</span> *x)
<a name="l05618"></a>05618 {
<a name="l05619"></a>05619    <span class="keywordflow">if</span> (p == 0)
<a name="l05620"></a>05620    {
<a name="l05621"></a>05621       x[0] = 0.5;
<a name="l05622"></a>05622    }
<a name="l05623"></a>05623    <span class="keywordflow">else</span>
<a name="l05624"></a>05624    {
<a name="l05625"></a>05625       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l05626"></a>05626          x[i] = <span class="keywordtype">double</span>(i)/p;
<a name="l05627"></a>05627    }
<a name="l05628"></a>05628 }
<a name="l05629"></a>05629 
<a name="l05630"></a><a class="code" href="classPoly__1D.html#a9ef701a7917eae7c684f88ac9538e718">05630</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a9ef701a7917eae7c684f88ac9538e718">Poly_1D::GaussPoints</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keywordtype">double</span> *x)
<a name="l05631"></a>05631 {
<a name="l05632"></a>05632    <span class="keywordtype">int</span> m = (p+1)/2, odd_p = p%2;
<a name="l05633"></a>05633 
<a name="l05634"></a>05634    <span class="keywordflow">if</span> (!odd_p)
<a name="l05635"></a>05635       x[m] = 0.5;
<a name="l05636"></a>05636 
<a name="l05637"></a>05637    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; i++)
<a name="l05638"></a>05638    {
<a name="l05639"></a>05639       <span class="keywordtype">double</span> z, y, p0, d0;
<a name="l05640"></a>05640       z = cos(M_PI*(i + 0.75)/(p + 1.5));
<a name="l05641"></a>05641 
<a name="l05642"></a>05642       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; <span class="keyword">true</span>; )
<a name="l05643"></a>05643       {
<a name="l05644"></a>05644          <span class="comment">// compute p0, d0 -- P_{p+1}(z), P&#39;_{p+1}(z) using</span>
<a name="l05645"></a>05645          <span class="comment">// (n+1)*P_{n+1}(z) = (2*n+1)*z*P_n(z)-n*P_{n-1}(z)</span>
<a name="l05646"></a>05646          <span class="comment">// P&#39;_{n+1}(z) = (2*n+1)*P_n(z)+P&#39;_{n-1}(z)</span>
<a name="l05647"></a>05647          {
<a name="l05648"></a>05648             <span class="keywordtype">double</span> p1, p2;
<a name="l05649"></a>05649             p2 = 1.;
<a name="l05650"></a>05650             p1 = z;
<a name="l05651"></a>05651             d0 = 1 - odd_p;
<a name="l05652"></a>05652             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; <span class="keyword">true</span>; n++)
<a name="l05653"></a>05653             {
<a name="l05654"></a>05654                p0 = ((2*n+1)*z*p1 - n*p2)/(n + 1);
<a name="l05655"></a>05655                <span class="keywordflow">if</span> (n%2 == odd_p)
<a name="l05656"></a>05656                   d0 += (2*n+1)*p1;
<a name="l05657"></a>05657                <span class="keywordflow">if</span> (n == p) <span class="keywordflow">break</span>;
<a name="l05658"></a>05658                p2 = p1;
<a name="l05659"></a>05659                p1 = p0;
<a name="l05660"></a>05660             }
<a name="l05661"></a>05661             <span class="comment">// d0 = (p + 1)*(z*p0 - p1)/(z*z - 1); // alternative formula</span>
<a name="l05662"></a>05662          }
<a name="l05663"></a>05663 
<a name="l05664"></a>05664          <span class="keywordflow">if</span> (fabs(p0/d0) &lt; 2e-16) <span class="keywordflow">break</span>;
<a name="l05665"></a>05665 
<a name="l05666"></a>05666          <span class="keywordflow">if</span> (++k == 5)
<a name="l05667"></a>05667          {
<a name="l05668"></a>05668             std::cout &lt;&lt; <span class="stringliteral">&quot;Poly_1D::GaussPoints : No convergence!&quot;</span>
<a name="l05669"></a>05669                <span class="stringliteral">&quot; p = &quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;, i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, p0/d0 = &quot;</span> &lt;&lt; p0/d0
<a name="l05670"></a>05670                       &lt;&lt; std::endl;
<a name="l05671"></a>05671             <span class="keywordflow">break</span>;
<a name="l05672"></a>05672          }
<a name="l05673"></a>05673 
<a name="l05674"></a>05674          z = z - p0/d0;
<a name="l05675"></a>05675       }
<a name="l05676"></a>05676 
<a name="l05677"></a>05677       <span class="comment">// z = z - p0/d0; y = (1 - z)/2; // bad roundoff !!!</span>
<a name="l05678"></a>05678       y = ((1 - z) + p0/d0)/2;
<a name="l05679"></a>05679 
<a name="l05680"></a>05680       x[i]   = y;
<a name="l05681"></a>05681       x[p-i] = 1 - y;
<a name="l05682"></a>05682       <span class="comment">// the weight is: 1./(4*y*(1 - y)*d0*d0)</span>
<a name="l05683"></a>05683    }
<a name="l05684"></a>05684 }
<a name="l05685"></a>05685 
<a name="l05686"></a><a class="code" href="classPoly__1D.html#a25e9dbaabc08741edf571677dd8ac044">05686</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a25e9dbaabc08741edf571677dd8ac044">Poly_1D::GaussLobattoPoints</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keywordtype">double</span> *x)
<a name="l05687"></a>05687 {
<a name="l05688"></a>05688    <span class="keywordflow">if</span> (p == 0)
<a name="l05689"></a>05689    {
<a name="l05690"></a>05690       x[0] = 0.5;
<a name="l05691"></a>05691    }
<a name="l05692"></a>05692    <span class="keywordflow">else</span>
<a name="l05693"></a>05693    {
<a name="l05694"></a>05694       x[0] = 0.;
<a name="l05695"></a>05695       x[p] = 1.;
<a name="l05696"></a>05696       <span class="keywordflow">if</span> (p == 1) <span class="keywordflow">return</span>;
<a name="l05697"></a>05697 
<a name="l05698"></a>05698       <span class="comment">// x[1],...,x[p-1] are the (shifted) roots of P&#39;_p</span>
<a name="l05699"></a>05699       <span class="keywordtype">int</span> m = (p - 1)/2, odd_p = p%2;
<a name="l05700"></a>05700 
<a name="l05701"></a>05701       <span class="keywordflow">if</span> (!odd_p)
<a name="l05702"></a>05702          x[m+1] = 0.5;
<a name="l05703"></a>05703       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; )
<a name="l05704"></a>05704       {
<a name="l05705"></a>05705          <span class="keywordtype">double</span> y, z, d0, s0;
<a name="l05706"></a>05706          z = cos(M_PI*(i + 1)/p);
<a name="l05707"></a>05707 
<a name="l05708"></a>05708          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; <span class="keyword">true</span>; )
<a name="l05709"></a>05709          {
<a name="l05710"></a>05710             <span class="comment">// compute d0, s0 -- P&#39;_p(z), P&quot;_p(z)</span>
<a name="l05711"></a>05711             <span class="comment">// (n+1)*P_{n+1}(z) = (2*n+1)*z*P_n(z)-n*P_{n-1}(z)</span>
<a name="l05712"></a>05712             <span class="comment">// P&#39;_{n+1}(z) = (2*n+1)* P_n(z)+P&#39;_{n-1}(z)</span>
<a name="l05713"></a>05713             <span class="comment">// P&quot;_{n+1}(z) = (2*n+1)*P&#39;_n(z)+P&quot;_{n-1}(z)</span>
<a name="l05714"></a>05714             {
<a name="l05715"></a>05715                <span class="keywordtype">double</span> p0, p1, p2, d1;
<a name="l05716"></a>05716                p2 = 1.;
<a name="l05717"></a>05717                p1 = z;
<a name="l05718"></a>05718                d0 = odd_p;
<a name="l05719"></a>05719                d1 = 1 - odd_p;
<a name="l05720"></a>05720                s0 = 0;
<a name="l05721"></a>05721                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; <span class="keyword">true</span>; n++)
<a name="l05722"></a>05722                {
<a name="l05723"></a>05723                   p0 = ((2*n+1)*z*p1 - n*p2)/(n + 1);
<a name="l05724"></a>05724                   <span class="keywordflow">if</span> (n%2 != odd_p)
<a name="l05725"></a>05725                   {
<a name="l05726"></a>05726                      d0 += (2*n+1)*p1;
<a name="l05727"></a>05727                      s0 += (2*n+1)*d1;
<a name="l05728"></a>05728                   }
<a name="l05729"></a>05729                   <span class="keywordflow">else</span>
<a name="l05730"></a>05730                   {
<a name="l05731"></a>05731                      d1 += (2*n+1)*p1;
<a name="l05732"></a>05732                   }
<a name="l05733"></a>05733                   <span class="keywordflow">if</span> (n == p - 1) <span class="keywordflow">break</span>;
<a name="l05734"></a>05734                   p2 = p1;
<a name="l05735"></a>05735                   p1 = p0;
<a name="l05736"></a>05736                }
<a name="l05737"></a>05737             }
<a name="l05738"></a>05738 
<a name="l05739"></a>05739             <span class="keywordflow">if</span> (fabs(d0/s0) &lt; 2e-16) <span class="keywordflow">break</span>;
<a name="l05740"></a>05740 
<a name="l05741"></a>05741             <span class="keywordflow">if</span> (++k == 6)
<a name="l05742"></a>05742             {
<a name="l05743"></a>05743                std::cout &lt;&lt; <span class="stringliteral">&quot;Poly_1D::GaussLobattoPoints : No convergence!&quot;</span>
<a name="l05744"></a>05744                   <span class="stringliteral">&quot; p = &quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;, i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, d0/s0 = &quot;</span> &lt;&lt; d0/s0
<a name="l05745"></a>05745                          &lt;&lt; std::endl;
<a name="l05746"></a>05746                <span class="keywordflow">break</span>;
<a name="l05747"></a>05747             }
<a name="l05748"></a>05748 
<a name="l05749"></a>05749             z = z - d0/s0;
<a name="l05750"></a>05750          }
<a name="l05751"></a>05751 
<a name="l05752"></a>05752          y = ((1 - z) + d0/s0)/2;
<a name="l05753"></a>05753 
<a name="l05754"></a>05754          x[++i] = y;
<a name="l05755"></a>05755          x[p-i] = 1 - y;
<a name="l05756"></a>05756       }
<a name="l05757"></a>05757    }
<a name="l05758"></a>05758 }
<a name="l05759"></a>05759 
<a name="l05760"></a><a class="code" href="classPoly__1D.html#a34320928cde7d8f5d203454ed61e4ba7">05760</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a34320928cde7d8f5d203454ed61e4ba7">Poly_1D::ChebyshevPoints</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keywordtype">double</span> *x)
<a name="l05761"></a>05761 {
<a name="l05762"></a>05762    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l05763"></a>05763    {
<a name="l05764"></a>05764       <span class="comment">// x[i] = 0.5*(1. + cos(M_PI*(p - i + 0.5)/(p + 1)));</span>
<a name="l05765"></a>05765       <span class="keywordtype">double</span> s = sin(M_PI_2*(i + 0.5)/(p + 1));
<a name="l05766"></a>05766       x[i] = s*s;
<a name="l05767"></a>05767    }
<a name="l05768"></a>05768 }
<a name="l05769"></a>05769 
<a name="l05770"></a><a class="code" href="classPoly__1D.html#a178987d6d9f2c828305609c511bc0290">05770</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a178987d6d9f2c828305609c511bc0290">Poly_1D::CalcMono</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u)
<a name="l05771"></a>05771 {
<a name="l05772"></a>05772    <span class="keywordtype">double</span> xn;
<a name="l05773"></a>05773    u[0] = xn = 1.;
<a name="l05774"></a>05774    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= p; n++)
<a name="l05775"></a>05775       u[n] = (xn *= x);
<a name="l05776"></a>05776 }
<a name="l05777"></a>05777 
<a name="l05778"></a><a class="code" href="classPoly__1D.html#add822fdd51d706e0d2825c1ad1defe1f">05778</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a178987d6d9f2c828305609c511bc0290">Poly_1D::CalcMono</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u, <span class="keywordtype">double</span> *d)
<a name="l05779"></a>05779 {
<a name="l05780"></a>05780    <span class="keywordtype">double</span> xn;
<a name="l05781"></a>05781    u[0] = xn = 1.;
<a name="l05782"></a>05782    d[0] = 0.;
<a name="l05783"></a>05783    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= p; n++)
<a name="l05784"></a>05784    {
<a name="l05785"></a>05785       d[n] = n * xn;
<a name="l05786"></a>05786       u[n] = (xn *= x);
<a name="l05787"></a>05787    }
<a name="l05788"></a>05788 }
<a name="l05789"></a>05789 
<a name="l05790"></a><a class="code" href="classPoly__1D.html#af3687f12ec1c5c516158622d662e5863">05790</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#af3687f12ec1c5c516158622d662e5863">Poly_1D::CalcBernstein</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u)
<a name="l05791"></a>05791 {
<a name="l05792"></a>05792    <span class="comment">// not the best way to evaluate; just for testing</span>
<a name="l05793"></a>05793    u[0] = 1.;
<a name="l05794"></a>05794    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= p; n++)
<a name="l05795"></a>05795    {
<a name="l05796"></a>05796       u[n] = x*u[n-1];
<a name="l05797"></a>05797       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = n - 1; k &gt; 0; k--)
<a name="l05798"></a>05798          u[k] = x*u[k-1] + (1. - x)*u[k];
<a name="l05799"></a>05799       u[0] = (1. - x)*u[0];
<a name="l05800"></a>05800    }
<a name="l05801"></a>05801 }
<a name="l05802"></a>05802 
<a name="l05803"></a><a class="code" href="classPoly__1D.html#a2a6d8a3846dbb89eca35e2506c4dfee0">05803</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#af3687f12ec1c5c516158622d662e5863">Poly_1D::CalcBernstein</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u, <span class="keywordtype">double</span> *d)
<a name="l05804"></a>05804 {
<a name="l05805"></a>05805    <span class="comment">// not the best way to evaluate; just for testing</span>
<a name="l05806"></a>05806    u[0] = 1.;
<a name="l05807"></a>05807    d[0] = 0.;
<a name="l05808"></a>05808    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt;= p; n++)
<a name="l05809"></a>05809    {
<a name="l05810"></a>05810       d[n] = u[n-1] + x*d[n-1];
<a name="l05811"></a>05811       u[n] = x*u[n-1];
<a name="l05812"></a>05812       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = n - 1; k &gt; 0; k--)
<a name="l05813"></a>05813       {
<a name="l05814"></a>05814          d[k] = u[k-1] + x*d[k-1] - u[k] + (1. - x)*d[k];
<a name="l05815"></a>05815          u[k] = x*u[k-1] + (1. - x)*u[k];
<a name="l05816"></a>05816       }
<a name="l05817"></a>05817       d[0] = -u[0] + (1. - x)*d[0];
<a name="l05818"></a>05818       u[0] = (1. - x)*u[0];
<a name="l05819"></a>05819    }
<a name="l05820"></a>05820 }
<a name="l05821"></a>05821 
<a name="l05822"></a><a class="code" href="classPoly__1D.html#a64d2ecc407ee9b949ccfe3b4defb461c">05822</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a64d2ecc407ee9b949ccfe3b4defb461c">Poly_1D::CalcLegendre</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u)
<a name="l05823"></a>05823 {
<a name="l05824"></a>05824    <span class="comment">// use the recursive definition for [-1,1]:</span>
<a name="l05825"></a>05825    <span class="comment">// (n+1)*P_{n+1}(z) = (2*n+1)*z*P_n(z)-n*P_{n-1}(z)</span>
<a name="l05826"></a>05826    <span class="keywordtype">double</span> z;
<a name="l05827"></a>05827    u[0] = 1.;
<a name="l05828"></a>05828    <span class="keywordflow">if</span> (p == 0) <span class="keywordflow">return</span>;
<a name="l05829"></a>05829    u[1] = z = 2.*x - 1.;
<a name="l05830"></a>05830    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt; p; n++)
<a name="l05831"></a>05831    {
<a name="l05832"></a>05832       u[n+1] = ((2*n + 1)*z*u[n] - n*u[n-1])/(n + 1);
<a name="l05833"></a>05833    }
<a name="l05834"></a>05834 }
<a name="l05835"></a>05835 
<a name="l05836"></a><a class="code" href="classPoly__1D.html#ad88ce21a44520705daa3d3e16a843a58">05836</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a64d2ecc407ee9b949ccfe3b4defb461c">Poly_1D::CalcLegendre</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u, <span class="keywordtype">double</span> *d)
<a name="l05837"></a>05837 {
<a name="l05838"></a>05838    <span class="comment">// use the recursive definition for [-1,1]:</span>
<a name="l05839"></a>05839    <span class="comment">// (n+1)*P_{n+1}(z) = (2*n+1)*z*P_n(z)-n*P_{n-1}(z)</span>
<a name="l05840"></a>05840    <span class="comment">// for the derivative use, z in [-1,1]:</span>
<a name="l05841"></a>05841    <span class="comment">// P&#39;_{n+1}(z) = (2*n+1)*P_n(z)+P&#39;_{n-1}(z)</span>
<a name="l05842"></a>05842    <span class="keywordtype">double</span> z;
<a name="l05843"></a>05843    u[0] = 1.;
<a name="l05844"></a>05844    d[0] = 0.;
<a name="l05845"></a>05845    <span class="keywordflow">if</span> (p == 0) <span class="keywordflow">return</span>;
<a name="l05846"></a>05846    u[1] = z = 2.*x - 1.;
<a name="l05847"></a>05847    d[1] = 2.;
<a name="l05848"></a>05848    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt; p; n++)
<a name="l05849"></a>05849    {
<a name="l05850"></a>05850       u[n+1] = ((2*n + 1)*z*u[n] - n*u[n-1])/(n + 1);
<a name="l05851"></a>05851       d[n+1] = (4*n + 2)*u[n] + d[n-1];
<a name="l05852"></a>05852    }
<a name="l05853"></a>05853 }
<a name="l05854"></a>05854 
<a name="l05855"></a><a class="code" href="classPoly__1D.html#a716eb36f598c81640153a496b522117f">05855</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a716eb36f598c81640153a496b522117f">Poly_1D::CalcChebyshev</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u)
<a name="l05856"></a>05856 {
<a name="l05857"></a>05857    <span class="comment">// recursive definition, z in [-1,1]</span>
<a name="l05858"></a>05858    <span class="comment">// T_0(z) = 1,  T_1(z) = z</span>
<a name="l05859"></a>05859    <span class="comment">// T_{n+1}(z) = 2*z*T_n(z) - T_{n-1}(z)</span>
<a name="l05860"></a>05860    <span class="keywordtype">double</span> z;
<a name="l05861"></a>05861    u[0] = 1.;
<a name="l05862"></a>05862    <span class="keywordflow">if</span> (p == 0) <span class="keywordflow">return</span>;
<a name="l05863"></a>05863    u[1] = z = 2.*x - 1.;
<a name="l05864"></a>05864    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt; p; n++)
<a name="l05865"></a>05865    {
<a name="l05866"></a>05866       u[n+1] = 2*z*u[n] - u[n-1];
<a name="l05867"></a>05867    }
<a name="l05868"></a>05868 }
<a name="l05869"></a>05869 
<a name="l05870"></a><a class="code" href="classPoly__1D.html#a22636bc7110b3a761bbed5acb43b89d0">05870</a> <span class="keywordtype">void</span> <a class="code" href="classPoly__1D.html#a716eb36f598c81640153a496b522117f">Poly_1D::CalcChebyshev</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> *u, <span class="keywordtype">double</span> *d)
<a name="l05871"></a>05871 {
<a name="l05872"></a>05872    <span class="comment">// recursive definition, z in [-1,1]</span>
<a name="l05873"></a>05873    <span class="comment">// T_0(z) = 1,  T_1(z) = z</span>
<a name="l05874"></a>05874    <span class="comment">// T_{n+1}(z) = 2*z*T_n(z) - T_{n-1}(z)</span>
<a name="l05875"></a>05875    <span class="comment">// T&#39;_n(z) = n*U_{n-1}(z)</span>
<a name="l05876"></a>05876    <span class="comment">// U_0(z) = 1  U_1(z) = 2*z</span>
<a name="l05877"></a>05877    <span class="comment">// U_{n+1}(z) = 2*z*U_n(z) - U_{n-1}(z)</span>
<a name="l05878"></a>05878    <span class="comment">// U_n(z) = z*U_{n-1}(z) + T_n(z) = z*T&#39;_n(z)/n + T_n(z)</span>
<a name="l05879"></a>05879    <span class="comment">// T&#39;_{n+1}(z) = (n + 1)*(z*T&#39;_n(z)/n + T_n(z))</span>
<a name="l05880"></a>05880    <span class="keywordtype">double</span> z;
<a name="l05881"></a>05881    u[0] = 1.;
<a name="l05882"></a>05882    d[0] = 0.;
<a name="l05883"></a>05883    <span class="keywordflow">if</span> (p == 0) <span class="keywordflow">return</span>;
<a name="l05884"></a>05884    u[1] = z = 2.*x - 1.;
<a name="l05885"></a>05885    d[1] = 2.;
<a name="l05886"></a>05886    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 1; n &lt; p; n++)
<a name="l05887"></a>05887    {
<a name="l05888"></a>05888       u[n+1] = 2*z*u[n] - u[n-1];
<a name="l05889"></a>05889       d[n+1] = (n + 1)*(z*d[n]/n + 2*u[n]);
<a name="l05890"></a>05890    }
<a name="l05891"></a>05891 }
<a name="l05892"></a>05892 
<a name="l05893"></a><a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">05893</a> <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">Poly_1D::OpenPoints</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l05894"></a>05894 {
<a name="l05895"></a>05895    <span class="keywordtype">double</span> *op;
<a name="l05896"></a>05896 
<a name="l05897"></a>05897    <span class="keywordflow">if</span> (<a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() &lt;= p)
<a name="l05898"></a>05898    {
<a name="l05899"></a>05899       <span class="keywordtype">int</span> i = <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>();
<a name="l05900"></a>05900       <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(p + 1);
<a name="l05901"></a>05901       <span class="keywordflow">for</span> ( ; i &lt; p; i++)
<a name="l05902"></a>05902          <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>[i] = NULL;
<a name="l05903"></a>05903       <span class="keywordflow">goto</span> alloc_open;
<a name="l05904"></a>05904    }
<a name="l05905"></a>05905    <span class="keywordflow">if</span> ((op = <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>[p]) != NULL)
<a name="l05906"></a>05906       <span class="keywordflow">return</span> op;
<a name="l05907"></a>05907 alloc_open:
<a name="l05908"></a>05908    <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>[p] = op = <span class="keyword">new</span> <span class="keywordtype">double</span>[p + 1];
<a name="l05909"></a>05909    <a class="code" href="classPoly__1D.html#a9ef701a7917eae7c684f88ac9538e718">GaussPoints</a>(p, op);
<a name="l05910"></a>05910    <span class="comment">// ChebyshevPoints(p, op);</span>
<a name="l05911"></a>05911    <span class="keywordflow">return</span> op;
<a name="l05912"></a>05912 }
<a name="l05913"></a>05913 
<a name="l05914"></a><a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">05914</a> <span class="keyword">const</span> <span class="keywordtype">double</span> *<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">Poly_1D::ClosedPoints</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l05915"></a>05915 {
<a name="l05916"></a>05916    <span class="keywordtype">double</span> *cp;
<a name="l05917"></a>05917 
<a name="l05918"></a>05918    <span class="keywordflow">if</span> (<a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() &lt;= p)
<a name="l05919"></a>05919    {
<a name="l05920"></a>05920       <span class="keywordtype">int</span> i = <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>();
<a name="l05921"></a>05921       <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(p + 1);
<a name="l05922"></a>05922       <span class="keywordflow">for</span> ( ; i &lt; p; i++)
<a name="l05923"></a>05923          <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>[i] = NULL;
<a name="l05924"></a>05924       <span class="keywordflow">goto</span> alloc_closed;
<a name="l05925"></a>05925    }
<a name="l05926"></a>05926    <span class="keywordflow">if</span> ((cp = <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>[p]) != NULL)
<a name="l05927"></a>05927       <span class="keywordflow">return</span> cp;
<a name="l05928"></a>05928 alloc_closed:
<a name="l05929"></a>05929    <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>[p] = cp = <span class="keyword">new</span> <span class="keywordtype">double</span>[p + 1];
<a name="l05930"></a>05930    <a class="code" href="classPoly__1D.html#a25e9dbaabc08741edf571677dd8ac044">GaussLobattoPoints</a>(p, cp);
<a name="l05931"></a>05931    <span class="comment">// UniformPoints(p, cp);</span>
<a name="l05932"></a>05932    <span class="keywordflow">return</span> cp;
<a name="l05933"></a>05933 }
<a name="l05934"></a>05934 
<a name="l05935"></a><a class="code" href="classPoly__1D.html#a5b1210927e2905fc6fdc01d6574ba02b">05935</a> <a class="code" href="classPoly__1D_1_1Basis.html">Poly_1D::Basis</a> &amp;<a class="code" href="classPoly__1D.html#a5b1210927e2905fc6fdc01d6574ba02b">Poly_1D::OpenBasis</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l05936"></a>05936 {
<a name="l05937"></a>05937    <a class="code" href="classPoly__1D_1_1Basis.html">Basis</a> *ob;
<a name="l05938"></a>05938 
<a name="l05939"></a>05939    <span class="keywordflow">if</span> (<a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() &lt;= p)
<a name="l05940"></a>05940    {
<a name="l05941"></a>05941       <span class="keywordtype">int</span> i = <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>();
<a name="l05942"></a>05942       <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(p + 1);
<a name="l05943"></a>05943       <span class="keywordflow">for</span> ( ; i &lt; p; i++)
<a name="l05944"></a>05944          <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>[i] = NULL;
<a name="l05945"></a>05945       <span class="keywordflow">goto</span> alloc_obasis;
<a name="l05946"></a>05946    }
<a name="l05947"></a>05947    <span class="keywordflow">if</span> ((ob = <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>[p]) != NULL)
<a name="l05948"></a>05948       <span class="keywordflow">return</span> *ob;
<a name="l05949"></a>05949 alloc_obasis:
<a name="l05950"></a>05950    <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>[p] = ob = <span class="keyword">new</span> <a class="code" href="classPoly__1D_1_1Basis.html">Basis</a>(p, <a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p));
<a name="l05951"></a>05951    <span class="keywordflow">return</span> *ob;
<a name="l05952"></a>05952 }
<a name="l05953"></a>05953 
<a name="l05954"></a><a class="code" href="classPoly__1D.html#abf7b9611cf43917a06aca744b23998fe">05954</a> <a class="code" href="classPoly__1D_1_1Basis.html">Poly_1D::Basis</a> &amp;<a class="code" href="classPoly__1D.html#abf7b9611cf43917a06aca744b23998fe">Poly_1D::ClosedBasis</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l05955"></a>05955 {
<a name="l05956"></a>05956    <a class="code" href="classPoly__1D_1_1Basis.html">Basis</a> *cb;
<a name="l05957"></a>05957 
<a name="l05958"></a>05958    <span class="keywordflow">if</span> (<a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() &lt;= p)
<a name="l05959"></a>05959    {
<a name="l05960"></a>05960       <span class="keywordtype">int</span> i = <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>();
<a name="l05961"></a>05961       <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(p + 1);
<a name="l05962"></a>05962       <span class="keywordflow">for</span> ( ; i &lt; p; i++)
<a name="l05963"></a>05963          <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>[i] = NULL;
<a name="l05964"></a>05964       <span class="keywordflow">goto</span> alloc_cbasis;
<a name="l05965"></a>05965    }
<a name="l05966"></a>05966    <span class="keywordflow">if</span> ((cb = <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>[p]) != NULL)
<a name="l05967"></a>05967       <span class="keywordflow">return</span> *cb;
<a name="l05968"></a>05968 alloc_cbasis:
<a name="l05969"></a>05969    <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>[p] = cb = <span class="keyword">new</span> <a class="code" href="classPoly__1D_1_1Basis.html">Basis</a>(p, <a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p));
<a name="l05970"></a>05970    <span class="keywordflow">return</span> *cb;
<a name="l05971"></a>05971 }
<a name="l05972"></a>05972 
<a name="l05973"></a><a class="code" href="classPoly__1D.html#a5185ea9882b5b3250d1df39912a7bd88">05973</a> <a class="code" href="classPoly__1D.html#a5185ea9882b5b3250d1df39912a7bd88">Poly_1D::~Poly_1D</a>()
<a name="l05974"></a>05974 {
<a name="l05975"></a>05975    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l05976"></a>05976       <span class="keyword">delete</span> [] <a class="code" href="classPoly__1D.html#a525b845e4b81b9f3b0ad16e995112741">open_pts</a>[i];
<a name="l05977"></a>05977    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l05978"></a>05978       <span class="keyword">delete</span> [] <a class="code" href="classPoly__1D.html#a059001c75b1ad554fa04dfa6e003ea15">closed_pts</a>[i];
<a name="l05979"></a>05979    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l05980"></a>05980       <span class="keyword">delete</span> <a class="code" href="classPoly__1D.html#a8dcecb9bebfbce8ab2b024f5607aa204">open_basis</a>[i];
<a name="l05981"></a>05981    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l05982"></a>05982       <span class="keyword">delete</span> <a class="code" href="classPoly__1D.html#a1d90bb54783285989311e9e8d16fd1e4">closed_basis</a>[i];
<a name="l05983"></a>05983 }
<a name="l05984"></a>05984 
<a name="l05985"></a><a class="code" href="fe_8hpp.html#a378c89335bc16a1ef53998fd55090331">05985</a> <a class="code" href="classPoly__1D.html">Poly_1D</a> <a class="code" href="fe_8cpp.html#a378c89335bc16a1ef53998fd55090331">poly1d</a>;
<a name="l05986"></a>05986 
<a name="l05987"></a>05987 
<a name="l05988"></a><a class="code" href="classH1__SegmentElement.html#a9048edbdf02ba0d37d684841038f5766">05988</a> <a class="code" href="classH1__SegmentElement.html#a9048edbdf02ba0d37d684841038f5766">H1_SegmentElement::H1_SegmentElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l05989"></a>05989    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, p + 1, p, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk),
<a name="l05990"></a>05990      basis1d(poly1d.<a class="code" href="classPoly__1D.html#abf7b9611cf43917a06aca744b23998fe">ClosedBasis</a>(p))
<a name="l05991"></a>05991 {
<a name="l05992"></a>05992    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l05993"></a>05993 
<a name="l05994"></a>05994 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l05995"></a>05995 <span class="preprocessor"></span>   <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p+1);
<a name="l05996"></a>05996    <a class="code" href="classH1__SegmentElement.html#a495bcc5b084ee484149a874da33bceaf">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p+1);
<a name="l05997"></a>05997 <span class="preprocessor">#endif</span>
<a name="l05998"></a>05998 <span class="preprocessor"></span>
<a name="l05999"></a>05999    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = cp[0];
<a name="l06000"></a>06000    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = cp[p];
<a name="l06001"></a>06001    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06002"></a>06002       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i+1).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = cp[i];
<a name="l06003"></a>06003 }
<a name="l06004"></a>06004 
<a name="l06005"></a><a class="code" href="classH1__SegmentElement.html#a2a89dc70566064a5cb35402844c4b4d3">06005</a> <span class="keywordtype">void</span> <a class="code" href="classH1__SegmentElement.html#a2a89dc70566064a5cb35402844c4b4d3">H1_SegmentElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06006"></a>06006                                   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06007"></a>06007 <span class="keyword"></span>{
<a name="l06008"></a>06008    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06009"></a>06009 
<a name="l06010"></a>06010 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06011"></a>06011 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>(p+1);
<a name="l06012"></a>06012 <span class="preprocessor">#endif</span>
<a name="l06013"></a>06013 <span class="preprocessor"></span>
<a name="l06014"></a>06014    <a class="code" href="classH1__SegmentElement.html#a87104e2bc01dba1fbb63f272f04ce8b1">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, shape_x);
<a name="l06015"></a>06015 
<a name="l06016"></a>06016    shape(0) = <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>(0);
<a name="l06017"></a>06017    shape(1) = <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>(p);
<a name="l06018"></a>06018    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06019"></a>06019       shape(i+1) = <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>(i);
<a name="l06020"></a>06020 }
<a name="l06021"></a>06021 
<a name="l06022"></a><a class="code" href="classH1__SegmentElement.html#a363dfed24a495915b091af6116b40bfe">06022</a> <span class="keywordtype">void</span> <a class="code" href="classH1__SegmentElement.html#a363dfed24a495915b091af6116b40bfe">H1_SegmentElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06023"></a>06023                                    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06024"></a>06024 <span class="keyword"></span>{
<a name="l06025"></a>06025    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06026"></a>06026 
<a name="l06027"></a>06027 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06028"></a>06028 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>(p+1), <a class="code" href="classH1__SegmentElement.html#a495bcc5b084ee484149a874da33bceaf">dshape_x</a>(p+1);
<a name="l06029"></a>06029 <span class="preprocessor">#endif</span>
<a name="l06030"></a>06030 <span class="preprocessor"></span>
<a name="l06031"></a>06031    <a class="code" href="classH1__SegmentElement.html#a87104e2bc01dba1fbb63f272f04ce8b1">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__SegmentElement.html#ac864eeb31bc5a25453109bae82e99aad">shape_x</a>, dshape_x);
<a name="l06032"></a>06032 
<a name="l06033"></a>06033    dshape(0,0) = <a class="code" href="classH1__SegmentElement.html#a495bcc5b084ee484149a874da33bceaf">dshape_x</a>(0);
<a name="l06034"></a>06034    dshape(1,0) = <a class="code" href="classH1__SegmentElement.html#a495bcc5b084ee484149a874da33bceaf">dshape_x</a>(p);
<a name="l06035"></a>06035    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06036"></a>06036       dshape(i+1,0) = <a class="code" href="classH1__SegmentElement.html#a495bcc5b084ee484149a874da33bceaf">dshape_x</a>(i);
<a name="l06037"></a>06037 }
<a name="l06038"></a>06038 
<a name="l06039"></a>06039 
<a name="l06040"></a><a class="code" href="classH1__QuadrilateralElement.html#adaaca46725b2595c6da4ec3c7153decd">06040</a> <a class="code" href="classH1__QuadrilateralElement.html#adaaca46725b2595c6da4ec3c7153decd">H1_QuadrilateralElement::H1_QuadrilateralElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06041"></a>06041    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, (p + 1)*(p + 1), p,
<a name="l06042"></a>06042                         <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk),
<a name="l06043"></a>06043      basis1d(poly1d.ClosedBasis(p)), dof_map((p + 1)*(p + 1))
<a name="l06044"></a>06044 {
<a name="l06045"></a>06045    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l06046"></a>06046 
<a name="l06047"></a>06047    <span class="keyword">const</span> <span class="keywordtype">int</span> p1 = p + 1;
<a name="l06048"></a>06048 
<a name="l06049"></a>06049 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06050"></a>06050 <span class="preprocessor"></span>   <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06051"></a>06051    <a class="code" href="classH1__QuadrilateralElement.html#af86ef48aa7661a08a03c5283b278a20e">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06052"></a>06052    <a class="code" href="classH1__QuadrilateralElement.html#acdaa9581549a71752c997afaa058fc28">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06053"></a>06053    <a class="code" href="classH1__QuadrilateralElement.html#ad3b7298cb7a74eed2b21ccc6f9fd6dbb">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06054"></a>06054 <span class="preprocessor">#endif</span>
<a name="l06055"></a>06055 <span class="preprocessor"></span>
<a name="l06056"></a>06056    <span class="comment">// vertices</span>
<a name="l06057"></a>06057    <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[0 + 0*p1] = 0;
<a name="l06058"></a>06058    <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[p + 0*p1] = 1;
<a name="l06059"></a>06059    <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[p + p*p1] = 2;
<a name="l06060"></a>06060    <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[0 + p*p1] = 3;
<a name="l06061"></a>06061 
<a name="l06062"></a>06062    <span class="comment">// edges</span>
<a name="l06063"></a>06063    <span class="keywordtype">int</span> o = 4;
<a name="l06064"></a>06064    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06065"></a>06065       <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[i + 0*p1] = o++;
<a name="l06066"></a>06066    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06067"></a>06067       <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[p + i*p1] = o++;
<a name="l06068"></a>06068    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06069"></a>06069       <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[(p-i) + p*p1] = o++;
<a name="l06070"></a>06070    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06071"></a>06071       <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[0 + (p-i)*p1] = o++;
<a name="l06072"></a>06072 
<a name="l06073"></a>06073    <span class="comment">// interior</span>
<a name="l06074"></a>06074    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06075"></a>06075       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06076"></a>06076          <a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[i + j*p1] = o++;
<a name="l06077"></a>06077 
<a name="l06078"></a>06078    o = 0;
<a name="l06079"></a>06079    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06080"></a>06080       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06081"></a>06081          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(<a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[o++]).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[i], cp[j]);
<a name="l06082"></a>06082 }
<a name="l06083"></a>06083 
<a name="l06084"></a><a class="code" href="classH1__QuadrilateralElement.html#acb446068515fc558c890a9ed25a786ff">06084</a> <span class="keywordtype">void</span> <a class="code" href="classH1__QuadrilateralElement.html#acb446068515fc558c890a9ed25a786ff">H1_QuadrilateralElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06085"></a>06085                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06086"></a>06086 <span class="keyword"></span>{
<a name="l06087"></a>06087    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06088"></a>06088 
<a name="l06089"></a>06089 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06090"></a>06090 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>(p+1), <a class="code" href="classH1__QuadrilateralElement.html#af86ef48aa7661a08a03c5283b278a20e">shape_y</a>(p+1);
<a name="l06091"></a>06091 <span class="preprocessor">#endif</span>
<a name="l06092"></a>06092 <span class="preprocessor"></span>
<a name="l06093"></a>06093    <a class="code" href="classH1__QuadrilateralElement.html#abea35f1058c78b655faff9f7c9de056f">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>);
<a name="l06094"></a>06094    <a class="code" href="classH1__QuadrilateralElement.html#abea35f1058c78b655faff9f7c9de056f">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_y);
<a name="l06095"></a>06095 
<a name="l06096"></a>06096    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06097"></a>06097       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06098"></a>06098          shape(<a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[o++]) = <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>(i)*<a class="code" href="classH1__QuadrilateralElement.html#af86ef48aa7661a08a03c5283b278a20e">shape_y</a>(j);
<a name="l06099"></a>06099 }
<a name="l06100"></a>06100 
<a name="l06101"></a><a class="code" href="classH1__QuadrilateralElement.html#a8a1a77c96ceec5ca113f97d69126c891">06101</a> <span class="keywordtype">void</span> <a class="code" href="classH1__QuadrilateralElement.html#a8a1a77c96ceec5ca113f97d69126c891">H1_QuadrilateralElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06102"></a>06102                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06103"></a>06103 <span class="keyword"></span>{
<a name="l06104"></a>06104    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06105"></a>06105 
<a name="l06106"></a>06106 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06107"></a>06107 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>(p+1), <a class="code" href="classH1__QuadrilateralElement.html#af86ef48aa7661a08a03c5283b278a20e">shape_y</a>(p+1), <a class="code" href="classH1__QuadrilateralElement.html#acdaa9581549a71752c997afaa058fc28">dshape_x</a>(p+1), <a class="code" href="classH1__QuadrilateralElement.html#ad3b7298cb7a74eed2b21ccc6f9fd6dbb">dshape_y</a>(p+1);
<a name="l06108"></a>06108 <span class="preprocessor">#endif</span>
<a name="l06109"></a>06109 <span class="preprocessor"></span>
<a name="l06110"></a>06110    <a class="code" href="classH1__QuadrilateralElement.html#abea35f1058c78b655faff9f7c9de056f">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>, <a class="code" href="classH1__QuadrilateralElement.html#acdaa9581549a71752c997afaa058fc28">dshape_x</a>);
<a name="l06111"></a>06111    <a class="code" href="classH1__QuadrilateralElement.html#abea35f1058c78b655faff9f7c9de056f">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__QuadrilateralElement.html#af86ef48aa7661a08a03c5283b278a20e">shape_y</a>, dshape_y);
<a name="l06112"></a>06112 
<a name="l06113"></a>06113    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06114"></a>06114       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06115"></a>06115       {
<a name="l06116"></a>06116          dshape(<a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[o],0) = <a class="code" href="classH1__QuadrilateralElement.html#acdaa9581549a71752c997afaa058fc28">dshape_x</a>(i)* <a class="code" href="classH1__QuadrilateralElement.html#af86ef48aa7661a08a03c5283b278a20e">shape_y</a>(j);
<a name="l06117"></a>06117          dshape(<a class="code" href="classH1__QuadrilateralElement.html#a65d7c4121d6f2a64af0a936f6b438df6">dof_map</a>[o],1) =  <a class="code" href="classH1__QuadrilateralElement.html#a70ee4346dd891e912ae677363a74314d">shape_x</a>(i)*<a class="code" href="classH1__QuadrilateralElement.html#ad3b7298cb7a74eed2b21ccc6f9fd6dbb">dshape_y</a>(j);  o++;
<a name="l06118"></a>06118       }
<a name="l06119"></a>06119 }
<a name="l06120"></a>06120 
<a name="l06121"></a><a class="code" href="classH1__HexahedronElement.html#a81ec2570ba3f32d98975f01ac75a054e">06121</a> <a class="code" href="classH1__HexahedronElement.html#a81ec2570ba3f32d98975f01ac75a054e">H1_HexahedronElement::H1_HexahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06122"></a>06122    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, (p + 1)*(p + 1)*(p + 1), p,
<a name="l06123"></a>06123                         <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk),
<a name="l06124"></a>06124      basis1d(poly1d.ClosedBasis(p)), dof_map((p + 1)*(p + 1)*(p + 1))
<a name="l06125"></a>06125 {
<a name="l06126"></a>06126    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l06127"></a>06127 
<a name="l06128"></a>06128    <span class="keyword">const</span> <span class="keywordtype">int</span> p1 = p + 1;
<a name="l06129"></a>06129 
<a name="l06130"></a>06130 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06131"></a>06131 <span class="preprocessor"></span>   <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06132"></a>06132    <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06133"></a>06133    <a class="code" href="classH1__HexahedronElement.html#a9d3be65ed85ece95c03dbd2076eadb85">shape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06134"></a>06134    <a class="code" href="classH1__HexahedronElement.html#a1b24d6ae4afb602074a275a911df1383">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06135"></a>06135    <a class="code" href="classH1__HexahedronElement.html#af6d9a49a655c48f982d6b59565d9d5d7">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06136"></a>06136    <a class="code" href="classH1__HexahedronElement.html#a0a50ad9587f2a5e41acb9754e3c5cb58">dshape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p1);
<a name="l06137"></a>06137 <span class="preprocessor">#endif</span>
<a name="l06138"></a>06138 <span class="preprocessor"></span>
<a name="l06139"></a>06139    <span class="comment">// vertices</span>
<a name="l06140"></a>06140    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (0 + 0*p1)*p1] = 0;
<a name="l06141"></a>06141    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (0 + 0*p1)*p1] = 1;
<a name="l06142"></a>06142    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (p + 0*p1)*p1] = 2;
<a name="l06143"></a>06143    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (p + 0*p1)*p1] = 3;
<a name="l06144"></a>06144    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (0 + p*p1)*p1] = 4;
<a name="l06145"></a>06145    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (0 + p*p1)*p1] = 5;
<a name="l06146"></a>06146    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (p + p*p1)*p1] = 6;
<a name="l06147"></a>06147    <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (p + p*p1)*p1] = 7;
<a name="l06148"></a>06148 
<a name="l06149"></a>06149    <span class="comment">// edges (see Hexahedron::edges in mesh/hexahedron.cpp)</span>
<a name="l06150"></a>06150    <span class="keywordtype">int</span> o = 8;
<a name="l06151"></a>06151    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06152"></a>06152       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (0 + 0*p1)*p1] = o++;  <span class="comment">// (0,1)</span>
<a name="l06153"></a>06153    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06154"></a>06154       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (i + 0*p1)*p1] = o++;  <span class="comment">// (1,2)</span>
<a name="l06155"></a>06155    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06156"></a>06156       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (p + 0*p1)*p1] = o++;  <span class="comment">// (3,2)</span>
<a name="l06157"></a>06157    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06158"></a>06158       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (i + 0*p1)*p1] = o++;  <span class="comment">// (0,3)</span>
<a name="l06159"></a>06159    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06160"></a>06160       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (0 + p*p1)*p1] = o++;  <span class="comment">// (4,5)</span>
<a name="l06161"></a>06161    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06162"></a>06162       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (i + p*p1)*p1] = o++;  <span class="comment">// (5,6)</span>
<a name="l06163"></a>06163    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06164"></a>06164       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (p + p*p1)*p1] = o++;  <span class="comment">// (7,6)</span>
<a name="l06165"></a>06165    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06166"></a>06166       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (i + p*p1)*p1] = o++;  <span class="comment">// (4,7)</span>
<a name="l06167"></a>06167    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06168"></a>06168       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (0 + i*p1)*p1] = o++;  <span class="comment">// (0,4)</span>
<a name="l06169"></a>06169    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06170"></a>06170       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (0 + i*p1)*p1] = o++;  <span class="comment">// (1,5)</span>
<a name="l06171"></a>06171    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06172"></a>06172       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (p + i*p1)*p1] = o++;  <span class="comment">// (2,6)</span>
<a name="l06173"></a>06173    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06174"></a>06174       <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + (p + i*p1)*p1] = o++;  <span class="comment">// (3,7)</span>
<a name="l06175"></a>06175 
<a name="l06176"></a>06176    <span class="comment">// faces (see Mesh::GenerateFaces in mesh/mesh.cpp)</span>
<a name="l06177"></a>06177    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06178"></a>06178       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06179"></a>06179          <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + ((p-j) + 0*p1)*p1] = o++;  <span class="comment">// (3,2,1,0)</span>
<a name="l06180"></a>06180    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06181"></a>06181       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06182"></a>06182          <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (0 + j*p1)*p1] = o++;  <span class="comment">// (0,1,5,4)</span>
<a name="l06183"></a>06183    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06184"></a>06184       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06185"></a>06185          <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[p + (i + j*p1)*p1] = o++;  <span class="comment">// (1,2,6,5)</span>
<a name="l06186"></a>06186    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06187"></a>06187       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06188"></a>06188          <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[(p-i) + (p + j*p1)*p1] = o++;  <span class="comment">// (2,3,7,6)</span>
<a name="l06189"></a>06189    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06190"></a>06190       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06191"></a>06191          <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[0 + ((p-i) + j*p1)*p1] = o++;  <span class="comment">// (3,0,4,7)</span>
<a name="l06192"></a>06192    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06193"></a>06193       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06194"></a>06194          <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (j + p*p1)*p1] = o++;  <span class="comment">// (4,5,6,7)</span>
<a name="l06195"></a>06195 
<a name="l06196"></a>06196    <span class="comment">// interior</span>
<a name="l06197"></a>06197    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++)
<a name="l06198"></a>06198       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06199"></a>06199          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06200"></a>06200             <a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[i + (j + k*p1)*p1] = o++;
<a name="l06201"></a>06201 
<a name="l06202"></a>06202    o = 0;
<a name="l06203"></a>06203    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l06204"></a>06204       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06205"></a>06205          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06206"></a>06206             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(<a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[o++]).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i], cp[j], cp[k]);
<a name="l06207"></a>06207 }
<a name="l06208"></a>06208 
<a name="l06209"></a><a class="code" href="classH1__HexahedronElement.html#aa858d7c1ce2a93086a5f9b938272fe74">06209</a> <span class="keywordtype">void</span> <a class="code" href="classH1__HexahedronElement.html#aa858d7c1ce2a93086a5f9b938272fe74">H1_HexahedronElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06210"></a>06210                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06211"></a>06211 <span class="keyword"></span>{
<a name="l06212"></a>06212    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06213"></a>06213 
<a name="l06214"></a>06214 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06215"></a>06215 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>(p+1), <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>(p+1), <a class="code" href="classH1__HexahedronElement.html#a9d3be65ed85ece95c03dbd2076eadb85">shape_z</a>(p+1);
<a name="l06216"></a>06216 <span class="preprocessor">#endif</span>
<a name="l06217"></a>06217 <span class="preprocessor"></span>
<a name="l06218"></a>06218    <a class="code" href="classH1__HexahedronElement.html#aaf714c67207781668ba28b0373ae967c">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>);
<a name="l06219"></a>06219    <a class="code" href="classH1__HexahedronElement.html#aaf714c67207781668ba28b0373ae967c">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>);
<a name="l06220"></a>06220    <a class="code" href="classH1__HexahedronElement.html#aaf714c67207781668ba28b0373ae967c">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_z);
<a name="l06221"></a>06221 
<a name="l06222"></a>06222    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06223"></a>06223       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06224"></a>06224          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06225"></a>06225             shape(<a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[o++]) = <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>(i)*<a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>(j)*<a class="code" href="classH1__HexahedronElement.html#a9d3be65ed85ece95c03dbd2076eadb85">shape_z</a>(k);
<a name="l06226"></a>06226 }
<a name="l06227"></a>06227 
<a name="l06228"></a><a class="code" href="classH1__HexahedronElement.html#a4316983c8d2971ede323f1564f05e117">06228</a> <span class="keywordtype">void</span> <a class="code" href="classH1__HexahedronElement.html#a4316983c8d2971ede323f1564f05e117">H1_HexahedronElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06229"></a>06229                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06230"></a>06230 <span class="keyword"></span>{
<a name="l06231"></a>06231    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06232"></a>06232 
<a name="l06233"></a>06233 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06234"></a>06234 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>(p+1),  <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>(p+1),  <a class="code" href="classH1__HexahedronElement.html#a9d3be65ed85ece95c03dbd2076eadb85">shape_z</a>(p+1);
<a name="l06235"></a>06235    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__HexahedronElement.html#a1b24d6ae4afb602074a275a911df1383">dshape_x</a>(p+1), <a class="code" href="classH1__HexahedronElement.html#af6d9a49a655c48f982d6b59565d9d5d7">dshape_y</a>(p+1), <a class="code" href="classH1__HexahedronElement.html#a0a50ad9587f2a5e41acb9754e3c5cb58">dshape_z</a>(p+1);
<a name="l06236"></a>06236 <span class="preprocessor">#endif</span>
<a name="l06237"></a>06237 <span class="preprocessor"></span>
<a name="l06238"></a>06238    <a class="code" href="classH1__HexahedronElement.html#aaf714c67207781668ba28b0373ae967c">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>, <a class="code" href="classH1__HexahedronElement.html#a1b24d6ae4afb602074a275a911df1383">dshape_x</a>);
<a name="l06239"></a>06239    <a class="code" href="classH1__HexahedronElement.html#aaf714c67207781668ba28b0373ae967c">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>, <a class="code" href="classH1__HexahedronElement.html#af6d9a49a655c48f982d6b59565d9d5d7">dshape_y</a>);
<a name="l06240"></a>06240    <a class="code" href="classH1__HexahedronElement.html#aaf714c67207781668ba28b0373ae967c">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_z, dshape_z);
<a name="l06241"></a>06241 
<a name="l06242"></a>06242    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06243"></a>06243       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06244"></a>06244          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06245"></a>06245          {
<a name="l06246"></a>06246             dshape(<a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[o],0) = <a class="code" href="classH1__HexahedronElement.html#a1b24d6ae4afb602074a275a911df1383">dshape_x</a>(i)* <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>(j)* <a class="code" href="classH1__HexahedronElement.html#a9d3be65ed85ece95c03dbd2076eadb85">shape_z</a>(k);
<a name="l06247"></a>06247             dshape(<a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[o],1) =  <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>(i)*<a class="code" href="classH1__HexahedronElement.html#af6d9a49a655c48f982d6b59565d9d5d7">dshape_y</a>(j)* <a class="code" href="classH1__HexahedronElement.html#a9d3be65ed85ece95c03dbd2076eadb85">shape_z</a>(k);
<a name="l06248"></a>06248             dshape(<a class="code" href="classH1__HexahedronElement.html#ad7282a01d5e6e7be8248e62946be19a8">dof_map</a>[o],2) =  <a class="code" href="classH1__HexahedronElement.html#ad66c7df4055291316a5919a0bbe8addf">shape_x</a>(i)* <a class="code" href="classH1__HexahedronElement.html#a95d33a193499618a207ad86b5383934a">shape_y</a>(j)*<a class="code" href="classH1__HexahedronElement.html#a0a50ad9587f2a5e41acb9754e3c5cb58">dshape_z</a>(k);  o++;
<a name="l06249"></a>06249          }
<a name="l06250"></a>06250 }
<a name="l06251"></a>06251 
<a name="l06252"></a>06252 
<a name="l06253"></a><a class="code" href="classH1__TriangleElement.html#a9a22637af6916196e70e54aebd37ccad">06253</a> <a class="code" href="classH1__TriangleElement.html#a9a22637af6916196e70e54aebd37ccad">H1_TriangleElement::H1_TriangleElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06254"></a>06254    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, ((p + 1)*(p + 2))/2, p,
<a name="l06255"></a>06255                         <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), T(Dof)
<a name="l06256"></a>06256 {
<a name="l06257"></a>06257    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l06258"></a>06258 
<a name="l06259"></a>06259 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06260"></a>06260 <span class="preprocessor"></span>   <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06261"></a>06261    <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06262"></a>06262    <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06263"></a>06263    <a class="code" href="classH1__TriangleElement.html#abd165dfb263fed7d0e34669ee5c354e7">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06264"></a>06264    <a class="code" href="classH1__TriangleElement.html#af60ab165d3c7c8a362571ec0de2fb3fd">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06265"></a>06265    <a class="code" href="classH1__TriangleElement.html#a77c58d2617744286f69309750c1b00df">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06266"></a>06266    <a class="code" href="classH1__TriangleElement.html#a1f93bbcdb474fda49439411619dcf021">u</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06267"></a>06267    <a class="code" href="classH1__TriangleElement.html#a430de308f1eec860bb87d4b64ad15a26">du</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06268"></a>06268 <span class="preprocessor">#else</span>
<a name="l06269"></a>06269 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(p + 1);
<a name="l06270"></a>06270 <span class="preprocessor">#endif</span>
<a name="l06271"></a>06271 <span class="preprocessor"></span>
<a name="l06272"></a>06272    <span class="comment">// vertices</span>
<a name="l06273"></a>06273    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[0], cp[0]);
<a name="l06274"></a>06274    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[p], cp[0]);
<a name="l06275"></a>06275    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[0], cp[p]);
<a name="l06276"></a>06276 
<a name="l06277"></a>06277    <span class="comment">// edges</span>
<a name="l06278"></a>06278    <span class="keywordtype">int</span> o = 3;
<a name="l06279"></a>06279    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06280"></a>06280       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[i], cp[0]);
<a name="l06281"></a>06281    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06282"></a>06282       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[p-i], cp[i]);
<a name="l06283"></a>06283    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l06284"></a>06284       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[0], cp[p-i]);
<a name="l06285"></a>06285 
<a name="l06286"></a>06286    <span class="comment">// interior</span>
<a name="l06287"></a>06287    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06288"></a>06288       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i + j &lt; p; i++)
<a name="l06289"></a>06289       {
<a name="l06290"></a>06290          <span class="keyword">const</span> <span class="keywordtype">double</span> w = cp[i] + cp[j] + cp[p-i-j];
<a name="l06291"></a>06291          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[i]/w, cp[j]/w);
<a name="l06292"></a>06292       }
<a name="l06293"></a>06293 
<a name="l06294"></a>06294    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l06295"></a>06295    {
<a name="l06296"></a>06296       <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l06297"></a>06297       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>);
<a name="l06298"></a>06298       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>);
<a name="l06299"></a>06299       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l);
<a name="l06300"></a>06300 
<a name="l06301"></a>06301       o = 0;
<a name="l06302"></a>06302       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06303"></a>06303          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06304"></a>06304             <a class="code" href="classH1__TriangleElement.html#a3ff3657a0b6b5224ccb4820db558c3f8">T</a>(o++, k) = <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(i)*<a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(j)*<a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(p-i-j);
<a name="l06305"></a>06305    }
<a name="l06306"></a>06306 
<a name="l06307"></a>06307    <a class="code" href="classH1__TriangleElement.html#a3ff3657a0b6b5224ccb4820db558c3f8">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l06308"></a>06308    <span class="comment">// cout &lt;&lt; &quot;H1_TriangleElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l06309"></a>06309 }
<a name="l06310"></a>06310 
<a name="l06311"></a><a class="code" href="classH1__TriangleElement.html#a9d0a9843f3f5cbd2c8c82ee7069ee305">06311</a> <span class="keywordtype">void</span> <a class="code" href="classH1__TriangleElement.html#a9d0a9843f3f5cbd2c8c82ee7069ee305">H1_TriangleElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06312"></a>06312                                    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06313"></a>06313 <span class="keyword"></span>{
<a name="l06314"></a>06314    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06315"></a>06315 
<a name="l06316"></a>06316 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06317"></a>06317 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#a1f93bbcdb474fda49439411619dcf021">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06318"></a>06318 <span class="preprocessor">#endif</span>
<a name="l06319"></a>06319 <span class="preprocessor"></span>
<a name="l06320"></a>06320    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>);
<a name="l06321"></a>06321    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>);
<a name="l06322"></a>06322    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>);
<a name="l06323"></a>06323 
<a name="l06324"></a>06324    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06325"></a>06325       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06326"></a>06326          <a class="code" href="classH1__TriangleElement.html#a1f93bbcdb474fda49439411619dcf021">u</a>(o++) = <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(i)*<a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(j)*<a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(p-i-j);
<a name="l06327"></a>06327 
<a name="l06328"></a>06328    <a class="code" href="classH1__TriangleElement.html#a3ff3657a0b6b5224ccb4820db558c3f8">T</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(u, shape);
<a name="l06329"></a>06329 }
<a name="l06330"></a>06330 
<a name="l06331"></a><a class="code" href="classH1__TriangleElement.html#a59ae9e677208b29140c0c6df72a03b23">06331</a> <span class="keywordtype">void</span> <a class="code" href="classH1__TriangleElement.html#a59ae9e677208b29140c0c6df72a03b23">H1_TriangleElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06332"></a>06332                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06333"></a>06333 <span class="keyword"></span>{
<a name="l06334"></a>06334    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06335"></a>06335 
<a name="l06336"></a>06336 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06337"></a>06337 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a>  <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(p + 1),  <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(p + 1),  <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(p + 1);
<a name="l06338"></a>06338    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TriangleElement.html#abd165dfb263fed7d0e34669ee5c354e7">dshape_x</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#af60ab165d3c7c8a362571ec0de2fb3fd">dshape_y</a>(p + 1), <a class="code" href="classH1__TriangleElement.html#a77c58d2617744286f69309750c1b00df">dshape_l</a>(p + 1);
<a name="l06339"></a>06339    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classH1__TriangleElement.html#a430de308f1eec860bb87d4b64ad15a26">du</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06340"></a>06340 <span class="preprocessor">#endif</span>
<a name="l06341"></a>06341 <span class="preprocessor"></span>
<a name="l06342"></a>06342    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>, <a class="code" href="classH1__TriangleElement.html#abd165dfb263fed7d0e34669ee5c354e7">dshape_x</a>);
<a name="l06343"></a>06343    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>, <a class="code" href="classH1__TriangleElement.html#af60ab165d3c7c8a362571ec0de2fb3fd">dshape_y</a>);
<a name="l06344"></a>06344    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l, dshape_l);
<a name="l06345"></a>06345 
<a name="l06346"></a>06346    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06347"></a>06347       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06348"></a>06348       {
<a name="l06349"></a>06349          <span class="keywordtype">int</span> k = p - i - j;
<a name="l06350"></a>06350          <a class="code" href="classH1__TriangleElement.html#a430de308f1eec860bb87d4b64ad15a26">du</a>(o,0) = ((<a class="code" href="classH1__TriangleElement.html#abd165dfb263fed7d0e34669ee5c354e7">dshape_x</a>(i)* <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(k)) -
<a name="l06351"></a>06351                     ( <a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(i)*<a class="code" href="classH1__TriangleElement.html#a77c58d2617744286f69309750c1b00df">dshape_l</a>(k)))*<a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(j);
<a name="l06352"></a>06352          <a class="code" href="classH1__TriangleElement.html#a430de308f1eec860bb87d4b64ad15a26">du</a>(o,1) = ((<a class="code" href="classH1__TriangleElement.html#af60ab165d3c7c8a362571ec0de2fb3fd">dshape_y</a>(j)* <a class="code" href="classH1__TriangleElement.html#a39ae3ef2b20a99904c28fd145e4548c0">shape_l</a>(k)) -
<a name="l06353"></a>06353                     ( <a class="code" href="classH1__TriangleElement.html#ac45353c3a859d3a02e39329e7c2f782a">shape_y</a>(j)*<a class="code" href="classH1__TriangleElement.html#a77c58d2617744286f69309750c1b00df">dshape_l</a>(k)))*<a class="code" href="classH1__TriangleElement.html#a615558b6aa4e000c82031808093be66e">shape_x</a>(i);
<a name="l06354"></a>06354          o++;
<a name="l06355"></a>06355       }
<a name="l06356"></a>06356 
<a name="l06357"></a>06357    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classH1__TriangleElement.html#a3ff3657a0b6b5224ccb4820db558c3f8">T</a>, du, dshape);
<a name="l06358"></a>06358 }
<a name="l06359"></a>06359 
<a name="l06360"></a>06360 
<a name="l06361"></a><a class="code" href="classH1__TetrahedronElement.html#a3187473d11f7143f97860f04e65e3a3e">06361</a> <a class="code" href="classH1__TetrahedronElement.html#a3187473d11f7143f97860f04e65e3a3e">H1_TetrahedronElement::H1_TetrahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06362"></a>06362    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, ((p + 1)*(p + 2)*(p + 3))/6,
<a name="l06363"></a>06363                         p, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), T(Dof)
<a name="l06364"></a>06364 {
<a name="l06365"></a>06365    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l06366"></a>06366 
<a name="l06367"></a>06367 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06368"></a>06368 <span class="preprocessor"></span>   <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06369"></a>06369    <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06370"></a>06370    <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06371"></a>06371    <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06372"></a>06372    <a class="code" href="classH1__TetrahedronElement.html#aa8f811b7906d90826bc205456bc161ae">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06373"></a>06373    <a class="code" href="classH1__TetrahedronElement.html#aed7b2d4675e2f3e953d67bc51aca64e8">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06374"></a>06374    <a class="code" href="classH1__TetrahedronElement.html#a25e2ed32a0edecc962968d8146a68c26">dshape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06375"></a>06375    <a class="code" href="classH1__TetrahedronElement.html#a9316d3191a41dc88c0d726420b07dcb6">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06376"></a>06376    <a class="code" href="classH1__TetrahedronElement.html#a676436901cc64ed34cb38306f75394c2">u</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06377"></a>06377    <a class="code" href="classH1__TetrahedronElement.html#aa15494413569ed02ee855e8143b36bde">du</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06378"></a>06378 <span class="preprocessor">#else</span>
<a name="l06379"></a>06379 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(p + 1);
<a name="l06380"></a>06380 <span class="preprocessor">#endif</span>
<a name="l06381"></a>06381 <span class="preprocessor"></span>
<a name="l06382"></a>06382    <span class="comment">// vertices</span>
<a name="l06383"></a>06383    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(0).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[0], cp[0]);
<a name="l06384"></a>06384    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(1).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[p], cp[0], cp[0]);
<a name="l06385"></a>06385    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(2).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[p], cp[0]);
<a name="l06386"></a>06386    <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(3).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[0], cp[p]);
<a name="l06387"></a>06387 
<a name="l06388"></a>06388    <span class="comment">// edges (see Tetrahedron::edges in mesh/tetrahedron.cpp)</span>
<a name="l06389"></a>06389    <span class="keywordtype">int</span> o = 4;
<a name="l06390"></a>06390    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)  <span class="comment">// (0,1)</span>
<a name="l06391"></a>06391       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i], cp[0], cp[0]);
<a name="l06392"></a>06392    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)  <span class="comment">// (0,2)</span>
<a name="l06393"></a>06393       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[i], cp[0]);
<a name="l06394"></a>06394    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)  <span class="comment">// (0,3)</span>
<a name="l06395"></a>06395       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[0], cp[i]);
<a name="l06396"></a>06396    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)  <span class="comment">// (1,2)</span>
<a name="l06397"></a>06397       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[p-i], cp[i], cp[0]);
<a name="l06398"></a>06398    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)  <span class="comment">// (1,3)</span>
<a name="l06399"></a>06399       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[p-i], cp[0], cp[i]);
<a name="l06400"></a>06400    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)  <span class="comment">// (2,3)</span>
<a name="l06401"></a>06401       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[p-i], cp[i]);
<a name="l06402"></a>06402 
<a name="l06403"></a>06403    <span class="comment">// faces (see Mesh::GenerateFaces in mesh/mesh.cpp)</span>
<a name="l06404"></a>06404    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06405"></a>06405       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i + j &lt; p; i++)  <span class="comment">// (1,2,3)</span>
<a name="l06406"></a>06406       {
<a name="l06407"></a>06407          <span class="keywordtype">double</span> w = cp[i] + cp[j] + cp[p-i-j];
<a name="l06408"></a>06408          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[p-i-j]/w, cp[i]/w, cp[j]/w);
<a name="l06409"></a>06409       }
<a name="l06410"></a>06410    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06411"></a>06411       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i + j &lt; p; i++)  <span class="comment">// (0,3,2)</span>
<a name="l06412"></a>06412       {
<a name="l06413"></a>06413          <span class="keywordtype">double</span> w = cp[i] + cp[j] + cp[p-i-j];
<a name="l06414"></a>06414          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[0], cp[j]/w, cp[i]/w);
<a name="l06415"></a>06415       }
<a name="l06416"></a>06416    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06417"></a>06417       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i + j &lt; p; i++)  <span class="comment">// (0,1,3)</span>
<a name="l06418"></a>06418       {
<a name="l06419"></a>06419          <span class="keywordtype">double</span> w = cp[i] + cp[j] + cp[p-i-j];
<a name="l06420"></a>06420          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i]/w, cp[0], cp[j]/w);
<a name="l06421"></a>06421       }
<a name="l06422"></a>06422    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l06423"></a>06423       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i + j &lt; p; i++)  <span class="comment">// (0,2,1)</span>
<a name="l06424"></a>06424       {
<a name="l06425"></a>06425          <span class="keywordtype">double</span> w = cp[i] + cp[j] + cp[p-i-j];
<a name="l06426"></a>06426          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[j]/w, cp[i]/w, cp[0]);
<a name="l06427"></a>06427       }
<a name="l06428"></a>06428 
<a name="l06429"></a>06429    <span class="comment">// interior</span>
<a name="l06430"></a>06430    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++)
<a name="l06431"></a>06431       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j + k &lt; p; j++)
<a name="l06432"></a>06432          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i + j + k &lt; p; i++)
<a name="l06433"></a>06433          {
<a name="l06434"></a>06434             <span class="keywordtype">double</span> w = cp[i] + cp[j] + cp[k] + cp[p-i-j-k];
<a name="l06435"></a>06435             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i]/w, cp[j]/w, cp[k]/w);
<a name="l06436"></a>06436          }
<a name="l06437"></a>06437 
<a name="l06438"></a>06438    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; m++)
<a name="l06439"></a>06439    {
<a name="l06440"></a>06440       <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(m);
<a name="l06441"></a>06441       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>);
<a name="l06442"></a>06442       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>);
<a name="l06443"></a>06443       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>);
<a name="l06444"></a>06444       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l06445"></a>06445 
<a name="l06446"></a>06446       o = 0;
<a name="l06447"></a>06447       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l06448"></a>06448          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06449"></a>06449             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06450"></a>06450                <a class="code" href="classH1__TetrahedronElement.html#ae6e3a4a0a647a8b3af8c5c4c03db4ad8">T</a>(o++, m) = <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(i)*<a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(j)*<a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(k)*<a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(p-i-j-k);
<a name="l06451"></a>06451    }
<a name="l06452"></a>06452 
<a name="l06453"></a>06453    <a class="code" href="classH1__TetrahedronElement.html#ae6e3a4a0a647a8b3af8c5c4c03db4ad8">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l06454"></a>06454    <span class="comment">// cout &lt;&lt; &quot;H1_TetrahedronElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l06455"></a>06455 }
<a name="l06456"></a>06456 
<a name="l06457"></a><a class="code" href="classH1__TetrahedronElement.html#a4946852b1b22d21de3a77c652046d325">06457</a> <span class="keywordtype">void</span> <a class="code" href="classH1__TetrahedronElement.html#a4946852b1b22d21de3a77c652046d325">H1_TetrahedronElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06458"></a>06458                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06459"></a>06459 <span class="keyword"></span>{
<a name="l06460"></a>06460    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06461"></a>06461 
<a name="l06462"></a>06462 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06463"></a>06463 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(p + 1);
<a name="l06464"></a>06464    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TetrahedronElement.html#a676436901cc64ed34cb38306f75394c2">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06465"></a>06465 <span class="preprocessor">#endif</span>
<a name="l06466"></a>06466 <span class="preprocessor"></span>
<a name="l06467"></a>06467    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>);
<a name="l06468"></a>06468    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>);
<a name="l06469"></a>06469    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>);
<a name="l06470"></a>06470    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l06471"></a>06471 
<a name="l06472"></a>06472    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06473"></a>06473       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06474"></a>06474          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06475"></a>06475             <a class="code" href="classH1__TetrahedronElement.html#a676436901cc64ed34cb38306f75394c2">u</a>(o++) = <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(i)*<a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(j)*<a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(k)*<a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(p-i-j-k);
<a name="l06476"></a>06476 
<a name="l06477"></a>06477    <a class="code" href="classH1__TetrahedronElement.html#ae6e3a4a0a647a8b3af8c5c4c03db4ad8">T</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(u, shape);
<a name="l06478"></a>06478 }
<a name="l06479"></a>06479 
<a name="l06480"></a><a class="code" href="classH1__TetrahedronElement.html#aed33e13d1ead2a97742b9f21dc34d127">06480</a> <span class="keywordtype">void</span> <a class="code" href="classH1__TetrahedronElement.html#aed33e13d1ead2a97742b9f21dc34d127">H1_TetrahedronElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06481"></a>06481                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06482"></a>06482 <span class="keyword"></span>{
<a name="l06483"></a>06483    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06484"></a>06484 
<a name="l06485"></a>06485 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06486"></a>06486 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a>  <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(p + 1),  <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(p + 1),  <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(p + 1),  <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(p + 1);
<a name="l06487"></a>06487    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classH1__TetrahedronElement.html#aa8f811b7906d90826bc205456bc161ae">dshape_x</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#aed7b2d4675e2f3e953d67bc51aca64e8">dshape_y</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#a25e2ed32a0edecc962968d8146a68c26">dshape_z</a>(p + 1), <a class="code" href="classH1__TetrahedronElement.html#a9316d3191a41dc88c0d726420b07dcb6">dshape_l</a>(p + 1);
<a name="l06488"></a>06488    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classH1__TetrahedronElement.html#aa15494413569ed02ee855e8143b36bde">du</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06489"></a>06489 <span class="preprocessor">#endif</span>
<a name="l06490"></a>06490 <span class="preprocessor"></span>
<a name="l06491"></a>06491    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>, <a class="code" href="classH1__TetrahedronElement.html#aa8f811b7906d90826bc205456bc161ae">dshape_x</a>);
<a name="l06492"></a>06492    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>, <a class="code" href="classH1__TetrahedronElement.html#aed7b2d4675e2f3e953d67bc51aca64e8">dshape_y</a>);
<a name="l06493"></a>06493    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>, <a class="code" href="classH1__TetrahedronElement.html#a25e2ed32a0edecc962968d8146a68c26">dshape_z</a>);
<a name="l06494"></a>06494    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l, dshape_l);
<a name="l06495"></a>06495 
<a name="l06496"></a>06496    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06497"></a>06497       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06498"></a>06498          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06499"></a>06499          {
<a name="l06500"></a>06500             <span class="keywordtype">int</span> l = p - i - j - k;
<a name="l06501"></a>06501             <a class="code" href="classH1__TetrahedronElement.html#aa15494413569ed02ee855e8143b36bde">du</a>(o,0) = ((<a class="code" href="classH1__TetrahedronElement.html#aa8f811b7906d90826bc205456bc161ae">dshape_x</a>(i)* <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(l)) -
<a name="l06502"></a>06502                        ( <a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(i)*<a class="code" href="classH1__TetrahedronElement.html#a9316d3191a41dc88c0d726420b07dcb6">dshape_l</a>(l)))*<a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(j)*<a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(k);
<a name="l06503"></a>06503             <a class="code" href="classH1__TetrahedronElement.html#aa15494413569ed02ee855e8143b36bde">du</a>(o,1) = ((<a class="code" href="classH1__TetrahedronElement.html#aed7b2d4675e2f3e953d67bc51aca64e8">dshape_y</a>(j)* <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(l)) -
<a name="l06504"></a>06504                        ( <a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(j)*<a class="code" href="classH1__TetrahedronElement.html#a9316d3191a41dc88c0d726420b07dcb6">dshape_l</a>(l)))*<a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(i)*<a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(k);
<a name="l06505"></a>06505             <a class="code" href="classH1__TetrahedronElement.html#aa15494413569ed02ee855e8143b36bde">du</a>(o,2) = ((<a class="code" href="classH1__TetrahedronElement.html#a25e2ed32a0edecc962968d8146a68c26">dshape_z</a>(k)* <a class="code" href="classH1__TetrahedronElement.html#a35be14e3bf902bb00e3171012e063696">shape_l</a>(l)) -
<a name="l06506"></a>06506                        ( <a class="code" href="classH1__TetrahedronElement.html#a2a24f16a4f05924d80caa9b4cb8cac32">shape_z</a>(k)*<a class="code" href="classH1__TetrahedronElement.html#a9316d3191a41dc88c0d726420b07dcb6">dshape_l</a>(l)))*<a class="code" href="classH1__TetrahedronElement.html#ae754cac623436a1406c581f49f20e0b6">shape_x</a>(i)*<a class="code" href="classH1__TetrahedronElement.html#afa010787aa813109a026d2d28c5fe614">shape_y</a>(j);
<a name="l06507"></a>06507             o++;
<a name="l06508"></a>06508          }
<a name="l06509"></a>06509 
<a name="l06510"></a>06510    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classH1__TetrahedronElement.html#ae6e3a4a0a647a8b3af8c5c4c03db4ad8">T</a>, du, dshape);
<a name="l06511"></a>06511 }
<a name="l06512"></a>06512 
<a name="l06513"></a>06513 
<a name="l06514"></a><a class="code" href="classL2__SegmentElement.html#abd4e39a880557f6d5879dea2c1bad66d">06514</a> <a class="code" href="classL2__SegmentElement.html#abd4e39a880557f6d5879dea2c1bad66d">L2_SegmentElement::L2_SegmentElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06515"></a>06515    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(1, <a class="code" href="classGeometry.html">Geometry</a>::SEGMENT, p + 1, p, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk),
<a name="l06516"></a>06516      basis1d(poly1d.OpenBasis(p))
<a name="l06517"></a>06517 {
<a name="l06518"></a>06518    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06519"></a>06519 
<a name="l06520"></a>06520 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06521"></a>06521 <span class="preprocessor"></span>   <a class="code" href="classL2__SegmentElement.html#a98621a2177b9341a37f29acf880566fd">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06522"></a>06522    <a class="code" href="classL2__SegmentElement.html#aa3d0a7eabac65ef0989b5cb4c6c0d8ca">dshape_x</a>.<a class="code" href="classVector.html#a35f720a71ee87fb26053c9b02f280d20">SetDataAndSize</a>(NULL, p + 1);
<a name="l06523"></a>06523 <span class="preprocessor">#endif</span>
<a name="l06524"></a>06524 <span class="preprocessor"></span>
<a name="l06525"></a>06525    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06526"></a>06526       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(i).<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> = op[i];
<a name="l06527"></a>06527 }
<a name="l06528"></a>06528 
<a name="l06529"></a><a class="code" href="classL2__SegmentElement.html#ab2460c49ae43fd6e4271b31b01ee4df6">06529</a> <span class="keywordtype">void</span> <a class="code" href="classL2__SegmentElement.html#ab2460c49ae43fd6e4271b31b01ee4df6">L2_SegmentElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06530"></a>06530                                   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06531"></a>06531 <span class="keyword"></span>{
<a name="l06532"></a>06532    <a class="code" href="classL2__SegmentElement.html#a57b879097b7012ea0792f03709184b2a">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, shape);
<a name="l06533"></a>06533 }
<a name="l06534"></a>06534 
<a name="l06535"></a><a class="code" href="classL2__SegmentElement.html#a4151c1a80ffcf903b6052d19e36baa2b">06535</a> <span class="keywordtype">void</span> <a class="code" href="classL2__SegmentElement.html#a4151c1a80ffcf903b6052d19e36baa2b">L2_SegmentElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06536"></a>06536                                    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06537"></a>06537 <span class="keyword"></span>{
<a name="l06538"></a>06538 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06539"></a>06539 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__SegmentElement.html#a98621a2177b9341a37f29acf880566fd">shape_x</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>), <a class="code" href="classL2__SegmentElement.html#aa3d0a7eabac65ef0989b5cb4c6c0d8ca">dshape_x</a>(dshape.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06540"></a>06540 <span class="preprocessor">#else</span>
<a name="l06541"></a>06541 <span class="preprocessor"></span>   <a class="code" href="classL2__SegmentElement.html#aa3d0a7eabac65ef0989b5cb4c6c0d8ca">dshape_x</a>.<a class="code" href="classVector.html#a8796799b2ea1faf5b551a5a751b47ddb">SetData</a>(dshape.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>());
<a name="l06542"></a>06542 <span class="preprocessor">#endif</span>
<a name="l06543"></a>06543 <span class="preprocessor"></span>   <a class="code" href="classL2__SegmentElement.html#a57b879097b7012ea0792f03709184b2a">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__SegmentElement.html#a98621a2177b9341a37f29acf880566fd">shape_x</a>, <a class="code" href="classL2__SegmentElement.html#aa3d0a7eabac65ef0989b5cb4c6c0d8ca">dshape_x</a>);
<a name="l06544"></a>06544 }
<a name="l06545"></a>06545 
<a name="l06546"></a><a class="code" href="classL2__SegmentElement.html#a4e9f488b19fd263f7745f5183186d9d4">06546</a> <span class="keywordtype">void</span> <a class="code" href="classL2__SegmentElement.html#a4e9f488b19fd263f7745f5183186d9d4">L2_SegmentElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex,
<a name="l06547"></a>06547                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l06548"></a>06548 <span class="keyword"></span>{
<a name="l06549"></a>06549    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06550"></a>06550    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06551"></a>06551    <span class="keywordflow">switch</span> (vertex)
<a name="l06552"></a>06552    {
<a name="l06553"></a>06553    <span class="keywordflow">case</span> 0:
<a name="l06554"></a>06554       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06555"></a>06555          dofs(i) = poly1d.<a class="code" href="classPoly__1D.html#ac5b3da4cfa8b364575ee31563bbc2c50">CalcDelta</a>(p,(1.0 - op[i]));
<a name="l06556"></a>06556       <span class="keywordflow">break</span>;
<a name="l06557"></a>06557 
<a name="l06558"></a>06558    <span class="keywordflow">case</span> 1:
<a name="l06559"></a>06559       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06560"></a>06560          dofs(i) = poly1d.<a class="code" href="classPoly__1D.html#ac5b3da4cfa8b364575ee31563bbc2c50">CalcDelta</a>(p,op[i]);
<a name="l06561"></a>06561       <span class="keywordflow">break</span>;
<a name="l06562"></a>06562    }
<a name="l06563"></a>06563 }
<a name="l06564"></a>06564 
<a name="l06565"></a>06565 
<a name="l06566"></a><a class="code" href="classL2__QuadrilateralElement.html#a440eaa74bd0cb69ac6cec2dd4e36bbe0">06566</a> <a class="code" href="classL2__QuadrilateralElement.html#a440eaa74bd0cb69ac6cec2dd4e36bbe0">L2_QuadrilateralElement::L2_QuadrilateralElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06567"></a>06567    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, (p + 1)*(p + 1), p,
<a name="l06568"></a>06568                         <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk), basis1d(poly1d.OpenBasis(p))
<a name="l06569"></a>06569 {
<a name="l06570"></a>06570    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06571"></a>06571 
<a name="l06572"></a>06572 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06573"></a>06573 <span class="preprocessor"></span>   <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06574"></a>06574    <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06575"></a>06575    <a class="code" href="classL2__QuadrilateralElement.html#a7c913e88f21a4e61fbc7d1806e2c72a9">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06576"></a>06576    <a class="code" href="classL2__QuadrilateralElement.html#a725aab0b60a5fd18a33307519b511059">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06577"></a>06577 <span class="preprocessor">#endif</span>
<a name="l06578"></a>06578 <span class="preprocessor"></span>
<a name="l06579"></a>06579    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06580"></a>06580       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06581"></a>06581          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(op[i], op[j]);
<a name="l06582"></a>06582 }
<a name="l06583"></a>06583 
<a name="l06584"></a><a class="code" href="classL2__QuadrilateralElement.html#ae798f11fb0adec5b3fa13eb661c0a3be">06584</a> <span class="keywordtype">void</span> <a class="code" href="classL2__QuadrilateralElement.html#ae798f11fb0adec5b3fa13eb661c0a3be">L2_QuadrilateralElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06585"></a>06585                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06586"></a>06586 <span class="keyword"></span>{
<a name="l06587"></a>06587    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06588"></a>06588 
<a name="l06589"></a>06589 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06590"></a>06590 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(p+1), <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(p+1);
<a name="l06591"></a>06591 <span class="preprocessor">#endif</span>
<a name="l06592"></a>06592 <span class="preprocessor"></span>
<a name="l06593"></a>06593    <a class="code" href="classL2__QuadrilateralElement.html#acc43ea6bc78cd35090ca6999b031c0ea">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>);
<a name="l06594"></a>06594    <a class="code" href="classL2__QuadrilateralElement.html#acc43ea6bc78cd35090ca6999b031c0ea">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_y);
<a name="l06595"></a>06595 
<a name="l06596"></a>06596    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06597"></a>06597       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06598"></a>06598          shape(o++) = <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(i)*<a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(j);
<a name="l06599"></a>06599 }
<a name="l06600"></a>06600 
<a name="l06601"></a><a class="code" href="classL2__QuadrilateralElement.html#a9d2b108bbdc6cfcea34fda226f01961d">06601</a> <span class="keywordtype">void</span> <a class="code" href="classL2__QuadrilateralElement.html#a9d2b108bbdc6cfcea34fda226f01961d">L2_QuadrilateralElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06602"></a>06602                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06603"></a>06603 <span class="keyword"></span>{
<a name="l06604"></a>06604    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06605"></a>06605 
<a name="l06606"></a>06606 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06607"></a>06607 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(p+1), <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(p+1), <a class="code" href="classL2__QuadrilateralElement.html#a7c913e88f21a4e61fbc7d1806e2c72a9">dshape_x</a>(p+1), <a class="code" href="classL2__QuadrilateralElement.html#a725aab0b60a5fd18a33307519b511059">dshape_y</a>(p+1);
<a name="l06608"></a>06608 <span class="preprocessor">#endif</span>
<a name="l06609"></a>06609 <span class="preprocessor"></span>
<a name="l06610"></a>06610    <a class="code" href="classL2__QuadrilateralElement.html#acc43ea6bc78cd35090ca6999b031c0ea">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>, <a class="code" href="classL2__QuadrilateralElement.html#a7c913e88f21a4e61fbc7d1806e2c72a9">dshape_x</a>);
<a name="l06611"></a>06611    <a class="code" href="classL2__QuadrilateralElement.html#acc43ea6bc78cd35090ca6999b031c0ea">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>, dshape_y);
<a name="l06612"></a>06612 
<a name="l06613"></a>06613    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06614"></a>06614       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06615"></a>06615       {
<a name="l06616"></a>06616          dshape(o,0) = <a class="code" href="classL2__QuadrilateralElement.html#a7c913e88f21a4e61fbc7d1806e2c72a9">dshape_x</a>(i)* <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(j);
<a name="l06617"></a>06617          dshape(o,1) =  <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(i)*<a class="code" href="classL2__QuadrilateralElement.html#a725aab0b60a5fd18a33307519b511059">dshape_y</a>(j);  o++;
<a name="l06618"></a>06618       }
<a name="l06619"></a>06619 }
<a name="l06620"></a>06620 
<a name="l06621"></a><a class="code" href="classL2__QuadrilateralElement.html#ae2ddbb19cdf87e7e02b49d9d03013d56">06621</a> <span class="keywordtype">void</span> <a class="code" href="classL2__QuadrilateralElement.html#ae2ddbb19cdf87e7e02b49d9d03013d56">L2_QuadrilateralElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex,
<a name="l06622"></a>06622                                            <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l06623"></a>06623 <span class="keyword"></span>{
<a name="l06624"></a>06624    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06625"></a>06625    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06626"></a>06626 
<a name="l06627"></a>06627 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06628"></a>06628 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(p+1), <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(p+1);
<a name="l06629"></a>06629 <span class="preprocessor">#endif</span>
<a name="l06630"></a>06630 <span class="preprocessor"></span>
<a name="l06631"></a>06631    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06632"></a>06632    {
<a name="l06633"></a>06633       <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(i) = poly1d.<a class="code" href="classPoly__1D.html#ac5b3da4cfa8b364575ee31563bbc2c50">CalcDelta</a>(p,(1.0 - op[i]));
<a name="l06634"></a>06634       <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(i) = poly1d.<a class="code" href="classPoly__1D.html#ac5b3da4cfa8b364575ee31563bbc2c50">CalcDelta</a>(p,op[i]);
<a name="l06635"></a>06635    }
<a name="l06636"></a>06636 
<a name="l06637"></a>06637    <span class="keywordflow">switch</span> (vertex)
<a name="l06638"></a>06638    {
<a name="l06639"></a>06639    <span class="keywordflow">case</span> 0:
<a name="l06640"></a>06640       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06641"></a>06641          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06642"></a>06642             dofs[o++] = <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(i)*<a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(j);
<a name="l06643"></a>06643       <span class="keywordflow">break</span>;
<a name="l06644"></a>06644    <span class="keywordflow">case</span> 1:
<a name="l06645"></a>06645       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06646"></a>06646          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06647"></a>06647             dofs[o++] = <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(i)*<a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(j);
<a name="l06648"></a>06648       <span class="keywordflow">break</span>;
<a name="l06649"></a>06649    <span class="keywordflow">case</span> 2:
<a name="l06650"></a>06650       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06651"></a>06651          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06652"></a>06652             dofs[o++] = <a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(i)*<a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(j);
<a name="l06653"></a>06653       <span class="keywordflow">break</span>;
<a name="l06654"></a>06654    <span class="keywordflow">case</span> 3:
<a name="l06655"></a>06655       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06656"></a>06656          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06657"></a>06657             dofs[o++] = <a class="code" href="classL2__QuadrilateralElement.html#a1ad4c7ed9f050727e12b681d2c58799c">shape_x</a>(i)*<a class="code" href="classL2__QuadrilateralElement.html#ad6eced292af6b14875d5c61da7868de9">shape_y</a>(j);
<a name="l06658"></a>06658       <span class="keywordflow">break</span>;
<a name="l06659"></a>06659    }
<a name="l06660"></a>06660 }
<a name="l06661"></a>06661 
<a name="l06662"></a>06662 
<a name="l06663"></a><a class="code" href="classL2__HexahedronElement.html#abbfdc5ab8eaa71d7c40a595c11818af8">06663</a> <a class="code" href="classL2__HexahedronElement.html#abbfdc5ab8eaa71d7c40a595c11818af8">L2_HexahedronElement::L2_HexahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06664"></a>06664    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, (p + 1)*(p + 1)*(p + 1), p,
<a name="l06665"></a>06665                         <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk), basis1d(poly1d.OpenBasis(p))
<a name="l06666"></a>06666 {
<a name="l06667"></a>06667    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06668"></a>06668 
<a name="l06669"></a>06669 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06670"></a>06670 <span class="preprocessor"></span>   <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06671"></a>06671    <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06672"></a>06672    <a class="code" href="classL2__HexahedronElement.html#a31ab4c32576a073b553f569e93a5537c">shape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06673"></a>06673    <a class="code" href="classL2__HexahedronElement.html#a2ac27476e541415506876411c1c80eb2">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06674"></a>06674    <a class="code" href="classL2__HexahedronElement.html#a7cd439a73bb7a0242e9e133c98fa2490">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06675"></a>06675    <a class="code" href="classL2__HexahedronElement.html#a8b6354f3315d537e3ff7f486dbeccc29">dshape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06676"></a>06676 <span class="preprocessor">#endif</span>
<a name="l06677"></a>06677 <span class="preprocessor"></span>
<a name="l06678"></a>06678    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06679"></a>06679       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06680"></a>06680          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06681"></a>06681             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(op[i], op[j], op[k]);
<a name="l06682"></a>06682 }
<a name="l06683"></a>06683 
<a name="l06684"></a><a class="code" href="classL2__HexahedronElement.html#a8e8221b6e4c7fa39de1031b832cf3efd">06684</a> <span class="keywordtype">void</span> <a class="code" href="classL2__HexahedronElement.html#a8e8221b6e4c7fa39de1031b832cf3efd">L2_HexahedronElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06685"></a>06685                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06686"></a>06686 <span class="keyword"></span>{
<a name="l06687"></a>06687    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06688"></a>06688 
<a name="l06689"></a>06689 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06690"></a>06690 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(p+1), <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(p+1), <a class="code" href="classL2__HexahedronElement.html#a31ab4c32576a073b553f569e93a5537c">shape_z</a>(p+1);
<a name="l06691"></a>06691 <span class="preprocessor">#endif</span>
<a name="l06692"></a>06692 <span class="preprocessor"></span>
<a name="l06693"></a>06693    <a class="code" href="classL2__HexahedronElement.html#a1e1cbb9f59c9a408f5a25b45809bf2ae">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>);
<a name="l06694"></a>06694    <a class="code" href="classL2__HexahedronElement.html#a1e1cbb9f59c9a408f5a25b45809bf2ae">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>);
<a name="l06695"></a>06695    <a class="code" href="classL2__HexahedronElement.html#a1e1cbb9f59c9a408f5a25b45809bf2ae">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_z);
<a name="l06696"></a>06696 
<a name="l06697"></a>06697    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06698"></a>06698       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06699"></a>06699          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06700"></a>06700             shape(o++) = <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a31ab4c32576a073b553f569e93a5537c">shape_z</a>(k);
<a name="l06701"></a>06701 }
<a name="l06702"></a>06702 
<a name="l06703"></a><a class="code" href="classL2__HexahedronElement.html#a624b5f7563916341a32460eaf17552af">06703</a> <span class="keywordtype">void</span> <a class="code" href="classL2__HexahedronElement.html#a624b5f7563916341a32460eaf17552af">L2_HexahedronElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06704"></a>06704                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06705"></a>06705 <span class="keyword"></span>{
<a name="l06706"></a>06706    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06707"></a>06707 
<a name="l06708"></a>06708 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06709"></a>06709 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(p+1),  <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(p+1),  <a class="code" href="classL2__HexahedronElement.html#a31ab4c32576a073b553f569e93a5537c">shape_z</a>(p+1);
<a name="l06710"></a>06710    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__HexahedronElement.html#a2ac27476e541415506876411c1c80eb2">dshape_x</a>(p+1), <a class="code" href="classL2__HexahedronElement.html#a7cd439a73bb7a0242e9e133c98fa2490">dshape_y</a>(p+1), <a class="code" href="classL2__HexahedronElement.html#a8b6354f3315d537e3ff7f486dbeccc29">dshape_z</a>(p+1);
<a name="l06711"></a>06711 <span class="preprocessor">#endif</span>
<a name="l06712"></a>06712 <span class="preprocessor"></span>
<a name="l06713"></a>06713    <a class="code" href="classL2__HexahedronElement.html#a1e1cbb9f59c9a408f5a25b45809bf2ae">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>, <a class="code" href="classL2__HexahedronElement.html#a2ac27476e541415506876411c1c80eb2">dshape_x</a>);
<a name="l06714"></a>06714    <a class="code" href="classL2__HexahedronElement.html#a1e1cbb9f59c9a408f5a25b45809bf2ae">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>, <a class="code" href="classL2__HexahedronElement.html#a7cd439a73bb7a0242e9e133c98fa2490">dshape_y</a>);
<a name="l06715"></a>06715    <a class="code" href="classL2__HexahedronElement.html#a1e1cbb9f59c9a408f5a25b45809bf2ae">basis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_z, dshape_z);
<a name="l06716"></a>06716 
<a name="l06717"></a>06717    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06718"></a>06718       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06719"></a>06719          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06720"></a>06720          {
<a name="l06721"></a>06721             dshape(o,0) = <a class="code" href="classL2__HexahedronElement.html#a2ac27476e541415506876411c1c80eb2">dshape_x</a>(i)* <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)* <a class="code" href="classL2__HexahedronElement.html#a31ab4c32576a073b553f569e93a5537c">shape_z</a>(k);
<a name="l06722"></a>06722             dshape(o,1) =  <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a7cd439a73bb7a0242e9e133c98fa2490">dshape_y</a>(j)* <a class="code" href="classL2__HexahedronElement.html#a31ab4c32576a073b553f569e93a5537c">shape_z</a>(k);
<a name="l06723"></a>06723             dshape(o,2) =  <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)* <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a8b6354f3315d537e3ff7f486dbeccc29">dshape_z</a>(k);  o++;
<a name="l06724"></a>06724          }
<a name="l06725"></a>06725 }
<a name="l06726"></a>06726 
<a name="l06727"></a><a class="code" href="classL2__HexahedronElement.html#a04ed00348accbfdea54c460c6078fb03">06727</a> <span class="keywordtype">void</span> <a class="code" href="classL2__HexahedronElement.html#a04ed00348accbfdea54c460c6078fb03">L2_HexahedronElement::ProjectDelta</a>(<span class="keywordtype">int</span> vertex,
<a name="l06728"></a>06728                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l06729"></a>06729 <span class="keyword"></span>{
<a name="l06730"></a>06730    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06731"></a>06731    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06732"></a>06732 
<a name="l06733"></a>06733 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06734"></a>06734 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(p+1), <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(p+1);
<a name="l06735"></a>06735 <span class="preprocessor">#endif</span>
<a name="l06736"></a>06736 <span class="preprocessor"></span>
<a name="l06737"></a>06737    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06738"></a>06738    {
<a name="l06739"></a>06739       <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i) = poly1d.<a class="code" href="classPoly__1D.html#ac5b3da4cfa8b364575ee31563bbc2c50">CalcDelta</a>(p,(1.0 - op[i]));
<a name="l06740"></a>06740       <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(i) = poly1d.<a class="code" href="classPoly__1D.html#ac5b3da4cfa8b364575ee31563bbc2c50">CalcDelta</a>(p,op[i]);
<a name="l06741"></a>06741    }
<a name="l06742"></a>06742 
<a name="l06743"></a>06743    <span class="keywordflow">switch</span> (vertex)
<a name="l06744"></a>06744    {
<a name="l06745"></a>06745    <span class="keywordflow">case</span> 0:
<a name="l06746"></a>06746       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06747"></a>06747          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06748"></a>06748             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06749"></a>06749                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(k);
<a name="l06750"></a>06750       <span class="keywordflow">break</span>;
<a name="l06751"></a>06751    <span class="keywordflow">case</span> 1:
<a name="l06752"></a>06752       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06753"></a>06753          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06754"></a>06754             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06755"></a>06755                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(k);
<a name="l06756"></a>06756       <span class="keywordflow">break</span>;
<a name="l06757"></a>06757    <span class="keywordflow">case</span> 2:
<a name="l06758"></a>06758       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06759"></a>06759          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06760"></a>06760             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06761"></a>06761                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(k);
<a name="l06762"></a>06762       <span class="keywordflow">break</span>;
<a name="l06763"></a>06763    <span class="keywordflow">case</span> 3:
<a name="l06764"></a>06764       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06765"></a>06765          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06766"></a>06766             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06767"></a>06767                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(k);
<a name="l06768"></a>06768       <span class="keywordflow">break</span>;
<a name="l06769"></a>06769    <span class="keywordflow">case</span> 4:
<a name="l06770"></a>06770       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06771"></a>06771          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06772"></a>06772             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06773"></a>06773                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(k);
<a name="l06774"></a>06774       <span class="keywordflow">break</span>;
<a name="l06775"></a>06775    <span class="keywordflow">case</span> 5:
<a name="l06776"></a>06776       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06777"></a>06777          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06778"></a>06778             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06779"></a>06779                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(k);
<a name="l06780"></a>06780       <span class="keywordflow">break</span>;
<a name="l06781"></a>06781    <span class="keywordflow">case</span> 6:
<a name="l06782"></a>06782       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06783"></a>06783          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06784"></a>06784             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06785"></a>06785                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(k);
<a name="l06786"></a>06786       <span class="keywordflow">break</span>;
<a name="l06787"></a>06787    <span class="keywordflow">case</span> 7:
<a name="l06788"></a>06788       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06789"></a>06789          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l06790"></a>06790             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l06791"></a>06791                dofs[o++] = <a class="code" href="classL2__HexahedronElement.html#a3ebdb4a43bb73b623f1a752ab7e3b1a4">shape_x</a>(i)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(j)*<a class="code" href="classL2__HexahedronElement.html#a884b290827bab3b16416120b47ea58e1">shape_y</a>(k);
<a name="l06792"></a>06792       <span class="keywordflow">break</span>;
<a name="l06793"></a>06793    }
<a name="l06794"></a>06794 }
<a name="l06795"></a>06795 
<a name="l06796"></a>06796 
<a name="l06797"></a><a class="code" href="classL2__TriangleElement.html#aa84fa36ec1250d7c4059ee0467698d68">06797</a> <a class="code" href="classL2__TriangleElement.html#aa84fa36ec1250d7c4059ee0467698d68">L2_TriangleElement::L2_TriangleElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06798"></a>06798    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, ((p + 1)*(p + 2))/2, p,
<a name="l06799"></a>06799                         <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), T(Dof)
<a name="l06800"></a>06800 {
<a name="l06801"></a>06801    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06802"></a>06802 
<a name="l06803"></a>06803 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06804"></a>06804 <span class="preprocessor"></span>   <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06805"></a>06805    <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06806"></a>06806    <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06807"></a>06807    <a class="code" href="classL2__TriangleElement.html#a05dfb024683ef7689b4d5339595ab921">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06808"></a>06808    <a class="code" href="classL2__TriangleElement.html#a06ff775e71ab8f9987f52f03c41b9a1a">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06809"></a>06809    <a class="code" href="classL2__TriangleElement.html#a764bd3e8ec8c0f0f6c2e6234256a66ee">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06810"></a>06810    <a class="code" href="classL2__TriangleElement.html#a6b6c227720bbcfac938d92b378141d4e">u</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06811"></a>06811    <a class="code" href="classL2__TriangleElement.html#ab1c471bcd0e22698638b5141b701d2d5">du</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06812"></a>06812 <span class="preprocessor">#else</span>
<a name="l06813"></a>06813 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(p + 1);
<a name="l06814"></a>06814 <span class="preprocessor">#endif</span>
<a name="l06815"></a>06815 <span class="preprocessor"></span>
<a name="l06816"></a>06816    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06817"></a>06817       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06818"></a>06818       {
<a name="l06819"></a>06819          <span class="keywordtype">double</span> w = op[i] + op[j] + op[p-i-j];
<a name="l06820"></a>06820          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(op[i]/w, op[j]/w);
<a name="l06821"></a>06821       }
<a name="l06822"></a>06822 
<a name="l06823"></a>06823    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l06824"></a>06824    {
<a name="l06825"></a>06825       <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l06826"></a>06826       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>);
<a name="l06827"></a>06827       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>);
<a name="l06828"></a>06828       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l);
<a name="l06829"></a>06829 
<a name="l06830"></a>06830       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06831"></a>06831          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06832"></a>06832             <a class="code" href="classL2__TriangleElement.html#a340b6b9016a0faa78902b3193dd1b409">T</a>(o++, k) = <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(i)*<a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(j)*<a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(p-i-j);
<a name="l06833"></a>06833    }
<a name="l06834"></a>06834 
<a name="l06835"></a>06835    <a class="code" href="classL2__TriangleElement.html#a340b6b9016a0faa78902b3193dd1b409">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l06836"></a>06836    <span class="comment">// cout &lt;&lt; &quot;L2_TriangleElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l06837"></a>06837 }
<a name="l06838"></a>06838 
<a name="l06839"></a><a class="code" href="classL2__TriangleElement.html#a3aeb47fc6c1f675bfb59dca779ce244a">06839</a> <span class="keywordtype">void</span> <a class="code" href="classL2__TriangleElement.html#a3aeb47fc6c1f675bfb59dca779ce244a">L2_TriangleElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06840"></a>06840                                    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06841"></a>06841 <span class="keyword"></span>{
<a name="l06842"></a>06842    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06843"></a>06843 
<a name="l06844"></a>06844 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06845"></a>06845 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#a6b6c227720bbcfac938d92b378141d4e">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06846"></a>06846 <span class="preprocessor">#endif</span>
<a name="l06847"></a>06847 <span class="preprocessor"></span>
<a name="l06848"></a>06848    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>);
<a name="l06849"></a>06849    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>);
<a name="l06850"></a>06850    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>);
<a name="l06851"></a>06851 
<a name="l06852"></a>06852    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06853"></a>06853       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06854"></a>06854          <a class="code" href="classL2__TriangleElement.html#a6b6c227720bbcfac938d92b378141d4e">u</a>(o++) = <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(i)*<a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(j)*<a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(p-i-j);
<a name="l06855"></a>06855 
<a name="l06856"></a>06856    <a class="code" href="classL2__TriangleElement.html#a340b6b9016a0faa78902b3193dd1b409">T</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(u, shape);
<a name="l06857"></a>06857 }
<a name="l06858"></a>06858 
<a name="l06859"></a><a class="code" href="classL2__TriangleElement.html#a46671e199dc22693f510bc727ac75790">06859</a> <span class="keywordtype">void</span> <a class="code" href="classL2__TriangleElement.html#a46671e199dc22693f510bc727ac75790">L2_TriangleElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06860"></a>06860                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06861"></a>06861 <span class="keyword"></span>{
<a name="l06862"></a>06862    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06863"></a>06863 
<a name="l06864"></a>06864 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06865"></a>06865 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a>  <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(p + 1),  <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(p + 1),  <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(p + 1);
<a name="l06866"></a>06866    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TriangleElement.html#a05dfb024683ef7689b4d5339595ab921">dshape_x</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#a06ff775e71ab8f9987f52f03c41b9a1a">dshape_y</a>(p + 1), <a class="code" href="classL2__TriangleElement.html#a764bd3e8ec8c0f0f6c2e6234256a66ee">dshape_l</a>(p + 1);
<a name="l06867"></a>06867    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classL2__TriangleElement.html#ab1c471bcd0e22698638b5141b701d2d5">du</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06868"></a>06868 <span class="preprocessor">#endif</span>
<a name="l06869"></a>06869 <span class="preprocessor"></span>
<a name="l06870"></a>06870    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>, <a class="code" href="classL2__TriangleElement.html#a05dfb024683ef7689b4d5339595ab921">dshape_x</a>);
<a name="l06871"></a>06871    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>, <a class="code" href="classL2__TriangleElement.html#a06ff775e71ab8f9987f52f03c41b9a1a">dshape_y</a>);
<a name="l06872"></a>06872    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l, dshape_l);
<a name="l06873"></a>06873 
<a name="l06874"></a>06874    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= p; j++)
<a name="l06875"></a>06875       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l06876"></a>06876       {
<a name="l06877"></a>06877          <span class="keywordtype">int</span> k = p - i - j;
<a name="l06878"></a>06878          <a class="code" href="classL2__TriangleElement.html#ab1c471bcd0e22698638b5141b701d2d5">du</a>(o,0) = ((<a class="code" href="classL2__TriangleElement.html#a05dfb024683ef7689b4d5339595ab921">dshape_x</a>(i)* <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(k)) -
<a name="l06879"></a>06879                     ( <a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(i)*<a class="code" href="classL2__TriangleElement.html#a764bd3e8ec8c0f0f6c2e6234256a66ee">dshape_l</a>(k)))*<a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(j);
<a name="l06880"></a>06880          <a class="code" href="classL2__TriangleElement.html#ab1c471bcd0e22698638b5141b701d2d5">du</a>(o,1) = ((<a class="code" href="classL2__TriangleElement.html#a06ff775e71ab8f9987f52f03c41b9a1a">dshape_y</a>(j)* <a class="code" href="classL2__TriangleElement.html#a9cc0a6c9c640efa11f5d3eb7332393c6">shape_l</a>(k)) -
<a name="l06881"></a>06881                     ( <a class="code" href="classL2__TriangleElement.html#abe946dd89470f5364551065e0d690668">shape_y</a>(j)*<a class="code" href="classL2__TriangleElement.html#a764bd3e8ec8c0f0f6c2e6234256a66ee">dshape_l</a>(k)))*<a class="code" href="classL2__TriangleElement.html#a15405e94c4619b50dfc969cbdcc3b6a7">shape_x</a>(i);
<a name="l06882"></a>06882          o++;
<a name="l06883"></a>06883       }
<a name="l06884"></a>06884 
<a name="l06885"></a>06885    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classL2__TriangleElement.html#a340b6b9016a0faa78902b3193dd1b409">T</a>, du, dshape);
<a name="l06886"></a>06886 }
<a name="l06887"></a>06887 
<a name="l06888"></a>06888 
<a name="l06889"></a><a class="code" href="classL2__TetrahedronElement.html#a12a6232c7665ddd70433e24178dd314b">06889</a> <a class="code" href="classL2__TetrahedronElement.html#a12a6232c7665ddd70433e24178dd314b">L2_TetrahedronElement::L2_TetrahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06890"></a>06890    : <a class="code" href="classNodalFiniteElement.html">NodalFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, ((p + 1)*(p + 2)*(p + 3))/6,
<a name="l06891"></a>06891                         p, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), T(Dof)
<a name="l06892"></a>06892 {
<a name="l06893"></a>06893    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l06894"></a>06894 
<a name="l06895"></a>06895 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l06896"></a>06896 <span class="preprocessor"></span>   <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06897"></a>06897    <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06898"></a>06898    <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06899"></a>06899    <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06900"></a>06900    <a class="code" href="classL2__TetrahedronElement.html#a78ea305152df7128522cc2d73c163589">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06901"></a>06901    <a class="code" href="classL2__TetrahedronElement.html#a1b9805dda5b329d59dc0cfca929b83d2">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06902"></a>06902    <a class="code" href="classL2__TetrahedronElement.html#aa73defde7b3938952f97bf416c484691">dshape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06903"></a>06903    <a class="code" href="classL2__TetrahedronElement.html#a7931620a674fa395558c8c2ab509e901">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l06904"></a>06904    <a class="code" href="classL2__TetrahedronElement.html#af82659bd867abd9abadee520bbe1182a">u</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06905"></a>06905    <a class="code" href="classL2__TetrahedronElement.html#ad2d405d36712102a71126a85ac377e0d">du</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06906"></a>06906 <span class="preprocessor">#else</span>
<a name="l06907"></a>06907 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(p + 1);
<a name="l06908"></a>06908 <span class="preprocessor">#endif</span>
<a name="l06909"></a>06909 <span class="preprocessor"></span>
<a name="l06910"></a>06910    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06911"></a>06911       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06912"></a>06912          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06913"></a>06913          {
<a name="l06914"></a>06914             <span class="keywordtype">double</span> w = op[i] + op[j] + op[k] + op[p-i-j-k];
<a name="l06915"></a>06915             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o++).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(op[i]/w, op[j]/w, op[k]/w);
<a name="l06916"></a>06916          }
<a name="l06917"></a>06917 
<a name="l06918"></a>06918    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; m++)
<a name="l06919"></a>06919    {
<a name="l06920"></a>06920       <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(m);
<a name="l06921"></a>06921       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>);
<a name="l06922"></a>06922       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>);
<a name="l06923"></a>06923       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>);
<a name="l06924"></a>06924       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l06925"></a>06925 
<a name="l06926"></a>06926       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06927"></a>06927          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06928"></a>06928             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06929"></a>06929                <a class="code" href="classL2__TetrahedronElement.html#a68824097b5ddd98d32deb12bbb630de1">T</a>(o++, m) = <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(i)*<a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(j)*<a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(k)*<a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(p-i-j-k);
<a name="l06930"></a>06930    }
<a name="l06931"></a>06931 
<a name="l06932"></a>06932    <a class="code" href="classL2__TetrahedronElement.html#a68824097b5ddd98d32deb12bbb630de1">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l06933"></a>06933    <span class="comment">// cout &lt;&lt; &quot;L2_TetrahedronElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l06934"></a>06934 }
<a name="l06935"></a>06935 
<a name="l06936"></a><a class="code" href="classL2__TetrahedronElement.html#a6d6c65359884b1a20a16eeae6160d99d">06936</a> <span class="keywordtype">void</span> <a class="code" href="classL2__TetrahedronElement.html#a6d6c65359884b1a20a16eeae6160d99d">L2_TetrahedronElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06937"></a>06937                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l06938"></a>06938 <span class="keyword"></span>{
<a name="l06939"></a>06939    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06940"></a>06940 
<a name="l06941"></a>06941 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06942"></a>06942 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(p + 1);
<a name="l06943"></a>06943    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TetrahedronElement.html#af82659bd867abd9abadee520bbe1182a">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l06944"></a>06944 <span class="preprocessor">#endif</span>
<a name="l06945"></a>06945 <span class="preprocessor"></span>
<a name="l06946"></a>06946    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>);
<a name="l06947"></a>06947    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>);
<a name="l06948"></a>06948    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>);
<a name="l06949"></a>06949    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l06950"></a>06950 
<a name="l06951"></a>06951    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06952"></a>06952       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06953"></a>06953          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06954"></a>06954             <a class="code" href="classL2__TetrahedronElement.html#af82659bd867abd9abadee520bbe1182a">u</a>(o++) = <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(i)*<a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(j)*<a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(k)*<a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(p-i-j-k);
<a name="l06955"></a>06955 
<a name="l06956"></a>06956    <a class="code" href="classL2__TetrahedronElement.html#a68824097b5ddd98d32deb12bbb630de1">T</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(u, shape);
<a name="l06957"></a>06957 }
<a name="l06958"></a>06958 
<a name="l06959"></a><a class="code" href="classL2__TetrahedronElement.html#ab22092007bf6e612122bde45e0ac5ec4">06959</a> <span class="keywordtype">void</span> <a class="code" href="classL2__TetrahedronElement.html#ab22092007bf6e612122bde45e0ac5ec4">L2_TetrahedronElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l06960"></a>06960                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l06961"></a>06961 <span class="keyword"></span>{
<a name="l06962"></a>06962    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l06963"></a>06963 
<a name="l06964"></a>06964 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l06965"></a>06965 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a>  <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(p + 1),  <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(p + 1),  <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(p + 1),  <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(p + 1);
<a name="l06966"></a>06966    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classL2__TetrahedronElement.html#a78ea305152df7128522cc2d73c163589">dshape_x</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a1b9805dda5b329d59dc0cfca929b83d2">dshape_y</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#aa73defde7b3938952f97bf416c484691">dshape_z</a>(p + 1), <a class="code" href="classL2__TetrahedronElement.html#a7931620a674fa395558c8c2ab509e901">dshape_l</a>(p + 1);
<a name="l06967"></a>06967    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classL2__TetrahedronElement.html#ad2d405d36712102a71126a85ac377e0d">du</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l06968"></a>06968 <span class="preprocessor">#endif</span>
<a name="l06969"></a>06969 <span class="preprocessor"></span>
<a name="l06970"></a>06970    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>, <a class="code" href="classL2__TetrahedronElement.html#a78ea305152df7128522cc2d73c163589">dshape_x</a>);
<a name="l06971"></a>06971    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>, <a class="code" href="classL2__TetrahedronElement.html#a1b9805dda5b329d59dc0cfca929b83d2">dshape_y</a>);
<a name="l06972"></a>06972    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>, <a class="code" href="classL2__TetrahedronElement.html#aa73defde7b3938952f97bf416c484691">dshape_z</a>);
<a name="l06973"></a>06973    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l, dshape_l);
<a name="l06974"></a>06974 
<a name="l06975"></a>06975    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= p; k++)
<a name="l06976"></a>06976       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l06977"></a>06977          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l06978"></a>06978          {
<a name="l06979"></a>06979             <span class="keywordtype">int</span> l = p - i - j - k;
<a name="l06980"></a>06980             <a class="code" href="classL2__TetrahedronElement.html#ad2d405d36712102a71126a85ac377e0d">du</a>(o,0) = ((<a class="code" href="classL2__TetrahedronElement.html#a78ea305152df7128522cc2d73c163589">dshape_x</a>(i)* <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(l)) -
<a name="l06981"></a>06981                        ( <a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(i)*<a class="code" href="classL2__TetrahedronElement.html#a7931620a674fa395558c8c2ab509e901">dshape_l</a>(l)))*<a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(j)*<a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(k);
<a name="l06982"></a>06982             <a class="code" href="classL2__TetrahedronElement.html#ad2d405d36712102a71126a85ac377e0d">du</a>(o,1) = ((<a class="code" href="classL2__TetrahedronElement.html#a1b9805dda5b329d59dc0cfca929b83d2">dshape_y</a>(j)* <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(l)) -
<a name="l06983"></a>06983                        ( <a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(j)*<a class="code" href="classL2__TetrahedronElement.html#a7931620a674fa395558c8c2ab509e901">dshape_l</a>(l)))*<a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(i)*<a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(k);
<a name="l06984"></a>06984             <a class="code" href="classL2__TetrahedronElement.html#ad2d405d36712102a71126a85ac377e0d">du</a>(o,2) = ((<a class="code" href="classL2__TetrahedronElement.html#aa73defde7b3938952f97bf416c484691">dshape_z</a>(k)* <a class="code" href="classL2__TetrahedronElement.html#a1cd18b9a3428a26a21fa761ea36d6f64">shape_l</a>(l)) -
<a name="l06985"></a>06985                        ( <a class="code" href="classL2__TetrahedronElement.html#a7908380507cd91fb1f905fc8a1617e84">shape_z</a>(k)*<a class="code" href="classL2__TetrahedronElement.html#a7931620a674fa395558c8c2ab509e901">dshape_l</a>(l)))*<a class="code" href="classL2__TetrahedronElement.html#a189a9df324e725d7a3f8a12e31d16814">shape_x</a>(i)*<a class="code" href="classL2__TetrahedronElement.html#a16467f9012957bee21ec7d421a66a215">shape_y</a>(j);
<a name="l06986"></a>06986             o++;
<a name="l06987"></a>06987          }
<a name="l06988"></a>06988 
<a name="l06989"></a>06989    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classL2__TetrahedronElement.html#a68824097b5ddd98d32deb12bbb630de1">T</a>, du, dshape);
<a name="l06990"></a>06990 }
<a name="l06991"></a>06991 
<a name="l06992"></a>06992 
<a name="l06993"></a>06993 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT__QuadrilateralElement.html#aff6b4f67ebe438b8ddc9b2e28a8e7410">RT_QuadrilateralElement::nk</a>[8] =
<a name="l06994"></a>06994 { 0., -1.,  1., 0.,  0., 1.,  -1., 0. };
<a name="l06995"></a>06995 
<a name="l06996"></a><a class="code" href="classRT__QuadrilateralElement.html#aa8c5d2059113fede6acd997a68602b5f">06996</a> <a class="code" href="classRT__QuadrilateralElement.html#aa8c5d2059113fede6acd997a68602b5f">RT_QuadrilateralElement::RT_QuadrilateralElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l06997"></a>06997    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 2*(p + 1)*(p + 2), p + 1,
<a name="l06998"></a>06998                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk),
<a name="l06999"></a>06999      cbasis1d(poly1d.ClosedBasis(p + 1)), obasis1d(poly1d.OpenBasis(p)),
<a name="l07000"></a>07000      dof_map(Dof), dof2nk(Dof)
<a name="l07001"></a>07001 {
<a name="l07002"></a>07002    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p + 1);
<a name="l07003"></a>07003    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l07004"></a>07004    <span class="keyword">const</span> <span class="keywordtype">int</span> dof2 = <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>/2;
<a name="l07005"></a>07005 
<a name="l07006"></a>07006 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l07007"></a>07007 <span class="preprocessor"></span>   <a class="code" href="classRT__QuadrilateralElement.html#a257b7fe3458b468066f91a85bfaae52c">shape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07008"></a>07008    <a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07009"></a>07009    <a class="code" href="classRT__QuadrilateralElement.html#a295131c18b5efc847b3dc40ca81f8c93">shape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07010"></a>07010    <a class="code" href="classRT__QuadrilateralElement.html#ac08052ade9cface1f31d5559a57eed0b">shape_oy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07011"></a>07011    <a class="code" href="classRT__QuadrilateralElement.html#a560bee3e563873774cd2c587cb7172ae">dshape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07012"></a>07012    <a class="code" href="classRT__QuadrilateralElement.html#a15bf828d6363bef3ef1ac84f5ebfff5b">dshape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07013"></a>07013 <span class="preprocessor">#endif</span>
<a name="l07014"></a>07014 <span class="preprocessor"></span>
<a name="l07015"></a>07015    <span class="comment">// edges</span>
<a name="l07016"></a>07016    <span class="keywordtype">int</span> o = 0;
<a name="l07017"></a>07017    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (0,1)</span>
<a name="l07018"></a>07018       <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[1*dof2 + i + 0*(p + 1)] = o++;
<a name="l07019"></a>07019    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (1,2)</span>
<a name="l07020"></a>07020       <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[0*dof2 + (p + 1) + i*(p + 2)] = o++;
<a name="l07021"></a>07021    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (2,3)</span>
<a name="l07022"></a>07022       <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[1*dof2 + (p - i) + (p + 1)*(p + 1)] = o++;
<a name="l07023"></a>07023    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (3,0)</span>
<a name="l07024"></a>07024       <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[0*dof2 + 0 + (p - i)*(p + 2)] = o++;
<a name="l07025"></a>07025 
<a name="l07026"></a>07026    <span class="comment">// interior</span>
<a name="l07027"></a>07027    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// x-components</span>
<a name="l07028"></a>07028       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= p; i++)
<a name="l07029"></a>07029          <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[0*dof2 + i + j*(p + 2)] = o++;
<a name="l07030"></a>07030    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt;= p; j++)  <span class="comment">// y-components</span>
<a name="l07031"></a>07031       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07032"></a>07032          <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[1*dof2 + i + j*(p + 1)] = o++;
<a name="l07033"></a>07033 
<a name="l07034"></a>07034    <span class="comment">// dof orientations</span>
<a name="l07035"></a>07035    <span class="comment">// x-components</span>
<a name="l07036"></a>07036    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07037"></a>07037       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p/2; i++)
<a name="l07038"></a>07038       {
<a name="l07039"></a>07039          <span class="keywordtype">int</span> idx = 0*dof2 + i + j*(p + 2);
<a name="l07040"></a>07040          <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[idx] = -1 - dof_map[idx];
<a name="l07041"></a>07041       }
<a name="l07042"></a>07042    <span class="keywordflow">if</span> (p%2 == 1)
<a name="l07043"></a>07043       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = p/2 + 1; j &lt;= p; j++)
<a name="l07044"></a>07044       {
<a name="l07045"></a>07045          <span class="keywordtype">int</span> idx = 0*dof2 + (p/2 + 1) + j*(p + 2);
<a name="l07046"></a>07046          <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[idx] = -1 - <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[idx];
<a name="l07047"></a>07047       }
<a name="l07048"></a>07048    <span class="comment">// y-components</span>
<a name="l07049"></a>07049    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p/2; j++)
<a name="l07050"></a>07050       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07051"></a>07051       {
<a name="l07052"></a>07052          <span class="keywordtype">int</span> idx = 1*dof2 + i + j*(p + 1);
<a name="l07053"></a>07053          <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[idx] = -1 - dof_map[idx];
<a name="l07054"></a>07054       }
<a name="l07055"></a>07055    <span class="keywordflow">if</span> (p%2 == 1)
<a name="l07056"></a>07056       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = p/2 + 1; i &lt;= p; i++)
<a name="l07057"></a>07057       {
<a name="l07058"></a>07058          <span class="keywordtype">int</span> idx = 1*dof2 + i + (p/2 + 1)*(p + 1);
<a name="l07059"></a>07059          <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[idx] = -1 - <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[idx];
<a name="l07060"></a>07060       }
<a name="l07061"></a>07061 
<a name="l07062"></a>07062    o = 0;
<a name="l07063"></a>07063    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07064"></a>07064       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p + 1; i++)
<a name="l07065"></a>07065       {
<a name="l07066"></a>07066          <span class="keywordtype">int</span> idx;
<a name="l07067"></a>07067          <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[o++]) &lt; 0)
<a name="l07068"></a>07068          {
<a name="l07069"></a>07069             idx = -1 - idx;
<a name="l07070"></a>07070             <a class="code" href="classRT__QuadrilateralElement.html#a5b3dcbe4a19ffebede49d7f2618cefc5">dof2nk</a>[idx] = 3;
<a name="l07071"></a>07071          }
<a name="l07072"></a>07072          <span class="keywordflow">else</span>
<a name="l07073"></a>07073          {
<a name="l07074"></a>07074             <a class="code" href="classRT__QuadrilateralElement.html#a5b3dcbe4a19ffebede49d7f2618cefc5">dof2nk</a>[idx] = 1;
<a name="l07075"></a>07075          }
<a name="l07076"></a>07076          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[i], op[j]);
<a name="l07077"></a>07077       }
<a name="l07078"></a>07078    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p + 1; j++)
<a name="l07079"></a>07079       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07080"></a>07080       {
<a name="l07081"></a>07081          <span class="keywordtype">int</span> idx;
<a name="l07082"></a>07082          <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[o++]) &lt; 0)
<a name="l07083"></a>07083          {
<a name="l07084"></a>07084             idx = -1 - idx;
<a name="l07085"></a>07085             <a class="code" href="classRT__QuadrilateralElement.html#a5b3dcbe4a19ffebede49d7f2618cefc5">dof2nk</a>[idx] = 0;
<a name="l07086"></a>07086          }
<a name="l07087"></a>07087          <span class="keywordflow">else</span>
<a name="l07088"></a>07088          {
<a name="l07089"></a>07089             <a class="code" href="classRT__QuadrilateralElement.html#a5b3dcbe4a19ffebede49d7f2618cefc5">dof2nk</a>[idx] = 2;
<a name="l07090"></a>07090          }
<a name="l07091"></a>07091          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(op[i], cp[j]);
<a name="l07092"></a>07092       }
<a name="l07093"></a>07093 }
<a name="l07094"></a>07094 
<a name="l07095"></a><a class="code" href="classRT__QuadrilateralElement.html#a4021756a8bf0f4c45caa041a75bc289b">07095</a> <span class="keywordtype">void</span> <a class="code" href="classRT__QuadrilateralElement.html#a4021756a8bf0f4c45caa041a75bc289b">RT_QuadrilateralElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07096"></a>07096                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l07097"></a>07097 <span class="keyword"></span>{
<a name="l07098"></a>07098    <span class="keyword">const</span> <span class="keywordtype">int</span> pp1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l07099"></a>07099 
<a name="l07100"></a>07100 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07101"></a>07101 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__QuadrilateralElement.html#a257b7fe3458b468066f91a85bfaae52c">shape_cx</a>(pp1 + 1), <a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>(pp1), <a class="code" href="classRT__QuadrilateralElement.html#a295131c18b5efc847b3dc40ca81f8c93">shape_cy</a>(pp1 + 1), <a class="code" href="classRT__QuadrilateralElement.html#ac08052ade9cface1f31d5559a57eed0b">shape_oy</a>(pp1);
<a name="l07102"></a>07102 <span class="preprocessor">#endif</span>
<a name="l07103"></a>07103 <span class="preprocessor"></span>
<a name="l07104"></a>07104    <a class="code" href="classRT__QuadrilateralElement.html#ab2fa217dc7d245bb378210d6b371e949">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__QuadrilateralElement.html#a257b7fe3458b468066f91a85bfaae52c">shape_cx</a>);
<a name="l07105"></a>07105    <a class="code" href="classRT__QuadrilateralElement.html#af1a992cfffc5487bb55aab2aa4827f2c">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>);
<a name="l07106"></a>07106    <a class="code" href="classRT__QuadrilateralElement.html#ab2fa217dc7d245bb378210d6b371e949">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__QuadrilateralElement.html#a295131c18b5efc847b3dc40ca81f8c93">shape_cy</a>);
<a name="l07107"></a>07107    <a class="code" href="classRT__QuadrilateralElement.html#af1a992cfffc5487bb55aab2aa4827f2c">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l07108"></a>07108 
<a name="l07109"></a>07109    <span class="keywordtype">int</span> o = 0;
<a name="l07110"></a>07110    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pp1; j++)
<a name="l07111"></a>07111       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= pp1; i++)
<a name="l07112"></a>07112       {
<a name="l07113"></a>07113          <span class="keywordtype">int</span> idx, s;
<a name="l07114"></a>07114          <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[o++]) &lt; 0)
<a name="l07115"></a>07115             idx = -1 - idx, s = -1;
<a name="l07116"></a>07116          <span class="keywordflow">else</span>
<a name="l07117"></a>07117             s = +1;
<a name="l07118"></a>07118          shape(idx,0) = s*<a class="code" href="classRT__QuadrilateralElement.html#a257b7fe3458b468066f91a85bfaae52c">shape_cx</a>(i)*<a class="code" href="classRT__QuadrilateralElement.html#ac08052ade9cface1f31d5559a57eed0b">shape_oy</a>(j);
<a name="l07119"></a>07119          shape(idx,1) = 0.;
<a name="l07120"></a>07120       }
<a name="l07121"></a>07121    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pp1; j++)
<a name="l07122"></a>07122       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pp1; i++)
<a name="l07123"></a>07123       {
<a name="l07124"></a>07124          <span class="keywordtype">int</span> idx, s;
<a name="l07125"></a>07125          <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[o++]) &lt; 0)
<a name="l07126"></a>07126             idx = -1 - idx, s = -1;
<a name="l07127"></a>07127          <span class="keywordflow">else</span>
<a name="l07128"></a>07128             s = +1;
<a name="l07129"></a>07129          shape(idx,0) = 0.;
<a name="l07130"></a>07130          shape(idx,1) = s*<a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>(i)*<a class="code" href="classRT__QuadrilateralElement.html#a295131c18b5efc847b3dc40ca81f8c93">shape_cy</a>(j);
<a name="l07131"></a>07131       }
<a name="l07132"></a>07132 }
<a name="l07133"></a>07133 
<a name="l07134"></a><a class="code" href="classRT__QuadrilateralElement.html#a24b6e7529480bace9c4810c5d59693da">07134</a> <span class="keywordtype">void</span> <a class="code" href="classRT__QuadrilateralElement.html#a24b6e7529480bace9c4810c5d59693da">RT_QuadrilateralElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07135"></a>07135                                            <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l07136"></a>07136 <span class="keyword"></span>{
<a name="l07137"></a>07137    <span class="keyword">const</span> <span class="keywordtype">int</span> pp1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l07138"></a>07138 
<a name="l07139"></a>07139 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07140"></a>07140 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__QuadrilateralElement.html#a257b7fe3458b468066f91a85bfaae52c">shape_cx</a>(pp1 + 1), <a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>(pp1), <a class="code" href="classRT__QuadrilateralElement.html#a295131c18b5efc847b3dc40ca81f8c93">shape_cy</a>(pp1 + 1), <a class="code" href="classRT__QuadrilateralElement.html#ac08052ade9cface1f31d5559a57eed0b">shape_oy</a>(pp1);
<a name="l07141"></a>07141    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__QuadrilateralElement.html#a560bee3e563873774cd2c587cb7172ae">dshape_cx</a>(pp1 + 1), <a class="code" href="classRT__QuadrilateralElement.html#a15bf828d6363bef3ef1ac84f5ebfff5b">dshape_cy</a>(pp1 + 1);
<a name="l07142"></a>07142 <span class="preprocessor">#endif</span>
<a name="l07143"></a>07143 <span class="preprocessor"></span>
<a name="l07144"></a>07144    <a class="code" href="classRT__QuadrilateralElement.html#ab2fa217dc7d245bb378210d6b371e949">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__QuadrilateralElement.html#a257b7fe3458b468066f91a85bfaae52c">shape_cx</a>, <a class="code" href="classRT__QuadrilateralElement.html#a560bee3e563873774cd2c587cb7172ae">dshape_cx</a>);
<a name="l07145"></a>07145    <a class="code" href="classRT__QuadrilateralElement.html#af1a992cfffc5487bb55aab2aa4827f2c">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>);
<a name="l07146"></a>07146    <a class="code" href="classRT__QuadrilateralElement.html#ab2fa217dc7d245bb378210d6b371e949">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__QuadrilateralElement.html#a295131c18b5efc847b3dc40ca81f8c93">shape_cy</a>, dshape_cy);
<a name="l07147"></a>07147    <a class="code" href="classRT__QuadrilateralElement.html#af1a992cfffc5487bb55aab2aa4827f2c">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l07148"></a>07148 
<a name="l07149"></a>07149    <span class="keywordtype">int</span> o = 0;
<a name="l07150"></a>07150    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pp1; j++)
<a name="l07151"></a>07151       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= pp1; i++)
<a name="l07152"></a>07152       {
<a name="l07153"></a>07153          <span class="keywordtype">int</span> idx, s;
<a name="l07154"></a>07154          <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[o++]) &lt; 0)
<a name="l07155"></a>07155             idx = -1 - idx, s = -1;
<a name="l07156"></a>07156          <span class="keywordflow">else</span>
<a name="l07157"></a>07157             s = +1;
<a name="l07158"></a>07158          divshape(idx) = s*<a class="code" href="classRT__QuadrilateralElement.html#a560bee3e563873774cd2c587cb7172ae">dshape_cx</a>(i)*<a class="code" href="classRT__QuadrilateralElement.html#ac08052ade9cface1f31d5559a57eed0b">shape_oy</a>(j);
<a name="l07159"></a>07159       }
<a name="l07160"></a>07160    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pp1; j++)
<a name="l07161"></a>07161       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pp1; i++)
<a name="l07162"></a>07162       {
<a name="l07163"></a>07163          <span class="keywordtype">int</span> idx, s;
<a name="l07164"></a>07164          <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__QuadrilateralElement.html#ab73b87bc567d4b423a77b18a9babb50e">dof_map</a>[o++]) &lt; 0)
<a name="l07165"></a>07165             idx = -1 - idx, s = -1;
<a name="l07166"></a>07166          <span class="keywordflow">else</span>
<a name="l07167"></a>07167             s = +1;
<a name="l07168"></a>07168          divshape(idx) = s*<a class="code" href="classRT__QuadrilateralElement.html#a8b5750aa6e2b28810c4cf4e37421a83c">shape_ox</a>(i)*<a class="code" href="classRT__QuadrilateralElement.html#a15bf828d6363bef3ef1ac84f5ebfff5b">dshape_cy</a>(j);
<a name="l07169"></a>07169       }
<a name="l07170"></a>07170 }
<a name="l07171"></a>07171 
<a name="l07172"></a>07172 
<a name="l07173"></a>07173 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT__HexahedronElement.html#a4983ef71d475dab5408274da1e537e01">RT_HexahedronElement::nk</a>[18] =
<a name="l07174"></a>07174 { 0.,0.,-1.,  0.,-1.,0.,  1.,0.,0.,  0.,1.,0.,  -1.,0.,0.,  0.,0.,1. };
<a name="l07175"></a>07175 
<a name="l07176"></a><a class="code" href="classRT__HexahedronElement.html#a35273692051bcd59fdcb6800e76cbbf7">07176</a> <a class="code" href="classRT__HexahedronElement.html#a35273692051bcd59fdcb6800e76cbbf7">RT_HexahedronElement::RT_HexahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l07177"></a>07177    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 3*(p + 1)*(p + 1)*(p + 2), p + 1,
<a name="l07178"></a>07178                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk),
<a name="l07179"></a>07179      cbasis1d(poly1d.ClosedBasis(p + 1)), obasis1d(poly1d.OpenBasis(p)),
<a name="l07180"></a>07180      dof_map(Dof), dof2nk(Dof)
<a name="l07181"></a>07181 {
<a name="l07182"></a>07182    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p + 1);
<a name="l07183"></a>07183    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l07184"></a>07184    <span class="keyword">const</span> <span class="keywordtype">int</span> dof3 = <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>/3;
<a name="l07185"></a>07185 
<a name="l07186"></a>07186 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l07187"></a>07187 <span class="preprocessor"></span>   <a class="code" href="classRT__HexahedronElement.html#a4d33b0276c782ef824d5a66baacf6e72">shape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07188"></a>07188    <a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07189"></a>07189    <a class="code" href="classRT__HexahedronElement.html#af73ac4509e3499df4bdf047c3d205786">shape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07190"></a>07190    <a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07191"></a>07191    <a class="code" href="classRT__HexahedronElement.html#a31f4ac0d524403ce3edd9f8c06dbba6f">shape_cz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07192"></a>07192    <a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07193"></a>07193    <a class="code" href="classRT__HexahedronElement.html#a92385012e792d916b86365dbc78c3090">dshape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07194"></a>07194    <a class="code" href="classRT__HexahedronElement.html#a0eeaafdc8797a22f65fe1580bc7f66da">dshape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07195"></a>07195    <a class="code" href="classRT__HexahedronElement.html#ae7f87d472b001702e70b44121ab8fd5e">dshape_cz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 2);
<a name="l07196"></a>07196 <span class="preprocessor">#endif</span>
<a name="l07197"></a>07197 <span class="preprocessor"></span>
<a name="l07198"></a>07198    <span class="comment">// faces</span>
<a name="l07199"></a>07199    <span class="keywordtype">int</span> o = 0;
<a name="l07200"></a>07200    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// (3,2,1,0) -- bottom</span>
<a name="l07201"></a>07201       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07202"></a>07202          <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[2*dof3 + i + ((p - j) + 0*(p + 1))*(p + 1)] = o++;
<a name="l07203"></a>07203    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// (0,1,5,4) -- front</span>
<a name="l07204"></a>07204       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07205"></a>07205          <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[1*dof3 + i + (0 + j*(p + 2))*(p + 1)] = o++;
<a name="l07206"></a>07206    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// (1,2,6,5) -- right</span>
<a name="l07207"></a>07207       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07208"></a>07208          <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[0*dof3 + (p + 1) + (i + j*(p + 1))*(p + 2)] = o++;
<a name="l07209"></a>07209    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// (2,3,7,6) -- back</span>
<a name="l07210"></a>07210       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07211"></a>07211          <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[1*dof3 + (p - i) + ((p + 1) + j*(p + 2))*(p + 1)] = o++;
<a name="l07212"></a>07212    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// (3,0,4,7) -- left</span>
<a name="l07213"></a>07213       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07214"></a>07214          <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[0*dof3 + 0 + ((p - i) + j*(p + 1))*(p + 2)] = o++;
<a name="l07215"></a>07215    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)  <span class="comment">// (4,5,6,7) -- top</span>
<a name="l07216"></a>07216       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07217"></a>07217          <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[2*dof3 + i + (j + (p + 1)*(p + 1))*(p + 1)] = o++;
<a name="l07218"></a>07218 
<a name="l07219"></a>07219    <span class="comment">// interior</span>
<a name="l07220"></a>07220    <span class="comment">// x-components</span>
<a name="l07221"></a>07221    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07222"></a>07222       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07223"></a>07223          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= p; i++)
<a name="l07224"></a>07224             <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[0*dof3 + i + (j + k*(p + 1))*(p + 2)] = o++;
<a name="l07225"></a>07225    <span class="comment">// y-components</span>
<a name="l07226"></a>07226    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07227"></a>07227       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt;= p; j++)
<a name="l07228"></a>07228          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07229"></a>07229             <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[1*dof3 + i + (j + k*(p + 2))*(p + 1)] = o++;
<a name="l07230"></a>07230    <span class="comment">// z-components</span>
<a name="l07231"></a>07231    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt;= p; k++)
<a name="l07232"></a>07232       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07233"></a>07233          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07234"></a>07234             <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[2*dof3 + i + (j + k*(p + 1))*(p + 1)] = o++;
<a name="l07235"></a>07235 
<a name="l07236"></a>07236    <span class="comment">// dof orientations</span>
<a name="l07237"></a>07237    <span class="comment">// for odd p, do not change the orientations in the mid-planes</span>
<a name="l07238"></a>07238    <span class="comment">// {i = p/2 + 1}, {j = p/2 + 1}, {k = p/2 + 1} in the x, y, z-components</span>
<a name="l07239"></a>07239    <span class="comment">// respectively.</span>
<a name="l07240"></a>07240    <span class="comment">// x-components</span>
<a name="l07241"></a>07241    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07242"></a>07242       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07243"></a>07243          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p/2; i++)
<a name="l07244"></a>07244          {
<a name="l07245"></a>07245             <span class="keywordtype">int</span> idx = 0*dof3 + i + (j + k*(p + 1))*(p + 2);
<a name="l07246"></a>07246             <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[idx] = -1 - dof_map[idx];
<a name="l07247"></a>07247          }
<a name="l07248"></a>07248    <span class="comment">// y-components</span>
<a name="l07249"></a>07249    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07250"></a>07250       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p/2; j++)
<a name="l07251"></a>07251          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07252"></a>07252          {
<a name="l07253"></a>07253             <span class="keywordtype">int</span> idx = 1*dof3 + i + (j + k*(p + 2))*(p + 1);
<a name="l07254"></a>07254             <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[idx] = -1 - dof_map[idx];
<a name="l07255"></a>07255          }
<a name="l07256"></a>07256    <span class="comment">// z-components</span>
<a name="l07257"></a>07257    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p/2; k++)
<a name="l07258"></a>07258       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07259"></a>07259          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07260"></a>07260          {
<a name="l07261"></a>07261             <span class="keywordtype">int</span> idx = 2*dof3 + i + (j + k*(p + 1))*(p + 1);
<a name="l07262"></a>07262             <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[idx] = -1 - dof_map[idx];
<a name="l07263"></a>07263          }
<a name="l07264"></a>07264 
<a name="l07265"></a>07265    o = 0;
<a name="l07266"></a>07266    <span class="comment">// x-components</span>
<a name="l07267"></a>07267    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07268"></a>07268       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07269"></a>07269          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p + 1; i++)
<a name="l07270"></a>07270          {
<a name="l07271"></a>07271             <span class="keywordtype">int</span> idx;
<a name="l07272"></a>07272             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07273"></a>07273             {
<a name="l07274"></a>07274                idx = -1 - idx;
<a name="l07275"></a>07275                <a class="code" href="classRT__HexahedronElement.html#a28e666eec8606f22474ba51481474578">dof2nk</a>[idx] = 4;
<a name="l07276"></a>07276             }
<a name="l07277"></a>07277             <span class="keywordflow">else</span>
<a name="l07278"></a>07278             {
<a name="l07279"></a>07279                <a class="code" href="classRT__HexahedronElement.html#a28e666eec8606f22474ba51481474578">dof2nk</a>[idx] = 2;
<a name="l07280"></a>07280             }
<a name="l07281"></a>07281             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i], op[j], op[k]);
<a name="l07282"></a>07282          }
<a name="l07283"></a>07283    <span class="comment">// y-components</span>
<a name="l07284"></a>07284    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07285"></a>07285       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p + 1; j++)
<a name="l07286"></a>07286          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07287"></a>07287          {
<a name="l07288"></a>07288             <span class="keywordtype">int</span> idx;
<a name="l07289"></a>07289             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07290"></a>07290             {
<a name="l07291"></a>07291                idx = -1 - idx;
<a name="l07292"></a>07292                <a class="code" href="classRT__HexahedronElement.html#a28e666eec8606f22474ba51481474578">dof2nk</a>[idx] = 1;
<a name="l07293"></a>07293             }
<a name="l07294"></a>07294             <span class="keywordflow">else</span>
<a name="l07295"></a>07295             {
<a name="l07296"></a>07296                <a class="code" href="classRT__HexahedronElement.html#a28e666eec8606f22474ba51481474578">dof2nk</a>[idx] = 3;
<a name="l07297"></a>07297             }
<a name="l07298"></a>07298             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(op[i], cp[j], op[k]);
<a name="l07299"></a>07299          }
<a name="l07300"></a>07300    <span class="comment">// z-components</span>
<a name="l07301"></a>07301    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p + 1; k++)
<a name="l07302"></a>07302       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07303"></a>07303          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07304"></a>07304          {
<a name="l07305"></a>07305             <span class="keywordtype">int</span> idx;
<a name="l07306"></a>07306             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07307"></a>07307             {
<a name="l07308"></a>07308                idx = -1 - idx;
<a name="l07309"></a>07309                <a class="code" href="classRT__HexahedronElement.html#a28e666eec8606f22474ba51481474578">dof2nk</a>[idx] = 0;
<a name="l07310"></a>07310             }
<a name="l07311"></a>07311             <span class="keywordflow">else</span>
<a name="l07312"></a>07312             {
<a name="l07313"></a>07313                <a class="code" href="classRT__HexahedronElement.html#a28e666eec8606f22474ba51481474578">dof2nk</a>[idx] = 5;
<a name="l07314"></a>07314             }
<a name="l07315"></a>07315             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(op[i], op[j], cp[k]);
<a name="l07316"></a>07316          }
<a name="l07317"></a>07317 }
<a name="l07318"></a>07318 
<a name="l07319"></a><a class="code" href="classRT__HexahedronElement.html#a835fe669874786410f338419129dd69f">07319</a> <span class="keywordtype">void</span> <a class="code" href="classRT__HexahedronElement.html#a835fe669874786410f338419129dd69f">RT_HexahedronElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07320"></a>07320                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l07321"></a>07321 <span class="keyword"></span>{
<a name="l07322"></a>07322    <span class="keyword">const</span> <span class="keywordtype">int</span> pp1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l07323"></a>07323 
<a name="l07324"></a>07324 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07325"></a>07325 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__HexahedronElement.html#a4d33b0276c782ef824d5a66baacf6e72">shape_cx</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>(pp1), <a class="code" href="classRT__HexahedronElement.html#af73ac4509e3499df4bdf047c3d205786">shape_cy</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>(pp1);
<a name="l07326"></a>07326    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__HexahedronElement.html#a31f4ac0d524403ce3edd9f8c06dbba6f">shape_cz</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>(pp1);
<a name="l07327"></a>07327 <span class="preprocessor">#endif</span>
<a name="l07328"></a>07328 <span class="preprocessor"></span>
<a name="l07329"></a>07329    <a class="code" href="classRT__HexahedronElement.html#aaa4302cffac95fbf5d8e2e528b55ee15">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__HexahedronElement.html#a4d33b0276c782ef824d5a66baacf6e72">shape_cx</a>);
<a name="l07330"></a>07330    <a class="code" href="classRT__HexahedronElement.html#aade72bf6b25d89faa016d867d7b18d31">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>);
<a name="l07331"></a>07331    <a class="code" href="classRT__HexahedronElement.html#aaa4302cffac95fbf5d8e2e528b55ee15">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__HexahedronElement.html#af73ac4509e3499df4bdf047c3d205786">shape_cy</a>);
<a name="l07332"></a>07332    <a class="code" href="classRT__HexahedronElement.html#aade72bf6b25d89faa016d867d7b18d31">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l07333"></a>07333    <a class="code" href="classRT__HexahedronElement.html#aaa4302cffac95fbf5d8e2e528b55ee15">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classRT__HexahedronElement.html#a31f4ac0d524403ce3edd9f8c06dbba6f">shape_cz</a>);
<a name="l07334"></a>07334    <a class="code" href="classRT__HexahedronElement.html#aade72bf6b25d89faa016d867d7b18d31">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_oz);
<a name="l07335"></a>07335 
<a name="l07336"></a>07336    <span class="keywordtype">int</span> o = 0;
<a name="l07337"></a>07337    <span class="comment">// x-components</span>
<a name="l07338"></a>07338    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; pp1; k++)
<a name="l07339"></a>07339       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pp1; j++)
<a name="l07340"></a>07340          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= pp1; i++)
<a name="l07341"></a>07341          {
<a name="l07342"></a>07342             <span class="keywordtype">int</span> idx, s;
<a name="l07343"></a>07343             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07344"></a>07344                idx = -1 - idx, s = -1;
<a name="l07345"></a>07345             <span class="keywordflow">else</span>
<a name="l07346"></a>07346                s = +1;
<a name="l07347"></a>07347             shape(idx,0) = s*<a class="code" href="classRT__HexahedronElement.html#a4d33b0276c782ef824d5a66baacf6e72">shape_cx</a>(i)*<a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>(j)*<a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>(k);
<a name="l07348"></a>07348             shape(idx,1) = 0.;
<a name="l07349"></a>07349             shape(idx,2) = 0.;
<a name="l07350"></a>07350          }
<a name="l07351"></a>07351    <span class="comment">// y-components</span>
<a name="l07352"></a>07352    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; pp1; k++)
<a name="l07353"></a>07353       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pp1; j++)
<a name="l07354"></a>07354          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pp1; i++)
<a name="l07355"></a>07355          {
<a name="l07356"></a>07356             <span class="keywordtype">int</span> idx, s;
<a name="l07357"></a>07357             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07358"></a>07358                idx = -1 - idx, s = -1;
<a name="l07359"></a>07359             <span class="keywordflow">else</span>
<a name="l07360"></a>07360                s = +1;
<a name="l07361"></a>07361             shape(idx,0) = 0.;
<a name="l07362"></a>07362             shape(idx,1) = s*<a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>(i)*<a class="code" href="classRT__HexahedronElement.html#af73ac4509e3499df4bdf047c3d205786">shape_cy</a>(j)*<a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>(k);
<a name="l07363"></a>07363             shape(idx,2) = 0.;
<a name="l07364"></a>07364          }
<a name="l07365"></a>07365    <span class="comment">// z-components</span>
<a name="l07366"></a>07366    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pp1; k++)
<a name="l07367"></a>07367       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pp1; j++)
<a name="l07368"></a>07368          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pp1; i++)
<a name="l07369"></a>07369          {
<a name="l07370"></a>07370             <span class="keywordtype">int</span> idx, s;
<a name="l07371"></a>07371             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07372"></a>07372                idx = -1 - idx, s = -1;
<a name="l07373"></a>07373             <span class="keywordflow">else</span>
<a name="l07374"></a>07374                s = +1;
<a name="l07375"></a>07375             shape(idx,0) = 0.;
<a name="l07376"></a>07376             shape(idx,1) = 0.;
<a name="l07377"></a>07377             shape(idx,2) = s*<a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>(i)*<a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>(j)*<a class="code" href="classRT__HexahedronElement.html#a31f4ac0d524403ce3edd9f8c06dbba6f">shape_cz</a>(k);
<a name="l07378"></a>07378          }
<a name="l07379"></a>07379 }
<a name="l07380"></a>07380 
<a name="l07381"></a><a class="code" href="classRT__HexahedronElement.html#a06e2f0d44987f46f59c1873712f98910">07381</a> <span class="keywordtype">void</span> <a class="code" href="classRT__HexahedronElement.html#a06e2f0d44987f46f59c1873712f98910">RT_HexahedronElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07382"></a>07382                                         <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l07383"></a>07383 <span class="keyword"></span>{
<a name="l07384"></a>07384    <span class="keyword">const</span> <span class="keywordtype">int</span> pp1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l07385"></a>07385 
<a name="l07386"></a>07386 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07387"></a>07387 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__HexahedronElement.html#a4d33b0276c782ef824d5a66baacf6e72">shape_cx</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>(pp1), <a class="code" href="classRT__HexahedronElement.html#af73ac4509e3499df4bdf047c3d205786">shape_cy</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>(pp1);
<a name="l07388"></a>07388    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__HexahedronElement.html#a31f4ac0d524403ce3edd9f8c06dbba6f">shape_cz</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>(pp1);
<a name="l07389"></a>07389    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__HexahedronElement.html#a92385012e792d916b86365dbc78c3090">dshape_cx</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#a0eeaafdc8797a22f65fe1580bc7f66da">dshape_cy</a>(pp1 + 1), <a class="code" href="classRT__HexahedronElement.html#ae7f87d472b001702e70b44121ab8fd5e">dshape_cz</a>(pp1 + 1);
<a name="l07390"></a>07390 <span class="preprocessor">#endif</span>
<a name="l07391"></a>07391 <span class="preprocessor"></span>
<a name="l07392"></a>07392    <a class="code" href="classRT__HexahedronElement.html#aaa4302cffac95fbf5d8e2e528b55ee15">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__HexahedronElement.html#a4d33b0276c782ef824d5a66baacf6e72">shape_cx</a>, <a class="code" href="classRT__HexahedronElement.html#a92385012e792d916b86365dbc78c3090">dshape_cx</a>);
<a name="l07393"></a>07393    <a class="code" href="classRT__HexahedronElement.html#aade72bf6b25d89faa016d867d7b18d31">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>);
<a name="l07394"></a>07394    <a class="code" href="classRT__HexahedronElement.html#aaa4302cffac95fbf5d8e2e528b55ee15">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__HexahedronElement.html#af73ac4509e3499df4bdf047c3d205786">shape_cy</a>, <a class="code" href="classRT__HexahedronElement.html#a0eeaafdc8797a22f65fe1580bc7f66da">dshape_cy</a>);
<a name="l07395"></a>07395    <a class="code" href="classRT__HexahedronElement.html#aade72bf6b25d89faa016d867d7b18d31">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l07396"></a>07396    <a class="code" href="classRT__HexahedronElement.html#aaa4302cffac95fbf5d8e2e528b55ee15">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classRT__HexahedronElement.html#a31f4ac0d524403ce3edd9f8c06dbba6f">shape_cz</a>, dshape_cz);
<a name="l07397"></a>07397    <a class="code" href="classRT__HexahedronElement.html#aade72bf6b25d89faa016d867d7b18d31">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_oz);
<a name="l07398"></a>07398 
<a name="l07399"></a>07399    <span class="keywordtype">int</span> o = 0;
<a name="l07400"></a>07400    <span class="comment">// x-components</span>
<a name="l07401"></a>07401    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; pp1; k++)
<a name="l07402"></a>07402       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pp1; j++)
<a name="l07403"></a>07403          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= pp1; i++)
<a name="l07404"></a>07404          {
<a name="l07405"></a>07405             <span class="keywordtype">int</span> idx, s;
<a name="l07406"></a>07406             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07407"></a>07407                idx = -1 - idx, s = -1;
<a name="l07408"></a>07408             <span class="keywordflow">else</span>
<a name="l07409"></a>07409                s = +1;
<a name="l07410"></a>07410             divshape(idx) = s*<a class="code" href="classRT__HexahedronElement.html#a92385012e792d916b86365dbc78c3090">dshape_cx</a>(i)*<a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>(j)*<a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>(k);
<a name="l07411"></a>07411          }
<a name="l07412"></a>07412    <span class="comment">// y-components</span>
<a name="l07413"></a>07413    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; pp1; k++)
<a name="l07414"></a>07414       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pp1; j++)
<a name="l07415"></a>07415          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pp1; i++)
<a name="l07416"></a>07416          {
<a name="l07417"></a>07417             <span class="keywordtype">int</span> idx, s;
<a name="l07418"></a>07418             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07419"></a>07419                idx = -1 - idx, s = -1;
<a name="l07420"></a>07420             <span class="keywordflow">else</span>
<a name="l07421"></a>07421                s = +1;
<a name="l07422"></a>07422             divshape(idx) = s*<a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>(i)*<a class="code" href="classRT__HexahedronElement.html#a0eeaafdc8797a22f65fe1580bc7f66da">dshape_cy</a>(j)*<a class="code" href="classRT__HexahedronElement.html#ac5883925c349628f232bd57302fe29ef">shape_oz</a>(k);
<a name="l07423"></a>07423          }
<a name="l07424"></a>07424    <span class="comment">// z-components</span>
<a name="l07425"></a>07425    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pp1; k++)
<a name="l07426"></a>07426       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pp1; j++)
<a name="l07427"></a>07427          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pp1; i++)
<a name="l07428"></a>07428          {
<a name="l07429"></a>07429             <span class="keywordtype">int</span> idx, s;
<a name="l07430"></a>07430             <span class="keywordflow">if</span> ((idx = <a class="code" href="classRT__HexahedronElement.html#a382a1baa21c87e46c34262dd247a53d3">dof_map</a>[o++]) &lt; 0)
<a name="l07431"></a>07431                idx = -1 - idx, s = -1;
<a name="l07432"></a>07432             <span class="keywordflow">else</span>
<a name="l07433"></a>07433                s = +1;
<a name="l07434"></a>07434             divshape(idx) = s*<a class="code" href="classRT__HexahedronElement.html#a0c3cb6908f7289662a7511bedc7a9b47">shape_ox</a>(i)*<a class="code" href="classRT__HexahedronElement.html#aab3b1e4df09e7aabeca06c5337b97bc4">shape_oy</a>(j)*<a class="code" href="classRT__HexahedronElement.html#ae7f87d472b001702e70b44121ab8fd5e">dshape_cz</a>(k);
<a name="l07435"></a>07435          }
<a name="l07436"></a>07436 }
<a name="l07437"></a>07437 
<a name="l07438"></a>07438 
<a name="l07439"></a>07439 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT__TriangleElement.html#a64e8da161c82004173bd863c5fd457e6">RT_TriangleElement::nk</a>[6] =
<a name="l07440"></a>07440 { 0., -1., 1., 1., -1., 0. };
<a name="l07441"></a>07441 
<a name="l07442"></a>07442 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">RT_TriangleElement::c</a> = 1./3.;
<a name="l07443"></a>07443 
<a name="l07444"></a><a class="code" href="classRT__TriangleElement.html#a9659b367415509117c2566ca1523afe8">07444</a> <a class="code" href="classRT__TriangleElement.html#a9659b367415509117c2566ca1523afe8">RT_TriangleElement::RT_TriangleElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l07445"></a>07445    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, (p + 1)*(p + 3), p + 1,
<a name="l07446"></a>07446                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), dof2nk(Dof), T(Dof)
<a name="l07447"></a>07447 {
<a name="l07448"></a>07448    <span class="keyword">const</span> <span class="keywordtype">double</span> *iop = (p &gt; 0) ? poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 1) : NULL;
<a name="l07449"></a>07449    <span class="keyword">const</span> <span class="keywordtype">double</span> *bop = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l07450"></a>07450 
<a name="l07451"></a>07451 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l07452"></a>07452 <span class="preprocessor"></span>   <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07453"></a>07453    <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07454"></a>07454    <a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07455"></a>07455    <a class="code" href="classRT__TriangleElement.html#a51dd13901916fa4bf26637f229bf290b">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07456"></a>07456    <a class="code" href="classRT__TriangleElement.html#ab698dd5ff81e35c5f5b6f464eeabf7c2">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07457"></a>07457    <a class="code" href="classRT__TriangleElement.html#a86c97f1bf5f1eff8c3b0841559e74aef">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07458"></a>07458    <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l07459"></a>07459    <a class="code" href="classRT__TriangleElement.html#a7b77c43543ed6bad3ba156c78bc42b57">divu</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l07460"></a>07460 <span class="preprocessor">#else</span>
<a name="l07461"></a>07461 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(p + 1), <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(p + 1), <a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(p + 1);
<a name="l07462"></a>07462 <span class="preprocessor">#endif</span>
<a name="l07463"></a>07463 <span class="preprocessor"></span>
<a name="l07464"></a>07464    <span class="comment">// edges</span>
<a name="l07465"></a>07465    <span class="keywordtype">int</span> o = 0;
<a name="l07466"></a>07466    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (0,1)</span>
<a name="l07467"></a>07467    {
<a name="l07468"></a>07468       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(bop[i], 0.);
<a name="l07469"></a>07469       <a class="code" href="classRT__TriangleElement.html#a54f367f791e0e3e34f5a919a32d88c28">dof2nk</a>[o++] = 0;
<a name="l07470"></a>07470    }
<a name="l07471"></a>07471    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (1,2)</span>
<a name="l07472"></a>07472    {
<a name="l07473"></a>07473       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(bop[p-i], bop[i]);
<a name="l07474"></a>07474       <a class="code" href="classRT__TriangleElement.html#a54f367f791e0e3e34f5a919a32d88c28">dof2nk</a>[o++] = 1;
<a name="l07475"></a>07475    }
<a name="l07476"></a>07476    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)  <span class="comment">// (2,0)</span>
<a name="l07477"></a>07477    {
<a name="l07478"></a>07478       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(0., bop[p-i]);
<a name="l07479"></a>07479       <a class="code" href="classRT__TriangleElement.html#a54f367f791e0e3e34f5a919a32d88c28">dof2nk</a>[o++] = 2;
<a name="l07480"></a>07480    }
<a name="l07481"></a>07481 
<a name="l07482"></a>07482    <span class="comment">// interior</span>
<a name="l07483"></a>07483    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l07484"></a>07484       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt; p; i++)
<a name="l07485"></a>07485       {
<a name="l07486"></a>07486          <span class="keywordtype">double</span> w = iop[i] + iop[j] + iop[p-1-i-j];
<a name="l07487"></a>07487          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(iop[i]/w, iop[j]/w);
<a name="l07488"></a>07488          <a class="code" href="classRT__TriangleElement.html#a54f367f791e0e3e34f5a919a32d88c28">dof2nk</a>[o++] = 0;
<a name="l07489"></a>07489          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(iop[i]/w, iop[j]/w);
<a name="l07490"></a>07490          <a class="code" href="classRT__TriangleElement.html#a54f367f791e0e3e34f5a919a32d88c28">dof2nk</a>[o++] = 2;
<a name="l07491"></a>07491       }
<a name="l07492"></a>07492 
<a name="l07493"></a>07493    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; k++)
<a name="l07494"></a>07494    {
<a name="l07495"></a>07495       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(k);
<a name="l07496"></a>07496       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>);
<a name="l07497"></a>07497       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>);
<a name="l07498"></a>07498       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l);
<a name="l07499"></a>07499       <span class="keyword">const</span> <span class="keywordtype">double</span> *n_k = <a class="code" href="classRT__TriangleElement.html#a64e8da161c82004173bd863c5fd457e6">nk</a> + 2*<a class="code" href="classRT__TriangleElement.html#a54f367f791e0e3e34f5a919a32d88c28">dof2nk</a>[k];
<a name="l07500"></a>07500 
<a name="l07501"></a>07501       o = 0;
<a name="l07502"></a>07502       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07503"></a>07503          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l07504"></a>07504          {
<a name="l07505"></a>07505             <span class="keywordtype">double</span> s = <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i)*<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(j)*<a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(p-i-j);
<a name="l07506"></a>07506             <a class="code" href="classRT__TriangleElement.html#abfba59f64543d285a1f1bb900990405e">T</a>(o++, k) = s*n_k[0];
<a name="l07507"></a>07507             <a class="code" href="classRT__TriangleElement.html#abfba59f64543d285a1f1bb900990405e">T</a>(o++, k) = s*n_k[1];
<a name="l07508"></a>07508          }
<a name="l07509"></a>07509       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07510"></a>07510       {
<a name="l07511"></a>07511          <span class="keywordtype">double</span> s = <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i)*<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(p-i);
<a name="l07512"></a>07512          <a class="code" href="classRT__TriangleElement.html#abfba59f64543d285a1f1bb900990405e">T</a>(o++, k) = s*((ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">c</a>)*n_k[0] + (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">c</a>)*n_k[1]);
<a name="l07513"></a>07513       }
<a name="l07514"></a>07514    }
<a name="l07515"></a>07515 
<a name="l07516"></a>07516    <a class="code" href="classRT__TriangleElement.html#abfba59f64543d285a1f1bb900990405e">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l07517"></a>07517    <span class="comment">// cout &lt;&lt; &quot;RT_TriangleElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l07518"></a>07518 }
<a name="l07519"></a>07519 
<a name="l07520"></a><a class="code" href="classRT__TriangleElement.html#a7243c72363d3c24776c069854f9bf484">07520</a> <span class="keywordtype">void</span> <a class="code" href="classRT__TriangleElement.html#a7243c72363d3c24776c069854f9bf484">RT_TriangleElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07521"></a>07521                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l07522"></a>07522 <span class="keyword"></span>{
<a name="l07523"></a>07523    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l07524"></a>07524 
<a name="l07525"></a>07525 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07526"></a>07526 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(p + 1), <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(p + 1), <a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(p + 1);
<a name="l07527"></a>07527    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l07528"></a>07528 <span class="preprocessor">#endif</span>
<a name="l07529"></a>07529 <span class="preprocessor"></span>
<a name="l07530"></a>07530    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>);
<a name="l07531"></a>07531    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>);
<a name="l07532"></a>07532    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l);
<a name="l07533"></a>07533 
<a name="l07534"></a>07534    <span class="keywordtype">int</span> o = 0;
<a name="l07535"></a>07535    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07536"></a>07536       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l07537"></a>07537       {
<a name="l07538"></a>07538          <span class="keywordtype">double</span> s = <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i)*<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(j)*<a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(p-i-j);
<a name="l07539"></a>07539          <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(o,0) = s;  <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(o,1) = 0;  o++;
<a name="l07540"></a>07540          <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(o,0) = 0;  <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(o,1) = s;  o++;
<a name="l07541"></a>07541       }
<a name="l07542"></a>07542    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07543"></a>07543    {
<a name="l07544"></a>07544       <span class="keywordtype">double</span> s = <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i)*<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(p-i);
<a name="l07545"></a>07545       <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(o,0) = (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">c</a>)*s;  <a class="code" href="classRT__TriangleElement.html#a2cbb800700355e4362973f07e22af896">u</a>(o,1) = (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">c</a>)*s;  o++;
<a name="l07546"></a>07546    }
<a name="l07547"></a>07547 
<a name="l07548"></a>07548    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classRT__TriangleElement.html#abfba59f64543d285a1f1bb900990405e">T</a>, u, shape);
<a name="l07549"></a>07549 }
<a name="l07550"></a>07550 
<a name="l07551"></a><a class="code" href="classRT__TriangleElement.html#a59e33d06abdef85648268ce23245ed5a">07551</a> <span class="keywordtype">void</span> <a class="code" href="classRT__TriangleElement.html#a59e33d06abdef85648268ce23245ed5a">RT_TriangleElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07552"></a>07552                                       <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l07553"></a>07553 <span class="keyword"></span>{
<a name="l07554"></a>07554    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l07555"></a>07555 
<a name="l07556"></a>07556 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07557"></a>07557 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(p + 1),  <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(p + 1),  <a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(p + 1);
<a name="l07558"></a>07558    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TriangleElement.html#a51dd13901916fa4bf26637f229bf290b">dshape_x</a>(p + 1), <a class="code" href="classRT__TriangleElement.html#ab698dd5ff81e35c5f5b6f464eeabf7c2">dshape_y</a>(p + 1), <a class="code" href="classRT__TriangleElement.html#a86c97f1bf5f1eff8c3b0841559e74aef">dshape_l</a>(p + 1);
<a name="l07559"></a>07559    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TriangleElement.html#a7b77c43543ed6bad3ba156c78bc42b57">divu</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l07560"></a>07560 <span class="preprocessor">#endif</span>
<a name="l07561"></a>07561 <span class="preprocessor"></span>
<a name="l07562"></a>07562    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>, <a class="code" href="classRT__TriangleElement.html#a51dd13901916fa4bf26637f229bf290b">dshape_x</a>);
<a name="l07563"></a>07563    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>, <a class="code" href="classRT__TriangleElement.html#ab698dd5ff81e35c5f5b6f464eeabf7c2">dshape_y</a>);
<a name="l07564"></a>07564    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l, dshape_l);
<a name="l07565"></a>07565 
<a name="l07566"></a>07566    <span class="keywordtype">int</span> o = 0;
<a name="l07567"></a>07567    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07568"></a>07568       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l07569"></a>07569       {
<a name="l07570"></a>07570          <span class="keywordtype">int</span> k = p - i - j;
<a name="l07571"></a>07571          <a class="code" href="classRT__TriangleElement.html#a7b77c43543ed6bad3ba156c78bc42b57">divu</a>(o++) = (<a class="code" href="classRT__TriangleElement.html#a51dd13901916fa4bf26637f229bf290b">dshape_x</a>(i)*<a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(k) -
<a name="l07572"></a>07572                       <a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i)*<a class="code" href="classRT__TriangleElement.html#a86c97f1bf5f1eff8c3b0841559e74aef">dshape_l</a>(k))*<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(j);
<a name="l07573"></a>07573          <a class="code" href="classRT__TriangleElement.html#a7b77c43543ed6bad3ba156c78bc42b57">divu</a>(o++) = (<a class="code" href="classRT__TriangleElement.html#ab698dd5ff81e35c5f5b6f464eeabf7c2">dshape_y</a>(j)*<a class="code" href="classRT__TriangleElement.html#ab99af6611d765ea1a33031367fc60fd9">shape_l</a>(k) -
<a name="l07574"></a>07574                       <a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(j)*<a class="code" href="classRT__TriangleElement.html#a86c97f1bf5f1eff8c3b0841559e74aef">dshape_l</a>(k))*<a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i);
<a name="l07575"></a>07575       }
<a name="l07576"></a>07576    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07577"></a>07577    {
<a name="l07578"></a>07578       <span class="keywordtype">int</span> j = p - i;
<a name="l07579"></a>07579       <a class="code" href="classRT__TriangleElement.html#a7b77c43543ed6bad3ba156c78bc42b57">divu</a>(o++) = ((<a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i) + (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">c</a>)*<a class="code" href="classRT__TriangleElement.html#a51dd13901916fa4bf26637f229bf290b">dshape_x</a>(i))*<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(j) +
<a name="l07580"></a>07580                    (<a class="code" href="classRT__TriangleElement.html#a9748708af7112f405e0763abc6965128">shape_y</a>(j) + (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classRT__TriangleElement.html#a4090f98cbf67e2e4c8bd189dc2bada59">c</a>)*<a class="code" href="classRT__TriangleElement.html#ab698dd5ff81e35c5f5b6f464eeabf7c2">dshape_y</a>(j))*<a class="code" href="classRT__TriangleElement.html#a70341caa2da60bf16cf7ed74f0cff8e3">shape_x</a>(i));
<a name="l07581"></a>07581    }
<a name="l07582"></a>07582 
<a name="l07583"></a>07583    <a class="code" href="classRT__TriangleElement.html#abfba59f64543d285a1f1bb900990405e">T</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(divu, divshape);
<a name="l07584"></a>07584 }
<a name="l07585"></a>07585 
<a name="l07586"></a>07586 
<a name="l07587"></a>07587 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT__TetrahedronElement.html#a80cc5bd4f5ebf059431415c2cff4f356">RT_TetrahedronElement::nk</a>[12] =
<a name="l07588"></a>07588 { 1,1,1,  -1,0,0,  0,-1,0,  0,0,-1 };
<a name="l07589"></a>07589 <span class="comment">// { .5,.5,.5, -.5,0,0, 0,-.5,0, 0,0,-.5}; // n_F |F|</span>
<a name="l07590"></a>07590 
<a name="l07591"></a>07591 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">RT_TetrahedronElement::c</a> = 1./4.;
<a name="l07592"></a>07592 
<a name="l07593"></a><a class="code" href="classRT__TetrahedronElement.html#aca5ef0fcd07722bbe0b5335832b48857">07593</a> <a class="code" href="classRT__TetrahedronElement.html#aca5ef0fcd07722bbe0b5335832b48857">RT_TetrahedronElement::RT_TetrahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l07594"></a>07594    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, (p + 1)*(p + 2)*(p + 4)/2,
<a name="l07595"></a>07595                          p + 1, <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), dof2nk(Dof), T(Dof)
<a name="l07596"></a>07596 {
<a name="l07597"></a>07597    <span class="keyword">const</span> <span class="keywordtype">double</span> *iop = (p &gt; 0) ? poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 1) : NULL;
<a name="l07598"></a>07598    <span class="keyword">const</span> <span class="keywordtype">double</span> *bop = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p);
<a name="l07599"></a>07599 
<a name="l07600"></a>07600 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l07601"></a>07601 <span class="preprocessor"></span>   <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07602"></a>07602    <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07603"></a>07603    <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07604"></a>07604    <a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07605"></a>07605    <a class="code" href="classRT__TetrahedronElement.html#a84a506187509715aae5552e15ed16558">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07606"></a>07606    <a class="code" href="classRT__TetrahedronElement.html#a103f292968118caeb2b8817c3e967941">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07607"></a>07607    <a class="code" href="classRT__TetrahedronElement.html#ab7d242061cee0278f696b8a44a2f5ada">dshape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07608"></a>07608    <a class="code" href="classRT__TetrahedronElement.html#a007ede179d2fcb5dae103b0a2d5fa8cd">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07609"></a>07609    <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l07610"></a>07610    <a class="code" href="classRT__TetrahedronElement.html#a4d70f38b62b59ee1056800b274a638e2">divu</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l07611"></a>07611 <span class="preprocessor">#else</span>
<a name="l07612"></a>07612 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(p + 1);
<a name="l07613"></a>07613 <span class="preprocessor">#endif</span>
<a name="l07614"></a>07614 <span class="preprocessor"></span>
<a name="l07615"></a>07615    <span class="keywordtype">int</span> o = 0;
<a name="l07616"></a>07616    <span class="comment">// faces (see Mesh::GenerateFaces in mesh/mesh.cpp,</span>
<a name="l07617"></a>07617    <span class="comment">//        the constructor of H1_TetrahedronElement)</span>
<a name="l07618"></a>07618    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07619"></a>07619       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)  <span class="comment">// (1,2,3)</span>
<a name="l07620"></a>07620       {
<a name="l07621"></a>07621          <span class="keywordtype">double</span> w = bop[i] + bop[j] + bop[p-i-j];
<a name="l07622"></a>07622          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(bop[p-i-j]/w, bop[i]/w, bop[j]/w);
<a name="l07623"></a>07623          <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 0;
<a name="l07624"></a>07624       }
<a name="l07625"></a>07625    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07626"></a>07626       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)  <span class="comment">// (0,3,2)</span>
<a name="l07627"></a>07627       {
<a name="l07628"></a>07628          <span class="keywordtype">double</span> w = bop[i] + bop[j] + bop[p-i-j];
<a name="l07629"></a>07629          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(0., bop[j]/w, bop[i]/w);
<a name="l07630"></a>07630          <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 1;
<a name="l07631"></a>07631       }
<a name="l07632"></a>07632    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07633"></a>07633       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)  <span class="comment">// (0,1,3)</span>
<a name="l07634"></a>07634       {
<a name="l07635"></a>07635          <span class="keywordtype">double</span> w = bop[i] + bop[j] + bop[p-i-j];
<a name="l07636"></a>07636          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(bop[i]/w, 0., bop[j]/w);
<a name="l07637"></a>07637          <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 2;
<a name="l07638"></a>07638       }
<a name="l07639"></a>07639    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07640"></a>07640       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)  <span class="comment">// (0,2,1)</span>
<a name="l07641"></a>07641       {
<a name="l07642"></a>07642          <span class="keywordtype">double</span> w = bop[i] + bop[j] + bop[p-i-j];
<a name="l07643"></a>07643          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(bop[j]/w, bop[i]/w, 0.);
<a name="l07644"></a>07644          <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 3;
<a name="l07645"></a>07645       }
<a name="l07646"></a>07646 
<a name="l07647"></a>07647    <span class="comment">// interior</span>
<a name="l07648"></a>07648    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++)
<a name="l07649"></a>07649       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt; p; j++)
<a name="l07650"></a>07650          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt; p; i++)
<a name="l07651"></a>07651          {
<a name="l07652"></a>07652             <span class="keywordtype">double</span> w = iop[i] + iop[j] + iop[k] + iop[p-1-i-j-k];
<a name="l07653"></a>07653             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(iop[i]/w, iop[j]/w, iop[k]/w);
<a name="l07654"></a>07654             <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 1;
<a name="l07655"></a>07655             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(iop[i]/w, iop[j]/w, iop[k]/w);
<a name="l07656"></a>07656             <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 2;
<a name="l07657"></a>07657             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(iop[i]/w, iop[j]/w, iop[k]/w);
<a name="l07658"></a>07658             <a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[o++] = 3;
<a name="l07659"></a>07659          }
<a name="l07660"></a>07660 
<a name="l07661"></a>07661    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; m++)
<a name="l07662"></a>07662    {
<a name="l07663"></a>07663       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(m);
<a name="l07664"></a>07664       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>);
<a name="l07665"></a>07665       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>);
<a name="l07666"></a>07666       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>);
<a name="l07667"></a>07667       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l07668"></a>07668       <span class="keyword">const</span> <span class="keywordtype">double</span> *nm = <a class="code" href="classRT__TetrahedronElement.html#a80cc5bd4f5ebf059431415c2cff4f356">nk</a> + 3*<a class="code" href="classRT__TetrahedronElement.html#aa2d40a539db862ea304a9d0e5992792c">dof2nk</a>[m];
<a name="l07669"></a>07669 
<a name="l07670"></a>07670       o = 0;
<a name="l07671"></a>07671       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07672"></a>07672          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l07673"></a>07673             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l07674"></a>07674             {
<a name="l07675"></a>07675                <span class="keywordtype">double</span> s = <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k)*<a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(p-i-j-k);
<a name="l07676"></a>07676                <a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>(o++, m) = s * nm[0];
<a name="l07677"></a>07677                <a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>(o++, m) = s * nm[1];
<a name="l07678"></a>07678                <a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>(o++, m) = s * nm[2];
<a name="l07679"></a>07679             }
<a name="l07680"></a>07680       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07681"></a>07681          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l07682"></a>07682          {
<a name="l07683"></a>07683             <span class="keywordtype">double</span> s = <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(p-i-j);
<a name="l07684"></a>07684             <a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>(o++, m) = s*((ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*nm[0] + (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*nm[1] +
<a name="l07685"></a>07685                            (ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*nm[2]);
<a name="l07686"></a>07686          }
<a name="l07687"></a>07687    }
<a name="l07688"></a>07688 
<a name="l07689"></a>07689    <a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l07690"></a>07690    <span class="comment">// cout &lt;&lt; &quot;RT_TetrahedronElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l07691"></a>07691 }
<a name="l07692"></a>07692 
<a name="l07693"></a><a class="code" href="classRT__TetrahedronElement.html#a4a3f84b81064dbeb3d2da1fb2ab9c863">07693</a> <span class="keywordtype">void</span> <a class="code" href="classRT__TetrahedronElement.html#a4a3f84b81064dbeb3d2da1fb2ab9c863">RT_TetrahedronElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07694"></a>07694                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l07695"></a>07695 <span class="keyword"></span>{
<a name="l07696"></a>07696    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l07697"></a>07697 
<a name="l07698"></a>07698 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07699"></a>07699 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(p + 1);
<a name="l07700"></a>07700    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l07701"></a>07701 <span class="preprocessor">#endif</span>
<a name="l07702"></a>07702 <span class="preprocessor"></span>
<a name="l07703"></a>07703    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>);
<a name="l07704"></a>07704    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>);
<a name="l07705"></a>07705    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>);
<a name="l07706"></a>07706    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l07707"></a>07707 
<a name="l07708"></a>07708    <span class="keywordtype">int</span> o = 0;
<a name="l07709"></a>07709    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07710"></a>07710       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l07711"></a>07711          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l07712"></a>07712          {
<a name="l07713"></a>07713             <span class="keywordtype">double</span> s = <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k)*<a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(p-i-j-k);
<a name="l07714"></a>07714             <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,0) = s;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,1) = 0;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,2) = 0;  o++;
<a name="l07715"></a>07715             <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,0) = 0;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,1) = s;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,2) = 0;  o++;
<a name="l07716"></a>07716             <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,0) = 0;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,1) = 0;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,2) = s;  o++;
<a name="l07717"></a>07717          }
<a name="l07718"></a>07718    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07719"></a>07719       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l07720"></a>07720       {
<a name="l07721"></a>07721          <span class="keywordtype">double</span> s = <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(p-i-j);
<a name="l07722"></a>07722          <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,0) = (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*s;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,1) = (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*s;  <a class="code" href="classRT__TetrahedronElement.html#aea7741ed7535ab6a2e5718f69593cfb7">u</a>(o,2) = (ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*s;
<a name="l07723"></a>07723          o++;
<a name="l07724"></a>07724       }
<a name="l07725"></a>07725 
<a name="l07726"></a>07726    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>, u, shape);
<a name="l07727"></a>07727 }
<a name="l07728"></a>07728 
<a name="l07729"></a><a class="code" href="classRT__TetrahedronElement.html#a0b6f6e26dd972ae3a37800a59f8859bb">07729</a> <span class="keywordtype">void</span> <a class="code" href="classRT__TetrahedronElement.html#a0b6f6e26dd972ae3a37800a59f8859bb">RT_TetrahedronElement::CalcDivShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07730"></a>07730                                          <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;divshape)<span class="keyword"> const</span>
<a name="l07731"></a>07731 <span class="keyword"></span>{
<a name="l07732"></a>07732    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l07733"></a>07733 
<a name="l07734"></a>07734 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07735"></a>07735 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(p + 1),  <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(p + 1),  <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(p + 1),  <a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(p + 1);
<a name="l07736"></a>07736    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TetrahedronElement.html#a84a506187509715aae5552e15ed16558">dshape_x</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a103f292968118caeb2b8817c3e967941">dshape_y</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#ab7d242061cee0278f696b8a44a2f5ada">dshape_z</a>(p + 1), <a class="code" href="classRT__TetrahedronElement.html#a007ede179d2fcb5dae103b0a2d5fa8cd">dshape_l</a>(p + 1);
<a name="l07737"></a>07737    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classRT__TetrahedronElement.html#a4d70f38b62b59ee1056800b274a638e2">divu</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l07738"></a>07738 <span class="preprocessor">#endif</span>
<a name="l07739"></a>07739 <span class="preprocessor"></span>
<a name="l07740"></a>07740    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>, <a class="code" href="classRT__TetrahedronElement.html#a84a506187509715aae5552e15ed16558">dshape_x</a>);
<a name="l07741"></a>07741    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>, <a class="code" href="classRT__TetrahedronElement.html#a103f292968118caeb2b8817c3e967941">dshape_y</a>);
<a name="l07742"></a>07742    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>, <a class="code" href="classRT__TetrahedronElement.html#ab7d242061cee0278f696b8a44a2f5ada">dshape_z</a>);
<a name="l07743"></a>07743    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(p, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l, dshape_l);
<a name="l07744"></a>07744 
<a name="l07745"></a>07745    <span class="keywordtype">int</span> o = 0;
<a name="l07746"></a>07746    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07747"></a>07747       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= p; j++)
<a name="l07748"></a>07748          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= p; i++)
<a name="l07749"></a>07749          {
<a name="l07750"></a>07750             <span class="keywordtype">int</span> l = p - i - j - k;
<a name="l07751"></a>07751             <a class="code" href="classRT__TetrahedronElement.html#a4d70f38b62b59ee1056800b274a638e2">divu</a>(o++) = (<a class="code" href="classRT__TetrahedronElement.html#a84a506187509715aae5552e15ed16558">dshape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(l) -
<a name="l07752"></a>07752                          <a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a007ede179d2fcb5dae103b0a2d5fa8cd">dshape_l</a>(l))*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k);
<a name="l07753"></a>07753             <a class="code" href="classRT__TetrahedronElement.html#a4d70f38b62b59ee1056800b274a638e2">divu</a>(o++) = (<a class="code" href="classRT__TetrahedronElement.html#a103f292968118caeb2b8817c3e967941">dshape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(l) -
<a name="l07754"></a>07754                          <a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a007ede179d2fcb5dae103b0a2d5fa8cd">dshape_l</a>(l))*<a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k);
<a name="l07755"></a>07755             <a class="code" href="classRT__TetrahedronElement.html#a4d70f38b62b59ee1056800b274a638e2">divu</a>(o++) = (<a class="code" href="classRT__TetrahedronElement.html#ab7d242061cee0278f696b8a44a2f5ada">dshape_z</a>(k)*<a class="code" href="classRT__TetrahedronElement.html#a0cb69542d650d75e42620f112455d8f2">shape_l</a>(l) -
<a name="l07756"></a>07756                          <a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k)*<a class="code" href="classRT__TetrahedronElement.html#a007ede179d2fcb5dae103b0a2d5fa8cd">dshape_l</a>(l))*<a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j);
<a name="l07757"></a>07757          }
<a name="l07758"></a>07758    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07759"></a>07759       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= p; i++)
<a name="l07760"></a>07760       {
<a name="l07761"></a>07761          <span class="keywordtype">int</span> k = p - i - j;
<a name="l07762"></a>07762          <a class="code" href="classRT__TetrahedronElement.html#a4d70f38b62b59ee1056800b274a638e2">divu</a>(o++) =
<a name="l07763"></a>07763             (<a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i) + (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*<a class="code" href="classRT__TetrahedronElement.html#a84a506187509715aae5552e15ed16558">dshape_x</a>(i))*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k) +
<a name="l07764"></a>07764             (<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j) + (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*<a class="code" href="classRT__TetrahedronElement.html#a103f292968118caeb2b8817c3e967941">dshape_y</a>(j))*<a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k) +
<a name="l07765"></a>07765             (<a class="code" href="classRT__TetrahedronElement.html#a00f7bc5b7d092d9b1dd03e378e9d78b1">shape_z</a>(k) + (ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classRT__TetrahedronElement.html#a60ce32e45253eb3f5e10173ad792855c">c</a>)*<a class="code" href="classRT__TetrahedronElement.html#ab7d242061cee0278f696b8a44a2f5ada">dshape_z</a>(k))*<a class="code" href="classRT__TetrahedronElement.html#aab59b3e7c60e24f8ee083188cee03068">shape_x</a>(i)*<a class="code" href="classRT__TetrahedronElement.html#a00790e2962824ecd408290f154bd8c5a">shape_y</a>(j);
<a name="l07766"></a>07766       }
<a name="l07767"></a>07767 
<a name="l07768"></a>07768    <a class="code" href="classRT__TetrahedronElement.html#a01aaafd76b1896a50cb2697e927f4c89">T</a>.<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>(divu, divshape);
<a name="l07769"></a>07769 }
<a name="l07770"></a>07770 
<a name="l07771"></a>07771 
<a name="l07772"></a>07772 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classND__HexahedronElement.html#a7f85084b66ebcc6023e77a38edcb0014">ND_HexahedronElement::tk</a>[18] =
<a name="l07773"></a>07773 { 1.,0.,0.,  0.,1.,0.,  0.,0.,1., -1.,0.,0.,  0.,-1.,0.,  0.,0.,-1. };
<a name="l07774"></a>07774 
<a name="l07775"></a><a class="code" href="classND__HexahedronElement.html#a66087392ee53769a60b5aa09b1366c41">07775</a> <a class="code" href="classND__HexahedronElement.html#a66087392ee53769a60b5aa09b1366c41">ND_HexahedronElement::ND_HexahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l07776"></a>07776    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::CUBE, 3*p*(p + 1)*(p + 1), p,
<a name="l07777"></a>07777                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk),
<a name="l07778"></a>07778      cbasis1d(poly1d.ClosedBasis(p)), obasis1d(poly1d.OpenBasis(p - 1)),
<a name="l07779"></a>07779      dof_map(Dof), dof2tk(Dof)
<a name="l07780"></a>07780 {
<a name="l07781"></a>07781    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l07782"></a>07782    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 1);
<a name="l07783"></a>07783    <span class="keyword">const</span> <span class="keywordtype">int</span> dof3 = <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>/3;
<a name="l07784"></a>07784 
<a name="l07785"></a>07785 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l07786"></a>07786 <span class="preprocessor"></span>   <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07787"></a>07787    <a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l07788"></a>07788    <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07789"></a>07789    <a class="code" href="classND__HexahedronElement.html#a33969724795ec0f701ff00297648cb45">shape_oy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l07790"></a>07790    <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07791"></a>07791    <a class="code" href="classND__HexahedronElement.html#a4979682df927700b830a71628b04cc6c">shape_oz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l07792"></a>07792    <a class="code" href="classND__HexahedronElement.html#a0711f31c0e54a486d2d7c8c8b41f1b37">dshape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07793"></a>07793    <a class="code" href="classND__HexahedronElement.html#a7d58a040ab86820feed6c6cea759840d">dshape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07794"></a>07794    <a class="code" href="classND__HexahedronElement.html#ad68e9690aed340e114ac09e2ae61323e">dshape_cz</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l07795"></a>07795 <span class="preprocessor">#endif</span>
<a name="l07796"></a>07796 <span class="preprocessor"></span>
<a name="l07797"></a>07797    <span class="comment">// edges</span>
<a name="l07798"></a>07798    <span class="keywordtype">int</span> o = 0;
<a name="l07799"></a>07799    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (0,1)</span>
<a name="l07800"></a>07800       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (0 + 0*(p + 1))*p] = o++;
<a name="l07801"></a>07801    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (1,2)</span>
<a name="l07802"></a>07802       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + p + (i + 0*p)*(p + 1)] = o++;
<a name="l07803"></a>07803    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (3,2)</span>
<a name="l07804"></a>07804       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (p + 0*(p + 1))*p] = o++;
<a name="l07805"></a>07805    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (0,3)</span>
<a name="l07806"></a>07806       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + 0 + (i + 0*p)*(p + 1)] = o++;
<a name="l07807"></a>07807    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (4,5)</span>
<a name="l07808"></a>07808       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (0 + p*(p + 1))*p] = o++;
<a name="l07809"></a>07809    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (5,6)</span>
<a name="l07810"></a>07810       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + p + (i + p*p)*(p + 1)] = o++;
<a name="l07811"></a>07811    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (7,6)</span>
<a name="l07812"></a>07812       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (p + p*(p + 1))*p] = o++;
<a name="l07813"></a>07813    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (4,7)</span>
<a name="l07814"></a>07814       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + 0 + (i + p*p)*(p + 1)] = o++;
<a name="l07815"></a>07815    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (0,4)</span>
<a name="l07816"></a>07816       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + 0 + (0 + i*(p + 1))*(p + 1)] = o++;
<a name="l07817"></a>07817    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (1,5)</span>
<a name="l07818"></a>07818       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + p + (0 + i*(p + 1))*(p + 1)] = o++;
<a name="l07819"></a>07819    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (2,6)</span>
<a name="l07820"></a>07820       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + p + (p + i*(p + 1))*(p + 1)] = o++;
<a name="l07821"></a>07821    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (3,7)</span>
<a name="l07822"></a>07822       <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + 0 + (p + i*(p + 1))*(p + 1)] = o++;
<a name="l07823"></a>07823 
<a name="l07824"></a>07824    <span class="comment">// faces</span>
<a name="l07825"></a>07825    <span class="comment">// (3,2,1,0) -- bottom</span>
<a name="l07826"></a>07826    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++) <span class="comment">// x - components</span>
<a name="l07827"></a>07827       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07828"></a>07828          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + ((p - j) + 0*(p + 1))*p] = o++;
<a name="l07829"></a>07829    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++) <span class="comment">// y - components</span>
<a name="l07830"></a>07830       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l07831"></a>07831          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + i + ((p - 1 - j) + 0*p)*(p + 1)] = -1 - (o++);
<a name="l07832"></a>07832    <span class="comment">// (0,1,5,4) -- front</span>
<a name="l07833"></a>07833    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++) <span class="comment">// x - components</span>
<a name="l07834"></a>07834       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07835"></a>07835          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (0 + k*(p + 1))*p] = o++;
<a name="l07836"></a>07836    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++) <span class="comment">// z - components</span>
<a name="l07837"></a>07837       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++ )
<a name="l07838"></a>07838          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + i + (0 + k*(p + 1))*(p + 1)] = o++;
<a name="l07839"></a>07839    <span class="comment">// (1,2,6,5) -- right</span>
<a name="l07840"></a>07840    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++) <span class="comment">// y - components</span>
<a name="l07841"></a>07841       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l07842"></a>07842          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + p + (j + k*p)*(p + 1)] = o++;
<a name="l07843"></a>07843    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++) <span class="comment">// z - components</span>
<a name="l07844"></a>07844       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l07845"></a>07845          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + p + (j + k*(p + 1))*(p + 1)] = o++;
<a name="l07846"></a>07846    <span class="comment">// (2,3,7,6) -- back</span>
<a name="l07847"></a>07847    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++) <span class="comment">// x - components</span>
<a name="l07848"></a>07848       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07849"></a>07849          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + (p - 1 - i) + (p + k*(p + 1))*p] = -1 - (o++);
<a name="l07850"></a>07850    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++) <span class="comment">// z - components</span>
<a name="l07851"></a>07851       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l07852"></a>07852          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + (p - i) + (p + k*(p + 1))*(p + 1)] = o++;
<a name="l07853"></a>07853    <span class="comment">// (3,0,4,7) -- left</span>
<a name="l07854"></a>07854    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++) <span class="comment">// y - components</span>
<a name="l07855"></a>07855       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l07856"></a>07856          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + 0 + ((p - 1 - j) + k*p)*(p + 1)] = -1 - (o++);
<a name="l07857"></a>07857    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++) <span class="comment">// z - components</span>
<a name="l07858"></a>07858       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l07859"></a>07859          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + 0 + ((p - j) + k*(p + 1))*(p + 1)] = o++;
<a name="l07860"></a>07860    <span class="comment">// (4,5,6,7) -- top</span>
<a name="l07861"></a>07861    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++) <span class="comment">// x - components</span>
<a name="l07862"></a>07862       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07863"></a>07863          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (j + p*(p + 1))*p] = o++;
<a name="l07864"></a>07864    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++) <span class="comment">// y - components</span>
<a name="l07865"></a>07865       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l07866"></a>07866          <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + i + (j + p*p)*(p + 1)] = o++;
<a name="l07867"></a>07867 
<a name="l07868"></a>07868    <span class="comment">// interior</span>
<a name="l07869"></a>07869    <span class="comment">// x-components</span>
<a name="l07870"></a>07870    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++)
<a name="l07871"></a>07871       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l07872"></a>07872          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07873"></a>07873             <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[0*dof3 + i + (j + k*(p + 1))*p] = o++;
<a name="l07874"></a>07874    <span class="comment">// y-components</span>
<a name="l07875"></a>07875    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; p; k++)
<a name="l07876"></a>07876       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l07877"></a>07877          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l07878"></a>07878             <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[1*dof3 + i + (j + k*p)*(p + 1)] = o++;
<a name="l07879"></a>07879    <span class="comment">// z-components</span>
<a name="l07880"></a>07880    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++)
<a name="l07881"></a>07881       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l07882"></a>07882          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l07883"></a>07883             <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[2*dof3 + i + (j + k*(p + 1))*(p + 1)] = o++;
<a name="l07884"></a>07884 
<a name="l07885"></a>07885    <span class="comment">// set dof2tk and Nodes</span>
<a name="l07886"></a>07886    o = 0;
<a name="l07887"></a>07887    <span class="comment">// x-components</span>
<a name="l07888"></a>07888    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07889"></a>07889       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07890"></a>07890          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07891"></a>07891          {
<a name="l07892"></a>07892             <span class="keywordtype">int</span> idx;
<a name="l07893"></a>07893             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l07894"></a>07894                <a class="code" href="classND__HexahedronElement.html#adb227971a25e44fb5445979919d9ddba">dof2tk</a>[idx = -1 - idx] = 3;
<a name="l07895"></a>07895             <span class="keywordflow">else</span>
<a name="l07896"></a>07896                <a class="code" href="classND__HexahedronElement.html#adb227971a25e44fb5445979919d9ddba">dof2tk</a>[idx] = 0;
<a name="l07897"></a>07897             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(op[i], cp[j], cp[k]);
<a name="l07898"></a>07898          }
<a name="l07899"></a>07899    <span class="comment">// y-components</span>
<a name="l07900"></a>07900    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07901"></a>07901       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l07902"></a>07902          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07903"></a>07903          {
<a name="l07904"></a>07904             <span class="keywordtype">int</span> idx;
<a name="l07905"></a>07905             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l07906"></a>07906                <a class="code" href="classND__HexahedronElement.html#adb227971a25e44fb5445979919d9ddba">dof2tk</a>[idx = -1 - idx] = 4;
<a name="l07907"></a>07907             <span class="keywordflow">else</span>
<a name="l07908"></a>07908                <a class="code" href="classND__HexahedronElement.html#adb227971a25e44fb5445979919d9ddba">dof2tk</a>[idx] = 1;
<a name="l07909"></a>07909             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i], op[j], cp[k]);
<a name="l07910"></a>07910          }
<a name="l07911"></a>07911    <span class="comment">// z-components</span>
<a name="l07912"></a>07912    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++)
<a name="l07913"></a>07913       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07914"></a>07914          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07915"></a>07915          {
<a name="l07916"></a>07916             <span class="keywordtype">int</span> idx;
<a name="l07917"></a>07917             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l07918"></a>07918                <a class="code" href="classND__HexahedronElement.html#adb227971a25e44fb5445979919d9ddba">dof2tk</a>[idx = -1 - idx] = 5;
<a name="l07919"></a>07919             <span class="keywordflow">else</span>
<a name="l07920"></a>07920                <a class="code" href="classND__HexahedronElement.html#adb227971a25e44fb5445979919d9ddba">dof2tk</a>[idx] = 2;
<a name="l07921"></a>07921             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(cp[i], cp[j], op[k]);
<a name="l07922"></a>07922          }
<a name="l07923"></a>07923 }
<a name="l07924"></a>07924 
<a name="l07925"></a><a class="code" href="classND__HexahedronElement.html#a59e4b4db1fd526e53dab842a23a679c0">07925</a> <span class="keywordtype">void</span> <a class="code" href="classND__HexahedronElement.html#a59e4b4db1fd526e53dab842a23a679c0">ND_HexahedronElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07926"></a>07926                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l07927"></a>07927 <span class="keyword"></span>{
<a name="l07928"></a>07928    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l07929"></a>07929 
<a name="l07930"></a>07930 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07931"></a>07931 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>(p), <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a33969724795ec0f701ff00297648cb45">shape_oy</a>(p);
<a name="l07932"></a>07932    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a4979682df927700b830a71628b04cc6c">shape_oz</a>(p);
<a name="l07933"></a>07933 <span class="preprocessor">#endif</span>
<a name="l07934"></a>07934 <span class="preprocessor"></span>
<a name="l07935"></a>07935    <a class="code" href="classND__HexahedronElement.html#ac6853d5a35a1db73127dcf06bd40481f">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>);
<a name="l07936"></a>07936    <a class="code" href="classND__HexahedronElement.html#ab10e2d324b43ca4c59d28bcd95b551d6">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>);
<a name="l07937"></a>07937    <a class="code" href="classND__HexahedronElement.html#ac6853d5a35a1db73127dcf06bd40481f">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>);
<a name="l07938"></a>07938    <a class="code" href="classND__HexahedronElement.html#ab10e2d324b43ca4c59d28bcd95b551d6">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l07939"></a>07939    <a class="code" href="classND__HexahedronElement.html#ac6853d5a35a1db73127dcf06bd40481f">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>);
<a name="l07940"></a>07940    <a class="code" href="classND__HexahedronElement.html#ab10e2d324b43ca4c59d28bcd95b551d6">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_oz);
<a name="l07941"></a>07941 
<a name="l07942"></a>07942    <span class="keywordtype">int</span> o = 0;
<a name="l07943"></a>07943    <span class="comment">// x-components</span>
<a name="l07944"></a>07944    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07945"></a>07945       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07946"></a>07946          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l07947"></a>07947          {
<a name="l07948"></a>07948             <span class="keywordtype">int</span> idx, s;
<a name="l07949"></a>07949             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l07950"></a>07950                idx = -1 - idx, s = -1;
<a name="l07951"></a>07951             <span class="keywordflow">else</span>
<a name="l07952"></a>07952                s = +1;
<a name="l07953"></a>07953             shape(idx,0) = s*<a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>(i)*<a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>(j)*<a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>(k);
<a name="l07954"></a>07954             shape(idx,1) = 0.;
<a name="l07955"></a>07955             shape(idx,2) = 0.;
<a name="l07956"></a>07956          }
<a name="l07957"></a>07957    <span class="comment">// y-components</span>
<a name="l07958"></a>07958    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l07959"></a>07959       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l07960"></a>07960          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07961"></a>07961          {
<a name="l07962"></a>07962             <span class="keywordtype">int</span> idx, s;
<a name="l07963"></a>07963             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l07964"></a>07964                idx = -1 - idx, s = -1;
<a name="l07965"></a>07965             <span class="keywordflow">else</span>
<a name="l07966"></a>07966                s = +1;
<a name="l07967"></a>07967             shape(idx,0) = 0.;
<a name="l07968"></a>07968             shape(idx,1) = s*<a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>(i)*<a class="code" href="classND__HexahedronElement.html#a33969724795ec0f701ff00297648cb45">shape_oy</a>(j)*<a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>(k);
<a name="l07969"></a>07969             shape(idx,2) = 0.;
<a name="l07970"></a>07970          }
<a name="l07971"></a>07971    <span class="comment">// z-components</span>
<a name="l07972"></a>07972    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++)
<a name="l07973"></a>07973       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l07974"></a>07974          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l07975"></a>07975          {
<a name="l07976"></a>07976             <span class="keywordtype">int</span> idx, s;
<a name="l07977"></a>07977             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l07978"></a>07978                idx = -1 - idx, s = -1;
<a name="l07979"></a>07979             <span class="keywordflow">else</span>
<a name="l07980"></a>07980                s = +1;
<a name="l07981"></a>07981             shape(idx,0) = 0.;
<a name="l07982"></a>07982             shape(idx,1) = 0.;
<a name="l07983"></a>07983             shape(idx,2) = s*<a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>(i)*<a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>(j)*<a class="code" href="classND__HexahedronElement.html#a4979682df927700b830a71628b04cc6c">shape_oz</a>(k);
<a name="l07984"></a>07984          }
<a name="l07985"></a>07985 }
<a name="l07986"></a>07986 
<a name="l07987"></a><a class="code" href="classND__HexahedronElement.html#a0b4e5941c29f67a39ae1108fd56bf3d2">07987</a> <span class="keywordtype">void</span> <a class="code" href="classND__HexahedronElement.html#a0b4e5941c29f67a39ae1108fd56bf3d2">ND_HexahedronElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l07988"></a>07988                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"> const</span>
<a name="l07989"></a>07989 <span class="keyword"></span>{
<a name="l07990"></a>07990    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l07991"></a>07991 
<a name="l07992"></a>07992 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l07993"></a>07993 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>(p), <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a33969724795ec0f701ff00297648cb45">shape_oy</a>(p);
<a name="l07994"></a>07994    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a4979682df927700b830a71628b04cc6c">shape_oz</a>(p);
<a name="l07995"></a>07995    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__HexahedronElement.html#a0711f31c0e54a486d2d7c8c8b41f1b37">dshape_cx</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#a7d58a040ab86820feed6c6cea759840d">dshape_cy</a>(p + 1), <a class="code" href="classND__HexahedronElement.html#ad68e9690aed340e114ac09e2ae61323e">dshape_cz</a>(p + 1);
<a name="l07996"></a>07996 <span class="preprocessor">#endif</span>
<a name="l07997"></a>07997 <span class="preprocessor"></span>
<a name="l07998"></a>07998    <a class="code" href="classND__HexahedronElement.html#ac6853d5a35a1db73127dcf06bd40481f">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>, <a class="code" href="classND__HexahedronElement.html#a0711f31c0e54a486d2d7c8c8b41f1b37">dshape_cx</a>);
<a name="l07999"></a>07999    <a class="code" href="classND__HexahedronElement.html#ab10e2d324b43ca4c59d28bcd95b551d6">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>);
<a name="l08000"></a>08000    <a class="code" href="classND__HexahedronElement.html#ac6853d5a35a1db73127dcf06bd40481f">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>, <a class="code" href="classND__HexahedronElement.html#a7d58a040ab86820feed6c6cea759840d">dshape_cy</a>);
<a name="l08001"></a>08001    <a class="code" href="classND__HexahedronElement.html#ab10e2d324b43ca4c59d28bcd95b551d6">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l08002"></a>08002    <a class="code" href="classND__HexahedronElement.html#ac6853d5a35a1db73127dcf06bd40481f">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>, dshape_cz);
<a name="l08003"></a>08003    <a class="code" href="classND__HexahedronElement.html#ab10e2d324b43ca4c59d28bcd95b551d6">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_oz);
<a name="l08004"></a>08004 
<a name="l08005"></a>08005    <span class="keywordtype">int</span> o = 0;
<a name="l08006"></a>08006    <span class="comment">// x-components</span>
<a name="l08007"></a>08007    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l08008"></a>08008       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l08009"></a>08009          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l08010"></a>08010          {
<a name="l08011"></a>08011             <span class="keywordtype">int</span> idx, s;
<a name="l08012"></a>08012             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l08013"></a>08013                idx = -1 - idx, s = -1;
<a name="l08014"></a>08014             <span class="keywordflow">else</span>
<a name="l08015"></a>08015                s = +1;
<a name="l08016"></a>08016             curl_shape(idx,0) = 0.;
<a name="l08017"></a>08017             curl_shape(idx,1) =  s*<a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>(i)* <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>(j)*<a class="code" href="classND__HexahedronElement.html#ad68e9690aed340e114ac09e2ae61323e">dshape_cz</a>(k);
<a name="l08018"></a>08018             curl_shape(idx,2) = -s*<a class="code" href="classND__HexahedronElement.html#a532ce50115d2e2e8889b1df7c1d77649">shape_ox</a>(i)*<a class="code" href="classND__HexahedronElement.html#a7d58a040ab86820feed6c6cea759840d">dshape_cy</a>(j)* <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>(k);
<a name="l08019"></a>08019          }
<a name="l08020"></a>08020    <span class="comment">// y-components</span>
<a name="l08021"></a>08021    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= p; k++)
<a name="l08022"></a>08022       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l08023"></a>08023          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l08024"></a>08024          {
<a name="l08025"></a>08025             <span class="keywordtype">int</span> idx, s;
<a name="l08026"></a>08026             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l08027"></a>08027                idx = -1 - idx, s = -1;
<a name="l08028"></a>08028             <span class="keywordflow">else</span>
<a name="l08029"></a>08029                s = +1;
<a name="l08030"></a>08030             curl_shape(idx,0) = -s* <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>(i)*<a class="code" href="classND__HexahedronElement.html#a33969724795ec0f701ff00297648cb45">shape_oy</a>(j)*<a class="code" href="classND__HexahedronElement.html#ad68e9690aed340e114ac09e2ae61323e">dshape_cz</a>(k);
<a name="l08031"></a>08031             curl_shape(idx,1) = 0.;
<a name="l08032"></a>08032             curl_shape(idx,2) =  s*<a class="code" href="classND__HexahedronElement.html#a0711f31c0e54a486d2d7c8c8b41f1b37">dshape_cx</a>(i)*<a class="code" href="classND__HexahedronElement.html#a33969724795ec0f701ff00297648cb45">shape_oy</a>(j)* <a class="code" href="classND__HexahedronElement.html#a9c8e20dfc296a53e734993f7c1b39e03">shape_cz</a>(k);
<a name="l08033"></a>08033          }
<a name="l08034"></a>08034    <span class="comment">// z-components</span>
<a name="l08035"></a>08035    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; p; k++)
<a name="l08036"></a>08036       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l08037"></a>08037          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l08038"></a>08038          {
<a name="l08039"></a>08039             <span class="keywordtype">int</span> idx, s;
<a name="l08040"></a>08040             <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__HexahedronElement.html#af162e3560961d293a1eaec13f870d052">dof_map</a>[o++]) &lt; 0)
<a name="l08041"></a>08041                idx = -1 - idx, s = -1;
<a name="l08042"></a>08042             <span class="keywordflow">else</span>
<a name="l08043"></a>08043                s = +1;
<a name="l08044"></a>08044             curl_shape(idx,0) =   s* <a class="code" href="classND__HexahedronElement.html#a3354ff89f38f75bac14f7948f1b29a2b">shape_cx</a>(i)*<a class="code" href="classND__HexahedronElement.html#a7d58a040ab86820feed6c6cea759840d">dshape_cy</a>(j)*<a class="code" href="classND__HexahedronElement.html#a4979682df927700b830a71628b04cc6c">shape_oz</a>(k);
<a name="l08045"></a>08045             curl_shape(idx,1) =  -s*<a class="code" href="classND__HexahedronElement.html#a0711f31c0e54a486d2d7c8c8b41f1b37">dshape_cx</a>(i)* <a class="code" href="classND__HexahedronElement.html#a06fa3bbf4093ec9008b96efda5f62b30">shape_cy</a>(j)*<a class="code" href="classND__HexahedronElement.html#a4979682df927700b830a71628b04cc6c">shape_oz</a>(k);
<a name="l08046"></a>08046             curl_shape(idx,2) = 0.;
<a name="l08047"></a>08047          }
<a name="l08048"></a>08048 }
<a name="l08049"></a>08049 
<a name="l08050"></a>08050 
<a name="l08051"></a>08051 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classND__QuadrilateralElement.html#aff91c3453ed60b9fc66f788a466cde3c">ND_QuadrilateralElement::tk</a>[8] =
<a name="l08052"></a>08052 { 1.,0.,  0.,1., -1.,0., 0.,-1. };
<a name="l08053"></a>08053 
<a name="l08054"></a><a class="code" href="classND__QuadrilateralElement.html#a2c1755edba0a2c4875cb0b0604eb4788">08054</a> <a class="code" href="classND__QuadrilateralElement.html#a2c1755edba0a2c4875cb0b0604eb4788">ND_QuadrilateralElement::ND_QuadrilateralElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l08055"></a>08055    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::SQUARE, 2*p*(p + 1), p,
<a name="l08056"></a>08056                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Qk),
<a name="l08057"></a>08057      cbasis1d(poly1d.ClosedBasis(p)), obasis1d(poly1d.OpenBasis(p - 1)),
<a name="l08058"></a>08058      dof_map(Dof), dof2tk(Dof)
<a name="l08059"></a>08059 {
<a name="l08060"></a>08060    <span class="keyword">const</span> <span class="keywordtype">double</span> *cp = poly1d.<a class="code" href="classPoly__1D.html#a3511478fb55fdd2fe41923c3ed209e48">ClosedPoints</a>(p);
<a name="l08061"></a>08061    <span class="keyword">const</span> <span class="keywordtype">double</span> *op = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 1);
<a name="l08062"></a>08062    <span class="keyword">const</span> <span class="keywordtype">int</span> dof2 = <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>/2;
<a name="l08063"></a>08063 
<a name="l08064"></a>08064 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l08065"></a>08065 <span class="preprocessor"></span>   <a class="code" href="classND__QuadrilateralElement.html#abf3ccc14b4560e317e938585e9637915">shape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l08066"></a>08066    <a class="code" href="classND__QuadrilateralElement.html#a728f6867ea5a7b504c29e7892690a591">shape_ox</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08067"></a>08067    <a class="code" href="classND__QuadrilateralElement.html#a0a634276fef15507cf10601cb83e14f2">shape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l08068"></a>08068    <a class="code" href="classND__QuadrilateralElement.html#a845f03627907a1f30dc09c7bc05e40b2">shape_oy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08069"></a>08069    <a class="code" href="classND__QuadrilateralElement.html#ad9b117b740f7ade37e6737dede2ff305">dshape_cx</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l08070"></a>08070    <a class="code" href="classND__QuadrilateralElement.html#a9e10b63bdb8ab22e7af5c8a642b8ef92">dshape_cy</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p + 1);
<a name="l08071"></a>08071 <span class="preprocessor">#endif</span>
<a name="l08072"></a>08072 <span class="preprocessor"></span>
<a name="l08073"></a>08073    <span class="comment">// edges</span>
<a name="l08074"></a>08074    <span class="keywordtype">int</span> o = 0;
<a name="l08075"></a>08075    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (0,1)</span>
<a name="l08076"></a>08076       <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[0*dof2 + i + 0*p] = o++;
<a name="l08077"></a>08077    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)  <span class="comment">// (1,2)</span>
<a name="l08078"></a>08078       <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[1*dof2 + p + j*(p + 1)] = o++;
<a name="l08079"></a>08079    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)  <span class="comment">// (2,3)</span>
<a name="l08080"></a>08080       <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[0*dof2 + (p - 1 - i) + p*p] = -1 - (o++);
<a name="l08081"></a>08081    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)  <span class="comment">// (3,0)</span>
<a name="l08082"></a>08082       <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[1*dof2 + 0 + (p - 1 - j)*(p + 1)] = -1 - (o++);
<a name="l08083"></a>08083 
<a name="l08084"></a>08084    <span class="comment">// interior</span>
<a name="l08085"></a>08085    <span class="comment">// x-components</span>
<a name="l08086"></a>08086    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; p; j++)
<a name="l08087"></a>08087       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l08088"></a>08088          <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[0*dof2 + i + j*p] = o++;
<a name="l08089"></a>08089    <span class="comment">// y-components</span>
<a name="l08090"></a>08090    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l08091"></a>08091       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; p; i++)
<a name="l08092"></a>08092          <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[1*dof2 + i + j*(p + 1)] = o++;
<a name="l08093"></a>08093 
<a name="l08094"></a>08094    <span class="comment">// set dof2tk and Nodes</span>
<a name="l08095"></a>08095    o = 0;
<a name="l08096"></a>08096    <span class="comment">// x-components</span>
<a name="l08097"></a>08097    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l08098"></a>08098       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l08099"></a>08099       {
<a name="l08100"></a>08100          <span class="keywordtype">int</span> idx;
<a name="l08101"></a>08101          <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[o++]) &lt; 0)
<a name="l08102"></a>08102             <a class="code" href="classND__QuadrilateralElement.html#ac40149b26d26e27558370c503225c66c">dof2tk</a>[idx = -1 - idx] = 2;
<a name="l08103"></a>08103          <span class="keywordflow">else</span>
<a name="l08104"></a>08104             <a class="code" href="classND__QuadrilateralElement.html#ac40149b26d26e27558370c503225c66c">dof2tk</a>[idx] = 0;
<a name="l08105"></a>08105          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(op[i], cp[j]);
<a name="l08106"></a>08106       }
<a name="l08107"></a>08107    <span class="comment">// y-components</span>
<a name="l08108"></a>08108    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l08109"></a>08109       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l08110"></a>08110       {
<a name="l08111"></a>08111          <span class="keywordtype">int</span> idx;
<a name="l08112"></a>08112          <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[o++]) &lt; 0)
<a name="l08113"></a>08113             <a class="code" href="classND__QuadrilateralElement.html#ac40149b26d26e27558370c503225c66c">dof2tk</a>[idx = -1 - idx] = 3;
<a name="l08114"></a>08114          <span class="keywordflow">else</span>
<a name="l08115"></a>08115             <a class="code" href="classND__QuadrilateralElement.html#ac40149b26d26e27558370c503225c66c">dof2tk</a>[idx] = 1;
<a name="l08116"></a>08116          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(idx).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(cp[i], op[j]);
<a name="l08117"></a>08117       }
<a name="l08118"></a>08118 }
<a name="l08119"></a>08119 
<a name="l08120"></a><a class="code" href="classND__QuadrilateralElement.html#a4a58c1f9c563aebdb2621c43d6f04e8f">08120</a> <span class="keywordtype">void</span> <a class="code" href="classND__QuadrilateralElement.html#a4a58c1f9c563aebdb2621c43d6f04e8f">ND_QuadrilateralElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08121"></a>08121                                          <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l08122"></a>08122 <span class="keyword"></span>{
<a name="l08123"></a>08123    <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l08124"></a>08124 
<a name="l08125"></a>08125 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l08126"></a>08126 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__QuadrilateralElement.html#abf3ccc14b4560e317e938585e9637915">shape_cx</a>(p + 1), <a class="code" href="classND__QuadrilateralElement.html#a728f6867ea5a7b504c29e7892690a591">shape_ox</a>(p), <a class="code" href="classND__QuadrilateralElement.html#a0a634276fef15507cf10601cb83e14f2">shape_cy</a>(p + 1), <a class="code" href="classND__QuadrilateralElement.html#a845f03627907a1f30dc09c7bc05e40b2">shape_oy</a>(p);
<a name="l08127"></a>08127 <span class="preprocessor">#endif</span>
<a name="l08128"></a>08128 <span class="preprocessor"></span>
<a name="l08129"></a>08129    <a class="code" href="classND__QuadrilateralElement.html#a92ac1f793a6d14486e7f46036f3bf20e">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__QuadrilateralElement.html#abf3ccc14b4560e317e938585e9637915">shape_cx</a>);
<a name="l08130"></a>08130    <a class="code" href="classND__QuadrilateralElement.html#aa170c2726ae910da35be90f7cbaa5e99">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__QuadrilateralElement.html#a728f6867ea5a7b504c29e7892690a591">shape_ox</a>);
<a name="l08131"></a>08131    <a class="code" href="classND__QuadrilateralElement.html#a92ac1f793a6d14486e7f46036f3bf20e">cbasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__QuadrilateralElement.html#a0a634276fef15507cf10601cb83e14f2">shape_cy</a>);
<a name="l08132"></a>08132    <a class="code" href="classND__QuadrilateralElement.html#aa170c2726ae910da35be90f7cbaa5e99">obasis1d</a>.<a class="code" href="classPoly__1D_1_1Basis.html#a09b1b3f93c9bc9372603d876f619deeb">Eval</a>(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_oy);
<a name="l08133"></a>08133 
<a name="l08134"></a>08134    <span class="keywordtype">int</span> o = 0;
<a name="l08135"></a>08135    <span class="comment">// x-components</span>
<a name="l08136"></a>08136    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= p; j++)
<a name="l08137"></a>08137       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++)
<a name="l08138"></a>08138       {
<a name="l08139"></a>08139          <span class="keywordtype">int</span> idx, s;
<a name="l08140"></a>08140          <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[o++]) &lt; 0)
<a name="l08141"></a>08141             idx = -1 - idx, s = -1;
<a name="l08142"></a>08142          <span class="keywordflow">else</span>
<a name="l08143"></a>08143             s = +1;
<a name="l08144"></a>08144          shape(idx,0) = s*<a class="code" href="classND__QuadrilateralElement.html#a728f6867ea5a7b504c29e7892690a591">shape_ox</a>(i)*<a class="code" href="classND__QuadrilateralElement.html#a0a634276fef15507cf10601cb83e14f2">shape_cy</a>(j);
<a name="l08145"></a>08145          shape(idx,1) = 0.;
<a name="l08146"></a>08146       }
<a name="l08147"></a>08147    <span class="comment">// y-components</span>
<a name="l08148"></a>08148    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; p; j++)
<a name="l08149"></a>08149       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= p; i++)
<a name="l08150"></a>08150       {
<a name="l08151"></a>08151          <span class="keywordtype">int</span> idx, s;
<a name="l08152"></a>08152          <span class="keywordflow">if</span> ((idx = <a class="code" href="classND__QuadrilateralElement.html#a98890dbd6892b056f3fd46e3754d34a4">dof_map</a>[o++]) &lt; 0)
<a name="l08153"></a>08153             idx = -1 - idx, s = -1;
<a name="l08154"></a>08154          <span class="keywordflow">else</span>
<a name="l08155"></a>08155             s = +1;
<a name="l08156"></a>08156          shape(idx,0) = 0.;
<a name="l08157"></a>08157          shape(idx,1) = s*<a class="code" href="classND__QuadrilateralElement.html#abf3ccc14b4560e317e938585e9637915">shape_cx</a>(i)*<a class="code" href="classND__QuadrilateralElement.html#a845f03627907a1f30dc09c7bc05e40b2">shape_oy</a>(j);
<a name="l08158"></a>08158       }
<a name="l08159"></a>08159 }
<a name="l08160"></a>08160 
<a name="l08161"></a><a class="code" href="classND__QuadrilateralElement.html#a26f14766e53b8ad5aefd0d125517509d">08161</a> <span class="keywordtype">void</span> <a class="code" href="classND__QuadrilateralElement.html#a26f14766e53b8ad5aefd0d125517509d">ND_QuadrilateralElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08162"></a>08162                                             <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"> const</span>
<a name="l08163"></a>08163 <span class="keyword"></span>{
<a name="l08164"></a>08164    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;ND_QuadrilateralElement::CalcCurlShape&quot;</span>);
<a name="l08165"></a>08165 }
<a name="l08166"></a>08166 
<a name="l08167"></a>08167 
<a name="l08168"></a>08168 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classND__TetrahedronElement.html#ae2c52748126354107be37aa8bf9542a9">ND_TetrahedronElement::tk</a>[18] =
<a name="l08169"></a>08169 { 1.,0.,0.,  0.,1.,0.,  0.,0.,1.,  -1.,1.,0.,  -1.,0.,1.,  0.,-1.,1. };
<a name="l08170"></a>08170 
<a name="l08171"></a>08171 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">ND_TetrahedronElement::c</a> = 1./4.;
<a name="l08172"></a>08172 
<a name="l08173"></a><a class="code" href="classND__TetrahedronElement.html#a24c7bf4c045db37f39d3388d6ddc4fad">08173</a> <a class="code" href="classND__TetrahedronElement.html#a24c7bf4c045db37f39d3388d6ddc4fad">ND_TetrahedronElement::ND_TetrahedronElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l08174"></a>08174    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(3, <a class="code" href="classGeometry.html">Geometry</a>::TETRAHEDRON, p*(p + 2)*(p + 3)/2, p,
<a name="l08175"></a>08175                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), dof2tk(Dof), T(Dof)
<a name="l08176"></a>08176 {
<a name="l08177"></a>08177    <span class="keyword">const</span> <span class="keywordtype">double</span> *eop = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 1);
<a name="l08178"></a>08178    <span class="keyword">const</span> <span class="keywordtype">double</span> *fop = (p &gt; 1) ? poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 2) : NULL;
<a name="l08179"></a>08179    <span class="keyword">const</span> <span class="keywordtype">double</span> *iop = (p &gt; 2) ? poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 3) : NULL;
<a name="l08180"></a>08180 
<a name="l08181"></a>08181    <span class="keyword">const</span> <span class="keywordtype">int</span> pm1 = p - 1, pm2 = p - 2, pm3 = p - 3;
<a name="l08182"></a>08182 
<a name="l08183"></a>08183 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l08184"></a>08184 <span class="preprocessor"></span>   <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08185"></a>08185    <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08186"></a>08186    <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08187"></a>08187    <a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08188"></a>08188    <a class="code" href="classND__TetrahedronElement.html#af9a09b6da49b3f17a7c6e6096f8a302f">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08189"></a>08189    <a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08190"></a>08190    <a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08191"></a>08191    <a class="code" href="classND__TetrahedronElement.html#afac324079afd06b0037186590dd66d18">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08192"></a>08192    <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l08193"></a>08193 <span class="preprocessor">#else</span>
<a name="l08194"></a>08194 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(p), <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(p), <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(p), <a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(p);
<a name="l08195"></a>08195 <span class="preprocessor">#endif</span>
<a name="l08196"></a>08196 <span class="preprocessor"></span>
<a name="l08197"></a>08197    <span class="keywordtype">int</span> o = 0;
<a name="l08198"></a>08198    <span class="comment">// edges</span>
<a name="l08199"></a>08199    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (0,1)</span>
<a name="l08200"></a>08200    {
<a name="l08201"></a>08201       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(eop[i], 0., 0.);
<a name="l08202"></a>08202       <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 0;
<a name="l08203"></a>08203    }
<a name="l08204"></a>08204    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (0,2)</span>
<a name="l08205"></a>08205    {
<a name="l08206"></a>08206       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(0., eop[i], 0.);
<a name="l08207"></a>08207       <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 1;
<a name="l08208"></a>08208    }
<a name="l08209"></a>08209    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (0,3)</span>
<a name="l08210"></a>08210    {
<a name="l08211"></a>08211       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(0., 0., eop[i]);
<a name="l08212"></a>08212       <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 2;
<a name="l08213"></a>08213    }
<a name="l08214"></a>08214    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (1,2)</span>
<a name="l08215"></a>08215    {
<a name="l08216"></a>08216       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(eop[pm1-i], eop[i], 0.);
<a name="l08217"></a>08217       <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 3;
<a name="l08218"></a>08218    }
<a name="l08219"></a>08219    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (1,3)</span>
<a name="l08220"></a>08220    {
<a name="l08221"></a>08221       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(eop[pm1-i], 0., eop[i]);
<a name="l08222"></a>08222       <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 4;
<a name="l08223"></a>08223    }
<a name="l08224"></a>08224    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (2,3)</span>
<a name="l08225"></a>08225    {
<a name="l08226"></a>08226       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(0., eop[pm1-i], eop[i]);
<a name="l08227"></a>08227       <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 5;
<a name="l08228"></a>08228    }
<a name="l08229"></a>08229 
<a name="l08230"></a>08230    <span class="comment">// faces</span>
<a name="l08231"></a>08231    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm2; j++)  <span class="comment">// (1,2,3)</span>
<a name="l08232"></a>08232       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm2; i++)
<a name="l08233"></a>08233       {
<a name="l08234"></a>08234          <span class="keywordtype">double</span> w = fop[i] + fop[j] + fop[pm2-i-j];
<a name="l08235"></a>08235          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(fop[pm2-i-j]/w, fop[i]/w, fop[j]/w);
<a name="l08236"></a>08236          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 3;
<a name="l08237"></a>08237          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(fop[pm2-i-j]/w, fop[i]/w, fop[j]/w);
<a name="l08238"></a>08238          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 4;
<a name="l08239"></a>08239       }
<a name="l08240"></a>08240    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm2; j++)  <span class="comment">// (0,3,2)</span>
<a name="l08241"></a>08241       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm2; i++)
<a name="l08242"></a>08242       {
<a name="l08243"></a>08243          <span class="keywordtype">double</span> w = fop[i] + fop[j] + fop[pm2-i-j];
<a name="l08244"></a>08244          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(0., fop[j]/w, fop[i]/w);
<a name="l08245"></a>08245          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 2;
<a name="l08246"></a>08246          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(0., fop[j]/w, fop[i]/w);
<a name="l08247"></a>08247          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 1;
<a name="l08248"></a>08248       }
<a name="l08249"></a>08249    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm2; j++)  <span class="comment">// (0,1,3)</span>
<a name="l08250"></a>08250       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm2; i++)
<a name="l08251"></a>08251       {
<a name="l08252"></a>08252          <span class="keywordtype">double</span> w = fop[i] + fop[j] + fop[pm2-i-j];
<a name="l08253"></a>08253          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(fop[i]/w, 0., fop[j]/w);
<a name="l08254"></a>08254          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 0;
<a name="l08255"></a>08255          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(fop[i]/w, 0., fop[j]/w);
<a name="l08256"></a>08256          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 2;
<a name="l08257"></a>08257       }
<a name="l08258"></a>08258    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm2; j++)  <span class="comment">// (0,2,1)</span>
<a name="l08259"></a>08259       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm2; i++)
<a name="l08260"></a>08260       {
<a name="l08261"></a>08261          <span class="keywordtype">double</span> w = fop[i] + fop[j] + fop[pm2-i-j];
<a name="l08262"></a>08262          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(fop[j]/w, fop[i]/w, 0.);
<a name="l08263"></a>08263          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 1;
<a name="l08264"></a>08264          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(fop[j]/w, fop[i]/w, 0.);
<a name="l08265"></a>08265          <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 0;
<a name="l08266"></a>08266       }
<a name="l08267"></a>08267 
<a name="l08268"></a>08268    <span class="comment">// interior</span>
<a name="l08269"></a>08269    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm3; k++)
<a name="l08270"></a>08270       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm3; j++)
<a name="l08271"></a>08271          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= pm3; i++)
<a name="l08272"></a>08272          {
<a name="l08273"></a>08273             <span class="keywordtype">double</span> w = iop[i] + iop[j] + iop[k] + iop[pm3-i-j-k];
<a name="l08274"></a>08274             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(iop[i]/w, iop[j]/w, iop[k]/w);
<a name="l08275"></a>08275             <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 0;
<a name="l08276"></a>08276             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(iop[i]/w, iop[j]/w, iop[k]/w);
<a name="l08277"></a>08277             <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 1;
<a name="l08278"></a>08278             <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(o).<a class="code" href="classIntegrationPoint.html#a79c73aec1a18d21dce57f9c05a7b8610">Set3</a>(iop[i]/w, iop[j]/w, iop[k]/w);
<a name="l08279"></a>08279             <a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[o++] = 2;
<a name="l08280"></a>08280          }
<a name="l08281"></a>08281 
<a name="l08282"></a>08282    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; m++)
<a name="l08283"></a>08283    {
<a name="l08284"></a>08284       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(m);
<a name="l08285"></a>08285       <span class="keyword">const</span> <span class="keywordtype">double</span> *tm = <a class="code" href="classND__TetrahedronElement.html#ae2c52748126354107be37aa8bf9542a9">tk</a> + 3*<a class="code" href="classND__TetrahedronElement.html#a2071782383e67eb7debef8447eddcf23">dof2tk</a>[m];
<a name="l08286"></a>08286       o = 0;
<a name="l08287"></a>08287 
<a name="l08288"></a>08288       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>);
<a name="l08289"></a>08289       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>);
<a name="l08290"></a>08290       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>);
<a name="l08291"></a>08291       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l08292"></a>08292 
<a name="l08293"></a>08293       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08294"></a>08294          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm1; j++)
<a name="l08295"></a>08295             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= pm1; i++)
<a name="l08296"></a>08296             {
<a name="l08297"></a>08297                <span class="keywordtype">double</span> s = <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)*<a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(pm1-i-j-k);
<a name="l08298"></a>08298                <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>(o++, m) = s * tm[0];
<a name="l08299"></a>08299                <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>(o++, m) = s * tm[1];
<a name="l08300"></a>08300                <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>(o++, m) = s * tm[2];
<a name="l08301"></a>08301             }
<a name="l08302"></a>08302       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08303"></a>08303          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm1; j++)
<a name="l08304"></a>08304          {
<a name="l08305"></a>08305             <span class="keywordtype">double</span> s = <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(pm1-j-k)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k);
<a name="l08306"></a>08306             <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>(o++, m) = s*((ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*tm[0] - (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*tm[1]);
<a name="l08307"></a>08307             <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>(o++, m) = s*((ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*tm[0] - (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*tm[2]);
<a name="l08308"></a>08308          }
<a name="l08309"></a>08309       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08310"></a>08310       {
<a name="l08311"></a>08311          <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>(o++, m) =
<a name="l08312"></a>08312             <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(pm1-k)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)*((ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*tm[1] - (ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*tm[2]);
<a name="l08313"></a>08313       }
<a name="l08314"></a>08314    }
<a name="l08315"></a>08315 
<a name="l08316"></a>08316    <a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l08317"></a>08317    <span class="comment">// cout &lt;&lt; &quot;ND_TetrahedronElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l08318"></a>08318 }
<a name="l08319"></a>08319 
<a name="l08320"></a><a class="code" href="classND__TetrahedronElement.html#a2e5c5e500792c3af7da5e1e34b7af81e">08320</a> <span class="keywordtype">void</span> <a class="code" href="classND__TetrahedronElement.html#a2e5c5e500792c3af7da5e1e34b7af81e">ND_TetrahedronElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08321"></a>08321                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l08322"></a>08322 <span class="keyword"></span>{
<a name="l08323"></a>08323    <span class="keyword">const</span> <span class="keywordtype">int</span> pm1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l08324"></a>08324 
<a name="l08325"></a>08325 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l08326"></a>08326 <span class="preprocessor"></span>   <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l08327"></a>08327    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(p), <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(p), <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(p), <a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(p);
<a name="l08328"></a>08328    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l08329"></a>08329 <span class="preprocessor">#endif</span>
<a name="l08330"></a>08330 <span class="preprocessor"></span>
<a name="l08331"></a>08331    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>);
<a name="l08332"></a>08332    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>);
<a name="l08333"></a>08333    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>);
<a name="l08334"></a>08334    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l);
<a name="l08335"></a>08335 
<a name="l08336"></a>08336    <span class="keywordtype">int</span> n = 0;
<a name="l08337"></a>08337    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08338"></a>08338       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm1; j++)
<a name="l08339"></a>08339          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= pm1; i++)
<a name="l08340"></a>08340          {
<a name="l08341"></a>08341             <span class="keywordtype">double</span> s = <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)*<a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(pm1-i-j-k);
<a name="l08342"></a>08342             <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) =  s;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = 0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = 0.;  n++;
<a name="l08343"></a>08343             <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = 0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) =  s;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = 0.;  n++;
<a name="l08344"></a>08344             <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = 0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = 0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) =  s;  n++;
<a name="l08345"></a>08345          }
<a name="l08346"></a>08346    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08347"></a>08347       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm1; j++)
<a name="l08348"></a>08348       {
<a name="l08349"></a>08349          <span class="keywordtype">double</span> s = <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(pm1-j-k)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k);
<a name="l08350"></a>08350          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = s*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = -s*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) =  0.;  n++;
<a name="l08351"></a>08351          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = s*(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) =  0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = -s*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);  n++;
<a name="l08352"></a>08352       }
<a name="l08353"></a>08353    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08354"></a>08354    {
<a name="l08355"></a>08355       <span class="keywordtype">double</span> s = <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(pm1-k)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k);
<a name="l08356"></a>08356       <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = 0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = s*(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = -s*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);  n++;
<a name="l08357"></a>08357    }
<a name="l08358"></a>08358 
<a name="l08359"></a>08359    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>, u, shape);
<a name="l08360"></a>08360 }
<a name="l08361"></a>08361 
<a name="l08362"></a><a class="code" href="classND__TetrahedronElement.html#a43afbe9f93b0157f2493157d118a8a7c">08362</a> <span class="keywordtype">void</span> <a class="code" href="classND__TetrahedronElement.html#a43afbe9f93b0157f2493157d118a8a7c">ND_TetrahedronElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08363"></a>08363                                           <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"> const</span>
<a name="l08364"></a>08364 <span class="keyword"></span>{
<a name="l08365"></a>08365    <span class="keyword">const</span> <span class="keywordtype">int</span> pm1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l08366"></a>08366 
<a name="l08367"></a>08367 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l08368"></a>08368 <span class="preprocessor"></span>   <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l08369"></a>08369    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(p), <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(p), <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(p), <a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(p);
<a name="l08370"></a>08370    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__TetrahedronElement.html#af9a09b6da49b3f17a7c6e6096f8a302f">dshape_x</a>(p), <a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>(p), <a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>(p), <a class="code" href="classND__TetrahedronElement.html#afac324079afd06b0037186590dd66d18">dshape_l</a>(p);
<a name="l08371"></a>08371    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l08372"></a>08372 <span class="preprocessor">#endif</span>
<a name="l08373"></a>08373 <span class="preprocessor"></span>
<a name="l08374"></a>08374    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>, <a class="code" href="classND__TetrahedronElement.html#af9a09b6da49b3f17a7c6e6096f8a302f">dshape_x</a>);
<a name="l08375"></a>08375    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>, <a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>);
<a name="l08376"></a>08376    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>, <a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>);
<a name="l08377"></a>08377    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>, shape_l, dshape_l);
<a name="l08378"></a>08378 
<a name="l08379"></a>08379    <span class="keywordtype">int</span> n = 0;
<a name="l08380"></a>08380    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08381"></a>08381       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm1; j++)
<a name="l08382"></a>08382          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j + k &lt;= pm1; i++)
<a name="l08383"></a>08383          {
<a name="l08384"></a>08384             <span class="keywordtype">int</span> l = pm1-i-j-k;
<a name="l08385"></a>08385             <span class="keyword">const</span> <span class="keywordtype">double</span> dx = (<a class="code" href="classND__TetrahedronElement.html#af9a09b6da49b3f17a7c6e6096f8a302f">dshape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(l) -
<a name="l08386"></a>08386                                <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#afac324079afd06b0037186590dd66d18">dshape_l</a>(l))*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k);
<a name="l08387"></a>08387             <span class="keyword">const</span> <span class="keywordtype">double</span> dy = (<a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(l) -
<a name="l08388"></a>08388                                <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#afac324079afd06b0037186590dd66d18">dshape_l</a>(l))*<a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k);
<a name="l08389"></a>08389             <span class="keyword">const</span> <span class="keywordtype">double</span> dz = (<a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>(k)*<a class="code" href="classND__TetrahedronElement.html#aca9a2e3e1d9079eccaca95a36a671150">shape_l</a>(l) -
<a name="l08390"></a>08390                                <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)*<a class="code" href="classND__TetrahedronElement.html#afac324079afd06b0037186590dd66d18">dshape_l</a>(l))*<a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j);
<a name="l08391"></a>08391 
<a name="l08392"></a>08392             <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) =  0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) =  dz;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = -dy;  n++;
<a name="l08393"></a>08393             <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = -dz;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) =  0.;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) =  dx;  n++;
<a name="l08394"></a>08394             <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) =  dy;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = -dx;  <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) =  0.;  n++;
<a name="l08395"></a>08395          }
<a name="l08396"></a>08396    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08397"></a>08397       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j + k &lt;= pm1; j++)
<a name="l08398"></a>08398       {
<a name="l08399"></a>08399          <span class="keywordtype">int</span> i = pm1 - j - k;
<a name="l08400"></a>08400          <span class="comment">// s = shape_x(i)*shape_y(j)*shape_z(k);</span>
<a name="l08401"></a>08401          <span class="comment">// curl of s*(ip.y - c, -(ip.x - c), 0):</span>
<a name="l08402"></a>08402          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) =  <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>(k);
<a name="l08403"></a>08403          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) =  <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*<a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>(k);
<a name="l08404"></a>08404          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) =
<a name="l08405"></a>08405             -((<a class="code" href="classND__TetrahedronElement.html#af9a09b6da49b3f17a7c6e6096f8a302f">dshape_x</a>(i)*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>) + <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i))*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k) +
<a name="l08406"></a>08406               (<a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>(j)*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>) + <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j))*<a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k));
<a name="l08407"></a>08407          n++;
<a name="l08408"></a>08408          <span class="comment">// curl of s*(ip.z - c, 0, -(ip.x - c)):</span>
<a name="l08409"></a>08409          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = -<a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>)*<a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k);
<a name="l08410"></a>08410          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = (<a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*(<a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>(k)*(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>) + <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)) +
<a name="l08411"></a>08411                    (<a class="code" href="classND__TetrahedronElement.html#af9a09b6da49b3f17a7c6e6096f8a302f">dshape_x</a>(i)*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>) + <a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i))*<a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k));
<a name="l08412"></a>08412          <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = -<a class="code" href="classND__TetrahedronElement.html#a6e75845006c5ab091167dd3509bcc229">shape_x</a>(i)*<a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>(j)*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)*(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>);
<a name="l08413"></a>08413          n++;
<a name="l08414"></a>08414       }
<a name="l08415"></a>08415    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt;= pm1; k++)
<a name="l08416"></a>08416    {
<a name="l08417"></a>08417       <span class="keywordtype">int</span> j = pm1 - k;
<a name="l08418"></a>08418       <span class="comment">// curl of shape_y(j)*shape_z(k)*(0, ip.z - c, -(ip.y - c)):</span>
<a name="l08419"></a>08419       <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,0) = -((<a class="code" href="classND__TetrahedronElement.html#adb3e7fff8362fe3cb4279bdd6e1cf996">dshape_y</a>(j)*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>) + <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j))*<a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k) +
<a name="l08420"></a>08420                  <a class="code" href="classND__TetrahedronElement.html#a013abb831a3d29ba98b3069208ec6e4b">shape_y</a>(j)*(<a class="code" href="classND__TetrahedronElement.html#ac337f1c7abdc7b19b91f2c2dd0ac7652">dshape_z</a>(k)*(ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a> - <a class="code" href="classND__TetrahedronElement.html#a5f54e1b43742920f0124572ef60248ff">c</a>) + <a class="code" href="classND__TetrahedronElement.html#a5e994b0b678861ebd1de4a989d91480d">shape_z</a>(k)));
<a name="l08421"></a>08421       <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,1) = 0.;
<a name="l08422"></a>08422       <a class="code" href="classND__TetrahedronElement.html#aa3f314852015a98d68fd4d7851553099">u</a>(n,2) = 0.;  n++;
<a name="l08423"></a>08423    }
<a name="l08424"></a>08424 
<a name="l08425"></a>08425    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classND__TetrahedronElement.html#aceaab8f3d517af790e298c29b7c75c46">T</a>, u, curl_shape);
<a name="l08426"></a>08426 }
<a name="l08427"></a>08427 
<a name="l08428"></a>08428 
<a name="l08429"></a>08429 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classND__TriangleElement.html#a6f76cf641b874fa7a7ffc3fed6c0b53d">ND_TriangleElement::tk</a>[8] =
<a name="l08430"></a>08430 { 1.,0.,  -1.,1.,  0.,-1.,  0.,1. };
<a name="l08431"></a>08431 
<a name="l08432"></a>08432 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="classND__TriangleElement.html#a9d3786877ba046fa191a79a0a4e7a884">ND_TriangleElement::c</a> = 1./3.;
<a name="l08433"></a>08433 
<a name="l08434"></a><a class="code" href="classND__TriangleElement.html#a990522903a0c42d74f7ec20b29967150">08434</a> <a class="code" href="classND__TriangleElement.html#a990522903a0c42d74f7ec20b29967150">ND_TriangleElement::ND_TriangleElement</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> p)
<a name="l08435"></a>08435    : <a class="code" href="classVectorFiniteElement.html">VectorFiniteElement</a>(2, <a class="code" href="classGeometry.html">Geometry</a>::TRIANGLE, p*(p + 2), p,
<a name="l08436"></a>08436                          <a class="code" href="classFunctionSpace.html" title="Describes the space on each element.">FunctionSpace</a>::Pk), dof2tk(Dof), T(Dof)
<a name="l08437"></a>08437 {
<a name="l08438"></a>08438    <span class="keyword">const</span> <span class="keywordtype">double</span> *eop = poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 1);
<a name="l08439"></a>08439    <span class="keyword">const</span> <span class="keywordtype">double</span> *iop = (p &gt; 1) ? poly1d.<a class="code" href="classPoly__1D.html#a45d04be293fc2f77b4447e00dc8c9b93">OpenPoints</a>(p - 2) : NULL;
<a name="l08440"></a>08440 
<a name="l08441"></a>08441    <span class="keyword">const</span> <span class="keywordtype">int</span> pm1 = p - 1, pm2 = p - 2;
<a name="l08442"></a>08442 
<a name="l08443"></a>08443 <span class="preprocessor">#ifndef MFEM_USE_OPENMP</span>
<a name="l08444"></a>08444 <span class="preprocessor"></span>   <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08445"></a>08445    <a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08446"></a>08446    <a class="code" href="classND__TriangleElement.html#ad87efc66be6c6558f7306acd1642fc1a">shape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08447"></a>08447    <a class="code" href="classND__TriangleElement.html#a8719245d6417bbccbef0437b713887d2">dshape_x</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08448"></a>08448    <a class="code" href="classND__TriangleElement.html#a273ee36ba6b4f7b5d7c4b7da9ad57bbb">dshape_y</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08449"></a>08449    <a class="code" href="classND__TriangleElement.html#a91df63493a1eb78d70185a3ebb8c3f99">dshape_l</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(p);
<a name="l08450"></a>08450    <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l08451"></a>08451 <span class="preprocessor">#else</span>
<a name="l08452"></a>08452 <span class="preprocessor"></span>   <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>(p), <a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>(p), <a class="code" href="classND__TriangleElement.html#ad87efc66be6c6558f7306acd1642fc1a">shape_l</a>(p);
<a name="l08453"></a>08453 <span class="preprocessor">#endif</span>
<a name="l08454"></a>08454 <span class="preprocessor"></span>
<a name="l08455"></a>08455    <span class="keywordtype">int</span> n = 0;
<a name="l08456"></a>08456    <span class="comment">// edges</span>
<a name="l08457"></a>08457    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (0,1)</span>
<a name="l08458"></a>08458    {
<a name="l08459"></a>08459       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(eop[i], 0.);
<a name="l08460"></a>08460       <a class="code" href="classND__TriangleElement.html#a06a8fd8b8609dfe0444b9a6d7745e493">dof2tk</a>[n++] = 0;
<a name="l08461"></a>08461    }
<a name="l08462"></a>08462    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (1,2)</span>
<a name="l08463"></a>08463    {
<a name="l08464"></a>08464       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(eop[pm1-i], eop[i]);
<a name="l08465"></a>08465       <a class="code" href="classND__TriangleElement.html#a06a8fd8b8609dfe0444b9a6d7745e493">dof2tk</a>[n++] = 1;
<a name="l08466"></a>08466    }
<a name="l08467"></a>08467    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; p; i++) <span class="comment">// (2,0)</span>
<a name="l08468"></a>08468    {
<a name="l08469"></a>08469       <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(0., eop[pm1-i]);
<a name="l08470"></a>08470       <a class="code" href="classND__TriangleElement.html#a06a8fd8b8609dfe0444b9a6d7745e493">dof2tk</a>[n++] = 2;
<a name="l08471"></a>08471    }
<a name="l08472"></a>08472 
<a name="l08473"></a>08473    <span class="comment">// interior</span>
<a name="l08474"></a>08474    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm2; j++)
<a name="l08475"></a>08475       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm2; i++)
<a name="l08476"></a>08476       {
<a name="l08477"></a>08477          <span class="keywordtype">double</span> w = iop[i] + iop[j] + iop[pm2-i-j];
<a name="l08478"></a>08478          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(iop[i]/w, iop[j]/w);
<a name="l08479"></a>08479          <a class="code" href="classND__TriangleElement.html#a06a8fd8b8609dfe0444b9a6d7745e493">dof2tk</a>[n++] = 0;
<a name="l08480"></a>08480          <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(n).<a class="code" href="classIntegrationPoint.html#a02f76672eea0fa252a5e5c6bba35d59f">Set2</a>(iop[i]/w, iop[j]/w);
<a name="l08481"></a>08481          <a class="code" href="classND__TriangleElement.html#a06a8fd8b8609dfe0444b9a6d7745e493">dof2tk</a>[n++] = 3;
<a name="l08482"></a>08482       }
<a name="l08483"></a>08483 
<a name="l08484"></a>08484    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m = 0; m &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; m++)
<a name="l08485"></a>08485    {
<a name="l08486"></a>08486       <span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip = <a class="code" href="classFiniteElement.html#a2cbf81de55862fc3711b851c63850a21">Nodes</a>.<a class="code" href="classIntegrationRule.html#a30f5b6a5c2f58a412680d277ba4ed189" title="Returns a reference to the i-th integration point.">IntPoint</a>(m);
<a name="l08487"></a>08487       <span class="keyword">const</span> <span class="keywordtype">double</span> *tm = <a class="code" href="classND__TriangleElement.html#a6f76cf641b874fa7a7ffc3fed6c0b53d">tk</a> + 2*<a class="code" href="classND__TriangleElement.html#a06a8fd8b8609dfe0444b9a6d7745e493">dof2tk</a>[m];
<a name="l08488"></a>08488       n = 0;
<a name="l08489"></a>08489 
<a name="l08490"></a>08490       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>);
<a name="l08491"></a>08491       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>);
<a name="l08492"></a>08492       poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l);
<a name="l08493"></a>08493 
<a name="l08494"></a>08494       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm1; j++)
<a name="l08495"></a>08495          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm1; i++)
<a name="l08496"></a>08496          {
<a name="l08497"></a>08497             <span class="keywordtype">double</span> s = <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>(i)*<a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>(j)*<a class="code" href="classND__TriangleElement.html#ad87efc66be6c6558f7306acd1642fc1a">shape_l</a>(pm1-i-j);
<a name="l08498"></a>08498             <a class="code" href="classND__TriangleElement.html#a01805b7b362e9c9e8f7ef7ed7b70b4d4">T</a>(n++, m) = s * tm[0];
<a name="l08499"></a>08499             <a class="code" href="classND__TriangleElement.html#a01805b7b362e9c9e8f7ef7ed7b70b4d4">T</a>(n++, m) = s * tm[1];
<a name="l08500"></a>08500          }
<a name="l08501"></a>08501       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm1; j++)
<a name="l08502"></a>08502       {
<a name="l08503"></a>08503          <a class="code" href="classND__TriangleElement.html#a01805b7b362e9c9e8f7ef7ed7b70b4d4">T</a>(n++ ,m) =
<a name="l08504"></a>08504             <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>(pm1-j)*<a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>(j)*((ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TriangleElement.html#a9d3786877ba046fa191a79a0a4e7a884">c</a>)*tm[0] - (ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TriangleElement.html#a9d3786877ba046fa191a79a0a4e7a884">c</a>)*tm[1]);
<a name="l08505"></a>08505       }
<a name="l08506"></a>08506    }
<a name="l08507"></a>08507 
<a name="l08508"></a>08508    <a class="code" href="classND__TriangleElement.html#a01805b7b362e9c9e8f7ef7ed7b70b4d4">T</a>.<a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();
<a name="l08509"></a>08509    <span class="comment">// cout &lt;&lt; &quot;ND_TriangleElement(&quot; &lt;&lt; p &lt;&lt; &quot;) : &quot;; T.TestInversion();</span>
<a name="l08510"></a>08510 }
<a name="l08511"></a>08511 
<a name="l08512"></a><a class="code" href="classND__TriangleElement.html#a300e90ae0faf64d9de4ad34bb9c452b8">08512</a> <span class="keywordtype">void</span> <a class="code" href="classND__TriangleElement.html#a300e90ae0faf64d9de4ad34bb9c452b8">ND_TriangleElement::CalcVShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08513"></a>08513                                     <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;shape)<span class="keyword"> const</span>
<a name="l08514"></a>08514 <span class="keyword"></span>{
<a name="l08515"></a>08515    <span class="keyword">const</span> <span class="keywordtype">int</span> pm1 = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a> - 1;
<a name="l08516"></a>08516 
<a name="l08517"></a>08517 <span class="preprocessor">#ifdef MFEM_USE_OPENMP</span>
<a name="l08518"></a>08518 <span class="preprocessor"></span>   <span class="keyword">const</span> <span class="keywordtype">int</span> p = <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>;
<a name="l08519"></a>08519    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>(p), <a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>(p), <a class="code" href="classND__TriangleElement.html#ad87efc66be6c6558f7306acd1642fc1a">shape_l</a>(p);
<a name="l08520"></a>08520    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(<a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>, <a class="code" href="classFiniteElement.html#a8ca84b45b7be22af365d4980c8f99a04">Dim</a>);
<a name="l08521"></a>08521 <span class="preprocessor">#endif</span>
<a name="l08522"></a>08522 <span class="preprocessor"></span>
<a name="l08523"></a>08523    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>, <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>);
<a name="l08524"></a>08524    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, <a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>);
<a name="l08525"></a>08525    poly1d.<a class="code" href="classPoly__1D.html#a4d463e926455f7ae28fe908b9e7f5278">CalcBasis</a>(pm1, 1. - ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>, shape_l);
<a name="l08526"></a>08526 
<a name="l08527"></a>08527    <span class="keywordtype">int</span> n = 0;
<a name="l08528"></a>08528    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm1; j++)
<a name="l08529"></a>08529       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i + j &lt;= pm1; i++)
<a name="l08530"></a>08530       {
<a name="l08531"></a>08531          <span class="keywordtype">double</span> s = <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>(i)*<a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>(j)*<a class="code" href="classND__TriangleElement.html#ad87efc66be6c6558f7306acd1642fc1a">shape_l</a>(pm1-i-j);
<a name="l08532"></a>08532          <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(n,0) =  s;  <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(n,1) = 0.;  n++;
<a name="l08533"></a>08533          <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(n,0) = 0.;  <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(n,1) =  s;  n++;
<a name="l08534"></a>08534       }
<a name="l08535"></a>08535    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= pm1; j++)
<a name="l08536"></a>08536    {
<a name="l08537"></a>08537       <span class="keywordtype">double</span> s = <a class="code" href="classND__TriangleElement.html#a4b6ea5388bfdf39290a90eccecf1dcd1">shape_x</a>(pm1-j)*<a class="code" href="classND__TriangleElement.html#a012803afb0a70e3aa16587e5d8ada9e3">shape_y</a>(j);
<a name="l08538"></a>08538       <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(n,0) =  s*(ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a> - <a class="code" href="classND__TriangleElement.html#a9d3786877ba046fa191a79a0a4e7a884">c</a>);
<a name="l08539"></a>08539       <a class="code" href="classND__TriangleElement.html#a08aa09d3dcf1b621f3d1d3b9f0e4d1a6">u</a>(n,1) = -s*(ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a> - <a class="code" href="classND__TriangleElement.html#a9d3786877ba046fa191a79a0a4e7a884">c</a>);
<a name="l08540"></a>08540    }
<a name="l08541"></a>08541 
<a name="l08542"></a>08542    <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<a class="code" href="classND__TriangleElement.html#a01805b7b362e9c9e8f7ef7ed7b70b4d4">T</a>, u, shape);
<a name="l08543"></a>08543 }
<a name="l08544"></a>08544 
<a name="l08545"></a><a class="code" href="classND__TriangleElement.html#a9f1ced59e197e97823b91d5ff2aab609">08545</a> <span class="keywordtype">void</span> <a class="code" href="classND__TriangleElement.html#a9f1ced59e197e97823b91d5ff2aab609">ND_TriangleElement::CalcCurlShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08546"></a>08546                                        <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl_shape)<span class="keyword"> const</span>
<a name="l08547"></a>08547 <span class="keyword"></span>{
<a name="l08548"></a>08548    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;ND_TriangleElement::CalcCurlShape&quot;</span>);
<a name="l08549"></a>08549 }
<a name="l08550"></a>08550 
<a name="l08551"></a>08551 
<a name="l08552"></a><a class="code" href="classNURBS1DFiniteElement.html#a7df0ff37357dc8d56c7f479f8f02a4e3">08552</a> <span class="keywordtype">void</span> <a class="code" href="classNURBS1DFiniteElement.html#a7df0ff37357dc8d56c7f479f8f02a4e3">NURBS1DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08553"></a>08553                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l08554"></a>08554 <span class="keyword"></span>{
<a name="l08555"></a>08555    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcShape(shape, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08556"></a>08556 
<a name="l08557"></a>08557    <span class="keywordtype">double</span> sum = 0.0;
<a name="l08558"></a>08558    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; i++)
<a name="l08559"></a>08559       sum += (shape(i) *= <a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(i));
<a name="l08560"></a>08560 
<a name="l08561"></a>08561    shape /= sum;
<a name="l08562"></a>08562 }
<a name="l08563"></a>08563 
<a name="l08564"></a><a class="code" href="classNURBS1DFiniteElement.html#a6c4f72bce7813401351765075717b857">08564</a> <span class="keywordtype">void</span> <a class="code" href="classNURBS1DFiniteElement.html#a6c4f72bce7813401351765075717b857">NURBS1DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08565"></a>08565                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l08566"></a>08566 <span class="keyword"></span>{
<a name="l08567"></a>08567    <a class="code" href="classVector.html" title="Vector data type.">Vector</a> grad(dshape.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>);
<a name="l08568"></a>08568 
<a name="l08569"></a>08569    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcShape (<a class="code" href="classNURBS1DFiniteElement.html#a08821a77ec8c426474b506a5a54aba55">shape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08570"></a>08570    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcDShape(grad,    <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08571"></a>08571 
<a name="l08572"></a>08572    <span class="keywordtype">double</span> sum = 0.0, dsum = 0.0;
<a name="l08573"></a>08573    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; i++)
<a name="l08574"></a>08574    {
<a name="l08575"></a>08575       sum  += (<a class="code" href="classNURBS1DFiniteElement.html#a08821a77ec8c426474b506a5a54aba55">shape_x</a>(i) *= <a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(i));
<a name="l08576"></a>08576       dsum += (   grad(i) *= <a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(i));
<a name="l08577"></a>08577    }
<a name="l08578"></a>08578 
<a name="l08579"></a>08579    sum = 1.0/sum;
<a name="l08580"></a>08580    <a class="code" href="vector_8cpp.html#afab8821f67b068fd29c8dee586a16020">add</a>(sum, grad, -dsum*sum*sum, <a class="code" href="classNURBS1DFiniteElement.html#a08821a77ec8c426474b506a5a54aba55">shape_x</a>, grad);
<a name="l08581"></a>08581 }
<a name="l08582"></a>08582 
<a name="l08583"></a><a class="code" href="classNURBS2DFiniteElement.html#a1c75527fab28baff04cd9b58ad2e471a">08583</a> <span class="keywordtype">void</span> <a class="code" href="classNURBS2DFiniteElement.html#a1c75527fab28baff04cd9b58ad2e471a">NURBS2DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08584"></a>08584                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l08585"></a>08585 <span class="keyword"></span>{
<a name="l08586"></a>08586    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcShape(<a class="code" href="classNURBS2DFiniteElement.html#a8184b2b7cbd8dce0d42407a74b30c51f">shape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08587"></a>08587    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[1]-&gt;CalcShape(<a class="code" href="classNURBS2DFiniteElement.html#a07c727e916c440165a2246d782c8ddc2">shape_y</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[1], ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l08588"></a>08588 
<a name="l08589"></a>08589    <span class="keywordtype">double</span> sum = 0.0;
<a name="l08590"></a>08590    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; j++)
<a name="l08591"></a>08591    {
<a name="l08592"></a>08592       <span class="keyword">const</span> <span class="keywordtype">double</span> sy = <a class="code" href="classNURBS2DFiniteElement.html#a07c727e916c440165a2246d782c8ddc2">shape_y</a>(j);
<a name="l08593"></a>08593       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; i++, o++)
<a name="l08594"></a>08594       {
<a name="l08595"></a>08595          sum += ( shape(o) = <a class="code" href="classNURBS2DFiniteElement.html#a8184b2b7cbd8dce0d42407a74b30c51f">shape_x</a>(i)*sy*<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08596"></a>08596       }
<a name="l08597"></a>08597    }
<a name="l08598"></a>08598 
<a name="l08599"></a>08599    shape /= sum;
<a name="l08600"></a>08600 }
<a name="l08601"></a>08601 
<a name="l08602"></a><a class="code" href="classNURBS2DFiniteElement.html#a975ec1aea954770985b05c0374946a90">08602</a> <span class="keywordtype">void</span> <a class="code" href="classNURBS2DFiniteElement.html#a975ec1aea954770985b05c0374946a90">NURBS2DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08603"></a>08603                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l08604"></a>08604 <span class="keyword"></span>{
<a name="l08605"></a>08605    <span class="keywordtype">double</span> sum, dsum[2];
<a name="l08606"></a>08606 
<a name="l08607"></a>08607    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcShape ( <a class="code" href="classNURBS2DFiniteElement.html#a8184b2b7cbd8dce0d42407a74b30c51f">shape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08608"></a>08608    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[1]-&gt;CalcShape ( <a class="code" href="classNURBS2DFiniteElement.html#a07c727e916c440165a2246d782c8ddc2">shape_y</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[1], ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l08609"></a>08609 
<a name="l08610"></a>08610    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcDShape(<a class="code" href="classNURBS2DFiniteElement.html#a1bc612165e7c3db2059a8eb5eb2133c2">dshape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08611"></a>08611    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[1]-&gt;CalcDShape(<a class="code" href="classNURBS2DFiniteElement.html#a9f7f0efb7a6c72c8aafee88e9f523f2f">dshape_y</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[1], ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l08612"></a>08612 
<a name="l08613"></a>08613    sum = dsum[0] = dsum[1] = 0.0;
<a name="l08614"></a>08614    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, j = 0; j &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; j++)
<a name="l08615"></a>08615    {
<a name="l08616"></a>08616       <span class="keyword">const</span> <span class="keywordtype">double</span> sy = <a class="code" href="classNURBS2DFiniteElement.html#a07c727e916c440165a2246d782c8ddc2">shape_y</a>(j), dsy = <a class="code" href="classNURBS2DFiniteElement.html#a9f7f0efb7a6c72c8aafee88e9f523f2f">dshape_y</a>(j);
<a name="l08617"></a>08617       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; i++, o++)
<a name="l08618"></a>08618       {
<a name="l08619"></a>08619          sum += ( <a class="code" href="classNURBS2DFiniteElement.html#a430770b840cd9def63931f260043e9f2">u</a>(o) = <a class="code" href="classNURBS2DFiniteElement.html#a8184b2b7cbd8dce0d42407a74b30c51f">shape_x</a>(i)*sy*<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08620"></a>08620 
<a name="l08621"></a>08621          dsum[0] += ( dshape(o,0) = <a class="code" href="classNURBS2DFiniteElement.html#a1bc612165e7c3db2059a8eb5eb2133c2">dshape_x</a>(i)*sy *<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08622"></a>08622          dsum[1] += ( dshape(o,1) =  <a class="code" href="classNURBS2DFiniteElement.html#a8184b2b7cbd8dce0d42407a74b30c51f">shape_x</a>(i)*dsy*<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08623"></a>08623       }
<a name="l08624"></a>08624    }
<a name="l08625"></a>08625 
<a name="l08626"></a>08626    sum = 1.0/sum;
<a name="l08627"></a>08627    dsum[0] *= sum*sum;
<a name="l08628"></a>08628    dsum[1] *= sum*sum;
<a name="l08629"></a>08629 
<a name="l08630"></a>08630    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0; o &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; o++)
<a name="l08631"></a>08631    {
<a name="l08632"></a>08632       dshape(o,0) = dshape(o,0)*sum - <a class="code" href="classNURBS2DFiniteElement.html#a430770b840cd9def63931f260043e9f2">u</a>(o)*dsum[0];
<a name="l08633"></a>08633       dshape(o,1) = dshape(o,1)*sum - <a class="code" href="classNURBS2DFiniteElement.html#a430770b840cd9def63931f260043e9f2">u</a>(o)*dsum[1];
<a name="l08634"></a>08634    }
<a name="l08635"></a>08635 }
<a name="l08636"></a>08636 
<a name="l08637"></a><a class="code" href="classNURBS3DFiniteElement.html#a58ec0098b9c1c0ee64ba688440a3a8b4">08637</a> <span class="keywordtype">void</span> <a class="code" href="classNURBS3DFiniteElement.html#a58ec0098b9c1c0ee64ba688440a3a8b4">NURBS3DFiniteElement::CalcShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08638"></a>08638                                      <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;shape)<span class="keyword"> const</span>
<a name="l08639"></a>08639 <span class="keyword"></span>{
<a name="l08640"></a>08640    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcShape(<a class="code" href="classNURBS3DFiniteElement.html#af97ac3c11ae13c9b0069990d6cd425a9">shape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08641"></a>08641    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[1]-&gt;CalcShape(<a class="code" href="classNURBS3DFiniteElement.html#ad12b761c27fd27975cb7449f27a58ef7">shape_y</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[1], ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l08642"></a>08642    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[2]-&gt;CalcShape(<a class="code" href="classNURBS3DFiniteElement.html#ad8df91dc1513f90e27b30685395f6af8">shape_z</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[2], ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>);
<a name="l08643"></a>08643 
<a name="l08644"></a>08644    <span class="keywordtype">double</span> sum = 0.0;
<a name="l08645"></a>08645    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; k++)
<a name="l08646"></a>08646    {
<a name="l08647"></a>08647       <span class="keyword">const</span> <span class="keywordtype">double</span> sz = <a class="code" href="classNURBS3DFiniteElement.html#ad8df91dc1513f90e27b30685395f6af8">shape_z</a>(k);
<a name="l08648"></a>08648       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; j++)
<a name="l08649"></a>08649       {
<a name="l08650"></a>08650          <span class="keyword">const</span> <span class="keywordtype">double</span> sy_sz = <a class="code" href="classNURBS3DFiniteElement.html#ad12b761c27fd27975cb7449f27a58ef7">shape_y</a>(j)*sz;
<a name="l08651"></a>08651          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; i++, o++)
<a name="l08652"></a>08652          {
<a name="l08653"></a>08653             sum += ( shape(o) = <a class="code" href="classNURBS3DFiniteElement.html#af97ac3c11ae13c9b0069990d6cd425a9">shape_x</a>(i)*sy_sz*<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08654"></a>08654          }
<a name="l08655"></a>08655       }
<a name="l08656"></a>08656    }
<a name="l08657"></a>08657 
<a name="l08658"></a>08658    shape /= sum;
<a name="l08659"></a>08659 }
<a name="l08660"></a>08660 
<a name="l08661"></a><a class="code" href="classNURBS3DFiniteElement.html#a2afbfb51590c29027b6dfd592fc30e1e">08661</a> <span class="keywordtype">void</span> <a class="code" href="classNURBS3DFiniteElement.html#a2afbfb51590c29027b6dfd592fc30e1e">NURBS3DFiniteElement::CalcDShape</a>(<span class="keyword">const</span> <a class="code" href="classIntegrationPoint.html" title="Class for integration point with weight.">IntegrationPoint</a> &amp;ip,
<a name="l08662"></a>08662                                       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;dshape)<span class="keyword"> const</span>
<a name="l08663"></a>08663 <span class="keyword"></span>{
<a name="l08664"></a>08664    <span class="keywordtype">double</span> sum, dsum[3];
<a name="l08665"></a>08665 
<a name="l08666"></a>08666    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcShape ( <a class="code" href="classNURBS3DFiniteElement.html#af97ac3c11ae13c9b0069990d6cd425a9">shape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08667"></a>08667    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[1]-&gt;CalcShape ( <a class="code" href="classNURBS3DFiniteElement.html#ad12b761c27fd27975cb7449f27a58ef7">shape_y</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[1], ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l08668"></a>08668    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[2]-&gt;CalcShape ( <a class="code" href="classNURBS3DFiniteElement.html#ad8df91dc1513f90e27b30685395f6af8">shape_z</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[2], ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>);
<a name="l08669"></a>08669 
<a name="l08670"></a>08670    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[0]-&gt;CalcDShape(<a class="code" href="classNURBS3DFiniteElement.html#a9094474a8d39981c1c8a5b7810f14eb5">dshape_x</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[0], ip.<a class="code" href="classIntegrationPoint.html#a18776fbe007079616fd72dd8cca6461c">x</a>);
<a name="l08671"></a>08671    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[1]-&gt;CalcDShape(<a class="code" href="classNURBS3DFiniteElement.html#a6d88d4c248f523421e7dd1c151f9fcd4">dshape_y</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[1], ip.<a class="code" href="classIntegrationPoint.html#a1f856959524a97f669cc2efa1c95e168">y</a>);
<a name="l08672"></a>08672    <a class="code" href="classNURBSFiniteElement.html#a9a0ccb3480e346ede7004dc28cf3b866">kv</a>[2]-&gt;CalcDShape(<a class="code" href="classNURBS3DFiniteElement.html#a6455f6c9e8d77e49fbb14c06ce99b12b">dshape_z</a>, <a class="code" href="classNURBSFiniteElement.html#acd8777718d00e579f88a2754db952ee0">ijk</a>[2], ip.<a class="code" href="classIntegrationPoint.html#ab8083dabffac637359e2a0918d9140b5">z</a>);
<a name="l08673"></a>08673 
<a name="l08674"></a>08674    sum = dsum[0] = dsum[1] = dsum[2] = 0.0;
<a name="l08675"></a>08675    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0, k = 0; k &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; k++)
<a name="l08676"></a>08676    {
<a name="l08677"></a>08677       <span class="keyword">const</span> <span class="keywordtype">double</span> sz = <a class="code" href="classNURBS3DFiniteElement.html#ad8df91dc1513f90e27b30685395f6af8">shape_z</a>(k), dsz = <a class="code" href="classNURBS3DFiniteElement.html#a6455f6c9e8d77e49fbb14c06ce99b12b">dshape_z</a>(k);
<a name="l08678"></a>08678       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; j++)
<a name="l08679"></a>08679       {
<a name="l08680"></a>08680          <span class="keyword">const</span> <span class="keywordtype">double</span>  sy_sz  =  <a class="code" href="classNURBS3DFiniteElement.html#ad12b761c27fd27975cb7449f27a58ef7">shape_y</a>(j)* sz;
<a name="l08681"></a>08681          <span class="keyword">const</span> <span class="keywordtype">double</span> dsy_sz  = <a class="code" href="classNURBS3DFiniteElement.html#a6d88d4c248f523421e7dd1c151f9fcd4">dshape_y</a>(j)* sz;
<a name="l08682"></a>08682          <span class="keyword">const</span> <span class="keywordtype">double</span>  sy_dsz =  <a class="code" href="classNURBS3DFiniteElement.html#ad12b761c27fd27975cb7449f27a58ef7">shape_y</a>(j)*dsz;
<a name="l08683"></a>08683          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= <a class="code" href="classFiniteElement.html#aa1fb906363bef55f42d91ecd2739b29d">Order</a>; i++, o++)
<a name="l08684"></a>08684          {
<a name="l08685"></a>08685             sum += ( <a class="code" href="classNURBS3DFiniteElement.html#a801fa28f9fabf028407f8b92615ad57f">u</a>(o) = <a class="code" href="classNURBS3DFiniteElement.html#af97ac3c11ae13c9b0069990d6cd425a9">shape_x</a>(i)*sy_sz*<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08686"></a>08686 
<a name="l08687"></a>08687             dsum[0] += ( dshape(o,0) = <a class="code" href="classNURBS3DFiniteElement.html#a9094474a8d39981c1c8a5b7810f14eb5">dshape_x</a>(i)* sy_sz *<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08688"></a>08688             dsum[1] += ( dshape(o,1) =  <a class="code" href="classNURBS3DFiniteElement.html#af97ac3c11ae13c9b0069990d6cd425a9">shape_x</a>(i)*dsy_sz *<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08689"></a>08689             dsum[2] += ( dshape(o,2) =  <a class="code" href="classNURBS3DFiniteElement.html#af97ac3c11ae13c9b0069990d6cd425a9">shape_x</a>(i)* sy_dsz*<a class="code" href="classNURBSFiniteElement.html#a48e9cde8df503cde7b6844b9b61e5c5b">weights</a>(o) );
<a name="l08690"></a>08690          }
<a name="l08691"></a>08691       }
<a name="l08692"></a>08692    }
<a name="l08693"></a>08693 
<a name="l08694"></a>08694    sum = 1.0/sum;
<a name="l08695"></a>08695    dsum[0] *= sum*sum;
<a name="l08696"></a>08696    dsum[1] *= sum*sum;
<a name="l08697"></a>08697    dsum[2] *= sum*sum;
<a name="l08698"></a>08698 
<a name="l08699"></a>08699    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> o = 0; o &lt; <a class="code" href="classFiniteElement.html#ae7c084a31f6be74f22cb54afe0dac776">Dof</a>; o++)
<a name="l08700"></a>08700    {
<a name="l08701"></a>08701       dshape(o,0) = dshape(o,0)*sum - <a class="code" href="classNURBS3DFiniteElement.html#a801fa28f9fabf028407f8b92615ad57f">u</a>(o)*dsum[0];
<a name="l08702"></a>08702       dshape(o,1) = dshape(o,1)*sum - <a class="code" href="classNURBS3DFiniteElement.html#a801fa28f9fabf028407f8b92615ad57f">u</a>(o)*dsum[1];
<a name="l08703"></a>08703       dshape(o,2) = dshape(o,2)*sum - <a class="code" href="classNURBS3DFiniteElement.html#a801fa28f9fabf028407f8b92615ad57f">u</a>(o)*dsum[2];
<a name="l08704"></a>08704    }
<a name="l08705"></a>08705 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 2 2012 16:18:17 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
