<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MFEM: mesh/pmesh.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v4.5.2</span>
   </div>
   <div id="projectbrief">Finite element discretization library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_71786b7bc69a081a150e1a2372e4c3f1.html">mesh</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">pmesh.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="pmesh_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2010-2023, Lawrence Livermore National Security, LLC. Produced</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// at the Lawrence Livermore National Laboratory. All Rights reserved. See files</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LICENSE and NOTICE for details. LLNL-CODE-806117.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the MFEM library. For more information and source code</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// availability visit https://mfem.org.</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// terms of the BSD-3 license. We welcome feedback and contributions, see file</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// CONTRIBUTING.md for details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;../config/config.hpp&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef MFEM_USE_MPI</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mesh__headers_8hpp.html">mesh_headers.hpp</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;../fem/fem.hpp&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;../general/sets.hpp&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;../general/sort_pairs.hpp&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;../general/text.hpp&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;../general/globals.hpp&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemfem.html">mfem</a></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aa945896bc16721bc9fa4aedc61b837cf">   31</a></span>&#160;ParMesh::ParMesh(<span class="keyword">const</span> <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;pmesh, <span class="keywordtype">bool</span> copy_nodes)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   : <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>(pmesh, false),</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;     group_svert(pmesh.group_svert),</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;     group_sedge(pmesh.group_sedge),</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;     group_stria(pmesh.group_stria),</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;     group_squad(pmesh.group_squad),</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;     face_nbr_el_to_face(NULL),</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;     glob_elem_offset(-1),</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;     glob_offset_sequence(-1),</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;     gtopo(pmesh.gtopo)</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a> = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a> = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   <span class="comment">// Duplicate the shared_edges</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.SetSize(pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size());</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); i++)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i] = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i]-&gt;Duplicate(<span class="keyword">this</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a> = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a> = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="comment">// Copy the shared-to-local index Arrays</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>);</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a> = pmesh.<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   <span class="comment">// Do not copy face-neighbor data (can be generated if needed)</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="comment">// If pmesh has a ParNURBSExtension, it was copied by the Mesh copy ctor, so</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   <span class="comment">// there is no need to do anything here.</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="comment">// Copy ParNCMesh, if present</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordflow">if</span> (pmesh.<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParMesh.html#a1c24b1592e32e5365209d28d121e8c6b">ParNCMesh</a>(*pmesh.<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">OnMeshUpdated</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   {</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = NULL;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">ncmesh</a> = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <span class="comment">// Copy the Nodes as a ParGridFunction, including the FiniteElementCollection</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   <span class="comment">// and the FiniteElementSpace (as a ParFiniteElementSpace)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keywordflow">if</span> (pmesh.<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> &amp;&amp; copy_nodes)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a> *fes = pmesh.<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>();</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1FiniteElementCollection.html">FiniteElementCollection</a> *fec = fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a5a44f6dac69c8a2a4c99dbd14a7eb076">FEColl</a>();</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="classmfem_1_1FiniteElementCollection.html">FiniteElementCollection</a> *fec_copy =</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;         <a class="code" href="classmfem_1_1FiniteElementCollection.html#a15fcfa553d4949eb08f9926ac74d1e80">FiniteElementCollection::New</a>(fec-&gt;<a class="code" href="classmfem_1_1FiniteElementCollection.html#a0f812fed1793858e59a16a8a3fd8b42c">Name</a>());</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *pfes_copy =</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;         <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(*fes, *<span class="keyword">this</span>, fec_copy);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a>(pfes_copy);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a5b7454afd8d02d6a6fe8ec4754e448fe">MakeOwner</a>(fec_copy);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      *<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> = *pmesh.<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac6cf2e60dc2177744096b6d9a0eaad49">own_nodes</a> = 1;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ac931ae9fc249cb2bba6c69560bf3be1f">   96</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh::ParMesh</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;&amp;mesh) : <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a>()</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#afa55bdf445b256c57888aa9203b2bc9a">Swap</a>(mesh);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ababcaca40ea48ba9ddc56f5bf94f3f88">  101</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a>&amp; <a class="code" href="classmfem_1_1ParMesh.html#ababcaca40ea48ba9ddc56f5bf94f3f88">ParMesh::operator=</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;&amp;mesh)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;{</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#afa55bdf445b256c57888aa9203b2bc9a">Swap</a>(mesh);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a0df4bd271c941c795c854e1d92f34dcb">  107</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh::ParMesh</a>(MPI_Comm comm, <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> &amp;mesh, <span class="keywordtype">int</span> *partitioning_,</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                 <span class="keywordtype">int</span> part_method)</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   : face_nbr_el_to_face(NULL)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   , glob_elem_offset(-1)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   , glob_offset_sequence(-1)</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   , gtopo(comm)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <span class="keywordtype">int</span> *partitioning = NULL;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;bool&gt;</a> activeBdrElem;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a> = comm;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   MPI_Comm_size(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   MPI_Comm_rank(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">Nonconforming</a>())</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (partitioning_)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         partitioning = partitioning_;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">ncmesh</a> = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParMesh.html#a1c24b1592e32e5365209d28d121e8c6b">ParNCMesh</a>(comm, *mesh.<a class="code" href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">ncmesh</a>, partitioning);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (!partitioning)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      {</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;         partitioning = <span class="keyword">new</span> <span class="keywordtype">int</span>[mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>()];</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;         {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            partitioning[i] = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#afa4f16dc016e8b89ed91b137a1ba5c61">InitialPartition</a>(i);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;         }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#aa5b75211f5053327b6899f8ab4e3423b">Prune</a>();</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a4c23a825f8da99e3c2a4ed86dc27cdf0">Mesh::InitFromNCMesh</a>(*<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">OnMeshUpdated</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a81197e06ddf2eb20439cfe166a9551f8">GetConformingSharedStructures</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="comment">// SetMeshGen(); // called by Mesh::InitFromNCMesh(...) above</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> = mesh.<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>; <span class="comment">// copy the global &#39;meshgen&#39;</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      mesh.<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      mesh.<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a37b72005638c0da654315a61f7965fd7">GenerateNCFaceInfo</a>();</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <span class="keywordflow">else</span> <span class="comment">// mesh.Conforming()</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> = mesh.<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a> = mesh.<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">ncmesh</a> = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = NULL;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span> (partitioning_)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;         partitioning = partitioning_;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;         partitioning = mesh.<a class="code" href="classmfem_1_1Mesh.html#af81b83179f6169a99218b7b1f6d589e4">GeneratePartitioning</a>(<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>, part_method);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <span class="comment">// re-enumerate the partitions to better map to actual processor</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="comment">// interconnect topology !?</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vert_global_local;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> = <a class="code" href="classmfem_1_1ParMesh.html#af283451292bc574f1b8022e8dcc86152">BuildLocalVertices</a>(mesh, partitioning, vert_global_local);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> = <a class="code" href="classmfem_1_1ParMesh.html#a902ed2768f95643dc04cbc83eb60d34c">BuildLocalElements</a>(mesh, partitioning, vert_global_local);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="classmfem_1_1Table.html">Table</a> *edge_element = NULL;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> = <a class="code" href="classmfem_1_1ParMesh.html#aeb7a273faffe828dee49ae4f5e39529a">BuildLocalBoundary</a>(mesh, partitioning,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                            vert_global_local,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                            activeBdrElem, edge_element);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ad96a1f7ebda1728b3683893b16671eae">SetMeshGen</a>();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> = mesh.<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>; <span class="comment">// copy the global &#39;meshgen&#39;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      mesh.<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      mesh.<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">NumOfEdges</a> = <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a> = 0;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Table.html">Table</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">NumOfEdges</a> = <a class="code" href="classmfem_1_1Mesh.html#a4f62eb3ede00bc8dc5de42baa366cab4">Mesh::GetElementToEdgeTable</a>(*<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a>, <a class="code" href="classmfem_1_1Mesh.html#a27b274dcab25a4606c9995f5d1607ff8">be_to_edge</a>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *faces_tbl = NULL;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;         faces_tbl = <a class="code" href="classmfem_1_1Mesh.html#a81e17bd07601b5f66821dbe21ba3652c">GetElementToFaceTable</a>(1);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a4784444c57c21808869bcaed6e6bcf50">GenerateFaces</a>();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <a class="code" href="classmfem_1_1ListOfIntegerSets.html">ListOfIntegerSets</a>  groups;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         <span class="comment">// the first group is the local one</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         <a class="code" href="classmfem_1_1IntegerSet.html">IntegerSet</a> group;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         group.<a class="code" href="classmfem_1_1IntegerSet.html#a46792e0e26ddc11a27cfed8812ec04fa">Recreate</a>(1, &amp;<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;         groups.<a class="code" href="classmfem_1_1ListOfIntegerSets.html#a451e3ff20e8173bea1996c6cac58fc2b">Insert</a>(group);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      MFEM_ASSERT(mesh.<a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>() == 0 || <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> face_group(mesh.<a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>());</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <a class="code" href="classmfem_1_1Table.html">Table</a> *vert_element = mesh.<a class="code" href="classmfem_1_1Mesh.html#af438e7d1d688617959f6dbd9e37da407">GetVertexToElementTable</a>(); <span class="comment">// we must delete this</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a475c2fa7963bb755b0f5b2f21e1761b2">FindSharedFaces</a>(mesh, partitioning, face_group, groups);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordtype">int</span> nsedges = <a class="code" href="classmfem_1_1ParMesh.html#ac6d9d2955527fac5e033d20433491f82">FindSharedEdges</a>(mesh, partitioning, edge_element, groups);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      <span class="keywordtype">int</span> nsvert = <a class="code" href="classmfem_1_1ParMesh.html#ae6d58733b72f9d49584a6640d05fb235">FindSharedVertices</a>(partitioning, vert_element, groups);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="comment">// build the group communication topology</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a97facd56fccab3bdec0693e229f74e0f">Create</a>(groups, 822);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="comment">// fill out group_sface, group_sedge, group_svert</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordtype">int</span> ngroups = groups.<a class="code" href="classmfem_1_1ListOfIntegerSets.html#a3057a37fc73a5a91d44b657265da1b85">Size</a>()-1, nstris, nsquads;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a9cd80a3c556bbe144e5524944ea00109">BuildFaceGroup</a>(ngroups, mesh, face_group, nstris, nsquads);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2c3ca23eb412a895516662e1885619c5">BuildEdgeGroup</a>(ngroups, *edge_element);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a0a10d8e32dc7d3d71ac6756fe4c14ca7">BuildVertexGroup</a>(ngroups, *vert_element);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// build shared_faces and sface_lface mapping</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a3458b71b04b2fc8376dd2d41c54f79fa">BuildSharedFaceElems</a>(nstris, nsquads, mesh, partitioning, faces_tbl,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                           face_group, vert_global_local);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">delete</span> faces_tbl;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="comment">// build shared_edges and sedge_ledge mapping</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a9e07cfa2170e12ef7881376658291b40">BuildSharedEdgeElems</a>(nsedges, mesh, vert_global_local, edge_element);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keyword">delete</span> edge_element;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">// build svert_lvert mapping</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a360c3741a62e64c827d4101b69a4439f">BuildSharedVertMapping</a>(nsvert, vert_element, vert_global_local);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keyword">delete</span> vert_element;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ad96a1f7ebda1728b3683893b16671eae">SetMeshGen</a>();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> = mesh.<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>; <span class="comment">// copy the global &#39;meshgen&#39;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      MFEM_ASSERT(mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>() &amp;&amp;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                  mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;FESpace()-&gt;GetNURBSext() == mesh.<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>,</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                  <span class="stringliteral">&quot;invalid NURBS mesh&quot;</span>);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParNURBSExtension.html">ParNURBSExtension</a>(comm, mesh.<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>, partitioning,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                       activeBdrElem);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;   }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;   <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()) <span class="comment">// curved mesh</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;   {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a>(<span class="keyword">this</span>, mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>());</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a> *glob_fes = mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;FESpace();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;         <a class="code" href="classmfem_1_1FiniteElementCollection.html">FiniteElementCollection</a> *nfec =</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <a class="code" href="classmfem_1_1FiniteElementCollection.html#a15fcfa553d4949eb08f9926ac74d1e80">FiniteElementCollection::New</a>(glob_fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a5a44f6dac69c8a2a4c99dbd14a7eb076">FEColl</a>()-&gt;<a class="code" href="classmfem_1_1FiniteElementCollection.html#a0f812fed1793858e59a16a8a3fd8b42c">Name</a>());</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *pfes =</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(<span class="keyword">this</span>, nfec, glob_fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#ad27a4b8249411b018f03b3319bed9276">GetVDim</a>(),</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                      glob_fes-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6ea7e53fd19088193d6847257a7abd95">GetOrdering</a>());</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a>(pfes);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a5b7454afd8d02d6a6fe8ec4754e448fe">MakeOwner</a>(nfec); <span class="comment">// Nodes will own nfec and pfes</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac6cf2e60dc2177744096b6d9a0eaad49">own_nodes</a> = 1;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> gvdofs, lvdofs;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <a class="code" href="classmfem_1_1Vector.html">Vector</a> lnodes;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordtype">int</span> element_counter = 0;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      {</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         <span class="keywordflow">if</span> (partitioning[i] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;         {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>()-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6ac2fad2ec742d60cb17dc8d873b46aa">GetElementVDofs</a>(element_counter, lvdofs);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;FESpace()-&gt;GetElementVDofs(i, gvdofs);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            mesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;GetSubVector(gvdofs, lnodes);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1Vector.html#a9cce8215d185deab7fb54f6d727b5e51">SetSubVector</a>(lvdofs, lnodes);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            element_counter++;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="comment">// set meaningful values to &#39;vertices&#39; even though we have Nodes,</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// for compatibility (e.g., Mesh::GetVertex())</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a02c45b15e111f47cc55732d6f3bec084">SetVerticesFromNodes</a>(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   <span class="keywordflow">if</span> (partitioning != partitioning_)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keyword">delete</span> [] partitioning;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#af283451292bc574f1b8022e8dcc86152">  302</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#af283451292bc574f1b8022e8dcc86152">ParMesh::BuildLocalVertices</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">mfem::Mesh</a> &amp;mesh,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">int</span>* partitioning,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;vert_global_local)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   vert_global_local.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(mesh.<a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>());</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   vert_global_local = -1;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keywordtype">int</span> vert_counter = 0;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">if</span> (partitioning[i] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;         <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vert;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a2a373eb2c566226e38bf9804b76d003a">GetElementVertices</a>(i, vert);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; vert.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;         {</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">if</span> (vert_global_local[vert[j]] &lt; 0)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;               vert_global_local[vert[j]] = vert_counter++;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;         }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      }</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;   <span class="comment">// re-enumerate the local vertices to preserve the global ordering</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;   vert_counter = 0;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; vert_global_local.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;   {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="keywordflow">if</span> (vert_global_local[i] &gt;= 0)</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         vert_global_local[i] = vert_counter++;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;   }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.SetSize(vert_counter);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; vert_global_local.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">if</span> (vert_global_local[i] &gt;= 0)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[vert_global_local[i]].SetCoords(mesh.<a class="code" href="classmfem_1_1Mesh.html#a8b7a6459b9c4ef0bada3ef9e00dcf082">SpaceDimension</a>(),</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                                  mesh.<a class="code" href="classmfem_1_1Mesh.html#aeefcdb017ae9e14993d3e4ba21dd56e4">GetVertex</a>(i));</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   }</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;   <span class="keywordflow">return</span> vert_counter;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a902ed2768f95643dc04cbc83eb60d34c">  350</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#a902ed2768f95643dc04cbc83eb60d34c">ParMesh::BuildLocalElements</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>&amp; mesh, <span class="keyword">const</span> <span class="keywordtype">int</span>* partitioning,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; vert_global_local)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;   <span class="keywordtype">int</span> nelems = 0;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   {</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span> (partitioning[i] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>) { nelems++; }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>.SetSize(nelems);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="comment">// Determine elements, enumerating the local elements to preserve the global</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="comment">// order. This is used, e.g. by the ParGridFunction ctor that takes a global</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="comment">// GridFunction as input parameter.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;   <span class="keywordtype">int</span> element_counter = 0;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); i++)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (partitioning[i] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[element_counter] = mesh.<a class="code" href="classmfem_1_1Mesh.html#aac0ecfa0737785cb713cb30b81bdf591">GetElement</a>(i)-&gt;<a class="code" href="classmfem_1_1Element.html#a4c1e1aeaf502f4f4258dbc01fd073946">Duplicate</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[element_counter]-&gt;GetVertices();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[element_counter]-&gt;GetNVertices();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;         {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            v[j] = vert_global_local[v[j]];</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;         element_counter++;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;   }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordflow">return</span> element_counter;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aeb7a273faffe828dee49ae4f5e39529a">  383</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#aeb7a273faffe828dee49ae4f5e39529a">ParMesh::BuildLocalBoundary</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>&amp; mesh, <span class="keyword">const</span> <span class="keywordtype">int</span>* partitioning,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; vert_global_local,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                <a class="code" href="classmfem_1_1Array.html">Array&lt;bool&gt;</a>&amp; activeBdrElem,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                <a class="code" href="classmfem_1_1Table.html">Table</a>*&amp; edge_element)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   <span class="keywordtype">int</span> nbdry = 0;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      activeBdrElem.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>());</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      activeBdrElem = <span class="keyword">false</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;   <span class="comment">// build boundary elements</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>(); i++)</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;         <span class="keywordtype">int</span> face, o, el1, el2;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a0c4dd0df3a6c4d9b11343c4473f7841e">GetBdrElementFace</a>(i, &amp;face, &amp;o);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">GetFaceElements</a>(face, &amp;el1, &amp;el2);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;         <span class="keywordflow">if</span> (partitioning[(o % 2 == 0 || el2 &lt; 0) ? el1 : el2] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;         {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            nbdry++;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;               activeBdrElem[i] = <span class="keyword">true</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;         }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordtype">int</span> bdrelem_counter = 0;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.SetSize(nbdry);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>(); i++)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         <span class="keywordtype">int</span> face, o, el1, el2;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a0c4dd0df3a6c4d9b11343c4473f7841e">GetBdrElementFace</a>(i, &amp;face, &amp;o);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">GetFaceElements</a>(face, &amp;el1, &amp;el2);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;         <span class="keywordflow">if</span> (partitioning[(o % 2 == 0 || el2 &lt; 0) ? el1 : el2] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;         {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter] = mesh.<a class="code" href="classmfem_1_1Mesh.html#aec099666a5e112fda3386c40ad89bfc5">GetBdrElement</a>(i)-&gt;<a class="code" href="classmfem_1_1Element.html#a4c1e1aeaf502f4f4258dbc01fd073946">Duplicate</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter]-&gt;GetVertices();</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter]-&gt;GetNVertices();</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;               v[j] = vert_global_local[v[j]];</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            bdrelem_counter++;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;         }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   }</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      edge_element = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Table.html">Table</a>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>(mesh.<a class="code" href="classmfem_1_1Mesh.html#a221bf58bfe1baf89f6384e3b7c14f861">ElementToEdgeTable</a>(), *edge_element, mesh.<a class="code" href="classmfem_1_1Mesh.html#a09bf96bbcf2833f005406317841f19b2">GetNEdges</a>());</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>(); i++)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      {</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;         <span class="keywordtype">int</span> edge = mesh.<a class="code" href="classmfem_1_1Mesh.html#ad998076561d21d2bccf24b72302abe52">GetBdrElementEdgeIndex</a>(i);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         <span class="keywordtype">int</span> el1 = edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(edge)[0];</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         <span class="keywordflow">if</span> (partitioning[el1] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;         {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            nbdry++;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;               activeBdrElem[i] = <span class="keyword">true</span>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordtype">int</span> bdrelem_counter = 0;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.SetSize(nbdry);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>(); i++)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <span class="keywordtype">int</span> edge = mesh.<a class="code" href="classmfem_1_1Mesh.html#ad998076561d21d2bccf24b72302abe52">GetBdrElementEdgeIndex</a>(i);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         <span class="keywordtype">int</span> el1 = edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(edge)[0];</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="keywordflow">if</span> (partitioning[el1] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter] = mesh.<a class="code" href="classmfem_1_1Mesh.html#aec099666a5e112fda3386c40ad89bfc5">GetBdrElement</a>(i)-&gt;<a class="code" href="classmfem_1_1Element.html#a4c1e1aeaf502f4f4258dbc01fd073946">Duplicate</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter]-&gt;GetVertices();</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter]-&gt;GetNVertices();</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;               v[j] = vert_global_local[v[j]];</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            bdrelem_counter++;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>(); i++)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;         <span class="keywordtype">int</span> vert = mesh.<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices()[0];</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;         <span class="keywordtype">int</span> el1, el2;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">GetFaceElements</a>(vert, &amp;el1, &amp;el2);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;         <span class="keywordflow">if</span> (partitioning[el1] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;         {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            nbdry++;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;         }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">int</span> bdrelem_counter = 0;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.SetSize(nbdry);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">GetNBE</a>(); i++)</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         <span class="keywordtype">int</span> vert = mesh.<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices()[0];</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;         <span class="keywordtype">int</span> el1, el2;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">GetFaceElements</a>(vert, &amp;el1, &amp;el2);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;         <span class="keywordflow">if</span> (partitioning[el1] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;         {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter] = mesh.<a class="code" href="classmfem_1_1Mesh.html#aec099666a5e112fda3386c40ad89bfc5">GetBdrElement</a>(i)-&gt;<a class="code" href="classmfem_1_1Element.html#a4c1e1aeaf502f4f4258dbc01fd073946">Duplicate</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[bdrelem_counter]-&gt;GetVertices();</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            v[0] = vert_global_local[v[0]];</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            bdrelem_counter++;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         }</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;   <span class="keywordflow">return</span> nbdry;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a475c2fa7963bb755b0f5b2f21e1761b2">  504</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a475c2fa7963bb755b0f5b2f21e1761b2">ParMesh::FindSharedFaces</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> &amp;mesh, <span class="keyword">const</span> <span class="keywordtype">int</span> *partitioning,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                              <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;face_group,</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                              <a class="code" href="classmfem_1_1ListOfIntegerSets.html">ListOfIntegerSets</a> &amp;groups)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;{</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   <a class="code" href="classmfem_1_1IntegerSet.html">IntegerSet</a> group;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   <span class="comment">// determine shared faces</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   face_group.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(mesh.<a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>());</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; face_group.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;   {</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordtype">int</span> el[2];</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      face_group[i] = -1;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      mesh.<a class="code" href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">GetFaceElements</a>(i, &amp;el[0], &amp;el[1]);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keywordflow">if</span> (el[1] &gt;= 0)</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;         el[0] = partitioning[el[0]];</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         el[1] = partitioning[el[1]];</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;         <span class="keywordflow">if</span> ((el[0] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> &amp;&amp; el[1] != <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>) ||</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;             (el[0] != <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> &amp;&amp; el[1] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>))</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;         {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            group.<a class="code" href="classmfem_1_1IntegerSet.html#a46792e0e26ddc11a27cfed8812ec04fa">Recreate</a>(2, el);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            face_group[i] = groups.<a class="code" href="classmfem_1_1ListOfIntegerSets.html#a451e3ff20e8173bea1996c6cac58fc2b">Insert</a>(group) - 1;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;         }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ac6d9d2955527fac5e033d20433491f82">  531</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#ac6d9d2955527fac5e033d20433491f82">ParMesh::FindSharedEdges</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> &amp;mesh, <span class="keyword">const</span> <span class="keywordtype">int</span> *partitioning,</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                             <a class="code" href="classmfem_1_1Table.html">Table</a>*&amp; edge_element,</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                             <a class="code" href="classmfem_1_1ListOfIntegerSets.html">ListOfIntegerSets</a>&amp; groups)</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;{</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   <a class="code" href="classmfem_1_1IntegerSet.html">IntegerSet</a> group;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="comment">// determine shared edges</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="keywordtype">int</span> sedge_counter = 0;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   <span class="keywordflow">if</span> (!edge_element)</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   {</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      edge_element = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Table.html">Table</a>;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(0,0);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;         <a class="code" href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">Transpose</a>(mesh.<a class="code" href="classmfem_1_1Mesh.html#a221bf58bfe1baf89f6384e3b7c14f861">ElementToEdgeTable</a>(), *edge_element, mesh.<a class="code" href="classmfem_1_1Mesh.html#a09bf96bbcf2833f005406317841f19b2">GetNEdges</a>());</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   }</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   {</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordtype">int</span> me = 0, others = 0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i]; j &lt; edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i+1]; j++)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;         <span class="keywordtype">int</span> k = edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[j];</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;         <span class="keywordtype">int</span> rank = partitioning[k];</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;         edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[j] = rank;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;         <span class="keywordflow">if</span> (rank == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;         {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            me = 1;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;         }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;         {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            others = 1;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;         }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="keywordflow">if</span> (me &amp;&amp; others)</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;         sedge_counter++;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;         group.<a class="code" href="classmfem_1_1IntegerSet.html#a46792e0e26ddc11a27cfed8812ec04fa">Recreate</a>(edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(i), edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i));</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;         edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0] = groups.<a class="code" href="classmfem_1_1ListOfIntegerSets.html#a451e3ff20e8173bea1996c6cac58fc2b">Insert</a>(group) - 1;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;         edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0] = -1;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="keywordflow">return</span> sedge_counter;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ae6d58733b72f9d49584a6640d05fb235">  585</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#ae6d58733b72f9d49584a6640d05fb235">ParMesh::FindSharedVertices</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> *partitioning, <a class="code" href="classmfem_1_1Table.html">Table</a> *vert_element,</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                                <a class="code" href="classmfem_1_1ListOfIntegerSets.html">ListOfIntegerSets</a> &amp;groups)</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;{</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <a class="code" href="classmfem_1_1IntegerSet.html">IntegerSet</a> group;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="comment">// determine shared vertices</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keywordtype">int</span> svert_counter = 0;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordtype">int</span> me = 0, others = 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i]; j &lt; vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i+1]; j++)</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[j] = partitioning[vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[j]];</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <span class="keywordflow">if</span> (vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[j] == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;         {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            me = 1;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;         {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            others = 1;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;         }</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      }</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keywordflow">if</span> (me &amp;&amp; others)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         svert_counter++;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;         group.<a class="code" href="classmfem_1_1IntegerSet.html#a46792e0e26ddc11a27cfed8812ec04fa">Recreate</a>(vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(i), vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i));</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;         vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i] = groups.<a class="code" href="classmfem_1_1ListOfIntegerSets.html#a451e3ff20e8173bea1996c6cac58fc2b">Insert</a>(group) - 1;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;         vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i] = -1;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="keywordflow">return</span> svert_counter;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a9cd80a3c556bbe144e5524944ea00109">  622</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a9cd80a3c556bbe144e5524944ea00109">ParMesh::BuildFaceGroup</a>(<span class="keywordtype">int</span> ngroups, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> &amp;mesh,</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;face_group,</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                             <span class="keywordtype">int</span> &amp;nstria, <span class="keywordtype">int</span> &amp;nsquad)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;{</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   <span class="comment">// build group_stria and group_squad</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(ngroups);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(ngroups);</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; face_group.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="keywordflow">if</span> (face_group[i] &gt;= 0)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;         <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a97ad367f1286f53ce98b3bfe6b7a6c6c">GetFace</a>(i)-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;         {</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(face_group[i]);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;         }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;         {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(face_group[i]);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;         }</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   nstria = nsquad = 0;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; face_group.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      <span class="keywordflow">if</span> (face_group[i] &gt;= 0)</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;         <span class="keywordflow">if</span> (mesh.<a class="code" href="classmfem_1_1Mesh.html#a97ad367f1286f53ce98b3bfe6b7a6c6c">GetFace</a>(i)-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(face_group[i], nstria++);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;         }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;         {</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(face_group[i], nsquad++);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;         }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a2c3ca23eb412a895516662e1885619c5">  668</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a2c3ca23eb412a895516662e1885619c5">ParMesh::BuildEdgeGroup</a>(<span class="keywordtype">int</span> ngroups, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;edge_element)</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;{</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(ngroups);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edge_element.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   {</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordflow">if</span> (edge_element.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0] &gt;= 0)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(edge_element.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0]);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      }</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordtype">int</span> sedge_counter = 0;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edge_element.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="keywordflow">if</span> (edge_element.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0] &gt;= 0)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(edge_element.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0], sedge_counter++);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;}</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a0a10d8e32dc7d3d71ac6756fe4c14ca7">  694</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a0a10d8e32dc7d3d71ac6756fe4c14ca7">ParMesh::BuildVertexGroup</a>(<span class="keywordtype">int</span> ngroups, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;vert_element)</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;{</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(ngroups);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; vert_element.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      <span class="keywordflow">if</span> (vert_element.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i] &gt;= 0)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(vert_element.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i]);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      }</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="keywordtype">int</span> svert_counter = 0;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; vert_element.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;      <span class="keywordflow">if</span> (vert_element.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i] &gt;= 0)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(vert_element.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i], svert_counter++);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a3458b71b04b2fc8376dd2d41c54f79fa">  720</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a3458b71b04b2fc8376dd2d41c54f79fa">ParMesh::BuildSharedFaceElems</a>(<span class="keywordtype">int</span> ntri_faces, <span class="keywordtype">int</span> nquad_faces,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>&amp; mesh, <span class="keywordtype">int</span> *partitioning,</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *faces_tbl,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;face_group,</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;vert_global_local)</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.SetSize(ntri_faces);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.SetSize(nquad_faces);</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>. SetSize(ntri_faces + nquad_faces);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &lt; 3) { <span class="keywordflow">return</span>; }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <span class="keywordtype">int</span> stria_counter = 0;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   <span class="keywordtype">int</span> squad_counter = 0;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; face_group.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordflow">if</span> (face_group[i] &lt; 0) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Element.html">Element</a> *face = mesh.<a class="code" href="classmfem_1_1Mesh.html#a97ad367f1286f53ce98b3bfe6b7a6c6c">GetFace</a>(i);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = face-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <span class="keywordflow">switch</span> (face-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>())</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>:</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;         {</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[stria_counter].Set(fv);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[stria_counter].v;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;               v[j] = vert_global_local[v[j]];</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> lface = (*faces_tbl)(v[0], v[1], v[2]);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[stria_counter] = lface;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 1) <span class="comment">// Tet-only mesh</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;               <a class="code" href="classmfem_1_1Tetrahedron.html">Tetrahedron</a> *tet = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1Tetrahedron.html">Tetrahedron</a> *<span class="keyword">&gt;</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                  (<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[<a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface].Elem1No]);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;               <span class="comment">// mark the shared face for refinement by reorienting</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;               <span class="comment">// it according to the refinement flag in the tetrahedron</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;               <span class="comment">// to which this shared face belongs to.</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;               <span class="keywordflow">if</span> (tet-&gt;<a class="code" href="classmfem_1_1Tetrahedron.html#ab7a34aae369d61fd5e3e67c4f1cac706">GetRefinementFlag</a>())</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;               {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                  tet-&gt;<a class="code" href="classmfem_1_1Tetrahedron.html#abd677057627def50ad358013dee61bc0">GetMarkedFace</a>(<a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface].Elem1Inf/64, v);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                  <span class="comment">// flip the shared face in the processor that owns the</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                  <span class="comment">// second element (in &#39;mesh&#39;)</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                  <span class="keywordtype">int</span> gl_el1, gl_el2;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                  mesh.<a class="code" href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">GetFaceElements</a>(i, &amp;gl_el1, &amp;gl_el2);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == partitioning[gl_el2])</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                  {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                     std::swap(v[0], v[1]);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;               }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            stria_counter++;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;         }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68">Element::QUADRILATERAL</a>:</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;         {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[squad_counter].Set(fv);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[squad_counter].v;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;               v[j] = vert_global_local[v[j]];</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            }</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size() + squad_counter] =</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;               (*faces_tbl)(v[0], v[1], v[2], v[3]);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            squad_counter++;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;         }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            MFEM_ABORT(<span class="stringliteral">&quot;unknown face type: &quot;</span> &lt;&lt; face-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>());</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      }</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   }</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;}</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a9e07cfa2170e12ef7881376658291b40">  797</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a9e07cfa2170e12ef7881376658291b40">ParMesh::BuildSharedEdgeElems</a>(<span class="keywordtype">int</span> nedges, <a class="code" href="classmfem_1_1Mesh.html">Mesh</a>&amp; mesh,</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; vert_global_local,</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">Table</a>* edge_element)</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;{</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="comment">// The passed in mesh is still the global mesh.  &quot;this&quot; mesh is the</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;   <span class="comment">// local partitioned mesh.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.SetSize(nedges);</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>. SetSize(nedges);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;   {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> v_to_v(<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ae6d959a7cd2b26c570831111e2f0d80e">GetVertexToVertexTable</a>(v_to_v);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordtype">int</span> sedge_counter = 0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;         <span class="keywordflow">if</span> (edge_element-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[0] &gt;= 0)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;         {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vert;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            mesh.<a class="code" href="classmfem_1_1Mesh.html#aa975b59a75949fd629c3c92d0c1e5ad6">GetEdgeVertices</a>(i, vert);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedge_counter] =</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;               <span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(vert_global_local[vert[0]],</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                           vert_global_local[vert[1]], 1);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>[sedge_counter] = v_to_v(vert_global_local[vert[0]],</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                                vert_global_local[vert[1]]);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            MFEM_VERIFY(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>[sedge_counter] &gt;= 0, <span class="stringliteral">&quot;Error in v_to_v.&quot;</span>);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            sedge_counter++;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;         }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   }</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a360c3741a62e64c827d4101b69a4439f">  834</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a360c3741a62e64c827d4101b69a4439f">ParMesh::BuildSharedVertMapping</a>(<span class="keywordtype">int</span> nvert,</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">mfem::Table</a> *vert_element,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;vert_global_local)</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;{</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="comment">// build svert_lvert</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(nvert);</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <span class="keywordtype">int</span> svert_counter = 0;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">if</span> (vert_element-&gt;<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[i] &gt;= 0)</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      {</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[svert_counter++] = vert_global_local[i];</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      }</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;   }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;}</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">// protected method, used by Nonconforming(De)Refinement and Rebalance</span></div><div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a186366645d4778f9c3156af8697f17a7">  853</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh::ParMesh</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1ParNCMesh.html">ParNCMesh</a> &amp;pncmesh)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;   : MyComm(pncmesh.MyComm)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   , NRanks(pncmesh.NRanks)</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;   , MyRank(pncmesh.MyRank)</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;   , face_nbr_el_to_face(NULL)</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;   , glob_elem_offset(-1)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;   , glob_offset_sequence(-1)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;   , gtopo(MyComm)</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   , pncmesh(NULL)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;{</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a4c23a825f8da99e3c2a4ed86dc27cdf0">Mesh::InitFromNCMesh</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a3cee7765b3ce1a6a8f5fe82b69e7166e">ReduceMeshGen</a>();</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;}</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#af30963c1d6025a1ef304caa2366109df">  868</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#af30963c1d6025a1ef304caa2366109df">ParMesh::ComputeGlobalElementOffset</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">glob_offset_sequence</a> != <a class="code" href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">sequence</a>) <span class="comment">// mesh has changed</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;   {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordtype">long</span> <span class="keywordtype">long</span> local_elems = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      MPI_Scan(&amp;local_elems, &amp;<a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a>, 1, MPI_LONG_LONG, MPI_SUM,</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a> -= local_elems;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">glob_offset_sequence</a> = <a class="code" href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">sequence</a>; <span class="comment">// don&#39;t recalculate until refinement etc.</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;   }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a3cee7765b3ce1a6a8f5fe82b69e7166e">  881</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a3cee7765b3ce1a6a8f5fe82b69e7166e">ParMesh::ReduceMeshGen</a>()</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;{</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;   <span class="keywordtype">int</span> loc_meshgen = <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   MPI_Allreduce(&amp;loc_meshgen, &amp;<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>, 1, MPI_INT, MPI_BOR, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;}</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div><div class="line"><a name="l00887"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">  887</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">ParMesh::FinalizeParTopo</a>()</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;{</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;   <span class="comment">// Determine sedge_ledge</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size());</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size())</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> v_to_v(<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ae6d959a7cd2b26c570831111e2f0d80e">GetVertexToVertexTable</a>(v_to_v);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> se = 0; se &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); se++)</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[se]-&gt;GetVertices();</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> l_edge = v_to_v(v[0], v[1]);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;         MFEM_ASSERT(l_edge &gt;= 0, <span class="stringliteral">&quot;invalid shared edge&quot;</span>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>[se] = l_edge;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;   <span class="comment">// Determine sface_lface</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> nst = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size();</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(nst + <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size());</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>())</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;   {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *faces_tbl = <a class="code" href="classmfem_1_1Mesh.html#ad5510bac66ddadc6eb5c920c7d74684e">GetFacesTable</a>();</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> st = 0; st &lt; nst; st++)</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      {</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[st].v;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[st] = (*faces_tbl)(v[0], v[1], v[2]);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      }</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a> = 0; <a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size(); <a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a>++)</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[<a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a>].v;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[nst+<a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a>] = (*faces_tbl)(v[0], v[1], v[2], v[3]);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keyword">delete</span> faces_tbl;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   }</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;}</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a5739976e0449fb48d3f7f04a4886cdb0">  924</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh::ParMesh</a>(MPI_Comm comm, istream &amp;input, <span class="keywordtype">bool</span> refine)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;   : face_nbr_el_to_face(NULL)</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;   , glob_elem_offset(-1)</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;   , glob_offset_sequence(-1)</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   , gtopo(comm)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;{</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a> = comm;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;   MPI_Comm_size(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;   MPI_Comm_rank(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = NULL;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> gen_edges = 1;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abeed313ed0e699ab273ef95f65e69535">Load</a>(input, gen_edges, refine, <span class="keyword">true</span>);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#abeed313ed0e699ab273ef95f65e69535">  942</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#abeed313ed0e699ab273ef95f65e69535">ParMesh::Load</a>(istream &amp;input, <span class="keywordtype">int</span> generate_edges, <span class="keywordtype">int</span> refine,</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                   <span class="keywordtype">bool</span> fix_orientation)</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;{</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa454ecf91aa0a17ec48e01610d85988a">ParMesh::Destroy</a>();</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;   <span class="comment">// Tell Loader() to read up to &#39;mfem_serial_mesh_end&#39; instead of</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;   <span class="comment">// &#39;mfem_mesh_end&#39;, as we have additional parallel mesh data to load in from</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;   <span class="comment">// the stream.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a36841bfd50c27064b31681d58bdab2aa">Loader</a>(input, generate_edges, <span class="stringliteral">&quot;mfem_serial_mesh_end&quot;</span>);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a3cee7765b3ce1a6a8f5fe82b69e7166e">ReduceMeshGen</a>(); <span class="comment">// determine the global &#39;meshgen&#39;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a2241de10a34775973f8d6a11e58121e7">Conforming</a>())</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   {</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a941ca9fdca79ba42226a42d4665f41e3">LoadSharedEntities</a>(input);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;   }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;   {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      <span class="comment">// the ParNCMesh instance was already constructed in &#39;Loader&#39;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1ParNCMesh.html">ParNCMesh</a>*<span class="keyword">&gt;</span>(<a class="code" href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">ncmesh</a>);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      MFEM_ASSERT(<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>, <span class="stringliteral">&quot;internal error&quot;</span>);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="comment">// in the NC case we don&#39;t need to load extra data from the file,</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="comment">// as the shared entities can be constructed from the ghost layer</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a81197e06ddf2eb20439cfe166a9551f8">GetConformingSharedStructures</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;   }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a96c92d4c620bb09098eddad86891b21f">Finalize</a>(refine, fix_orientation);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aafd5d6df0b247c7bc48773204c086eb4">EnsureParNodes</a>();</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;   <span class="comment">// note: attributes and bdr_attributes are local lists</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;   <span class="comment">// TODO: NURBS meshes?</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a941ca9fdca79ba42226a42d4665f41e3">  978</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a941ca9fdca79ba42226a42d4665f41e3">ParMesh::LoadSharedEntities</a>(istream &amp;input)</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;{</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   <span class="keywordtype">string</span> ident;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <a class="code" href="namespacemfem.html#af2ff7d23ad44e0ac992308edd40dd30b">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   <span class="comment">// read the group topology</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   input &gt;&gt; ident;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   MFEM_VERIFY(ident == <span class="stringliteral">&quot;communication_groups&quot;</span>,</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;               <span class="stringliteral">&quot;input stream is not a parallel MFEM mesh&quot;</span>);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a78cf1afe79f2f051fe5f0022caee4280">Load</a>(input);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;   <a class="code" href="namespacemfem.html#af2ff7d23ad44e0ac992308edd40dd30b">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;   <span class="comment">// read and set the sizes of svert_lvert, group_svert</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;   {</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      <span class="keywordtype">int</span> num_sverts;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      input &gt;&gt; ident &gt;&gt; num_sverts;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      MFEM_VERIFY(ident == <span class="stringliteral">&quot;total_shared_vertices&quot;</span>, <span class="stringliteral">&quot;invalid mesh file&quot;</span>);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(num_sverts);</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1, num_sverts);</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   <span class="comment">// read and set the sizes of sedge_ledge, group_sedge</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   {</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <a class="code" href="namespacemfem.html#af2ff7d23ad44e0ac992308edd40dd30b">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      <span class="keywordtype">int</span> num_sedges;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      input &gt;&gt; ident &gt;&gt; num_sedges;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      MFEM_VERIFY(ident == <span class="stringliteral">&quot;total_shared_edges&quot;</span>, <span class="stringliteral">&quot;invalid mesh file&quot;</span>);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(num_sedges);</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.SetSize(num_sedges);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1, num_sedges);</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;   }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   {</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a738134431dec43a60af6d8fc7e6f3819">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1, 0);   <span class="comment">// create empty group_sedge</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;   }</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   <span class="comment">// read and set the sizes of sface_lface, group_{stria,squad}</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <a class="code" href="namespacemfem.html#af2ff7d23ad44e0ac992308edd40dd30b">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <span class="keywordtype">int</span> num_sface;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      input &gt;&gt; ident &gt;&gt; num_sface;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      MFEM_VERIFY(ident == <span class="stringliteral">&quot;total_shared_faces&quot;</span>, <span class="stringliteral">&quot;invalid mesh file&quot;</span>);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(num_sface);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;   }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a738134431dec43a60af6d8fc7e6f3819">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1, 0);   <span class="comment">// create empty group_stria</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a738134431dec43a60af6d8fc7e6f3819">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1, 0);   <span class="comment">// create empty group_squad</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;   }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   <span class="comment">// read, group by group, the contents of group_svert, svert_lvert,</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;   <span class="comment">// group_sedge, shared_edges, group_{stria,squad}, shared_{trias,quads}</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;   <span class="keywordtype">int</span> svert_counter = 0, sedge_counter = 0;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;   {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <a class="code" href="namespacemfem.html#af2ff7d23ad44e0ac992308edd40dd30b">skip_comment_lines</a>(input, <span class="charliteral">&#39;#&#39;</span>);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="comment">// implementation prior to prism-dev merge</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <span class="keywordtype">int</span> g;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      input &gt;&gt; ident &gt;&gt; g; <span class="comment">// group</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">if</span> (g != gr)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      {</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         <a class="code" href="namespacemfem.html#aa3e9faf8433d07cc3132b310eb03d731">mfem::err</a> &lt;&lt; <span class="stringliteral">&quot;ParMesh::ParMesh : expecting group &quot;</span> &lt;&lt; gr</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;, read group &quot;</span> &lt;&lt; g &lt;&lt; endl;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;         <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>();</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      }</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      {</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;         <span class="keywordtype">int</span> nv;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         input &gt;&gt; ident &gt;&gt; nv; <span class="comment">// shared_vertices (in this group)</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;         MFEM_VERIFY(ident == <span class="stringliteral">&quot;shared_vertices&quot;</span>, <span class="stringliteral">&quot;invalid mesh file&quot;</span>);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;         nv += svert_counter;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;         MFEM_VERIFY(nv &lt;= <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>(),</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                     <span class="stringliteral">&quot;incorrect number of total_shared_vertices&quot;</span>);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = nv;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;         <span class="keywordflow">for</span> ( ; svert_counter &lt; nv; svert_counter++)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;         {</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[svert_counter] = svert_counter;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            input &gt;&gt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[svert_counter];</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;         }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      {</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;         <span class="keywordtype">int</span> ne, v[2];</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         input &gt;&gt; ident &gt;&gt; ne; <span class="comment">// shared_edges (in this group)</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;         MFEM_VERIFY(ident == <span class="stringliteral">&quot;shared_edges&quot;</span>, <span class="stringliteral">&quot;invalid mesh file&quot;</span>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         ne += sedge_counter;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;         MFEM_VERIFY(ne &lt;= <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>(),</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                     <span class="stringliteral">&quot;incorrect number of total_shared_edges&quot;</span>);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = ne;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;         <span class="keywordflow">for</span> ( ; sedge_counter &lt; ne; sedge_counter++)</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;         {</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[sedge_counter] = sedge_counter;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            input &gt;&gt; v[0] &gt;&gt; v[1];</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedge_counter] = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[0], v[1], 1);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;         }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      {</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;         <span class="keywordtype">int</span> nf, tstart = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(), qstart = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size();</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;         input &gt;&gt; ident &gt;&gt; nf; <span class="comment">// shared_faces (in this group)</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nf; i++)</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;         {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordtype">int</span> geom, *v;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            input &gt;&gt; geom;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="keywordflow">switch</span> (geom)</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            {</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;               <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>:</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                  <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.SetSize(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()+1);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                  v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Last().v;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++) { input &gt;&gt; v[ii]; }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;               <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>:</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                  <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.SetSize(<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size()+1);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                  v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Last().v;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 4; ii++) { input &gt;&gt; v[ii]; }</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                  <span class="keywordflow">break</span>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;               <span class="keywordflow">default</span>:</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                  MFEM_ABORT(<span class="stringliteral">&quot;invalid shared face geometry: &quot;</span> &lt;&lt; geom);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            }</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;         }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()-tstart);</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size()-qstart);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;   }</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;   {</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      MFEM_VERIFY(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size() + <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size()</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                  == <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(),</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                  <span class="stringliteral">&quot;incorrect number of total_shared_faces&quot;</span>);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="comment">// Define the J arrays of group_stria and group_squad -- they just contain</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="comment">// consecutive numbers starting from 0 up to shared_trias.Size()-1 and</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="comment">// shared_quads.Size()-1, respectively.</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); i++)</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[i] = i;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      }</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size(); i++)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[i] = i;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;   }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;}</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aead4c95b5ee9235a0855589681e4da72"> 1127</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh::ParMesh</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *orig_mesh, <span class="keywordtype">int</span> ref_factor, <span class="keywordtype">int</span> ref_type)</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;{</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a6e3e3d935208cc8c3728b459ca9ea15e">MakeRefined_</a>(*orig_mesh, ref_factor, ref_type);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;}</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a6e3e3d935208cc8c3728b459ca9ea15e"> 1132</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a6e3e3d935208cc8c3728b459ca9ea15e">ParMesh::MakeRefined_</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;orig_mesh, <span class="keywordtype">int</span> ref_factor, <span class="keywordtype">int</span> ref_type)</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;{</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a1661656f04d406d94de8b751a2ef93b5">GetComm</a>();</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2a760adc26b5be37bd463e96032342ae">GetNRanks</a>();</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a1797afa9ee0af1d3145cbc395357f57c">GetMyRank</a>();</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a> = NULL;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a> = -1;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">glob_offset_sequence</a> = -1;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = NULL;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ref_factors(orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>());</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;   ref_factors = ref_factor;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a2e59779374ef3ceee57ff013d12d2bb5">Mesh::MakeRefined_</a>(orig_mesh, ref_factors, ref_type);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;   <span class="comment">// Need to initialize:</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;   <span class="comment">// - shared_edges, shared_{trias,quads}</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;   <span class="comment">// - group_svert, group_sedge, group_{stria,squad}</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;   <span class="comment">// - svert_lvert, sedge_ledge, sface_lface</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> = orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>; <span class="comment">// copy the global &#39;meshgen&#39;</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;   <a class="code" href="classmfem_1_1H1__FECollection.html">H1_FECollection</a> rfec(ref_factor, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>, ref_type);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> rfes(&amp;orig_mesh, &amp;rfec);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;   <span class="comment">// count the number of entries in each row of group_s{vert,edge,face}</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1); <span class="comment">// exclude the local group 0</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;   {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="comment">// orig vertex -&gt; vertex</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#affa2425b183402615573eeda05804a7c">GroupNVertices</a>(gr));</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="comment">// orig edge -&gt; (ref_factor-1) vertices and (ref_factor) edges</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_ne = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#ab18f38d2affaab9a1a1feccbe4a99f51">GroupNEdges</a>(gr);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, (ref_factor-1)*orig_ne);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, ref_factor*orig_ne);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="comment">// orig face -&gt; (?) vertices, (?) edges, and (?) faces</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nt = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#aae348d99498be7174b05eebebf31a68b">GroupNTriangles</a>(gr);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="keywordflow">if</span> (orig_nt &gt; 0)</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nvert = <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom];</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;         <a class="code" href="classmfem_1_1RefinedGeometry.html">RefinedGeometry</a> &amp;RG =</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            *<a class="code" href="namespacemfem.html#a3697bdaae6ecb0512523be42d34f468a">GlobGeometryRefiner</a>.<a class="code" href="classmfem_1_1GeometryRefiner.html#a02322fb06b6129c5d2170fff4de16155">Refine</a>(geom, ref_factor, ref_factor);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         <span class="comment">// count internal vertices</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nt*rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#a4fc311c31acc9adcb5bda81c25b7f115">DofForGeometry</a>(geom));</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;         <span class="comment">// count internal edges</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nt*(RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">RefEdges</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()/2-</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                                    RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#ad91b1235663c3b114515b2143e734322">NumBdrEdges</a>));</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;         <span class="comment">// count refined faces</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nt*(RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()/nvert));</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      }</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nq = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a042555bc799c7f54516929fad12dcb85">GroupNQuadrilaterals</a>(gr);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <span class="keywordflow">if</span> (orig_nq &gt; 0)</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      {</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nvert = <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom];</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;         <a class="code" href="classmfem_1_1RefinedGeometry.html">RefinedGeometry</a> &amp;RG =</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            *<a class="code" href="namespacemfem.html#a3697bdaae6ecb0512523be42d34f468a">GlobGeometryRefiner</a>.<a class="code" href="classmfem_1_1GeometryRefiner.html#a02322fb06b6129c5d2170fff4de16155">Refine</a>(geom, ref_factor, ref_factor);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;         <span class="comment">// count internal vertices</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nq*rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#a4fc311c31acc9adcb5bda81c25b7f115">DofForGeometry</a>(geom));</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;         <span class="comment">// count internal edges</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nq*(RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">RefEdges</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()/2-</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                                    RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#ad91b1235663c3b114515b2143e734322">NumBdrEdges</a>));</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         <span class="comment">// count refined faces</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nq*(RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()/nvert));</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;   }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Reserve(<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Reserve(<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Reserve(<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size() + <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size());</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> rdofs;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;   {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="comment">// add shared vertices from original shared vertices</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_n_verts = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#affa2425b183402615573eeda05804a7c">GroupNVertices</a>(gr);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; orig_n_verts; j++)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      {</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;         rfes.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a3f7589d77a54377f6b080cd2f934af48">GetVertexDofs</a>(orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a331895349cfbc3e40e595249c7741a08">GroupVertex</a>(gr, j), rdofs);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(rdofs[0])-1);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="comment">// add refined shared edges; add shared vertices from refined shared edges</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_n_edges = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#ab18f38d2affaab9a1a1feccbe4a99f51">GroupNEdges</a>(gr);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">if</span> (orig_n_edges &gt; 0)</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      {</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nvert = <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom];</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         <a class="code" href="classmfem_1_1RefinedGeometry.html">RefinedGeometry</a> &amp;RG = *<a class="code" href="namespacemfem.html#a3697bdaae6ecb0512523be42d34f468a">GlobGeometryRefiner</a>.<a class="code" href="classmfem_1_1GeometryRefiner.html#a02322fb06b6129c5d2170fff4de16155">Refine</a>(geom, ref_factor);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *c2h_map = rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#af967a0f6e7ab63efbb79cc8fa5413ded">GetDofMap</a>(geom, ref_factor); <span class="comment">// FIXME hp</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; orig_n_edges; e++)</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;         {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            rfes.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#a0a862151943f79b9006ae1851632711c">GetSharedEdgeDofs</a>(gr, e, rdofs);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;            MFEM_ASSERT(rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() == RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a06d15a8bc8081d6b5e120057e485129f">RefPts</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(), <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;            <span class="comment">// add the internal edge &#39;rdofs&#39; as shared vertices</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 2; j &lt; rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            {</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(rdofs[j])-1);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j += nvert)</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            {</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;               <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = <a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(geom);</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;               <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nvert; k++)</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;               {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                  <span class="keywordtype">int</span> cid = RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>[j+k]; <span class="comment">// local Cartesian index</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                  v[k] = rdofs[c2h_map[cid]];</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;               }</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(elem)-1);</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            }</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;         }</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      }</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="comment">// add refined shared faces; add shared edges and shared vertices from</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <span class="comment">// refined shared faces</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nt = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#aae348d99498be7174b05eebebf31a68b">GroupNTriangles</a>(gr);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keywordflow">if</span> (orig_nt &gt; 0)</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nvert = <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom];</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;         <a class="code" href="classmfem_1_1RefinedGeometry.html">RefinedGeometry</a> &amp;RG =</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            *<a class="code" href="namespacemfem.html#a3697bdaae6ecb0512523be42d34f468a">GlobGeometryRefiner</a>.<a class="code" href="classmfem_1_1GeometryRefiner.html#a02322fb06b6129c5d2170fff4de16155">Refine</a>(geom, ref_factor, ref_factor);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> num_int_verts = rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#a4fc311c31acc9adcb5bda81c25b7f115">DofForGeometry</a>(geom);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *c2h_map = rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#af967a0f6e7ab63efbb79cc8fa5413ded">GetDofMap</a>(geom, ref_factor); <span class="comment">// FIXME hp</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> = 0; <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> &lt; orig_nt; <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>++)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;         {</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            rfes.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#a091a1d069e2d47887ed5f3874a83f016">GetSharedTriangleDofs</a>(gr, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>, rdofs);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            MFEM_ASSERT(rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() == RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a06d15a8bc8081d6b5e120057e485129f">RefPts</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(), <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="comment">// add the internal face &#39;rdofs&#39; as shared vertices</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()-num_int_verts; j &lt; rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(rdofs[j])-1);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="comment">// add the internal (for the shared face) edges as shared edges</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 2*RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#ad91b1235663c3b114515b2143e734322">NumBdrEdges</a>; j &lt; RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">RefEdges</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j += 2)</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            {</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;               <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = <a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>);</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;               <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;               {</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                  v[k] = rdofs[c2h_map[RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">RefEdges</a>[j+k]]];</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;               }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(elem)-1);</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="comment">// add refined shared faces</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j += nvert)</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.SetSize(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()+1);</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;               <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Last().v;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nvert; k++)</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;               {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                  <span class="keywordtype">int</span> cid = RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>[j+k]; <span class="comment">// local Cartesian index</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                  v[k] = rdofs[c2h_map[cid]];</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;               }</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()-1);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            }</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;         }</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      }</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nq = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a042555bc799c7f54516929fad12dcb85">GroupNQuadrilaterals</a>(gr);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="keywordflow">if</span> (orig_nq &gt; 0)</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;         <span class="keyword">const</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nvert = <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom];</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;         <a class="code" href="classmfem_1_1RefinedGeometry.html">RefinedGeometry</a> &amp;RG =</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            *<a class="code" href="namespacemfem.html#a3697bdaae6ecb0512523be42d34f468a">GlobGeometryRefiner</a>.<a class="code" href="classmfem_1_1GeometryRefiner.html#a02322fb06b6129c5d2170fff4de16155">Refine</a>(geom, ref_factor, ref_factor);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> num_int_verts = rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#a4fc311c31acc9adcb5bda81c25b7f115">DofForGeometry</a>(geom);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *c2h_map = rfec.<a class="code" href="classmfem_1_1H1__FECollection.html#af967a0f6e7ab63efbb79cc8fa5413ded">GetDofMap</a>(geom, ref_factor); <span class="comment">// FIXME hp</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> = 0; <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> &lt; orig_nq; <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>++)</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;         {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            rfes.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#acdd9724869c18766622fe6632467f4aa">GetSharedQuadrilateralDofs</a>(gr, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>, rdofs);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            MFEM_ASSERT(rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() == RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a06d15a8bc8081d6b5e120057e485129f">RefPts</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(), <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="comment">// add the internal face &#39;rdofs&#39; as shared vertices</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()-num_int_verts; j &lt; rdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(rdofs[j])-1);</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="comment">// add the internal (for the shared face) edges as shared edges</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 2*RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#ad91b1235663c3b114515b2143e734322">NumBdrEdges</a>; j &lt; RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">RefEdges</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j += 2)</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            {</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;               <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = <a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>);</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;               <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;               {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                  v[k] = rdofs[c2h_map[RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">RefEdges</a>[j+k]]];</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;               }</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(elem)-1);</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            }</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <span class="comment">// add refined shared faces</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j += nvert)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.SetSize(<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size()+1);</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;               <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Last().v;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; nvert; k++)</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;               {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                  <span class="keywordtype">int</span> cid = RG.<a class="code" href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">RefGeoms</a>[j+k]; <span class="comment">// local Cartesian index</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                  v[k] = rdofs[c2h_map[cid]];</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;               }</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size()-1);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;         }</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      }</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;   }</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> != NULL)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      <span class="comment">// This call will turn the Nodes into a ParGridFunction</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a5f55ec61fee309905a372ee344994631">SetCurvature</a>(1, <a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>()-&gt;IsDGSpace(), <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>,</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                   <a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>()-&gt;GetOrdering());</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;   }</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ade4cd331ded674ee03c8cab2a8e02d3f"> 1367</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> <a class="code" href="classmfem_1_1ParMesh.html#ade4cd331ded674ee03c8cab2a8e02d3f">ParMesh::MakeRefined</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;orig_mesh, <span class="keywordtype">int</span> ref_factor, <span class="keywordtype">int</span> ref_type)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> mesh;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a6e3e3d935208cc8c3728b459ca9ea15e">MakeRefined_</a>(orig_mesh, ref_factor, ref_type);</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;   <span class="keywordflow">return</span> mesh;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;}</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a93da2addef0d0298d1e90b30b14b7664"> 1374</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> <a class="code" href="classmfem_1_1ParMesh.html#a93da2addef0d0298d1e90b30b14b7664">ParMesh::MakeSimplicial</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;orig_mesh)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;{</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> mesh;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a1661656f04d406d94de8b751a2ef93b5">GetComm</a>();</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2a760adc26b5be37bd463e96032342ae">GetNRanks</a>();</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a1797afa9ee0af1d3145cbc395357f57c">GetMyRank</a>();</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a> = -1;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">glob_offset_sequence</a> = -1;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a> = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = NULL;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;   mesh.<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> = orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;   <a class="code" href="classmfem_1_1H1__FECollection.html">H1_FECollection</a> fec(1, orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#a6875d857942c66cb8cea1159337b807a">Dimension</a>());</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> fes(&amp;orig_mesh, &amp;fec);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vglobal(orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>());</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv&lt;orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>(); ++iv)</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;   {</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      vglobal[iv] = fes.GetGlobalTDofNumber(iv);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;   }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;   mesh.<a class="code" href="classmfem_1_1Mesh.html#afb51ddb515e59436a517d2b1510f8543">MakeSimplicial_</a>(orig_mesh, vglobal);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;   <span class="comment">// count the number of entries in each row of group_s{vert,edge,face}</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1); <span class="comment">// exclude the local group 0</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1);</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;   {</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#affa2425b183402615573eeda05804a7c">GroupNVertices</a>(gr));</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#ab18f38d2affaab9a1a1feccbe4a99f51">GroupNEdges</a>(gr));</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="comment">// Every quad gives an extra edge</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nq = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a042555bc799c7f54516929fad12dcb85">GroupNQuadrilaterals</a>(gr);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nq);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="comment">// Every quad is subdivided into two triangles</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, 2*orig_nq);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      <span class="comment">// Existing triangles remain unchanged</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nt = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#aae348d99498be7174b05eebebf31a68b">GroupNTriangles</a>(gr);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr-1, orig_nt);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;   }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Reserve(mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Reserve(mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size());</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;   constexpr <span class="keywordtype">int</span> ntris = 2, nv_tri = 3, nv_quad = 4;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> dofs;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;   {</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      <span class="comment">// add shared vertices from original shared vertices</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_n_verts = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#affa2425b183402615573eeda05804a7c">GroupNVertices</a>(gr);</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; orig_n_verts; j++)</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      {</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;         fes.GetVertexDofs(orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a331895349cfbc3e40e595249c7741a08">GroupVertex</a>(gr, j), dofs);</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;         mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, mesh.<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(dofs[0])-1);</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      }</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="comment">// add original shared edges</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_n_edges = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#ab18f38d2affaab9a1a1feccbe4a99f51">GroupNEdges</a>(gr);</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; orig_n_edges; e++)</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      {</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;         <span class="keywordtype">int</span> iedge, o;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;         orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#afba0dcbfb9dbd7d2bf794478c8437589">GroupEdge</a>(gr, e, iedge, o);</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;         <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = mesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;         <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> edge_verts;</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;         orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#aa975b59a75949fd629c3c92d0c1e5ad6">GetEdgeVertices</a>(iedge, edge_verts);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;         elem-&gt;<a class="code" href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">SetVertices</a>(edge_verts);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;         mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, mesh.<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(elem)-1);</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      }</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;      <span class="comment">// add original shared triangles</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nt = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#aae348d99498be7174b05eebebf31a68b">GroupNTriangles</a>(gr);</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; orig_nt; e++)</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      {</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;         <span class="keywordtype">int</span> itri, o;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;         orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#ae6dbcb74bd6f1b9d917ebf5b552942d6">GroupTriangle</a>(gr, e, itri, o);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#a97ad367f1286f53ce98b3bfe6b7a6c6c">GetFace</a>(itri)-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;         mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.SetSize(mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()+1);</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         <span class="keywordtype">int</span> *v2 = mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Last().v;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv&lt;nv_tri; ++iv) { v2[iv] = v[iv]; }</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;         mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()-1);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      <span class="comment">// add triangles from split quads and add resulting diagonal edge</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> orig_nq = orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#a042555bc799c7f54516929fad12dcb85">GroupNQuadrilaterals</a>(gr);</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      <span class="keywordflow">if</span> (orig_nq &gt; 0)</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      {</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> trimap[12] =</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;         {</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;            0, 0, 0, 1,</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;            1, 2, 1, 2,</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;            2, 3, 3, 3</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;         };</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> diagmap[4] = { 0, 2, 1, 3 };</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> = 0; <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> &lt; orig_nq; ++<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;         {</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordtype">int</span> iquad, o;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            orig_mesh.<a class="code" href="classmfem_1_1ParMesh.html#acee30a668bbc576868feb465a7fcd7b3">GroupQuadrilateral</a>(gr, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>, iquad, o);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = orig_mesh.<a class="code" href="classmfem_1_1Mesh.html#a97ad367f1286f53ce98b3bfe6b7a6c6c">GetFace</a>(iquad)-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            <span class="comment">// Split quad according the smallest (global) vertex</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            <span class="keywordtype">int</span> vg[nv_quad];</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv&lt;nv_quad; ++iv) { vg[iv] = vglobal[v[iv]]; }</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <span class="keywordtype">int</span> iv_min = std::min_element(vg, vg+nv_quad) - vg;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            <span class="keywordtype">int</span> isplit = (iv_min == 0 || iv_min == 2) ? 0 : 1;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            <span class="comment">// Add diagonal</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            <a class="code" href="classmfem_1_1Element.html">Element</a> *diag = mesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>);</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <span class="keywordtype">int</span> *v_diag = diag-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            v_diag[0] = v[diagmap[0 + isplit*2]];</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            v_diag[1] = v[diagmap[1 + isplit*2]];</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, mesh.<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(diag)-1);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            <span class="comment">// Add two new triangles</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> itri=0; itri&lt;ntris; ++itri)</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            {</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;               mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.SetSize(mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()+1);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;               <span class="keywordtype">int</span> *v2 = mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Last().v;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv=0; iv&lt;nv_tri; ++iv)</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;               {</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                  v2[iv] = v[trimap[itri + isplit*2 + iv*ntris*2]];</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;               }</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;               mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr-1, mesh.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()-1);</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            }</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;         }</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      }</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;   }</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;   mesh.<a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;   <span class="keywordflow">return</span> mesh;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;}</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a96c92d4c620bb09098eddad86891b21f"> 1516</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a96c92d4c620bb09098eddad86891b21f">ParMesh::Finalize</a>(<span class="keywordtype">bool</span> refine, <span class="keywordtype">bool</span> fix_orientation)</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;{</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> meshgen_save = <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a>; <span class="comment">// Mesh::Finalize() may call SetMeshGen()</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ac039f2cf162a535455b4f02fa4df7f06">Mesh::Finalize</a>(refine, fix_orientation);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> = meshgen_save;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;   <span class="comment">// Note: if Mesh::Finalize() calls MarkTetMeshForRefinement() then the</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;   <span class="comment">//       shared_trias have been rotated as necessary.</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;   <span class="comment">// Setup secondary parallel mesh data: sedge_ledge, sface_lface</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;}</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a6698ffa6a809e3cc48b478c26b95e55f"> 1530</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#a6698ffa6a809e3cc48b478c26b95e55f">ParMesh::GetLocalElementNum</a>(<span class="keywordtype">long</span> <span class="keywordtype">long</span> global_element_num)<span class="keyword"> const</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#af30963c1d6025a1ef304caa2366109df">ComputeGlobalElementOffset</a>();</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> local = global_element_num - <a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a>;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;   <span class="keywordflow">if</span> (local &lt; 0 || local &gt;= <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>) { <span class="keywordflow">return</span> -1; }</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;   <span class="keywordflow">return</span> local;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;}</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a363532c83cf1c893013a57281baf281c"> 1538</a></span>&#160;<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classmfem_1_1ParMesh.html#a363532c83cf1c893013a57281baf281c">ParMesh::GetGlobalElementNum</a>(<span class="keywordtype">int</span> local_element_num)<span class="keyword"> const</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#af30963c1d6025a1ef304caa2366109df">ComputeGlobalElementOffset</a>();</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a> + local_element_num;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;}</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;</div><div class="line"><a name="l01544"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ad2b0c68243d9e3c5d9ad86236bf4cb9f"> 1544</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ad2b0c68243d9e3c5d9ad86236bf4cb9f">ParMesh::DistributeAttributes</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;attr)</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;{</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;   <span class="comment">// Determine the largest attribute number across all processors</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   <span class="keywordtype">int</span> max_attr = attr.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() ? attr.<a class="code" href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">Max</a>() : 1 <span class="comment">/*allow empty ranks*/</span>;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;   <span class="keywordtype">int</span> glb_max_attr = -1;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;   MPI_Allreduce(&amp;max_attr, &amp;glb_max_attr, 1, MPI_INT, MPI_MAX, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;   <span class="comment">// Create marker arrays to indicate which attributes are present</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;   <span class="comment">// assuming attribute numbers are in the range [1,glb_max_attr].</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;   <span class="keywordtype">bool</span> *attr_marker = <span class="keyword">new</span> <span class="keywordtype">bool</span>[glb_max_attr];</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;   <span class="keywordtype">bool</span> *glb_attr_marker = <span class="keyword">new</span> <span class="keywordtype">bool</span>[glb_max_attr];</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; glb_max_attr; i++)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;   {</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      attr_marker[i] = <span class="keyword">false</span>;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;   }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; attr.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;   {</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      attr_marker[attr[i] - 1] = <span class="keyword">true</span>;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;   }</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;   MPI_Allreduce(attr_marker, glb_attr_marker, glb_max_attr,</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                 MPI_C_BOOL, MPI_LOR, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;   <span class="keyword">delete</span> [] attr_marker;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;   <span class="comment">// Translate from the marker array to a unique, sorted list of attributes</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;   attr.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   attr.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(glb_max_attr);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; glb_max_attr; i++)</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;   {</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">if</span> (glb_attr_marker[i])</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;      {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;         attr.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(i + 1);</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      }</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;   }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;   <span class="keyword">delete</span> [] glb_attr_marker;</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;}</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div><div class="line"><a name="l01580"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a67c84c40d54bc94d5a304d112e392726"> 1580</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a67c84c40d54bc94d5a304d112e392726">ParMesh::SetAttributes</a>()</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;{</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <span class="comment">// Determine the attributes occurring in local interior and boundary elements</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#afb720c1a8d716f98e6ed23e6822b2b13">Mesh::SetAttributes</a>();</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ad2b0c68243d9e3c5d9ad86236bf4cb9f">DistributeAttributes</a>(<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>[0] &lt;= 0)</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;   {</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      MFEM_WARNING(<span class="stringliteral">&quot;Non-positive boundary element attributes found!&quot;</span>);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;   }</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ad2b0c68243d9e3c5d9ad86236bf4cb9f">DistributeAttributes</a>(<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>[0] &lt;= 0)</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;   {</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;      MFEM_WARNING(<span class="stringliteral">&quot;Non-positive element attributes found!&quot;</span>);</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;   }</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;}</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div><div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a5b8a79e9931e284c0214da68d23339b9"> 1598</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmfem_1_1ParMesh.html#a5b8a79e9931e284c0214da68d23339b9">ParMesh::HasBoundaryElements</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;   <span class="comment">// maximum number of boundary elements over all ranks</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;   <span class="keywordtype">int</span> maxNumOfBdrElements;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;   MPI_Allreduce(&amp;<a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>, &amp;maxNumOfBdrElements, 1,</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                 MPI_INT, MPI_MAX, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;   <span class="keywordflow">return</span> (maxNumOfBdrElements &gt; 0);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;}</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#afba0dcbfb9dbd7d2bf794478c8437589"> 1607</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#afba0dcbfb9dbd7d2bf794478c8437589">ParMesh::GroupEdge</a>(<span class="keywordtype">int</span> group, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> &amp;edge, <span class="keywordtype">int</span> &amp;o)<span class="keyword"> const</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   <span class="keywordtype">int</span> sedge = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group-1)[i];</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   edge = <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>[sedge];</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedge]-&gt;GetVertices();</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;   o = (v[0] &lt; v[1]) ? (+1) : (-1);</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;}</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div><div class="line"><a name="l01615"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ae6dbcb74bd6f1b9d917ebf5b552942d6"> 1615</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ae6dbcb74bd6f1b9d917ebf5b552942d6">ParMesh::GroupTriangle</a>(<span class="keywordtype">int</span> group, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> &amp;face, <span class="keywordtype">int</span> &amp;o)<span class="keyword"> const</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;   <span class="keywordtype">int</span> stria = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group-1)[i];</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;   face = <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[stria];</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;   <span class="comment">// face gives the base orientation</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[face]-&gt;GetType() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>,</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;               <span class="stringliteral">&quot;Expecting a triangular face.&quot;</span>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;   o = <a class="code" href="classmfem_1_1Mesh.html#a51e284497f4584a27a34f6bd3525ee06">GetTriOrientation</a>(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[face]-&gt;<a class="code" href="classmfem_1_1Mesh.html#a4c234990eb6bba0fa4a9772bb4797116">GetVertices</a>(), <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[stria].v);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;}</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#acee30a668bbc576868feb465a7fcd7b3"> 1626</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#acee30a668bbc576868feb465a7fcd7b3">ParMesh::GroupQuadrilateral</a>(<span class="keywordtype">int</span> group, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> &amp;face, <span class="keywordtype">int</span> &amp;o)<span class="keyword"> const</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;   <span class="keywordtype">int</span> squad = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group-1)[i];</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;   face = <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size()+squad];</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;   <span class="comment">// face gives the base orientation</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[face]-&gt;GetType() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68">Element::QUADRILATERAL</a>,</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;               <span class="stringliteral">&quot;Expecting a quadrilateral face.&quot;</span>);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;   o = <a class="code" href="classmfem_1_1Mesh.html#a1e1467c385205e8958089ae090156c9d">GetQuadOrientation</a>(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[face]-&gt;<a class="code" href="classmfem_1_1Mesh.html#a4c234990eb6bba0fa4a9772bb4797116">GetVertices</a>(), <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[squad].v);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div><div class="line"><a name="l01637"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a522b34210abfe52cd71134231aeb4ca2"> 1637</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a522b34210abfe52cd71134231aeb4ca2">ParMesh::GetSharedEdgeCommunicator</a>(<span class="keywordtype">int</span> ordering,</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                                        <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a>&amp; sedge_comm)<span class="keyword"> const</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;gr_sedge = sedge_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a5a01c4355d94a68dc6623c50d1f8fc4b">GroupLDofTable</a>();</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   gr_sedge.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(), <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size());</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   gr_sedge.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[0] = 0;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt;= <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;   {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      gr_sedge.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr-1];</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;   }</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); k++)</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;   {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">if</span> (ordering == 1)</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      {</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;         gr_sedge.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] =k;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      }</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      {</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;         gr_sedge.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k];</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      }</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   }</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;   sedge_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#ae49365321f5af65337d7fe5c2b69c19d">Finalize</a>();</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;}</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aaeca6483b3628feb94d008f7ea86bad5"> 1661</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#aaeca6483b3628feb94d008f7ea86bad5">ParMesh::GetSharedVertexCommunicator</a>(<span class="keywordtype">int</span> ordering,</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                                          <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a>&amp; svert_comm)<span class="keyword"> const</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;gr_svert = svert_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a5a01c4355d94a68dc6623c50d1f8fc4b">GroupLDofTable</a>();</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;   gr_svert.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(), <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;   gr_svert.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[0] = 0;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt;= <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   {</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      gr_svert.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr-1];</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;   }</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); k++)</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;   {</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="keywordflow">if</span> (ordering == 1)</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      {</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;         gr_svert.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = k;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      }</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      {</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;         gr_svert.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k];</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      }</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   svert_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#ae49365321f5af65337d7fe5c2b69c19d">Finalize</a>();</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;}</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;</div><div class="line"><a name="l01685"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a68ba627efbd66b617b3dc8a0c54bb9be"> 1685</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a68ba627efbd66b617b3dc8a0c54bb9be">ParMesh::GetSharedQuadCommunicator</a>(<span class="keywordtype">int</span> ordering,</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                                        <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a>&amp; squad_comm)<span class="keyword"> const</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;gr_squad = squad_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a5a01c4355d94a68dc6623c50d1f8fc4b">GroupLDofTable</a>();</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   gr_squad.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(), <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size());</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;   gr_squad.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[0] = 0;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt;= <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;   {</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      gr_squad.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr-1];</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;   }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size(); k++)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   {</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      <span class="keywordflow">if</span> (ordering == 1)</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      {</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;         gr_squad.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = k;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;      }</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;      {</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;         gr_squad.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k];</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      }</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;   }</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   squad_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#ae49365321f5af65337d7fe5c2b69c19d">Finalize</a>();</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;}</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;</div><div class="line"><a name="l01709"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a1f042059063208b83a9abdb3dc7160a8"> 1709</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a1f042059063208b83a9abdb3dc7160a8">ParMesh::GetSharedTriCommunicator</a>(<span class="keywordtype">int</span> ordering,</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                                       <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a>&amp; stria_comm)<span class="keyword"> const</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;gr_stria = stria_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a5a01c4355d94a68dc6623c50d1f8fc4b">GroupLDofTable</a>();</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;   gr_stria.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(), <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size());</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   gr_stria.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[0] = 0;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt;= <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;   {</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      gr_stria.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr-1];</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;   }</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); k++)</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;   {</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keywordflow">if</span> (ordering == 1)</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      {</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;         gr_stria.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = k;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      }</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;         gr_stria.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k];</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;   }</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;   stria_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#ae49365321f5af65337d7fe5c2b69c19d">Finalize</a>();</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;}</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div><div class="line"><a name="l01733"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#afb9ab36ef169bec5b72f6cbb928f298f"> 1733</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#afb9ab36ef169bec5b72f6cbb928f298f">ParMesh::MarkTetMeshForRefinement</a>(<a class="code" href="classmfem_1_1DSTable.html">DSTable</a> &amp;v_to_v)</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;{</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> order;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ace8518539660c6f8bc04198b3e28ea46">GetEdgeOrdering</a>(v_to_v, order); <span class="comment">// local edge ordering</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <span class="comment">// create a GroupCommunicator on the shared edges</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;   <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a> sedge_comm(<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a522b34210abfe52cd71134231aeb4ca2">GetSharedEdgeCommunicator</a>(sedge_comm);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> sedge_ord(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size());</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Pair&lt;int,int&gt;</a> &gt; sedge_ord_map(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size());</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); k++)</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   {</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="comment">// sedge_ledge may be undefined -- use shared_edges and v_to_v instead</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> sedge = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k];</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedge]-&gt;GetVertices();</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      sedge_ord[k] = order[v_to_v(v[0], v[1])];</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;   }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   sedge_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a8330d9ef25733a0488337478ca514035">Bcast</a>&lt;<span class="keywordtype">int</span>&gt;(sedge_ord, 1);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0, gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;   {</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="keywordflow">if</span> (n == 0) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      sedge_ord_map.SetSize(n);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;      {</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;         sedge_ord_map[j].one = sedge_ord[k+j];</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;         sedge_ord_map[j].two = j;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      }</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      SortPairs&lt;int, int&gt;(sedge_ord_map, n);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;      {</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> sedge_from = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k+j];</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedge_from]-&gt;GetVertices();</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;         sedge_ord[k+j] = order[v_to_v(v[0], v[1])];</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;      }</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      std::sort(&amp;sedge_ord[k], &amp;sedge_ord[k] + n);</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      {</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> sedge_to = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k+sedge_ord_map[j].two];</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedge_to]-&gt;GetVertices();</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;         order[v_to_v(v[0], v[1])] = sedge_ord[k+j];</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      }</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      k += n;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   }</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;   {</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Pair&lt;int, double&gt;</a> &gt; ilen_len(order.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      {</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1DSTable_1_1RowIterator.html">DSTable::RowIterator</a> it(v_to_v, i); !it; ++it)</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;         {</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            <span class="keywordtype">int</span> j = it.Index();</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            ilen_len[j].one = order[j];</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            ilen_len[j].two = <a class="code" href="classmfem_1_1Mesh.html#ab4befc0b8219172fb75b08b8a68a4e35">GetLength</a>(i, it.Column());</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;         }</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      }</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      SortPairs&lt;int, double&gt;(ilen_len, order.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="keywordtype">double</span> d_max = 0.;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; order.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      {</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;         d_max = std::max(d_max, ilen_len[i-1].two-ilen_len[i].two);</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;      }</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="comment">// Debug message from every MPI rank.</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;      <a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;proc. &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> &lt;&lt; <span class="charliteral">&#39;/&#39;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a> &lt;&lt; <span class="stringliteral">&quot;: d_max = &quot;</span> &lt;&lt; d_max</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                &lt;&lt; endl;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      <span class="comment">// Debug message just from rank 0.</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <span class="keywordtype">double</span> glob_d_max;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      MPI_Reduce(&amp;d_max, &amp;glob_d_max, 1, MPI_DOUBLE, MPI_MAX, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      {</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         <a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;glob_d_max = &quot;</span> &lt;&lt; glob_d_max &lt;&lt; endl;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      }</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;   }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;   <span class="comment">// use &#39;order&#39; to mark the tets, the boundary triangles, and the shared</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   <span class="comment">// triangle faces</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   {</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetType() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">Element::TETRAHEDRON</a>)</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      {</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;MarkEdge(v_to_v, order);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      }</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;   }</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   {</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetType() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>)</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;      {</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;MarkEdge(v_to_v, order);</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      }</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;   }</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); i++)</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;   {</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <a class="code" href="classmfem_1_1Triangle.html#a05a8415be2afef95a979c31e1a78cf3d">Triangle::MarkEdge</a>(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v, v_to_v, order);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;   }</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;}</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">// For a line segment with vertices v[0] and v[1], return a number with</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment">// the following meaning:</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">// 0 - the edge was not refined</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment">// 1 - the edge e was refined once by splitting v[0],v[1]</span></div><div class="line"><a name="l01847"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a1a39ac7a8245a70788b01f1b92419725"> 1847</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#a1a39ac7a8245a70788b01f1b92419725">ParMesh::GetEdgeSplittings</a>(<a class="code" href="classmfem_1_1Element.html">Element</a> *edge, <span class="keyword">const</span> <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> &amp;v_to_v,</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                               <span class="keywordtype">int</span> *middle)</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;{</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   <span class="keywordtype">int</span> m, *v = edge-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;   <span class="keywordflow">if</span> ((m = v_to_v(v[0], v[1])) != -1 &amp;&amp; middle[m] != -1)</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;   {</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;   }</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;   {</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;}</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div><div class="line"><a name="l01862"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a05b6a0ccfbc7fce09cf66b3c1b781d65"> 1862</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a05b6a0ccfbc7fce09cf66b3c1b781d65">ParMesh::GetFaceSplittings</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> *fv, <span class="keyword">const</span> <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Hashed2&gt;</a> &amp;v_to_v,</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                                <a class="code" href="classmfem_1_1Array.html">Array&lt;unsigned&gt;</a> &amp;codes)</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;{</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;   <span class="keyword">typedef</span> <a class="code" href="classmfem_1_1Triple.html">Triple&lt;int,int,int&gt;</a> face_t;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;face_t&gt;</a> face_stack;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;   <span class="keywordtype">unsigned</span> code = 0;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;   face_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face_t(fv[0], fv[1], fv[2]));</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> bit = 0; face_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0; bit++)</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;   {</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="keywordflow">if</span> (bit == 8*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      {</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;         codes.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(code);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;         code = bit = 0;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;      }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keyword">const</span> face_t &amp;<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> = face_stack.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>();</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      <span class="keywordtype">int</span> mid = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.one, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.two);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;      <span class="keywordflow">if</span> (mid == -1)</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;      {</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;         <span class="comment">// leave a 0 at bit &#39;bit&#39;</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;         face_stack.<a class="code" href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">DeleteLast</a>();</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      }</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      {</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;         code += (1 &lt;&lt; bit); <span class="comment">// set bit &#39;bit&#39; to 1</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;         mid += <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;         face_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face_t(<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.three, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.one, mid));</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;         face_t &amp;r = face_stack[face_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()-2];</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;         r = face_t(r.two, r.three, mid);</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;      }</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;   }</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;   codes.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(code);</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;}</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a9079e68a3e311bef9d312a464d1c385a"> 1897</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmfem_1_1ParMesh.html#a9079e68a3e311bef9d312a464d1c385a">ParMesh::DecodeFaceSplittings</a>(<a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Hashed2&gt;</a> &amp;v_to_v, <span class="keyword">const</span> <span class="keywordtype">int</span> *v,</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;unsigned&gt;</a> &amp;codes, <span class="keywordtype">int</span> &amp;pos)</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;{</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;   <span class="keyword">typedef</span> <a class="code" href="classmfem_1_1Triple.html">Triple&lt;int,int,int&gt;</a> face_t;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;face_t&gt;</a> face_stack;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;   <span class="keywordtype">bool</span> need_refinement = 0;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;   face_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face_t(v[0], v[1], v[2]));</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> bit = 0, code = codes[pos++]; face_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0; bit++)</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;   {</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keywordflow">if</span> (bit == 8*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      {</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;         code = codes[pos++];</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;         bit = 0;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      }</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <span class="keywordflow">if</span> ((code &amp; (1 &lt;&lt; bit)) == 0) { face_stack.<a class="code" href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">DeleteLast</a>(); <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keyword">const</span> face_t &amp;<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a> = face_stack.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>();</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      <span class="keywordtype">int</span> mid = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.one, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.two);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">if</span> (mid == -1)</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      {</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;         mid = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#a6e94e3678fe908300fc5c8873d3f0bc5">GetId</a>(<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.one, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.two);</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;         <span class="keywordtype">int</span> ind[2] = { <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.one, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.two };</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Append(<a class="code" href="classmfem_1_1Vertex.html">Vertex</a>());</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aad2cb8db2b1437750935553c4034a9e1">AverageVertices</a>(ind, 2, <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Size()-1);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;         need_refinement = 1;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      }</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;      mid += <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      face_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face_t(<a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.three, <a class="code" href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">f</a>.one, mid));</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      face_t &amp;r = face_stack[face_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()-2];</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      r = face_t(r.two, r.three, mid);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   }</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <span class="keywordflow">return</span> need_refinement;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;}</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ab2cbd39c804f07e3af26c6795bc62264"> 1933</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ab2cbd39c804f07e3af26c6795bc62264">ParMesh::GenerateOffsets</a>(<span class="keywordtype">int</span> N, <a class="code" href="hypre__parcsr_8hpp.html#a891d15140bcc33b92ff03f02664c9022">HYPRE_BigInt</a> loc_sizes[],</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                              <a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> *offsets[])<span class="keyword"> const</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;   {</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> temp(N);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      MPI_Scan(loc_sizes, temp.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), N, HYPRE_MPI_BIG_INT, MPI_SUM, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++)</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      {</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;         offsets[i]-&gt;<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;         (*offsets[i])[0] = temp[i] - loc_sizes[i];</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;         (*offsets[i])[1] = temp[i];</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      }</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      MPI_Bcast(temp.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), N, HYPRE_MPI_BIG_INT, <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>-1, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++)</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;      {</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;         (*offsets[i])[2] = temp[i];</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;         <span class="comment">// check for overflow</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;         MFEM_VERIFY((*offsets[i])[0] &gt;= 0 &amp;&amp; (*offsets[i])[1] &gt;= 0,</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                     <span class="stringliteral">&quot;overflow in offsets&quot;</span>);</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      }</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   }</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   {</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> temp(N*<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>);</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      MPI_Allgather(loc_sizes, N, HYPRE_MPI_BIG_INT, temp.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), N,</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    HYPRE_MPI_BIG_INT, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; N; i++)</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      {</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;         <a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> &amp;offs = *offsets[i];</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;         offs.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>+1);</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;         offs[0] = 0;</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; j++)</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         {</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            offs[j+1] = offs[j] + temp[i+N*j];</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;         }</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;         <span class="comment">// Check for overflow</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;         MFEM_VERIFY(offs[<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>] &gt;= 0 &amp;&amp; offs[<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>+1] &gt;= 0,</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                     <span class="stringliteral">&quot;overflow in offsets&quot;</span>);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      }</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;   }</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;}</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;</div><div class="line"><a name="l01976"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a95c8bc6cc12e67bd8a952b6bb94a415b"> 1976</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a95c8bc6cc12e67bd8a952b6bb94a415b">ParMesh::GetFaceNbrElementTransformation</a>(</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;   <span class="keywordtype">int</span> i, <a class="code" href="classmfem_1_1IsoparametricTransformation.html">IsoparametricTransformation</a> *ElTr)</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;{</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;pointmat = ElTr-&gt;<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a45164c2e229ec45a83f50a50dd80302e">GetPointMat</a>();</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;   <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[i];</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;   ElTr-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#adcbe93689e9f88e401464c49f0d4fb2e">Attribute</a> = elem-&gt;<a class="code" href="classmfem_1_1Element.html#ac8535dd353bf1d8bb2068a28abe8b436">GetAttribute</a>();</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;   ElTr-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#a945a5eda543ab04aa8cf38b5caeaf4f0">ElementNo</a> = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> + i;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;   ElTr-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#afa5039577a5f025c51136dfddbf59358">ElementType</a> = <a class="code" href="classmfem_1_1ElementTransformation.html#af17b21e655aa7edd97dec4c93fa19ec3aaaa97da9eb1848fb638687a9635fab78">ElementTransformation::ELEMENT</a>;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;   ElTr-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#a5603b7b1024b36ba4375a8b4adbd58a2">mesh</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;   ElTr-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#ae5ce116fc288a679459e369af376e435">Reset</a>();</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> == NULL)</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;   {</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nv = elem-&gt;<a class="code" href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">GetNVertices</a>();</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      pointmat.<a class="code" href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, nv);</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; k++)</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      {</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;         {</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            pointmat(k, j) = <a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>[v[j]](k);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;         }</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      }</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      ElTr-&gt;<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a156708114d0bfeb6e9aadc664ad68d2c">SetFE</a>(<a class="code" href="classmfem_1_1Mesh.html#a1d2e8f696ea28c4ed0dc738de6bcd009">GetTransformationFEforElementType</a>(elem-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>()));</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;   }</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;   {</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vdofs;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;      <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *pNodes = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *<span class="keyword">&gt;</span>(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>);</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keywordflow">if</span> (pNodes)</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      {</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;         pNodes-&gt;<a class="code" href="classmfem_1_1ParGridFunction.html#ac3a24195a12d4b801a1aa1f7e8f0a89d">ParFESpace</a>()-&gt;<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ab9dcb35bab1960fbed70643586289b04">GetFaceNbrElementVDofs</a>(i, vdofs);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;         <span class="keywordtype">int</span> n = vdofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()/<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;         pointmat.<a class="code" href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, n);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; k++)</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;         {</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;            {</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;               pointmat(k,j) = (pNodes-&gt;<a class="code" href="classmfem_1_1ParGridFunction.html#aca823c26fcbef5a0d54e21065f4c996f">FaceNbrData</a>())(vdofs[n*k+j]);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            }</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;         }</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;         ElTr-&gt;<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a156708114d0bfeb6e9aadc664ad68d2c">SetFE</a>(pNodes-&gt;<a class="code" href="classmfem_1_1ParGridFunction.html#ac3a24195a12d4b801a1aa1f7e8f0a89d">ParFESpace</a>()-&gt;<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#af043ab44e2d5144949ed66181afe1246">GetFaceNbrFE</a>(i));</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      }</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      {</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;Nodes are not ParGridFunction!&quot;</span>);</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;      }</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;   }</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;}</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02030"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#adc9fbbcfc01b5fd7723d061dbcde136a"> 2030</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classmfem_1_1ParMesh.html#adc9fbbcfc01b5fd7723d061dbcde136a">ParMesh::GetFaceNbrElementSize</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> type)</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;{</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1Mesh.html#adde50e5a10f09b877c861d8371981c0c">GetElementSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#a95c8bc6cc12e67bd8a952b6bb94a415b">GetFaceNbrElementTransformation</a>(i), type);</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;}</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5"> 2035</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">ParMesh::DeleteFaceNbrData</a>()</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;{</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a>)</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;   {</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;   }</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>.<a class="code" href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">DeleteAll</a>();</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>.<a class="code" href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">DeleteAll</a>();</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>.<a class="code" href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">DeleteAll</a>();</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>.Size(); i++)</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   {</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac8d75c3d28255c7153c2b72f7811058a">FreeElement</a>(<a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[i]);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;   }</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>.DeleteAll();</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>.DeleteAll();</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">Clear</a>();</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">Clear</a>();</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;}</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;</div><div class="line"><a name="l02056"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a5f55ec61fee309905a372ee344994631"> 2056</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a5f55ec61fee309905a372ee344994631">ParMesh::SetCurvature</a>(<span class="keywordtype">int</span> order, <span class="keywordtype">bool</span> discont, <span class="keywordtype">int</span> space_dim, <span class="keywordtype">int</span> ordering)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;{</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;   space_dim = (space_dim == -1) ? <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a> : space_dim;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;   <a class="code" href="classmfem_1_1FiniteElementCollection.html">FiniteElementCollection</a>* nfec;</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;   <span class="keywordflow">if</span> (discont)</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;   {</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      nfec = <span class="keyword">new</span> <a class="code" href="classmfem_1_1L2__FECollection.html">L2_FECollection</a>(order, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>, <a class="code" href="classmfem_1_1BasisType.html#a595200afdb6ca6e3fda75896071ef3efa5289400991b692469b59ad94accfe75b">BasisType::GaussLobatto</a>);</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;   }</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   {</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      nfec = <span class="keyword">new</span> <a class="code" href="classmfem_1_1H1__FECollection.html">H1_FECollection</a>(order, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;   }</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>* nfes = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(<span class="keyword">this</span>, nfec, space_dim,</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;                                                           ordering);</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;   <span class="keyword">auto</span> pnodes = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a>(nfes);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aca13f93c81a0ef69c0aa9d0328c114b7">GetNodes</a>(*pnodes);</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#acdb6659e4e92d2a4c214f7453cab79b5">NewNodes</a>(*pnodes, <span class="keyword">true</span>);</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a5b7454afd8d02d6a6fe8ec4754e448fe">MakeOwner</a>(nfec);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;}</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div><div class="line"><a name="l02076"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a7d957f07ff5fd306b8dd15a367b292b3"> 2076</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a7d957f07ff5fd306b8dd15a367b292b3">ParMesh::SetNodalFESpace</a>(<a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a> *nfes)</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;{</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *npfes = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>*<span class="keyword">&gt;</span>(nfes);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;   <span class="keywordflow">if</span> (npfes)</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;   {</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a7d957f07ff5fd306b8dd15a367b292b3">SetNodalFESpace</a>(npfes);</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;   }</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;   {</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#abf310dd4bd2b603cf1c1c6c1006ded0b">Mesh::SetNodalFESpace</a>(nfes);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;   }</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;}</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;</div><div class="line"><a name="l02089"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#af35c38b9f45693d04532d86b733fa262"> 2089</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a7d957f07ff5fd306b8dd15a367b292b3">ParMesh::SetNodalFESpace</a>(<a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *npfes)</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;{</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;   <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *nodes = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a>(npfes);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a938655b0d2d1168689770bf06e48ae49">SetNodalGridFunction</a>(nodes, <span class="keyword">true</span>);</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;}</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div><div class="line"><a name="l02095"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aafd5d6df0b247c7bc48773204c086eb4"> 2095</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#aafd5d6df0b247c7bc48773204c086eb4">ParMesh::EnsureParNodes</a>()</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;{</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> &amp;&amp; dynamic_cast&lt;ParFiniteElementSpace*&gt;(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>()) == NULL)</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;   {</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;      <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *pfes =</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;         <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a>(*<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>(), *<span class="keyword">this</span>);</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *new_nodes = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a>(pfes);</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      *new_nodes = *<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#ac07dc3502dcfd13cb325c98349b5e319">OwnFEC</a>())</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      {</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;         new_nodes-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a5b7454afd8d02d6a6fe8ec4754e448fe">MakeOwner</a>(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#ac07dc3502dcfd13cb325c98349b5e319">OwnFEC</a>());</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a5b7454afd8d02d6a6fe8ec4754e448fe">MakeOwner</a>(NULL); <span class="comment">// takes away ownership of &#39;fec&#39; and &#39;fes&#39;</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;         <span class="keyword">delete</span> <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>();</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;      }</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> = new_nodes;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;   }</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;}</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57"> 2117</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57">ParMesh::ExchangeFaceNbrData</a>()</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;{</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a>)</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;   {</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   }</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">Nonconforming</a>())</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;   {</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      <span class="comment">// with ParNCMesh we can set up face neighbors without communication</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a4482879c8b45fae30e481d6f1e3fa1c7">GetFaceNeighbors</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a7a2c02dd7f2fa28aa27324cc81135115">ExchangeFaceNbrNodes</a>();</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;   }</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> *gr_sface;</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;   <span class="keywordtype">int</span>   *s2l_face;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;   <span class="keywordtype">bool</span>   del_tables = <span class="keyword">false</span>;</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1)</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;   {</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      gr_sface = &amp;<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      s2l_face = <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;   }</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;   {</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      gr_sface = &amp;<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      s2l_face = <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;   }</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;   {</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      s2l_face = <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size() == <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>())</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      {</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;         <span class="comment">// All shared faces are Triangular</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;         gr_sface = &amp;<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;      }</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size() == <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>())</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;      {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;         <span class="comment">// All shared faced are Quadrilateral</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;         gr_sface = &amp;<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>;</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;      }</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      {</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;         <span class="comment">// Shared faces contain a mixture of triangles and quads</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;         gr_sface = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Table.html">Table</a>;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;         del_tables = <span class="keyword">true</span>;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;         <span class="comment">// Merge the Tables group_stria and group_squad</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;         gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>());</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr=0; gr&lt;<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); gr++)</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;         {</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(gr,</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                                      <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr) +</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                                      <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr));</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;         }</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;         gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nst = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size();</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr=0; gr&lt;<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); gr++)</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;         {</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;            gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a440c7b20b906c764e57bd43ee5670d60">AddConnections</a>(gr,</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                                     <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr),</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                                     <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr));</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr); c++)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;            {</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;               gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(gr,</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                                       nst + <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr)[c]);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            }</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;         }</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;         gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      }</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   }</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57">ExchangeFaceNbrData</a>(gr_sface, s2l_face);</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   {</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a5af643a8b550ef249d39f2c7452e3b87">GetFaceNbrElementToFaceTable</a>();</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;   }</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;   <span class="keywordflow">if</span> (del_tables) { <span class="keyword">delete</span> gr_sface; }</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> ) { <span class="keywordflow">return</span>; }</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a7a2c02dd7f2fa28aa27324cc81135115">ExchangeFaceNbrNodes</a>();</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;}</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a1ce484d0d018292870b5c8bd28721545"> 2207</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57">ParMesh::ExchangeFaceNbrData</a>(<a class="code" href="classmfem_1_1Table.html">Table</a> *gr_sface, <span class="keywordtype">int</span> *s2l_face)</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;{</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;   <span class="keywordtype">int</span> num_face_nbrs = 0;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 1; g &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); g++)</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;   {</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      <span class="keywordflow">if</span> (gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(g-1) &gt; 0)</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;      {</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;         num_face_nbrs++;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;      }</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;   }</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(num_face_nbrs);</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;   <span class="keywordflow">if</span> (num_face_nbrs == 0)</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   {</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;   }</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;   {</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      <span class="comment">// sort face-neighbors by processor rank</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Pair&lt;int, int&gt;</a> &gt; rank_group(num_face_nbrs);</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 1, counter = 0; g &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); g++)</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      {</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;         <span class="keywordflow">if</span> (gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(g-1) &gt; 0)</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;         {</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            MFEM_ASSERT(<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a4846bd1e96d1fadb07d42db0649ffaed">GetGroupSize</a>(g) == 2, <span class="stringliteral">&quot;group size is not 2!&quot;</span>);</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *nbs = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">GetGroup</a>(g);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="keywordtype">int</span> lproc = (nbs[0]) ? nbs[0] : nbs[1];</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            rank_group[counter].one = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(lproc);</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            rank_group[counter].two = g;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            counter++;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;         }</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      }</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      SortPairs&lt;int, int&gt;(rank_group, rank_group.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;      {</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>[fn] = rank_group[fn].two;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;      }</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;   }</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;   MPI_Request *requests = <span class="keyword">new</span> MPI_Request[2*num_face_nbrs];</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;   MPI_Request *send_requests = requests;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;   MPI_Request *recv_requests = requests + num_face_nbrs;</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;   MPI_Status  *statuses = <span class="keyword">new</span> MPI_Status[num_face_nbrs];</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   <span class="keywordtype">int</span> *nbr_data = <span class="keyword">new</span> <span class="keywordtype">int</span>[6*num_face_nbrs];</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;   <span class="keywordtype">int</span> *nbr_send_data = nbr_data;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;   <span class="keywordtype">int</span> *nbr_recv_data = nbr_data + 3*num_face_nbrs;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> el_marker(<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>());</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vertex_marker(<a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>());</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;   el_marker = -1;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;   vertex_marker = -1;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> fcs, cor;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> send_face_nbr_elemdata, send_face_nbr_facedata;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(num_face_nbrs);</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(num_face_nbrs);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;   send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(num_face_nbrs);</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;   send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(num_face_nbrs);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;   {</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordtype">int</span> nbr_group = <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>[fn];</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keywordtype">int</span>  num_sfaces = gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(nbr_group-1);</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <span class="keywordtype">int</span> *sface = gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(nbr_group-1);</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_sfaces; i++)</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      {</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;         <span class="keywordtype">int</span> lface = s2l_face[sface[i]];</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;         <span class="keywordtype">int</span> el = <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface].Elem1No;</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;         <span class="keywordflow">if</span> (el_marker[el] != fn)</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;         {</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            el_marker[el] = fn;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(fn);</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[el]-&gt;GetNVertices();</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[el]-&gt;GetVertices();</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;               <span class="keywordflow">if</span> (vertex_marker[v[j]] != fn)</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;               {</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;                  vertex_marker[v[j]] = fn;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                  <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(fn);</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;               }</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nf = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[el]-&gt;GetNFaces();</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(fn, nv + nf + 2);</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;         }</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      }</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(fn, 2*num_sfaces);</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      nbr_send_data[3*fn  ] = <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[fn];</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      nbr_send_data[3*fn+1] = <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[fn];</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;      nbr_send_data[3*fn+2] = send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[fn];</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keywordtype">int</span> nbr_rank = <a class="code" href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950">GetFaceNbrRank</a>(fn);</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;      <span class="keywordtype">int</span> tag = 0;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      MPI_Isend(&amp;nbr_send_data[3*fn], 3, MPI_INT, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>,</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                &amp;send_requests[fn]);</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      MPI_Irecv(&amp;nbr_recv_data[3*fn], 3, MPI_INT, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>,</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;                &amp;recv_requests[fn]);</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;   }</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;   send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;   send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;   el_marker = -1;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;   vertex_marker = -1;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> nst = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size();</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;   {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      <span class="keywordtype">int</span> nbr_group = <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>[fn];</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <span class="keywordtype">int</span>  num_sfaces = gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(nbr_group-1);</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="keywordtype">int</span> *sface = gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(nbr_group-1);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_sfaces; i++)</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;      {</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> sf = sface[i];</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;         <span class="keywordtype">int</span> lface = s2l_face[sf];</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;         <span class="keywordtype">int</span> el = <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface].Elem1No;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;         <span class="keywordflow">if</span> (el_marker[el] != fn)</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;         {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            el_marker[el] = fn;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(fn, el);</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[el]-&gt;GetNVertices();</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[el]-&gt;GetVertices();</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;               <span class="keywordflow">if</span> (vertex_marker[v[j]] != fn)</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;               {</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                  vertex_marker[v[j]] = fn;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                  <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(fn, v[j]);</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;               }</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(fn, <a class="code" href="classmfem_1_1Mesh.html#a2883f6489c821ed509ce84e74b919b54">GetAttribute</a>(el));</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;            send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;               fn, <a class="code" href="classmfem_1_1Mesh.html#aed059a8a2f3fd0481f57a08aecf30059">GetElementBaseGeometry</a>(el));</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;            send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a440c7b20b906c764e57bd43ee5670d60">AddConnections</a>(fn, v, nv);</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            {</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> nf = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[el]-&gt;GetNFaces();</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#a8a9eeb25e4480dddca25a2c292eae00d">GetElementFaces</a>(el, fcs, cor);</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;               send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a440c7b20b906c764e57bd43ee5670d60">AddConnections</a>(fn, cor, nf);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            }</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;         }</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;         send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(fn, el);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;         <span class="keywordtype">int</span> info = <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface].Elem1Inf;</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;         <span class="comment">// change the orientation in info to be relative to the shared face</span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;         <span class="comment">//   in 1D and 2D keep the orientation equal to 0</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;         {</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *lf_v = <a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[lface]-&gt;GetVertices();</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            <span class="keywordflow">if</span> (sf &lt; nst) <span class="comment">// triangle shared face</span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            {</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;               info += <a class="code" href="classmfem_1_1Mesh.html#a51e284497f4584a27a34f6bd3525ee06">GetTriOrientation</a>(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[sf].v, lf_v);</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            }</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// quad shared face</span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            {</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;               info += <a class="code" href="classmfem_1_1Mesh.html#a1e1467c385205e8958089ae090156c9d">GetQuadOrientation</a>(<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[sf-nst].v, lf_v);</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            }</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;         }</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;         send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(fn, info);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      }</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;   }</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;   send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;   send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;   <span class="comment">// convert the vertex indices in send_face_nbr_elemdata</span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;   <span class="comment">// convert the element indices in send_face_nbr_facedata</span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   {</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;      <span class="keywordtype">int</span>  num_elems  = <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn);</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;      <span class="keywordtype">int</span> *elems      = <a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn);</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <span class="keywordtype">int</span>  num_verts  = <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="keywordtype">int</span> *verts      = <a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn);</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <span class="keywordtype">int</span> *elemdata   = send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn);</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;      <span class="keywordtype">int</span>  num_sfaces = send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn)/2;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;      <span class="keywordtype">int</span> *facedata   = send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn);</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_verts; i++)</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      {</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;         vertex_marker[verts[i]] = i;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      }</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> el = 0; el &lt; num_elems; el++)</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      {</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[elems[el]]-&gt;GetNVertices();</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nf = (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3) ? <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[elems[el]]-&gt;<a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>() : 0;</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;         elemdata += 2; <span class="comment">// skip the attribute and the geometry type</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;         {</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            elemdata[j] = vertex_marker[elemdata[j]];</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;         }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;         elemdata += nv + nf;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;         el_marker[elems[el]] = el;</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;      }</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_sfaces; i++)</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;      {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;         facedata[2*i] = el_marker[facedata[2*i]];</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;      }</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;   }</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;   MPI_Waitall(num_face_nbrs, recv_requests, statuses);</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> recv_face_nbr_facedata;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> recv_face_nbr_elemdata;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;   <span class="comment">// fill-in face_nbr_elements_offset, face_nbr_vertices_offset</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(num_face_nbrs + 1);</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(num_face_nbrs + 1);</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;   recv_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(num_face_nbrs);</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[0] = 0;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[0] = 0;</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;   {</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[fn+1] =</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[fn] + nbr_recv_data[3*fn];</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[fn+1] =</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[fn] + nbr_recv_data[3*fn+1];</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      recv_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(fn, nbr_recv_data[3*fn+2]);</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;   }</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;   recv_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;   MPI_Waitall(num_face_nbrs, send_requests, statuses);</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;   <span class="comment">// send and receive the element data</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;   {</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;      <span class="keywordtype">int</span> nbr_rank = <a class="code" href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950">GetFaceNbrRank</a>(fn);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keywordtype">int</span> tag = 0;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      MPI_Isend(send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn),</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                send_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn),</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                MPI_INT, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;send_requests[fn]);</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;      MPI_Irecv(recv_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn),</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                recv_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn),</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                MPI_INT, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;recv_requests[fn]);</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   }</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   <span class="comment">// convert the element data into face_nbr_elements</span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>.SetSize(<a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[num_face_nbrs]);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">face_nbr_el_ori</a>.<a class="code" href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">Clear</a>();</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">face_nbr_el_ori</a>.<a class="code" href="classmfem_1_1Table.html#a738134431dec43a60af6d8fc7e6f3819">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[num_face_nbrs], 6);</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;   <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;   {</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;      <span class="keywordtype">int</span> fn;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;      MPI_Waitany(num_face_nbrs, recv_requests, &amp;fn, statuses);</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;      <span class="keywordflow">if</span> (fn == MPI_UNDEFINED)</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;      {</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;      }</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;      <span class="keywordtype">int</span>  vert_off      = <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[fn];</div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      <span class="keywordtype">int</span>  elem_off      = <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[fn];</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;      <span class="keywordtype">int</span>  num_elems     = <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[fn+1] - elem_off;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <span class="keywordtype">int</span> *recv_elemdata = recv_face_nbr_elemdata.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn);</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_elems; i++)</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      {</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;         <a class="code" href="classmfem_1_1Element.html">Element</a> *el = <a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(recv_elemdata[1]);</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;         el-&gt;<a class="code" href="classmfem_1_1Element.html#a68f17653a78f9d85c29a1e486a25ddaf">SetAttribute</a>(recv_elemdata[0]);</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;         recv_elemdata += 2;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;         <span class="keywordtype">int</span> nv = el-&gt;<a class="code" href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">GetNVertices</a>();</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;         {</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;            recv_elemdata[j] += vert_off;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;         }</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;         el-&gt;<a class="code" href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">SetVertices</a>(recv_elemdata);</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;         recv_elemdata += nv;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;         {</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            <span class="keywordtype">int</span> nf = el-&gt;<a class="code" href="classmfem_1_1Element.html#a03a783300d766ab20ec48fb23ef92b62">GetNFaces</a>();</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <span class="keywordtype">int</span> * fn_ori = <a class="code" href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">face_nbr_el_ori</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(elem_off);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nf; j++)</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            {</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;               fn_ori[j] = recv_elemdata[j];</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            }</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            recv_elemdata += nf;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;         }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[elem_off++] = el;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      }</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;   }</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">face_nbr_el_ori</a>.<a class="code" href="classmfem_1_1Table.html#a97d6d380f8416ddbfb5187238a5a8f46">Finalize</a>();</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;   MPI_Waitall(num_face_nbrs, send_requests, statuses);</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   <span class="comment">// send and receive the face data</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;   recv_face_nbr_facedata.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   {</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordtype">int</span> nbr_rank = <a class="code" href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950">GetFaceNbrRank</a>(fn);</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="keywordtype">int</span> tag = 0;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      MPI_Isend(send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(fn),</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn),</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                MPI_INT, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;send_requests[fn]);</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <span class="comment">// the size of the send and receive face data is the same</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      MPI_Irecv(&amp;recv_face_nbr_facedata[send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[fn]],</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn),</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                MPI_INT, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;recv_requests[fn]);</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;   }</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;   <span class="comment">// transfer the received face data into faces_info</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;   <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;   {</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      <span class="keywordtype">int</span> fn;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;      MPI_Waitany(num_face_nbrs, recv_requests, &amp;fn, statuses);</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="keywordflow">if</span> (fn == MPI_UNDEFINED)</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      {</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      }</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;      <span class="keywordtype">int</span>  elem_off   = <a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>[fn];</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="keywordtype">int</span>  nbr_group  = <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>[fn];</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;      <span class="keywordtype">int</span>  num_sfaces = gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(nbr_group-1);</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <span class="keywordtype">int</span> *sface      = gr_sface-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(nbr_group-1);</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      <span class="keywordtype">int</span> *facedata =</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;         &amp;recv_face_nbr_facedata[send_face_nbr_facedata.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[fn]];</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_sfaces; i++)</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;      {</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> sf = sface[i];</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;         <span class="keywordtype">int</span> lface = s2l_face[sf];</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;         <a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html">FaceInfo</a> &amp;face_info = <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface];</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;         face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#ae80c204d9f7f651358d2a1b18cbe40ba">Elem2No</a> = -1 - (facedata[2*i] + elem_off);</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;         <span class="keywordtype">int</span> info = facedata[2*i+1];</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;         <span class="comment">// change the orientation in info to be relative to the local face</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &lt; 3)</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;         {</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            info++; <span class="comment">// orientation 0 --&gt; orientation 1</span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;         }</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;         {</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;            <span class="keywordtype">int</span> nbr_ori = info%64, nbr_v[4];</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *lf_v = <a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[lface]-&gt;GetVertices();</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;            <span class="keywordflow">if</span> (sf &lt; nst) <span class="comment">// triangle shared face</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;            {</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;               <span class="comment">// apply the nbr_ori to sf_v to get nbr_v</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *perm = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TRIANGLE_01_4.html#ac6c42835ae2141eb30177d1a815221c1">tri_t::Orient</a>[nbr_ori];</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *sf_v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[sf].v;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++)</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;               {</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                  nbr_v[perm[j]] = sf_v[j];</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;               }</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;               <span class="comment">// get the orientation of nbr_v w.r.t. the local face</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;               nbr_ori = <a class="code" href="classmfem_1_1Mesh.html#a51e284497f4584a27a34f6bd3525ee06">GetTriOrientation</a>(lf_v, nbr_v);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;            }</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// quad shared face</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            {</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;               <span class="comment">// apply the nbr_ori to sf_v to get nbr_v</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *perm = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1SQUARE_01_4.html#a565d3b9ebcd7d9e03b6149fc24a5087b">quad_t::Orient</a>[nbr_ori];</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *sf_v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[sf-nst].v;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;               {</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;                  nbr_v[perm[j]] = sf_v[j];</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;               }</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;               <span class="comment">// get the orientation of nbr_v w.r.t. the local face</span></div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;               nbr_ori = <a class="code" href="classmfem_1_1Mesh.html#a1e1467c385205e8958089ae090156c9d">GetQuadOrientation</a>(lf_v, nbr_v);</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;            }</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            info = 64*(info/64) + nbr_ori;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;         }</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;         face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#a5fca9e45068918fbd498a1ab08eaf54d">Elem2Inf</a> = info;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      }</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;   }</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;   MPI_Waitall(num_face_nbrs, send_requests, statuses);</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;   <span class="comment">// allocate the face_nbr_vertices</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>.SetSize(<a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[num_face_nbrs]);</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;   <span class="keyword">delete</span> [] nbr_data;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;   <span class="keyword">delete</span> [] statuses;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;   <span class="keyword">delete</span> [] requests;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;}</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;</div><div class="line"><a name="l02601"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a7a2c02dd7f2fa28aa27324cc81135115"> 2601</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a7a2c02dd7f2fa28aa27324cc81135115">ParMesh::ExchangeFaceNbrNodes</a>()</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;{</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a>)</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;   {</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57">ExchangeFaceNbrData</a>(); <span class="comment">// calls this method at the end</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;   }</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> == NULL)</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;   {</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">Nonconforming</a>())</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;      {</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;         <span class="comment">// with ParNCMesh we already have the vertices</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      }</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;      <span class="keywordtype">int</span> num_face_nbrs = <a class="code" href="classmfem_1_1ParMesh.html#abf6535dc3e248ed140783593bc802e85">GetNFaceNeighbors</a>();</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;      <span class="keywordflow">if</span> (!num_face_nbrs) { <span class="keywordflow">return</span>; }</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;      MPI_Request *requests = <span class="keyword">new</span> MPI_Request[2*num_face_nbrs];</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;      MPI_Request *send_requests = requests;</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      MPI_Request *recv_requests = requests + num_face_nbrs;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      MPI_Status  *statuses = <span class="keyword">new</span> MPI_Status[num_face_nbrs];</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      <span class="comment">// allocate buffer and copy the vertices to be sent</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Vertex&gt;</a> send_vertices(<a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; send_vertices.Size(); i++)</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;      {</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;         send_vertices[i] = <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[<a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[i]];</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;      }</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;      <span class="comment">// send and receive the vertices</span></div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fn = 0; fn &lt; num_face_nbrs; fn++)</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      {</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;         <span class="keywordtype">int</span> nbr_rank = <a class="code" href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950">GetFaceNbrRank</a>(fn);</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;         <span class="keywordtype">int</span> tag = 0;</div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;         MPI_Isend(send_vertices[<a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[fn]](),</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                   3*<a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(fn),</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                   MPI_DOUBLE, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;send_requests[fn]);</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;         MPI_Irecv(<a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>[<a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[fn]](),</div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                   3*(<a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[fn+1] -</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;                      <a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>[fn]),</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;                   MPI_DOUBLE, nbr_rank, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;recv_requests[fn]);</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      }</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      MPI_Waitall(num_face_nbrs, recv_requests, statuses);</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;      MPI_Waitall(num_face_nbrs, send_requests, statuses);</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;      <span class="keyword">delete</span> [] statuses;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      <span class="keyword">delete</span> [] requests;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;   }</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;   {</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *pNodes = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *<span class="keyword">&gt;</span>(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      MFEM_VERIFY(pNodes != NULL, <span class="stringliteral">&quot;Nodes are not ParGridFunction!&quot;</span>);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      pNodes-&gt;<a class="code" href="classmfem_1_1ParGridFunction.html#a01393a296330e148763a0812d40fc048">ExchangeFaceNbrData</a>();</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   }</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;}</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div><div class="line"><a name="l02661"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ad98e0ee2b8f5406d15161492c9d186f4"> 2661</a></span>&#160;<a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *<a class="code" href="classmfem_1_1ParMesh.html#ad98e0ee2b8f5406d15161492c9d186f4">ParMesh::GetSharedFacesTable</a>()</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;{</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;   <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *sfaces_tbl = <span class="keyword">new</span> <a class="code" href="classmfem_1_1STable3D.html">STable3D</a>(<a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>.Size());</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>.Size(); i++)</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   {</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[i]-&gt;GetType())</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      {</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">Element::TETRAHEDRON</a>:</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;         {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            {</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TETRAHEDRON_01_4.html#a31427df70ce8e93401c7771596fc752d">tet_t::FaceVert</a>[j];</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;               sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2e89a4660cf9259b9d08303777105885">Push</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            }</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;         }</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a86662b7597025697ecc376394b7e4434">Element::WEDGE</a>:</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;         {</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            {</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PRISM_01_4.html#a11d85406c1e761ca4f3cc7c83d44a282">pri_t::FaceVert</a>[j];</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;               sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2e89a4660cf9259b9d08303777105885">Push</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            }</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 2; j &lt; 5; j++)</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;            {</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PRISM_01_4.html#a11d85406c1e761ca4f3cc7c83d44a282">pri_t::FaceVert</a>[j];</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;               sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a6033441aea5f8f755d658736f8a36059">Push4</a>(v[fv[0]], v[fv[1]], v[fv[2]], v[fv[3]]);</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            }</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;         }</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a74b0da998b807440e7c39b983e28edee">Element::PYRAMID</a>:</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;         {</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 1; j++)</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;            {</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PYRAMID_01_4.html#aeec94acc6b3b1594da8e25b1c50e68c5">pyr_t::FaceVert</a>[j];</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;               sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a6033441aea5f8f755d658736f8a36059">Push4</a>(v[fv[0]], v[fv[1]], v[fv[2]], v[fv[3]]);</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            }</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; 5; j++)</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;            {</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PYRAMID_01_4.html#aeec94acc6b3b1594da8e25b1c50e68c5">pyr_t::FaceVert</a>[j];</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;               sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2e89a4660cf9259b9d08303777105885">Push</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;            }</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;         }</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a56670b7e34dd8ed02029799ee21619b7">Element::HEXAHEDRON</a>:</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;         {</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            <span class="comment">// find the face by the vertices with the smallest 3 numbers</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;            <span class="comment">// z = 0, y = 0, x = 1, y = 1, x = 0, z = 1</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 6; j++)</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;            {</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1CUBE_01_4.html#a78982d92509f51af3eb559d11e87039f">hex_t::FaceVert</a>[j];</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;               sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a6033441aea5f8f755d658736f8a36059">Push4</a>(v[fv[0]], v[fv[1]], v[fv[2]], v[fv[3]]);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;            }</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;         }</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;            MFEM_ABORT(<span class="stringliteral">&quot;Unexpected type of Element.&quot;</span>);</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      }</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;   }</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;   <span class="keywordflow">return</span> sfaces_tbl;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;}</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;</div><div class="line"><a name="l02724"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a5af643a8b550ef249d39f2c7452e3b87"> 2724</a></span>&#160;<a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *<a class="code" href="classmfem_1_1ParMesh.html#a5af643a8b550ef249d39f2c7452e3b87">ParMesh::GetFaceNbrElementToFaceTable</a>(<span class="keywordtype">int</span> ret_ftbl)</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;{</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;   <span class="keywordtype">int</span> i, *v;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;   <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> * faces_tbl = <a class="code" href="classmfem_1_1Mesh.html#ad5510bac66ddadc6eb5c920c7d74684e">GetFacesTable</a>();</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;   <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> * sfaces_tbl = <a class="code" href="classmfem_1_1ParMesh.html#ad98e0ee2b8f5406d15161492c9d186f4">GetSharedFacesTable</a>();</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a> != NULL)</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;   {</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      <span class="keyword">delete</span> <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;   }</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a> = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Table.html">Table</a>(<a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>.Size(), 6);</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>.Size(); i++)</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;   {</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;      v = <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[i]-&gt;GetType())</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      {</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">Element::TETRAHEDRON</a>:</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;         {</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            {</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TETRAHEDRON_01_4.html#a31427df70ce8e93401c7771596fc752d">tet_t::FaceVert</a>[j];</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;               <span class="keywordtype">int</span> lf = faces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;               <span class="keywordflow">if</span> (lf &lt; 0)</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;               {</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                  lf = sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                  <span class="keywordflow">if</span> (lf &gt;= 0)</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                  {</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                     lf += <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a>;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                  }</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;               }</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">Push</a>(i, lf);</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            }</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;         }</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a86662b7597025697ecc376394b7e4434">Element::WEDGE</a>:</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;         {</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;            {</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PRISM_01_4.html#a11d85406c1e761ca4f3cc7c83d44a282">pri_t::FaceVert</a>[j];</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;               <span class="keywordtype">int</span> lf = faces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;               <span class="keywordflow">if</span> (lf &lt; 0)</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;               {</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                  lf = sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                  <span class="keywordflow">if</span> (lf &gt;= 0)</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                  {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                     lf += <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a>;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                  }</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;               }</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">Push</a>(i, lf);</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;            }</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 2; j &lt; 5; j++)</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;            {</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PRISM_01_4.html#a11d85406c1e761ca4f3cc7c83d44a282">pri_t::FaceVert</a>[j];</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;               <span class="keywordtype">int</span> k = 0;</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;               <span class="keywordtype">int</span> max = v[fv[0]];</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[1]]) { max = v[fv[1]], k = 1; }</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[2]]) { max = v[fv[2]], k = 2; }</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[3]]) { k = 3; }</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;               <span class="keywordtype">int</span> v0 = -1, v1 = -1, v2 = -1;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;               <span class="keywordflow">switch</span> (k)</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;               {</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                  <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                     v0 = v[fv[1]]; v1 = v[fv[2]]; v2 = v[fv[3]];</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[2]]; v2 = v[fv[3]];</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[1]]; v2 = v[fv[3]];</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                  <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[1]]; v2 = v[fv[2]];</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;               }</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;               <span class="keywordtype">int</span> lf = faces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v0, v1, v2);</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;               <span class="keywordflow">if</span> (lf &lt; 0)</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;               {</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                  lf = sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v0, v1, v2);</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                  <span class="keywordflow">if</span> (lf &gt;= 0)</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                  {</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                     lf += <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a>;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                  }</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;               }</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">Push</a>(i, lf);</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            }</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;         }</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a74b0da998b807440e7c39b983e28edee">Element::PYRAMID</a>:</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;         {</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 1; j++)</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;            {</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PYRAMID_01_4.html#aeec94acc6b3b1594da8e25b1c50e68c5">pyr_t::FaceVert</a>[j];</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;               <span class="keywordtype">int</span> k = 0;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;               <span class="keywordtype">int</span> max = v[fv[0]];</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[1]]) { max = v[fv[1]], k = 1; }</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[2]]) { max = v[fv[2]], k = 2; }</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[3]]) { k = 3; }</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;               <span class="keywordtype">int</span> v0 = -1, v1 = -1, v2 = -1;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;               <span class="keywordflow">switch</span> (k)</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;               {</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                  <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                     v0 = v[fv[1]]; v1 = v[fv[2]]; v2 = v[fv[3]];</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[2]]; v2 = v[fv[3]];</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[1]]; v2 = v[fv[3]];</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                  <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[1]]; v2 = v[fv[2]];</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;               }</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;               <span class="keywordtype">int</span> lf = faces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v0, v1, v2);</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;               <span class="keywordflow">if</span> (lf &lt; 0)</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;               {</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                  lf = sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v0, v1, v2);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                  <span class="keywordflow">if</span> (lf &gt;= 0)</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                  {</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                     lf += <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a>;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                  }</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;               }</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">Push</a>(i, lf);</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;            }</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; 5; j++)</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;            {</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PYRAMID_01_4.html#aeec94acc6b3b1594da8e25b1c50e68c5">pyr_t::FaceVert</a>[j];</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;               <span class="keywordtype">int</span> lf = faces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;               <span class="keywordflow">if</span> (lf &lt; 0)</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;               {</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;                  lf = sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v[fv[0]], v[fv[1]], v[fv[2]]);</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;                  <span class="keywordflow">if</span> (lf &gt;= 0)</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                  {</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                     lf += <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a>;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                  }</div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;               }</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">Push</a>(i, lf);</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;            }</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;         }</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;         <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a56670b7e34dd8ed02029799ee21619b7">Element::HEXAHEDRON</a>:</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;         {</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;            <span class="comment">// find the face by the vertices with the smallest 3 numbers</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;            <span class="comment">// z = 0, y = 0, x = 1, y = 1, x = 0, z = 1</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 6; j++)</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;            {</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = <a class="code" href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1CUBE_01_4.html#a78982d92509f51af3eb559d11e87039f">hex_t::FaceVert</a>[j];</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;               <span class="keywordtype">int</span> k = 0;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;               <span class="keywordtype">int</span> max = v[fv[0]];</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[1]]) { max = v[fv[1]], k = 1; }</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[2]]) { max = v[fv[2]], k = 2; }</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;               <span class="keywordflow">if</span> (max &lt; v[fv[3]]) { k = 3; }</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;               <span class="keywordtype">int</span> v0 = -1, v1 = -1, v2 = -1;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;               <span class="keywordflow">switch</span> (k)</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;               {</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                  <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                     v0 = v[fv[1]]; v1 = v[fv[2]]; v2 = v[fv[3]];</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                  <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[2]]; v2 = v[fv[3]];</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                  <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[1]]; v2 = v[fv[3]];</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                  <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;                     v0 = v[fv[0]]; v1 = v[fv[1]]; v2 = v[fv[2]];</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                     <span class="keywordflow">break</span>;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;               }</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;               <span class="keywordtype">int</span> lf = faces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v0, v1, v2);</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;               <span class="keywordflow">if</span> (lf &lt; 0)</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;               {</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                  lf = sfaces_tbl-&gt;<a class="code" href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">Index</a>(v0, v1, v2);</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                  <span class="keywordflow">if</span> (lf &gt;= 0)</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                  {</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                     lf += <a class="code" href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">NumOfFaces</a>;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                  }</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;               }</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">Push</a>(i, lf);</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;            }</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;         }</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;            MFEM_ABORT(<span class="stringliteral">&quot;Unexpected type of Element.&quot;</span>);</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;      }</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;   }</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a97d6d380f8416ddbfb5187238a5a8f46">Finalize</a>();</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;   <span class="keyword">delete</span> sfaces_tbl;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;   <span class="keywordflow">if</span> (ret_ftbl)</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;   {</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      <span class="keywordflow">return</span> faces_tbl;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;   }</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;   <span class="keyword">delete</span> faces_tbl;</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;   <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;}</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div><div class="line"><a name="l02926"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950"> 2926</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950">ParMesh::GetFaceNbrRank</a>(<span class="keywordtype">int</span> fn)<span class="keyword"> const</span></div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a2241de10a34775973f8d6a11e58121e7">Conforming</a>())</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;   {</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      <span class="keywordtype">int</span> nbr_group = <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>[fn];</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *nbs = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">GetGroup</a>(nbr_group);</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <span class="keywordtype">int</span> nbr_lproc = (nbs[0]) ? nbs[0] : nbs[1];</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      <span class="keywordtype">int</span> nbr_rank = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbr_lproc);</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;      <span class="keywordflow">return</span> nbr_rank;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;   }</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;   {</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;      <span class="comment">// NC: simplified handling of face neighbor ranks</span></div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>[fn];</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   }</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;}</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02944"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ac071c7196b5fc38ca3a0edd9b8c28b98"> 2944</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#ac071c7196b5fc38ca3a0edd9b8c28b98">ParMesh::GetFaceNbrElementFaces</a>(<span class="keywordtype">int</span> i, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;fcs, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;cor)<span class="keyword"> const</span></div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;   <span class="keywordtype">int</span> n, j;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;   <span class="keywordtype">int</span> el_nbr = i - <a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>();</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>)</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;   {</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>-&gt;<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(el_nbr, fcs);</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;   }</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;   {</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;ParMesh::GetFaceNbrElementFaces(...) : &quot;</span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                 <span class="stringliteral">&quot;face_nbr_el_to_face not generated.&quot;</span>);</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;   }</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;   <span class="keywordflow">if</span> (el_nbr &lt; <a class="code" href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">face_nbr_el_ori</a>.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>())</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;   {</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> * row = <a class="code" href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">face_nbr_el_ori</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(el_nbr);</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      n = fcs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      cor.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(n);</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      <span class="keywordflow">for</span> (j=0; j&lt;n; j++)</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;      {</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;         cor[j] = row[j];</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      }</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;   }</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;   {</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;ParMesh::GetFaceNbrElementFaces(...) : &quot;</span></div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                 <span class="stringliteral">&quot;face_nbr_el_to_face not generated.&quot;</span>);</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;   }</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;}</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div><div class="line"><a name="l02974"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a39f2450e96b22aa272e07b0583f7b49b"> 2974</a></span>&#160;<a class="code" href="classmfem_1_1Table.html">Table</a> *<a class="code" href="classmfem_1_1ParMesh.html#a39f2450e96b22aa272e07b0583f7b49b">ParMesh::GetFaceToAllElementTable</a>()<span class="keyword"> const</span></div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> *s2l_face;</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1)</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   {</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      s2l_face = &amp;<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   }</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   {</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      s2l_face = &amp;<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;   }</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;   {</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      s2l_face = &amp;<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>;</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;   }</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> *face_elem = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Table.html">Table</a>;</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;   face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>(<a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>.Size());</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>.Size(); i++)</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;   {</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[i].Elem2No &gt;= 0)</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      {</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;         face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(i, 2);</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      }</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      {</div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;         face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>(i);</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      }</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;   }</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s2l_face-&gt;<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;   {</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;      face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">AddAColumnInRow</a>((*s2l_face)[i]);</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;   }</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;   face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>.Size(); i++)</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;   {</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(i, <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[i].Elem1No);</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[i].Elem2No &gt;= 0)</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      {</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;         face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(i, <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[i].Elem2No);</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      }</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;   }</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s2l_face-&gt;<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;   {</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      <span class="keywordtype">int</span> lface = (*s2l_face)[i];</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <span class="keywordtype">int</span> nbr_elem_idx = -1 - <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[lface].Elem2No;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(lface, <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> + nbr_elem_idx);</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   }</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   face_elem-&gt;<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;   <span class="keywordflow">return</span> face_elem;</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;}</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;</div><div class="line"><a name="l03032"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a57d29bf3cd15d1796cb8c78d5805c2c5"> 3032</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a57d29bf3cd15d1796cb8c78d5805c2c5">ParMesh::GetGhostFaceTransformation</a>(</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;   <a class="code" href="classmfem_1_1FaceElementTransformations.html">FaceElementTransformations</a>* FETr, <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78">Element::Type</a> face_type,</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;   <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> face_geom)</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;{</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   <span class="comment">// calculate composition of FETr-&gt;Loc1 and FETr-&gt;Elem1</span></div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;   <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;face_pm = FETr-&gt;<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a45164c2e229ec45a83f50a50dd80302e">GetPointMat</a>();</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;   FETr-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#ae5ce116fc288a679459e369af376e435">Reset</a>();</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> == NULL)</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;   {</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      FETr-&gt;<a class="code" href="classmfem_1_1FaceElementTransformations.html#a1c8e3135e68653fdca63cca2ad0332d9">Elem1</a>-&gt;<a class="code" href="classmfem_1_1ElementTransformation.html#ac5bf9371c58dac27dda644e11b18a47c">Transform</a>(FETr-&gt;<a class="code" href="classmfem_1_1FaceElementTransformations.html#a58930273cc132a70cfc9ae53c51dcc57">Loc1</a>.<a class="code" href="classmfem_1_1IntegrationPointTransformation.html#a1f5f75fc449ee465ec9e00b6de3d0c16">Transf</a>.<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a45164c2e229ec45a83f50a50dd80302e">GetPointMat</a>(), face_pm);</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      FETr-&gt;<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a156708114d0bfeb6e9aadc664ad68d2c">SetFE</a>(<a class="code" href="classmfem_1_1Mesh.html#a1d2e8f696ea28c4ed0dc738de6bcd009">GetTransformationFEforElementType</a>(face_type));</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;   }</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;   {</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1FiniteElement.html">FiniteElement</a>* face_el =</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>()-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#aae2ff639412b9ec63aa0fd413cd1451b">GetTraceElement</a>(FETr-&gt;<a class="code" href="classmfem_1_1FaceElementTransformations.html#a02e05e5a2d85cec35abe19211ae272c2">Elem1No</a>, face_geom);</div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;      MFEM_VERIFY(dynamic_cast&lt;const NodalFiniteElement*&gt;(face_el),</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;                  <span class="stringliteral">&quot;Mesh requires nodal Finite Element.&quot;</span>);</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="preprocessor">#if 0 // TODO: handle the case of non-interpolatory Nodes</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> I;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;      face_el-&gt;<a class="code" href="classmfem_1_1FiniteElement.html#ac4548a4548b814f37dbc49a763625dc6">Project</a>(<a class="code" href="classmfem_1_1Mesh.html#a88925817d4e35a8386f460a896d560ff">Transformation</a>.<a class="code" href="classmfem_1_1IsoparametricTransformation.html#af8ae8afa0ba1d6f17e0d74a786133fb8">GetFE</a>(), FETr-&gt;<a class="code" href="classmfem_1_1FaceElementTransformations.html#a58930273cc132a70cfc9ae53c51dcc57">Loc1</a>.<a class="code" href="classmfem_1_1IntegrationPointTransformation.html#a1f5f75fc449ee465ec9e00b6de3d0c16">Transf</a>, I);</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;      <a class="code" href="namespacemfem.html#a4b575e50e0676000389d0fa6129eaa79">MultABt</a>(<a class="code" href="classmfem_1_1Mesh.html#a88925817d4e35a8386f460a896d560ff">Transformation</a>.<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a45164c2e229ec45a83f50a50dd80302e">GetPointMat</a>(), I, pm_face);</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      <a class="code" href="classmfem_1_1IntegrationRule.html">IntegrationRule</a> eir(face_el-&gt;<a class="code" href="classmfem_1_1FiniteElement.html#af4408ffc73146fc6bf710bd95ddc682c">GetDof</a>());</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      FETr-&gt;<a class="code" href="classmfem_1_1FaceElementTransformations.html#a58930273cc132a70cfc9ae53c51dcc57">Loc1</a>.<a class="code" href="classmfem_1_1IntegrationPointTransformation.html#ad52ff28eba3af4c60a7d56382ba72cc0">Transform</a>(face_el-&gt;<a class="code" href="classmfem_1_1FiniteElement.html#a4e98d9b922030b9ef7379855daa81346">GetNodes</a>(), eir);</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#af29be245d92e79eb31bb1e7dc733db3b">GetVectorValues</a>(*FETr-&gt;<a class="code" href="classmfem_1_1FaceElementTransformations.html#a1c8e3135e68653fdca63cca2ad0332d9">Elem1</a>, eir, face_pm);</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;      FETr-&gt;<a class="code" href="classmfem_1_1IsoparametricTransformation.html#a156708114d0bfeb6e9aadc664ad68d2c">SetFE</a>(face_el);</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;   }</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;}</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div><div class="line"><a name="l03064"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a352923d1f1f80504d6b5c31177b56d57"> 3064</a></span>&#160;<a class="code" href="classmfem_1_1FaceElementTransformations.html">FaceElementTransformations</a> *<a class="code" href="classmfem_1_1ParMesh.html#a352923d1f1f80504d6b5c31177b56d57">ParMesh::GetFaceElementTransformations</a>(</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;   <span class="keywordtype">int</span> FaceNo,</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;   <span class="keywordtype">int</span> mask)</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;{</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;   <span class="keywordflow">if</span> (FaceNo &lt; <a class="code" href="classmfem_1_1Mesh.html#a2249b56c56f685bb6a14b74921e77199">GetNumFaces</a>())</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;   {</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1Mesh.html#a15e10ac10768ad6537bcda1cf1380792">Mesh::GetFaceElementTransformations</a>(FaceNo, mask);</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;   }</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;   {</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> fill2 = mask &amp; 10; <span class="comment">// Elem2 and/or Loc2</span></div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#aa5286b303d8ba9152ed4c8d988ffe2b1">GetSharedFaceTransformationsByLocalIndex</a>(FaceNo, fill2);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;   }</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;}</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;<a class="code" href="classmfem_1_1FaceElementTransformations.html">FaceElementTransformations</a> *<a class="code" href="classmfem_1_1ParMesh.html#ae6f90bec4d091ae5adc160fb74d89ca1">ParMesh::</a></div><div class="line"><a name="l03080"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ae6f90bec4d091ae5adc160fb74d89ca1"> 3080</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#ae6f90bec4d091ae5adc160fb74d89ca1">GetSharedFaceTransformations</a>(<span class="keywordtype">int</span> sf, <span class="keywordtype">bool</span> fill2)</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;{</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;   <span class="keywordtype">int</span> FaceNo = <a class="code" href="classmfem_1_1ParMesh.html#aaf48f81c10f73c0f748c7e55d54d68b1">GetSharedFace</a>(sf);</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#aa5286b303d8ba9152ed4c8d988ffe2b1">GetSharedFaceTransformationsByLocalIndex</a>(FaceNo, fill2);</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;}</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;<a class="code" href="classmfem_1_1FaceElementTransformations.html">FaceElementTransformations</a> *<a class="code" href="classmfem_1_1ParMesh.html#aa5286b303d8ba9152ed4c8d988ffe2b1">ParMesh::</a></div><div class="line"><a name="l03088"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aa5286b303d8ba9152ed4c8d988ffe2b1"> 3088</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#aa5286b303d8ba9152ed4c8d988ffe2b1">GetSharedFaceTransformationsByLocalIndex</a>(<span class="keywordtype">int</span> FaceNo, <span class="keywordtype">bool</span> fill2)</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;{</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;   <a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html">FaceInfo</a> &amp;face_info = <a class="code" href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">faces_info</a>[FaceNo];</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;   MFEM_VERIFY(face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#a5fca9e45068918fbd498a1ab08eaf54d">Elem2Inf</a> &gt;= 0, <span class="stringliteral">&quot;The face must be shared.&quot;</span>);</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;   <span class="keywordtype">bool</span> is_slave = <a class="code" href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">Nonconforming</a>() &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#ac8d355c5b980f33eff621eb3ef0660d3">IsSlaveFace</a>(face_info);</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;   <span class="keywordtype">bool</span> is_ghost = <a class="code" href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">Nonconforming</a>() &amp;&amp; FaceNo &gt;= <a class="code" href="classmfem_1_1Mesh.html#a2249b56c56f685bb6a14b74921e77199">GetNumFaces</a>();</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;   <span class="keywordtype">int</span> mask = 0;</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#aba74c90032cc9cf6621fe8a1bf3630b3">SetConfigurationMask</a>(0);</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a1c8e3135e68653fdca63cca2ad0332d9">Elem1</a> = NULL;</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a0e6638d14519c9856e743713c9a359c6">Elem2</a> = NULL;</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   <a class="code" href="structmfem_1_1Mesh_1_1NCFaceInfo.html">NCFaceInfo</a>* nc_info = NULL;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;   <span class="keywordflow">if</span> (is_slave) { nc_info = &amp;<a class="code" href="classmfem_1_1Mesh.html#a2f2d9df54781b659fd4eb47717ec0dc9">nc_faces_info</a>[face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#aa4799f92980466d991fb36a5e42e65f8">NCFace</a>]; }</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;   <span class="keywordtype">int</span> local_face = is_ghost ? nc_info-&gt;<a class="code" href="structmfem_1_1Mesh_1_1NCFaceInfo.html#ac21072f78c884782721ffff19a498c65">MasterFace</a> : FaceNo;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;   <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78">Element::Type</a>  face_type = <a class="code" href="classmfem_1_1Mesh.html#aab85b892df2a606fb61ec632ccdebad9">GetFaceElementType</a>(local_face);</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;   <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> face_geom = <a class="code" href="classmfem_1_1Mesh.html#a2329c4602cf0477c1b9e9292dd232bd1">GetFaceGeometry</a>(local_face);</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;   <span class="comment">// setup the transformation for the first element</span></div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a02e05e5a2d85cec35abe19211ae272c2">Elem1No</a> = face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#a3e22801bd2ed5fcdf0715ad34d402d17">Elem1No</a>;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a72dd2c8c7e70b3c766b72b25e2bfbb26">GetElementTransformation</a>(<a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a02e05e5a2d85cec35abe19211ae272c2">Elem1No</a>, &amp;<a class="code" href="classmfem_1_1Mesh.html#a88925817d4e35a8386f460a896d560ff">Transformation</a>);</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a1c8e3135e68653fdca63cca2ad0332d9">Elem1</a> = &amp;<a class="code" href="classmfem_1_1Mesh.html#a88925817d4e35a8386f460a896d560ff">Transformation</a>;</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;   mask |= <a class="code" href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8ad1d1ee65e315969caf26f61c7112ca7b">FaceElementTransformations::HAVE_ELEM1</a>;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;   <span class="comment">// setup the transformation for the second (neighbor) element</span></div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;   <span class="keywordtype">int</span> Elem2NbrNo;</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;   <span class="keywordflow">if</span> (fill2)</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;   {</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      Elem2NbrNo = -1 - face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#ae80c204d9f7f651358d2a1b18cbe40ba">Elem2No</a>;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      <span class="comment">// Store the &quot;shifted index&quot; for element 2 in FaceElemTr.Elem2No.</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      <span class="comment">// `Elem2NbrNo` is the index of the face neighbor (starting from 0),</span></div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;      <span class="comment">// and `FaceElemTr.Elem2No` will be offset by the number of (local)</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;      <span class="comment">// elements in the mesh.</span></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a332fc3ffe680e3548a61848774b427f0">Elem2No</a> = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> + Elem2NbrNo;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a95c8bc6cc12e67bd8a952b6bb94a415b">GetFaceNbrElementTransformation</a>(Elem2NbrNo, &amp;<a class="code" href="classmfem_1_1Mesh.html#a098afe9ba26ede737a9745ddf996413f">Transformation2</a>);</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a0e6638d14519c9856e743713c9a359c6">Elem2</a> = &amp;<a class="code" href="classmfem_1_1Mesh.html#a098afe9ba26ede737a9745ddf996413f">Transformation2</a>;</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;      mask |= <a class="code" href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8a698034150b296a90af6201c7d94d6ad4">FaceElementTransformations::HAVE_ELEM2</a>;</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;   }</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;   {</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a332fc3ffe680e3548a61848774b427f0">Elem2No</a> = -1;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;   }</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;   <span class="comment">// setup the face transformation if the face is not a ghost</span></div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;   <span class="keywordflow">if</span> (!is_ghost)</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;   {</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a92591d67739bde9d944e7119be94977b">GetFaceTransformation</a>(FaceNo, &amp;<a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>);</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="comment">// NOTE: The above call overwrites FaceElemTr.Loc1</span></div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      mask |= <a class="code" href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8ad9f62fedff40db5806cd67d37c585c87">FaceElementTransformations::HAVE_FACE</a>;</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;   }</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;   {</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a73c3e95a702f98e015ce3cfd944c2e05">SetGeometryType</a>(face_geom);</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;   }</div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;   <span class="comment">// setup Loc1 &amp; Loc2</span></div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;   <span class="keywordtype">int</span> elem_type = <a class="code" href="classmfem_1_1Mesh.html#a1e4b4686077146cd260acc1f50827047">GetElementType</a>(face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#a3e22801bd2ed5fcdf0715ad34d402d17">Elem1No</a>);</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a90aab9f1f50ab61c9cf98825481ed9ae">GetLocalFaceTransformation</a>(face_type, elem_type, <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#a58930273cc132a70cfc9ae53c51dcc57">Loc1</a>.<a class="code" href="classmfem_1_1IntegrationPointTransformation.html#a1f5f75fc449ee465ec9e00b6de3d0c16">Transf</a>,</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;                              face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#ad37ab9407b139a90c0d49bac23c708be">Elem1Inf</a>);</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   mask |= <a class="code" href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8acce41fac6399beaef5bb4dfe8de2f6d1">FaceElementTransformations::HAVE_LOC1</a>;</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   <span class="keywordflow">if</span> (fill2)</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;   {</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      elem_type = <a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>[Elem2NbrNo]-&gt;GetType();</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a90aab9f1f50ab61c9cf98825481ed9ae">GetLocalFaceTransformation</a>(face_type, elem_type, <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#ac7b1dcce22e1c2bb4509713254db85c9">Loc2</a>.<a class="code" href="classmfem_1_1IntegrationPointTransformation.html#a1f5f75fc449ee465ec9e00b6de3d0c16">Transf</a>,</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                                 face_info.<a class="code" href="structmfem_1_1Mesh_1_1FaceInfo.html#a5fca9e45068918fbd498a1ab08eaf54d">Elem2Inf</a>);</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      mask |= <a class="code" href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8af9926e2869f1a03d78b8a7dee533b13c">FaceElementTransformations::HAVE_LOC2</a>;</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   }</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;   <span class="comment">// adjust Loc1 or Loc2 of the master face if this is a slave face</span></div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   <span class="keywordflow">if</span> (is_slave)</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;   {</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      <span class="keywordflow">if</span> (is_ghost || fill2)</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      {</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;         <span class="comment">// is_ghost -&gt; modify side 1, otherwise -&gt; modify side 2:</span></div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a81129a94d35bb7bf3746e92fc61cdff9">ApplyLocalSlaveTransformation</a>(<a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>, face_info, is_ghost);</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      }</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;   }</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;   <span class="comment">// for ghost faces we need a special version of GetFaceTransformation</span></div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   <span class="keywordflow">if</span> (is_ghost)</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;   {</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a57d29bf3cd15d1796cb8c78d5805c2c5">GetGhostFaceTransformation</a>(&amp;<a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>, face_type, face_geom);</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;      mask |= <a class="code" href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8ad9f62fedff40db5806cd67d37c585c87">FaceElementTransformations::HAVE_FACE</a>;</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;   }</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#aba74c90032cc9cf6621fe8a1bf3630b3">SetConfigurationMask</a>(mask);</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;   <span class="comment">// This check can be useful for internal debugging, however it will fail on</span></div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;   <span class="comment">// periodic boundary faces, so we keep it disabled in general.</span></div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;   <span class="keywordtype">double</span> dist = <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#abed8173071d957c12e662e37129388e2">CheckConsistency</a>();</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;   <span class="keywordflow">if</span> (dist &gt;= 1e-12)</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;   {</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;\nInternal error: face id = &quot;</span> &lt;&lt; FaceNo</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, dist = &quot;</span> &lt;&lt; dist &lt;&lt; <span class="stringliteral">&quot;, rank = &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>.<a class="code" href="classmfem_1_1FaceElementTransformations.html#abed8173071d957c12e662e37129388e2">CheckConsistency</a>(1); <span class="comment">// print coordinates</span></div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;internal error&quot;</span>);</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;   }</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;   <span class="keywordflow">return</span> &amp;<a class="code" href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">FaceElemTr</a>;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;}</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div><div class="line"><a name="l03196"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a203856446d235b6f467592cc84336f3e"> 3196</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#a203856446d235b6f467592cc84336f3e">ParMesh::GetNSharedFaces</a>()<span class="keyword"> const</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a2241de10a34775973f8d6a11e58121e7">Conforming</a>())</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;   {</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>)</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      {</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;         <span class="keywordflow">case</span> 1:  <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;         <span class="keywordflow">case</span> 2:  <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;         <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      }</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;   }</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   {</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCMesh::NCList</a> &amp;shared = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#ad4148905bd3ce26e861a013161acf82d">GetSharedList</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>-1);</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;      <span class="keywordflow">return</span> shared.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>.Size() + shared.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>.Size();</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;   }</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;}</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;</div><div class="line"><a name="l03215"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aaf48f81c10f73c0f748c7e55d54d68b1"> 3215</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#aaf48f81c10f73c0f748c7e55d54d68b1">ParMesh::GetSharedFace</a>(<span class="keywordtype">int</span> sface)<span class="keyword"> const</span></div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a2241de10a34775973f8d6a11e58121e7">Conforming</a>())</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;   {</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>)</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      {</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;         <span class="keywordflow">case</span> 1:  <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[sface];</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;         <span class="keywordflow">case</span> 2:  <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>[sface];</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;         <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>[sface];</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      }</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;   }</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;   {</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCMesh::NCList</a> &amp;shared = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#ad4148905bd3ce26e861a013161acf82d">GetSharedList</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>-1);</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;      <span class="keywordtype">int</span> csize = (int) shared.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>.Size();</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      <span class="keywordflow">return</span> sface &lt; csize</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;             ? shared.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>[sface].index</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;             : shared.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>[sface - csize].index;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;   }</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;}</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;</div><div class="line"><a name="l03237"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a55dc871ae5eba6b843538b8df1b0af4c"> 3237</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#a55dc871ae5eba6b843538b8df1b0af4c">ParMesh::GetNFbyType</a>(<a class="code" href="namespacemfem.html#af736ce0d62a2894982a1eda9dbe93fb7">FaceType</a> type)<span class="keyword"> const</span></div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;   <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code" href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57">ExchangeFaceNbrData</a>();</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1Mesh.html#a4c4ebc6ea67fbb893a819c592adaac01">Mesh::GetNFbyType</a>(type);</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;}</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;<span class="comment">// shift cyclically 3 integers a, b, c, so that the smallest of</span></div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="comment">// order[a], order[b], order[c] is first</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span></div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;<span class="keywordtype">void</span> Rotate3Indirect(<span class="keywordtype">int</span> &amp;<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <span class="keywordtype">int</span> &amp;<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, <span class="keywordtype">int</span> &amp;c,</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;std::int64_t&gt;</a> &amp;order)</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;{</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;   <span class="keywordflow">if</span> (order[<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>] &lt; order[<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>])</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;   {</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      <span class="keywordflow">if</span> (order[<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>] &gt; order[c])</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      {</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;         <a class="code" href="namespacemfem.html#a4d41fc88f57d8f2806f909e35eabd648">ShiftRight</a>(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, c);</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;      }</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;   }</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;   {</div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      <span class="keywordflow">if</span> (order[<a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>] &lt; order[c])</div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      {</div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;         <a class="code" href="namespacemfem.html#a4d41fc88f57d8f2806f909e35eabd648">ShiftRight</a>(c, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>);</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      }</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;      {</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;         <a class="code" href="namespacemfem.html#a4d41fc88f57d8f2806f909e35eabd648">ShiftRight</a>(<a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, c);</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;      }</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;   }</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;}</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;</div><div class="line"><a name="l03269"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a2f7246762acc8d5953d82915a87eded9"> 3269</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a2f7246762acc8d5953d82915a87eded9">ParMesh::ReorientTetMesh</a>()</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;{</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> != 3 || !(<a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> &amp; 1))</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;   {</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;   }</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ab29031fb80d570dc4d7847a14cf78f91">ResetLazyData</a>();</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;   <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> *old_v_to_v = NULL;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> *old_elem_vert = NULL;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;   {</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a631c7ee9a2c9667fbea11bfe15e3effc">PrepareNodeReorder</a>(&amp;old_v_to_v, &amp;old_elem_vert);</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;   }</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;   <span class="comment">// create a GroupCommunicator over shared vertices</span></div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;   <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a> svert_comm(<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>);</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aaeca6483b3628feb94d008f7ea86bad5">GetSharedVertexCommunicator</a>(svert_comm);</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;   <span class="comment">// communicate the local index of each shared vertex from the group master to</span></div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;   <span class="comment">// other ranks in the group</span></div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> svert_master_rank(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> svert_master_index(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>);</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;   {</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;      {</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;         <span class="keywordtype">int</span> rank = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a871cda1b0e0ba0f3a22b1b37d8d1bcfe">GetGroupMasterRank</a>(i+1);</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(i); j++)</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;         {</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            svert_master_rank[<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i)[j]] = rank;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;         }</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      }</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;      svert_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a8330d9ef25733a0488337478ca514035">Bcast</a>(svert_master_index);</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;   }</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;   <span class="comment">// the pairs (master rank, master local index) define a globally consistent</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   <span class="comment">// vertex ordering</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;std::int64_t&gt;</a> glob_vert_order(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Size());</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;   {</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> lvert_svert(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Size());</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      lvert_svert = -1;</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;      {</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;         lvert_svert[<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[i]] = i;</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      }</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Size(); i++)</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      {</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="ncmesh__tables_8hpp.html#aa9bbc8c2be6976cfc6ce9759a9012e39">s</a> = lvert_svert[i];</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="ncmesh__tables_8hpp.html#aa9bbc8c2be6976cfc6ce9759a9012e39">s</a> &gt;= 0)</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;         {</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;            glob_vert_order[i] =</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;               (std::int64_t(svert_master_rank[<a class="code" href="ncmesh__tables_8hpp.html#aa9bbc8c2be6976cfc6ce9759a9012e39">s</a>]) &lt;&lt; 32) + svert_master_index[<a class="code" href="ncmesh__tables_8hpp.html#aa9bbc8c2be6976cfc6ce9759a9012e39">s</a>];</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;         }</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;         {</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;            glob_vert_order[i] = (std::int64_t(<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>) &lt;&lt; 32) + i;</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;         }</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;      }</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;   }</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;   <span class="comment">// rotate tetrahedra so that vertex zero is the lowest (global) index vertex,</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;   <span class="comment">// vertex 1 is the second lowest (global) index and vertices 2 and 3 preserve</span></div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;   <span class="comment">// positive orientation of the element</span></div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;   {</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a1e4b4686077146cd260acc1f50827047">GetElementType</a>(i) == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">Element::TETRAHEDRON</a>)</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      {</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;         Rotate3Indirect(v[0], v[1], v[2], glob_vert_order);</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;         <span class="keywordflow">if</span> (glob_vert_order[v[0]] &lt; glob_vert_order[v[3]])</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;         {</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;            Rotate3Indirect(v[1], v[2], v[3], glob_vert_order);</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;         }</div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;         {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;            <a class="code" href="namespacemfem.html#a4d41fc88f57d8f2806f909e35eabd648">ShiftRight</a>(v[0], v[1], v[3]);</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;         }</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      }</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;   }</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;   <span class="comment">// rotate also boundary triangles</span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;   {</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a21772d74bd053829dca52a0394d0e49e">GetBdrElementType</a>(i) == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>)</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;      {</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;         Rotate3Indirect(v[0], v[1], v[2], glob_vert_order);</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      }</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   }</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> check_consistency = <span class="keyword">true</span>;</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;   <span class="keywordflow">if</span> (check_consistency)</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;   {</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      <span class="comment">// create a GroupCommunicator on the shared triangles</span></div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      <a class="code" href="classmfem_1_1GroupCommunicator.html">GroupCommunicator</a> stria_comm(<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>);</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;      {</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;         <span class="comment">// initialize stria_comm</span></div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;         <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;gr_stria = stria_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a5a01c4355d94a68dc6623c50d1f8fc4b">GroupLDofTable</a>();</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;         <span class="comment">// gr_stria differs from group_stria - the latter does not store gr. 0</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;         gr_stria.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(), <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size());</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;         gr_stria.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[0] = 0;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt;= <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;         {</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;            gr_stria.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr] = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>()[gr-1];</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;         }</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); k++)</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;         {</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;            gr_stria.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k] = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[k];</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;         }</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;         stria_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#ae49365321f5af65337d7fe5c2b69c19d">Finalize</a>();</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;      }</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> stria_flag(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size());</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; stria_flag.Size(); i++)</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      {</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;         <span class="keywordflow">if</span> (glob_vert_order[v[0]] &lt; glob_vert_order[v[1]])</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;         {</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            stria_flag[i] = (glob_vert_order[v[0]] &lt; glob_vert_order[v[2]]) ? 0 : 2;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;         }</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;         <span class="keywordflow">else</span> <span class="comment">// v[1] &lt; v[0]</span></div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;         {</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            stria_flag[i] = (glob_vert_order[v[1]] &lt; glob_vert_order[v[2]]) ? 1 : 2;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;         }</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      }</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> stria_master_flag(stria_flag);</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;      stria_comm.<a class="code" href="classmfem_1_1GroupCommunicator.html#a8330d9ef25733a0488337478ca514035">Bcast</a>(stria_master_flag);</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; stria_flag.Size(); i++)</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      {</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v;</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;         MFEM_VERIFY(stria_flag[i] == stria_master_flag[i],</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                     <span class="stringliteral">&quot;inconsistent vertex ordering found, shared triangle &quot;</span></div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;                     &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;: (&quot;</span></div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                     &lt;&lt; v[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; v[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; v[2] &lt;&lt; <span class="stringliteral">&quot;), &quot;</span></div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;local flag: &quot;</span> &lt;&lt; stria_flag[i]</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;, master flag: &quot;</span> &lt;&lt; stria_master_flag[i]);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      }</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;   }</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;   <span class="comment">// rotate shared triangle faces</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); i++)</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;   {</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;      <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;      Rotate3Indirect(v[0], v[1], v[2], glob_vert_order);</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;   }</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;   <span class="comment">// finalize</span></div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;   {</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a81e17bd07601b5f66821dbe21ba3652c">GetElementToFaceTable</a>();</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a4784444c57c21808869bcaed6e6bcf50">GenerateFaces</a>();</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a>)</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      {</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">NumOfEdges</a> = <a class="code" href="classmfem_1_1Mesh.html#a4f62eb3ede00bc8dc5de42baa366cab4">GetElementToEdgeTable</a>(*<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a>, <a class="code" href="classmfem_1_1Mesh.html#a27b274dcab25a4606c9995f5d1607ff8">be_to_edge</a>);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      }</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;   }</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;   {</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a3fb722340f1daf32abdc1aa4c716466a">DoNodeReorder</a>(old_v_to_v, old_elem_vert);</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;      <span class="keyword">delete</span> old_elem_vert;</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;      <span class="keyword">delete</span> old_v_to_v;</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;   }</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;   <span class="comment">// the local edge and face numbering is changed therefore we need to</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   <span class="comment">// update sedge_ledge and sface_lface.</span></div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;}</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;</div><div class="line"><a name="l03444"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a5c56c658bfeeed21914278e38cbb3a8f"> 3444</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a5c56c658bfeeed21914278e38cbb3a8f">ParMesh::LocalRefinement</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;marked_el, <span class="keywordtype">int</span> type)</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;{</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>)</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;   {</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Local and nonconforming refinements cannot be mixed.&quot;</span>);</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;   }</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#af4a17aac29f1b53d82433b6a76e7145c">InitRefinementTransforms</a>();</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;   {</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;      <span class="keywordtype">int</span> uniform_refinement = 0;</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;      <span class="keywordflow">if</span> (type &lt; 0)</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      {</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;         type = -type;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;         uniform_refinement = 1;</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;      }</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;      <span class="comment">// 1. Hash table of vertex to vertex connections corresponding to refined</span></div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;      <span class="comment">//    edges.</span></div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;      <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Hashed2&gt;</a> v_to_v;</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;      <span class="comment">// 2. Do the red refinement.</span></div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;      <span class="keywordflow">switch</span> (type)</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;      {</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;         <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;            {</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(marked_el[i], v_to_v);</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;            }</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;         <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            {</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(marked_el[i], v_to_v);</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> - 1, v_to_v);</div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(marked_el[i], v_to_v);</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            }</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;         <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            {</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(marked_el[i], v_to_v);</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;               <span class="keywordtype">int</span> j = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> - 1;</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(j, v_to_v);</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> - 1, v_to_v);</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(j, v_to_v);</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(marked_el[i], v_to_v);</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>-1, v_to_v);</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(marked_el[i], v_to_v);</div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;            }</div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;      }</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;      <span class="comment">// 3. Do the green refinement (to get conforming mesh).</span></div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;      <span class="keywordtype">int</span> need_refinement;</div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;      <span class="keywordtype">int</span> max_faces_in_group = 0;</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;      <span class="comment">// face_splittings identify how the shared faces have been split</span></div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;unsigned&gt;</a> *face_splittings = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;unsigned&gt;</a>[<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1];</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;      {</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> faces_in_group = <a class="code" href="classmfem_1_1ParMesh.html#aae348d99498be7174b05eebebf31a68b">GroupNTriangles</a>(i+1);</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;         face_splittings[i].<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(faces_in_group);</div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;         <span class="keywordflow">if</span> (faces_in_group &gt; max_faces_in_group)</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;         {</div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            max_faces_in_group = faces_in_group;</div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;         }</div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      }</div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      <span class="keywordtype">int</span> neighbor;</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;unsigned&gt;</a> iBuf(max_faces_in_group);</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;      MPI_Request *requests = <span class="keyword">new</span> MPI_Request[<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1];</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;      MPI_Status  status;</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;      <span class="keywordtype">int</span> ref_loops_all = 0, ref_loops_par = 0;</div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;      {</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;         need_refinement = 0;</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;         {</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;NeedRefinement(v_to_v))</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;            {</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;               need_refinement = 1;</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">Bisection</a>(i, v_to_v);</div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;            }</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;         }</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;         ref_loops_all++;</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;         <span class="keywordflow">if</span> (uniform_refinement)</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;         {</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;         }</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;         <span class="comment">// if the mesh is locally conforming start making it globally</span></div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;         <span class="comment">// conforming</span></div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;         <span class="keywordflow">if</span> (need_refinement == 0)</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;         {</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;            ref_loops_par++;</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;            <span class="comment">// MPI_Barrier(MyComm);</span></div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> tag = 293;</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            <span class="comment">// (a) send the type of interface splitting</span></div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;            <span class="keywordtype">int</span> req_count = 0;</div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            {</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *group_faces = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i);</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> faces_in_group = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(i);</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;               <span class="comment">// it is enough to communicate through the faces</span></div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;               <span class="keywordflow">if</span> (faces_in_group == 0) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;</div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;               face_splittings[i].<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; faces_in_group; j++)</div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;               {</div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                  <a class="code" href="classmfem_1_1ParMesh.html#a05b6a0ccfbc7fce09cf66b3c1b781d65">GetFaceSplittings</a>(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[group_faces[j]].v, v_to_v,</div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;                                    face_splittings[i]);</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;               }</div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *nbs = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">GetGroup</a>(i+1);</div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;               neighbor = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbs[0] ? nbs[0] : nbs[1]);</div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;               MPI_Isend(face_splittings[i], face_splittings[i].Size(),</div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                         MPI_UNSIGNED, neighbor, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>,</div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                         &amp;requests[req_count++]);</div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            }</div><div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;            <span class="comment">// (b) receive the type of interface splitting</span></div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            {</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *group_faces = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i);</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> faces_in_group = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(i);</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;               <span class="keywordflow">if</span> (faces_in_group == 0) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">int</span> *nbs = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">GetGroup</a>(i+1);</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;               neighbor = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbs[0] ? nbs[0] : nbs[1]);</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;               MPI_Probe(neighbor, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;               <span class="keywordtype">int</span> count;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;               MPI_Get_count(&amp;status, MPI_UNSIGNED, &amp;count);</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;               iBuf.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(count);</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;               MPI_Recv(iBuf, count, MPI_UNSIGNED, neighbor, tag, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>,</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                        MPI_STATUS_IGNORE);</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0, pos = 0; j &lt; faces_in_group; j++)</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;               {</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[group_faces[j]].v;</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                  need_refinement |= <a class="code" href="classmfem_1_1ParMesh.html#a9079e68a3e311bef9d312a464d1c385a">DecodeFaceSplittings</a>(v_to_v, v, iBuf, pos);</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;               }</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;            }</div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;</div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            <span class="keywordtype">int</span> nr = need_refinement;</div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            MPI_Allreduce(&amp;nr, &amp;need_refinement, 1, MPI_INT, MPI_LOR, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;</div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;            MPI_Waitall(req_count, requests, MPI_STATUSES_IGNORE);</div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;         }</div><div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      }</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;      <span class="keywordflow">while</span> (need_refinement == 1);</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;      {</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;         <span class="keywordtype">int</span> i = ref_loops_all;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;         MPI_Reduce(&amp;i, &amp;ref_loops_all, 1, MPI_INT, MPI_MAX, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;         {</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;            <a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;\n\nParMesh::LocalRefinement : max. ref_loops_all = &quot;</span></div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                      &lt;&lt; ref_loops_all &lt;&lt; <span class="stringliteral">&quot;, ref_loops_par = &quot;</span> &lt;&lt; ref_loops_par</div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                      &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; endl;</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;         }</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      }</div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;      <span class="keyword">delete</span> [] requests;</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      iBuf.<a class="code" href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">DeleteAll</a>();</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <span class="keyword">delete</span> [] face_splittings;</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;</div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <span class="comment">// 4. Update the boundary elements.</span></div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      {</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;         need_refinement = 0;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;         {</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;NeedRefinement(v_to_v))</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;            {</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;               need_refinement = 1;</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#a21233b713496e559a61361a7fbfe16b5">BdrBisection</a>(i, v_to_v);</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;            }</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;         }</div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;      }</div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;      <span class="keywordflow">while</span> (need_refinement == 1);</div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;</div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> != <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.Size())</div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;      {</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;         <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;ParMesh::LocalRefinement :&quot;</span></div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;                    <span class="stringliteral">&quot; (NumOfBdrElements != boundary.Size())&quot;</span>);</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      }</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ab29031fb80d570dc4d7847a14cf78f91">ResetLazyData</a>();</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> old_nv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> = <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Size();</div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a1a778ec440848d25becb69798b48e781">RefineGroups</a>(old_nv, v_to_v);</div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <span class="comment">// 5. Update the groups after refinement.</span></div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a6901d57cf77f50497a6741d77f10f062">el_to_face</a> != NULL)</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      {</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a81e17bd07601b5f66821dbe21ba3652c">GetElementToFaceTable</a>();</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a4784444c57c21808869bcaed6e6bcf50">GenerateFaces</a>();</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;      }</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;      <span class="comment">// 6. Update element-to-edge relations.</span></div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a> != NULL)</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      {</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">NumOfEdges</a> = <a class="code" href="classmfem_1_1Mesh.html#a4f62eb3ede00bc8dc5de42baa366cab4">GetElementToEdgeTable</a>(*<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a>, <a class="code" href="classmfem_1_1Mesh.html#a27b274dcab25a4606c9995f5d1607ff8">be_to_edge</a>);</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;      }</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;   } <span class="comment">//  &#39;if (Dim == 3)&#39;</span></div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;</div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;   {</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;      <span class="keywordtype">int</span> uniform_refinement = 0;</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      <span class="keywordflow">if</span> (type &lt; 0)</div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      {</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;         <span class="comment">// type = -type; // not used</span></div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;         uniform_refinement = 1;</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;      }</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      <span class="comment">// 1. Get table of vertex to vertex connections.</span></div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;      <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> v_to_v(<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ae6d959a7cd2b26c570831111e2f0d80e">GetVertexToVertexTable</a>(v_to_v);</div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;      <span class="comment">// 2. Get edge to element connections in arrays edge1 and edge2</span></div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;      <span class="keywordtype">int</span> nedges  = v_to_v.<a class="code" href="classmfem_1_1DSTable.html#a18868aa35ecd8c7800f5e6258ce40a79">NumberOfEntries</a>();</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;      <span class="keywordtype">int</span> *edge1  = <span class="keyword">new</span> <span class="keywordtype">int</span>[nedges];</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;      <span class="keywordtype">int</span> *edge2  = <span class="keyword">new</span> <span class="keywordtype">int</span>[nedges];</div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      <span class="keywordtype">int</span> *middle = <span class="keyword">new</span> <span class="keywordtype">int</span>[nedges];</div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nedges; i++)</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;      {</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;         edge1[i] = edge2[i] = middle[i] = -1;</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;      }</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;</div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;      {</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++)</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;         {</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;            <span class="keywordtype">int</span> ind = v_to_v(v[j], v[(j+1)%3]);</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;            (edge1[ind] == -1) ? (edge1[ind] = i) : (edge2[ind] = i);</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;         }</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;      }</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;</div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      <span class="comment">// 3. Do the red refinement.</span></div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      {</div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a18ddc6d1c3a178d628350bbc6b8f030e">RedRefinement</a>(marked_el[i], v_to_v, edge1, edge2, middle);</div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;      }</div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;</div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;      <span class="comment">// 4. Do the green refinement (to get conforming mesh).</span></div><div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;      <span class="keywordtype">int</span> need_refinement;</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;      <span class="keywordtype">int</span> edges_in_group, max_edges_in_group = 0;</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;      <span class="comment">// edge_splittings identify how the shared edges have been split</span></div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;      <span class="keywordtype">int</span> **edge_splittings = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1];</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      {</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;         edges_in_group = <a class="code" href="classmfem_1_1ParMesh.html#ab18f38d2affaab9a1a1feccbe4a99f51">GroupNEdges</a>(i+1);</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;         edge_splittings[i] = <span class="keyword">new</span> <span class="keywordtype">int</span>[edges_in_group];</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;         <span class="keywordflow">if</span> (edges_in_group &gt; max_edges_in_group)</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;         {</div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;            max_edges_in_group = edges_in_group;</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;         }</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;      }</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;      <span class="keywordtype">int</span> neighbor, *iBuf = <span class="keyword">new</span> <span class="keywordtype">int</span>[max_edges_in_group];</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> group_edges;</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;      MPI_Request request;</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;      MPI_Status  status;</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      <a class="code" href="classmfem_1_1Vertex.html">Vertex</a> V;</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;      V(2) = 0.0;</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      <span class="keywordtype">int</span> ref_loops_all = 0, ref_loops_par = 0;</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;      <span class="keywordflow">do</span></div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;      {</div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;         need_refinement = 0;</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nedges; i++)</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;         {</div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;            <span class="keywordflow">if</span> (middle[i] != -1 &amp;&amp; edge1[i] != -1)</div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;            {</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;               need_refinement = 1;</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#a6c725958a987520590c8caf69e9c1e62">GreenRefinement</a>(edge1[i], v_to_v, edge1, edge2, middle);</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;            }</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;         }</div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;         ref_loops_all++;</div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;</div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;         <span class="keywordflow">if</span> (uniform_refinement)</div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;         {</div><div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;         }</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;</div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;         <span class="comment">// if the mesh is locally conforming start making it globally</span></div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;         <span class="comment">// conforming</span></div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;         <span class="keywordflow">if</span> (need_refinement == 0)</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;         {</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;            ref_loops_par++;</div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;            <span class="comment">// MPI_Barrier(MyComm);</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;</div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;            <span class="comment">// (a) send the type of interface splitting</span></div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;            {</div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i, group_edges);</div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;               edges_in_group = group_edges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;               <span class="comment">// it is enough to communicate through the edges</span></div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;               <span class="keywordflow">if</span> (edges_in_group != 0)</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;               {</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; edges_in_group; j++)</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;                  {</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                     edge_splittings[i][j] =</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                        <a class="code" href="classmfem_1_1ParMesh.html#a1a39ac7a8245a70788b01f1b92419725">GetEdgeSplittings</a>(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[j]], v_to_v,</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;                                          middle);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;                  }</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> *nbs = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">GetGroup</a>(i+1);</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                  <span class="keywordflow">if</span> (nbs[0] == 0)</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                  {</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                     neighbor = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbs[1]);</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                  }</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                  {</div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                     neighbor = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbs[0]);</div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;                  }</div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                  MPI_Isend(edge_splittings[i], edges_in_group, MPI_INT,</div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;                            neighbor, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;request);</div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;               }</div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;            }</div><div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;            <span class="comment">// (b) receive the type of interface splitting</span></div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;            {</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i, group_edges);</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;               edges_in_group = group_edges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;               <span class="keywordflow">if</span> (edges_in_group != 0)</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;               {</div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">int</span> *nbs = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">GetGroup</a>(i+1);</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;                  <span class="keywordflow">if</span> (nbs[0] == 0)</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;                  {</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                     neighbor = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbs[1]);</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;                  }</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;                  <span class="keywordflow">else</span></div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;                  {</div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;                     neighbor = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">GetNeighborRank</a>(nbs[0]);</div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;                  }</div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;                  MPI_Recv(iBuf, edges_in_group, MPI_INT, neighbor,</div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;                           MPI_ANY_TAG, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;</div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; edges_in_group; j++)</div><div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;                  {</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;                     <span class="keywordflow">if</span> (iBuf[j] == 1 &amp;&amp; edge_splittings[i][j] == 0)</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;                     {</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;                        <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[j]]-&gt;GetVertices();</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;                        <span class="keywordtype">int</span> ii = v_to_v(v[0], v[1]);</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;                        <span class="keywordflow">if</span> (middle[ii] != -1)</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;                        {</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;                           <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;ParMesh::LocalRefinement (triangles) : &quot;</span></div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;                                      <span class="stringliteral">&quot;Oops!&quot;</span>);</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;                        }</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                        need_refinement = 1;</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                        middle[ii] = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>++;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; 2; c++)</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                        {</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                           V(c) = 0.5 * (<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[v[0]](c) + <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[v[1]](c));</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;                        }</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;                        <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Append(V);</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;                     }</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                  }</div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;               }</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;            }</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;</div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;            <span class="keywordtype">int</span> nr = need_refinement;</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;            MPI_Allreduce(&amp;nr, &amp;need_refinement, 1, MPI_INT, MPI_LOR, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;         }</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;      }</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;      <span class="keywordflow">while</span> (need_refinement == 1);</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG_PARMESH_LOCALREF</span></div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;      {</div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;         <span class="keywordtype">int</span> i = ref_loops_all;</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;         MPI_Reduce(&amp;i, &amp;ref_loops_all, 1, MPI_INT, MPI_MAX, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;         {</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;            <a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;\n\nParMesh::LocalRefinement : max. ref_loops_all = &quot;</span></div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;                      &lt;&lt; ref_loops_all &lt;&lt; <span class="stringliteral">&quot;, ref_loops_par = &quot;</span> &lt;&lt; ref_loops_par</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                      &lt;&lt; <span class="charliteral">&#39;\n&#39;</span> &lt;&lt; endl;</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;         }</div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;      }</div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;</div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; i++)</div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      {</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;         <span class="keyword">delete</span> [] edge_splittings[i];</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      }</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <span class="keyword">delete</span> [] edge_splittings;</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      <span class="keyword">delete</span> [] iBuf;</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;      <span class="comment">// 5. Update the boundary elements.</span></div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <span class="keywordtype">int</span> v1[2], v2[2], bisect, temp;</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      temp = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>;</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; temp; i++)</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      {</div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;         bisect = v_to_v(v[0], v[1]);</div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;         <span class="keywordflow">if</span> (middle[bisect] != -1)</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;         {</div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;            <span class="comment">// the element was refined (needs updating)</span></div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetType() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2">Element::SEGMENT</a>)</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;            {</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;               v1[0] =           v[0]; v1[1] = middle[bisect];</div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;               v2[0] = middle[bisect]; v2[1] =           v[1];</div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;</div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;SetVertices(v1);</div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;               <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v2, <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;<a class="code" href="classmfem_1_1Mesh.html#a2883f6489c821ed509ce84e74b919b54">GetAttribute</a>()));</div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            }</div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;            {</div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;               <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;Only bisection of segment is implemented for bdr&quot;</span></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                          <span class="stringliteral">&quot; elem.&quot;</span>);</div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;            }</div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;         }</div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;      }</div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.Size();</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ab29031fb80d570dc4d7847a14cf78f91">ResetLazyData</a>();</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;      <span class="comment">// 5a. Update the groups after refinement.</span></div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a1a778ec440848d25becb69798b48e781">RefineGroups</a>(v_to_v, middle);</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;      <span class="comment">// 6. Free the allocated memory.</span></div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;      <span class="keyword">delete</span> [] edge1;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;      <span class="keyword">delete</span> [] edge2;</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      <span class="keyword">delete</span> [] middle;</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a> != NULL)</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      {</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">NumOfEdges</a> = <a class="code" href="classmfem_1_1Mesh.html#a4f62eb3ede00bc8dc5de42baa366cab4">GetElementToEdgeTable</a>(*<a class="code" href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">el_to_edge</a>, <a class="code" href="classmfem_1_1Mesh.html#a27b274dcab25a4606c9995f5d1607ff8">be_to_edge</a>);</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a4784444c57c21808869bcaed6e6bcf50">GenerateFaces</a>();</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;      }</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;   } <span class="comment">//  &#39;if (Dim == 2)&#39;</span></div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1) <span class="comment">// --------------------------------------------------------</span></div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;   {</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;      <span class="keywordtype">int</span> cne = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, cnv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> += marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> += marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.SetSize(<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>.SetSize(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>);</div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a1107bd0db9d445c5f613af92a458bcbc">CoarseFineTr</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.SetSize(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>);</div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;</div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; marked_el.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;      {</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;         <span class="keywordtype">int</span> i = marked_el[j];</div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;         <a class="code" href="classmfem_1_1Segment.html">Segment</a> *c_seg = (<a class="code" href="classmfem_1_1Segment.html">Segment</a> *)<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i];</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;         <span class="keywordtype">int</span> *vert = c_seg-&gt;<a class="code" href="classmfem_1_1Segment.html#afbe497734a991a283ec832d9861885ec">GetVertices</a>(), attr = c_seg-&gt;<a class="code" href="classmfem_1_1Element.html#ac8535dd353bf1d8bb2068a28abe8b436">GetAttribute</a>();</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;         <span class="keywordtype">int</span> new_v = cnv + j, new_e = cne + j;</div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#aad2cb8db2b1437750935553c4034a9e1">AverageVertices</a>(vert, 2, new_v);</div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[new_e] = <span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(new_v, vert[1], attr);</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;         vert[1] = new_v;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;</div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a1107bd0db9d445c5f613af92a458bcbc">CoarseFineTr</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[i] = <a class="code" href="structmfem_1_1Embedding.html">Embedding</a>(i, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>, 1);</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a1107bd0db9d445c5f613af92a458bcbc">CoarseFineTr</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[new_e] = <a class="code" href="structmfem_1_1Embedding.html">Embedding</a>(i, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>, 2);</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;      }</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">double</span> seg_children[3*2] = { 0.0,1.0, 0.0,0.5, 0.5,1.0 };</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a1107bd0db9d445c5f613af92a458bcbc">CoarseFineTr</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">point_matrices</a>[<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>].</div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      UseExternalData(seg_children, 1, 2, 3);</div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;</div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a4784444c57c21808869bcaed6e6bcf50">GenerateFaces</a>();</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;   } <span class="comment">// end of &#39;if (Dim == 1)&#39;</span></div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aed8f13455eddd66c387966f71d19f329">last_operation</a> = <a class="code" href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294ba691c033cad8c39ea9637b56e86fa167e">Mesh::REFINE</a>;</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">sequence</a>++;</div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">UpdateNodes</a>();</div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a0029fd07ad6a22cc30b145b7ba2959af">CheckElementOrientation</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aabadf9380fee10dfa4b01211c5cafc90">CheckBdrElementOrientation</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;}</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;</div><div class="line"><a name="l03948"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a042492b062fbd9308a9f4320fcabd1ce"> 3948</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a042492b062fbd9308a9f4320fcabd1ce">ParMesh::NonconformingRefinement</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;Refinement&gt;</a> &amp;refinements,</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                                      <span class="keywordtype">int</span> nc_limit)</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;{</div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;   {</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;NURBS meshes are not supported. Please project the &quot;</span></div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                 <span class="stringliteral">&quot;NURBS to Nodes first with SetCurvature().&quot;</span>);</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;   }</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>)</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;   {</div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Can&#39;t convert conforming ParMesh to nonconforming ParMesh &quot;</span></div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                 <span class="stringliteral">&quot;(you need to initialize the ParMesh from a nonconforming &quot;</span></div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;                 <span class="stringliteral">&quot;serial Mesh)&quot;</span>);</div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;   }</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;   <span class="comment">// NOTE: no check of !refinements.Size(), in parallel we would have to reduce</span></div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;   <span class="comment">// do the refinements</span></div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#adbdecc1f97835142cdf9dbb52743d083">MarkCoarseLevel</a>();</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a4669b97f16600aa70a2ceadf08c15d2e">Refine</a>(refinements);</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;</div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;   <span class="keywordflow">if</span> (nc_limit &gt; 0)</div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;   {</div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#aef8e191581f226d508953d16a8c159d7">LimitNCLevel</a>(nc_limit);</div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;   }</div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;</div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;   <span class="comment">// create a second mesh containing the finest elements from &#39;pncmesh&#39;</span></div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a>* pmesh2 = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh</a>(*<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">OnMeshUpdated</a>(pmesh2);</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(pmesh2-&gt;<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>);</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(pmesh2-&gt;<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>);</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;   <span class="comment">// now swap the meshes, the second mesh will become the old coarse mesh</span></div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;   <span class="comment">// and this mesh will be the new fine mesh</span></div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ab09c17e5079c7c7f854949ec959882a8">Mesh::Swap</a>(*pmesh2, <span class="keyword">false</span>);</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;   <span class="keyword">delete</span> pmesh2; <span class="comment">// NOTE: old face neighbors destroyed here</span></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;</div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a81197e06ddf2eb20439cfe166a9551f8">GetConformingSharedStructures</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;</div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a37b72005638c0da654315a61f7965fd7">GenerateNCFaceInfo</a>();</div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;</div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aed8f13455eddd66c387966f71d19f329">last_operation</a> = <a class="code" href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294ba691c033cad8c39ea9637b56e86fa167e">Mesh::REFINE</a>;</div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">sequence</a>++;</div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;</div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">UpdateNodes</a>();</div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;}</div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;</div><div class="line"><a name="l04000"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a4466317d7e70353013bb842c74556e54"> 4000</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmfem_1_1ParMesh.html#a4466317d7e70353013bb842c74556e54">ParMesh::NonconformingDerefinement</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;double&gt;</a> &amp;elem_error,</div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;                                        <span class="keywordtype">double</span> threshold, <span class="keywordtype">int</span> nc_limit, <span class="keywordtype">int</span> op)</div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;{</div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;   MFEM_VERIFY(<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>, <span class="stringliteral">&quot;Only supported for non-conforming meshes.&quot;</span>);</div><div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;   MFEM_VERIFY(!<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>, <span class="stringliteral">&quot;Derefinement of NURBS meshes is not supported. &quot;</span></div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;               <span class="stringliteral">&quot;Project the NURBS to Nodes first.&quot;</span>);</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;dt = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#ae86d604004fdde2ac62d7ad82cdb11b8">GetDerefinementTable</a>();</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a0b31f62cb833a0e09c9eb89fd1c9a34d">SynchronizeDerefinementData</a>(elem_error, dt);</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> level_ok;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;   <span class="keywordflow">if</span> (nc_limit &gt; 0)</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;   {</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a9936001a545c5777a996f1e4066514c7">CheckDerefinementNCLevel</a>(dt, level_ok, nc_limit);</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;   }</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> derefs;</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; dt.<a class="code" href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">Size</a>(); i++)</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;   {</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;      <span class="keywordflow">if</span> (nc_limit &gt; 0 &amp;&amp; !level_ok[i]) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;</div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;      <span class="keywordtype">double</span> error =</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a38ac9f00a3195b7777153118d646f79a">AggregateError</a>(elem_error, dt.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(i), dt.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(i), op);</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;      <span class="keywordflow">if</span> (error &lt; threshold) { derefs.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(i); }</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;   }</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> glob_size = <a class="code" href="classmfem_1_1ParMesh.html#a85c4ec2abbe32b3e45ceeb115d3eb878">ReduceInt</a>(derefs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>());</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;   <span class="keywordflow">if</span> (!glob_size) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;   <span class="comment">// Destroy face-neighbor data only when actually de-refining.</span></div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#ae0d6fbb5a3078ba054a640ed88c5a104">Derefine</a>(derefs);</div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;</div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a>* mesh2 = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh</a>(*<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">OnMeshUpdated</a>(mesh2);</div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;</div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(mesh2-&gt;<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>);</div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(mesh2-&gt;<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>);</div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;</div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ab09c17e5079c7c7f854949ec959882a8">Mesh::Swap</a>(*mesh2, <span class="keyword">false</span>);</div><div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;   <span class="keyword">delete</span> mesh2;</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a81197e06ddf2eb20439cfe166a9551f8">GetConformingSharedStructures</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a37b72005638c0da654315a61f7965fd7">GenerateNCFaceInfo</a>();</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aed8f13455eddd66c387966f71d19f329">last_operation</a> = <a class="code" href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294baa1fafee4d375682ea8c579adfbaffd61">Mesh::DEREFINE</a>;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">sequence</a>++;</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">UpdateNodes</a>();</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;</div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;}</div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;</div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;</div><div class="line"><a name="l04058"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a80761f9e9a934d1a5e16efdc5e611446"> 4058</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a80761f9e9a934d1a5e16efdc5e611446">ParMesh::Rebalance</a>()</div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;{</div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac4218963b161bfae267b6ff9c22e1bbc">RebalanceImpl</a>(NULL); <span class="comment">// default SFC-based partition</span></div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;}</div><div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;</div><div class="line"><a name="l04063"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a54b3f168f4380ebfe4d70e7de234a3bb"> 4063</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a80761f9e9a934d1a5e16efdc5e611446">ParMesh::Rebalance</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;partition)</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;{</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac4218963b161bfae267b6ff9c22e1bbc">RebalanceImpl</a>(&amp;partition);</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;}</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;</div><div class="line"><a name="l04068"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ac4218963b161bfae267b6ff9c22e1bbc"> 4068</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ac4218963b161bfae267b6ff9c22e1bbc">ParMesh::RebalanceImpl</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> *partition)</div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;{</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a2241de10a34775973f8d6a11e58121e7">Conforming</a>())</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;   {</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Load balancing is currently not supported for conforming&quot;</span></div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;                 <span class="stringliteral">&quot; meshes.&quot;</span>);</div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;   }</div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;</div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;   {</div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;      <span class="comment">// check that Nodes use a parallel FE space, so we can call UpdateNodes()</span></div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      MFEM_VERIFY(dynamic_cast&lt;ParFiniteElementSpace*&gt;(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>())</div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                  != NULL, <span class="stringliteral">&quot;internal error&quot;</span>);</div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;   }</div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;</div><div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a8881cbed07da54396b41b87b0bb50810">Rebalance</a>(partition);</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a>* pmesh2 = <span class="keyword">new</span> <a class="code" href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">ParMesh</a>(*<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">OnMeshUpdated</a>(pmesh2);</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(pmesh2-&gt;<a class="code" href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">attributes</a>);</div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">Copy</a>(pmesh2-&gt;<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>);</div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;</div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ab09c17e5079c7c7f854949ec959882a8">Mesh::Swap</a>(*pmesh2, <span class="keyword">false</span>);</div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;   <span class="keyword">delete</span> pmesh2;</div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;</div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a81197e06ddf2eb20439cfe166a9551f8">GetConformingSharedStructures</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a37b72005638c0da654315a61f7965fd7">GenerateNCFaceInfo</a>();</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aed8f13455eddd66c387966f71d19f329">last_operation</a> = <a class="code" href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294ba0ad85359958a23db9b0e91fb5ecf521d">Mesh::REBALANCE</a>;</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">sequence</a>++;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">UpdateNodes</a>();</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;}</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;</div><div class="line"><a name="l04106"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a1a778ec440848d25becb69798b48e781"> 4106</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a1a778ec440848d25becb69798b48e781">ParMesh::RefineGroups</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> &amp;v_to_v, <span class="keywordtype">int</span> *middle)</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;{</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;   <span class="comment">// Refine groups after LocalRefinement in 2D (triangle meshes)</span></div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 1, <span class="stringliteral">&quot;internal error&quot;</span>);</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> group_verts, group_edges;</div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   <span class="comment">// To update the groups after a refinement, we observe that:</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;   <span class="comment">// - every (new and old) vertex, edge and face belongs to exactly one group</span></div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;   <span class="comment">// - the refinement does not create new groups</span></div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;   <span class="comment">// - a new vertex appears only as the middle of a refined edge</span></div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;   <span class="comment">// - a face can be refined 2, 3 or 4 times producing new edges and faces</span></div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;   <span class="keywordtype">int</span> *I_group_svert, *J_group_svert;</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;   <span class="keywordtype">int</span> *I_group_sedge, *J_group_sedge;</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;   I_group_svert = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()+1);</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;   I_group_sedge = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()+1);</div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;   I_group_svert[0] = I_group_svert[1] = 0;</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;   I_group_sedge[0] = I_group_sedge[1] = 0;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;</div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;   <span class="comment">// overestimate the size of the J arrays</span></div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;   J_group_svert = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>() +</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;   J_group_sedge = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(2*<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> group = 0; group &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; group++)</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;   {</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      <span class="comment">// Get the group shared objects</span></div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_verts);</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_edges);</div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      <span class="comment">// Check which edges have been refined</span></div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      {</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[i]]-&gt;GetVertices();</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> ind = middle[v_to_v(v[0], v[1])];</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;         <span class="keywordflow">if</span> (ind != -1)</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;         {</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;            <span class="comment">// add a vertex</span></div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;            group_verts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(ind)-1);</div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;            <span class="comment">// update the edges</span></div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[i]]-&gt;GetAttribute();</div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[1], ind, attr));</div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;            group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;            v[1] = ind;</div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;         }</div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;      }</div><div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;      I_group_svert[group+1] = I_group_svert[group] + group_verts.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;      I_group_sedge[group+1] = I_group_sedge[group] + group_edges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;      <span class="keywordtype">int</span> *J;</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;      J = J_group_svert+I_group_svert[group];</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; group_verts.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;      {</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;         J[i] = group_verts[i];</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      }</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;      J = J_group_sedge+I_group_sedge[group];</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; group_edges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      {</div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;         J[i] = group_edges[i];</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;      }</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;   }</div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_svert, J_group_svert);</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_sedge, J_group_sedge);</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;}</div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;</div><div class="line"><a name="l04179"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#acc78219b26c57412309471cda8463ead"> 4179</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a1a778ec440848d25becb69798b48e781">ParMesh::RefineGroups</a>(<span class="keywordtype">int</span> old_nv, <span class="keyword">const</span> <a class="code" href="classmfem_1_1HashTable.html">HashTable&lt;Hashed2&gt;</a> &amp;v_to_v)</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;{</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;   <span class="comment">// Refine groups after LocalRefinement in 3D (tetrahedral meshes)</span></div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 1, <span class="stringliteral">&quot;internal error&quot;</span>);</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> group_verts, group_edges, group_trias;</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;</div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;   <span class="comment">// To update the groups after a refinement, we observe that:</span></div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;   <span class="comment">// - every (new and old) vertex, edge and face belongs to exactly one group</span></div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;   <span class="comment">// - the refinement does not create new groups</span></div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;   <span class="comment">// - a new vertex appears only as the middle of a refined edge</span></div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;   <span class="comment">// - a face can be refined multiple times producing new edges and faces</span></div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Segment *&gt;</a> sedge_stack;</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Vert3&gt;</a> sface_stack;</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> I_group_svert, J_group_svert;</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> I_group_sedge, J_group_sedge;</div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> I_group_stria, J_group_stria;</div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;</div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;   I_group_svert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;   I_group_sedge.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;   I_group_stria.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;</div><div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;   I_group_svert[0] = 0;</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;   I_group_sedge[0] = 0;</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;   I_group_stria[0] = 0;</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> group = 0; group &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; group++)</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;   {</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;      <span class="comment">// Get the group shared objects</span></div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_verts);</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_edges);</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_trias);</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;      <span class="comment">// Check which edges have been refined</span></div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;      {</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[i]]-&gt;GetVertices();</div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;         <span class="keywordtype">int</span> ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], v[1]);</div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;         <span class="keywordflow">if</span> (ind == -1) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;</div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;         <span class="comment">// This shared edge is refined: walk the whole refinement tree</span></div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[i]]-&gt;GetAttribute();</div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;         <span class="keywordflow">do</span></div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;         {</div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;            ind += old_nv;</div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;            <span class="comment">// Add new shared vertex</span></div><div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;            group_verts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(ind)-1);</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;            <span class="comment">// Put the right sub-edge on top of the stack</span></div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            sedge_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(ind, v[1], attr));</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;            <span class="comment">// The left sub-edge replaces the original edge</span></div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;            v[1] = ind;</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;            ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], ind);</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;         }</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;         <span class="keywordflow">while</span> (ind != -1);</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;         <span class="comment">// Process all edges in the edge stack</span></div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;         <span class="keywordflow">do</span></div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;         {</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;            <a class="code" href="classmfem_1_1Segment.html">Segment</a> *se = sedge_stack.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>();</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;            v = se-&gt;<a class="code" href="classmfem_1_1Segment.html#afbe497734a991a283ec832d9861885ec">GetVertices</a>();</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;            ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], v[1]);</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;            <span class="keywordflow">if</span> (ind == -1)</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;            {</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;               <span class="comment">// The edge &#39;se&#39; is not refined</span></div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;               sedge_stack.<a class="code" href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">DeleteLast</a>();</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;               <span class="comment">// Add new shared edge</span></div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(se);</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;               group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;            }</div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;            {</div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;               <span class="comment">// The edge &#39;se&#39; is refined</span></div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;               ind += old_nv;</div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;               <span class="comment">// Add new shared vertex</span></div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;               group_verts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(ind)-1);</div><div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;               <span class="comment">// Put the left sub-edge on top of the stack</span></div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;               sedge_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[0], ind, attr));</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;               <span class="comment">// The right sub-edge replaces the original edge</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;               v[0] = ind;</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;            }</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;         }</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;         <span class="keywordflow">while</span> (sedge_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0);</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;      }</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      <span class="comment">// Check which triangles have been refined</span></div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;      {</div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[group_trias[i]].v;</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;         <span class="keywordtype">int</span> ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], v[1]);</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;         <span class="keywordflow">if</span> (ind == -1) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;         <span class="comment">// This shared face is refined: walk the whole refinement tree</span></div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> edge_attr = 1;</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;         <span class="keywordflow">do</span></div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;         {</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;            ind += old_nv;</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;            <span class="comment">// Add the refinement edge to the edge stack</span></div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;            sedge_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[2], ind, edge_attr));</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;            <span class="comment">// Put the right sub-triangle on top of the face stack</span></div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;            sface_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="structmfem_1_1ParMesh_1_1Vert3.html">Vert3</a>(v[1], v[2], ind));</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;            <span class="comment">// The left sub-triangle replaces the original one</span></div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;            v[1] = v[0]; v[0] = v[2]; v[2] = ind;</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;            ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], v[1]);</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;         }</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;         <span class="keywordflow">while</span> (ind != -1);</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;         <span class="comment">// Process all faces (triangles) in the face stack</span></div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;         <span class="keywordflow">do</span></div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;         {</div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;            <a class="code" href="structmfem_1_1ParMesh_1_1Vert3.html">Vert3</a> &amp;st = sface_stack.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>();</div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;            v = st.<a class="code" href="structmfem_1_1ParMesh_1_1Vert3.html#ac2c5fb0ba8b8f3da6ea91c90a92f232d">v</a>;</div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;            ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], v[1]);</div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;            <span class="keywordflow">if</span> (ind == -1)</div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;            {</div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;               <span class="comment">// The triangle &#39;st&#39; is not refined</span></div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;               <span class="comment">// Add new shared face</span></div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Append(st);</div><div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;               group_trias.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;               sface_stack.<a class="code" href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">DeleteLast</a>();</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;            }</div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;            {</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;               <span class="comment">// The triangle &#39;st&#39; is refined</span></div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;               ind += old_nv;</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;               <span class="comment">// Add the refinement edge to the edge stack</span></div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;               sedge_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[2], ind, edge_attr));</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;               <span class="comment">// Put the left sub-triangle on top of the face stack</span></div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;               sface_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="structmfem_1_1ParMesh_1_1Vert3.html">Vert3</a>(v[2], v[0], ind));</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;               <span class="comment">// Note that the above Append() may invalidate &#39;v&#39;</span></div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;               v = sface_stack[sface_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()-2].v;</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;               <span class="comment">// The right sub-triangle replaces the original one</span></div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;               v[0] = v[1]; v[1] = v[2]; v[2] = ind;</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;            }</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;         }</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;         <span class="keywordflow">while</span> (sface_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0);</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;         <span class="comment">// Process all edges in the edge stack (same code as above)</span></div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;         <span class="keywordflow">do</span></div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;         {</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;            <a class="code" href="classmfem_1_1Segment.html">Segment</a> *se = sedge_stack.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>();</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;            v = se-&gt;<a class="code" href="classmfem_1_1Segment.html#afbe497734a991a283ec832d9861885ec">GetVertices</a>();</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;            ind = v_to_v.<a class="code" href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">FindId</a>(v[0], v[1]);</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;            <span class="keywordflow">if</span> (ind == -1)</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;            {</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;               <span class="comment">// The edge &#39;se&#39; is not refined</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;               sedge_stack.<a class="code" href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">DeleteLast</a>();</div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;               <span class="comment">// Add new shared edge</span></div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;               <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(se);</div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;               group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;            }</div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;            {</div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;               <span class="comment">// The edge &#39;se&#39; is refined</span></div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;               ind += old_nv;</div><div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;               <span class="comment">// Add new shared vertex</span></div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;               group_verts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(ind)-1);</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;               <span class="comment">// Put the left sub-edge on top of the stack</span></div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;               sedge_stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[0], ind, edge_attr));</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;               <span class="comment">// The right sub-edge replaces the original edge</span></div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;               v[0] = ind;</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            }</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;         }</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;         <span class="keywordflow">while</span> (sedge_stack.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0);</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      }</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      I_group_svert[group+1] = I_group_svert[group] + group_verts.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      I_group_sedge[group+1] = I_group_sedge[group] + group_edges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;      I_group_stria[group+1] = I_group_stria[group] + group_trias.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      J_group_svert.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(group_verts);</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;      J_group_sedge.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(group_edges);</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      J_group_stria.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(group_trias);</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;   }</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;</div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_svert, J_group_svert);</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_sedge, J_group_sedge);</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_stria, J_group_stria);</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;   I_group_svert.<a class="code" href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">LoseData</a>(); J_group_svert.<a class="code" href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">LoseData</a>();</div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;   I_group_sedge.<a class="code" href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">LoseData</a>(); J_group_sedge.<a class="code" href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">LoseData</a>();</div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;   I_group_stria.<a class="code" href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">LoseData</a>(); J_group_stria.<a class="code" href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">LoseData</a>();</div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;}</div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;</div><div class="line"><a name="l04363"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a77b0de5a8a964d2c7b2d0abc9077ec8e"> 4363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a77b0de5a8a964d2c7b2d0abc9077ec8e">ParMesh::UniformRefineGroups2D</a>(<span class="keywordtype">int</span> old_nv)</div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;{</div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> sverts, sedges;</div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;</div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;   <span class="keywordtype">int</span> *I_group_svert, *J_group_svert;</div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;   <span class="keywordtype">int</span> *I_group_sedge, *J_group_sedge;</div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;</div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;   I_group_svert = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;   I_group_sedge = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;   I_group_svert[0] = 0;</div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;   I_group_sedge[0] = 0;</div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;</div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;   <span class="comment">// compute the size of the J arrays</span></div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;   J_group_svert = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>() +</div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;                               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;   J_group_sedge = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(2*<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> group = 0; group &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; group++)</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;   {</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;      <span class="comment">// Get the group shared objects</span></div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, sverts);</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, sedges);</div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;      <span class="comment">// Process all the edges</span></div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;      {</div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedges[i]]-&gt;GetVertices();</div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> ind = old_nv + <a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>[sedges[i]];</div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;         <span class="comment">// add a vertex</span></div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;         sverts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(ind)-1);</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;         <span class="comment">// update the edges</span></div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[sedges[i]]-&gt;GetAttribute();</div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[1], ind, attr));</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;         sedges.Append(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;         v[1] = ind;</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;      }</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;      I_group_svert[group+1] = I_group_svert[group] + sverts.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;      I_group_sedge[group+1] = I_group_sedge[group] + sedges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;      sverts.<a class="code" href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">CopyTo</a>(J_group_svert + I_group_svert[group]);</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      sedges.<a class="code" href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">CopyTo</a>(J_group_sedge + I_group_sedge[group]);</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;   }</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;</div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_svert, J_group_svert);</div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_sedge, J_group_sedge);</div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;}</div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;</div><div class="line"><a name="l04414"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ac1eca094b9624f7a24dce5c6ab333caf"> 4414</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ac1eca094b9624f7a24dce5c6ab333caf">ParMesh::UniformRefineGroups3D</a>(<span class="keywordtype">int</span> old_nv, <span class="keywordtype">int</span> old_nedges,</div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> &amp;old_v_to_v,</div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> &amp;old_faces,</div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;                                    <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> *f2qf)</div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;{</div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;   <span class="comment">// f2qf can be NULL if all faces are quads or there are no quad faces</span></div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;</div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> group_verts, group_edges, group_trias, group_quads;</div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;   <span class="keywordtype">int</span> *I_group_svert, *J_group_svert;</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;   <span class="keywordtype">int</span> *I_group_sedge, *J_group_sedge;</div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;   <span class="keywordtype">int</span> *I_group_stria, *J_group_stria;</div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;   <span class="keywordtype">int</span> *I_group_squad, *J_group_squad;</div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;</div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;   I_group_svert = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;   I_group_sedge = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;   I_group_stria = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;   I_group_squad = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>());</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;   I_group_svert[0] = 0;</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;   I_group_sedge[0] = 0;</div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;   I_group_stria[0] = 0;</div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;   I_group_squad[0] = 0;</div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;   <span class="comment">// compute the size of the J arrays</span></div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;   J_group_svert = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>() +</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                               <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>() +</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                               <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;   J_group_sedge = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(2*<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>() +</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;                               3*<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>() +</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;                               4*<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;   J_group_stria = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(4*<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;   J_group_squad = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(4*<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">Size_of_connections</a>());</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;</div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> oface = old_nv + old_nedges;</div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;</div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> group = 0; group &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>()-1; group++)</div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;   {</div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;      <span class="comment">// Get the group shared objects</span></div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_verts);</div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_edges);</div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_trias);</div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(group, group_quads);</div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;</div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;      <span class="comment">// Process the edges that have been refined</span></div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;      {</div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[i]]-&gt;GetVertices();</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> ind = old_nv + old_v_to_v(v[0], v[1]);</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;         <span class="comment">// add a vertex</span></div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;         group_verts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(ind)-1);</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;         <span class="comment">// update the edges</span></div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[group_edges[i]]-&gt;GetAttribute();</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(v[1], ind, attr));</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;         v[1] = ind; <span class="comment">// v[0] remains the same</span></div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      }</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;      <span class="comment">// Process the triangles that have been refined</span></div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;      {</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;         <span class="keywordtype">int</span> m[3];</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> stria = group_trias[i];</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[stria].v;</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;         <span class="comment">// add the refinement edges</span></div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;         m[0] = old_nv + old_v_to_v(v[0], v[1]);</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;         m[1] = old_nv + old_v_to_v(v[1], v[2]);</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;         m[2] = old_nv + old_v_to_v(v[2], v[0]);</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> edge_attr = 1;</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[0], m[1], edge_attr));</div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[1], m[2], edge_attr));</div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[0], m[2], edge_attr));</div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;         <span class="comment">// update faces</span></div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nst = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size();</div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.SetSize(nst+3);</div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;         <span class="comment">// The above SetSize() may invalidate &#39;v&#39;</span></div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;         v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[stria].v;</div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[nst+0].Set(m[1],m[2],m[0]);</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[nst+1].Set(m[0],v[1],m[1]);</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[nst+2].Set(m[2],m[1],v[2]);</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;         v[1] = m[0]; v[2] = m[2]; <span class="comment">// v[0] remains the same</span></div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;         group_trias.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nst+0);</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;         group_trias.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nst+1);</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;         group_trias.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nst+2);</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;         <span class="comment">// sface_lface is set later</span></div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;      }</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;      <span class="comment">// Process the quads that have been refined</span></div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(group); i++)</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      {</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;         <span class="keywordtype">int</span> m[5];</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> squad = group_quads[i];</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[squad].v;</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> olf = old_faces(v[0], v[1], v[2], v[3]);</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;         <span class="comment">// f2qf can be NULL if all faces are quads</span></div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;         m[0] = oface + (f2qf ? (*f2qf)[olf] : olf);</div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;         <span class="comment">// add a vertex</span></div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;         group_verts.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(m[0])-1);</div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;         <span class="comment">// add the refinement edges</span></div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;         m[1] = old_nv + old_v_to_v(v[0], v[1]);</div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;         m[2] = old_nv + old_v_to_v(v[1], v[2]);</div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;         m[3] = old_nv + old_v_to_v(v[2], v[3]);</div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;         m[4] = old_nv + old_v_to_v(v[3], v[0]);</div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> edge_attr = 1;</div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[1], m[0], edge_attr));</div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[2], m[0], edge_attr));</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[3], m[0], edge_attr));</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Append(<span class="keyword">new</span> <a class="code" href="classmfem_1_1Segment.html">Segment</a>(m[4], m[0], edge_attr));</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;         group_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(-1)-1);</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;         <span class="comment">// update faces</span></div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nsq = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size();</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.SetSize(nsq+3);</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;         <span class="comment">// The above SetSize() may invalidate &#39;v&#39;</span></div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;         v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[squad].v;</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[nsq+0].Set(m[1],v[1],m[2],m[0]);</div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[nsq+1].Set(m[0],m[2],v[2],m[3]);</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[nsq+2].Set(m[4],m[0],m[3],v[3]);</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;         v[1] = m[1]; v[2] = m[0]; v[3] = m[4]; <span class="comment">// v[0] remains the same</span></div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;         group_quads.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nsq+0);</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;         group_quads.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nsq+1);</div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;         group_quads.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nsq+2);</div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;         <span class="comment">// sface_lface is set later</span></div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;      }</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;      I_group_svert[group+1] = I_group_svert[group] + group_verts.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;      I_group_sedge[group+1] = I_group_sedge[group] + group_edges.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;      I_group_stria[group+1] = I_group_stria[group] + group_trias.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;      I_group_squad[group+1] = I_group_squad[group] + group_quads.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;      group_verts.<a class="code" href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">CopyTo</a>(J_group_svert + I_group_svert[group]);</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;      group_edges.<a class="code" href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">CopyTo</a>(J_group_sedge + I_group_sedge[group]);</div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;      group_trias.<a class="code" href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">CopyTo</a>(J_group_stria + I_group_stria[group]);</div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;      group_quads.<a class="code" href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">CopyTo</a>(J_group_squad + I_group_squad[group]);</div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;   }</div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">FinalizeParTopo</a>();</div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;</div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_svert, J_group_svert);</div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_sedge, J_group_sedge);</div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_stria, J_group_stria);</div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I_group_squad, J_group_squad);</div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;}</div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;</div><div class="line"><a name="l04563"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a33a72d6483e85d585aad2d170e09efa7"> 4563</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a33a72d6483e85d585aad2d170e09efa7">ParMesh::UniformRefinement2D</a>()</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;{</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> old_nv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;   <span class="comment">// call Mesh::UniformRefinement2D so that it won&#39;t update the nodes</span></div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;   {</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> update_nodes = <span class="keyword">false</span>;</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ab35a7f8b1a2c0d13ab2094271b00efd1">Mesh::UniformRefinement2D_base</a>(update_nodes);</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;   }</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;   <span class="comment">// update the groups</span></div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a77b0de5a8a964d2c7b2d0abc9077ec8e">UniformRefineGroups2D</a>(old_nv);</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">UpdateNodes</a>();</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;   <span class="comment">// If there are no Nodes, the orientation is checked in the call to</span></div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;   <span class="comment">// UniformRefinement2D_base() above.</span></div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>) { <a class="code" href="classmfem_1_1Mesh.html#a0029fd07ad6a22cc30b145b7ba2959af">CheckElementOrientation</a>(<span class="keyword">false</span>); }</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;}</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;</div><div class="line"><a name="l04587"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a7dcffcbadab4c5c90d24370a2b5a2dab"> 4587</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a7dcffcbadab4c5c90d24370a2b5a2dab">ParMesh::UniformRefinement3D</a>()</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;{</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> old_nv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> old_nedges = <a class="code" href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">NumOfEdges</a>;</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;   <a class="code" href="classmfem_1_1DSTable.html">DSTable</a> v_to_v(<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ae6d959a7cd2b26c570831111e2f0d80e">GetVertexToVertexTable</a>(v_to_v);</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;   <a class="code" href="classmfem_1_1STable3D.html">STable3D</a> *faces_tbl = <a class="code" href="classmfem_1_1Mesh.html#ad5510bac66ddadc6eb5c920c7d74684e">GetFacesTable</a>();</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;   <span class="comment">// call Mesh::UniformRefinement3D_base so that it won&#39;t update the nodes</span></div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> f2qf;</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;   {</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> update_nodes = <span class="keyword">false</span>;</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a2b58a4871c821476600a22702b70ee8a">UniformRefinement3D_base</a>(&amp;f2qf, &amp;v_to_v, update_nodes);</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      <span class="comment">// Note: for meshes that have triangular faces, v_to_v is modified by the</span></div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;      <span class="comment">//       above call to return different edge indices - this is used when</span></div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;      <span class="comment">//       updating the groups. This is needed by ReorientTetMesh().</span></div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;   }</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;   <span class="comment">// update the groups</span></div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#ac1eca094b9624f7a24dce5c6ab333caf">UniformRefineGroups3D</a>(old_nv, old_nedges, v_to_v, *faces_tbl,</div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;                         f2qf.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() ? &amp;f2qf : NULL);</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;   <span class="keyword">delete</span> faces_tbl;</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">UpdateNodes</a>();</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;}</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;</div><div class="line"><a name="l04616"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a950cc1011ae68063201e5fb567398012"> 4616</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a950cc1011ae68063201e5fb567398012">ParMesh::NURBSUniformRefinement</a>()</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;{</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;   {</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;      <a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;\nParMesh::NURBSUniformRefinement : Not supported yet!\n&quot;</span>;</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;   }</div><div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;}</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;</div><div class="line"><a name="l04624"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a16746032783bd96c382cde0bc82f2337"> 4624</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a16746032783bd96c382cde0bc82f2337">ParMesh::PrintXG</a>(std::ostream &amp;os)<span class="keyword"> const</span></div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, <span class="stringliteral">&quot;2D manifolds not supported&quot;</span>);</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 1)</div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;   {</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;      <span class="keywordtype">int</span> i, j, nv;</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *ind;</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;NETGEN_Neutral_Format\n&quot;</span>;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;      <span class="comment">// print the vertices</span></div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;      {</div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;         {</div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;         }</div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;      }</div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;</div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;      <span class="comment">// print the elements</span></div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;      {</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;         ind = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;         os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;         {</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;         }</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;      }</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;      <span class="comment">// print the boundary + shared faces information</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;      <span class="comment">// boundary</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;      {</div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;         ind = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;         os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;         {</div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;         }</div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;      }</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;      <span class="comment">// shared faces</span></div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> sf_attr =</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> + 1 + (<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0 ? <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">Max</a>() : 0);</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); i++)</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;      {</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;         ind = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;         os &lt;&lt; sf_attr;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;         {</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;            os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;         }</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;      }</div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;      <span class="comment">// There are no quad shared faces</span></div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;   }</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 2)</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;   {</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;      <span class="keywordtype">int</span> i, j, nv;</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *ind;</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;TrueGrid\n&quot;</span></div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;1 &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a></div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; 0 0 0 0 0 0 0\n&quot;</span></div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;0 0 0 1 0 0 0 0 0 0 0\n&quot;</span></div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;0 0 &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>+<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>()</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; 0 0 0 0 0 0 0 0 0 0 0 0 0\n&quot;</span></div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;0.0 0.0 0.0 0 0 0.0 0.0 0 0.0\n&quot;</span></div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n&quot;</span>;</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;      <span class="comment">// print the vertices</span></div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;      {</div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;         os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; 0.0 &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](1)</div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](2) &lt;&lt; <span class="stringliteral">&quot; 0.0\n&quot;</span>;</div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;      }</div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;</div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;      <span class="comment">// print the elements</span></div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;      {</div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;         ind = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;         os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;         {</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;         }</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;      }</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      <span class="comment">// print the boundary information</span></div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      {</div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;         ind = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;         os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;         {</div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;         }</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot; 1.0 1.0 1.0 1.0\n&quot;</span>;</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      }</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;      <span class="comment">// print the shared faces information</span></div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> sf_attr =</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> + 1 + (<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0 ? <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">Max</a>() : 0);</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;      <span class="comment">// There are no shared triangle faces</span></div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size(); i++)</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      {</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;         ind = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[i].v;</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;         os &lt;&lt; sf_attr;</div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;         {</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;            os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;         }</div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot; 1.0 1.0 1.0 1.0\n&quot;</span>;</div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;      }</div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;   }</div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;</div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;   {</div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;      <span class="keywordtype">int</span> i, j, attr;</div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> v;</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;areamesh2\n\n&quot;</span>;</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;      <span class="comment">// print the boundary + shared edges information</span></div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;      <span class="comment">// boundary</span></div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;      {</div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;         attr = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;         os &lt;&lt; attr &lt;&lt; <span class="stringliteral">&quot;     &quot;</span>;</div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; v.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;         {</div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;            os &lt;&lt; v[j] + 1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;         }</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;      }</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;      <span class="comment">// shared edges</span></div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); i++)</div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      {</div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;         attr = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;         <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;         os &lt;&lt; attr &lt;&lt; <span class="stringliteral">&quot;     &quot;</span>;</div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; v.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;         {</div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;            os &lt;&lt; v[j] + 1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;         }</div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;      }</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;      <span class="comment">// print the elements</span></div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;      {</div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;         attr = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;</div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;         os &lt;&lt; attr &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;         <span class="keywordflow">if</span> ((j = <a class="code" href="classmfem_1_1Mesh.html#a1e4b4686077146cd260acc1f50827047">GetElementType</a>(i)) == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">Element::TRIANGLE</a>)</div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;         {</div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;            os &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;         }</div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68">Element::QUADRILATERAL</a>)</div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;         {</div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;            os &lt;&lt; 4 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;         }</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2">Element::SEGMENT</a>)</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;         {</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;            os &lt;&lt; 2 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;         }</div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; v.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;         {</div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;            os &lt;&lt; v[j] + 1 &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;         }</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;      }</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;      <span class="comment">// print the vertices</span></div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;      {</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;         {</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;         }</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;      }</div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;   }</div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;   os.flush();</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;}</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;</div><div class="line"><a name="l04826"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a345990e5e841a634dda2b62cbc994a42"> 4826</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmfem_1_1ParMesh.html#a345990e5e841a634dda2b62cbc994a42">ParMesh::WantSkipSharedMaster</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Master.html">NCMesh::Master</a> &amp;master)<span class="keyword"> const</span></div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;   <span class="comment">// In 2D, this is a workaround for a CPU boundary rendering artifact. We need</span></div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;   <span class="comment">// to skip a shared master edge if one of its slaves has the same rank.</span></div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCMesh::NCList</a> &amp;list = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1NCMesh.html#a66a55c978781ac29f1d6e380cd79e28b">GetEdgeList</a>();</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = master.<a class="code" href="structmfem_1_1NCMesh_1_1Master.html#a9ac95777a21057b4787526f41bca07c8">slaves_begin</a>; i &lt; master.<a class="code" href="structmfem_1_1NCMesh_1_1Master.html#ac76bd3a2e6a22693fd5f8deea4af55be">slaves_end</a>; i++)</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;   {</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a0ceb36799b7cfe46fb1c16c27c25d1ce">IsGhost</a>(1, list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>[i].index)) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;   }</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;}</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;</div><div class="line"><a name="l04839"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#afa7fefbe7831d5e3b514d4d84ff129ef"> 4839</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#afa7fefbe7831d5e3b514d4d84ff129ef">ParMesh::Print</a>(std::ostream &amp;os)<span class="keyword"> const</span></div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;   <span class="keywordtype">int</span> shared_bdr_attr;</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> nc_shared_faces;</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;   {</div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#afc8694e930d1db54abc3833d44504229">Printer</a>(os); <span class="comment">// does not print shared boundary</span></div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;   }</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>* s2l_face;</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>)</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;   {</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      s2l_face = ((<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1) ? &amp;<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a> :</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;                  ((<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2) ? &amp;<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a> : &amp;<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>));</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;   }</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;   {</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      s2l_face = &amp;nc_shared_faces;</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;      {</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;         <span class="comment">// get a list of all shared non-ghost faces</span></div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;         <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCMesh::NCList</a>&amp; sfaces =</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;            (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3) ? <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#a2996b5567bedaf88c723475f1857bbe5">GetSharedFaces</a>() : <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#ac1441513981a3a71dcc99f78cfa9d2cb">GetSharedEdges</a>();</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nfaces = <a class="code" href="classmfem_1_1Mesh.html#a2249b56c56f685bb6a14b74921e77199">GetNumFaces</a>();</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>.Size(); i++)</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;         {</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>[i].index;</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> &lt; nfaces) { nc_shared_faces.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>); }</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;         }</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">masters</a>.Size(); i++)</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;         {</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2 &amp;&amp; <a class="code" href="classmfem_1_1ParMesh.html#a345990e5e841a634dda2b62cbc994a42">WantSkipSharedMaster</a>(sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">masters</a>[i])) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">masters</a>[i].index;</div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> &lt; nfaces) { nc_shared_faces.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>); }</div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;         }</div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>.Size(); i++)</div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;         {</div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;            <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = sfaces.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>[i].index;</div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> &lt; nfaces) { nc_shared_faces.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>); }</div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;         }</div><div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;      }</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;   }</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;MFEM mesh v1.0\n&quot;</span>;</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;   <span class="comment">// optional</span></div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;   os &lt;&lt;</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;      <span class="stringliteral">&quot;\n#\n# MFEM Geometry Types (see mesh/geom.hpp):\n#\n&quot;</span></div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;      <span class="stringliteral">&quot;# POINT       = 0\n&quot;</span></div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      <span class="stringliteral">&quot;# SEGMENT     = 1\n&quot;</span></div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;      <span class="stringliteral">&quot;# TRIANGLE    = 2\n&quot;</span></div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;      <span class="stringliteral">&quot;# SQUARE      = 3\n&quot;</span></div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;      <span class="stringliteral">&quot;# TETRAHEDRON = 4\n&quot;</span></div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      <span class="stringliteral">&quot;# CUBE        = 5\n&quot;</span></div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;      <span class="stringliteral">&quot;# PRISM       = 6\n&quot;</span></div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      <span class="stringliteral">&quot;#\n&quot;</span>;</div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\ndimension\n&quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a></div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;\n\nelements\n&quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;   {</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a8fcbc3ac9d7d9bb02743a26e14ac4a2b">PrintElement</a>(<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i], os);</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;   }</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;   <span class="keywordtype">int</span> num_bdr_elems = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>;</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a5c53f58add9caebd46a57cc43e774e69">print_shared</a> &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1)</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;   {</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;      num_bdr_elems += s2l_face-&gt;<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;   }</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\nboundary\n&quot;</span> &lt;&lt; num_bdr_elems &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;   {</div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a8fcbc3ac9d7d9bb02743a26e14ac4a2b">PrintElement</a>(<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i], os);</div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;   }</div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;</div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a5c53f58add9caebd46a57cc43e774e69">print_shared</a> &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1)</div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;   {</div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>())</div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;      {</div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;         shared_bdr_attr = <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">Max</a>() + <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> + 1;</div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;      }</div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;      {</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;         shared_bdr_attr = <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> + 1;</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;      }</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s2l_face-&gt;<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;      {</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;         <span class="comment">// Modify the attributes of the faces (not used otherwise?)</span></div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[(*s2l_face)[i]]-&gt;SetAttribute(shared_bdr_attr);</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;         <a class="code" href="classmfem_1_1Mesh.html#a8fcbc3ac9d7d9bb02743a26e14ac4a2b">PrintElement</a>(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[(*s2l_face)[i]], os);</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;      }</div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;   }</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\nvertices\n&quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> == NULL)</div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;   {</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;      os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;      {</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;         os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](0);</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; j++)</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;         {</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;            os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;         }</div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;      }</div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;      os.flush();</div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;   }</div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;   {</div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\nnodes\n&quot;</span>;</div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a384af64abe5d00fd151480fe7cf21ac2">Save</a>(os);</div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;   }</div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;}</div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;</div><div class="line"><a name="l04955"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a89e5b9c622f32475936666ff6ad19cab"> 4955</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a89e5b9c622f32475936666ff6ad19cab">ParMesh::Save</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keywordtype">int</span> precision)<span class="keyword"> const</span></div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;   ostringstream fname_with_suffix;</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;   fname_with_suffix &lt;&lt; fname &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; setw(6) &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>;</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;   ofstream ofs(fname_with_suffix.str().c_str());</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;   ofs.precision(precision);</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#afa7fefbe7831d5e3b514d4d84ff129ef">Print</a>(ofs);</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;}</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;<span class="preprocessor">#ifdef MFEM_USE_ADIOS2</span></div><div class="line"><a name="l04965"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a4bd63f276596b9bc2cffda0d1b755c7a"> 4965</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#afa7fefbe7831d5e3b514d4d84ff129ef">ParMesh::Print</a>(<a class="code" href="classmfem_1_1adios2stream.html">adios2stream</a> &amp;os)<span class="keyword"> const</span></div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#a77b793b23a4bbda8cb05cd29d696dd8a">Mesh::Print</a>(os);</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;}</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> dump_element(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Element.html">Element</a>* elem, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;data)</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;{</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;   data.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(elem-&gt;<a class="code" href="classmfem_1_1Element.html#a1e661e3be0ce243710e18e1ee41a887a">GetGeometryType</a>());</div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;   <span class="keywordtype">int</span> nv = elem-&gt;<a class="code" href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">GetNVertices</a>();</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nv; i++)</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;   {</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      data.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(v[i]);</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;   }</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;}</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;</div><div class="line"><a name="l04983"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a55ad4b875a6943bd34bf10774c7d1c82"> 4983</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a55ad4b875a6943bd34bf10774c7d1c82">ParMesh::PrintAsOne</a>(std::ostream &amp;os)<span class="keyword"> const</span></div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;   <span class="keywordtype">int</span> i, j, k, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, nv_ne[2], &amp;nv = nv_ne[0], &amp;ne = nv_ne[1], vc;</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> *v;</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;   MPI_Status status;</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;double&gt;</a> vert;</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ints;</div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;</div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;   {</div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;MFEM mesh v1.0\n&quot;</span>;</div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;</div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <span class="comment">// optional</span></div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      os &lt;&lt;</div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;         <span class="stringliteral">&quot;\n#\n# MFEM Geometry Types (see mesh/geom.hpp):\n#\n&quot;</span></div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;         <span class="stringliteral">&quot;# POINT       = 0\n&quot;</span></div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;         <span class="stringliteral">&quot;# SEGMENT     = 1\n&quot;</span></div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;         <span class="stringliteral">&quot;# TRIANGLE    = 2\n&quot;</span></div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;         <span class="stringliteral">&quot;# SQUARE      = 3\n&quot;</span></div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;         <span class="stringliteral">&quot;# TETRAHEDRON = 4\n&quot;</span></div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;         <span class="stringliteral">&quot;# CUBE        = 5\n&quot;</span></div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;         <span class="stringliteral">&quot;# PRISM       = 6\n&quot;</span></div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;         <span class="stringliteral">&quot;#\n&quot;</span>;</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\ndimension\n&quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>;</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;   }</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;</div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;   nv = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>;</div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;   MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;   {</div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\n\nelements\n&quot;</span> &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;      {</div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;         <span class="comment">// processor number + 1 as attribute and geometry type</span></div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;         os &lt;&lt; 1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetGeometryType();</div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;         <span class="comment">// vertices</span></div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;         v  = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;         <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;         {</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;            os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v[j];</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;         }</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;         os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      }</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      vc = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      {</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;         MPI_Recv(nv_ne, 2, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(ne);</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;         <span class="keywordflow">if</span> (ne)</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;         {</div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;            MPI_Recv(&amp;ints[0], ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;         }</div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; ne; )</div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;         {</div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;            <span class="comment">// processor number + 1 as attribute and geometry type</span></div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;            os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; ints[i];</div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;            <span class="comment">// vertices</span></div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;            k = <a class="code" href="namespacemfem.html#a4310501b6df5bda8f82fc045015b40a8">Geometries</a>.<a class="code" href="classmfem_1_1Geometry.html#afb55a0fedd48df0fcd524b9dce60589b">GetVertices</a>(ints[i++])-&gt;<a class="code" href="classmfem_1_1IntegrationRule.html#a65a041b5cd5417664446932fa946409d">GetNPoints</a>();</div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; k; j++)</div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;            {</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;               os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vc + ints[i++];</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            }</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;         }</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;         vc += nv;</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      }</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;   }</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;   {</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;      <span class="comment">// for each element send its geometry type and its vertices</span></div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;      ne = 0;</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;      {</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;         ne += 1 + <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;      }</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;      nv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;      MPI_Send(nv_ne, 2, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;</div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;      ints.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(ne);</div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;      ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;      {</div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;         dump_element(<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i], ints);</div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;      }</div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;      MFEM_ASSERT(ints.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() == ne, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;      <span class="keywordflow">if</span> (ne)</div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;      {</div><div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;         MPI_Send(&amp;ints[0], ne, MPI_INT, 0, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;      }</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;   }</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;   <span class="comment">// boundary + shared boundary</span></div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;   ne = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>;</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>)</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;   {</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;      ne += <a class="code" href="classmfem_1_1ParMesh.html#a203856446d235b6f467592cc84336f3e">GetNSharedFaces</a>();</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;   }</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1)</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;   {</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCMesh::NCList</a> &amp;list = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#ad4148905bd3ce26e861a013161acf82d">GetSharedList</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> - 1);</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;      ne += list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>.Size() + list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">masters</a>.Size() + list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>.Size();</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;      <span class="comment">// In addition to the number returned by GetNSharedFaces(), include the</span></div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;      <span class="comment">// the master shared faces as well.</span></div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;   }</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;   ints.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(ne * (1 + 2*(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>-1))); <span class="comment">// just an upper bound</span></div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;   ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;   <span class="comment">// for each boundary and shared boundary element send its geometry type</span></div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;   <span class="comment">// and its vertices</span></div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;   ne = 0;</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;   <span class="keywordflow">for</span> (i = j = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;   {</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;      dump_element(<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i], ints); ne++;</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;   }</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>)</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;   {</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;      <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>)</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;      {</div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;         <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;            {</div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;               ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a3a4eeb8006188bea7c806ebbef23ca90">Geometry::POINT</a>);</div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;               ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[i]);</div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;               ne++;</div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;            }</div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;</div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;         <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); i++)</div><div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;            {</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;               dump_element(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i], ints); ne++;</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;            }</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;         <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); i++)</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;            {</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;               ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>);</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;               ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v, 3);</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;               ne++;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;            }</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size(); i++)</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;            {</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;               ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>);</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;               ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[i].v, 4);</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;               ne++;</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;            }</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;            MFEM_ABORT(<span class="stringliteral">&quot;invalid dimension: &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>);</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;      }</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;   }</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt; 1)</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;   {</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCMesh::NCList</a> &amp;list = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>-&gt;<a class="code" href="classmfem_1_1ParNCMesh.html#ad4148905bd3ce26e861a013161acf82d">GetSharedList</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> - 1);</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nfaces = <a class="code" href="classmfem_1_1Mesh.html#a2249b56c56f685bb6a14b74921e77199">GetNumFaces</a>();</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>.Size(); i++)</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;      {</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">conforming</a>[i].index;</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> &lt; nfaces) { dump_element(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>], ints); ne++; }</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;      }</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">masters</a>.Size(); i++)</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      {</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">masters</a>[i].index;</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> &lt; nfaces) { dump_element(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>], ints); ne++; }</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;      }</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;      <span class="keywordflow">for</span> (i = 0; i &lt; list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>.Size(); i++)</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;      {</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = list.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">slaves</a>[i].index;</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> &lt; nfaces) { dump_element(<a class="code" href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">faces</a>[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>], ints); ne++; }</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;      }</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;   }</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;   MPI_Reduce(&amp;ne, &amp;k, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;   {</div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\nboundary\n&quot;</span> &lt;&lt; k &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      vc = 0;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 0; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;      {</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>)</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;         {</div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;            MPI_Recv(nv_ne, 2, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(ne);</div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;            <span class="keywordflow">if</span> (ne)</div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;            {</div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;               MPI_Recv(ints.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;            }</div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;         }</div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;         {</div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;            ne = ints.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;            nv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;         }</div><div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; ne; )</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;         {</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;            <span class="comment">// processor number + 1 as bdr. attr. and bdr. geometry type</span></div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;            os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1 &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; ints[i];</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;            k = <a class="code" href="namespacemfem.html#a4310501b6df5bda8f82fc045015b40a8">Geometries</a>.<a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">NumVerts</a>[ints[i++]];</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;            <span class="comment">// vertices</span></div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; k; j++)</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;            {</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;               os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vc + ints[i++];</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;            }</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;         }</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;         vc += nv;</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      }</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;   }</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;   {</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;      nv = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;      ne = ints.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;      MPI_Send(nv_ne, 2, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;      <span class="keywordflow">if</span> (ne)</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;      {</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;         MPI_Send(ints.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), ne, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;      }</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;   }</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;   <span class="comment">// vertices / nodes</span></div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;   MPI_Reduce(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;   {</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\nvertices\n&quot;</span> &lt;&lt; nv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;   }</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a> == NULL)</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;   {</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;      {</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;         os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;         {</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](0);</div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;            <span class="keywordflow">for</span> (j = 1; j &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; j++)</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;            {</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;               os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;            }</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;         }</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;         {</div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 448, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;            vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(nv*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>);</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;            <span class="keywordflow">if</span> (nv)</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;            {</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;               MPI_Recv(&amp;vert[0], nv*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, MPI_DOUBLE, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 449, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;            }</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; nv; i++)</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;            {</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;               os &lt;&lt; vert[i*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>];</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;               <span class="keywordflow">for</span> (j = 1; j &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; j++)</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;               {</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                  os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; vert[i*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>+j];</div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;               }</div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;            }</div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;         }</div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;         os.flush();</div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;      }</div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;      {</div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 448, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;         vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>);</div><div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;         {</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; j++)</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;            {</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;               vert[i*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>+j] = <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;            }</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;         }</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>)</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;         {</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;            MPI_Send(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, MPI_DOUBLE, 0, 449, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;         }</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;      }</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;   }</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;   {</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;      {</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\nnodes\n&quot;</span>;</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      }</div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *pnodes = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> *<span class="keyword">&gt;</span>(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>);</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="keywordflow">if</span> (pnodes)</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      {</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;         pnodes-&gt;<a class="code" href="classmfem_1_1ParGridFunction.html#ac76417ffa33e7c502d830148397bafae">SaveAsOne</a>(os);</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      }</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;      {</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;         <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *pfes =</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;            <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> *<span class="keyword">&gt;</span>(<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>());</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;         <span class="keywordflow">if</span> (pfes)</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;         {</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;            <span class="comment">// create a wrapper ParGridFunction</span></div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;            <a class="code" href="classmfem_1_1ParGridFunction.html">ParGridFunction</a> ParNodes(pfes, <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>);</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;            ParNodes.<a class="code" href="classmfem_1_1ParGridFunction.html#ac76417ffa33e7c502d830148397bafae">SaveAsOne</a>(os);</div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;         }</div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;         {</div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;            <a class="code" href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem_error</a>(<span class="stringliteral">&quot;ParMesh::PrintAsOne : Nodes have no parallel info!&quot;</span>);</div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;         }</div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;      }</div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;   }</div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;}</div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;</div><div class="line"><a name="l05292"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a77d9d95321f54573d795660125f758b5"> 5292</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a77d9d95321f54573d795660125f758b5">ParMesh::PrintAsSerial</a>(std::ostream &amp;os)<span class="keyword"> const</span></div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;   <span class="keywordtype">int</span> save_rank = 0;</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> serialmesh = <a class="code" href="classmfem_1_1ParMesh.html#a01d3de80a43b0e1b7f34b64497646ac5">GetSerialMesh</a>(save_rank);</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == save_rank)</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;   {</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      serialmesh.<a class="code" href="classmfem_1_1Mesh.html#afc8694e930d1db54abc3833d44504229">Printer</a>(os);</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;   }</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;   MPI_Barrier(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;}</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;</div><div class="line"><a name="l05303"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a01d3de80a43b0e1b7f34b64497646ac5"> 5303</a></span>&#160;<a class="code" href="classmfem_1_1Mesh.html">Mesh</a> <a class="code" href="classmfem_1_1ParMesh.html#a01d3de80a43b0e1b7f34b64497646ac5">ParMesh::GetSerialMesh</a>(<span class="keywordtype">int</span> save_rank)<span class="keyword"> const</span></div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> || <a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;   {</div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Nonconforming meshes and NURBS meshes are not yet supported.&quot;</span>);</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;   }</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;   <span class="comment">// Define linear H1 space for vertex numbering</span></div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;   <a class="code" href="classmfem_1_1H1__FECollection.html">H1_FECollection</a> fec_linear(1, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>);</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *pm = <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> pfespace_linear(pm, &amp;fec_linear);</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> ne_glob_l = <a class="code" href="classmfem_1_1Mesh.html#ac0221ba9089ee9e6cb81546177977c97">GetGlobalNE</a>(); <span class="comment">// needs to be called by all ranks</span></div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;   MFEM_VERIFY(<span class="keywordtype">int</span>(ne_glob_l) == ne_glob_l,</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;               <span class="stringliteral">&quot;overflow in the number of elements!&quot;</span>);</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;   <span class="keywordtype">int</span> ne_glob = (save_rank == <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>) ? <span class="keywordtype">int</span>(ne_glob_l) : 0;</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> nvertices = pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#a1a65f4990fb94bc1333fabd42e7b056c">GetTrueVSize</a>();</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> nvertices_glob_l = 0;</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;   MPI_Reduce(&amp;nvertices, &amp;nvertices_glob_l, 1, MPI_LONG_LONG, MPI_SUM,</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;              save_rank, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;   <span class="keywordtype">int</span> nvertices_glob = int(nvertices_glob_l);</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;   MFEM_VERIFY(nvertices_glob == nvertices_glob_l,</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;               <span class="stringliteral">&quot;overflow in the number of vertices!&quot;</span>);</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> nbe = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>;</div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> nbe_glob_l = 0;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;   MPI_Reduce(&amp;nbe, &amp;nbe_glob_l, 1, MPI_LONG_LONG, MPI_SUM, save_rank, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;   <span class="keywordtype">int</span> nbe_glob = int(nbe_glob_l);</div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;   MFEM_VERIFY(nbe_glob == nbe_glob_l,</div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;               <span class="stringliteral">&quot;overflow in the number of boundary elements!&quot;</span>);</div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;</div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;   <span class="comment">// On ranks other than save_rank, the *_glob variables are 0, so the serial</span></div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;   <span class="comment">// mesh is empty.</span></div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> serialmesh(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>, nvertices_glob, ne_glob, nbe_glob, <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>);</div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;</div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;   <span class="keywordtype">int</span> n_send_recv;</div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;   MPI_Status status;</div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;double&gt;</a> vert;</div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ints, dofs;</div><div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;   <span class="comment">// First set the connectivity of serial mesh using the True Dofs from</span></div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;   <span class="comment">// the linear H1 space.</span></div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == save_rank)</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;   {</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; e++)</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;      {</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[e]-&gt;GetAttribute();</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> geom_type = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[e]-&gt;GetGeometryType();</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;         pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#abbe5721f5b01fb4c1f174ee9e2662d25">GetElementDofs</a>(e, dofs);</div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;         {</div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;            dofs[j] = pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(dofs[j]);</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;         }</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;         <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(geom_type);</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;         elem-&gt;<a class="code" href="classmfem_1_1Element.html#a68f17653a78f9d85c29a1e486a25ddaf">SetAttribute</a>(attr);</div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;         elem-&gt;<a class="code" href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">SetVertices</a>(dofs);</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;         serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a7b0ebfbab71ebba875e7b45223899167">AddElement</a>(elem);</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;      }</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;</div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 0; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      {</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> == save_rank) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;         MPI_Recv(&amp;n_send_recv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(n_send_recv);</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;         <span class="keywordflow">if</span> (n_send_recv)</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;         {</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;            MPI_Recv(&amp;ints[0], n_send_recv, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;         }</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_send_recv; )</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;         {</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;            <span class="keywordtype">int</span> attr = ints[i++];</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;            <span class="keywordtype">int</span> geom_type = ints[i++];</div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;            <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(geom_type);</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;            elem-&gt;<a class="code" href="classmfem_1_1Element.html#a68f17653a78f9d85c29a1e486a25ddaf">SetAttribute</a>(attr);</div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;            elem-&gt;<a class="code" href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">SetVertices</a>(&amp;ints[i]); i += <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom_type];</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;            serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a7b0ebfbab71ebba875e7b45223899167">AddElement</a>(elem);</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;         }</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;      }</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;   }</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;   {</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;      n_send_recv = 0;</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; e++)</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;      {</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;         n_send_recv += 2 + <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[e]-&gt;GetNVertices();</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;      }</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;      MPI_Send(&amp;n_send_recv, 1, MPI_INT, save_rank, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;      ints.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(n_send_recv);</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;      ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; e++)</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;      {</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[e]-&gt;GetAttribute();</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> geom_type = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[e]-&gt;GetGeometryType();;</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(attr);</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(geom_type);</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;         pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#abbe5721f5b01fb4c1f174ee9e2662d25">GetElementDofs</a>(e, dofs);</div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;         {</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(dofs[j]));</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;         }</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;      }</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;      <span class="keywordflow">if</span> (n_send_recv)</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;      {</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;         MPI_Send(&amp;ints[0], n_send_recv, MPI_INT, save_rank, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;      }</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;   }</div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;   <span class="comment">// Write out boundary elements</span></div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == save_rank)</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;   {</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; e++)</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;      {</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[e]-&gt;GetAttribute();</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> geom_type = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[e]-&gt;GetGeometryType();</div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;         pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ab3e15ea1d8c5d0a3143442b295b84f66">GetBdrElementDofs</a>(e, dofs);</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;         {</div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;            dofs[j] = pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(dofs[j]);</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;         }</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;         <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(geom_type);</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;         elem-&gt;<a class="code" href="classmfem_1_1Element.html#a68f17653a78f9d85c29a1e486a25ddaf">SetAttribute</a>(attr);</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;         elem-&gt;<a class="code" href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">SetVertices</a>(dofs);</div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;         serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a143ec47e53707b29accd8994058830b9">AddBdrElement</a>(elem);</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;      }</div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;</div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 0; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;      {</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> == save_rank) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;         MPI_Recv(&amp;n_send_recv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(n_send_recv);</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;         <span class="keywordflow">if</span> (n_send_recv)</div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;         {</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;            MPI_Recv(&amp;ints[0], n_send_recv, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;         }</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_send_recv; )</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;         {</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;            <span class="keywordtype">int</span> attr = ints[i++];</div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;            <span class="keywordtype">int</span> geom_type = ints[i++];</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;            <a class="code" href="classmfem_1_1Element.html">Element</a> *elem = serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(geom_type);</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;            elem-&gt;<a class="code" href="classmfem_1_1Element.html#a68f17653a78f9d85c29a1e486a25ddaf">SetAttribute</a>(attr);</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;            elem-&gt;<a class="code" href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">SetVertices</a>(&amp;ints[i]); i += <a class="code" href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">Geometry::NumVerts</a>[geom_type];</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;            serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a143ec47e53707b29accd8994058830b9">AddBdrElement</a>(elem);</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;         }</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;      }</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;   } <span class="comment">// MyRank == save_rank</span></div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;   {</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;      n_send_recv = 0;</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; e++)</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;      {</div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;         n_send_recv += 2 + <a class="code" href="classmfem_1_1Mesh.html#aec099666a5e112fda3386c40ad89bfc5">GetBdrElement</a>(e)-&gt;<a class="code" href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">GetNVertices</a>();</div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;      }</div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;      MPI_Send(&amp;n_send_recv, 1, MPI_INT, save_rank, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      ints.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(n_send_recv);</div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;      ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; e++)</div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;      {</div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> attr = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[e]-&gt;GetAttribute();</div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> geom_type = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[e]-&gt;GetGeometryType();</div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(attr);</div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(geom_type);</div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;         pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ab3e15ea1d8c5d0a3143442b295b84f66">GetBdrElementDofs</a>(e, dofs);</div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;         {</div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(pfespace_linear.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(dofs[j]));</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;         }</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;      }</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;      <span class="keywordflow">if</span> (n_send_recv)</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;      {</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;         MPI_Send(&amp;ints[0], n_send_recv, MPI_INT, save_rank, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;      }</div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;   } <span class="comment">// MyRank != save_rank</span></div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == save_rank)</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;   {</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v = 0; v &lt; nvertices_glob; v++)</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;      {</div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;         serialmesh.<a class="code" href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">AddVertex</a>(0.0); <span class="comment">// all other coordinates are 0 by default</span></div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;      }</div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;      serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a5d5f2a1b3e88520e2063feac1ec006ab">FinalizeTopology</a>();</div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;   }</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;   <span class="comment">// From each processor, we send element-wise vertex/dof locations and</span></div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;   <span class="comment">// overwrite the vertex/dof locations of the serial mesh.</span></div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == save_rank &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;   {</div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;      <a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a> *fespace_serial = NULL;</div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;      <span class="comment">// Duplicate the FE collection to make sure the serial mesh is completely</span></div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;      <span class="comment">// independent of the parallel mesh:</span></div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;      <span class="keyword">auto</span> fec_serial = <a class="code" href="classmfem_1_1FiniteElementCollection.html#a15fcfa553d4949eb08f9926ac74d1e80">FiniteElementCollection::New</a>(</div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;                           <a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>()-&gt;FEColl()-&gt;Name());</div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;      fespace_serial = <span class="keyword">new</span> <a class="code" href="classmfem_1_1FiniteElementSpace.html">FiniteElementSpace</a>(&amp;serialmesh,</div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;                                              fec_serial,</div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;                                              <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>,</div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;                                              <a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>()-&gt;GetOrdering());</div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;      serialmesh.<a class="code" href="classmfem_1_1Mesh.html#abf310dd4bd2b603cf1c1c6c1006ded0b">SetNodalFESpace</a>(fespace_serial);</div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;      serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;MakeOwner(fec_serial);</div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;      <span class="comment">// The serial mesh owns its Nodes and they, in turn, own fec_serial and</span></div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;      <span class="comment">// fespace_serial.</span></div><div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;   }</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;   <span class="keywordtype">int</span> elem_count = 0; <span class="comment">// To keep track of element count in serial mesh</span></div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == save_rank)</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;   {</div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;      <a class="code" href="classmfem_1_1Vector.html">Vector</a> nodeloc;</div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ints_serial;</div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; e++)</div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;      {</div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;         {</div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a6873da85b99606ee8621635f388034cf">GetElementDofValues</a>(e, nodeloc);</div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;            serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>()-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6ac2fad2ec742d60cb17dc8d873b46aa">GetElementVDofs</a>(elem_count++, dofs);</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;            serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;SetSubVector(dofs, nodeloc);</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;         }</div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;         {</div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#a2a373eb2c566226e38bf9804b76d003a">GetElementVertices</a>(e, ints);</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;            serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a2a373eb2c566226e38bf9804b76d003a">GetElementVertices</a>(elem_count++, ints_serial);</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ints.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;            {</div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">double</span> *vdata = <a class="code" href="classmfem_1_1Mesh.html#aeefcdb017ae9e14993d3e4ba21dd56e4">GetVertex</a>(ints[i]);</div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;               <span class="keywordtype">double</span> *vdata_serial = serialmesh.<a class="code" href="classmfem_1_1Mesh.html#aeefcdb017ae9e14993d3e4ba21dd56e4">GetVertex</a>(ints_serial[i]);</div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; d++)</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;               {</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;                  vdata_serial[d] = vdata[d];</div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;               }</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;            }</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;         }</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;      }</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;</div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 0; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;      {</div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> == save_rank) { <span class="keywordflow">continue</span>; }</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;         MPI_Recv(&amp;n_send_recv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 448, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;         vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(n_send_recv);</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;         <span class="keywordflow">if</span> (n_send_recv)</div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;         {</div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;            MPI_Recv(&amp;vert[0], n_send_recv, MPI_DOUBLE, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 449, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;         }</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_send_recv; )</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;         {</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;            {</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;               serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">GetNodalFESpace</a>()-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6ac2fad2ec742d60cb17dc8d873b46aa">GetElementVDofs</a>(elem_count++, dofs);</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;               serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">GetNodes</a>()-&gt;SetSubVector(dofs, &amp;vert[i]);</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;               i += dofs.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;            }</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;            {</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;               serialmesh.<a class="code" href="classmfem_1_1Mesh.html#a2a373eb2c566226e38bf9804b76d003a">GetElementVertices</a>(elem_count++, ints_serial);</div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; ints_serial.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;               {</div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;                  <span class="keywordtype">double</span> *vdata_serial = serialmesh.<a class="code" href="classmfem_1_1Mesh.html#aeefcdb017ae9e14993d3e4ba21dd56e4">GetVertex</a>(ints_serial[j]);</div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; d++)</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;                  {</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;                     vdata_serial[d] = vert[i++];</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;                  }</div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;               }</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;            }</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;         }</div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;      }</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;   } <span class="comment">// MyRank == save_rank</span></div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;   {</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;      n_send_recv = 0;</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;      <a class="code" href="classmfem_1_1Vector.html">Vector</a> nodeloc;</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; e++)</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;      {</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;         {</div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;            <span class="keyword">const</span> <a class="code" href="classmfem_1_1FiniteElement.html">FiniteElement</a> *fe = <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">FESpace</a>()-&gt;<a class="code" href="classmfem_1_1FiniteElementSpace.html#a6e60ce794202c56cc58d1141deec6905">GetFE</a>(e);</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;            n_send_recv += <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>*fe-&gt;<a class="code" href="classmfem_1_1FiniteElement.html#af4408ffc73146fc6bf710bd95ddc682c">GetDof</a>();</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;         }</div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;         {</div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;            n_send_recv += <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[e]-&gt;GetNVertices()*<a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>;</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;         }</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;      }</div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;      MPI_Send(&amp;n_send_recv, 1, MPI_INT, save_rank, 448, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      vert.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(n_send_recv);</div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;      vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> e = 0; e &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; e++)</div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;      {</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>)</div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;         {</div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">Nodes</a>-&gt;<a class="code" href="classmfem_1_1GridFunction.html#a6873da85b99606ee8621635f388034cf">GetElementDofValues</a>(e, nodeloc);</div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nodeloc.<a class="code" href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">Size</a>(); j++)</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;            {</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;               vert.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(nodeloc(j));</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;            }</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;         }</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;         {</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#a2a373eb2c566226e38bf9804b76d003a">GetElementVertices</a>(e, ints);</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ints.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); i++)</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;            {</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">double</span> *vdata = <a class="code" href="classmfem_1_1Mesh.html#aeefcdb017ae9e14993d3e4ba21dd56e4">GetVertex</a>(ints[i]);</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>; d++)</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;               {</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;                  vert.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(vdata[d]);</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;               }</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;            }</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;         }</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      }</div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;      <span class="keywordflow">if</span> (n_send_recv)</div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;      {</div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;         MPI_Send(&amp;vert[0], n_send_recv, MPI_DOUBLE, save_rank, 449, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;      }</div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;   }</div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;</div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;   MPI_Barrier(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;   <span class="keywordflow">return</span> serialmesh;</div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;}</div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;</div><div class="line"><a name="l05618"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a25bb6753ff4ba80b9bf70a94b8192857"> 5618</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a25bb6753ff4ba80b9bf70a94b8192857">ParMesh::SaveAsOne</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname, <span class="keywordtype">int</span> precision)<span class="keyword"> const</span></div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;   ofstream ofs;</div><div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;   {</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      ofs.open(fname);</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;      ofs.precision(precision);</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;   }</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a55ad4b875a6943bd34bf10774c7d1c82">PrintAsOne</a>(ofs);</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;}</div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;</div><div class="line"><a name="l05629"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aca7e3873c8ca264f6a95535b648f1de0"> 5629</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#aca7e3873c8ca264f6a95535b648f1de0">ParMesh::PrintAsOneXG</a>(std::ostream &amp;os)</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;{</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, <span class="stringliteral">&quot;2D Manifolds not supported.&quot;</span>);</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 1)</div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;   {</div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;      <span class="keywordtype">int</span> i, j, k, nv, ne, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>;</div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *ind, *v;</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      MPI_Status status;</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;double&gt;</a> vert;</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ints;</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      {</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;NETGEN_Neutral_Format\n&quot;</span>;</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;         <span class="comment">// print the vertices</span></div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;         MPI_Reduce(&amp;ne, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;         os &lt;&lt; nv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;         {</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;            {</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;               os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;            }</div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;         }</div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;         {</div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;            vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*nv);</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;            MPI_Recv(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*nv, MPI_DOUBLE, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; nv; i++)</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;            {</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;               {</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+j];</div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;               }</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;            }</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;         }</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;</div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;         <span class="comment">// print the elements</span></div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>;</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;         MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;         os &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;         {</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;            nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;            ind = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;            os &lt;&lt; 1;</div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;            {</div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;               os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;            }</div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;         }</div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;         k = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;         {</div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;            MPI_Recv(&amp;ne, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(4*ne);</div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;            MPI_Recv(&amp;ints[0], 4*ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; ne; i++)</div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;            {</div><div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;               os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1;</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;               {</div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k+ints[i*4+j]+1;</div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;               }</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;            }</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;            k += nv;</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;         }</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;         <span class="comment">// print the boundary + shared faces information</span></div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;         MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;         os &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;         <span class="comment">// boundary</span></div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;         {</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;            nv = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;            ind = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;            os &lt;&lt; 1;</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;            {</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;               os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;            }</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;         }</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;         <span class="comment">// shared faces</span></div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> sf_attr =</div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> + 1 + (<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0 ? <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">Max</a>() : 0);</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>.Size(); i++)</div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;         {</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;            ind = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i].v;</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;            os &lt;&lt; sf_attr;</div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;            {</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;               os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;            }</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;         }</div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;         <span class="comment">// There are no quad shared faces</span></div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;         k = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;         {</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;            MPI_Recv(&amp;ne, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3*ne);</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;            MPI_Recv(&amp;ints[0], 3*ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; ne; i++)</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;            {</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;               os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1;</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;               {</div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;                  os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; k+ints[i*3+j]+1;</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;               }</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;            }</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;            k += nv;</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;         }</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;      }</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;      {</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;         MPI_Reduce(&amp;ne, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;         vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;            {</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;               vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+j] = <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;            }</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;         MPI_Send(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, MPI_DOUBLE,</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;                  0, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;         <span class="comment">// elements</span></div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>;</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;         MPI_Reduce(&amp;ne, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, 1, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>*4);</div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;         {</div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;            v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;            {</div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;               ints[4*i+j] = v[j];</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;            }</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;         }</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;         MPI_Send(&amp;ints[0], 4*<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;         <span class="comment">// boundary + shared faces</span></div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;         MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;         MPI_Send(&amp;ne, 1, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3*ne);</div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;         {</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;            v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;            {</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;               ints[3*i+j] = v[j];</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;            }</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;         }</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;         <span class="keywordflow">for</span> ( ; i &lt; ne; i++)</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;         {</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;            v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[i-<a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>].v; <span class="comment">// tet mesh</span></div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;            {</div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;               ints[3*i+j] = v[j];</div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;            }</div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;         }</div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;         MPI_Send(&amp;ints[0], 3*ne, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;      }</div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;   }</div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;</div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3 &amp;&amp; <a class="code" href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">meshgen</a> == 2)</div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;   {</div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;      <span class="keywordtype">int</span> i, j, k, nv, ne, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>;</div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *ind, *v;</div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;      MPI_Status status;</div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;double&gt;</a> vert;</div><div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ints;</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;      <span class="keywordtype">int</span> TG_nv, TG_ne, TG_nbe;</div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;</div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;      {</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;         MPI_Reduce(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, &amp;TG_nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;         MPI_Reduce(&amp;<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, &amp;TG_ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;         MPI_Reduce(&amp;nv, &amp;TG_nbe, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;TrueGrid\n&quot;</span></div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;1 &quot;</span> &lt;&lt; TG_nv &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; TG_ne &lt;&lt; <span class="stringliteral">&quot; 0 0 0 0 0 0 0\n&quot;</span></div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;0 0 0 1 0 0 0 0 0 0 0\n&quot;</span></div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;0 0 &quot;</span> &lt;&lt; TG_nbe &lt;&lt; <span class="stringliteral">&quot; 0 0 0 0 0 0 0 0 0 0 0 0 0\n&quot;</span></div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;0.0 0.0 0.0 0 0 0.0 0.0 0 0.0\n&quot;</span></div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n&quot;</span>;</div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;         <span class="comment">// print the vertices</span></div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;         nv = TG_nv;</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;         {</div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;            os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; 0.0 &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](1)</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](2) &lt;&lt; <span class="stringliteral">&quot; 0.0\n&quot;</span>;</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;         }</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;         {</div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;            vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*nv);</div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;            MPI_Recv(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*nv, MPI_DOUBLE, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; nv; i++)</div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;            {</div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;               os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; 0.0 &quot;</span> &lt;&lt; vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+1]</div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+2] &lt;&lt; <span class="stringliteral">&quot; 0.0\n&quot;</span>;</div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;            }</div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;         }</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;</div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;         <span class="comment">// print the elements</span></div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;         ne = TG_ne;</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;         {</div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;            nv = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;            ind = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;            os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 1;</div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;            {</div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;               os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;            }</div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;         }</div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;         k = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;         {</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;            MPI_Recv(&amp;ne, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(8*ne);</div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;            MPI_Recv(&amp;ints[0], 8*ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; ne; i++)</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;            {</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;               os &lt;&lt; i+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1;</div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; 8; j++)</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;               {</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k+ints[i*8+j]+1;</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;               }</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;            }</div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;            k += nv;</div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;         }</div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;</div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;         <span class="comment">// print the boundary + shared faces information</span></div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;         ne = TG_nbe;</div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;         <span class="comment">// boundary</span></div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;         {</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;            nv = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetNVertices();</div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;            ind = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;            os &lt;&lt; 1;</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)</div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;            {</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;               os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;            }</div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; 1.0 1.0 1.0 1.0\n&quot;</span>;</div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;         }</div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;         <span class="comment">// shared faces</span></div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> sf_attr =</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> + 1 + (<a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &gt; 0 ? <a class="code" href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">bdr_attributes</a>.<a class="code" href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">Max</a>() : 0);</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;         <span class="comment">// There are no shared triangle faces</span></div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>.Size(); i++)</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;         {</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;            ind = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[i].v;</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;            os &lt;&lt; sf_attr;</div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;            {</div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;               os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; ind[j]+1;</div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;            }</div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; 1.0 1.0 1.0 1.0\n&quot;</span>;</div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;         }</div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;         k = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;         {</div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;            MPI_Recv(&amp;ne, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(4*ne);</div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;            MPI_Recv(&amp;ints[0], 4*ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; ne; i++)</div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;            {</div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;               os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1;</div><div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;               {</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k+ints[i*4+j]+1;</div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;               }</div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;               os &lt;&lt; <span class="stringliteral">&quot; 1.0 1.0 1.0 1.0\n&quot;</span>;</div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;            }</div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;            k += nv;</div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;         }</div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;      }</div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;      {</div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;         MPI_Reduce(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, &amp;TG_nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;         MPI_Reduce(&amp;<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, &amp;TG_ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;         MPI_Reduce(&amp;nv, &amp;TG_nbe, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;</div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;         vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;            {</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;               vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+j] = <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;            }</div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;         MPI_Send(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, MPI_DOUBLE, 0, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;         <span class="comment">// elements</span></div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, 1, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>*8);</div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;         {</div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;            v = <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 8; j++)</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;            {</div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;               ints[8*i+j] = v[j];</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;            }</div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;         }</div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;         MPI_Send(&amp;ints[0], 8*<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;         <span class="comment">// boundary + shared faces</span></div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>();</div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;         MPI_Send(&amp;ne, 1, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(4*ne);</div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;         {</div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;            v = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices();</div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;            {</div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;               ints[4*i+j] = v[j];</div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;            }</div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;         }</div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;         <span class="keywordflow">for</span> ( ; i &lt; ne; i++)</div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;         {</div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;            v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[i-<a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>].v; <span class="comment">// hex mesh</span></div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 4; j++)</div><div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;            {</div><div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;               ints[4*i+j] = v[j];</div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;            }</div><div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;         }</div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;         MPI_Send(&amp;ints[0], 4*ne, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;      }</div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;   }</div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;</div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;   {</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;      <span class="keywordtype">int</span> i, j, k, attr, nv, ne, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>;</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> v;</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;      MPI_Status status;</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;double&gt;</a> vert;</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> ints;</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;      {</div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;areamesh2\n\n&quot;</span>;</div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;</div><div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;         <span class="comment">// print the boundary + shared edges information</span></div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size();</div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;         MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;         os &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;         <span class="comment">// boundary</span></div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;         {</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;            attr = <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;            os &lt;&lt; attr &lt;&lt; <span class="stringliteral">&quot;     &quot;</span>;</div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; v.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;            {</div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;               os &lt;&lt; v[j] + 1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;            }</div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;         }</div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;         <span class="comment">// shared edges</span></div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); i++)</div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;         {</div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;            attr = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i]-&gt;GetAttribute();</div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;            os &lt;&lt; attr &lt;&lt; <span class="stringliteral">&quot;     &quot;</span>;</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; v.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;            {</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;               os &lt;&lt; v[j] + 1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;            }</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;         }</div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;         k = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;         {</div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;            MPI_Recv(&amp;ne, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(2*ne);</div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;            MPI_Recv(&amp;ints[0], 2*ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; ne; i++)</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;            {</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;               os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1;</div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++)</div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;               {</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k+ints[i*2+j]+1;</div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;               }</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;            }</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;            k += nv;</div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;         }</div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;         <span class="comment">// print the elements</span></div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>;</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;         MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;         os &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;         {</div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;            <span class="comment">// attr = elements[i]-&gt;GetAttribute(); // not used</span></div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;            os &lt;&lt; 1 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; 3 &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>;</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; v.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>(); j++)</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;            {</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;               os &lt;&lt; v[j] + 1 &lt;&lt; <span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;            }</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;         }</div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;         k = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;         {</div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;            MPI_Recv(&amp;ne, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;            ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3*ne);</div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;            MPI_Recv(&amp;ints[0], 3*ne, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; ne; i++)</div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;            {</div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;               os &lt;&lt; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>+1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; 3;</div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;               {</div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k+ints[i*3+j]+1;</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;               }</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;            }</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;            k += nv;</div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;         }</div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;</div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;         <span class="comment">// print the vertices</span></div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;         MPI_Reduce(&amp;ne, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;         os &lt;&lt; nv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;         {</div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;            {</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;               os &lt;&lt; <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;            }</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;         }</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;         <span class="keywordflow">for</span> (<a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> = 1; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a> &lt; <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>++)</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;         {</div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;            MPI_Recv(&amp;nv, 1, MPI_INT, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;            vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*nv);</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;            MPI_Recv(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*nv, MPI_DOUBLE, <a class="code" href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a>, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, &amp;status);</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; nv; i++)</div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;            {</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;               <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;               {</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;                  os &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+j];</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;               }</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;               os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;            }</div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;         }</div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;      }</div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;      {</div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;         <span class="comment">// boundary + shared faces</span></div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;         nv = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size();</div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;         MPI_Reduce(&amp;nv, &amp;ne, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a> + <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size();</div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;         MPI_Send(&amp;ne, 1, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(2*ne);</div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>; i++)</div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;         {</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++)</div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;            {</div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;               ints[2*i+j] = v[j];</div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;            }</div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;         }</div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;         <span class="keywordflow">for</span> ( ; i &lt; ne; i++)</div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;         {</div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;            <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i-<a class="code" href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">NumOfBdrElements</a>]-&gt;GetVertices(v);</div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 2; j++)</div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;            {</div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;               ints[2*i+j] = v[j];</div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;            }</div><div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;         }</div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;         MPI_Send(&amp;ints[0], 2*ne, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;         <span class="comment">// elements</span></div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>;</div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;         MPI_Reduce(&amp;ne, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, 1, MPI_INT, 0, 446, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;         ints.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>*3);</div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;         {</div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;            <a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>[i]-&gt;GetVertices(v);</div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;            {</div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;               ints[3*i+j] = v[j];</div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;            }</div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;         }</div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;         MPI_Send(&amp;ints[0], 3*<a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>, MPI_INT, 0, 447, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;         <span class="comment">// vertices</span></div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;         ne = <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>;</div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;         MPI_Reduce(&amp;ne, &amp;nv, 1, MPI_INT, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;         MPI_Send(&amp;<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, 1, MPI_INT, 0, 444, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;         vert.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>);</div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;         <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>; i++)</div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;            <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>; j++)</div><div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;            {</div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;               vert[<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*i+j] = <a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i](j);</div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;            }</div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;         MPI_Send(&amp;vert[0], <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>*<a class="code" href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">NumOfVertices</a>, MPI_DOUBLE,</div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;                  0, 445, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;      }</div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;   }</div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;}</div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;</div><div class="line"><a name="l06159"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#af3fceede11e97464def19cc712c81d69"> 6159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#af3fceede11e97464def19cc712c81d69">ParMesh::GetBoundingBox</a>(<a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;gp_min, <a class="code" href="classmfem_1_1Vector.html">Vector</a> &amp;gp_max, <span class="keywordtype">int</span> ref)</div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;{</div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;   <span class="keywordtype">int</span> sdim;</div><div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;   <a class="code" href="classmfem_1_1Vector.html">Vector</a> p_min, p_max;</div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;</div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;   this-&gt;<a class="code" href="classmfem_1_1Mesh.html#a66adc8ca8fb91fbe3684ae31fd1b3255">Mesh::GetBoundingBox</a>(p_min, p_max, ref);</div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;</div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;   sdim = <a class="code" href="classmfem_1_1Mesh.html#a8b7a6459b9c4ef0bada3ef9e00dcf082">SpaceDimension</a>();</div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;</div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;   gp_min.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(sdim);</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;   gp_max.<a class="code" href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">SetSize</a>(sdim);</div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;   MPI_Allreduce(p_min.<a class="code" href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">GetData</a>(), gp_min.<a class="code" href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">GetData</a>(), sdim, MPI_DOUBLE,</div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;                 MPI_MIN, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;   MPI_Allreduce(p_max.<a class="code" href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">GetData</a>(), gp_max.<a class="code" href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">GetData</a>(), sdim, MPI_DOUBLE,</div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;                 MPI_MAX, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;}</div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;</div><div class="line"><a name="l06177"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#ae9f0ec7ebdc1d605ad7dcb8b923e9b1e"> 6177</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#ae9f0ec7ebdc1d605ad7dcb8b923e9b1e">ParMesh::GetCharacteristics</a>(<span class="keywordtype">double</span> &amp;gh_min, <span class="keywordtype">double</span> &amp;gh_max,</div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;                                 <span class="keywordtype">double</span> &amp;gk_min, <span class="keywordtype">double</span> &amp;gk_max)</div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;{</div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;   <span class="keywordtype">double</span> h_min, h_max, kappa_min, kappa_max;</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;   this-&gt;<a class="code" href="classmfem_1_1Mesh.html#a499b245ac36db4285f2afe8aaef6e4f5">Mesh::GetCharacteristics</a>(h_min, h_max, kappa_min, kappa_max);</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;</div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;   MPI_Allreduce(&amp;h_min, &amp;gh_min, 1, MPI_DOUBLE, MPI_MIN, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;   MPI_Allreduce(&amp;h_max, &amp;gh_max, 1, MPI_DOUBLE, MPI_MAX, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;   MPI_Allreduce(&amp;kappa_min, &amp;gk_min, 1, MPI_DOUBLE, MPI_MIN, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;   MPI_Allreduce(&amp;kappa_max, &amp;gk_max, 1, MPI_DOUBLE, MPI_MAX, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;}</div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;</div><div class="line"><a name="l06190"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a532357fb36f7b2399d4948b6cd1b365c"> 6190</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a532357fb36f7b2399d4948b6cd1b365c">ParMesh::PrintInfo</a>(std::ostream &amp;os)</div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;{</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;   <span class="keywordtype">int</span> i;</div><div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;   <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> J(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>);</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;   <span class="keywordtype">double</span> h_min, h_max, kappa_min, kappa_max, h, <a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a>;</div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;</div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;   {</div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Parallel Mesh Stats:&quot;</span> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;   }</div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;</div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">NumOfElements</a>; i++)</div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;   {</div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#a5c463f733d1052e424c2b0c26cd46591">GetElementJacobian</a>(i, J);</div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;      h = pow(fabs(J.<a class="code" href="classmfem_1_1DenseMatrix.html#a27f8a22536eab0821bed4ba0790cac6e">Weight</a>()), 1.0/<span class="keywordtype">double</span>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>));</div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;      <a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a> = (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>) ?</div><div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;              J.<a class="code" href="classmfem_1_1DenseMatrix.html#a4618ccff09bb81c70312b642762b7a57">CalcSingularvalue</a>(0) / J.<a class="code" href="classmfem_1_1DenseMatrix.html#a4618ccff09bb81c70312b642762b7a57">CalcSingularvalue</a>(<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>-1) : -1.0;</div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;      <span class="keywordflow">if</span> (i == 0)</div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;      {</div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;         h_min = h_max = h;</div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;         kappa_min = kappa_max = <a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a>;</div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;      }</div><div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;      {</div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;         <span class="keywordflow">if</span> (h &lt; h_min) { h_min = h; }</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;         <span class="keywordflow">if</span> (h &gt; h_max) { h_max = h; }</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a> &lt; kappa_min) { kappa_min = <a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a>; }</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a> &gt; kappa_max) { kappa_max = <a class="code" href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a>; }</div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;      }</div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;   }</div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;</div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;   <span class="keywordtype">double</span> gh_min, gh_max, gk_min, gk_max;</div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;   MPI_Reduce(&amp;h_min, &amp;gh_min, 1, MPI_DOUBLE, MPI_MIN, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;   MPI_Reduce(&amp;h_max, &amp;gh_max, 1, MPI_DOUBLE, MPI_MAX, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;   MPI_Reduce(&amp;kappa_min, &amp;gk_min, 1, MPI_DOUBLE, MPI_MIN, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;   MPI_Reduce(&amp;kappa_max, &amp;gk_max, 1, MPI_DOUBLE, MPI_MAX, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;</div><div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;   <span class="comment">// TODO: collect and print stats by geometry</span></div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> ldata[5]; <span class="comment">// vert, edge, face, elem, neighbors;</span></div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> mindata[5], maxdata[5], sumdata[5];</div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;</div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;   <span class="comment">// count locally owned vertices, edges, and faces</span></div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;   ldata[0] = <a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>();</div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;   ldata[1] = <a class="code" href="classmfem_1_1Mesh.html#a09bf96bbcf2833f005406317841f19b2">GetNEdges</a>();</div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;   ldata[2] = <a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>();</div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;   ldata[3] = <a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>();</div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;   ldata[4] = <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#ae9804f24faea02a9a96a5b81aea520a8">GetNumNeighbors</a>()-1;</div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;   {</div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a0f6d9f13065a78d6b1cf87d37e593e32">IAmMaster</a>(gr)) <span class="comment">// we are not the master</span></div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;      {</div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;         ldata[0] -= <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;         ldata[1] -= <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;         ldata[2] -= <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;         ldata[2] -= <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;      }</div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;   }</div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;   MPI_Reduce(ldata, mindata, 5, MPI_LONG_LONG, MPI_MIN, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;   MPI_Reduce(ldata, sumdata, 5, MPI_LONG_LONG, MPI_SUM, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;   MPI_Reduce(ldata, maxdata, 5, MPI_LONG_LONG, MPI_MAX, 0, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;</div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;   {</div><div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;           &quot;</span></div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;         &lt;&lt; setw(12) &lt;&lt; <span class="stringliteral">&quot;minimum&quot;</span></div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;         &lt;&lt; setw(12) &lt;&lt; <span class="stringliteral">&quot;average&quot;</span></div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;         &lt;&lt; setw(12) &lt;&lt; <span class="stringliteral">&quot;maximum&quot;</span></div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;         &lt;&lt; setw(12) &lt;&lt; <span class="stringliteral">&quot;total&quot;</span> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; vertices  &quot;</span></div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;         &lt;&lt; setw(12) &lt;&lt; mindata[0]</div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[0]/<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a></div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;         &lt;&lt; setw(12) &lt;&lt; maxdata[0]</div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[0] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; edges     &quot;</span></div><div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;         &lt;&lt; setw(12) &lt;&lt; mindata[1]</div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[1]/<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a></div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;         &lt;&lt; setw(12) &lt;&lt; maxdata[1]</div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[1] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 3)</div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;      {</div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot; faces     &quot;</span></div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;            &lt;&lt; setw(12) &lt;&lt; mindata[2]</div><div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;            &lt;&lt; setw(12) &lt;&lt; sumdata[2]/<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a></div><div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;            &lt;&lt; setw(12) &lt;&lt; maxdata[2]</div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;            &lt;&lt; setw(12) &lt;&lt; sumdata[2] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;      }</div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; elements  &quot;</span></div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;         &lt;&lt; setw(12) &lt;&lt; mindata[3]</div><div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[3]/<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a></div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;         &lt;&lt; setw(12) &lt;&lt; maxdata[3]</div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[3] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; neighbors &quot;</span></div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;         &lt;&lt; setw(12) &lt;&lt; mindata[4]</div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;         &lt;&lt; setw(12) &lt;&lt; sumdata[4]/<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a></div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;         &lt;&lt; setw(12) &lt;&lt; maxdata[4] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;       &quot;</span></div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;         &lt;&lt; setw(12) &lt;&lt; <span class="stringliteral">&quot;minimum&quot;</span></div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;         &lt;&lt; setw(12) &lt;&lt; <span class="stringliteral">&quot;maximum&quot;</span> &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; h     &quot;</span></div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;         &lt;&lt; setw(12) &lt;&lt; gh_min</div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;         &lt;&lt; setw(12) &lt;&lt; gh_max &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; kappa &quot;</span></div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;         &lt;&lt; setw(12) &lt;&lt; gk_min</div><div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;         &lt;&lt; setw(12) &lt;&lt; gk_max &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;      os &lt;&lt; std::flush;</div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;   }</div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;}</div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;</div><div class="line"><a name="l06302"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a85c4ec2abbe32b3e45ceeb115d3eb878"> 6302</a></span>&#160;<span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="classmfem_1_1ParMesh.html#a85c4ec2abbe32b3e45ceeb115d3eb878">ParMesh::ReduceInt</a>(<span class="keywordtype">int</span> value)<span class="keyword"> const</span></div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;   <span class="keywordtype">long</span> <span class="keywordtype">long</span> local = value, global;</div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;   MPI_Allreduce(&amp;local, &amp;global, 1, MPI_LONG_LONG, MPI_SUM, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;   <span class="keywordflow">return</span> global;</div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;}</div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;</div><div class="line"><a name="l06309"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a7ebd0fa46057255dcc412d8b76e5ead4"> 6309</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a7ebd0fa46057255dcc412d8b76e5ead4">ParMesh::ParPrint</a>(ostream &amp;os)<span class="keyword"> const</span></div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">NURBSext</a>)</div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;   {</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;      <span class="comment">// TODO: NURBS meshes.</span></div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#afa7fefbe7831d5e3b514d4d84ff129ef">Print</a>(os); <span class="comment">// use the serial MFEM v1.0 format for now</span></div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;   }</div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;</div><div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">Nonconforming</a>())</div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;   {</div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;      <span class="comment">// the NC mesh format works both in serial and in parallel</span></div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#afc8694e930d1db54abc3833d44504229">Printer</a>(os);</div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;   }</div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;</div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;   <span class="comment">// Write out serial mesh.  Tell serial mesh to deliniate the end of it&#39;s</span></div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;   <span class="comment">// output with &#39;mfem_serial_mesh_end&#39; instead of &#39;mfem_mesh_end&#39;, as we will</span></div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;   <span class="comment">// be adding additional parallel mesh information.</span></div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#afc8694e930d1db54abc3833d44504229">Printer</a>(os, <span class="stringliteral">&quot;mfem_serial_mesh_end&quot;</span>);</div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;</div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;   <span class="comment">// write out group topology info.</span></div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a34d8919e16670b0034d53d9b6ea258b5">Save</a>(os);</div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;</div><div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\ntotal_shared_vertices &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;   {</div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;total_shared_edges &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;   }</div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;   {</div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;total_shared_faces &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;   }</div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;   {</div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;      {</div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  nv = <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *sv = <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\n# group &quot;</span> &lt;&lt; gr &lt;&lt; <span class="stringliteral">&quot;\nshared_vertices &quot;</span> &lt;&lt; nv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nv; i++)</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;         {</div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[sv[i]] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;         }</div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;      }</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;      {</div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  ne = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *se = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\nshared_edges &quot;</span> &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ne; i++)</div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;         {</div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[se[i]]-&gt;GetVertices();</div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;            os &lt;&lt; v[0] &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v[1] &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;         }</div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;      }</div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;      {</div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  nt = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *st = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  nq = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a> = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\nshared_faces &quot;</span> &lt;&lt; nt+nq &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nt; i++)</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;         {</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>;</div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[st[i]].v;</div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++) { os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v[j]; }</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;         }</div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nq; i++)</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;         {</div><div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>;</div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[<a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a>[i]].v;</div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++) { os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v[j]; }</div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;         }</div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;      }</div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;   }</div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;</div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;   <span class="comment">// Write out section end tag for mesh.</span></div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\nmfem_mesh_end&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;}</div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;</div><div class="line"><a name="l06392"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a0c09b68b568c0b2c5893667af56a070c"> 6392</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a0c09b68b568c0b2c5893667af56a070c">ParMesh::PrintVTU</a>(std::string pathname,</div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                       <a class="code" href="namespacemfem.html#aa1cc5701e3e695b09a013e7f6301a850">VTKFormat</a> format,</div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                       <span class="keywordtype">bool</span> high_order_output,</div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;                       <span class="keywordtype">int</span> compression_level,</div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;                       <span class="keywordtype">bool</span> bdr)</div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;{</div><div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;   <span class="keywordtype">int</span> pad_digits_rank = 6;</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;   <a class="code" href="classmfem_1_1DataCollection.html#a355e314f04127529240e0f540dd6543d">DataCollection::create_directory</a>(pathname, <span class="keyword">this</span>, <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>);</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;</div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;   std::string::size_type pos = pathname.find_last_of(<span class="charliteral">&#39;/&#39;</span>);</div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;   std::string fname</div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;      = (pos == std::string::npos) ? pathname : pathname.substr(pos+1);</div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;   {</div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;      std::string pvtu_name = pathname + <span class="stringliteral">&quot;/&quot;</span> + fname + <span class="stringliteral">&quot;.pvtu&quot;</span>;</div><div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;      std::ofstream os(pvtu_name);</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;</div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;      std::string data_type = (format == <a class="code" href="namespacemfem.html#aa1cc5701e3e695b09a013e7f6301a850a88131bfe59ca59720a89255e8857db09">VTKFormat::BINARY32</a>) ? <span class="stringliteral">&quot;Float32&quot;</span> : <span class="stringliteral">&quot;Float64&quot;</span>;</div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;      std::string data_format = (format == <a class="code" href="namespacemfem.html#aa1cc5701e3e695b09a013e7f6301a850ad2cd8253361a9c732d21ca1d336599cc">VTKFormat::ASCII</a>) ? <span class="stringliteral">&quot;ascii&quot;</span> : <span class="stringliteral">&quot;binary&quot;</span>;</div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;</div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&quot;</span>;</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;VTKFile type=\&quot;PUnstructuredGrid\&quot;&quot;</span>;</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; version =\&quot;0.1\&quot; byte_order=\&quot;&quot;</span> &lt;&lt; <a class="code" href="namespacemfem.html#acd8cbd1dcec616f06ddf2fa42afc8eca">VTKByteOrder</a>() &lt;&lt; <span class="stringliteral">&quot;\&quot;&gt;\n&quot;</span>;</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;PUnstructuredGrid GhostLevel=\&quot;0\&quot;&gt;\n&quot;</span>;</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;</div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;PPoints&gt;\n&quot;</span>;</div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\t&lt;PDataArray type=\&quot;&quot;</span> &lt;&lt; data_type &lt;&lt; <span class="stringliteral">&quot;\&quot; &quot;</span>;</div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; Name=\&quot;Points\&quot; NumberOfComponents=\&quot;3\&quot;&quot;</span></div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; format=\&quot;&quot;</span> &lt;&lt; data_format &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;</div><div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;/PPoints&gt;\n&quot;</span>;</div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;PCells&gt;\n&quot;</span>;</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\t&lt;PDataArray type=\&quot;Int32\&quot; &quot;</span>;</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; Name=\&quot;connectivity\&quot; NumberOfComponents=\&quot;1\&quot;&quot;</span></div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; format=\&quot;&quot;</span> &lt;&lt; data_format &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;</div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\t&lt;PDataArray type=\&quot;Int32\&quot; &quot;</span>;</div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; Name=\&quot;offsets\&quot;      NumberOfComponents=\&quot;1\&quot;&quot;</span></div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; format=\&quot;&quot;</span> &lt;&lt; data_format &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;</div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\t&lt;PDataArray type=\&quot;UInt8\&quot; &quot;</span>;</div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot; Name=\&quot;types\&quot;        NumberOfComponents=\&quot;1\&quot;&quot;</span></div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; format=\&quot;&quot;</span> &lt;&lt; data_format &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;</div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;/PCells&gt;\n&quot;</span>;</div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;</div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;PCellData&gt;\n&quot;</span>;</div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\t&lt;PDataArray type=\&quot;Int32\&quot; Name=\&quot;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;attribute&quot;</span></div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;\&quot; NumberOfComponents=\&quot;1\&quot;&quot;</span></div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; format=\&quot;&quot;</span> &lt;&lt; data_format &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;</div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;/PCellData&gt;\n&quot;</span>;</div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;</div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii=0; ii&lt;<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>; ii++)</div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;      {</div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;         std::string piece = fname + <span class="stringliteral">&quot;.proc&quot;</span></div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                             + <a class="code" href="namespacemfem.html#a75d80737c9ab9a6c0b9a53ee1f358457">to_padded_string</a>(ii, pad_digits_rank) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;&lt;Piece Source=\&quot;&quot;</span> &lt;&lt; piece &lt;&lt; <span class="stringliteral">&quot;\&quot;/&gt;\n&quot;</span>;</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;      }</div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;</div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;/PUnstructuredGrid&gt;\n&quot;</span>;</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;&lt;/VTKFile&gt;\n&quot;</span>;</div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;      os.close();</div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;   }</div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;</div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;   std::string vtu_fname = pathname + <span class="stringliteral">&quot;/&quot;</span> + fname + <span class="stringliteral">&quot;.proc&quot;</span></div><div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;                           + <a class="code" href="namespacemfem.html#a75d80737c9ab9a6c0b9a53ee1f358457">to_padded_string</a>(<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>, pad_digits_rank);</div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#aaa33469fa64e79c6b517951ad0dbb76c">Mesh::PrintVTU</a>(vtu_fname, format, high_order_output, compression_level, bdr);</div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;}</div><div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;</div><div class="line"><a name="l06459"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a68b86b731cbb7a3df48b919e6f7ca55e"> 6459</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1ParMesh.html#a68b86b731cbb7a3df48b919e6f7ca55e">ParMesh::FindPoints</a>(<a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a>&amp; point_mat, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a>&amp; elem_id,</div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;                        <a class="code" href="classmfem_1_1Array.html">Array&lt;IntegrationPoint&gt;</a>&amp; ip, <span class="keywordtype">bool</span> warn,</div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;                        <a class="code" href="classmfem_1_1InverseElementTransformation.html">InverseElementTransformation</a> *inv_trans)</div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;{</div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> npts = point_mat.<a class="code" href="classmfem_1_1Operator.html#a8d6d09abcca8b7523d28c61e97ee9a15">Width</a>();</div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;   <span class="keywordflow">if</span> (npts == 0) { <span class="keywordflow">return</span> 0; }</div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">bool</span> no_warn = <span class="keyword">false</span>;</div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ac4a77cf819f394d9e5097d5f4edc3845">Mesh::FindPoints</a>(point_mat, elem_id, ip, no_warn, inv_trans);</div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;</div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;   <span class="comment">// If multiple processors find the same point, we need to choose only one of</span></div><div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;   <span class="comment">// the processors to mark that point as found.</span></div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;   <span class="comment">// Here, we choose the processor with the minimal rank.</span></div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> my_point_rank(npts), glob_point_rank(npts);</div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; npts; k++)</div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;   {</div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;      my_point_rank[k] = (elem_id[k] == -1) ? <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a> : <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>;</div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;   }</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;</div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;   MPI_Allreduce(my_point_rank.GetData(), glob_point_rank.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), npts,</div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;                 MPI_INT, MPI_MIN, <a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;</div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;   <span class="keywordtype">int</span> pts_found = 0;</div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; npts; k++)</div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;   {</div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;      <span class="keywordflow">if</span> (glob_point_rank[k] == <a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>) { elem_id[k] = -1; }</div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;      {</div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;         pts_found++;</div><div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;         <span class="keywordflow">if</span> (glob_point_rank[k] != <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>) { elem_id[k] = -2; }</div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;      }</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;   }</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;   <span class="keywordflow">if</span> (warn &amp;&amp; pts_found != npts &amp;&amp; <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a> == 0)</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;   {</div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;      MFEM_WARNING((npts-pts_found) &lt;&lt; <span class="stringliteral">&quot; points were not found&quot;</span>);</div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;   }</div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;   <span class="keywordflow">return</span> pts_found;</div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;}</div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;</div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> PrintVertex(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Vertex.html">Vertex</a> &amp;v, <span class="keywordtype">int</span> space_dim, ostream &amp;os)</div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;{</div><div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;   os &lt;&lt; v(0);</div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 1; d &lt; space_dim; d++)</div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;   {</div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;      os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v(d);</div><div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;   }</div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;}</div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;</div><div class="line"><a name="l06508"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a34e4ede1a85fd74c515555bb23d6beb6"> 6508</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a34e4ede1a85fd74c515555bb23d6beb6">ParMesh::PrintSharedEntities</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *fname_prefix)<span class="keyword"> const</span></div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;   stringstream out_name;</div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;   out_name &lt;&lt; fname_prefix &lt;&lt; <span class="charliteral">&#39;_&#39;</span> &lt;&lt; setw(5) &lt;&lt; setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a></div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;.shared_entities&quot;</span>;</div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;   ofstream os(out_name.str().c_str());</div><div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;   os.precision(16);</div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;</div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a34d8919e16670b0034d53d9b6ea258b5">Save</a>(<a class="code" href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">out</a>);</div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;</div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;   os &lt;&lt; <span class="stringliteral">&quot;\ntotal_shared_vertices &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;   {</div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;total_shared_edges &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;   }</div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;   {</div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;total_shared_faces &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>.<a class="code" href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">Size</a>() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;   }</div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gr = 1; gr &lt; <a class="code" href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">GetNGroups</a>(); gr++)</div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;   {</div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;      {</div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  nv = <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *sv = <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\n# group &quot;</span> &lt;&lt; gr &lt;&lt; <span class="stringliteral">&quot;\n\nshared_vertices &quot;</span> &lt;&lt; nv &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nv; i++)</div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;         {</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> lvi = <a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>[sv[i]];</div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;            <span class="comment">// os &lt;&lt; lvi &lt;&lt; &#39;\n&#39;;</span></div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;            PrintVertex(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[lvi], <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, os);</div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;         }</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;      }</div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 2)</div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;      {</div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  ne = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *se = <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\nshared_edges &quot;</span> &lt;&lt; ne &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ne; i++)</div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;         {</div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[se[i]]-&gt;GetVertices();</div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;            <span class="comment">// os &lt;&lt; v[0] &lt;&lt; &#39; &#39; &lt;&lt; v[1] &lt;&lt; &#39;\n&#39;;</span></div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;            PrintVertex(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[v[0]], <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, os);</div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot; | &quot;</span>;</div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;            PrintVertex(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[v[1]], <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, os);</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;         }</div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;      }</div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> &gt;= 3)</div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;      {</div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  nt = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *st = <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>  nq = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">RowSize</a>(gr-1);</div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *<a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a> = <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">GetRow</a>(gr-1);</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;         os &lt;&lt; <span class="stringliteral">&quot;\nshared_faces &quot;</span> &lt;&lt; nt+nq &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nt; i++)</div><div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;         {</div><div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>[st[i]].v;</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>;</div><div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++) { os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v[j]; }</div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++)</div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;            {</div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;               PrintVertex(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[v[j]], <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, os);</div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;               (j &lt; 2) ? os &lt;&lt; <span class="stringliteral">&quot; | &quot;</span> : os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;            }</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;         }</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nq; i++)</div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;         {</div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>[<a class="code" href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a>[i]].v;</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;            os &lt;&lt; <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>;</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++) { os &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; v[j]; }</div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;            os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;            {</div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;               PrintVertex(<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[v[j]], <a class="code" href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">spaceDim</a>, os);</div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;               (j &lt; 3) ? os &lt;&lt; <span class="stringliteral">&quot; | &quot;</span> : os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;            }</div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;         }</div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;      }</div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;   }</div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;}</div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;</div><div class="line"><a name="l06595"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a5714678e316d2eb8fb75eacf5ef09eda"> 6595</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a5714678e316d2eb8fb75eacf5ef09eda">ParMesh::GetGlobalVertexIndices</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> &amp;gi)<span class="keyword"> const</span></div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;   <a class="code" href="classmfem_1_1H1__FECollection.html">H1_FECollection</a> fec(1, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>); <span class="comment">// Order 1, mesh dimension (not spatial dimension).</span></div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *pm = <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> fespace(pm, &amp;fec);</div><div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;</div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;   gi.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>());</div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;</div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> dofs;</div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">GetNV</a>(); ++i)</div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;   {</div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;      fespace.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a3f7589d77a54377f6b080cd2f934af48">GetVertexDofs</a>(i, dofs);</div><div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;      gi[i] = fespace.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(dofs[0]);</div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;   }</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;}</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;</div><div class="line"><a name="l06611"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a77dae875c8b86a41b8f22d2f7fd6b331"> 6611</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a77dae875c8b86a41b8f22d2f7fd6b331">ParMesh::GetGlobalEdgeIndices</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> &amp;gi)<span class="keyword"> const</span></div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1)</div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;   {</div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a5714678e316d2eb8fb75eacf5ef09eda">GetGlobalVertexIndices</a>(gi);</div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;   }</div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;</div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;   <a class="code" href="classmfem_1_1ND__FECollection.html">ND_FECollection</a> fec(1, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>); <span class="comment">// Order 1, mesh dimension (not spatial dimension).</span></div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *pm = <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> fespace(pm, &amp;fec);</div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;</div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;   gi.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a09bf96bbcf2833f005406317841f19b2">GetNEdges</a>());</div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;</div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> dofs;</div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classmfem_1_1Mesh.html#a09bf96bbcf2833f005406317841f19b2">GetNEdges</a>(); ++i)</div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;   {</div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;      fespace.<a class="code" href="classmfem_1_1FiniteElementSpace.html#a9f6f985320fedca41dc014e35a5b2bf0">GetEdgeDofs</a>(i, dofs);</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ldof = (dofs[0] &gt;= 0) ? dofs[0] : -1 - dofs[0];</div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;      gi[i] = fespace.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(ldof);</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;   }</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;}</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;</div><div class="line"><a name="l06634"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a72c146ad1d165bf4bbd099a806f4426b"> 6634</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a72c146ad1d165bf4bbd099a806f4426b">ParMesh::GetGlobalFaceIndices</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> &amp;gi)<span class="keyword"> const</span></div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 2)</div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;   {</div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a77dae875c8b86a41b8f22d2f7fd6b331">GetGlobalEdgeIndices</a>(gi);</div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;   }</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a> == 1)</div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;   {</div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;      <a class="code" href="classmfem_1_1ParMesh.html#a5714678e316d2eb8fb75eacf5ef09eda">GetGlobalVertexIndices</a>(gi);</div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;   }</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;   <a class="code" href="classmfem_1_1RT__FECollection.html">RT_FECollection</a> fec(0, <a class="code" href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">Dim</a>); <span class="comment">// Order 0, mesh dimension (not spatial dimension).</span></div><div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *pm = <span class="keyword">const_cast&lt;</span><a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;   <a class="code" href="classmfem_1_1ParFiniteElementSpace.html">ParFiniteElementSpace</a> fespace(pm, &amp;fec);</div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;</div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;   gi.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>());</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> dofs;</div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">GetNFaces</a>(); ++i)</div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;   {</div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;      fespace.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#a2e77fef828e37ad31f0c9aa3ffe503cc">GetFaceDofs</a>(i, dofs);</div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ldof = (dofs[0] &gt;= 0) ? dofs[0] : -1 - dofs[0];</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;      gi[i] = fespace.<a class="code" href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">GetGlobalTDofNumber</a>(ldof);</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;   }</div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;}</div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;</div><div class="line"><a name="l06662"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a40adebb484c5074bb9d6c5ea71a21432"> 6662</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#a40adebb484c5074bb9d6c5ea71a21432">ParMesh::GetGlobalElementIndices</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;HYPRE_BigInt&gt;</a> &amp;gi)<span class="keyword"> const</span></div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#af30963c1d6025a1ef304caa2366109df">ComputeGlobalElementOffset</a>();</div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;</div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;   <span class="comment">// Cast from long long to HYPRE_BigInt</span></div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;   <span class="keyword">const</span> <a class="code" href="hypre__parcsr_8hpp.html#a891d15140bcc33b92ff03f02664c9022">HYPRE_BigInt</a> offset = <a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a>;</div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;</div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;   gi.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>());</div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">GetNE</a>(); ++i)</div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;   {</div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;      gi[i] = offset + i;</div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;   }</div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;}</div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;</div><div class="line"><a name="l06676"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#afa55bdf445b256c57888aa9203b2bc9a"> 6676</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#afa55bdf445b256c57888aa9203b2bc9a">ParMesh::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html">ParMesh</a> &amp;other)</div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;{</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#ab09c17e5079c7c7f854949ec959882a8">Mesh::Swap</a>(other, <span class="keyword">true</span>);</div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;</div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">MyComm</a>);</div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">NRanks</a>);</div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">MyRank</a>);</div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;</div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">glob_elem_offset</a>);</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">glob_offset_sequence</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">glob_offset_sequence</a>);</div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;</div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>.<a class="code" href="classmfem_1_1GroupTopology.html#a24e06c9dc0ab8400aff8a8f061de4197">Swap</a>(other.<a class="code" href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">gtopo</a>);</div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>.<a class="code" href="classmfem_1_1Table.html#a4b5e9c6e1389e1ff399eebf28e5ac48d">Swap</a>(other.<a class="code" href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">group_svert</a>);</div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>.<a class="code" href="classmfem_1_1Table.html#a4b5e9c6e1389e1ff399eebf28e5ac48d">Swap</a>(other.<a class="code" href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">group_sedge</a>);</div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>.<a class="code" href="classmfem_1_1Table.html#a4b5e9c6e1389e1ff399eebf28e5ac48d">Swap</a>(other.<a class="code" href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">group_stria</a>);</div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>.<a class="code" href="classmfem_1_1Table.html#a4b5e9c6e1389e1ff399eebf28e5ac48d">Swap</a>(other.<a class="code" href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">group_squad</a>);</div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;</div><div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>);</div><div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">shared_trias</a>);</div><div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">shared_quads</a>);</div><div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">svert_lvert</a>);</div><div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">sedge_ledge</a>);</div><div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">sface_lface</a>);</div><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;</div><div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;   <span class="comment">// Swap face-neighbor data</span></div><div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">have_face_nbr_data</a>);</div><div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">face_nbr_group</a>);</div><div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">face_nbr_elements_offset</a>);</div><div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">face_nbr_vertices_offset</a>);</div><div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">face_nbr_elements</a>);</div><div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">face_nbr_vertices</a>);</div><div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">send_face_nbr_elements</a>);</div><div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">send_face_nbr_vertices</a>);</div><div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;</div><div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;   <span class="comment">// Nodes, NCMesh, and NURBSExtension are taken care of by Mesh::Swap</span></div><div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;   <a class="code" href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a>(<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>, other.<a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>);</div><div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;</div><div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a5c53f58add9caebd46a57cc43e774e69">print_shared</a> = other.<a class="code" href="classmfem_1_1ParMesh.html#a5c53f58add9caebd46a57cc43e774e69">print_shared</a>;</div><div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;}</div><div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;</div><div class="line"><a name="l06717"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#aa454ecf91aa0a17ec48e01610d85988a"> 6717</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1ParMesh.html#aa454ecf91aa0a17ec48e01610d85988a">ParMesh::Destroy</a>()</div><div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;{</div><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;   <span class="keyword">delete</span> <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a>;</div><div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;   <a class="code" href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">ncmesh</a> = <a class="code" href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">pncmesh</a> = NULL;</div><div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;</div><div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">DeleteFaceNbrData</a>();</div><div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;</div><div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.Size(); i++)</div><div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;   {</div><div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;      <a class="code" href="classmfem_1_1Mesh.html#ac8d75c3d28255c7153c2b72f7811058a">FreeElement</a>(<a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>[i]);</div><div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;   }</div><div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">shared_edges</a>.DeleteAll();</div><div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;</div><div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;   <span class="keyword">delete</span> <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a>;</div><div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">face_nbr_el_to_face</a> = NULL;</div><div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;}</div><div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;</div><div class="line"><a name="l06734"></a><span class="lineno"><a class="line" href="classmfem_1_1ParMesh.html#a3bd3863cf69b28d542b0648e482cdbbb"> 6734</a></span>&#160;<a class="code" href="classmfem_1_1ParMesh.html#a3bd3863cf69b28d542b0648e482cdbbb">ParMesh::~ParMesh</a>()</div><div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;{</div><div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;   <a class="code" href="classmfem_1_1ParMesh.html#aa454ecf91aa0a17ec48e01610d85988a">ParMesh::Destroy</a>();</div><div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;</div><div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;   <span class="comment">// The Mesh destructor is called automatically</span></div><div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;}</div><div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;</div><div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;}</div><div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;</div><div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="classmfem_1_1FiniteElement_html"><div class="ttname"><a href="classmfem_1_1FiniteElement.html">mfem::FiniteElement</a></div><div class="ttdoc">Abstract class for all finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8hpp_source.html#l00232">fe_base.hpp:232</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a7dcffcbadab4c5c90d24370a2b5a2dab"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a7dcffcbadab4c5c90d24370a2b5a2dab">mfem::ParMesh::UniformRefinement3D</a></div><div class="ttdeci">void UniformRefinement3D() override</div><div class="ttdoc">Refine a mixed 3D mesh uniformly. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04587">pmesh.cpp:4587</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">mfem::Geometry::SEGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00038">geom.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aca7e3873c8ca264f6a95535b648f1de0"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aca7e3873c8ca264f6a95535b648f1de0">mfem::ParMesh::PrintAsOneXG</a></div><div class="ttdeci">void PrintAsOneXG(std::ostream &amp;out=mfem::out)</div><div class="ttdoc">Old mesh format (Netgen/Truegrid) version of &amp;#39;PrintAsOne&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l05629">pmesh.cpp:5629</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a97facd56fccab3bdec0693e229f74e0f"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a97facd56fccab3bdec0693e229f74e0f">mfem::GroupTopology::Create</a></div><div class="ttdeci">void Create(ListOfIntegerSets &amp;groups, int mpitag)</div><div class="ttdoc">Set up the group topology given the list of sets of shared entities. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00085">communication.cpp:85</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a36841bfd50c27064b31681d58bdab2aa"><div class="ttname"><a href="classmfem_1_1Mesh.html#a36841bfd50c27064b31681d58bdab2aa">mfem::Mesh::Loader</a></div><div class="ttdeci">void Loader(std::istream &amp;input, int generate_edges=0, std::string parse_tag=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l03979">mesh.cpp:3979</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2">mfem::Element::SEGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="namespacemfem_html_a4b575e50e0676000389d0fa6129eaa79"><div class="ttname"><a href="namespacemfem.html#a4b575e50e0676000389d0fa6129eaa79">mfem::MultABt</a></div><div class="ttdeci">void MultABt(const DenseMatrix &amp;A, const DenseMatrix &amp;B, DenseMatrix &amp;ABt)</div><div class="ttdoc">Multiply a matrix A with the transpose of a matrix B: A*Bt. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l02781">densemat.cpp:2781</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_acdd9724869c18766622fe6632467f4aa"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#acdd9724869c18766622fe6632467f4aa">mfem::ParFiniteElementSpace::GetSharedQuadrilateralDofs</a></div><div class="ttdeci">void GetSharedQuadrilateralDofs(int group, int fi, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l00631">pfespace.cpp:631</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68">mfem::Element::QUADRILATERAL</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_a9cce8215d185deab7fb54f6d727b5e51"><div class="ttname"><a href="classmfem_1_1Vector.html#a9cce8215d185deab7fb54f6d727b5e51">mfem::Vector::SetSubVector</a></div><div class="ttdeci">void SetSubVector(const Array&lt; int &gt; &amp;dofs, const double value)</div><div class="ttdoc">Set the entries listed in dofs to the given value. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8cpp_source.html#l00574">vector.cpp:574</a></div></div>
<div class="ttc" id="structmfem_1_1ParMesh_1_1Vert3_html"><div class="ttname"><a href="structmfem_1_1ParMesh_1_1Vert3.html">mfem::ParMesh::Vert3</a></div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00040">pmesh.hpp:40</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a81197e06ddf2eb20439cfe166a9551f8"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a81197e06ddf2eb20439cfe166a9551f8">mfem::ParNCMesh::GetConformingSharedStructures</a></div><div class="ttdeci">void GetConformingSharedStructures(class ParMesh &amp;pmesh)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l00787">pncmesh.cpp:787</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a871cda1b0e0ba0f3a22b1b37d8d1bcfe"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a871cda1b0e0ba0f3a22b1b37d8d1bcfe">mfem::GroupTopology::GetGroupMasterRank</a></div><div class="ttdeci">int GetGroupMasterRank(int g) const</div><div class="ttdoc">Return the rank of the group master for group &amp;#39;g&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00171">communication.hpp:171</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationRule_html_a65a041b5cd5417664446932fa946409d"><div class="ttname"><a href="classmfem_1_1IntegrationRule.html#a65a041b5cd5417664446932fa946409d">mfem::IntegrationRule::GetNPoints</a></div><div class="ttdeci">int GetNPoints() const</div><div class="ttdoc">Returns the number of the points in the integration rule. </div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00247">intrules.hpp:247</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a820bfe7c23a983f4e50de6da4a773c0b"><div class="ttname"><a href="classmfem_1_1Table.html#a820bfe7c23a983f4e50de6da4a773c0b">mfem::Table::Push</a></div><div class="ttdeci">int Push(int i, int j)</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00219">table.cpp:219</a></div></div>
<div class="ttc" id="classmfem_1_1IntegerSet_html_a46792e0e26ddc11a27cfed8812ec04fa"><div class="ttname"><a href="classmfem_1_1IntegerSet.html#a46792e0e26ddc11a27cfed8812ec04fa">mfem::IntegerSet::Recreate</a></div><div class="ttdeci">void Recreate(const int n, const int *p)</div><div class="ttdoc">Create an integer set from C-array &amp;#39;p&amp;#39; of &amp;#39;n&amp;#39; integers. Overwrites any existing set data...</div><div class="ttdef"><b>Definition:</b> <a href="sets_8cpp_source.html#l00068">sets.cpp:68</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a2649ebd417db36c5c29371e59bbd65fa"><div class="ttname"><a href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">mfem::Table::GetJ</a></div><div class="ttdeci">int * GetJ()</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00114">table.hpp:114</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html"><div class="ttname"><a href="classmfem_1_1Mesh.html">mfem::Mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00052">mesh.hpp:52</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a57d29bf3cd15d1796cb8c78d5805c2c5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a57d29bf3cd15d1796cb8c78d5805c2c5">mfem::ParMesh::GetGhostFaceTransformation</a></div><div class="ttdeci">void GetGhostFaceTransformation(FaceElementTransformations *FETr, Element::Type face_type, Geometry::Type face_geom)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03032">pmesh.cpp:3032</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationRule_html"><div class="ttname"><a href="classmfem_1_1IntegrationRule.html">mfem::IntegrationRule</a></div><div class="ttdoc">Class for an integration rule - an Array of IntegrationPoint. </div><div class="ttdef"><b>Definition:</b> <a href="intrules_8hpp_source.html#l00090">intrules.hpp:90</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a350a9fd44c3070d48dd72b40ce9ab1f7"><div class="ttname"><a href="classmfem_1_1Mesh.html#a350a9fd44c3070d48dd72b40ce9ab1f7">mfem::Mesh::GetNodalFESpace</a></div><div class="ttdeci">const FiniteElementSpace * GetNodalFESpace() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05351">mesh.cpp:5351</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a4d6d51a8d57b7ebcf15de350761c5bf8ad1d1ee65e315969caf26f61c7112ca7b"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8ad1d1ee65e315969caf26f61c7112ca7b">mfem::FaceElementTransformations::HAVE_ELEM1</a></div><div class="ttdoc">Element on side 1 is configured. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00513">eltrans.hpp:513</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aaeca6483b3628feb94d008f7ea86bad5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aaeca6483b3628feb94d008f7ea86bad5">mfem::ParMesh::GetSharedVertexCommunicator</a></div><div class="ttdeci">void GetSharedVertexCommunicator(int ordering, GroupCommunicator &amp;svert_comm) const</div><div class="ttdoc">Get the shared vertices GroupCommunicator. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01661">pmesh.cpp:1661</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a3bd3863cf69b28d542b0648e482cdbbb"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a3bd3863cf69b28d542b0648e482cdbbb">mfem::ParMesh::~ParMesh</a></div><div class="ttdeci">virtual ~ParMesh()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06734">pmesh.cpp:6734</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a941ca9fdca79ba42226a42d4665f41e3"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a941ca9fdca79ba42226a42d4665f41e3">mfem::ParMesh::LoadSharedEntities</a></div><div class="ttdeci">void LoadSharedEntities(std::istream &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00978">pmesh.cpp:978</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a668bf760c232f6ddbaeb0fa94909ca3c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a668bf760c232f6ddbaeb0fa94909ca3c">mfem::ParMesh::glob_offset_sequence</a></div><div class="ttdeci">long glob_offset_sequence</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00087">pmesh.hpp:87</a></div></div>
<div class="ttc" id="classmfem_1_1DSTable_html"><div class="ttname"><a href="classmfem_1_1DSTable.html">mfem::DSTable</a></div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00244">table.hpp:244</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a77b0de5a8a964d2c7b2d0abc9077ec8e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a77b0de5a8a964d2c7b2d0abc9077ec8e">mfem::ParMesh::UniformRefineGroups2D</a></div><div class="ttdeci">void UniformRefineGroups2D(int old_nv)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04363">pmesh.cpp:4363</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac8d75c3d28255c7153c2b72f7811058a"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac8d75c3d28255c7153c2b72f7811058a">mfem::Mesh::FreeElement</a></div><div class="ttdeci">void FreeElement(Element *E)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l11937">mesh.cpp:11937</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aa5286b303d8ba9152ed4c8d988ffe2b1"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aa5286b303d8ba9152ed4c8d988ffe2b1">mfem::ParMesh::GetSharedFaceTransformationsByLocalIndex</a></div><div class="ttdeci">FaceElementTransformations * GetSharedFaceTransformationsByLocalIndex(int FaceNo, bool fill2=true)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03088">pmesh.cpp:3088</a></div></div>
<div class="ttc" id="classmfem_1_1ParGridFunction_html_a01393a296330e148763a0812d40fc048"><div class="ttname"><a href="classmfem_1_1ParGridFunction.html#a01393a296330e148763a0812d40fc048">mfem::ParGridFunction::ExchangeFaceNbrData</a></div><div class="ttdeci">void ExchangeFaceNbrData()</div><div class="ttdef"><b>Definition:</b> <a href="pgridfunc_8cpp_source.html#l00205">pgridfunc.cpp:205</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a0029fd07ad6a22cc30b145b7ba2959af"><div class="ttname"><a href="classmfem_1_1Mesh.html#a0029fd07ad6a22cc30b145b7ba2959af">mfem::Mesh::CheckElementOrientation</a></div><div class="ttdeci">int CheckElementOrientation(bool fix_it=true)</div><div class="ttdoc">Check (and optionally attempt to fix) the orientation of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05433">mesh.cpp:5433</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ac4752acb263590c6c4ea7442c43847ed"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ac4752acb263590c6c4ea7442c43847ed">mfem::ParMesh::NRanks</a></div><div class="ttdeci">int NRanks</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00038">pmesh.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a738134431dec43a60af6d8fc7e6f3819"><div class="ttname"><a href="classmfem_1_1Table.html#a738134431dec43a60af6d8fc7e6f3819">mfem::Table::SetSize</a></div><div class="ttdeci">void SetSize(int dim, int connections_per_row)</div><div class="ttdoc">Set the size and the number of connections for the table. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00124">table.cpp:124</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ababcaca40ea48ba9ddc56f5bf94f3f88"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ababcaca40ea48ba9ddc56f5bf94f3f88">mfem::ParMesh::operator=</a></div><div class="ttdeci">ParMesh &amp; operator=(ParMesh &amp;&amp;mesh)</div><div class="ttdoc">Move assignment operator. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00101">pmesh.cpp:101</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a68ba627efbd66b617b3dc8a0c54bb9be"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a68ba627efbd66b617b3dc8a0c54bb9be">mfem::ParMesh::GetSharedQuadCommunicator</a></div><div class="ttdeci">void GetSharedQuadCommunicator(int ordering, GroupCommunicator &amp;squad_comm) const</div><div class="ttdoc">Get the shared face quadrilaterals GroupCommunicator. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01685">pmesh.cpp:1685</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a6e3e3d935208cc8c3728b459ca9ea15e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a6e3e3d935208cc8c3728b459ca9ea15e">mfem::ParMesh::MakeRefined_</a></div><div class="ttdeci">void MakeRefined_(ParMesh &amp;orig_mesh, int ref_factor, int ref_type)</div><div class="ttdoc">Internal function used in ParMesh::MakeRefined (and related constructor) </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01132">pmesh.cpp:1132</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a4c1e1aeaf502f4f4258dbc01fd073946"><div class="ttname"><a href="classmfem_1_1Element.html#a4c1e1aeaf502f4f4258dbc01fd073946">mfem::Element::Duplicate</a></div><div class="ttdeci">virtual Element * Duplicate(Mesh *m) const =0</div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae6d58733b72f9d49584a6640d05fb235"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae6d58733b72f9d49584a6640d05fb235">mfem::ParMesh::FindSharedVertices</a></div><div class="ttdeci">int FindSharedVertices(const int *partition, Table *vertex_element, ListOfIntegerSets &amp;groups)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00585">pmesh.cpp:585</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a34e4ede1a85fd74c515555bb23d6beb6"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a34e4ede1a85fd74c515555bb23d6beb6">mfem::ParMesh::PrintSharedEntities</a></div><div class="ttdeci">void PrintSharedEntities(const char *fname_prefix) const</div><div class="ttdoc">Debugging method. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06508">pmesh.cpp:6508</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_ad236e8d8798e2e67a1565e14b023bf08"><div class="ttname"><a href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">mfem::Table::AddColumnsInRow</a></div><div class="ttdeci">void AddColumnsInRow(int r, int ncol)</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00078">table.hpp:78</a></div></div>
<div class="ttc" id="namespacemfem_html_aa3e9faf8433d07cc3132b310eb03d731"><div class="ttname"><a href="namespacemfem.html#aa3e9faf8433d07cc3132b310eb03d731">mfem::err</a></div><div class="ttdeci">OutStream err(std::cerr)</div><div class="ttdoc">Global stream used by the library for standard error output. Initially it uses the same std::streambu...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8hpp_source.html#l00071">globals.hpp:71</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2b58a4871c821476600a22702b70ee8a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2b58a4871c821476600a22702b70ee8a">mfem::Mesh::UniformRefinement3D_base</a></div><div class="ttdeci">void UniformRefinement3D_base(Array&lt; int &gt; *f2qf=NULL, DSTable *v_to_v_p=NULL, bool update_nodes=true)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l08206">mesh.cpp:8206</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a532357fb36f7b2399d4948b6cd1b365c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a532357fb36f7b2399d4948b6cd1b365c">mfem::ParMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo(std::ostream &amp;out=mfem::out) override</div><div class="ttdoc">Print various parallel mesh stats. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06190">pmesh.cpp:6190</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Master_html_a9ac95777a21057b4787526f41bca07c8"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Master.html#a9ac95777a21057b4787526f41bca07c8">mfem::NCMesh::Master::slaves_begin</a></div><div class="ttdeci">int slaves_begin</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00205">ncmesh.hpp:205</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a9c1892b82511e32df40ef8210d81d9f7"><div class="ttname"><a href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">mfem::Table::MakeI</a></div><div class="ttdeci">void MakeI(int nrows)</div><div class="ttdoc">Next 7 methods are used together with the default constructor. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00081">table.cpp:81</a></div></div>
<div class="ttc" id="navier__tgv_8cpp_html_a5fcfabb016a2ac0228d4eae15ea7beb6"><div class="ttname"><a href="navier__tgv_8cpp.html#a5fcfabb016a2ac0228d4eae15ea7beb6">sq</a></div><div class="ttdeci">T sq(T x)</div><div class="ttdef"><b>Definition:</b> <a href="navier__tgv_8cpp_source.html#l00116">navier_tgv.cpp:116</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_af043ab44e2d5144949ed66181afe1246"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#af043ab44e2d5144949ed66181afe1246">mfem::ParFiniteElementSpace::GetFaceNbrFE</a></div><div class="ttdeci">const FiniteElement * GetFaceNbrFE(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l01517">pfespace.cpp:1517</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a249826641c64c2cada3c9567da802fc6"><div class="ttname"><a href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">mfem::Element::GetVertices</a></div><div class="ttdeci">virtual void GetVertices(Array&lt; int &gt; &amp;v) const =0</div><div class="ttdoc">Returns element&amp;#39;s vertices. </div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aed059a8a2f3fd0481f57a08aecf30059"><div class="ttname"><a href="classmfem_1_1Mesh.html#aed059a8a2f3fd0481f57a08aecf30059">mfem::Mesh::GetElementBaseGeometry</a></div><div class="ttdeci">Geometry::Type GetElementBaseGeometry(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01108">mesh.hpp:1108</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ad998076561d21d2bccf24b72302abe52"><div class="ttname"><a href="classmfem_1_1Mesh.html#ad998076561d21d2bccf24b72302abe52">mfem::Mesh::GetBdrElementEdgeIndex</a></div><div class="ttdeci">int GetBdrElementEdgeIndex(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06235">mesh.cpp:6235</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ade4cd331ded674ee03c8cab2a8e02d3f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ade4cd331ded674ee03c8cab2a8e02d3f">mfem::ParMesh::MakeRefined</a></div><div class="ttdeci">static ParMesh MakeRefined(ParMesh &amp;orig_mesh, int ref_factor, int ref_type)</div><div class="ttdoc">Create a uniformly refined (by any factor) version of orig_mesh. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01367">pmesh.cpp:1367</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a5c53f58add9caebd46a57cc43e774e69"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a5c53f58add9caebd46a57cc43e774e69">mfem::ParMesh::print_shared</a></div><div class="ttdeci">bool print_shared</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00092">pmesh.hpp:92</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a2d1d239327da0c6ffe0bb148b3612f32"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a2d1d239327da0c6ffe0bb148b3612f32">mfem::NCMesh::NCList::slaves</a></div><div class="ttdeci">Array&lt; Slave &gt; slaves</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00231">ncmesh.hpp:231</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a1f042059063208b83a9abdb3dc7160a8"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a1f042059063208b83a9abdb3dc7160a8">mfem::ParMesh::GetSharedTriCommunicator</a></div><div class="ttdeci">void GetSharedTriCommunicator(int ordering, GroupCommunicator &amp;stria_comm) const</div><div class="ttdoc">Get the shared face triangles GroupCommunicator. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01709">pmesh.cpp:1709</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac9063d444be89252ed9479011d01fa08"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">mfem::Mesh::boundary</a></div><div class="ttdeci">Array&lt; Element * &gt; boundary</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00091">mesh.hpp:91</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a1c24b1592e32e5365209d28d121e8c6b"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a1c24b1592e32e5365209d28d121e8c6b">mfem::ParMesh::ParNCMesh</a></div><div class="ttdeci">friend class ParNCMesh</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00662">pmesh.hpp:662</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6875d857942c66cb8cea1159337b807a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6875d857942c66cb8cea1159337b807a">mfem::Mesh::Dimension</a></div><div class="ttdeci">int Dimension() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01047">mesh.hpp:1047</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af81b83179f6169a99218b7b1f6d589e4"><div class="ttname"><a href="classmfem_1_1Mesh.html#af81b83179f6169a99218b7b1f6d589e4">mfem::Mesh::GeneratePartitioning</a></div><div class="ttdeci">int * GeneratePartitioning(int nparts, int part_method=1)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l07074">mesh.cpp:7074</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_af283451292bc574f1b8022e8dcc86152"><div class="ttname"><a href="classmfem_1_1ParMesh.html#af283451292bc574f1b8022e8dcc86152">mfem::ParMesh::BuildLocalVertices</a></div><div class="ttdeci">int BuildLocalVertices(const Mesh &amp;global_mesh, const int *partitioning, Array&lt; int &gt; &amp;vert_global_local)</div><div class="ttdoc">Fills out partitioned Mesh::vertices. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00302">pmesh.cpp:302</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_afa5039577a5f025c51136dfddbf59358"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#afa5039577a5f025c51136dfddbf59358">mfem::ElementTransformation::ElementType</a></div><div class="ttdeci">int ElementType</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00078">eltrans.hpp:78</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a33a72d6483e85d585aad2d170e09efa7"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a33a72d6483e85d585aad2d170e09efa7">mfem::ParMesh::UniformRefinement2D</a></div><div class="ttdeci">void UniformRefinement2D() override</div><div class="ttdoc">Refine a mixed 2D mesh uniformly. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04563">pmesh.cpp:4563</a></div></div>
<div class="ttc" id="classmfem_1_1ParGridFunction_html_ac76417ffa33e7c502d830148397bafae"><div class="ttname"><a href="classmfem_1_1ParGridFunction.html#ac76417ffa33e7c502d830148397bafae">mfem::ParGridFunction::SaveAsOne</a></div><div class="ttdeci">void SaveAsOne(const char *fname, int precision=16) const</div><div class="ttdef"><b>Definition:</b> <a href="pgridfunc_8cpp_source.html#l00899">pgridfunc.cpp:899</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1107bd0db9d445c5f613af92a458bcbc"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1107bd0db9d445c5f613af92a458bcbc">mfem::Mesh::CoarseFineTr</a></div><div class="ttdeci">CoarseFineTransformations CoarseFineTr</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00240">mesh.hpp:240</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac6cf2e60dc2177744096b6d9a0eaad49"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac6cf2e60dc2177744096b6d9a0eaad49">mfem::Mesh::own_nodes</a></div><div class="ttdeci">int own_nodes</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00246">mesh.hpp:246</a></div></div>
<div class="ttc" id="classmfem_1_1GroupCommunicator_html_a8330d9ef25733a0488337478ca514035"><div class="ttname"><a href="classmfem_1_1GroupCommunicator.html#a8330d9ef25733a0488337478ca514035">mfem::GroupCommunicator::Bcast</a></div><div class="ttdeci">void Bcast(T *ldata, int layout) const</div><div class="ttdoc">Broadcast within each group where the master is the root. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00329">communication.hpp:329</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2249b56c56f685bb6a14b74921e77199"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2249b56c56f685bb6a14b74921e77199">mfem::Mesh::GetNumFaces</a></div><div class="ttdeci">int GetNumFaces() const</div><div class="ttdoc">Return the number of faces (3D), edges (2D) or vertices (1D). </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05389">mesh.cpp:5389</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_ac1e67bd3ee82db59573950d19897c149"><div class="ttname"><a href="classmfem_1_1Vector.html#ac1e67bd3ee82db59573950d19897c149">mfem::Vector::SetSize</a></div><div class="ttdeci">void SetSize(int s)</div><div class="ttdoc">Resize the vector to size s. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00512">vector.hpp:512</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a88925817d4e35a8386f460a896d560ff"><div class="ttname"><a href="classmfem_1_1Mesh.html#a88925817d4e35a8386f460a896d560ff">mfem::Mesh::Transformation</a></div><div class="ttdeci">IsoparametricTransformation Transformation</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00234">mesh.hpp:234</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a499b245ac36db4285f2afe8aaef6e4f5"><div class="ttname"><a href="classmfem_1_1Mesh.html#a499b245ac36db4285f2afe8aaef6e4f5">mfem::Mesh::GetCharacteristics</a></div><div class="ttdeci">void GetCharacteristics(double &amp;h_min, double &amp;h_max, double &amp;kappa_min, double &amp;kappa_max, Vector *Vh=NULL, Vector *Vk=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00193">mesh.cpp:193</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aa05882a7f334e436c4bddec9c8658509"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aa05882a7f334e436c4bddec9c8658509">mfem::ParMesh::face_nbr_elements</a></div><div class="ttdeci">Array&lt; Element * &gt; face_nbr_elements</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00382">pmesh.hpp:382</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1d2e8f696ea28c4ed0dc738de6bcd009"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1d2e8f696ea28c4ed0dc738de6bcd009">mfem::Mesh::GetTransformationFEforElementType</a></div><div class="ttdeci">static FiniteElement * GetTransformationFEforElementType(Element::Type)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00327">mesh.cpp:327</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_acdb6659e4e92d2a4c214f7453cab79b5"><div class="ttname"><a href="classmfem_1_1Mesh.html#acdb6659e4e92d2a4c214f7453cab79b5">mfem::Mesh::NewNodes</a></div><div class="ttdeci">void NewNodes(GridFunction &amp;nodes, bool make_owner=false)</div><div class="ttdoc">Replace the internal node GridFunction with the given GridFunction. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l07976">mesh.cpp:7976</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a4482879c8b45fae30e481d6f1e3fa1c7"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a4482879c8b45fae30e481d6f1e3fa1c7">mfem::ParNCMesh::GetFaceNeighbors</a></div><div class="ttdeci">void GetFaceNeighbors(class ParMesh &amp;pmesh)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l00886">pncmesh.cpp:886</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a4b5e9c6e1389e1ff399eebf28e5ac48d"><div class="ttname"><a href="classmfem_1_1Table.html#a4b5e9c6e1389e1ff399eebf28e5ac48d">mfem::Table::Swap</a></div><div class="ttdeci">void Swap(Table &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00394">table.cpp:394</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1FaceInfo_html_ad37ab9407b139a90c0d49bac23c708be"><div class="ttname"><a href="structmfem_1_1Mesh_1_1FaceInfo.html#ad37ab9407b139a90c0d49bac23c708be">mfem::Mesh::FaceInfo::Elem1Inf</a></div><div class="ttdeci">int Elem1Inf</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00156">mesh.hpp:156</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ae7f32e78ec3cf77fa2479bd1f3e68543"><div class="ttname"><a href="classmfem_1_1Mesh.html#ae7f32e78ec3cf77fa2479bd1f3e68543">mfem::Mesh::NumOfEdges</a></div><div class="ttdeci">int NumOfEdges</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00070">mesh.hpp:70</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html">mfem::NCMesh::NCList</a></div><div class="ttdoc">Lists all edges/faces in the nonconforming mesh. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00227">ncmesh.hpp:227</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a21772d74bd053829dca52a0394d0e49e"><div class="ttname"><a href="classmfem_1_1Mesh.html#a21772d74bd053829dca52a0394d0e49e">mfem::Mesh::GetBdrElementType</a></div><div class="ttdeci">Element::Type GetBdrElementType(int i) const</div><div class="ttdoc">Returns the type of boundary element i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06296">mesh.cpp:6296</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a66adc8ca8fb91fbe3684ae31fd1b3255"><div class="ttname"><a href="classmfem_1_1Mesh.html#a66adc8ca8fb91fbe3684ae31fd1b3255">mfem::Mesh::GetBoundingBox</a></div><div class="ttdeci">void GetBoundingBox(Vector &amp;min, Vector &amp;max, int ref=2)</div><div class="ttdoc">Returns the minimum and maximum corners of the mesh bounding box. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00129">mesh.cpp:129</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2329c4602cf0477c1b9e9292dd232bd1"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2329c4602cf0477c1b9e9292dd232bd1">mfem::Mesh::GetFaceGeometry</a></div><div class="ttdeci">Geometry::Type GetFaceGeometry(int i) const</div><div class="ttdoc">Return the Geometry::Type associated with face i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01413">mesh.cpp:1413</a></div></div>
<div class="ttc" id="namespacemfem_html_a4d41fc88f57d8f2806f909e35eabd648"><div class="ttname"><a href="namespacemfem.html#a4d41fc88f57d8f2806f909e35eabd648">mfem::ShiftRight</a></div><div class="ttdeci">void ShiftRight(int &amp;a, int &amp;b, int &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l02044">mesh.hpp:2044</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a230d2d88bbb44659679eba0c7d389bf2"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a230d2d88bbb44659679eba0c7d389bf2">mfem::ParMesh::sface_lface</a></div><div class="ttdeci">Array&lt; int &gt; sface_lface</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00078">pmesh.hpp:78</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_af7fae6773c6dfe98a9bc8b10a23c9720"><div class="ttname"><a href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">mfem::Table::SetDims</a></div><div class="ttdeci">void SetDims(int rows, int nnz)</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00140">table.cpp:140</a></div></div>
<div class="ttc" id="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TETRAHEDRON_01_4_html_a31427df70ce8e93401c7771596fc752d"><div class="ttname"><a href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TETRAHEDRON_01_4.html#a31427df70ce8e93401c7771596fc752d">mfem::Geometry::Constants&lt; Geometry::TETRAHEDRON &gt;::FaceVert</a></div><div class="ttdeci">static const int FaceVert[NumFaces][MaxFaceVert]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00226">geom.hpp:226</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_a8d6d09abcca8b7523d28c61e97ee9a15"><div class="ttname"><a href="classmfem_1_1Operator.html#a8d6d09abcca8b7523d28c61e97ee9a15">mfem::Operator::Width</a></div><div class="ttdeci">int Width() const</div><div class="ttdoc">Get the width (size of input) of the Operator. Synonym with NumCols(). </div><div class="ttdef"><b>Definition:</b> <a href="linalg_2operator_8hpp_source.html#l00072">operator.hpp:72</a></div></div>
<div class="ttc" id="classmfem_1_1Triple_html"><div class="ttname"><a href="classmfem_1_1Triple.html">mfem::Triple&lt; int, int, int &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a3458b71b04b2fc8376dd2d41c54f79fa"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a3458b71b04b2fc8376dd2d41c54f79fa">mfem::ParMesh::BuildSharedFaceElems</a></div><div class="ttdeci">void BuildSharedFaceElems(int ntri_faces, int nquad_faces, const Mesh &amp;mesh, int *partitioning, const STable3D *faces_tbl, const Array&lt; int &gt; &amp;face_group, const Array&lt; int &gt; &amp;vert_global_local)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00720">pmesh.cpp:720</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a171dc1db7958b2eece868de57a5b31c1">mfem::Element::TETRAHEDRON</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00042">element.hpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ae6d959a7cd2b26c570831111e2f0d80e"><div class="ttname"><a href="classmfem_1_1Mesh.html#ae6d959a7cd2b26c570831111e2f0d80e">mfem::Mesh::GetVertexToVertexTable</a></div><div class="ttdeci">void GetVertexToVertexTable(DSTable &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06372">mesh.cpp:6372</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_ac8535dd353bf1d8bb2068a28abe8b436"><div class="ttname"><a href="classmfem_1_1Element.html#ac8535dd353bf1d8bb2068a28abe8b436">mfem::Element::GetAttribute</a></div><div class="ttdeci">int GetAttribute() const</div><div class="ttdoc">Return element&amp;#39;s attribute. </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00055">element.hpp:55</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html">mfem::FaceElementTransformations</a></div><div class="ttdoc">A specialized ElementTransformation class representing a face and its two neighboring elements...</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00480">eltrans.hpp:480</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a1af753cbbc613bd5d225114e1ba9961d"><div class="ttname"><a href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">mfem::Array::GetData</a></div><div class="ttdeci">T * GetData()</div><div class="ttdoc">Returns the data. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00115">array.hpp:115</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a44040bae7ed45a2e221e24f75dc0fa44"><div class="ttname"><a href="classmfem_1_1Mesh.html#a44040bae7ed45a2e221e24f75dc0fa44">mfem::Mesh::Nonconforming</a></div><div class="ttdeci">bool Nonconforming() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01729">mesh.hpp:1729</a></div></div>
<div class="ttc" id="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PRISM_01_4_html_a11d85406c1e761ca4f3cc7c83d44a282"><div class="ttname"><a href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PRISM_01_4.html#a11d85406c1e761ca4f3cc7c83d44a282">mfem::Geometry::Constants&lt; Geometry::PRISM &gt;::FaceVert</a></div><div class="ttdeci">static const int FaceVert[NumFaces][MaxFaceVert]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00274">geom.hpp:274</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_aa9c5be6e53d0993d5851c276ba2a6079"><div class="ttname"><a href="classmfem_1_1Vector.html#aa9c5be6e53d0993d5851c276ba2a6079">mfem::Vector::Size</a></div><div class="ttdeci">int Size() const</div><div class="ttdoc">Returns the size of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00199">vector.hpp:199</a></div></div>
<div class="ttc" id="classmfem_1_1STable3D_html_a2e89a4660cf9259b9d08303777105885"><div class="ttname"><a href="classmfem_1_1STable3D.html#a2e89a4660cf9259b9d08303777105885">mfem::STable3D::Push</a></div><div class="ttdeci">int Push(int r, int c, int f)</div><div class="ttdoc">Check to see if this entry is in the table and add it to the table if it is not there. Returns the number assigned to the table entry. </div><div class="ttdef"><b>Definition:</b> <a href="stable3d_8cpp_source.html#l00064">stable3d.cpp:64</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a1d26743b6a4c76a56e60e2135ef04591"><div class="ttname"><a href="classmfem_1_1Array.html#a1d26743b6a4c76a56e60e2135ef04591">mfem::Array::Max</a></div><div class="ttdeci">T Max() const</div><div class="ttdoc">Find the maximal element in the array, using the comparison operator &lt; for class T. </div><div class="ttdef"><b>Definition:</b> <a href="array_8cpp_source.html#l00068">array.cpp:68</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html">mfem::DenseMatrix</a></div><div class="ttdoc">Data type dense matrix using column-major storage. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00023">densemat.hpp:23</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aaaabdc7661770619b981ffa61aeec428"><div class="ttname"><a href="classmfem_1_1Mesh.html#aaaabdc7661770619b981ffa61aeec428">mfem::Mesh::Nodes</a></div><div class="ttdeci">GridFunction * Nodes</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00245">mesh.hpp:245</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aaf671d6e376c40fad32a54753bfb7bda"><div class="ttname"><a href="classmfem_1_1Mesh.html#aaf671d6e376c40fad32a54753bfb7bda">mfem::Mesh::NumOfElements</a></div><div class="ttdeci">int NumOfElements</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00069">mesh.hpp:69</a></div></div>
<div class="ttc" id="classmfem_1_1RefinedGeometry_html"><div class="ttname"><a href="classmfem_1_1RefinedGeometry.html">mfem::RefinedGeometry</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00310">geom.hpp:310</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a4d6d51a8d57b7ebcf15de350761c5bf8af9926e2869f1a03d78b8a7dee533b13c"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8af9926e2869f1a03d78b8a7dee533b13c">mfem::FaceElementTransformations::HAVE_LOC2</a></div><div class="ttdoc">Point transformation for side 2 is configured. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00516">eltrans.hpp:516</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac8d355c5b980f33eff621eb3ef0660d3"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac8d355c5b980f33eff621eb3ef0660d3">mfem::Mesh::IsSlaveFace</a></div><div class="ttdeci">bool IsSlaveFace(const FaceInfo &amp;fi) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01051">mesh.cpp:1051</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_ac7b1dcce22e1c2bb4509713254db85c9"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#ac7b1dcce22e1c2bb4509713254db85c9">mfem::FaceElementTransformations::Loc2</a></div><div class="ttdeci">IntegrationPointTransformation Loc2</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00524">eltrans.hpp:524</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a81129a94d35bb7bf3746e92fc61cdff9"><div class="ttname"><a href="classmfem_1_1Mesh.html#a81129a94d35bb7bf3746e92fc61cdff9">mfem::Mesh::ApplyLocalSlaveTransformation</a></div><div class="ttdeci">void ApplyLocalSlaveTransformation(FaceElementTransformations &amp;FT, const FaceInfo &amp;fi, bool is_ghost)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01056">mesh.cpp:1056</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae9f0ec7ebdc1d605ad7dcb8b923e9b1e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae9f0ec7ebdc1d605ad7dcb8b923e9b1e">mfem::ParMesh::GetCharacteristics</a></div><div class="ttdeci">void GetCharacteristics(double &amp;h_min, double &amp;h_max, double &amp;kappa_min, double &amp;kappa_max)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06177">pmesh.cpp:6177</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2fd34bafce89dcad12039f80760c294ba0ad85359958a23db9b0e91fb5ecf521d"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294ba0ad85359958a23db9b0e91fb5ecf521d">mfem::Mesh::REBALANCE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00270">mesh.hpp:270</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aad2cb8db2b1437750935553c4034a9e1"><div class="ttname"><a href="classmfem_1_1Mesh.html#aad2cb8db2b1437750935553c4034a9e1">mfem::Mesh::AverageVertices</a></div><div class="ttdeci">void AverageVertices(const int *indexes, int n, int result)</div><div class="ttdoc">Averages the vertices with given indexes and saves the result in vertices[result]. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l08011">mesh.cpp:8011</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a0b31f62cb833a0e09c9eb89fd1c9a34d"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a0b31f62cb833a0e09c9eb89fd1c9a34d">mfem::ParNCMesh::SynchronizeDerefinementData</a></div><div class="ttdeci">void SynchronizeDerefinementData(Array&lt; Type &gt; &amp;elem_data, const Table &amp;deref_table)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01545">pncmesh.cpp:1545</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a042492b062fbd9308a9f4320fcabd1ce"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a042492b062fbd9308a9f4320fcabd1ce">mfem::ParMesh::NonconformingRefinement</a></div><div class="ttdeci">void NonconformingRefinement(const Array&lt; Refinement &gt; &amp;refinements, int nc_limit=0) override</div><div class="ttdoc">This function is not public anymore. Use GeneralRefinement instead. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03948">pmesh.cpp:3948</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a4618ccff09bb81c70312b642762b7a57"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a4618ccff09bb81c70312b642762b7a57">mfem::DenseMatrix::CalcSingularvalue</a></div><div class="ttdeci">double CalcSingularvalue(const int i) const</div><div class="ttdoc">Return the i-th singular value (decreasing order) of NxN matrix, N=1,2,3. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l01268">densemat.cpp:1268</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aafd5d6df0b247c7bc48773204c086eb4"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aafd5d6df0b247c7bc48773204c086eb4">mfem::ParMesh::EnsureParNodes</a></div><div class="ttdeci">void EnsureParNodes()</div><div class="ttdoc">If the mesh is curved, make sure &amp;#39;Nodes&amp;#39; is ParGridFunction. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02095">pmesh.cpp:2095</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_aae2ff639412b9ec63aa0fd413cd1451b"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#aae2ff639412b9ec63aa0fd413cd1451b">mfem::FiniteElementSpace::GetTraceElement</a></div><div class="ttdeci">const FiniteElement * GetTraceElement(int i, Geometry::Type geom_type) const</div><div class="ttdoc">Return the trace element from element &amp;#39;i&amp;#39; to the given &amp;#39;geom_type&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l03175">fespace.cpp:3175</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a61a969e430fbf545c0c984405f37ce51"><div class="ttname"><a href="classmfem_1_1Element.html#a61a969e430fbf545c0c984405f37ce51">mfem::Element::SetVertices</a></div><div class="ttdeci">virtual void SetVertices(const int *ind)</div><div class="ttdoc">Set the indices the element according to the input. </div><div class="ttdef"><b>Definition:</b> <a href="element_8cpp_source.html#l00017">element.cpp:17</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a02c524628afe38b9c8bfd2467be0c9c5"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a02c524628afe38b9c8bfd2467be0c9c5">mfem::GroupTopology::GetNeighborRank</a></div><div class="ttdeci">int GetNeighborRank(int i) const</div><div class="ttdoc">Return the MPI rank of neighbor &amp;#39;i&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00161">communication.hpp:161</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a09bf96bbcf2833f005406317841f19b2"><div class="ttname"><a href="classmfem_1_1Mesh.html#a09bf96bbcf2833f005406317841f19b2">mfem::Mesh::GetNEdges</a></div><div class="ttdeci">int GetNEdges() const</div><div class="ttdoc">Return the number of edges. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00942">mesh.hpp:942</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ac1eca094b9624f7a24dce5c6ab333caf"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ac1eca094b9624f7a24dce5c6ab333caf">mfem::ParMesh::UniformRefineGroups3D</a></div><div class="ttdeci">void UniformRefineGroups3D(int old_nv, int old_nedges, const DSTable &amp;old_v_to_v, const STable3D &amp;old_faces, Array&lt; int &gt; *f2qf)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04414">pmesh.cpp:4414</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aac0ecfa0737785cb713cb30b81bdf591"><div class="ttname"><a href="classmfem_1_1Mesh.html#aac0ecfa0737785cb713cb30b81bdf591">mfem::Mesh::GetElement</a></div><div class="ttdeci">const Element * GetElement(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01081">mesh.hpp:1081</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1NCFaceInfo_html_ac21072f78c884782721ffff19a498c65"><div class="ttname"><a href="structmfem_1_1Mesh_1_1NCFaceInfo.html#ac21072f78c884782721ffff19a498c65">mfem::Mesh::NCFaceInfo::MasterFace</a></div><div class="ttdeci">int MasterFace</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00205">mesh.hpp:205</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a68b86b731cbb7a3df48b919e6f7ca55e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a68b86b731cbb7a3df48b919e6f7ca55e">mfem::ParMesh::FindPoints</a></div><div class="ttdeci">int FindPoints(DenseMatrix &amp;point_mat, Array&lt; int &gt; &amp;elem_ids, Array&lt; IntegrationPoint &gt; &amp;ips, bool warn=true, InverseElementTransformation *inv_trans=NULL) override</div><div class="ttdoc">Find the ids of the elements that contain the given points, and their corresponding reference coordin...</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06459">pmesh.cpp:6459</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_ae0d6fbb5a3078ba054a640ed88c5a104"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#ae0d6fbb5a3078ba054a640ed88c5a104">mfem::ParNCMesh::Derefine</a></div><div class="ttdeci">virtual void Derefine(const Array&lt; int &gt; &amp;derefs)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01373">pncmesh.cpp:1373</a></div></div>
<div class="ttc" id="ex24_8cpp_html_a05ac5235b52a827a368e74ed228dd485"><div class="ttname"><a href="ex24_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a></div><div class="ttdeci">double kappa</div><div class="ttdef"><b>Definition:</b> <a href="ex24_8cpp_source.html#l00054">ex24.cpp:54</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html">mfem::ParFiniteElementSpace</a></div><div class="ttdoc">Abstract parallel finite element space. </div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8hpp_source.html#l00028">pfespace.hpp:28</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a8187ff0c6703b4729a13bc8d81b7f151"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a8187ff0c6703b4729a13bc8d81b7f151">mfem::ParMesh::have_face_nbr_data</a></div><div class="ttdeci">bool have_face_nbr_data</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00378">pmesh.hpp:378</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_acd3c84dfa471a83e6aa94b33730f7a5d"><div class="ttname"><a href="classmfem_1_1ParMesh.html#acd3c84dfa471a83e6aa94b33730f7a5d">mfem::ParMesh::shared_trias</a></div><div class="ttdeci">Array&lt; Vert3 &gt; shared_trias</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00065">pmesh.hpp:65</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a092fe433b60220af5f2059d482d64639"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a092fe433b60220af5f2059d482d64639">mfem::ParMesh::face_nbr_vertices_offset</a></div><div class="ttdeci">Array&lt; int &gt; face_nbr_vertices_offset</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00381">pmesh.hpp:381</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_a5b7454afd8d02d6a6fe8ec4754e448fe"><div class="ttname"><a href="classmfem_1_1GridFunction.html#a5b7454afd8d02d6a6fe8ec4754e448fe">mfem::GridFunction::MakeOwner</a></div><div class="ttdeci">void MakeOwner(FiniteElementCollection *fec_)</div><div class="ttdoc">Make the GridFunction the owner of fec and fes. </div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8hpp_source.html#l00122">gridfunc.hpp:122</a></div></div>
<div class="ttc" id="classmfem_1_1Vertex_html"><div class="ttname"><a href="classmfem_1_1Vertex.html">mfem::Vertex</a></div><div class="ttdoc">Data type for vertex. </div><div class="ttdef"><b>Definition:</b> <a href="vertex_8hpp_source.html#l00022">vertex.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ad96a1f7ebda1728b3683893b16671eae"><div class="ttname"><a href="classmfem_1_1Mesh.html#ad96a1f7ebda1728b3683893b16671eae">mfem::Mesh::SetMeshGen</a></div><div class="ttdeci">void SetMeshGen()</div><div class="ttdoc">Determine the mesh generator bitmask meshgen, see MeshGenerator(). </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l03926">mesh.cpp:3926</a></div></div>
<div class="ttc" id="classmfem_1_1RefinedGeometry_html_acd79d35d60905b00ce7add9470b378ad"><div class="ttname"><a href="classmfem_1_1RefinedGeometry.html#acd79d35d60905b00ce7add9470b378ad">mfem::RefinedGeometry::RefEdges</a></div><div class="ttdeci">Array&lt; int &gt; RefEdges</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00315">geom.hpp:315</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ab759883803589739cc115f96d4e78a8b"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ab759883803589739cc115f96d4e78a8b">mfem::ParMesh::face_nbr_group</a></div><div class="ttdeci">Array&lt; int &gt; face_nbr_group</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00379">pmesh.hpp:379</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1e1467c385205e8958089ae090156c9d"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1e1467c385205e8958089ae090156c9d">mfem::Mesh::GetQuadOrientation</a></div><div class="ttdeci">static int GetQuadOrientation(const int *base, const int *test)</div><div class="ttdoc">Returns the orientation of &quot;test&quot; relative to &quot;base&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05629">mesh.cpp:5629</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a4466317d7e70353013bb842c74556e54"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a4466317d7e70353013bb842c74556e54">mfem::ParMesh::NonconformingDerefinement</a></div><div class="ttdeci">bool NonconformingDerefinement(Array&lt; double &gt; &amp;elem_error, double threshold, int nc_limit=0, int op=1) override</div><div class="ttdoc">NC version of GeneralDerefinement. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04000">pmesh.cpp:4000</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1FaceInfo_html_aa4799f92980466d991fb36a5e42e65f8"><div class="ttname"><a href="structmfem_1_1Mesh_1_1FaceInfo.html#aa4799f92980466d991fb36a5e42e65f8">mfem::Mesh::FaceInfo::NCFace</a></div><div class="ttdeci">int NCFace</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00157">mesh.hpp:157</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a27f8a22536eab0821bed4ba0790cac6e"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a27f8a22536eab0821bed4ba0790cac6e">mfem::DenseMatrix::Weight</a></div><div class="ttdeci">double Weight() const</div><div class="ttdef"><b>Definition:</b> <a href="densemat_8cpp_source.html#l00545">densemat.cpp:545</a></div></div>
<div class="ttc" id="namespacemfem_html_aa1cc5701e3e695b09a013e7f6301a850ad2cd8253361a9c732d21ca1d336599cc"><div class="ttname"><a href="namespacemfem.html#aa1cc5701e3e695b09a013e7f6301a850ad2cd8253361a9c732d21ca1d336599cc">mfem::VTKFormat::ASCII</a></div><div class="ttdoc">Data arrays will be written in ASCII format. </div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a4d6d51a8d57b7ebcf15de350761c5bf8a698034150b296a90af6201c7d94d6ad4"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8a698034150b296a90af6201c7d94d6ad4">mfem::FaceElementTransformations::HAVE_ELEM2</a></div><div class="ttdoc">Element on side 2 is configured. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00514">eltrans.hpp:514</a></div></div>
<div class="ttc" id="classmfem_1_1InverseElementTransformation_html"><div class="ttname"><a href="classmfem_1_1InverseElementTransformation.html">mfem::InverseElementTransformation</a></div><div class="ttdoc">The inverse transformation of a given ElementTransformation. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00185">eltrans.hpp:185</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ac4218963b161bfae267b6ff9c22e1bbc"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ac4218963b161bfae267b6ff9c22e1bbc">mfem::ParMesh::RebalanceImpl</a></div><div class="ttdeci">void RebalanceImpl(const Array&lt; int &gt; *partition)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04068">pmesh.cpp:4068</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_afba0dcbfb9dbd7d2bf794478c8437589"><div class="ttname"><a href="classmfem_1_1ParMesh.html#afba0dcbfb9dbd7d2bf794478c8437589">mfem::ParMesh::GroupEdge</a></div><div class="ttdeci">void GroupEdge(int group, int i, int &amp;edge, int &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01607">pmesh.cpp:1607</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_afb9ab36ef169bec5b72f6cbb928f298f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#afb9ab36ef169bec5b72f6cbb928f298f">mfem::ParMesh::MarkTetMeshForRefinement</a></div><div class="ttdeci">void MarkTetMeshForRefinement(DSTable &amp;v_to_v) override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01733">pmesh.cpp:1733</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a0e6638d14519c9856e743713c9a359c6"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a0e6638d14519c9856e743713c9a359c6">mfem::FaceElementTransformations::Elem2</a></div><div class="ttdeci">ElementTransformation * Elem2</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00522">eltrans.hpp:522</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html"><div class="ttname"><a href="classmfem_1_1Table.html">mfem::Table</a></div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00043">table.hpp:43</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a9cd80a3c556bbe144e5524944ea00109"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a9cd80a3c556bbe144e5524944ea00109">mfem::ParMesh::BuildFaceGroup</a></div><div class="ttdeci">void BuildFaceGroup(int ngroups, const Mesh &amp;mesh, const Array&lt; int &gt; &amp;face_group, int &amp;nstria, int &amp;nsquad)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00622">pmesh.cpp:622</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a24e06c9dc0ab8400aff8a8f061de4197"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a24e06c9dc0ab8400aff8a8f061de4197">mfem::GroupTopology::Swap</a></div><div class="ttdeci">void Swap(GroupTopology &amp;other)</div><div class="ttdoc">Swap the internal data with another GroupTopology object. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00329">communication.cpp:329</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a3f7589d77a54377f6b080cd2f934af48"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a3f7589d77a54377f6b080cd2f934af48">mfem::FiniteElementSpace::GetVertexDofs</a></div><div class="ttdeci">void GetVertexDofs(int i, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l03035">fespace.cpp:3035</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a15e10ac10768ad6537bcda1cf1380792"><div class="ttname"><a href="classmfem_1_1Mesh.html#a15e10ac10768ad6537bcda1cf1380792">mfem::Mesh::GetFaceElementTransformations</a></div><div class="ttdeci">virtual FaceElementTransformations * GetFaceElementTransformations(int FaceNo, int mask=31)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00961">mesh.cpp:961</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a576ffc3a6e0d9087271ef7fb53ce4169"><div class="ttname"><a href="classmfem_1_1Table.html#a576ffc3a6e0d9087271ef7fb53ce4169">mfem::Table::RowSize</a></div><div class="ttdeci">int RowSize(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00108">table.hpp:108</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a3bde3e4be1041da56e0ede94fd5575e8"><div class="ttname"><a href="classmfem_1_1Mesh.html#a3bde3e4be1041da56e0ede94fd5575e8">mfem::Mesh::faces</a></div><div class="ttdeci">Array&lt; Element * &gt; faces</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00092">mesh.hpp:92</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_afb55a0fedd48df0fcd524b9dce60589b"><div class="ttname"><a href="classmfem_1_1Geometry.html#afb55a0fedd48df0fcd524b9dce60589b">mfem::Geometry::GetVertices</a></div><div class="ttdeci">const IntegrationRule * GetVertices(int GeomType)</div><div class="ttdoc">Return an IntegrationRule consisting of all vertices of the given Geometry::Type, GeomType...</div><div class="ttdef"><b>Definition:</b> <a href="geom_8cpp_source.html#l00265">geom.cpp:265</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_ac1441513981a3a71dcc99f78cfa9d2cb"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#ac1441513981a3a71dcc99f78cfa9d2cb">mfem::ParNCMesh::GetSharedEdges</a></div><div class="ttdeci">const NCList &amp; GetSharedEdges()</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8hpp_source.html#l00124">pncmesh.hpp:124</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac012cb85c61cf06ba1c552d56d67f71e"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac012cb85c61cf06ba1c552d56d67f71e">mfem::Mesh::GetNBE</a></div><div class="ttdeci">int GetNBE() const</div><div class="ttdoc">Returns number of boundary elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00939">mesh.hpp:939</a></div></div>
<div class="ttc" id="namespacemfem_html_a4310501b6df5bda8f82fc045015b40a8"><div class="ttname"><a href="namespacemfem.html#a4310501b6df5bda8f82fc045015b40a8">mfem::Geometries</a></div><div class="ttdeci">Geometry Geometries</div><div class="ttdef"><b>Definition:</b> <a href="fe_8cpp_source.html#l00049">fe.cpp:49</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ad98e0ee2b8f5406d15161492c9d186f4"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ad98e0ee2b8f5406d15161492c9d186f4">mfem::ParMesh::GetSharedFacesTable</a></div><div class="ttdeci">STable3D * GetSharedFacesTable()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02661">pmesh.cpp:2661</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a9f7b4db97a116cc7d2b988f3b74e50f7"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a9f7b4db97a116cc7d2b988f3b74e50f7">mfem::ParMesh::sedge_ledge</a></div><div class="ttdeci">Array&lt; int &gt; sedge_ledge</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00076">pmesh.hpp:76</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a18ddc6d1c3a178d628350bbc6b8f030e"><div class="ttname"><a href="classmfem_1_1Mesh.html#a18ddc6d1c3a178d628350bbc6b8f030e">mfem::Mesh::RedRefinement</a></div><div class="ttdeci">void RedRefinement(int i, const DSTable &amp;v_to_v, int *edge1, int *edge2, int *middle)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00359">mesh.hpp:359</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aed8f13455eddd66c387966f71d19f329"><div class="ttname"><a href="classmfem_1_1Mesh.html#aed8f13455eddd66c387966f71d19f329">mfem::Mesh::last_operation</a></div><div class="ttdeci">Operation last_operation</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00289">mesh.hpp:289</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a34d8919e16670b0034d53d9b6ea258b5"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a34d8919e16670b0034d53d9b6ea258b5">mfem::GroupTopology::Save</a></div><div class="ttdeci">void Save(std::ostream &amp;out) const</div><div class="ttdoc">Save the data in a stream. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00261">communication.cpp:261</a></div></div>
<div class="ttc" id="namespacemfem_html_af2ff7d23ad44e0ac992308edd40dd30b"><div class="ttname"><a href="namespacemfem.html#af2ff7d23ad44e0ac992308edd40dd30b">mfem::skip_comment_lines</a></div><div class="ttdeci">void skip_comment_lines(std::istream &amp;is, const char comment_char)</div><div class="ttdoc">Check if the stream starts with comment_char. If so skip it. </div><div class="ttdef"><b>Definition:</b> <a href="text_8hpp_source.html#l00031">text.hpp:31</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a5b8a79e9931e284c0214da68d23339b9"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a5b8a79e9931e284c0214da68d23339b9">mfem::ParMesh::HasBoundaryElements</a></div><div class="ttdeci">bool HasBoundaryElements() const override</div><div class="ttdoc">Checks if any rank in the mesh has boundary elements. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01598">pmesh.cpp:1598</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a857a050fe403ce45e0b7cc7912c4a3fe"><div class="ttname"><a href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">mfem::Array::DeleteAll</a></div><div class="ttdeci">void DeleteAll()</div><div class="ttdoc">Delete the whole array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00851">array.hpp:851</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aeee043d090a2db2b13b5b733404b69f9"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aeee043d090a2db2b13b5b733404b69f9">mfem::ParMesh::group_stria</a></div><div class="ttdeci">Table group_stria</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00071">pmesh.hpp:71</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a6e60ce794202c56cc58d1141deec6905"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a6e60ce794202c56cc58d1141deec6905">mfem::FiniteElementSpace::GetFE</a></div><div class="ttdeci">virtual const FiniteElement * GetFE(int i) const</div><div class="ttdoc">Returns pointer to the FiniteElement in the FiniteElementCollection associated with i&amp;#39;th element in t...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l02783">fespace.cpp:2783</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a440c7b20b906c764e57bd43ee5670d60"><div class="ttname"><a href="classmfem_1_1Table.html#a440c7b20b906c764e57bd43ee5670d60">mfem::Table::AddConnections</a></div><div class="ttdeci">void AddConnections(int r, const int *c, int nc)</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00104">table.cpp:104</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af4a17aac29f1b53d82433b6a76e7145c"><div class="ttname"><a href="classmfem_1_1Mesh.html#af4a17aac29f1b53d82433b6a76e7145c">mfem::Mesh::InitRefinementTransforms</a></div><div class="ttdeci">void InitRefinementTransforms()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l09968">mesh.cpp:9968</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_ad4148905bd3ce26e861a013161acf82d"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#ad4148905bd3ce26e861a013161acf82d">mfem::ParNCMesh::GetSharedList</a></div><div class="ttdeci">const NCList &amp; GetSharedList(int entity)</div><div class="ttdoc">Helper to get shared vertices/edges/faces (&amp;#39;entity&amp;#39; == 0/1/2 resp.). </div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8hpp_source.html#l00128">pncmesh.hpp:128</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab35a7f8b1a2c0d13ab2094271b00efd1"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab35a7f8b1a2c0d13ab2094271b00efd1">mfem::Mesh::UniformRefinement2D_base</a></div><div class="ttdeci">void UniformRefinement2D_base(bool update_nodes=true)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l08047">mesh.cpp:8047</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2f2d9df54781b659fd4eb47717ec0dc9"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2f2d9df54781b659fd4eb47717ec0dc9">mfem::Mesh::nc_faces_info</a></div><div class="ttdeci">Array&lt; NCFaceInfo &gt; nc_faces_info</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00218">mesh.hpp:218</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0333c5d35901cd957d7fb56df0801b1c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">mfem::NCMesh::OnMeshUpdated</a></div><div class="ttdeci">void OnMeshUpdated(Mesh *mesh)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02532">ncmesh.cpp:2532</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html">mfem::ParNCMesh</a></div><div class="ttdoc">A parallel extension of the NCMesh class. </div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8hpp_source.html#l00064">pncmesh.hpp:64</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a085464fbf2a801f2a98a724af938b5ba"><div class="ttname"><a href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">mfem::Mesh::NewElement</a></div><div class="ttdeci">Element * NewElement(int geom)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l03854">mesh.cpp:3854</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6901d57cf77f50497a6741d77f10f062"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6901d57cf77f50497a6741d77f10f062">mfem::Mesh::el_to_face</a></div><div class="ttdeci">Table * el_to_face</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00221">mesh.hpp:221</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_adf437db39b813d08b2f47440072e0f57"><div class="ttname"><a href="classmfem_1_1Mesh.html#adf437db39b813d08b2f47440072e0f57">mfem::Mesh::FaceElemTr</a></div><div class="ttdeci">FaceElementTransformations FaceElemTr</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00237">mesh.hpp:237</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae130412ac93da80414fa47ad93902bc1"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae130412ac93da80414fa47ad93902bc1">mfem::ParMesh::pncmesh</a></div><div class="ttdeci">ParNCMesh * pncmesh</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00388">pmesh.hpp:388</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a86c6eeb23dadaafd282a6ff0dbe63b69"><div class="ttname"><a href="classmfem_1_1Mesh.html#a86c6eeb23dadaafd282a6ff0dbe63b69">mfem::Mesh::GetFaceElements</a></div><div class="ttdeci">void GetFaceElements(int Face, int *Elem1, int *Elem2) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01394">mesh.cpp:1394</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a02c45b15e111f47cc55732d6f3bec084"><div class="ttname"><a href="classmfem_1_1Mesh.html#a02c45b15e111f47cc55732d6f3bec084">mfem::Mesh::SetVerticesFromNodes</a></div><div class="ttdeci">void SetVerticesFromNodes(const GridFunction *nodes)</div><div class="ttdoc">Helper to set vertex coordinates given a high-order curvature function. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05375">mesh.cpp:5375</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_ae4a9f6367724dae9cef308452ec38848"><div class="ttname"><a href="classmfem_1_1Array.html#ae4a9f6367724dae9cef308452ec38848">mfem::Array::CopyTo</a></div><div class="ttdeci">void CopyTo(U *dest)</div><div class="ttdoc">STL-like copyTo dest from begin to end. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00282">array.hpp:282</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ac6d9d2955527fac5e033d20433491f82"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ac6d9d2955527fac5e033d20433491f82">mfem::ParMesh::FindSharedEdges</a></div><div class="ttdeci">int FindSharedEdges(const Mesh &amp;mesh, const int *partition, Table *&amp;edge_element, ListOfIntegerSets &amp;groups)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00531">pmesh.cpp:531</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2fd34bafce89dcad12039f80760c294baa1fafee4d375682ea8c579adfbaffd61"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294baa1fafee4d375682ea8c579adfbaffd61">mfem::Mesh::DEREFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00270">mesh.hpp:270</a></div></div>
<div class="ttc" id="classmfem_1_1ParNURBSExtension_html"><div class="ttname"><a href="classmfem_1_1ParNURBSExtension.html">mfem::ParNURBSExtension</a></div><div class="ttdef"><b>Definition:</b> <a href="nurbs_8hpp_source.html#l00410">nurbs.hpp:410</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElement_html_ac4548a4548b814f37dbc49a763625dc6"><div class="ttname"><a href="classmfem_1_1FiniteElement.html#ac4548a4548b814f37dbc49a763625dc6">mfem::FiniteElement::Project</a></div><div class="ttdeci">virtual void Project(Coefficient &amp;coeff, ElementTransformation &amp;Trans, Vector &amp;dofs) const</div><div class="ttdoc">Given a coefficient and a transformation, compute its projection (approximation) in the local finite ...</div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8cpp_source.html#l00125">fe_base.cpp:125</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a02e05e5a2d85cec35abe19211ae272c2"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a02e05e5a2d85cec35abe19211ae272c2">mfem::FaceElementTransformations::Elem1No</a></div><div class="ttdeci">int Elem1No</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00520">eltrans.hpp:520</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aa54d3303834de5d84f2ab3ea41dc3385"><div class="ttname"><a href="classmfem_1_1Mesh.html#aa54d3303834de5d84f2ab3ea41dc3385">mfem::Mesh::GetNV</a></div><div class="ttdeci">int GetNV() const</div><div class="ttdoc">Returns number of vertices. Vertices are only at the corners of elements, where you would expect them...</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00933">mesh.hpp:933</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2e59779374ef3ceee57ff013d12d2bb5"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2e59779374ef3ceee57ff013d12d2bb5">mfem::Mesh::MakeRefined_</a></div><div class="ttdeci">void MakeRefined_(Mesh &amp;orig_mesh, const Array&lt; int &gt; ref_factors, int ref_type)</div><div class="ttdoc">Internal function used in Mesh::MakeRefined. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l04346">mesh.cpp:4346</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a241cf41f69c6d481943811967915fa57"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a241cf41f69c6d481943811967915fa57">mfem::ParMesh::ExchangeFaceNbrData</a></div><div class="ttdeci">void ExchangeFaceNbrData()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02117">pmesh.cpp:2117</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1FaceInfo_html_ae80c204d9f7f651358d2a1b18cbe40ba"><div class="ttname"><a href="structmfem_1_1Mesh_1_1FaceInfo.html#ae80c204d9f7f651358d2a1b18cbe40ba">mfem::Mesh::FaceInfo::Elem2No</a></div><div class="ttdeci">int Elem2No</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00156">mesh.hpp:156</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a360c3741a62e64c827d4101b69a4439f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a360c3741a62e64c827d4101b69a4439f">mfem::ParMesh::BuildSharedVertMapping</a></div><div class="ttdeci">void BuildSharedVertMapping(int nvert, const Table *vert_element, const Array&lt; int &gt; &amp;vert_global_local)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00834">pmesh.cpp:834</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2883f6489c821ed509ce84e74b919b54"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2883f6489c821ed509ce84e74b919b54">mfem::Mesh::GetAttribute</a></div><div class="ttdeci">int GetAttribute(int i) const</div><div class="ttdoc">Return the attribute of element i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01544">mesh.hpp:1544</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_ab9dcb35bab1960fbed70643586289b04"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#ab9dcb35bab1960fbed70643586289b04">mfem::ParFiniteElementSpace::GetFaceNbrElementVDofs</a></div><div class="ttdeci">DofTransformation * GetFaceNbrElementVDofs(int i, Array&lt; int &gt; &amp;vdofs) const</div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l01464">pfespace.cpp:1464</a></div></div>
<div class="ttc" id="structmfem_1_1ParMesh_1_1Vert3_html_ac2c5fb0ba8b8f3da6ea91c90a92f232d"><div class="ttname"><a href="structmfem_1_1ParMesh_1_1Vert3.html#ac2c5fb0ba8b8f3da6ea91c90a92f232d">mfem::ParMesh::Vert3::v</a></div><div class="ttdeci">int v[3]</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00042">pmesh.hpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a3cee7765b3ce1a6a8f5fe82b69e7166e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a3cee7765b3ce1a6a8f5fe82b69e7166e">mfem::ParMesh::ReduceMeshGen</a></div><div class="ttdeci">void ReduceMeshGen()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00881">pmesh.cpp:881</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a950cc1011ae68063201e5fb567398012"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a950cc1011ae68063201e5fb567398012">mfem::ParMesh::NURBSUniformRefinement</a></div><div class="ttdeci">void NURBSUniformRefinement() override</div><div class="ttdoc">Refine NURBS mesh. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04616">pmesh.cpp:4616</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a5c463f733d1052e424c2b0c26cd46591"><div class="ttname"><a href="classmfem_1_1Mesh.html#a5c463f733d1052e424c2b0c26cd46591">mfem::Mesh::GetElementJacobian</a></div><div class="ttdeci">void GetElementJacobian(int i, DenseMatrix &amp;J)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00060">mesh.cpp:60</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a80761f9e9a934d1a5e16efdc5e611446"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a80761f9e9a934d1a5e16efdc5e611446">mfem::ParMesh::Rebalance</a></div><div class="ttdeci">void Rebalance()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04058">pmesh.cpp:4058</a></div></div>
<div class="ttc" id="classmfem_1_1Triangle_html_a05a8415be2afef95a979c31e1a78cf3d"><div class="ttname"><a href="classmfem_1_1Triangle.html#a05a8415be2afef95a979c31e1a78cf3d">mfem::Triangle::MarkEdge</a></div><div class="ttdeci">void MarkEdge(DenseMatrix &amp;pmat)</div><div class="ttdef"><b>Definition:</b> <a href="triangle_8cpp_source.html#l00053">triangle.cpp:53</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ad9950e1768fac1c8ee0a54f219c4a9ba"><div class="ttname"><a href="classmfem_1_1Mesh.html#ad9950e1768fac1c8ee0a54f219c4a9ba">mfem::Mesh::AddVertex</a></div><div class="ttdeci">int AddVertex(double x, double y=0.0, double z=0.0)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01618">mesh.cpp:1618</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a77dae875c8b86a41b8f22d2f7fd6b331"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a77dae875c8b86a41b8f22d2f7fd6b331">mfem::ParMesh::GetGlobalEdgeIndices</a></div><div class="ttdeci">void GetGlobalEdgeIndices(Array&lt; HYPRE_BigInt &gt; &amp;gi) const</div><div class="ttdoc">AMR meshes are not supported. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06611">pmesh.cpp:6611</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a0c4dd0df3a6c4d9b11343c4473f7841e"><div class="ttname"><a href="classmfem_1_1Mesh.html#a0c4dd0df3a6c4d9b11343c4473f7841e">mfem::Mesh::GetBdrElementFace</a></div><div class="ttdeci">void GetBdrElementFace(int i, int *f, int *o) const</div><div class="ttdoc">Return the index and the orientation of the face of bdr element i. (3D) </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06212">mesh.cpp:6212</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aeb7a273faffe828dee49ae4f5e39529a"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aeb7a273faffe828dee49ae4f5e39529a">mfem::ParMesh::BuildLocalBoundary</a></div><div class="ttdeci">int BuildLocalBoundary(const Mesh &amp;global_mesh, const int *partitioning, const Array&lt; int &gt; &amp;vert_global_local, Array&lt; bool &gt; &amp;activeBdrElem, Table *&amp;edge_element)</div><div class="ttdoc">Fills out partitioned Mesh::boundary. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00383">pmesh.cpp:383</a></div></div>
<div class="ttc" id="namespacemfem_html_af736ce0d62a2894982a1eda9dbe93fb7"><div class="ttname"><a href="namespacemfem.html#af736ce0d62a2894982a1eda9dbe93fb7">mfem::FaceType</a></div><div class="ttdeci">FaceType</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00045">mesh.hpp:45</a></div></div>
<div class="ttc" id="classmfem_1_1GroupCommunicator_html"><div class="ttname"><a href="classmfem_1_1GroupCommunicator.html">mfem::GroupCommunicator</a></div><div class="ttdoc">Communicator performing operations within groups defined by a GroupTopology with arbitrary-size data ...</div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00201">communication.hpp:201</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a7ebd0fa46057255dcc412d8b76e5ead4"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a7ebd0fa46057255dcc412d8b76e5ead4">mfem::ParMesh::ParPrint</a></div><div class="ttdeci">void ParPrint(std::ostream &amp;out) const</div><div class="ttdoc">Save the mesh in a parallel mesh format. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06309">pmesh.cpp:6309</a></div></div>
<div class="ttc" id="classmfem_1_1Segment_html_afbe497734a991a283ec832d9861885ec"><div class="ttname"><a href="classmfem_1_1Segment.html#afbe497734a991a283ec832d9861885ec">mfem::Segment::GetVertices</a></div><div class="ttdeci">virtual void GetVertices(Array&lt; int &gt; &amp;v) const</div><div class="ttdoc">Returns the indices of the element&amp;#39;s vertices. </div><div class="ttdef"><b>Definition:</b> <a href="segment_8cpp_source.html#l00040">segment.cpp:40</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac0221ba9089ee9e6cb81546177977c97"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac0221ba9089ee9e6cb81546177977c97">mfem::Mesh::GetGlobalNE</a></div><div class="ttdeci">long long GetGlobalNE() const</div><div class="ttdoc">Return the total (global) number of elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00968">mesh.hpp:968</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ab7843d6f686e1e85227238b19965ba12"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ab7843d6f686e1e85227238b19965ba12">mfem::ParMesh::face_nbr_elements_offset</a></div><div class="ttdeci">Array&lt; int &gt; face_nbr_elements_offset</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00380">pmesh.hpp:380</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ace8518539660c6f8bc04198b3e28ea46"><div class="ttname"><a href="classmfem_1_1Mesh.html#ace8518539660c6f8bc04198b3e28ea46">mfem::Mesh::GetEdgeOrdering</a></div><div class="ttdeci">void GetEdgeOrdering(DSTable &amp;v_to_v, Array&lt; int &gt; &amp;order)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02445">mesh.cpp:2445</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a905eae200606c78fe0b9602888daf0b1"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a905eae200606c78fe0b9602888daf0b1">mfem::ParMesh::MyComm</a></div><div class="ttdeci">MPI_Comm MyComm</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00037">pmesh.hpp:37</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a8a9eeb25e4480dddca25a2c292eae00d"><div class="ttname"><a href="classmfem_1_1Mesh.html#a8a9eeb25e4480dddca25a2c292eae00d">mfem::Mesh::GetElementFaces</a></div><div class="ttdeci">void GetElementFaces(int i, Array&lt; int &gt; &amp;faces, Array&lt; int &gt; &amp;ori) const</div><div class="ttdoc">Return the indices and the orientations of all faces of element i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06161">mesh.cpp:6161</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">mfem::Geometry::SQUARE</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00038">geom.hpp:38</a></div></div>
<div class="ttc" id="namespacemfem_html_a3697bdaae6ecb0512523be42d34f468a"><div class="ttname"><a href="namespacemfem.html#a3697bdaae6ecb0512523be42d34f468a">mfem::GlobGeometryRefiner</a></div><div class="ttdeci">GeometryRefiner GlobGeometryRefiner</div><div class="ttdef"><b>Definition:</b> <a href="geom_8cpp_source.html#l01773">geom.cpp:1773</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a96c92d4c620bb09098eddad86891b21f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a96c92d4c620bb09098eddad86891b21f">mfem::ParMesh::Finalize</a></div><div class="ttdeci">void Finalize(bool refine=false, bool fix_orientation=false) override</div><div class="ttdoc">Finalize the construction of a general Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01516">pmesh.cpp:1516</a></div></div>
<div class="ttc" id="namespacemfem_html_a6ca5c7837c048d0c2692cfe31c1b88ba"><div class="ttname"><a href="namespacemfem.html#a6ca5c7837c048d0c2692cfe31c1b88ba">mfem::f</a></div><div class="ttdeci">double f(const Vector &amp;xvec)</div><div class="ttdef"><b>Definition:</b> <a href="lor__mms_8hpp_source.html#l00032">lor_mms.hpp:32</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_adde50e5a10f09b877c861d8371981c0c"><div class="ttname"><a href="classmfem_1_1Mesh.html#adde50e5a10f09b877c861d8371981c0c">mfem::Mesh::GetElementSize</a></div><div class="ttdeci">double GetElementSize(ElementTransformation *T, int type=0)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00076">mesh.cpp:76</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a1e661e3be0ce243710e18e1ee41a887a"><div class="ttname"><a href="classmfem_1_1Element.html#a1e661e3be0ce243710e18e1ee41a887a">mfem::Element::GetGeometryType</a></div><div class="ttdeci">Geometry::Type GetGeometryType() const</div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00052">element.hpp:52</a></div></div>
<div class="ttc" id="classmfem_1_1STable3D_html"><div class="ttname"><a href="classmfem_1_1STable3D.html">mfem::STable3D</a></div><div class="ttdoc">Symmetric 3D Table stored as an array of rows each of which has a stack of column, floor, number nodes. The number of the node is assigned by counting the nodes from zero as they are pushed into the table. Diagonals of any kind are not allowed so the row, column and floor must all be different for each node. Only one node is stored for all 6 symmetric entries that are indexable by unique triplets of row, column, and floor. </div><div class="ttdef"><b>Definition:</b> <a href="stable3d_8hpp_source.html#l00034">stable3d.hpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a73c3e95a702f98e015ce3cfd944c2e05"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a73c3e95a702f98e015ce3cfd944c2e05">mfem::FaceElementTransformations::SetGeometryType</a></div><div class="ttdeci">void SetGeometryType(Geometry::Type g)</div><div class="ttdoc">Method to set the geometry type of the face. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00536">eltrans.hpp:536</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_af3fceede11e97464def19cc712c81d69"><div class="ttname"><a href="classmfem_1_1ParMesh.html#af3fceede11e97464def19cc712c81d69">mfem::ParMesh::GetBoundingBox</a></div><div class="ttdeci">void GetBoundingBox(Vector &amp;p_min, Vector &amp;p_max, int ref=2)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06159">pmesh.cpp:6159</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4c234990eb6bba0fa4a9772bb4797116"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4c234990eb6bba0fa4a9772bb4797116">mfem::Mesh::GetVertices</a></div><div class="ttdeci">void GetVertices(Vector &amp;vert_coord) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l07878">mesh.cpp:7878</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae86d604004fdde2ac62d7ad82cdb11b8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae86d604004fdde2ac62d7ad82cdb11b8">mfem::NCMesh::GetDerefinementTable</a></div><div class="ttdeci">const Table &amp; GetDerefinementTable()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01937">ncmesh.cpp:1937</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_ae2fb5ee4728cb19a548a37ff910da239"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">mfem::CoarseFineTransformations::point_matrices</a></div><div class="ttdeci">DenseTensor point_matrices[Geometry::NumGeom]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00077">ncmesh.hpp:77</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a177fbce83f261359a029d1bd8768aadb"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a177fbce83f261359a029d1bd8768aadb">mfem::ParMesh::shared_edges</a></div><div class="ttdeci">Array&lt; Element * &gt; shared_edges</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00061">pmesh.hpp:61</a></div></div>
<div class="ttc" id="namespacemfem_html"><div class="ttname"><a href="namespacemfem.html">mfem</a></div><div class="ttdef"><b>Definition:</b> <a href="CodeDocumentation_8dox_source.html#l00001">CodeDocumentation.dox:1</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_afb720c1a8d716f98e6ed23e6822b2b13"><div class="ttname"><a href="classmfem_1_1Mesh.html#afb720c1a8d716f98e6ed23e6822b2b13">mfem::Mesh::SetAttributes</a></div><div class="ttdeci">virtual void SetAttributes()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01564">mesh.cpp:1564</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a89b4efb149e79a30a8dd194279154dd6"><div class="ttname"><a href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">mfem::Array::Append</a></div><div class="ttdeci">int Append(const T &amp;el)</div><div class="ttdoc">Append element &amp;#39;el&amp;#39; to array, resize if necessary. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00756">array.hpp:756</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aa454ecf91aa0a17ec48e01610d85988a"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aa454ecf91aa0a17ec48e01610d85988a">mfem::ParMesh::Destroy</a></div><div class="ttdeci">void Destroy()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06717">pmesh.cpp:6717</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a5a44f6dac69c8a2a4c99dbd14a7eb076"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a5a44f6dac69c8a2a4c99dbd14a7eb076">mfem::FiniteElementSpace::FEColl</a></div><div class="ttdeci">const FiniteElementCollection * FEColl() const</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00601">fespace.hpp:601</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a58930273cc132a70cfc9ae53c51dcc57"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a58930273cc132a70cfc9ae53c51dcc57">mfem::FaceElementTransformations::Loc1</a></div><div class="ttdeci">IntegrationPointTransformation Loc1</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00524">eltrans.hpp:524</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a733476790603d8d4cbafc238fcc4d215"><div class="ttname"><a href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">mfem::Table::Clear</a></div><div class="ttdeci">void Clear()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00380">table.cpp:380</a></div></div>
<div class="ttc" id="namespacemfem_html_abd1b6105cb4110752ec41c956c18d198"><div class="ttname"><a href="namespacemfem.html#abd1b6105cb4110752ec41c956c18d198">mfem::mfem_error</a></div><div class="ttdeci">void mfem_error(const char *msg)</div><div class="ttdoc">Function called when an error is encountered. Used by the macros MFEM_ABORT, MFEM_ASSERT, MFEM_VERIFY. </div><div class="ttdef"><b>Definition:</b> <a href="error_8cpp_source.html#l00154">error.cpp:154</a></div></div>
<div class="ttc" id="namespacemfem_html_a75d80737c9ab9a6c0b9a53ee1f358457"><div class="ttname"><a href="namespacemfem.html#a75d80737c9ab9a6c0b9a53ee1f358457">mfem::to_padded_string</a></div><div class="ttdeci">std::string to_padded_string(int i, int digits)</div><div class="ttdoc">Convert an integer to a 0-padded string with the given number of digits. </div><div class="ttdef"><b>Definition:</b> <a href="text_8hpp_source.html#l00054">text.hpp:54</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a9e07cfa2170e12ef7881376658291b40"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a9e07cfa2170e12ef7881376658291b40">mfem::ParMesh::BuildSharedEdgeElems</a></div><div class="ttdeci">void BuildSharedEdgeElems(int nedges, Mesh &amp;mesh, const Array&lt; int &gt; &amp;vert_global_local, const Table *edge_element)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00797">pmesh.cpp:797</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00042">lissajous.cpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1GroupCommunicator_html_ae49365321f5af65337d7fe5c2b69c19d"><div class="ttname"><a href="classmfem_1_1GroupCommunicator.html#ae49365321f5af65337d7fe5c2b69c19d">mfem::GroupCommunicator::Finalize</a></div><div class="ttdeci">void Finalize()</div><div class="ttdoc">Allocate internal buffers after the GroupLDofTable is defined. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00381">communication.cpp:381</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a92591d67739bde9d944e7119be94977b"><div class="ttname"><a href="classmfem_1_1Mesh.html#a92591d67739bde9d944e7119be94977b">mfem::Mesh::GetFaceTransformation</a></div><div class="ttdeci">void GetFaceTransformation(int i, IsoparametricTransformation *FTr)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00497">mesh.cpp:497</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_a945a5eda543ab04aa8cf38b5caeaf4f0"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#a945a5eda543ab04aa8cf38b5caeaf4f0">mfem::ElementTransformation::ElementNo</a></div><div class="ttdeci">int ElementNo</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00078">eltrans.hpp:78</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_aa5b75211f5053327b6899f8ab4e3423b"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#aa5b75211f5053327b6899f8ab4e3423b">mfem::ParNCMesh::Prune</a></div><div class="ttdeci">void Prune()</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01212">pncmesh.cpp:1212</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html"><div class="ttname"><a href="classmfem_1_1Array.html">mfem::Array&lt; bool &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_affa2425b183402615573eeda05804a7c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#affa2425b183402615573eeda05804a7c">mfem::ParMesh::GroupNVertices</a></div><div class="ttdeci">int GroupNVertices(int group) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00395">pmesh.hpp:395</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a352923d1f1f80504d6b5c31177b56d57"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a352923d1f1f80504d6b5c31177b56d57">mfem::ParMesh::GetFaceElementTransformations</a></div><div class="ttdeci">FaceElementTransformations * GetFaceElementTransformations(int FaceNo, int mask=31) override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03064">pmesh.cpp:3064</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a50284df93cf34724844aa01e8249724d"><div class="ttname"><a href="classmfem_1_1Geometry.html#a50284df93cf34724844aa01e8249724d">mfem::Geometry::NumVerts</a></div><div class="ttdeci">static const int NumVerts[NumGeom]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00049">geom.hpp:49</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a331895349cfbc3e40e595249c7741a08"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a331895349cfbc3e40e595249c7741a08">mfem::ParMesh::GroupVertex</a></div><div class="ttdeci">int GroupVertex(int group, int i) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00400">pmesh.hpp:400</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a56670b7e34dd8ed02029799ee21619b7"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a56670b7e34dd8ed02029799ee21619b7">mfem::Element::HEXAHEDRON</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00042">element.hpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a85ceb86ba1a12bf26a614ea92e4abe2c"><div class="ttname"><a href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">mfem::Table::AddConnection</a></div><div class="ttdeci">void AddConnection(int r, int c)</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00080">table.hpp:80</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a81e17bd07601b5f66821dbe21ba3652c"><div class="ttname"><a href="classmfem_1_1Mesh.html#a81e17bd07601b5f66821dbe21ba3652c">mfem::Mesh::GetElementToFaceTable</a></div><div class="ttdeci">STable3D * GetElementToFaceTable(int ret_ftbl=0)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06839">mesh.cpp:6839</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae6f90bec4d091ae5adc160fb74d89ca1"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae6f90bec4d091ae5adc160fb74d89ca1">mfem::ParMesh::GetSharedFaceTransformations</a></div><div class="ttdeci">FaceElementTransformations * GetSharedFaceTransformations(int sf, bool fill2=true)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03080">pmesh.cpp:3080</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a5d7ebc8a3e064693b92172b81c30f89c"><div class="ttname"><a href="classmfem_1_1Array.html#a5d7ebc8a3e064693b92172b81c30f89c">mfem::Array::LoseData</a></div><div class="ttdeci">void LoseData()</div><div class="ttdoc">NULL-ifies the data. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00135">array.hpp:135</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_ae5ce116fc288a679459e369af376e435"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#ae5ce116fc288a679459e369af376e435">mfem::ElementTransformation::Reset</a></div><div class="ttdeci">void Reset()</div><div class="ttdoc">Force the reevaluation of the Jacobian in the next call. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00089">eltrans.hpp:89</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2241de10a34775973f8d6a11e58121e7"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2241de10a34775973f8d6a11e58121e7">mfem::Mesh::Conforming</a></div><div class="ttdeci">bool Conforming() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01728">mesh.hpp:1728</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aa975b59a75949fd629c3c92d0c1e5ad6"><div class="ttname"><a href="classmfem_1_1Mesh.html#aa975b59a75949fd629c3c92d0c1e5ad6">mfem::Mesh::GetEdgeVertices</a></div><div class="ttdeci">void GetEdgeVertices(int i, Array&lt; int &gt; &amp;vert) const</div><div class="ttdoc">Returns the indices of the vertices of edge i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06029">mesh.cpp:6029</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a894a8464eb263bbd5c99ad177cfc7185"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a894a8464eb263bbd5c99ad177cfc7185">mfem::ParMesh::send_face_nbr_vertices</a></div><div class="ttdeci">Table send_face_nbr_vertices</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00386">pmesh.hpp:386</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78">mfem::Element::Type</a></div><div class="ttdeci">Type</div><div class="ttdoc">Constants for the classes derived from Element. </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae09102d1f21b0661eaf2fc365dc39182"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae09102d1f21b0661eaf2fc365dc39182">mfem::ParMesh::GetNGroups</a></div><div class="ttdeci">int GetNGroups() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00392">pmesh.hpp:392</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a332fc3ffe680e3548a61848774b427f0"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a332fc3ffe680e3548a61848774b427f0">mfem::FaceElementTransformations::Elem2No</a></div><div class="ttdeci">int Elem2No</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00520">eltrans.hpp:520</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1FaceInfo_html"><div class="ttname"><a href="structmfem_1_1Mesh_1_1FaceInfo.html">mfem::Mesh::FaceInfo</a></div><div class="ttdoc">This structure stores the low level information necessary to interpret the configuration of elements ...</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00153">mesh.hpp:153</a></div></div>
<div class="ttc" id="mesh__headers_8hpp_html"><div class="ttname"><a href="mesh__headers_8hpp.html">mesh_headers.hpp</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aeefcdb017ae9e14993d3e4ba21dd56e4"><div class="ttname"><a href="classmfem_1_1Mesh.html#aeefcdb017ae9e14993d3e4ba21dd56e4">mfem::Mesh::GetVertex</a></div><div class="ttdeci">const double * GetVertex(int i) const</div><div class="ttdoc">Return pointer to vertex i&amp;#39;s coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01053">mesh.hpp:1053</a></div></div>
<div class="ttc" id="namespacemfem_html_aa1cc5701e3e695b09a013e7f6301a850"><div class="ttname"><a href="namespacemfem.html#aa1cc5701e3e695b09a013e7f6301a850">mfem::VTKFormat</a></div><div class="ttdeci">VTKFormat</div><div class="ttdoc">Data array format for VTK and VTU files. </div><div class="ttdef"><b>Definition:</b> <a href="vtk_8hpp_source.html#l00096">vtk.hpp:96</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementCollection_html_a0f812fed1793858e59a16a8a3fd8b42c"><div class="ttname"><a href="classmfem_1_1FiniteElementCollection.html#a0f812fed1793858e59a16a8a3fd8b42c">mfem::FiniteElementCollection::Name</a></div><div class="ttdeci">virtual const char * Name() const</div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00073">fe_coll.hpp:73</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a5714678e316d2eb8fb75eacf5ef09eda"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a5714678e316d2eb8fb75eacf5ef09eda">mfem::ParMesh::GetGlobalVertexIndices</a></div><div class="ttdeci">void GetGlobalVertexIndices(Array&lt; HYPRE_BigInt &gt; &amp;gi) const</div><div class="ttdoc">AMR meshes are not supported. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06595">pmesh.cpp:6595</a></div></div>
<div class="ttc" id="classmfem_1_1ListOfIntegerSets_html_a451e3ff20e8173bea1996c6cac58fc2b"><div class="ttname"><a href="classmfem_1_1ListOfIntegerSets.html#a451e3ff20e8173bea1996c6cac58fc2b">mfem::ListOfIntegerSets::Insert</a></div><div class="ttdeci">int Insert(IntegerSet &amp;s)</div><div class="ttdoc">Check to see if set &amp;#39;s&amp;#39; is in the list. If not append it to the end of the list. Returns the index of...</div><div class="ttdef"><b>Definition:</b> <a href="sets_8cpp_source.html#l00091">sets.cpp:91</a></div></div>
<div class="ttc" id="classmfem_1_1H1__FECollection_html_a4fc311c31acc9adcb5bda81c25b7f115"><div class="ttname"><a href="classmfem_1_1H1__FECollection.html#a4fc311c31acc9adcb5bda81c25b7f115">mfem::H1_FECollection::DofForGeometry</a></div><div class="ttdeci">virtual int DofForGeometry(Geometry::Type GeomType) const</div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00268">fe_coll.hpp:268</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a517f198ce22ea84654640e65c940d5e2"><div class="ttname"><a href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">mfem::Array::Reserve</a></div><div class="ttdeci">void Reserve(int capacity)</div><div class="ttdoc">Ensures that the allocated size is at least the given size. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00159">array.hpp:159</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a0c09b68b568c0b2c5893667af56a070c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a0c09b68b568c0b2c5893667af56a070c">mfem::ParMesh::PrintVTU</a></div><div class="ttdeci">void PrintVTU(std::string pathname, VTKFormat format=VTKFormat::ASCII, bool high_order_output=false, int compression_level=0, bool bdr=false) override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06392">pmesh.cpp:6392</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2a373eb2c566226e38bf9804b76d003a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2a373eb2c566226e38bf9804b76d003a">mfem::Mesh::GetElementVertices</a></div><div class="ttdeci">void GetElementVertices(int i, Array&lt; int &gt; &amp;v) const</div><div class="ttdoc">Returns the indices of the vertices of element i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01148">mesh.hpp:1148</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_abf6535dc3e248ed140783593bc802e85"><div class="ttname"><a href="classmfem_1_1ParMesh.html#abf6535dc3e248ed140783593bc802e85">mfem::ParMesh::GetNFaceNeighbors</a></div><div class="ttdeci">int GetNFaceNeighbors() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00462">pmesh.hpp:462</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a7b0ebfbab71ebba875e7b45223899167"><div class="ttname"><a href="classmfem_1_1Mesh.html#a7b0ebfbab71ebba875e7b45223899167">mfem::Mesh::AddElement</a></div><div class="ttdeci">int AddElement(Element *elem)</div><div class="ttdoc">The parameter elem should be allocated using the NewElement() method. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01821">mesh.cpp:1821</a></div></div>
<div class="ttc" id="classmfem_1_1DataCollection_html_a355e314f04127529240e0f540dd6543d"><div class="ttname"><a href="classmfem_1_1DataCollection.html#a355e314f04127529240e0f540dd6543d">mfem::DataCollection::create_directory</a></div><div class="ttdeci">static int create_directory(const std::string &amp;dir_name, const Mesh *mesh, int myid)</div><div class="ttdef"><b>Definition:</b> <a href="datacollection_8cpp_source.html#l00034">datacollection.cpp:34</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_a80848ad38edd381b91b7d40e583d1c03"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">mfem::CoarseFineTransformations::embeddings</a></div><div class="ttdeci">Array&lt; Embedding &gt; embeddings</div><div class="ttdoc">Fine element positions in their parents. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00073">ncmesh.hpp:73</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_adb1cdcf96ef7afb4938b1831d638df47"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#adb1cdcf96ef7afb4938b1831d638df47">mfem::GroupTopology::GetGroup</a></div><div class="ttdeci">const int * GetGroup(int g) const</div><div class="ttdoc">Return a pointer to a list of neighbors for a given group. Neighbor 0 is the local processor...</div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00182">communication.hpp:182</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4f62eb3ede00bc8dc5de42baa366cab4"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4f62eb3ede00bc8dc5de42baa366cab4">mfem::Mesh::GetElementToEdgeTable</a></div><div class="ttdeci">int GetElementToEdgeTable(Table &amp;, Array&lt; int &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06397">mesh.cpp:6397</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a03a783300d766ab20ec48fb23ef92b62"><div class="ttname"><a href="classmfem_1_1Element.html#a03a783300d766ab20ec48fb23ef92b62">mfem::Element::GetNFaces</a></div><div class="ttdeci">virtual MFEM_DEPRECATED int GetNFaces(int &amp;nFaceVertices) const =0</div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_adbdecc1f97835142cdf9dbb52743d083"><div class="ttname"><a href="classmfem_1_1NCMesh.html#adbdecc1f97835142cdf9dbb52743d083">mfem::NCMesh::MarkCoarseLevel</a></div><div class="ttdeci">void MarkCoarseLevel()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04516">ncmesh.cpp:4516</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab29031fb80d570dc4d7847a14cf78f91"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab29031fb80d570dc4d7847a14cf78f91">mfem::Mesh::ResetLazyData</a></div><div class="ttdeci">void ResetLazyData()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01553">mesh.cpp:1553</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_af17b21e655aa7edd97dec4c93fa19ec3aaaa97da9eb1848fb638687a9635fab78"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#af17b21e655aa7edd97dec4c93fa19ec3aaaa97da9eb1848fb638687a9635fab78">mfem::ElementTransformation::ELEMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00071">eltrans.hpp:71</a></div></div>
<div class="ttc" id="classmfem_1_1RefinedGeometry_html_ad91b1235663c3b114515b2143e734322"><div class="ttname"><a href="classmfem_1_1RefinedGeometry.html#ad91b1235663c3b114515b2143e734322">mfem::RefinedGeometry::NumBdrEdges</a></div><div class="ttdeci">int NumBdrEdges</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00316">geom.hpp:316</a></div></div>
<div class="ttc" id="classmfem_1_1RefinedGeometry_html_a06d15a8bc8081d6b5e120057e485129f"><div class="ttname"><a href="classmfem_1_1RefinedGeometry.html#a06d15a8bc8081d6b5e120057e485129f">mfem::RefinedGeometry::RefPts</a></div><div class="ttdeci">IntegrationRule RefPts</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00314">geom.hpp:314</a></div></div>
<div class="ttc" id="classmfem_1_1DSTable_1_1RowIterator_html"><div class="ttname"><a href="classmfem_1_1DSTable_1_1RowIterator.html">mfem::DSTable::RowIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00273">table.hpp:273</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a522b34210abfe52cd71134231aeb4ca2"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a522b34210abfe52cd71134231aeb4ca2">mfem::ParMesh::GetSharedEdgeCommunicator</a></div><div class="ttdeci">void GetSharedEdgeCommunicator(int ordering, GroupCommunicator &amp;sedge_comm) const</div><div class="ttdoc">Get the shared edges GroupCommunicator. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01637">pmesh.cpp:1637</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a55dc871ae5eba6b843538b8df1b0af4c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a55dc871ae5eba6b843538b8df1b0af4c">mfem::ParMesh::GetNFbyType</a></div><div class="ttdeci">int GetNFbyType(FaceType type) const override</div><div class="ttdoc">Returns the number of local faces according to the requested type, does not count master non-conformi...</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03237">pmesh.cpp:3237</a></div></div>
<div class="ttc" id="classmfem_1_1GeometryRefiner_html_a02322fb06b6129c5d2170fff4de16155"><div class="ttname"><a href="classmfem_1_1GeometryRefiner.html#a02322fb06b6129c5d2170fff4de16155">mfem::GeometryRefiner::Refine</a></div><div class="ttdeci">RefinedGeometry * Refine(Geometry::Type Geom, int Times, int ETimes=1)</div><div class="ttdef"><b>Definition:</b> <a href="geom_8cpp_source.html#l01099">geom.cpp:1099</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a90aab9f1f50ab61c9cf98825481ed9ae"><div class="ttname"><a href="classmfem_1_1Mesh.html#a90aab9f1f50ab61c9cf98825481ed9ae">mfem::Mesh::GetLocalFaceTransformation</a></div><div class="ttdeci">void GetLocalFaceTransformation(int face_type, int elem_type, IsoparametricTransformation &amp;Transf, int info)</div><div class="ttdoc">A helper method that constructs a transformation from the reference space of a face to the reference ...</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00896">mesh.cpp:896</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a098afe9ba26ede737a9745ddf996413f"><div class="ttname"><a href="classmfem_1_1Mesh.html#a098afe9ba26ede737a9745ddf996413f">mfem::Mesh::Transformation2</a></div><div class="ttdeci">IsoparametricTransformation Transformation2</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00234">mesh.hpp:234</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a0dbc8b6089ccfdd3d8567366e8278f4e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a0dbc8b6089ccfdd3d8567366e8278f4e">mfem::ParMesh::face_nbr_el_to_face</a></div><div class="ttdeci">Table * face_nbr_el_to_face</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00080">pmesh.hpp:80</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_a091a1d069e2d47887ed5f3874a83f016"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#a091a1d069e2d47887ed5f3874a83f016">mfem::ParFiniteElementSpace::GetSharedTriangleDofs</a></div><div class="ttdeci">void GetSharedTriangleDofs(int group, int fi, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l00607">pfespace.cpp:607</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_abf310dd4bd2b603cf1c1c6c1006ded0b"><div class="ttname"><a href="classmfem_1_1Mesh.html#abf310dd4bd2b603cf1c1c6c1006ded0b">mfem::Mesh::SetNodalFESpace</a></div><div class="ttdeci">virtual void SetNodalFESpace(FiniteElementSpace *nfes)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05298">mesh.cpp:5298</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_ac07dc3502dcfd13cb325c98349b5e319"><div class="ttname"><a href="classmfem_1_1GridFunction.html#ac07dc3502dcfd13cb325c98349b5e319">mfem::GridFunction::OwnFEC</a></div><div class="ttdeci">FiniteElementCollection * OwnFEC()</div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8hpp_source.html#l00124">gridfunc.hpp:124</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a85c4ec2abbe32b3e45ceeb115d3eb878"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a85c4ec2abbe32b3e45ceeb115d3eb878">mfem::ParMesh::ReduceInt</a></div><div class="ttdeci">long long ReduceInt(int value) const override</div><div class="ttdoc">Utility function: sum integers from all processors (Allreduce). </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06302">pmesh.cpp:6302</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_aed2615302e7e8a1111b268a4dea20027"><div class="ttname"><a href="classmfem_1_1GridFunction.html#aed2615302e7e8a1111b268a4dea20027">mfem::GridFunction::FESpace</a></div><div class="ttdeci">FiniteElementSpace * FESpace()</div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8hpp_source.html#l00683">gridfunc.hpp:683</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a7abe3ef4a3460c255caa9e00eeb78038"><div class="ttname"><a href="classmfem_1_1Table.html#a7abe3ef4a3460c255caa9e00eeb78038">mfem::Table::GetRow</a></div><div class="ttdeci">void GetRow(int i, Array&lt; int &gt; &amp;row) const</div><div class="ttdoc">Return row i in array row (the Table must be finalized) </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00187">table.cpp:187</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a20a3b05ceaa493bb3d7ec76d282372c8"><div class="ttname"><a href="classmfem_1_1Mesh.html#a20a3b05ceaa493bb3d7ec76d282372c8">mfem::Mesh::NumOfBdrElements</a></div><div class="ttdeci">int NumOfBdrElements</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00069">mesh.hpp:69</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a7c806ae04b773836db7c9493b0d4b6e5"><div class="ttname"><a href="classmfem_1_1Mesh.html#a7c806ae04b773836db7c9493b0d4b6e5">mfem::Mesh::el_to_edge</a></div><div class="ttdeci">Table * el_to_edge</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00220">mesh.hpp:220</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aaf48f81c10f73c0f748c7e55d54d68b1"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aaf48f81c10f73c0f748c7e55d54d68b1">mfem::ParMesh::GetSharedFace</a></div><div class="ttdeci">int GetSharedFace(int sface) const</div><div class="ttdoc">Return the local face index for the given shared face. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03215">pmesh.cpp:3215</a></div></div>
<div class="ttc" id="classmfem_1_1ListOfIntegerSets_html_a3057a37fc73a5a91d44b657265da1b85"><div class="ttname"><a href="classmfem_1_1ListOfIntegerSets.html#a3057a37fc73a5a91d44b657265da1b85">mfem::ListOfIntegerSets::Size</a></div><div class="ttdeci">int Size()</div><div class="ttdoc">Return the number of integer sets in the list. </div><div class="ttdef"><b>Definition:</b> <a href="sets_8hpp_source.html#l00070">sets.hpp:70</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a5af643a8b550ef249d39f2c7452e3b87"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a5af643a8b550ef249d39f2c7452e3b87">mfem::ParMesh::GetFaceNbrElementToFaceTable</a></div><div class="ttdeci">STable3D * GetFaceNbrElementToFaceTable(int ret_ftbl=0)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02724">pmesh.cpp:2724</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a40adebb484c5074bb9d6c5ea71a21432"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a40adebb484c5074bb9d6c5ea71a21432">mfem::ParMesh::GetGlobalElementIndices</a></div><div class="ttdeci">void GetGlobalElementIndices(Array&lt; HYPRE_BigInt &gt; &amp;gi) const</div><div class="ttdoc">AMR meshes are supported. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06662">pmesh.cpp:6662</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">mfem::Geometry::TRIANGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00038">geom.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a1661656f04d406d94de8b751a2ef93b5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a1661656f04d406d94de8b751a2ef93b5">mfem::ParMesh::GetComm</a></div><div class="ttdeci">MPI_Comm GetComm() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00351">pmesh.hpp:351</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a93e115d0979d44b86b43bfa1a72509e3"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a93e115d0979d44b86b43bfa1a72509e3">mfem::ParMesh::shared_quads</a></div><div class="ttdeci">Array&lt; Vert4 &gt; shared_quads</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00066">pmesh.hpp:66</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a8881cbed07da54396b41b87b0bb50810"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a8881cbed07da54396b41b87b0bb50810">mfem::ParNCMesh::Rebalance</a></div><div class="ttdeci">void Rebalance(const Array&lt; int &gt; *custom_partition=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01683">pncmesh.cpp:1683</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aae348d99498be7174b05eebebf31a68b"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aae348d99498be7174b05eebebf31a68b">mfem::ParMesh::GroupNTriangles</a></div><div class="ttdeci">int GroupNTriangles(int group) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00397">pmesh.hpp:397</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Master_html_ac76bd3a2e6a22693fd5f8deea4af55be"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Master.html#ac76bd3a2e6a22693fd5f8deea4af55be">mfem::NCMesh::Master::slaves_end</a></div><div class="ttdeci">int slaves_end</div><div class="ttdoc">slave faces </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00205">ncmesh.hpp:205</a></div></div>
<div class="ttc" id="classmfem_1_1Tetrahedron_html"><div class="ttname"><a href="classmfem_1_1Tetrahedron.html">mfem::Tetrahedron</a></div><div class="ttdoc">Data type tetrahedron element. </div><div class="ttdef"><b>Definition:</b> <a href="tetrahedron_8hpp_source.html#l00022">tetrahedron.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html_aee4a1c4326df943c398b401cd58ea3eb"><div class="ttname"><a href="classmfem_1_1Vector.html#aee4a1c4326df943c398b401cd58ea3eb">mfem::Vector::GetData</a></div><div class="ttdeci">double * GetData() const</div><div class="ttdoc">Return a pointer to the beginning of the Vector data. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00208">vector.hpp:208</a></div></div>
<div class="ttc" id="classmfem_1_1RT__FECollection_html"><div class="ttname"><a href="classmfem_1_1RT__FECollection.html">mfem::RT_FECollection</a></div><div class="ttdoc">Arbitrary order H(div)-conforming Raviart-Thomas finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00373">fe_coll.hpp:373</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a16746032783bd96c382cde0bc82f2337"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a16746032783bd96c382cde0bc82f2337">mfem::ParMesh::PrintXG</a></div><div class="ttdeci">void PrintXG(std::ostream &amp;out=mfem::out) const override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04624">pmesh.cpp:4624</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a4d6d51a8d57b7ebcf15de350761c5bf8acce41fac6399beaef5bb4dfe8de2f6d1"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8acce41fac6399beaef5bb4dfe8de2f6d1">mfem::FaceElementTransformations::HAVE_LOC1</a></div><div class="ttdoc">Point transformation for side 1 is configured. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00515">eltrans.hpp:515</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_ad27a4b8249411b018f03b3319bed9276"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#ad27a4b8249411b018f03b3319bed9276">mfem::FiniteElementSpace::GetVDim</a></div><div class="ttdeci">int GetVDim() const</div><div class="ttdoc">Returns vector dimension. </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00581">fespace.hpp:581</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_abbe5721f5b01fb4c1f174ee9e2662d25"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#abbe5721f5b01fb4c1f174ee9e2662d25">mfem::ParFiniteElementSpace::GetElementDofs</a></div><div class="ttdeci">virtual DofTransformation * GetElementDofs(int i, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdoc">Returns indexes of degrees of freedom in array dofs for i&amp;#39;th element. </div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l00471">pfespace.cpp:471</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aaa33469fa64e79c6b517951ad0dbb76c"><div class="ttname"><a href="classmfem_1_1Mesh.html#aaa33469fa64e79c6b517951ad0dbb76c">mfem::Mesh::PrintVTU</a></div><div class="ttdeci">void PrintVTU(std::ostream &amp;os, int ref=1, VTKFormat format=VTKFormat::ASCII, bool high_order_output=false, int compression_level=0, bool bdr_elements=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l10565">mesh.cpp:10565</a></div></div>
<div class="ttc" id="classmfem_1_1ParGridFunction_html_aca823c26fcbef5a0d54e21065f4c996f"><div class="ttname"><a href="classmfem_1_1ParGridFunction.html#aca823c26fcbef5a0d54e21065f4c996f">mfem::ParGridFunction::FaceNbrData</a></div><div class="ttdeci">Vector &amp; FaceNbrData()</div><div class="ttdef"><b>Definition:</b> <a href="pgridfunc_8hpp_source.html#l00208">pgridfunc.hpp:208</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a6ac2fad2ec742d60cb17dc8d873b46aa"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a6ac2fad2ec742d60cb17dc8d873b46aa">mfem::FiniteElementSpace::GetElementVDofs</a></div><div class="ttdeci">DofTransformation * GetElementVDofs(int i, Array&lt; int &gt; &amp;vdofs) const</div><div class="ttdoc">Returns indexes of degrees of freedom in array dofs for i&amp;#39;th element. </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l00281">fespace.cpp:281</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aabadf9380fee10dfa4b01211c5cafc90"><div class="ttname"><a href="classmfem_1_1Mesh.html#aabadf9380fee10dfa4b01211c5cafc90">mfem::Mesh::CheckBdrElementOrientation</a></div><div class="ttdeci">int CheckBdrElementOrientation(bool fix_it=true)</div><div class="ttdoc">Check the orientation of the boundary elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05810">mesh.cpp:5810</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a7c4a30d0a7fb9070a8f5463dbf7479d2"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a7c4a30d0a7fb9070a8f5463dbf7479d2">mfem::ParMesh::face_nbr_el_ori</a></div><div class="ttdeci">Table face_nbr_el_ori</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00081">pmesh.hpp:81</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a1797afa9ee0af1d3145cbc395357f57c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a1797afa9ee0af1d3145cbc395357f57c">mfem::ParMesh::GetMyRank</a></div><div class="ttdeci">int GetMyRank() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00353">pmesh.hpp:353</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_a6873da85b99606ee8621635f388034cf"><div class="ttname"><a href="classmfem_1_1GridFunction.html#a6873da85b99606ee8621635f388034cf">mfem::GridFunction::GetElementDofValues</a></div><div class="ttdeci">virtual void GetElementDofValues(int el, Vector &amp;dof_vals) const</div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8cpp_source.html#l01841">gridfunc.cpp:1841</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_a2e77fef828e37ad31f0c9aa3ffe503cc"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#a2e77fef828e37ad31f0c9aa3ffe503cc">mfem::ParFiniteElementSpace::GetFaceDofs</a></div><div class="ttdeci">virtual int GetFaceDofs(int i, Array&lt; int &gt; &amp;dofs, int variant=0) const</div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l00519">pfespace.cpp:519</a></div></div>
<div class="ttc" id="namespacemfem_html_a005eac4b7840fa2691b6e57be1546d14"><div class="ttname"><a href="namespacemfem.html#a005eac4b7840fa2691b6e57be1546d14">mfem::Swap</a></div><div class="ttdeci">void Swap(Array&lt; T &gt; &amp;, Array&lt; T &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00635">array.hpp:635</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a16254ab9e08be6fa84e8b12cb551271a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a16254ab9e08be6fa84e8b12cb551271a">mfem::Mesh::bdr_attributes</a></div><div class="ttdeci">Array&lt; int &gt; bdr_attributes</div><div class="ttdoc">A list of all unique boundary attributes used by the Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00275">mesh.hpp:275</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a221bf58bfe1baf89f6384e3b7c14f861"><div class="ttname"><a href="classmfem_1_1Mesh.html#a221bf58bfe1baf89f6384e3b7c14f861">mfem::Mesh::ElementToEdgeTable</a></div><div class="ttdeci">const Table &amp; ElementToEdgeTable() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06481">mesh.cpp:6481</a></div></div>
<div class="ttc" id="navier__mms_8cpp_html_aad69e558efc20c74b91561cc5721ca1a"><div class="ttname"><a href="navier__mms_8cpp.html#aad69e558efc20c74b91561cc5721ca1a">p</a></div><div class="ttdeci">double p(const Vector &amp;x, double t)</div><div class="ttdef"><b>Definition:</b> <a href="navier__mms_8cpp_source.html#l00053">navier_mms.cpp:53</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a475c2fa7963bb755b0f5b2f21e1761b2"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a475c2fa7963bb755b0f5b2f21e1761b2">mfem::ParMesh::FindSharedFaces</a></div><div class="ttdeci">void FindSharedFaces(const Mesh &amp;mesh, const int *partition, Array&lt; int &gt; &amp;face_group, ListOfIntegerSets &amp;groups)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00504">pmesh.cpp:504</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_aba74c90032cc9cf6621fe8a1bf3630b3"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#aba74c90032cc9cf6621fe8a1bf3630b3">mfem::FaceElementTransformations::SetConfigurationMask</a></div><div class="ttdeci">void SetConfigurationMask(int m)</div><div class="ttdoc">Set the mask indicating which portions of the object have been setup. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00507">eltrans.hpp:507</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a5c56c658bfeeed21914278e38cbb3a8f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a5c56c658bfeeed21914278e38cbb3a8f">mfem::ParMesh::LocalRefinement</a></div><div class="ttdeci">void LocalRefinement(const Array&lt; int &gt; &amp;marked_el, int type=3) override</div><div class="ttdoc">This function is not public anymore. Use GeneralRefinement instead. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03444">pmesh.cpp:3444</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a203856446d235b6f467592cc84336f3e"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a203856446d235b6f467592cc84336f3e">mfem::ParMesh::GetNSharedFaces</a></div><div class="ttdeci">int GetNSharedFaces() const</div><div class="ttdoc">Return the number of shared faces (3D), edges (2D), vertices (1D) </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03196">pmesh.cpp:3196</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a1a778ec440848d25becb69798b48e781"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a1a778ec440848d25becb69798b48e781">mfem::ParMesh::RefineGroups</a></div><div class="ttdeci">void RefineGroups(const DSTable &amp;v_to_v, int *middle)</div><div class="ttdoc">Update the groups after triangle refinement. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04106">pmesh.cpp:4106</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a97d6d380f8416ddbfb5187238a5a8f46"><div class="ttname"><a href="classmfem_1_1Table.html#a97d6d380f8416ddbfb5187238a5a8f46">mfem::Table::Finalize</a></div><div class="ttdeci">void Finalize()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00242">table.cpp:242</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a75cf5ab424326223e352175024a59e3d"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a75cf5ab424326223e352175024a59e3d">mfem::ParMesh::face_nbr_vertices</a></div><div class="ttdeci">Array&lt; Vertex &gt; face_nbr_vertices</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00383">pmesh.hpp:383</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html">mfem::FiniteElementSpace</a></div><div class="ttdoc">Class FiniteElementSpace - responsible for providing FEM view of the mesh, mainly managing the set of...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00096">fespace.hpp:96</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a8fcbc3ac9d7d9bb02743a26e14ac4a2b"><div class="ttname"><a href="classmfem_1_1Mesh.html#a8fcbc3ac9d7d9bb02743a26e14ac4a2b">mfem::Mesh::PrintElement</a></div><div class="ttdeci">static void PrintElement(const Element *, std::ostream &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l03920">mesh.cpp:3920</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_abed8173071d957c12e662e37129388e2"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#abed8173071d957c12e662e37129388e2">mfem::FaceElementTransformations::CheckConsistency</a></div><div class="ttdeci">double CheckConsistency(int print_level=0, std::ostream &amp;out=mfem::out)</div><div class="ttdoc">Check for self-consistency: compares the result of mapping the reference face vertices to physical co...</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8cpp_source.html#l00646">eltrans.cpp:646</a></div></div>
<div class="ttc" id="classmfem_1_1Tetrahedron_html_ab7a34aae369d61fd5e3e67c4f1cac706"><div class="ttname"><a href="classmfem_1_1Tetrahedron.html#ab7a34aae369d61fd5e3e67c4f1cac706">mfem::Tetrahedron::GetRefinementFlag</a></div><div class="ttdeci">int GetRefinementFlag()</div><div class="ttdef"><b>Definition:</b> <a href="tetrahedron_8hpp_source.html#l00066">tetrahedron.hpp:66</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementCollection_html"><div class="ttname"><a href="classmfem_1_1FiniteElementCollection.html">mfem::FiniteElementCollection</a></div><div class="ttdoc">Collection of finite elements from the same family in multiple dimensions. This class is used to matc...</div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00026">fe_coll.hpp:26</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a74b0da998b807440e7c39b983e28edee"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a74b0da998b807440e7c39b983e28edee">mfem::Element::PYRAMID</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00042">element.hpp:42</a></div></div>
<div class="ttc" id="namespacemfem_html_a4042207f77a0aedbf8d6fc9d125f6f24"><div class="ttname"><a href="namespacemfem.html#a4042207f77a0aedbf8d6fc9d125f6f24">mfem::out</a></div><div class="ttdeci">OutStream out(std::cout)</div><div class="ttdoc">Global stream used by the library for standard output. Initially it uses the same std::streambuf as s...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8hpp_source.html#l00066">globals.hpp:66</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a0ceb36799b7cfe46fb1c16c27c25d1ce"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a0ceb36799b7cfe46fb1c16c27c25d1ce">mfem::ParNCMesh::IsGhost</a></div><div class="ttdeci">bool IsGhost(int entity, int index) const</div><div class="ttdoc">Return true if the specified vertex/edge/face is a ghost. </div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8hpp_source.html#l00184">pncmesh.hpp:184</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_afa55bdf445b256c57888aa9203b2bc9a"><div class="ttname"><a href="classmfem_1_1ParMesh.html#afa55bdf445b256c57888aa9203b2bc9a">mfem::ParMesh::Swap</a></div><div class="ttdeci">void Swap(ParMesh &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06676">pmesh.cpp:6676</a></div></div>
<div class="ttc" id="classmfem_1_1ParGridFunction_html_ac3a24195a12d4b801a1aa1f7e8f0a89d"><div class="ttname"><a href="classmfem_1_1ParGridFunction.html#ac3a24195a12d4b801a1aa1f7e8f0a89d">mfem::ParGridFunction::ParFESpace</a></div><div class="ttdeci">ParFiniteElementSpace * ParFESpace() const</div><div class="ttdef"><b>Definition:</b> <a href="pgridfunc_8hpp_source.html#l00113">pgridfunc.hpp:113</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a5d5f2a1b3e88520e2063feac1ec006ab"><div class="ttname"><a href="classmfem_1_1Mesh.html#a5d5f2a1b3e88520e2063feac1ec006ab">mfem::Mesh::FinalizeTopology</a></div><div class="ttdeci">void FinalizeTopology(bool generate_bdr=true)</div><div class="ttdoc">Finalize the construction of the secondary topology (connectivity) data of a Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02902">mesh.cpp:2902</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_af3a5b8f3b38a9b95349a60809cae03cf"><div class="ttname"><a href="classmfem_1_1Table.html#af3a5b8f3b38a9b95349a60809cae03cf">mfem::Table::AddAColumnInRow</a></div><div class="ttdeci">void AddAColumnInRow(int r)</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00077">table.hpp:77</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aca13f93c81a0ef69c0aa9d0328c114b7"><div class="ttname"><a href="classmfem_1_1Mesh.html#aca13f93c81a0ef69c0aa9d0328c114b7">mfem::Mesh::GetNodes</a></div><div class="ttdeci">GridFunction * GetNodes()</div><div class="ttdoc">Return a pointer to the internal node GridFunction (may be NULL). </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01610">mesh.hpp:1610</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a566edbabee3d4f0d7ce15cbc638021ca"><div class="ttname"><a href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">mfem::Array::SetSize</a></div><div class="ttdeci">void SetSize(int nsize)</div><div class="ttdoc">Change the logical size of the array, keep existing entries. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00684">array.hpp:684</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a25bb6753ff4ba80b9bf70a94b8192857"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a25bb6753ff4ba80b9bf70a94b8192857">mfem::ParMesh::SaveAsOne</a></div><div class="ttdeci">void SaveAsOne(const char *fname, int precision=16) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l05618">pmesh.cpp:5618</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a631c7ee9a2c9667fbea11bfe15e3effc"><div class="ttname"><a href="classmfem_1_1Mesh.html#a631c7ee9a2c9667fbea11bfe15e3effc">mfem::Mesh::PrepareNodeReorder</a></div><div class="ttdeci">void PrepareNodeReorder(DSTable **old_v_to_v, Table **old_elem_vert)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02493">mesh.cpp:2493</a></div></div>
<div class="ttc" id="hypre__parcsr_8hpp_html_a891d15140bcc33b92ff03f02664c9022"><div class="ttname"><a href="hypre__parcsr_8hpp.html#a891d15140bcc33b92ff03f02664c9022">HYPRE_BigInt</a></div><div class="ttdeci">HYPRE_Int HYPRE_BigInt</div><div class="ttdef"><b>Definition:</b> <a href="hypre__parcsr_8hpp_source.html#l00028">hypre_parcsr.hpp:28</a></div></div>
<div class="ttc" id="namespacemfem_html_a49e8b6b6fbef900c91b7db4cd3f6e2b6"><div class="ttname"><a href="namespacemfem.html#a49e8b6b6fbef900c91b7db4cd3f6e2b6">mfem::Transpose</a></div><div class="ttdeci">void Transpose(const Table &amp;A, Table &amp;At, int ncols_A_)</div><div class="ttdoc">Transpose a Table. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00413">table.cpp:413</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a4dcf19882ccda139fb3cb45ac6cd2c82"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a4dcf19882ccda139fb3cb45ac6cd2c82">mfem::ParMesh::glob_elem_offset</a></div><div class="ttdeci">long long glob_elem_offset</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00086">pmesh.hpp:86</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationPointTransformation_html_ad52ff28eba3af4c60a7d56382ba72cc0"><div class="ttname"><a href="classmfem_1_1IntegrationPointTransformation.html#ad52ff28eba3af4c60a7d56382ba72cc0">mfem::IntegrationPointTransformation::Transform</a></div><div class="ttdeci">void Transform(const IntegrationPoint &amp;, IntegrationPoint &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8cpp_source.html#l00546">eltrans.cpp:546</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a9f6f985320fedca41dc014e35a5b2bf0"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a9f6f985320fedca41dc014e35a5b2bf0">mfem::FiniteElementSpace::GetEdgeDofs</a></div><div class="ttdeci">int GetEdgeDofs(int edge, Array&lt; int &gt; &amp;dofs, int variant=0) const</div><div class="ttdoc">Returns the indices of the degrees of freedom for the specified edge, including the DOFs for the vert...</div><div class="ttdef"><b>Definition:</b> <a href="fespace_8cpp_source.html#l02987">fespace.cpp:2987</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a004c7eff16b8b8a5e4a2a055dbe1eef2"><div class="ttname"><a href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">mfem::Mesh::vertices</a></div><div class="ttdeci">Array&lt; Vertex &gt; vertices</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00090">mesh.hpp:90</a></div></div>
<div class="ttc" id="classmfem_1_1STable3D_html_a6033441aea5f8f755d658736f8a36059"><div class="ttname"><a href="classmfem_1_1STable3D.html#a6033441aea5f8f755d658736f8a36059">mfem::STable3D::Push4</a></div><div class="ttdeci">int Push4(int r, int c, int f, int t)</div><div class="ttdoc">Check to see if this entry is in the table and add it to the table if it is not there. The entry is addressed by the three smallest values of (r,c,f,t). Returns the number assigned to the table entry. </div><div class="ttdef"><b>Definition:</b> <a href="stable3d_8cpp_source.html#l00140">stable3d.cpp:140</a></div></div>
<div class="ttc" id="namespacemfem_html_aa1cc5701e3e695b09a013e7f6301a850a88131bfe59ca59720a89255e8857db09"><div class="ttname"><a href="namespacemfem.html#aa1cc5701e3e695b09a013e7f6301a850a88131bfe59ca59720a89255e8857db09">mfem::VTKFormat::BINARY32</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a86662b7597025697ecc376394b7e4434"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a86662b7597025697ecc376394b7e4434">mfem::Element::WEDGE</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00042">element.hpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a39f2450e96b22aa272e07b0583f7b49b"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a39f2450e96b22aa272e07b0583f7b49b">mfem::ParMesh::GetFaceToAllElementTable</a></div><div class="ttdeci">Table * GetFaceToAllElementTable() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02974">pmesh.cpp:2974</a></div></div>
<div class="ttc" id="classmfem_1_1STable3D_html_a2959f9ad5fbfe874b375be6351799117"><div class="ttname"><a href="classmfem_1_1STable3D.html#a2959f9ad5fbfe874b375be6351799117">mfem::STable3D::Index</a></div><div class="ttdeci">int Index(int r, int c, int f) const</div><div class="ttdef"><b>Definition:</b> <a href="stable3d_8cpp_source.html#l00117">stable3d.cpp:117</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_af67880b1b972e03d96ae38624a625d71"><div class="ttname"><a href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">mfem::Array::DeleteLast</a></div><div class="ttdeci">void DeleteLast()</div><div class="ttdoc">Delete the last entry of the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00196">array.hpp:196</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a55ad4b875a6943bd34bf10774c7d1c82"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a55ad4b875a6943bd34bf10774c7d1c82">mfem::ParMesh::PrintAsOne</a></div><div class="ttdeci">void PrintAsOne(std::ostream &amp;out=mfem::out) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04983">pmesh.cpp:4983</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a345990e5e841a634dda2b62cbc994a42"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a345990e5e841a634dda2b62cbc994a42">mfem::ParMesh::WantSkipSharedMaster</a></div><div class="ttdeci">bool WantSkipSharedMaster(const NCMesh::Master &amp;master) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04826">pmesh.cpp:4826</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElement_html_af4408ffc73146fc6bf710bd95ddc682c"><div class="ttname"><a href="classmfem_1_1FiniteElement.html#af4408ffc73146fc6bf710bd95ddc682c">mfem::FiniteElement::GetDof</a></div><div class="ttdeci">int GetDof() const</div><div class="ttdoc">Returns the number of degrees of freedom in the finite element. </div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8hpp_source.html#l00322">fe_base.hpp:322</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a894c32c7197aa5864be115b6f3a3b967"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a894c32c7197aa5864be115b6f3a3b967">mfem::ParMesh::ParMesh</a></div><div class="ttdeci">ParMesh()</div><div class="ttdoc">Default constructor. Create an empty ParMesh. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00290">pmesh.hpp:290</a></div></div>
<div class="ttc" id="classmfem_1_1GroupCommunicator_html_a5a01c4355d94a68dc6623c50d1f8fc4b"><div class="ttname"><a href="classmfem_1_1GroupCommunicator.html#a5a01c4355d94a68dc6623c50d1f8fc4b">mfem::GroupCommunicator::GroupLDofTable</a></div><div class="ttdeci">Table &amp; GroupLDofTable()</div><div class="ttdoc">Fill-in the returned Table reference to initialize the GroupCommunicator then call Finalize()...</div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00244">communication.hpp:244</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af9007b5f05f3309bb84ec20d133eeea7"><div class="ttname"><a href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">mfem::Mesh::elements</a></div><div class="ttdeci">Array&lt; Element * &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00085">mesh.hpp:85</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a67c84c40d54bc94d5a304d112e392726"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a67c84c40d54bc94d5a304d112e392726">mfem::ParMesh::SetAttributes</a></div><div class="ttdeci">void SetAttributes() override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01580">pmesh.cpp:1580</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a7112fda7d2fa9debbaa06099b31ec911"><div class="ttname"><a href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">mfem::Table::ShiftUpI</a></div><div class="ttdeci">void ShiftUpI()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00115">table.cpp:115</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ab2cbd39c804f07e3af26c6795bc62264"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ab2cbd39c804f07e3af26c6795bc62264">mfem::ParMesh::GenerateOffsets</a></div><div class="ttdeci">void GenerateOffsets(int N, HYPRE_BigInt loc_sizes[], Array&lt; HYPRE_BigInt &gt; *offsets[]) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01933">pmesh.cpp:1933</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a8b7a6459b9c4ef0bada3ef9e00dcf082"><div class="ttname"><a href="classmfem_1_1Mesh.html#a8b7a6459b9c4ef0bada3ef9e00dcf082">mfem::Mesh::SpaceDimension</a></div><div class="ttdeci">int SpaceDimension() const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01048">mesh.hpp:1048</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a0559bdb18be81c4c725209520d60dcb1"><div class="ttname"><a href="classmfem_1_1Mesh.html#a0559bdb18be81c4c725209520d60dcb1">mfem::Mesh::meshgen</a></div><div class="ttdeci">int meshgen</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00077">mesh.hpp:77</a></div></div>
<div class="ttc" id="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1CUBE_01_4_html_a78982d92509f51af3eb559d11e87039f"><div class="ttname"><a href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1CUBE_01_4.html#a78982d92509f51af3eb559d11e87039f">mfem::Geometry::Constants&lt; Geometry::CUBE &gt;::FaceVert</a></div><div class="ttdeci">static const int FaceVert[NumFaces][MaxFaceVert]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00252">geom.hpp:252</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a0a10d8e32dc7d3d71ac6756fe4c14ca7"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a0a10d8e32dc7d3d71ac6756fe4c14ca7">mfem::ParMesh::BuildVertexGroup</a></div><div class="ttdeci">void BuildVertexGroup(int ngroups, const Table &amp;vert_element)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00694">pmesh.cpp:694</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementCollection_html_a15fcfa553d4949eb08f9926ac74d1e80"><div class="ttname"><a href="classmfem_1_1FiniteElementCollection.html#a15fcfa553d4949eb08f9926ac74d1e80">mfem::FiniteElementCollection::New</a></div><div class="ttdeci">static FiniteElementCollection * New(const char *name)</div><div class="ttdoc">Factory method: return a newly allocated FiniteElementCollection according to the given name...</div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8cpp_source.html#l00116">fe_coll.cpp:116</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a95c8bc6cc12e67bd8a952b6bb94a415b"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a95c8bc6cc12e67bd8a952b6bb94a415b">mfem::ParMesh::GetFaceNbrElementTransformation</a></div><div class="ttdeci">void GetFaceNbrElementTransformation(int i, IsoparametricTransformation *ElTr)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01976">pmesh.cpp:1976</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a641d7dd01d6982be04d7c8410e2eafe8"><div class="ttname"><a href="classmfem_1_1Mesh.html#a641d7dd01d6982be04d7c8410e2eafe8">mfem::Mesh::GetNE</a></div><div class="ttdeci">int GetNE() const</div><div class="ttdoc">Returns number of elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00936">mesh.hpp:936</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_a1a65f4990fb94bc1333fabd42e7b056c"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#a1a65f4990fb94bc1333fabd42e7b056c">mfem::ParFiniteElementSpace::GetTrueVSize</a></div><div class="ttdeci">virtual int GetTrueVSize() const</div><div class="ttdoc">Return the number of local vector true dofs. </div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8hpp_source.html#l00289">pfespace.hpp:289</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1FaceInfo_html_a3e22801bd2ed5fcdf0715ad34d402d17"><div class="ttname"><a href="structmfem_1_1Mesh_1_1FaceInfo.html#a3e22801bd2ed5fcdf0715ad34d402d17">mfem::Mesh::FaceInfo::Elem1No</a></div><div class="ttdeci">int Elem1No</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00156">mesh.hpp:156</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1031d0e0a97a340abfe0a6ab9e831045"><div class="ttname"><a href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a></div><div class="ttdeci">double a</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00041">lissajous.cpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1995b5687a77992652d76edc04149e36"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1995b5687a77992652d76edc04149e36">mfem::Mesh::NURBSext</a></div><div class="ttdeci">NURBSExtension * NURBSext</div><div class="ttdoc">Optional NURBS mesh extension. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00277">mesh.hpp:277</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a6698ffa6a809e3cc48b478c26b95e55f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a6698ffa6a809e3cc48b478c26b95e55f">mfem::ParMesh::GetLocalElementNum</a></div><div class="ttdeci">int GetLocalElementNum(long long global_element_num) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01530">pmesh.cpp:1530</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a27b274dcab25a4606c9995f5d1607ff8"><div class="ttname"><a href="classmfem_1_1Mesh.html#a27b274dcab25a4606c9995f5d1607ff8">mfem::Mesh::be_to_edge</a></div><div class="ttdeci">Array&lt; int &gt; be_to_edge</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00223">mesh.hpp:223</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a4d6d51a8d57b7ebcf15de350761c5bf8ad9f62fedff40db5806cd67d37c585c87"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a4d6d51a8d57b7ebcf15de350761c5bf8ad9f62fedff40db5806cd67d37c585c87">mfem::FaceElementTransformations::HAVE_FACE</a></div><div class="ttdoc">Face transformation is configured. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00517">eltrans.hpp:517</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ac071c7196b5fc38ca3a0edd9b8c28b98"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ac071c7196b5fc38ca3a0edd9b8c28b98">mfem::ParMesh::GetFaceNbrElementFaces</a></div><div class="ttdeci">void GetFaceNbrElementFaces(int i, Array&lt; int &gt; &amp;fcs, Array&lt; int &gt; &amp;cor) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02944">pmesh.cpp:2944</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1FaceInfo_html_a5fca9e45068918fbd498a1ab08eaf54d"><div class="ttname"><a href="structmfem_1_1Mesh_1_1FaceInfo.html#a5fca9e45068918fbd498a1ab08eaf54d">mfem::Mesh::FaceInfo::Elem2Inf</a></div><div class="ttdeci">int Elem2Inf</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00156">mesh.hpp:156</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ad2b0c68243d9e3c5d9ad86236bf4cb9f"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ad2b0c68243d9e3c5d9ad86236bf4cb9f">mfem::ParMesh::DistributeAttributes</a></div><div class="ttdeci">void DistributeAttributes(Array&lt; int &gt; &amp;attr)</div><div class="ttdoc">Ensure that bdr_attributes and attributes agree across processors. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01544">pmesh.cpp:1544</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a2a760adc26b5be37bd463e96032342ae"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a2a760adc26b5be37bd463e96032342ae">mfem::ParMesh::GetNRanks</a></div><div class="ttdeci">int GetNRanks() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00352">pmesh.hpp:352</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a4669b97f16600aa70a2ceadf08c15d2e"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a4669b97f16600aa70a2ceadf08c15d2e">mfem::ParNCMesh::Refine</a></div><div class="ttdeci">virtual void Refine(const Array&lt; Refinement &gt; &amp;refinements)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01246">pncmesh.cpp:1246</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1e4b4686077146cd260acc1f50827047"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1e4b4686077146cd260acc1f50827047">mfem::Mesh::GetElementType</a></div><div class="ttdeci">Element::Type GetElementType(int i) const</div><div class="ttdoc">Returns the type of element i. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06291">mesh.cpp:6291</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab09c17e5079c7c7f854949ec959882a8"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab09c17e5079c7c7f854949ec959882a8">mfem::Mesh::Swap</a></div><div class="ttdeci">void Swap(Mesh &amp;other, bool non_geometry)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l09346">mesh.cpp:9346</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a2c3ca23eb412a895516662e1885619c5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a2c3ca23eb412a895516662e1885619c5">mfem::ParMesh::BuildEdgeGroup</a></div><div class="ttdeci">void BuildEdgeGroup(int ngroups, const Table &amp;edge_element)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00668">pmesh.cpp:668</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a05b6a0ccfbc7fce09cf66b3c1b781d65"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a05b6a0ccfbc7fce09cf66b3c1b781d65">mfem::ParMesh::GetFaceSplittings</a></div><div class="ttdeci">void GetFaceSplittings(const int *fv, const HashTable&lt; Hashed2 &gt; &amp;v_to_v, Array&lt; unsigned &gt; &amp;codes)</div><div class="ttdoc">Append codes identifying how the given face has been split to codes. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01862">pmesh.cpp:1862</a></div></div>
<div class="ttc" id="classmfem_1_1IsoparametricTransformation_html"><div class="ttname"><a href="classmfem_1_1IsoparametricTransformation.html">mfem::IsoparametricTransformation</a></div><div class="ttdoc">A standard isoparametric element transformation. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00361">eltrans.hpp:361</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a4846bd1e96d1fadb07d42db0649ffaed"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a4846bd1e96d1fadb07d42db0649ffaed">mfem::GroupTopology::GetGroupSize</a></div><div class="ttdeci">int GetGroupSize(int g) const</div><div class="ttdoc">Get the number of processors in a group. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00178">communication.hpp:178</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a72dd2c8c7e70b3c766b72b25e2bfbb26"><div class="ttname"><a href="classmfem_1_1Mesh.html#a72dd2c8c7e70b3c766b72b25e2bfbb26">mfem::Mesh::GetElementTransformation</a></div><div class="ttdeci">void GetElementTransformation(int i, IsoparametricTransformation *ElTr)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l00348">mesh.cpp:348</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a27b691c6780cdf7ded075ff99c8732f8"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a27b691c6780cdf7ded075ff99c8732f8">mfem::ParMesh::group_sedge</a></div><div class="ttdeci">Table group_sedge</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00070">pmesh.hpp:70</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4c4ebc6ea67fbb893a819c592adaac01"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4c4ebc6ea67fbb893a819c592adaac01">mfem::Mesh::GetNFbyType</a></div><div class="ttdeci">virtual int GetNFbyType(FaceType type) const</div><div class="ttdoc">Returns the number of faces according to the requested type, does not count master nonconforming face...</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05405">mesh.cpp:5405</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_acb0b198a9fd2db6f16681bb549d4001f"><div class="ttname"><a href="classmfem_1_1Table.html#acb0b198a9fd2db6f16681bb549d4001f">mfem::Table::Size</a></div><div class="ttdeci">int Size() const</div><div class="ttdoc">Returns the number of TYPE I elements. </div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00092">table.hpp:92</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a7a2c02dd7f2fa28aa27324cc81135115"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a7a2c02dd7f2fa28aa27324cc81135115">mfem::ParMesh::ExchangeFaceNbrNodes</a></div><div class="ttdeci">void ExchangeFaceNbrNodes()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02601">pmesh.cpp:2601</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElementSpace_html_a6ea7e53fd19088193d6847257a7abd95"><div class="ttname"><a href="classmfem_1_1FiniteElementSpace.html#a6ea7e53fd19088193d6847257a7abd95">mfem::FiniteElementSpace::GetOrdering</a></div><div class="ttdeci">Ordering::Type GetOrdering() const</div><div class="ttdoc">Return the ordering method. </div><div class="ttdef"><b>Definition:</b> <a href="fespace_8hpp_source.html#l00599">fespace.hpp:599</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a97ad367f1286f53ce98b3bfe6b7a6c6c"><div class="ttname"><a href="classmfem_1_1Mesh.html#a97ad367f1286f53ce98b3bfe6b7a6c6c">mfem::Mesh::GetFace</a></div><div class="ttdeci">const Element * GetFace(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01089">mesh.hpp:1089</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac039f2cf162a535455b4f02fa4df7f06"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac039f2cf162a535455b4f02fa4df7f06">mfem::Mesh::Finalize</a></div><div class="ttdeci">virtual void Finalize(bool refine=false, bool fix_orientation=false)</div><div class="ttdoc">Finalize the construction of a general Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02995">mesh.cpp:2995</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_html_aaf649a33105192742e99dce91d139f25"><div class="ttname"><a href="classmfem_1_1HashTable.html#aaf649a33105192742e99dce91d139f25">mfem::HashTable::FindId</a></div><div class="ttdeci">int FindId(int p1, int p2) const</div><div class="ttdoc">Find id of item whose parents are p1, p2... Return -1 if it doesn&amp;#39;t exist. </div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00699">hash.hpp:699</a></div></div>
<div class="ttc" id="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1SQUARE_01_4_html_a565d3b9ebcd7d9e03b6149fc24a5087b"><div class="ttname"><a href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1SQUARE_01_4.html#a565d3b9ebcd7d9e03b6149fc24a5087b">mfem::Geometry::Constants&lt; Geometry::SQUARE &gt;::Orient</a></div><div class="ttdeci">static const int Orient[NumOrient][NumVert]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00209">geom.hpp:209</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a7c229dcf72fad97ea98a881db87ff8d4"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a7c229dcf72fad97ea98a881db87ff8d4">mfem::NCMesh::NCList::masters</a></div><div class="ttdeci">Array&lt; Master &gt; masters</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00230">ncmesh.hpp:230</a></div></div>
<div class="ttc" id="classmfem_1_1IntegerSet_html"><div class="ttname"><a href="classmfem_1_1IntegerSet.html">mfem::IntegerSet</a></div><div class="ttdoc">A set of integers. </div><div class="ttdef"><b>Definition:</b> <a href="sets_8hpp_source.html#l00023">sets.hpp:23</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a902ed2768f95643dc04cbc83eb60d34c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a902ed2768f95643dc04cbc83eb60d34c">mfem::ParMesh::BuildLocalElements</a></div><div class="ttdeci">int BuildLocalElements(const Mesh &amp;global_mesh, const int *partitioning, const Array&lt; int &gt; &amp;vert_global_local)</div><div class="ttdoc">Fills out partitioned Mesh::elements. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00350">pmesh.cpp:350</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_aa3f81cd02927bc59a02a9aeff61ffe9e"><div class="ttname"><a href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">mfem::Table::SetIJ</a></div><div class="ttdeci">void SetIJ(int *newI, int *newJ, int newsize=-1)</div><div class="ttdoc">Replace the I and J arrays with the given newI and newJ arrays. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00207">table.cpp:207</a></div></div>
<div class="ttc" id="namespacemfem_html_acd8cbd1dcec616f06ddf2fa42afc8eca"><div class="ttname"><a href="namespacemfem.html#acd8cbd1dcec616f06ddf2fa42afc8eca">mfem::VTKByteOrder</a></div><div class="ttdeci">const char * VTKByteOrder()</div><div class="ttdoc">Determine the byte order and return either &quot;BigEndian&quot; or &quot;LittleEndian&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="vtk_8cpp_source.html#l00602">vtk.cpp:602</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_ae88fd62884438bb24d7f77102a96ccec"><div class="ttname"><a href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">mfem::Table::MakeJ</a></div><div class="ttdeci">void MakeJ()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00091">table.cpp:91</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a2ec69c2ec500f1cfd4b7d9446b2f239d"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a2ec69c2ec500f1cfd4b7d9446b2f239d">mfem::ParMesh::group_svert</a></div><div class="ttdeci">Table group_svert</div><div class="ttdoc">Shared objects in each group. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00069">pmesh.hpp:69</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a77d9d95321f54573d795660125f758b5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a77d9d95321f54573d795660125f758b5">mfem::ParMesh::PrintAsSerial</a></div><div class="ttdeci">void PrintAsSerial(std::ostream &amp;out=mfem::out) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l05292">pmesh.cpp:5292</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a5f55ec61fee309905a372ee344994631"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a5f55ec61fee309905a372ee344994631">mfem::ParMesh::SetCurvature</a></div><div class="ttdeci">void SetCurvature(int order, bool discont=false, int space_dim=-1, int ordering=1) override</div><div class="ttdoc">Set the curvature of the mesh nodes using the given polynomial degree. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02056">pmesh.cpp:2056</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a9079e68a3e311bef9d312a464d1c385a"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a9079e68a3e311bef9d312a464d1c385a">mfem::ParMesh::DecodeFaceSplittings</a></div><div class="ttdeci">bool DecodeFaceSplittings(HashTable&lt; Hashed2 &gt; &amp;v_to_v, const int *v, const Array&lt; unsigned &gt; &amp;codes, int &amp;pos)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01897">pmesh.cpp:1897</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805a3a4eeb8006188bea7c806ebbef23ca90"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a3a4eeb8006188bea7c806ebbef23ca90">mfem::Geometry::POINT</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00038">geom.hpp:38</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a1a5bad10ed9a45d2018dfd1c32fd288e"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a1a5bad10ed9a45d2018dfd1c32fd288e">mfem::NCMesh::NCList::conforming</a></div><div class="ttdeci">Array&lt; MeshId &gt; conforming</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00229">ncmesh.hpp:229</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aab85b892df2a606fb61ec632ccdebad9"><div class="ttname"><a href="classmfem_1_1Mesh.html#aab85b892df2a606fb61ec632ccdebad9">mfem::Mesh::GetFaceElementType</a></div><div class="ttdeci">Element::Type GetFaceElementType(int Face) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01432">mesh.cpp:1432</a></div></div>
<div class="ttc" id="classmfem_1_1IsoparametricTransformation_html_a156708114d0bfeb6e9aadc664ad68d2c"><div class="ttname"><a href="classmfem_1_1IsoparametricTransformation.html#a156708114d0bfeb6e9aadc664ad68d2c">mfem::IsoparametricTransformation::SetFE</a></div><div class="ttdeci">void SetFE(const FiniteElement *FE)</div><div class="ttdoc">Set the element that will be used to compute the transformations. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00381">eltrans.hpp:381</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_adc9fbbcfc01b5fd7723d061dbcde136a"><div class="ttname"><a href="classmfem_1_1ParMesh.html#adc9fbbcfc01b5fd7723d061dbcde136a">mfem::ParMesh::GetFaceNbrElementSize</a></div><div class="ttdeci">double GetFaceNbrElementSize(int i, int type=0)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02030">pmesh.cpp:2030</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a71907c5055e2815e8926a8322cf2eb43"><div class="ttname"><a href="classmfem_1_1Mesh.html#a71907c5055e2815e8926a8322cf2eb43">mfem::Mesh::sequence</a></div><div class="ttdeci">long sequence</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00083">mesh.hpp:83</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">mfem::Element::TRIANGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1IntegrationPointTransformation_html_a1f5f75fc449ee465ec9e00b6de3d0c16"><div class="ttname"><a href="classmfem_1_1IntegrationPointTransformation.html#a1f5f75fc449ee465ec9e00b6de3d0c16">mfem::IntegrationPointTransformation::Transf</a></div><div class="ttdeci">IsoparametricTransformation Transf</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00464">eltrans.hpp:464</a></div></div>
<div class="ttc" id="life_8cpp_html_a3b0ebfb1ea55d7ef281731142fe7e93d"><div class="ttname"><a href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a></div><div class="ttdeci">int index(int i, int j, int nx, int ny)</div><div class="ttdef"><b>Definition:</b> <a href="life_8cpp_source.html#l00235">life.cpp:235</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Master_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Master.html">mfem::NCMesh::Master</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00203">ncmesh.hpp:203</a></div></div>
<div class="ttc" id="classmfem_1_1DSTable_html_a18868aa35ecd8c7800f5e6258ce40a79"><div class="ttname"><a href="classmfem_1_1DSTable.html#a18868aa35ecd8c7800f5e6258ce40a79">mfem::DSTable::NumberOfEntries</a></div><div class="ttdeci">int NumberOfEntries() const</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00266">table.hpp:266</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a9c03a88178edb19654f58cedabf0b899"><div class="ttname"><a href="classmfem_1_1Array.html#a9c03a88178edb19654f58cedabf0b899">mfem::Array::Copy</a></div><div class="ttdeci">void Copy(Array &amp;copy) const</div><div class="ttdoc">Create a copy of the internal array to the provided copy. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00861">array.hpp:861</a></div></div>
<div class="ttc" id="classmfem_1_1FaceElementTransformations_html_a1c8e3135e68653fdca63cca2ad0332d9"><div class="ttname"><a href="classmfem_1_1FaceElementTransformations.html#a1c8e3135e68653fdca63cca2ad0332d9">mfem::FaceElementTransformations::Elem1</a></div><div class="ttdeci">ElementTransformation * Elem1</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00522">eltrans.hpp:522</a></div></div>
<div class="ttc" id="classmfem_1_1Memory_html"><div class="ttname"><a href="classmfem_1_1Memory.html">mfem::Memory&lt; int &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_afb51ddb515e59436a517d2b1510f8543"><div class="ttname"><a href="classmfem_1_1Mesh.html#afb51ddb515e59436a517d2b1510f8543">mfem::Mesh::MakeSimplicial_</a></div><div class="ttdeci">void MakeSimplicial_(const Mesh &amp;orig_mesh, int *vglobal)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l04582">mesh.cpp:4582</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a363532c83cf1c893013a57281baf281c"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a363532c83cf1c893013a57281baf281c">mfem::ParMesh::GetGlobalElementNum</a></div><div class="ttdeci">long long GetGlobalElementNum(int local_element_num) const</div><div class="ttdoc">Map a local element number to a global element number. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01538">pmesh.cpp:1538</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a0fc2af3d0e90ce609b68ffff617f5240"><div class="ttname"><a href="classmfem_1_1Mesh.html#a0fc2af3d0e90ce609b68ffff617f5240">mfem::Mesh::faces_info</a></div><div class="ttdeci">Array&lt; FaceInfo &gt; faces_info</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00217">mesh.hpp:217</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_ad8ec08b2b1213643206fdd5a9aab5931"><div class="ttname"><a href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">mfem::Element::GetNVertices</a></div><div class="ttdeci">virtual int GetNVertices() const =0</div></div>
<div class="ttc" id="classmfem_1_1Element_html_a68f17653a78f9d85c29a1e486a25ddaf"><div class="ttname"><a href="classmfem_1_1Element.html#a68f17653a78f9d85c29a1e486a25ddaf">mfem::Element::SetAttribute</a></div><div class="ttdeci">void SetAttribute(const int attr)</div><div class="ttdoc">Set element&amp;#39;s attribute. </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00058">element.hpp:58</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ad5510bac66ddadc6eb5c920c7d74684e"><div class="ttname"><a href="classmfem_1_1Mesh.html#ad5510bac66ddadc6eb5c920c7d74684e">mfem::Mesh::GetFacesTable</a></div><div class="ttdeci">STable3D * GetFacesTable()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06776">mesh.cpp:6776</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_ad172b0bc5f90baf82f19c1e74ce72f2a"><div class="ttname"><a href="classmfem_1_1Table.html#ad172b0bc5f90baf82f19c1e74ce72f2a">mfem::Table::Size_of_connections</a></div><div class="ttdeci">int Size_of_connections() const</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00098">table.hpp:98</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_a0a862151943f79b9006ae1851632711c"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#a0a862151943f79b9006ae1851632711c">mfem::ParFiniteElementSpace::GetSharedEdgeDofs</a></div><div class="ttdeci">void GetSharedEdgeDofs(int group, int ei, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l00584">pfespace.cpp:584</a></div></div>
<div class="ttc" id="classmfem_1_1BasisType_html_a595200afdb6ca6e3fda75896071ef3efa5289400991b692469b59ad94accfe75b"><div class="ttname"><a href="classmfem_1_1BasisType.html#a595200afdb6ca6e3fda75896071ef3efa5289400991b692469b59ad94accfe75b">mfem::BasisType::GaussLobatto</a></div><div class="ttdoc">Closed type. </div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8hpp_source.html#l00031">fe_base.hpp:31</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_accf0f0075e05fbd2e8086f81027f5b38"><div class="ttname"><a href="classmfem_1_1Mesh.html#accf0f0075e05fbd2e8086f81027f5b38">mfem::Mesh::ncmesh</a></div><div class="ttdeci">NCMesh * ncmesh</div><div class="ttdoc">Optional nonconforming mesh extension. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00278">mesh.hpp:278</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_af29be245d92e79eb31bb1e7dc733db3b"><div class="ttname"><a href="classmfem_1_1GridFunction.html#af29be245d92e79eb31bb1e7dc733db3b">mfem::GridFunction::GetVectorValues</a></div><div class="ttdeci">void GetVectorValues(int i, const IntegrationRule &amp;ir, DenseMatrix &amp;vals, DenseMatrix &amp;tr) const</div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8cpp_source.html#l00717">gridfunc.cpp:717</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a143ec47e53707b29accd8994058830b9"><div class="ttname"><a href="classmfem_1_1Mesh.html#a143ec47e53707b29accd8994058830b9">mfem::Mesh::AddBdrElement</a></div><div class="ttdeci">int AddBdrElement(Element *elem)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l01828">mesh.cpp:1828</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a5efef8b3cd9f7f35f89bb8330e76d120"><div class="ttname"><a href="classmfem_1_1Array.html#a5efef8b3cd9f7f35f89bb8330e76d120">mfem::Array::Size</a></div><div class="ttdeci">int Size() const</div><div class="ttdoc">Return the logical size of the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00141">array.hpp:141</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_afc37a6b99ec8f6dbda516d33384a1f01"><div class="ttname"><a href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">mfem::Array::Last</a></div><div class="ttdeci">T &amp; Last()</div><div class="ttdoc">Return the last element in the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00789">array.hpp:789</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a72c146ad1d165bf4bbd099a806f4426b"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a72c146ad1d165bf4bbd099a806f4426b">mfem::ParMesh::GetGlobalFaceIndices</a></div><div class="ttdeci">void GetGlobalFaceIndices(Array&lt; HYPRE_BigInt &gt; &amp;gi) const</div><div class="ttdoc">AMR meshes are not supported. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l06634">pmesh.cpp:6634</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a3c3a04ba890632835c2d766bab361970"><div class="ttname"><a href="classmfem_1_1Mesh.html#a3c3a04ba890632835c2d766bab361970">mfem::Mesh::Dim</a></div><div class="ttdeci">int Dim</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00066">mesh.hpp:66</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a9936001a545c5777a996f1e4066514c7"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a9936001a545c5777a996f1e4066514c7">mfem::ParNCMesh::CheckDerefinementNCLevel</a></div><div class="ttdeci">virtual void CheckDerefinementNCLevel(const Table &amp;deref_table, Array&lt; int &gt; &amp;level_ok, int max_nc_level)</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01625">pncmesh.cpp:1625</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a1a39ac7a8245a70788b01f1b92419725"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a1a39ac7a8245a70788b01f1b92419725">mfem::ParMesh::GetEdgeSplittings</a></div><div class="ttdeci">int GetEdgeSplittings(Element *edge, const DSTable &amp;v_to_v, int *middle)</div><div class="ttdoc">Return a number(0-1) identifying how the given edge has been split. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01847">pmesh.cpp:1847</a></div></div>
<div class="ttc" id="classmfem_1_1H1__FECollection_html_af967a0f6e7ab63efbb79cc8fa5413ded"><div class="ttname"><a href="classmfem_1_1H1__FECollection.html#af967a0f6e7ab63efbb79cc8fa5413ded">mfem::H1_FECollection::GetDofMap</a></div><div class="ttdeci">const int * GetDofMap(Geometry::Type GeomType) const</div><div class="ttdoc">Get the Cartesian to local H1 dof map. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8cpp_source.html#l02007">fe_coll.cpp:2007</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_adcbe93689e9f88e401464c49f0d4fb2e"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#adcbe93689e9f88e401464c49f0d4fb2e">mfem::ElementTransformation::Attribute</a></div><div class="ttdeci">int Attribute</div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00078">eltrans.hpp:78</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a38ac9f00a3195b7777153118d646f79a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a38ac9f00a3195b7777153118d646f79a">mfem::Mesh::AggregateError</a></div><div class="ttdeci">double AggregateError(const Array&lt; double &gt; &amp;elem_error, const int *fine, int nfine, int op)</div><div class="ttdoc">Derefinement helper. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l09205">mesh.cpp:9205</a></div></div>
<div class="ttc" id="classmfem_1_1Tetrahedron_html_abd677057627def50ad358013dee61bc0"><div class="ttname"><a href="classmfem_1_1Tetrahedron.html#abd677057627def50ad358013dee61bc0">mfem::Tetrahedron::GetMarkedFace</a></div><div class="ttdeci">void GetMarkedFace(const int face, int *fv)</div><div class="ttdef"><b>Definition:</b> <a href="tetrahedron_8cpp_source.html#l00137">tetrahedron.cpp:137</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_afa4f16dc016e8b89ed91b137a1ba5c61"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#afa4f16dc016e8b89ed91b137a1ba5c61">mfem::ParNCMesh::InitialPartition</a></div><div class="ttdeci">int InitialPartition(int index) const</div><div class="ttdoc">Helper to get the partitioning when the serial mesh gets split initially. </div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8hpp_source.html#l00309">pncmesh.hpp:309</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac4a77cf819f394d9e5097d5f4edc3845"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac4a77cf819f394d9e5097d5f4edc3845">mfem::Mesh::FindPoints</a></div><div class="ttdeci">virtual int FindPoints(DenseMatrix &amp;point_mat, Array&lt; int &gt; &amp;elem_ids, Array&lt; IntegrationPoint &gt; &amp;ips, bool warn=true, InverseElementTransformation *inv_trans=NULL)</div><div class="ttdoc">Find the ids of the elements that contain the given points, and their corresponding reference coordin...</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l11962">mesh.cpp:11962</a></div></div>
<div class="ttc" id="classmfem_1_1ND__FECollection_html"><div class="ttname"><a href="classmfem_1_1ND__FECollection.html">mfem::ND_FECollection</a></div><div class="ttdoc">Arbitrary order H(curl)-conforming Nedelec finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00447">fe_coll.hpp:447</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae3cb40035c448dde218f2b7000555950"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae3cb40035c448dde218f2b7000555950">mfem::ParMesh::GetFaceNbrRank</a></div><div class="ttdeci">int GetFaceNbrRank(int fn) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02926">pmesh.cpp:2926</a></div></div>
<div class="ttc" id="classmfem_1_1Vector_html"><div class="ttname"><a href="classmfem_1_1Vector.html">mfem::Vector</a></div><div class="ttdoc">Vector data type. </div><div class="ttdef"><b>Definition:</b> <a href="vector_8hpp_source.html#l00060">vector.hpp:60</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a5494695d820a72938344409d3654b3e9"><div class="ttname"><a href="classmfem_1_1Mesh.html#a5494695d820a72938344409d3654b3e9">mfem::Mesh::GetNFaces</a></div><div class="ttdeci">int GetNFaces() const</div><div class="ttdoc">Return the number of faces in a 3D mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00945">mesh.hpp:945</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a77b793b23a4bbda8cb05cd29d696dd8a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a77b793b23a4bbda8cb05cd29d696dd8a">mfem::Mesh::Print</a></div><div class="ttdeci">virtual void Print(std::ostream &amp;os=mfem::out) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01749">mesh.hpp:1749</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_ac5bf9371c58dac27dda644e11b18a47c"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#ac5bf9371c58dac27dda644e11b18a47c">mfem::ElementTransformation::Transform</a></div><div class="ttdeci">virtual void Transform(const IntegrationPoint &amp;, Vector &amp;)=0</div><div class="ttdoc">Transform integration point from reference coordinates to physical coordinates and store them in the ...</div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ab18f38d2affaab9a1a1feccbe4a99f51"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ab18f38d2affaab9a1a1feccbe4a99f51">mfem::ParMesh::GroupNEdges</a></div><div class="ttdeci">int GroupNEdges(int group) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00396">pmesh.hpp:396</a></div></div>
<div class="ttc" id="classmfem_1_1IsoparametricTransformation_html_a45164c2e229ec45a83f50a50dd80302e"><div class="ttname"><a href="classmfem_1_1IsoparametricTransformation.html#a45164c2e229ec45a83f50a50dd80302e">mfem::IsoparametricTransformation::GetPointMat</a></div><div class="ttdeci">const DenseMatrix &amp; GetPointMat() const</div><div class="ttdoc">Return the stored point matrix. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00404">eltrans.hpp:404</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a93da2addef0d0298d1e90b30b14b7664"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a93da2addef0d0298d1e90b30b14b7664">mfem::ParMesh::MakeSimplicial</a></div><div class="ttdeci">static ParMesh MakeSimplicial(ParMesh &amp;orig_mesh)</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01374">pmesh.cpp:1374</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a51e284497f4584a27a34f6bd3525ee06"><div class="ttname"><a href="classmfem_1_1Mesh.html#a51e284497f4584a27a34f6bd3525ee06">mfem::Mesh::GetTriOrientation</a></div><div class="ttdeci">static int GetTriOrientation(const int *base, const int *test)</div><div class="ttdoc">Returns the orientation of &quot;test&quot; relative to &quot;base&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05581">mesh.cpp:5581</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a7d957f07ff5fd306b8dd15a367b292b3"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a7d957f07ff5fd306b8dd15a367b292b3">mfem::ParMesh::SetNodalFESpace</a></div><div class="ttdeci">void SetNodalFESpace(FiniteElementSpace *nfes) override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02076">pmesh.cpp:2076</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a1f6835099238cd350794c812622c68f4"><div class="ttname"><a href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">mfem::Table::GetI</a></div><div class="ttdeci">int * GetI()</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00113">table.hpp:113</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_html_a6e94e3678fe908300fc5c8873d3f0bc5"><div class="ttname"><a href="classmfem_1_1HashTable.html#a6e94e3678fe908300fc5c8873d3f0bc5">mfem::HashTable::GetId</a></div><div class="ttdeci">int GetId(int p1, int p2)</div><div class="ttdoc">Get id of item whose parents are p1, p2... Create it if it doesn&amp;#39;t exist. </div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00608">hash.hpp:608</a></div></div>
<div class="ttc" id="classmfem_1_1H1__FECollection_html"><div class="ttname"><a href="classmfem_1_1H1__FECollection.html">mfem::H1_FECollection</a></div><div class="ttdoc">Arbitrary order H1-conforming (continuous) finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00252">fe_coll.hpp:252</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a9ebff5f2033d5797d02cc4e9906781dd"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a9ebff5f2033d5797d02cc4e9906781dd">mfem::ParMesh::svert_lvert</a></div><div class="ttdeci">Array&lt; int &gt; svert_lvert</div><div class="ttdoc">Shared to local index mapping. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00075">pmesh.hpp:75</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4784444c57c21808869bcaed6e6bcf50"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4784444c57c21808869bcaed6e6bcf50">mfem::Mesh::GenerateFaces</a></div><div class="ttdeci">void GenerateFaces()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06614">mesh.cpp:6614</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_a2996b5567bedaf88c723475f1857bbe5"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#a2996b5567bedaf88c723475f1857bbe5">mfem::ParNCMesh::GetSharedFaces</a></div><div class="ttdeci">const NCList &amp; GetSharedFaces()</div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8hpp_source.html#l00125">pncmesh.hpp:125</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a042555bc799c7f54516929fad12dcb85"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a042555bc799c7f54516929fad12dcb85">mfem::ParMesh::GroupNQuadrilaterals</a></div><div class="ttdeci">int GroupNQuadrilaterals(int group) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00398">pmesh.hpp:398</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a9a0fa5f0dbca754e36437b13ae6b158f"><div class="ttname"><a href="classmfem_1_1Mesh.html#a9a0fa5f0dbca754e36437b13ae6b158f">mfem::Mesh::GetNodes</a></div><div class="ttdeci">void GetNodes(Vector &amp;node_coord) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l07949">mesh.cpp:7949</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a7fbc0822531cf333b3417e9c94ef47b7"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a7fbc0822531cf333b3417e9c94ef47b7">mfem::ParMesh::MyRank</a></div><div class="ttdeci">int MyRank</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00038">pmesh.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab97420b9fbd65940ff9b532e45184d5f"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab97420b9fbd65940ff9b532e45184d5f">mfem::Mesh::spaceDim</a></div><div class="ttdeci">int spaceDim</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00067">mesh.hpp:67</a></div></div>
<div class="ttc" id="ncmesh__tables_8hpp_html_aa9bbc8c2be6976cfc6ce9759a9012e39"><div class="ttname"><a href="ncmesh__tables_8hpp.html#aa9bbc8c2be6976cfc6ce9759a9012e39">s</a></div><div class="ttdeci">RefCoord s[3]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh__tables_8hpp_source.html#l00182">ncmesh_tables.hpp:182</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_afc8694e930d1db54abc3833d44504229"><div class="ttname"><a href="classmfem_1_1Mesh.html#afc8694e930d1db54abc3833d44504229">mfem::Mesh::Printer</a></div><div class="ttdeci">void Printer(std::ostream &amp;out=mfem::out, std::string section_delimiter=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l10217">mesh.cpp:10217</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_afa7fefbe7831d5e3b514d4d84ff129ef"><div class="ttname"><a href="classmfem_1_1ParMesh.html#afa7fefbe7831d5e3b514d4d84ff129ef">mfem::ParMesh::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;out=mfem::out) const override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04839">pmesh.cpp:4839</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a66a55c978781ac29f1d6e380cd79e28b"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a66a55c978781ac29f1d6e380cd79e28b">mfem::NCMesh::GetEdgeList</a></div><div class="ttdeci">const NCList &amp; GetEdgeList()</div><div class="ttdoc">Return the current list of conforming and nonconforming edges. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00260">ncmesh.hpp:260</a></div></div>
<div class="ttc" id="classmfem_1_1adios2stream_html"><div class="ttname"><a href="classmfem_1_1adios2stream.html">mfem::adios2stream</a></div><div class="ttdef"><b>Definition:</b> <a href="adios2stream_8hpp_source.html#l00047">adios2stream.hpp:47</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a3fb722340f1daf32abdc1aa4c716466a"><div class="ttname"><a href="classmfem_1_1Mesh.html#a3fb722340f1daf32abdc1aa4c716466a">mfem::Mesh::DoNodeReorder</a></div><div class="ttdeci">void DoNodeReorder(DSTable *old_v_to_v, Table *old_elem_vert)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l02559">mesh.cpp:2559</a></div></div>
<div class="ttc" id="structmfem_1_1Mesh_1_1NCFaceInfo_html"><div class="ttname"><a href="structmfem_1_1Mesh_1_1NCFaceInfo.html">mfem::Mesh::NCFaceInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00202">mesh.hpp:202</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aec099666a5e112fda3386c40ad89bfc5"><div class="ttname"><a href="classmfem_1_1Mesh.html#aec099666a5e112fda3386c40ad89bfc5">mfem::Mesh::GetBdrElement</a></div><div class="ttdeci">const Element * GetBdrElement(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l01085">mesh.hpp:1085</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a2fd34bafce89dcad12039f80760c294ba691c033cad8c39ea9637b56e86fa167e"><div class="ttname"><a href="classmfem_1_1Mesh.html#a2fd34bafce89dcad12039f80760c294ba691c033cad8c39ea9637b56e86fa167e">mfem::Mesh::REFINE</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00270">mesh.hpp:270</a></div></div>
<div class="ttc" id="classmfem_1_1ParGridFunction_html"><div class="ttname"><a href="classmfem_1_1ParGridFunction.html">mfem::ParGridFunction</a></div><div class="ttdoc">Class for parallel grid function. </div><div class="ttdef"><b>Definition:</b> <a href="pgridfunc_8hpp_source.html#l00032">pgridfunc.hpp:32</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a938655b0d2d1168689770bf06e48ae49"><div class="ttname"><a href="classmfem_1_1Mesh.html#a938655b0d2d1168689770bf06e48ae49">mfem::Mesh::SetNodalGridFunction</a></div><div class="ttdeci">void SetNodalGridFunction(GridFunction *nodes, bool make_owner=false)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l05345">mesh.cpp:5345</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_acee30a668bbc576868feb465a7fcd7b3"><div class="ttname"><a href="classmfem_1_1ParMesh.html#acee30a668bbc576868feb465a7fcd7b3">mfem::ParMesh::GroupQuadrilateral</a></div><div class="ttdeci">void GroupQuadrilateral(int group, int i, int &amp;face, int &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01626">pmesh.cpp:1626</a></div></div>
<div class="ttc" id="classmfem_1_1IsoparametricTransformation_html_af8ae8afa0ba1d6f17e0d74a786133fb8"><div class="ttname"><a href="classmfem_1_1IsoparametricTransformation.html#af8ae8afa0ba1d6f17e0d74a786133fb8">mfem::IsoparametricTransformation::GetFE</a></div><div class="ttdeci">const FiniteElement * GetFE() const</div><div class="ttdoc">Get the current element used to compute the transformations. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00389">eltrans.hpp:389</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a5c62b399e1c6408e5f1903f6cab5dfbb"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">mfem::DenseMatrix::SetSize</a></div><div class="ttdeci">void SetSize(int s)</div><div class="ttdoc">Change the size of the DenseMatrix to s x s. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00105">densemat.hpp:105</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a090f20ad3e657d8fb7db3168230656b5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a090f20ad3e657d8fb7db3168230656b5">mfem::ParMesh::send_face_nbr_elements</a></div><div class="ttdeci">Table send_face_nbr_elements</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00385">pmesh.hpp:385</a></div></div>
<div class="ttc" id="classmfem_1_1ListOfIntegerSets_html"><div class="ttname"><a href="classmfem_1_1ListOfIntegerSets.html">mfem::ListOfIntegerSets</a></div><div class="ttdoc">List of integer sets. </div><div class="ttdef"><b>Definition:</b> <a href="sets_8hpp_source.html#l00062">sets.hpp:62</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a9a683a46e2c4c8dabc567a67bbe4abd3"><div class="ttname"><a href="classmfem_1_1Mesh.html#a9a683a46e2c4c8dabc567a67bbe4abd3">mfem::Mesh::NumOfVertices</a></div><div class="ttdeci">int NumOfVertices</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00069">mesh.hpp:69</a></div></div>
<div class="ttc" id="classmfem_1_1GridFunction_html_a384af64abe5d00fd151480fe7cf21ac2"><div class="ttname"><a href="classmfem_1_1GridFunction.html#a384af64abe5d00fd151480fe7cf21ac2">mfem::GridFunction::Save</a></div><div class="ttdeci">virtual void Save(std::ostream &amp;out) const</div><div class="ttdoc">Save the GridFunction to an output stream. </div><div class="ttdef"><b>Definition:</b> <a href="gridfunc_8cpp_source.html#l03673">gridfunc.cpp:3673</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ac70f8d3cf297d403dfb67daec0114299"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ac70f8d3cf297d403dfb67daec0114299">mfem::ParMesh::FinalizeParTopo</a></div><div class="ttdeci">void FinalizeParTopo()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00887">pmesh.cpp:887</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_abcac42dba005803c8b891633559b7ed5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#abcac42dba005803c8b891633559b7ed5">mfem::ParMesh::DeleteFaceNbrData</a></div><div class="ttdeci">void DeleteFaceNbrData()</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l02035">pmesh.cpp:2035</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4c23a825f8da99e3c2a4ed86dc27cdf0"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4c23a825f8da99e3c2a4ed86dc27cdf0">mfem::Mesh::InitFromNCMesh</a></div><div class="ttdeci">void InitFromNCMesh(const NCMesh &amp;ncmesh)</div><div class="ttdoc">Initialize vertices/elements/boundary/tables from a nonconforming mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l09302">mesh.cpp:9302</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_aa2f85a29cd1bfa7d58e0bfadbf9ba14a"><div class="ttname"><a href="classmfem_1_1ParMesh.html#aa2f85a29cd1bfa7d58e0bfadbf9ba14a">mfem::ParMesh::gtopo</a></div><div class="ttdeci">GroupTopology gtopo</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00375">pmesh.hpp:375</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab2402aac46a642ac45aefd0f339a7d4f"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab2402aac46a642ac45aefd0f339a7d4f">mfem::Mesh::Bisection</a></div><div class="ttdeci">void Bisection(int i, const DSTable &amp;, int *, int *, int *)</div><div class="ttdoc">Bisect a triangle: element with index i is bisected. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l09633">mesh.cpp:9633</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a01d3de80a43b0e1b7f34b64497646ac5"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a01d3de80a43b0e1b7f34b64497646ac5">mfem::ParMesh::GetSerialMesh</a></div><div class="ttdeci">Mesh GetSerialMesh(int save_rank) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l05303">pmesh.cpp:5303</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_abeed313ed0e699ab273ef95f65e69535"><div class="ttname"><a href="classmfem_1_1ParMesh.html#abeed313ed0e699ab273ef95f65e69535">mfem::ParMesh::Load</a></div><div class="ttdeci">void Load(std::istream &amp;input, int generate_edges=0, int refine=1, bool fix_orientation=true) override</div><div class="ttdoc">Parallel version of Mesh::Load(). </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00942">pmesh.cpp:942</a></div></div>
<div class="ttc" id="classmfem_1_1FiniteElement_html_a4e98d9b922030b9ef7379855daa81346"><div class="ttname"><a href="classmfem_1_1FiniteElement.html#a4e98d9b922030b9ef7379855daa81346">mfem::FiniteElement::GetNodes</a></div><div class="ttdeci">const IntegrationRule &amp; GetNodes() const</div><div class="ttdoc">Get a const reference to the nodes of the element. </div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8hpp_source.html#l00388">fe_base.hpp:388</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_ae6dbcb74bd6f1b9d917ebf5b552942d6"><div class="ttname"><a href="classmfem_1_1ParMesh.html#ae6dbcb74bd6f1b9d917ebf5b552942d6">mfem::ParMesh::GroupTriangle</a></div><div class="ttdeci">void GroupTriangle(int group, int i, int &amp;face, int &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l01615">pmesh.cpp:1615</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_html"><div class="ttname"><a href="classmfem_1_1HashTable.html">mfem::HashTable</a></div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00081">hash.hpp:81</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_ad4e566b2d669cd42a3ec96a7ce98b364"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#ad4e566b2d669cd42a3ec96a7ce98b364">mfem::ParFiniteElementSpace::GetGlobalTDofNumber</a></div><div class="ttdeci">HYPRE_BigInt GetGlobalTDofNumber(int ldof) const</div><div class="ttdoc">Returns the global tdof number of the given local degree of freedom. </div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l01083">pfespace.cpp:1083</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html"><div class="ttname"><a href="classmfem_1_1ParMesh.html">mfem::ParMesh</a></div><div class="ttdoc">Class for parallel meshes. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00032">pmesh.hpp:32</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html"><div class="ttname"><a href="classmfem_1_1Element.html">mfem::Element</a></div><div class="ttdoc">Abstract data type element. </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00028">element.hpp:28</a></div></div>
<div class="ttc" id="classmfem_1_1Segment_html"><div class="ttname"><a href="classmfem_1_1Segment.html">mfem::Segment</a></div><div class="ttdoc">Data type line segment element. </div><div class="ttdef"><b>Definition:</b> <a href="segment_8hpp_source.html#l00022">segment.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a21233b713496e559a61361a7fbfe16b5"><div class="ttname"><a href="classmfem_1_1Mesh.html#a21233b713496e559a61361a7fbfe16b5">mfem::Mesh::BdrBisection</a></div><div class="ttdeci">void BdrBisection(int i, const HashTable&lt; Hashed2 &gt; &amp;)</div><div class="ttdoc">Bisect a boundary triangle: boundary element with index i is bisected. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l09841">mesh.cpp:9841</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_af30963c1d6025a1ef304caa2366109df"><div class="ttname"><a href="classmfem_1_1ParMesh.html#af30963c1d6025a1ef304caa2366109df">mfem::ParMesh::ComputeGlobalElementOffset</a></div><div class="ttdeci">void ComputeGlobalElementOffset() const</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l00868">pmesh.cpp:868</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a97ddc5b11253b59372abbb9494e5d937"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a97ddc5b11253b59372abbb9494e5d937">mfem::ParMesh::group_squad</a></div><div class="ttdeci">Table group_squad</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8hpp_source.html#l00072">pmesh.hpp:72</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a37b72005638c0da654315a61f7965fd7"><div class="ttname"><a href="classmfem_1_1Mesh.html#a37b72005638c0da654315a61f7965fd7">mfem::Mesh::GenerateNCFaceInfo</a></div><div class="ttdeci">void GenerateNCFaceInfo()</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06715">mesh.cpp:6715</a></div></div>
<div class="ttc" id="classmfem_1_1RefinedGeometry_html_a4b2d00bf63fc89732a277670859845fa"><div class="ttname"><a href="classmfem_1_1RefinedGeometry.html#a4b2d00bf63fc89732a277670859845fa">mfem::RefinedGeometry::RefGeoms</a></div><div class="ttdeci">Array&lt; int &gt; RefGeoms</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00315">geom.hpp:315</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a89e5b9c622f32475936666ff6ad19cab"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a89e5b9c622f32475936666ff6ad19cab">mfem::ParMesh::Save</a></div><div class="ttdeci">void Save(const char *fname, int precision=16) const override</div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l04955">pmesh.cpp:4955</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaa7b6a988fd7eb10928cc14ba0f47543"><div class="ttname"><a href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">mfem::Element::GetType</a></div><div class="ttdeci">virtual Type GetType() const =0</div><div class="ttdoc">Returns element&amp;#39;s type. </div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab4befc0b8219172fb75b08b8a68a4e35"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab4befc0b8219172fb75b08b8a68a4e35">mfem::Mesh::GetLength</a></div><div class="ttdeci">double GetLength(int i, int j) const</div><div class="ttdoc">Return the length of the segment from node i to node j. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06335">mesh.cpp:6335</a></div></div>
<div class="ttc" id="classmfem_1_1ParNCMesh_html_aef8e191581f226d508953d16a8c159d7"><div class="ttname"><a href="classmfem_1_1ParNCMesh.html#aef8e191581f226d508953d16a8c159d7">mfem::ParNCMesh::LimitNCLevel</a></div><div class="ttdeci">virtual void LimitNCLevel(int max_nc_level)</div><div class="ttdoc">Parallel version of NCMesh::LimitNCLevel. </div><div class="ttdef"><b>Definition:</b> <a href="pncmesh_8cpp_source.html#l01324">pncmesh.cpp:1324</a></div></div>
<div class="ttc" id="classmfem_1_1ParFiniteElementSpace_html_ab3e15ea1d8c5d0a3143442b295b84f66"><div class="ttname"><a href="classmfem_1_1ParFiniteElementSpace.html#ab3e15ea1d8c5d0a3143442b295b84f66">mfem::ParFiniteElementSpace::GetBdrElementDofs</a></div><div class="ttdeci">virtual DofTransformation * GetBdrElementDofs(int i, Array&lt; int &gt; &amp;dofs) const</div><div class="ttdoc">Returns indexes of degrees of freedom for i&amp;#39;th boundary element. </div><div class="ttdef"><b>Definition:</b> <a href="pfespace_8cpp_source.html#l00495">pfespace.cpp:495</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af90b0afb96358056d9beae25806dab47"><div class="ttname"><a href="classmfem_1_1Mesh.html#af90b0afb96358056d9beae25806dab47">mfem::Mesh::attributes</a></div><div class="ttdeci">Array&lt; int &gt; attributes</div><div class="ttdoc">A list of all unique element attributes used by the Mesh. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00273">mesh.hpp:273</a></div></div>
<div class="ttc" id="classmfem_1_1ElementTransformation_html_a5603b7b1024b36ba4375a8b4adbd58a2"><div class="ttname"><a href="classmfem_1_1ElementTransformation.html#a5603b7b1024b36ba4375a8b4adbd58a2">mfem::ElementTransformation::mesh</a></div><div class="ttdeci">class Mesh * mesh</div><div class="ttdoc">The Mesh object containing the element. </div><div class="ttdef"><b>Definition:</b> <a href="eltrans_8hpp_source.html#l00084">eltrans.hpp:84</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af438e7d1d688617959f6dbd9e37da407"><div class="ttname"><a href="classmfem_1_1Mesh.html#af438e7d1d688617959f6dbd9e37da407">mfem::Mesh::GetVertexToElementTable</a></div><div class="ttdeci">Table * GetVertexToElementTable()</div><div class="ttdoc">The returned Table must be destroyed by the caller. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l06092">mesh.cpp:6092</a></div></div>
<div class="ttc" id="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TRIANGLE_01_4_html_ac6c42835ae2141eb30177d1a815221c1"><div class="ttname"><a href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1TRIANGLE_01_4.html#ac6c42835ae2141eb30177d1a815221c1">mfem::Geometry::Constants&lt; Geometry::TRIANGLE &gt;::Orient</a></div><div class="ttdeci">static const int Orient[NumOrient][NumVert]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00184">geom.hpp:184</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a78cf1afe79f2f051fe5f0022caee4280"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a78cf1afe79f2f051fe5f0022caee4280">mfem::GroupTopology::Load</a></div><div class="ttdeci">void Load(std::istream &amp;in)</div><div class="ttdoc">Load the data from a stream. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8cpp_source.html#l00284">communication.cpp:284</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6e49b4cc9f9bb3e71c8df2b4714bfb3d"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6e49b4cc9f9bb3e71c8df2b4714bfb3d">mfem::Mesh::UpdateNodes</a></div><div class="ttdeci">void UpdateNodes()</div><div class="ttdoc">Update the nodes of a curved mesh after the topological part of a Mesh::Operation, such as refinement, has been performed. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l08032">mesh.cpp:8032</a></div></div>
<div class="ttc" id="structmfem_1_1Embedding_html"><div class="ttname"><a href="structmfem_1_1Embedding.html">mfem::Embedding</a></div><div class="ttdoc">Defines the position of a fine element within a coarse element. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00049">ncmesh.hpp:49</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_a0f6d9f13065a78d6b1cf87d37e593e32"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#a0f6d9f13065a78d6b1cf87d37e593e32">mfem::GroupTopology::IAmMaster</a></div><div class="ttdeci">bool IAmMaster(int g) const</div><div class="ttdoc">Return true if I am master for group &amp;#39;g&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00164">communication.hpp:164</a></div></div>
<div class="ttc" id="classmfem_1_1ParMesh_html_a2f7246762acc8d5953d82915a87eded9"><div class="ttname"><a href="classmfem_1_1ParMesh.html#a2f7246762acc8d5953d82915a87eded9">mfem::ParMesh::ReorientTetMesh</a></div><div class="ttdeci">MFEM_DEPRECATED void ReorientTetMesh() override</div><div class="ttdoc">See the remarks for the serial version in mesh.hpp. </div><div class="ttdef"><b>Definition:</b> <a href="pmesh_8cpp_source.html#l03269">pmesh.cpp:3269</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6c725958a987520590c8caf69e9c1e62"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6c725958a987520590c8caf69e9c1e62">mfem::Mesh::GreenRefinement</a></div><div class="ttdeci">void GreenRefinement(int i, const DSTable &amp;v_to_v, int *edge1, int *edge2, int *middle)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00365">mesh.hpp:365</a></div></div>
<div class="ttc" id="classmfem_1_1GroupTopology_html_ae9804f24faea02a9a96a5b81aea520a8"><div class="ttname"><a href="classmfem_1_1GroupTopology.html#ae9804f24faea02a9a96a5b81aea520a8">mfem::GroupTopology::GetNumNeighbors</a></div><div class="ttdeci">int GetNumNeighbors() const</div><div class="ttdoc">Return the number of neighbors including the local processor. </div><div class="ttdef"><b>Definition:</b> <a href="communication_8hpp_source.html#l00158">communication.hpp:158</a></div></div>
<div class="ttc" id="classmfem_1_1L2__FECollection_html"><div class="ttname"><a href="classmfem_1_1L2__FECollection.html">mfem::L2_FECollection</a></div><div class="ttdoc">Arbitrary order &quot;L2-conforming&quot; discontinuous finite elements. </div><div class="ttdef"><b>Definition:</b> <a href="fe__coll_8hpp_source.html#l00320">fe_coll.hpp:320</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">mfem::Geometry::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00035">geom.hpp:35</a></div></div>
<div class="ttc" id="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PYRAMID_01_4_html_aeec94acc6b3b1594da8e25b1c50e68c5"><div class="ttname"><a href="structmfem_1_1Geometry_1_1Constants_3_01Geometry_1_1PYRAMID_01_4.html#aeec94acc6b3b1594da8e25b1c50e68c5">mfem::Geometry::Constants&lt; Geometry::PYRAMID &gt;::FaceVert</a></div><div class="ttdeci">static const int FaceVert[NumFaces][MaxFaceVert]</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00296">geom.hpp:296</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab7792af0d6b0ca6464de62677015c6d2"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab7792af0d6b0ca6464de62677015c6d2">mfem::Mesh::NumOfFaces</a></div><div class="ttdeci">int NumOfFaces</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00070">mesh.hpp:70</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 23 2023 16:28:24 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
