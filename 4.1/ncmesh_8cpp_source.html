<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>MFEM: mesh/ncmesh.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="https://cdn.llnl.gov/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM
   &#160;<span id="projectnumber">v4.1.0</span>
   </div>
   <div id="projectbrief">Finite element discretization library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_71786b7bc69a081a150e1a2372e4c3f1.html">mesh</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ncmesh.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ncmesh_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (c) 2010-2020, Lawrence Livermore National Security, LLC. Produced</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// at the Lawrence Livermore National Laboratory. All Rights reserved. See files</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// LICENSE and NOTICE for details. LLNL-CODE-806117.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the MFEM library. For more information and source code</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// availability visit https://mfem.org.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// terms of the BSD-3 license. We welcome feedback and contributions, see file</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// CONTRIBUTING.md for details.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mesh__headers_8hpp.html">mesh_headers.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;../fem/fem.hpp&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;../general/sort_pairs.hpp&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;climits&gt;</span> <span class="comment">// INT_MAX</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span> <span class="comment">// debug</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ncmesh__tables_8hpp.html">ncmesh_tables.hpp</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">namespace </span>mfem</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;NCMesh::GeomInfo <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">NCMesh::GI</a>[<a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>];</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1GeomInfo.html#af8bd69a06325f7b404c0525b30df3502">   30</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#af8bd69a06325f7b404c0525b30df3502">NCMesh::GeomInfo::Initialize</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Element.html">mfem::Element</a>* elem)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5aaaeebb7bf8f3e4975d2ea7b7588f5f">initialized</a>) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a> = elem-&gt;<a class="code" href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">GetNVertices</a>();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a> = elem-&gt;<a class="code" href="classmfem_1_1Element.html#aaf1732b41042d72dcdb835546bace3d3">GetNEdges</a>();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a> = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a7412ab7ae0feb6018148d7a947fa0716">GetNFaces</a>();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; i++)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i][j] = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a2e79b56354be74789e8ca64a7e5883cd">GetEdgeVertices</a>(i)[j];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[i] = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a4f05bd8272240c0b8f47d03a8f7d1b9a">GetNFaceVertices</a>(i);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i][3] = 7; <span class="comment">// invalid node index for 3-node faces</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[i]; j++)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i][j] = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a4cafe67f741771384f4725ed7f4cf8a5">GetFaceVertices</a>(i)[j];</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="comment">// in 2D we pretend to have faces too, so we can use NCMesh::Face::elem[2]</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   <span class="keywordflow">if</span> (!nf)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; i++)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;         <span class="comment">// make a degenerate face</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i][0] = <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i][1] = <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i][0];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i][2] = <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i][3] = <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i][1];</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      nf = <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5aaaeebb7bf8f3e4975d2ea7b7588f5f">initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;}</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab37530e175b27f8da95cab738bfaf59c">   72</a></span>&#160;<a class="code" href="classmfem_1_1NCMesh.html#ab37530e175b27f8da95cab738bfaf59c">NCMesh::NCMesh</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh, std::istream *vertex_parents)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   : <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>(1024, 2048)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a61f9ae762eb6e61a0a2df018d5e90c94">Dimension</a>();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#acf99393a0d32a11cca34ae65980b7848">spaceDim</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ada2086bdd3f3125dfc1b55ce0090695d">SpaceDimension</a>();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <span class="comment">// assume the mesh is anisotropic if we&#39;re loading a file</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a> = vertex_parents ? <span class="keyword">false</span> : <span class="keyword">true</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="comment">// examine elements and reserve the first node IDs for vertices</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <span class="comment">// (note: &#39;mesh&#39; may not have vertices defined yet, e.g., on load)</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   <span class="keywordtype">int</span> max_id = -1;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#af1d1c5110a2cd10105c3ae093c9f7b51">GetNE</a>(); i++)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Element.html">mfem::Element</a> *elem = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa0dd948fe43b96918ea9eabfd29f30ca">GetElement</a>(i);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>(), nv = elem-&gt;<a class="code" href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">GetNVertices</a>();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;         max_id = std::max(max_id, v[j]);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt;= max_id; <span class="keywordtype">id</span>++)</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// top-level nodes are special: id == p1 == p2 == orig. vertex id</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <span class="keywordtype">int</span> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(<span class="keywordtype">id</span>, <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      MFEM_CONTRACT_VAR(node);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      MFEM_ASSERT(node == <span class="keywordtype">id</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;   }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="comment">// if a mesh file is being read, load the vertex hierarchy now;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="comment">// &#39;vertex_parents&#39; must be at the appropriate section in the mesh file</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <span class="keywordflow">if</span> (vertex_parents)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a643c2de4d2ae90eca9672838aebd6d14">LoadVertexParents</a>(*vertex_parents);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3*mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa03c147984578b13beaf10c603487588">GetNV</a>());</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa03c147984578b13beaf10c603487588">GetNV</a>(); i++)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;         std::memcpy(&amp;<a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>[3*i], mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a4d75bf981d1dbb2420598422d4dffcc7">GetVertex</a>(i), 3*<span class="keyword">sizeof</span>(double));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      }</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <span class="comment">// create the NCMesh::Element struct for each Mesh element</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#af1d1c5110a2cd10105c3ae093c9f7b51">GetNE</a>(); i++)</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Element.html">mfem::Element</a> *elem = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#aa0dd948fe43b96918ea9eabfd29f30ca">GetElement</a>(i);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a> = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a873271d869a8aa0413a50ba3f84a4fe2">GetGeometryType</a>();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      MFEM_VERIFY(geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a> || geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a> ||</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                  geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a> || geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a> ||</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                  geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                  <span class="stringliteral">&quot;Element type &quot;</span> &lt;&lt; geom &lt;&lt; <span class="stringliteral">&quot; not supported by NCMesh.&quot;</span>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="comment">// initialize edge/face tables for this type of element</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#af8bd69a06325f7b404c0525b30df3502">Initialize</a>(elem);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="comment">// create our Element struct for this element</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordtype">int</span> root_id = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(geom, elem-&gt;<a class="code" href="classmfem_1_1Element.html#aca7d190fc3cbc6aee75e9e288f836b52">GetAttribute</a>()));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      MFEM_ASSERT(root_id == i, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;root_elem = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[root_id];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *v = elem-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; j++)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;         root_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j] = v[j];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="comment">// increase reference count of all nodes the element is using</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// (NOTE: this will also create and reference all edge nodes and faces)</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a50d302c196f491e537ba4b90bb8a5757">ReferenceElement</a>(root_id);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">// make links from faces back to the element</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ada5cef66827a6ed2955d6897f853328e">RegisterFaces</a>(root_id);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <span class="comment">// store boundary element attributes</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ad207cd78e4d4cf8732938c7226a66f58">GetNBE</a>(); i++)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Element.html">mfem::Element</a> *be = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a072de140d33089ffaff2d016a48137ba">GetBdrElement</a>(i);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *v = be-&gt;<a class="code" href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">GetVertices</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordflow">if</span> (be-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68">mfem::Element::QUADRILATERAL</a>)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(v[0], v[1], v[2], v[3]);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;         MFEM_VERIFY(face, <span class="stringliteral">&quot;boundary face not found.&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;         face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = be-&gt;<a class="code" href="classmfem_1_1Element.html#aca7d190fc3cbc6aee75e9e288f836b52">GetAttribute</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (be-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">mfem::Element::TRIANGLE</a>)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(v[0], v[1], v[2]);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         MFEM_VERIFY(face, <span class="stringliteral">&quot;boundary face not found.&quot;</span>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;         face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = be-&gt;<a class="code" href="classmfem_1_1Element.html#aca7d190fc3cbc6aee75e9e288f836b52">GetAttribute</a>();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (be-&gt;<a class="code" href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">GetType</a>() == <a class="code" href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2">mfem::Element::SEGMENT</a>)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(v[0], v[0], v[1], v[1]);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         MFEM_VERIFY(face, <span class="stringliteral">&quot;boundary face not found.&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = be-&gt;<a class="code" href="classmfem_1_1Element.html#aca7d190fc3cbc6aee75e9e288f836b52">GetAttribute</a>();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;Unsupported boundary element geometry.&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;   }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <span class="keywordflow">if</span> (!vertex_parents) <span class="comment">// i.e., not loading mesh from a file</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a902bc877ac5ae36802f5540d5ad3bcf8">InitRootState</a>(mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#af1d1c5110a2cd10105c3ae093c9f7b51">GetNE</a>());</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae4dfc79d23b8ae298504f35e8dfdcdf2">InitGeomFlags</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">Update</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#acf2b6b143cdecba5e9f05f39b87d560d">  188</a></span>&#160;<a class="code" href="classmfem_1_1NCMesh.html#ab37530e175b27f8da95cab738bfaf59c">NCMesh::NCMesh</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1NCMesh.html">NCMesh</a> &amp;other)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;   : Dim(other.Dim)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   , spaceDim(other.spaceDim)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;   , Iso(other.Iso)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;   , Geoms(other.Geoms)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   , nodes(other.nodes)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;   , faces(other.faces)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;   , elements(other.elements)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;   , shadow(1024, 2048)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;{</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;   other.<a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a94260d1bd2800d7912b35e372a5cf7e3">Copy</a>(<a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   other.<a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a94260d1bd2800d7912b35e372a5cf7e3">Copy</a>(<a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   other.<a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>.<a class="code" href="classmfem_1_1Array.html#a94260d1bd2800d7912b35e372a5cf7e3">Copy</a>(<a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">Update</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae4dfc79d23b8ae298504f35e8dfdcdf2">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ae4dfc79d23b8ae298504f35e8dfdcdf2">NCMesh::InitGeomFlags</a>()</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a6cd4a8f03e1f476f953f4f72bbe27f7e">Geoms</a> = 0;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a6cd4a8f03e1f476f953f4f72bbe27f7e">Geoms</a> |= (1 &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[i].Geom());</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;   }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">  213</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">NCMesh::Update</a>()</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#af6a595c367e485f7c913617931bd6fa3">UpdateLeafElements</a>();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae0f0e73c140a3ada22fb00151860bd08">UpdateVertices</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">Clear</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a8735be51233ecbfd04a6ad4866480273">  225</a></span>&#160;<a class="code" href="classmfem_1_1NCMesh.html#a8735be51233ecbfd04a6ad4866480273">NCMesh::~NCMesh</a>()</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef MFEM_USE_MPI</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor"></span>   <span class="comment">// in parallel, update &#39;leaf_elements&#39;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size(); i++)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[i].rank = 0; <span class="comment">// make sure all leaves are in leaf_elements</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;   }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#af6a595c367e485f7c913617931bd6fa3">UpdateLeafElements</a>();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   <span class="comment">// sign off of all faces and nodes</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> elemFaces;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      elemFaces.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ad15b9629acb977820834b2d18e82887c">UnreferenceElement</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i], elemFaces);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a312b400d5c21f539cbec01f81e4ba813">DeleteUnusedFaces</a>(elemFaces);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <span class="comment">// NOTE: in release mode, we just throw away all faces and nodes at once</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor"></span>}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1Node.html#a090b58d9aeb08b4b7dff10f3bbb74d18">  249</a></span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a090b58d9aeb08b4b7dff10f3bbb74d18">NCMesh::Node::~Node</a>()</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;{</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;   MFEM_ASSERT(!<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#ad0e734911a34827252537528a81c0cc1">vert_refc</a> &amp;&amp; !<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a7108f596104c940792b0a71fa085d812">edge_refc</a>, <span class="stringliteral">&quot;node was not unreffed properly, &quot;</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;               <span class="stringliteral">&quot;vert_refc: &quot;</span> &lt;&lt; (<span class="keywordtype">int</span>) <a class="code" href="structmfem_1_1NCMesh_1_1Node.html#ad0e734911a34827252537528a81c0cc1">vert_refc</a> &lt;&lt; <span class="stringliteral">&quot;, edge_refc: &quot;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;               &lt;&lt; (<span class="keywordtype">int</span>) <a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a7108f596104c940792b0a71fa085d812">edge_refc</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a5291a9d4b39abb9378f0106b0c66626c">  256</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a5291a9d4b39abb9378f0106b0c66626c">NCMesh::ReparentNode</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span> new_p1, <span class="keywordtype">int</span> new_p2)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;{</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node];</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <span class="keywordtype">int</span> old_p1 = nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a>, old_p2 = nd.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="comment">// assign new parents</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Reparent(node, new_p1, new_p2);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>.FindId(old_p1, old_p2) &lt; 0,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;               <span class="stringliteral">&quot;shadow node already exists&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="comment">// store old parent pair temporarily in &#39;shadow&#39;</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;   <span class="keywordtype">int</span> sh = <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>.GetId(old_p1, old_p2);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>[sh].vert_index = node;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">  272</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">NCMesh::FindMidEdgeNode</a>(<span class="keywordtype">int</span> node1, <span class="keywordtype">int</span> node2)<span class="keyword"> const</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;   <span class="keywordtype">int</span> mid = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(node1, node2);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;   <span class="keywordflow">if</span> (mid &lt; 0 &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>.Size())</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;   {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">// if (anisotropic) refinement is underway, some nodes may temporarily</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// be available under alternate parents (see ReparentNode)</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      mid = <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>.FindId(node1, node2);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">if</span> (mid &gt;= 0)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;         mid = <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>[mid].vert_index; <span class="comment">// index of the original node</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;   }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   <span class="keywordflow">return</span> mid;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">  288</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">NCMesh::GetMidEdgeNode</a>(<span class="keywordtype">int</span> node1, <span class="keywordtype">int</span> node2)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;   <span class="keywordtype">int</span> mid = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(node1, node2);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;   <span class="keywordflow">if</span> (mid &lt; 0) { mid = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(node1, node2); } <span class="comment">// create if not found</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;   <span class="keywordflow">return</span> mid;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">  295</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">NCMesh::GetMidFaceNode</a>(<span class="keywordtype">int</span> en1, <span class="keywordtype">int</span> en2, <span class="keywordtype">int</span> en3, <span class="keywordtype">int</span> en4)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;{</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   <span class="comment">// mid-face node can be created either from (en1, en3) or from (en2, en4)</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;   <span class="keywordtype">int</span> midf = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(en1, en3);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   <span class="keywordflow">if</span> (midf &gt;= 0) { <span class="keywordflow">return</span> midf; }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(en2, en4);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a50d302c196f491e537ba4b90bb8a5757">  303</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a50d302c196f491e537ba4b90bb8a5757">NCMesh::ReferenceElement</a>(<span class="keywordtype">int</span> elem)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;{</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;   <span class="keywordtype">int</span>* node = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="comment">// reference all vertices</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; i++)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;   {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[i]].vert_refc++;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;   }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="comment">// reference all edges (possibly creating their nodes)</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; i++)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i];</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Get(node[ev[0]], node[ev[1]])-&gt;edge_refc++;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   <span class="comment">// get all faces (possibly creating them)</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.GetId(node[fv[0]], node[fv[1]], node[fv[2]], node[fv[3]]);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="comment">// NOTE: face-&gt;RegisterElement called separately to avoid having</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="comment">// to store 3 element indices  temporarily in the face when refining.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <span class="comment">// See also NCMesh::RegisterFaces.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;   }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;}</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ad15b9629acb977820834b2d18e82887c">  334</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ad15b9629acb977820834b2d18e82887c">NCMesh::UnreferenceElement</a>(<span class="keywordtype">int</span> elem, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;elemFaces)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;{</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;   <span class="keywordtype">int</span>* node = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <span class="comment">// unreference all faces</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordtype">int</span> face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.FindId(node[fv[0]], node[fv[1]],</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                              node[fv[2]], node[fv[3]]);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      MFEM_ASSERT(face &gt;= 0, <span class="stringliteral">&quot;face not found.&quot;</span>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[face].ForgetElement(elem);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// NOTE: faces.Delete() called later to avoid destroying and</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// recreating faces during refinement, see NCMesh::DeleteUnusedFaces.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      elemFaces.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;   <span class="comment">// unreference all edges (possibly destroying them)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; i++)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i];</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordtype">int</span> enode = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(node[ev[0]], node[ev[1]]);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      MFEM_ASSERT(enode &gt;= 0, <span class="stringliteral">&quot;edge not found.&quot;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      MFEM_ASSERT(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.IdExists(enode), <span class="stringliteral">&quot;edge does not exist.&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[enode].UnrefEdge())</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Delete(enode);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <span class="comment">// unreference all vertices (possibly destroying them)</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; i++)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[i]].UnrefVertex())</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Delete(node[i]);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;   }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ada5cef66827a6ed2955d6897f853328e">  377</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ada5cef66827a6ed2955d6897f853328e">NCMesh::RegisterFaces</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">int</span>* fattr)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#aba5477e5a86ff703ae1ccdad4728081f">GetFace</a>(el, i);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      MFEM_ASSERT(face, <span class="stringliteral">&quot;face not found.&quot;</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a616b9884255409166ce5984241da3059">RegisterElement</a>(elem);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">if</span> (fattr) { face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr[i]; }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a312b400d5c21f539cbec01f81e4ba813">  391</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a312b400d5c21f539cbec01f81e4ba813">NCMesh::DeleteUnusedFaces</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;elemFaces)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; elemFaces.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[elemFaces[i]].Unused())</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Delete(elemFaces[i]);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1Face.html#a616b9884255409166ce5984241da3059">  402</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a616b9884255409166ce5984241da3059">NCMesh::Face::RegisterElement</a>(<span class="keywordtype">int</span> e)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;{</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordflow">if</span> (elem[0] &lt; 0) { elem[0] = e; }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem[1] &lt; 0) { elem[1] = e; }</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="keywordflow">else</span> { MFEM_ABORT(<span class="stringliteral">&quot;can&#39;t have 3 elements in Face::elem[].&quot;</span>); }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;}</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1Face.html#a193fa55ea20cd64f604c78542fcdcaa5">  409</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a193fa55ea20cd64f604c78542fcdcaa5">NCMesh::Face::ForgetElement</a>(<span class="keywordtype">int</span> e)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;{</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="keywordflow">if</span> (elem[0] == e) { elem[0] = -1; }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem[1] == e) { elem[1] = -1; }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="keywordflow">else</span> { MFEM_ABORT(<span class="stringliteral">&quot;element &quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; not found in Face::elem[].&quot;</span>); }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aba5477e5a86ff703ae1ccdad4728081f">  416</a></span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html">NCMesh::Face</a>* <a class="code" href="classmfem_1_1NCMesh.html#aba5477e5a86ff703ae1ccdad4728081f">NCMesh::GetFace</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;elem, <span class="keywordtype">int</span> face_no)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[(int) elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a>];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[face_no];</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="keywordtype">int</span>* node = elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(node[fv[0]], node[fv[1]], node[fv[2]], node[fv[3]]);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;}</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">  424</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">NCMesh::Face::GetSingleElement</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;   <span class="keywordflow">if</span> (elem[0] &gt;= 0)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      MFEM_ASSERT(elem[1] &lt; 0, <span class="stringliteral">&quot;not a single element face.&quot;</span>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">return</span> elem[0];</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      MFEM_ASSERT(elem[1] &gt;= 0, <span class="stringliteral">&quot;no elements in face.&quot;</span>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <span class="keywordflow">return</span> elem[1];</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;   }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">//// Refinement ////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1Element.html#a742e8e8aae7e3ff2988691e4ec1023e2">  441</a></span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a742e8e8aae7e3ff2988691e4ec1023e2">NCMesh::Element::Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>, <span class="keywordtype">int</span> attr)</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   : geom(geom), ref_type(0), tet_type(0), flag(0), <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>(-1)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   , rank(0), attribute(attr), parent(-1)</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++) { <a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = -1; }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="comment">// NOTE: in 2D the 8-element node/child arrays are not optimal, however,</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="comment">// testing shows we would only save 17% of the total NCMesh memory if</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   <span class="comment">// 4-element arrays were used (e.g. through templates); we thus prefer to</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="comment">// keep the code as simple as possible.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">  453</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NCMesh::NewHexahedron</a>(<span class="keywordtype">int</span> n0, <span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2, <span class="keywordtype">int</span> n3,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                          <span class="keywordtype">int</span> n4, <span class="keywordtype">int</span> n5, <span class="keywordtype">int</span> n6, <span class="keywordtype">int</span> n7,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                          <span class="keywordtype">int</span> attr,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                          <span class="keywordtype">int</span> fattr0, <span class="keywordtype">int</span> fattr1, <span class="keywordtype">int</span> fattr2,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                          <span class="keywordtype">int</span> fattr3, <span class="keywordtype">int</span> fattr4, <span class="keywordtype">int</span> fattr5)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   <span class="comment">// create new unrefined element, initialize nodes</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;   <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>, attr));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[new_id];</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[0] = n0, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[1] = n1, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[2] = n2, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[3] = n3;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[4] = n4, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[5] = n5, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[6] = n6, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[7] = n7;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;   <span class="comment">// get faces and assign face attributes</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* f[6];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi_hex = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>];</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi_hex.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;   {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi_hex.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      f[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Get(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                       el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]]);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   f[0]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr0,  f[1]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr1;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   f[2]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr2,  f[3]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr3;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   f[4]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr4,  f[5]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr5;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <span class="keywordflow">return</span> new_id;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">  483</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NCMesh::NewWedge</a>(<span class="keywordtype">int</span> n0, <span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                     <span class="keywordtype">int</span> n3, <span class="keywordtype">int</span> n4, <span class="keywordtype">int</span> n5,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                     <span class="keywordtype">int</span> attr,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                     <span class="keywordtype">int</span> fattr0, <span class="keywordtype">int</span> fattr1,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                     <span class="keywordtype">int</span> fattr2, <span class="keywordtype">int</span> fattr3, <span class="keywordtype">int</span> fattr4)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;{</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   <span class="comment">// create new unrefined element, initialize nodes</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>, attr));</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[new_id];</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[0] = n0, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[1] = n1, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[2] = n2;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[3] = n3, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[4] = n4, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[5] = n5;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="comment">// get faces and assign face attributes</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* f[5];</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi_wedge = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>];</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi_wedge.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;   {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi_wedge.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      f[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Get(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                       el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]]);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;   f[0]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   f[1]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr1;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;   f[2]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr2;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;   f[3]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr3;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;   f[4]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr4;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;   <span class="keywordflow">return</span> new_id;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">  515</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NCMesh::NewTetrahedron</a>(<span class="keywordtype">int</span> n0, <span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2, <span class="keywordtype">int</span> n3, <span class="keywordtype">int</span> attr,</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                           <span class="keywordtype">int</span> fattr0, <span class="keywordtype">int</span> fattr1, <span class="keywordtype">int</span> fattr2, <span class="keywordtype">int</span> fattr3)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="comment">// create new unrefined element, initialize nodes</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;   <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>, attr));</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[new_id];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[0] = n0, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[1] = n1, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[2] = n2, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[3] = n3;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   <span class="comment">// get faces and assign face attributes</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* f[4];</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi_tet = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi_tet.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi_tet.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      f[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Get(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]]);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;   }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   f[0]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr0;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;   f[1]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr1;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;   f[2]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr2;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;   f[3]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = fattr3;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="keywordflow">return</span> new_id;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">  541</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NCMesh::NewQuadrilateral</a>(<span class="keywordtype">int</span> n0, <span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2, <span class="keywordtype">int</span> n3,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                             <span class="keywordtype">int</span> attr,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                             <span class="keywordtype">int</span> eattr0, <span class="keywordtype">int</span> eattr1, <span class="keywordtype">int</span> eattr2, <span class="keywordtype">int</span> eattr3)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;{</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;   <span class="comment">// create new unrefined element, initialize nodes</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>, attr));</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[new_id];</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[0] = n0, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[1] = n1, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[2] = n2, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[3] = n3;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="comment">// get (degenerate) faces and assign face attributes</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* f[4];</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi_quad = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>];</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi_quad.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi_quad.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      f[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Get(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                       el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]]);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   f[0]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr0,  f[1]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr1;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   f[2]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr2,  f[3]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr3;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="keywordflow">return</span> new_id;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">  567</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">NCMesh::NewTriangle</a>(<span class="keywordtype">int</span> n0, <span class="keywordtype">int</span> n1, <span class="keywordtype">int</span> n2,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        <span class="keywordtype">int</span> attr, <span class="keywordtype">int</span> eattr0, <span class="keywordtype">int</span> eattr1, <span class="keywordtype">int</span> eattr2)</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="comment">// create new unrefined element, initialize nodes</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>, attr));</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[new_id];</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[0] = n0, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[1] = n1, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[2] = n2;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="comment">// get (degenerate) faces and assign face attributes</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* f[3];</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi_tri = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi_tri.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi_tri.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      f[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Get(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                       el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]]);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   f[0]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr0;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   f[1]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr1;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   f[2]-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> = eattr2;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="keywordflow">return</span> new_id;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;}</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="namespacemfem.html#a67e7a0fda75e3e06b69d5ef218f8b2b5">  592</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a67e7a0fda75e3e06b69d5ef218f8b2b5">CubeFaceLeft</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;{ <span class="keywordflow">return</span> node == n[0] || node == n[3] || node == n[4] || node == n[7]; }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="namespacemfem.html#a839d3a7984f1c355ace995961b486f18">  595</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a839d3a7984f1c355ace995961b486f18">CubeFaceRight</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;{ <span class="keywordflow">return</span> node == n[1] || node == n[2] || node == n[5] || node == n[6]; }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="namespacemfem.html#a9996e1e72dfb50224ea762b5a5b81e62">  598</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a9996e1e72dfb50224ea762b5a5b81e62">CubeFaceFront</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;{ <span class="keywordflow">return</span> node == n[0] || node == n[1] || node == n[4] || node == n[5]; }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="namespacemfem.html#a5835b1a237cb964604b52bc3a84f95e1">  601</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a5835b1a237cb964604b52bc3a84f95e1">CubeFaceBack</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;{ <span class="keywordflow">return</span> node == n[2] || node == n[3] || node == n[6] || node == n[7]; }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="namespacemfem.html#a40e1a9b833ee3d3cae4145bb3b267333">  604</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a40e1a9b833ee3d3cae4145bb3b267333">CubeFaceBottom</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{ <span class="keywordflow">return</span> node == n[0] || node == n[1] || node == n[2] || node == n[3]; }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="namespacemfem.html#af7011f8797a2fd1a474c1567c538aa86">  607</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#af7011f8797a2fd1a474c1567c538aa86">CubeFaceTop</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;{ <span class="keywordflow">return</span> node == n[4] || node == n[5] || node == n[6] || node == n[7]; }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">  610</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">PrismFaceBottom</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;{ <span class="keywordflow">return</span> node == n[0] || node == n[1] || node == n[2]; }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">  613</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">PrismFaceTop</a>(<span class="keywordtype">int</span> node, <span class="keywordtype">int</span>* n)</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;{ <span class="keywordflow">return</span> node == n[3] || node == n[4] || node == n[5]; }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a93a9e86595e6b4d6ad5b08d3841cbc98">  617</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a93a9e86595e6b4d6ad5b08d3841cbc98">NCMesh::ForceRefinement</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3, <span class="keywordtype">int</span> vn4)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;   <span class="comment">// get the element this face belongs to</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(vn1, vn2, vn3, vn4);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="keywordflow">if</span> (!face) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <span class="keywordtype">int</span> elem = face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">GetSingleElement</a>();</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   MFEM_ASSERT(!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>, <span class="stringliteral">&quot;element already refined.&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <span class="keywordtype">int</span>* <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a> = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// schedule the right split depending on face orientation</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="namespacemfem.html#a67e7a0fda75e3e06b69d5ef218f8b2b5">CubeFaceLeft</a>(vn1, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a839d3a7984f1c355ace995961b486f18">CubeFaceRight</a>(vn2, nodes)) ||</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          (<a class="code" href="namespacemfem.html#a67e7a0fda75e3e06b69d5ef218f8b2b5">CubeFaceLeft</a>(vn2, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a839d3a7984f1c355ace995961b486f18">CubeFaceRight</a>(vn1, nodes)))</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(elem, 1)); <span class="comment">// X split</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespacemfem.html#a9996e1e72dfb50224ea762b5a5b81e62">CubeFaceFront</a>(vn1, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a5835b1a237cb964604b52bc3a84f95e1">CubeFaceBack</a>(vn2, nodes)) ||</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;               (<a class="code" href="namespacemfem.html#a9996e1e72dfb50224ea762b5a5b81e62">CubeFaceFront</a>(vn2, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a5835b1a237cb964604b52bc3a84f95e1">CubeFaceBack</a>(vn1, nodes)))</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(elem, 2)); <span class="comment">// Y split</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespacemfem.html#a40e1a9b833ee3d3cae4145bb3b267333">CubeFaceBottom</a>(vn1, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#af7011f8797a2fd1a474c1567c538aa86">CubeFaceTop</a>(vn2, nodes)) ||</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;               (<a class="code" href="namespacemfem.html#a40e1a9b833ee3d3cae4145bb3b267333">CubeFaceBottom</a>(vn2, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#af7011f8797a2fd1a474c1567c538aa86">CubeFaceTop</a>(vn1, nodes)))</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(elem, 4)); <span class="comment">// Z split</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;Inconsistent element/face structure.&quot;</span>);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">PrismFaceTop</a>(vn1, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">PrismFaceBottom</a>(vn4, nodes)) ||</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          (<a class="code" href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">PrismFaceTop</a>(vn4, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">PrismFaceBottom</a>(vn1, nodes)))</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(elem, 3)); <span class="comment">// XY split</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">PrismFaceTop</a>(vn1, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">PrismFaceBottom</a>(vn2, nodes)) ||</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;               (<a class="code" href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">PrismFaceTop</a>(vn2, nodes) &amp;&amp; <a class="code" href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">PrismFaceBottom</a>(vn1, nodes)))</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      {</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(elem, 4)); <span class="comment">// Z split</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;Inconsistent element/face structure.&quot;</span>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;   {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Unsupported geometry.&quot;</span>)</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;}</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a6db73bae7fda9aef6dd839dd237e21f3">  675</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a6db73bae7fda9aef6dd839dd237e21f3">NCMesh::FindEdgeElements</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3, <span class="keywordtype">int</span> vn4,</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                              <a class="code" href="classmfem_1_1Array.html">Array&lt;MeshId&gt;</a> &amp;elem_edge)<span class="keyword"> const</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="comment">// Assuming that f = (vn1, vn2, vn3, vn4) is a quad face and</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   <span class="comment">// e = (vn1, vn4) is its edge, this function finds the N elements</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <span class="comment">// sharing e, and returns the N different MeshIds of the edge (i.e.,</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   <span class="comment">// different element-local pairs describing the edge).</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;   <span class="keywordtype">int</span> ev1 = vn1, ev2 = vn4;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;   <span class="comment">// follow face refinement towards &#39;vn1&#39;, get an existing face</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;   <span class="keywordtype">int</span> split, mid[5];</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   <span class="keywordflow">while</span> ((split = <a class="code" href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e">QuadFaceSplitType</a>(vn1, vn2, vn3, vn4, mid)) &gt; 0)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="keywordflow">if</span> (split == 1) <span class="comment">// vertical</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         vn2 = mid[0]; vn3 = mid[2];</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      }</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// horizontal</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;         vn3 = mid[1]; vn4 = mid[3];</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a> *face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(vn1, vn2, vn3, vn4);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   MFEM_ASSERT(face != NULL, <span class="stringliteral">&quot;Face not found: &quot;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;               &lt;&lt; vn1 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; vn2 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; vn3 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; vn4</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; (edge &quot;</span> &lt;&lt; ev1 &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ev2 &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="keywordtype">int</span> elem = face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">GetSingleElement</a>();</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="keywordtype">int</span> local = <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem], vn1);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> cousins;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a6f17fc9b7fe7f861ed146b9c12d711fe">FindVertexCousins</a>(elem, local, cousins);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;   elem_edge.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cousins.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      local = <a class="code" href="classmfem_1_1NCMesh.html#a3b5f570f87003bca08f366ee279b19cf">find_element_edge</a>(<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[cousins[i]], ev1, ev2, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      <span class="keywordflow">if</span> (local &gt; 0)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;         elem_edge.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a>(-1, cousins[i], local, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>));</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;}</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a63d2470bbec7b28dd9bdb1a7eba1c6eb">  722</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a63d2470bbec7b28dd9bdb1a7eba1c6eb">NCMesh::CheckAnisoPrism</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3, <span class="keywordtype">int</span> vn4,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                             <span class="keyword">const</span> <a class="code" href="structmfem_1_1Refinement.html">Refinement</a> *refs, <span class="keywordtype">int</span> nref)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a> buf[4];</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;MeshId&gt;</a> eid(buf, 4);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a6db73bae7fda9aef6dd839dd237e21f3">FindEdgeElements</a>(vn1, vn2, vn3, vn4, eid);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="comment">// see if there is an element that has not been force-refined yet</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, j; i &lt; eid.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordtype">int</span> elem = eid[i].element;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nref; j++)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;         <span class="keywordflow">if</span> (refs[j].<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> == elem) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      }</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">if</span> (j == nref) <span class="comment">// elem not found in refs[]</span></div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      {</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;         <span class="comment">// schedule prism refinement along Z axis</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;         MFEM_ASSERT(<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem].Geom() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(elem, 4));</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">  747</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">NCMesh::CheckAnisoFace</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3, <span class="keywordtype">int</span> vn4,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                            <span class="keywordtype">int</span> mid12, <span class="keywordtype">int</span> mid34, <span class="keywordtype">int</span> level)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;{</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;   <span class="comment">// When a face is getting split anisotropically (without loss of generality</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;   <span class="comment">// we assume a &quot;vertical&quot; split here, see picture), it is important to make</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   <span class="comment">// sure that the mid-face vertex node (midf) has mid34 and mid12 as parents.</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;   <span class="comment">// This is necessary for the face traversal algorithm and at places like</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="comment">// Refine() that assume the mid-edge nodes to be accessible through the right</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   <span class="comment">// parents. However, midf may already exist under the parents mid41 and</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   <span class="comment">// mid23. In that case we need to &quot;reparent&quot; midf, i.e., reinsert it to the</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="comment">// hash-table under the correct parents. This doesn&#39;t affect other nodes as</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="comment">// all IDs stay the same, only the face refinement &quot;tree&quot; is affected.</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <span class="comment">//</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="comment">//                     vn4      mid34      vn3</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <span class="comment">//                        *------*------*</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">//                        |      |      |</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <span class="comment">//                        |      |midf  |</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <span class="comment">//                  mid41 *- - - *- - - * mid23</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="comment">//                        |      |      |</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <span class="comment">//                        |      |      |</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;   <span class="comment">//                        *------*------*</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <span class="comment">//                    vn1      mid12      vn2</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="comment">//</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="comment">// This function is recursive, because the above applies to any node along</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   <span class="comment">// the middle vertical edge. The function calls itself again for the bottom</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;   <span class="comment">// and upper half of the above picture.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;   <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(vn2, vn3);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   <span class="keywordtype">int</span> mid41 = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(vn4, vn1);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;   <span class="keywordflow">if</span> (mid23 &gt;= 0 &amp;&amp; mid41 &gt;= 0)</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   {</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      <span class="keywordtype">int</span> midf = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(mid23, mid41);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <span class="keywordflow">if</span> (midf &gt;= 0)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a62e52da15fef484c22a6a63a55324c1a">reparents</a>.Append(<a class="code" href="classmfem_1_1Triple.html">Triple&lt;int, int, int&gt;</a>(midf, mid12, mid34));</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;         <span class="keywordtype">int</span> rs = <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Size();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(vn1, vn2, mid23, mid41, mid12, midf, level+1);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(mid41, mid23, vn3, vn4, midf, mid34, level+1);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ae6fb3d0a6bb5a292fb5bcae8c116f0bf">HavePrisms</a>() &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[midf].HasEdge())</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;         {</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="comment">// Check if there is a prism with edge (mid23, mid41) that we may</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="comment">// have missed in &#39;CheckAnisoFace&#39;, and force-refine it if present.</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Size() &gt; rs)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a63d2470bbec7b28dd9bdb1a7eba1c6eb">CheckAnisoPrism</a>(mid23, vn3, vn4, mid41,</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                               &amp;<a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>[rs], <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Size() - rs);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a63d2470bbec7b28dd9bdb1a7eba1c6eb">CheckAnisoPrism</a>(mid23, vn3, vn4, mid41, NULL, 0);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;         }</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;         <span class="comment">// perform the reparents all at once at the end</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         <span class="keywordflow">if</span> (level == 0)</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;         {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a62e52da15fef484c22a6a63a55324c1a">reparents</a>.Size(); i++)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;               <span class="keyword">const</span> <a class="code" href="classmfem_1_1Triple.html">Triple&lt;int, int, int&gt;</a> &amp;tr = <a class="code" href="classmfem_1_1NCMesh.html#a62e52da15fef484c22a6a63a55324c1a">reparents</a>[i];</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a5291a9d4b39abb9378f0106b0c66626c">ReparentNode</a>(tr.<a class="code" href="classmfem_1_1Triple.html#adbdb3b87212f05e20f71bdf9bd0c2306">one</a>, tr.<a class="code" href="classmfem_1_1Triple.html#a3ed46ed614c1bee6dd0b71c30e905eb9">two</a>, tr.<a class="code" href="classmfem_1_1Triple.html#a3e6931ad67b30ff75c3a66aab786fa66">three</a>);</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a62e52da15fef484c22a6a63a55324c1a">reparents</a>.DeleteAll();</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;         <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <span class="comment">// Also, this is the place where forced refinements begin. In the picture</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <span class="comment">// above, edges mid12-midf and midf-mid34 should actually exist in the</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <span class="comment">// neighboring elements, otherwise the mesh is inconsistent and needs to be</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="comment">// fixed. Example: suppose an element is being refined isotropically (!)</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;   <span class="comment">// whose neighbors across some face look like this:</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   <span class="comment">//</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   <span class="comment">//                         *--------*--------*</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;   <span class="comment">//                         |   d    |    e   |</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   <span class="comment">//                         *--------*--------*</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   <span class="comment">//                         |      c          |</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;   <span class="comment">//                         *--------*--------*</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   <span class="comment">//                         |        |        |</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="comment">//                         |   a    |    b   |</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="comment">//                         |        |        |</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   <span class="comment">//                         *--------*--------*</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   <span class="comment">//</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;   <span class="comment">// Element &#39;c&#39; needs to be refined vertically for the mesh to remain valid.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;   <span class="keywordflow">if</span> (level &gt; 0)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a93a9e86595e6b4d6ad5b08d3841cbc98">ForceRefinement</a>(vn1, vn2, vn3, vn4);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;   }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;}</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">  842</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">NCMesh::CheckIsoFace</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3, <span class="keywordtype">int</span> vn4,</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                          <span class="keywordtype">int</span> en1, <span class="keywordtype">int</span> en2, <span class="keywordtype">int</span> en3, <span class="keywordtype">int</span> en4, <span class="keywordtype">int</span> midf)</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;{</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a>)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;   {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="comment">/* If anisotropic refinements are present in the mesh, we need to check</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">         isotropically split faces as well, see second comment in</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">         CheckAnisoFace above. */</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(vn1, vn2, en2, en4, en1, midf);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(en4, en2, vn3, vn4, midf, en3);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(vn4, vn1, en1, en3, en4, midf);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(en3, en1, vn2, vn3, midf, en2);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;   }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;}</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a8f84e1390b55bdcaed1cd413c20f72c8">  859</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a8f84e1390b55bdcaed1cd413c20f72c8">NCMesh::RefineElement</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">char</span> ref_type)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;{</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;   <span class="keywordflow">if</span> (!ref_type) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;   <span class="comment">// handle elements that may have been (force-) refined already</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;   {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordtype">char</span> remaining = ref_type &amp; ~el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="comment">// do the remaining splits on the children</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;         <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0) { <a class="code" href="classmfem_1_1NCMesh.html#a8f84e1390b55bdcaed1cd413c20f72c8">RefineElement</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i], remaining); }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;   }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;   <span class="comment">/*mfem::out &lt;&lt; &quot;Refining element &quot; &lt;&lt; elem &lt;&lt; &quot; (&quot;</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">             &lt;&lt; el.node[0] &lt;&lt; &quot;, &quot; &lt;&lt; el.node[1] &lt;&lt; &quot;, &quot;</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">             &lt;&lt; el.node[2] &lt;&lt; &quot;, &quot; &lt;&lt; el.node[3] &lt;&lt; &quot;, &quot;</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="comment">             &lt;&lt; el.node[4] &lt;&lt; &quot;, &quot; &lt;&lt; el.node[5] &lt;&lt; &quot;, &quot;</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">             &lt;&lt; el.node[6] &lt;&lt; &quot;, &quot; &lt;&lt; el.node[7] &lt;&lt; &quot;), &quot;</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">             &lt;&lt; &quot;ref_type &quot; &lt;&lt; int(ref_type) &lt;&lt; std::endl;*/</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;   <span class="keywordtype">int</span>* no = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   <span class="keywordtype">int</span> attr = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#aea98bd2662eb60edfce0ed01f98085b8">attribute</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;   <span class="keywordtype">int</span> child[8];</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++) { child[i] = -1; }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;   <span class="comment">// get parent&#39;s face attributes</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;   <span class="keywordtype">int</span> fa[6];</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;   {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(no[fv[0]], no[fv[1]], no[fv[2]], no[fv[3]]);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      fa[i] = face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;   }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;   <span class="comment">// create child elements</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;   {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="comment">// Vertex numbering is assumed to be as follows:</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="comment">//       7             6</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      <span class="comment">//        +-----------+                Faces: 0 bottom</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="comment">//       /|          /|                       1 front</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      <span class="comment">//    4 / |       5 / |                       2 right</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="comment">//     +-----------+  |                       3 back</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="comment">//     |  |        |  |                       4 left</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="comment">//     |  +--------|--+                       5 top</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      <span class="comment">//     | / 3       | / 2       Z Y</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="comment">//     |/          |/          |/</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="comment">//     +-----------+           *--X</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="comment">//    0             1</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      <span class="keywordflow">if</span> (ref_type == 1) <span class="comment">// split along X axis</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;         <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[3]);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;         <span class="keywordtype">int</span> mid45 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[4], no[5]);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;         <span class="keywordtype">int</span> mid67 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[6], no[7]);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], mid01, mid23, no[3],</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                  no[4], mid45, mid67, no[7], attr,</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                  fa[0], fa[1], -1, fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid01, no[1], no[2], mid23,</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                  mid45, no[5], no[6], mid67, attr,</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                  fa[0], fa[1], fa[2], fa[3], -1, fa[5]);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[0], no[1], no[5], no[4], mid01, mid45);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[2], no[3], no[7], no[6], mid23, mid67);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[4], no[5], no[6], no[7], mid45, mid67);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[3], no[2], no[1], no[0], mid23, mid01);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 2) <span class="comment">// split along Y axis</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      {</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;         <span class="keywordtype">int</span> mid30 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[0]);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;         <span class="keywordtype">int</span> mid56 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[5], no[6]);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;         <span class="keywordtype">int</span> mid74 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[7], no[4]);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], no[1], mid12, mid30,</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                                  no[4], no[5], mid56, mid74, attr,</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                  fa[0], fa[1], fa[2], -1, fa[4], fa[5]);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid30, mid12, no[2], no[3],</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                  mid74, mid56, no[6], no[7], attr,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                  fa[0], -1, fa[2], fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[1], no[2], no[6], no[5], mid12, mid56);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[3], no[0], no[4], no[7], mid30, mid74);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[5], no[6], no[7], no[4], mid56, mid74);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[0], no[3], no[2], no[1], mid30, mid12);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 4) <span class="comment">// split along Z axis</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;         <span class="keywordtype">int</span> mid04 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[4]);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;         <span class="keywordtype">int</span> mid15 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[5]);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;         <span class="keywordtype">int</span> mid26 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[6]);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;         <span class="keywordtype">int</span> mid37 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[7]);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], no[1], no[2], no[3],</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                                  mid04, mid15, mid26, mid37, attr,</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                  fa[0], fa[1], fa[2], fa[3], fa[4], -1);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid04, mid15, mid26, mid37,</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                                  no[4], no[5], no[6], no[7], attr,</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                                  -1, fa[1], fa[2], fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[4], no[0], no[1], no[5], mid04, mid15);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[5], no[1], no[2], no[6], mid15, mid26);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[6], no[2], no[3], no[7], mid26, mid37);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[7], no[3], no[0], no[4], mid37, mid04);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 3) <span class="comment">// XY split</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;      {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;         <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[3]);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;         <span class="keywordtype">int</span> mid30 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[0]);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;         <span class="keywordtype">int</span> mid45 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[4], no[5]);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;         <span class="keywordtype">int</span> mid56 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[5], no[6]);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;         <span class="keywordtype">int</span> mid67 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[6], no[7]);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;         <span class="keywordtype">int</span> mid74 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[7], no[4]);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;         <span class="keywordtype">int</span> midf0 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid23, mid12, mid01, mid30);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         <span class="keywordtype">int</span> midf5 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid45, mid56, mid67, mid74);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], mid01, midf0, mid30,</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                  no[4], mid45, midf5, mid74, attr,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                  fa[0], fa[1], -1, -1, fa[4], fa[5]);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid01, no[1], mid12, midf0,</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                  mid45, no[5], mid56, midf5, attr,</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                  fa[0], fa[1], fa[2], -1, -1, fa[5]);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midf0, mid12, no[2], mid23,</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                                  midf5, mid56, no[6], mid67, attr,</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                                  fa[0], -1, fa[2], fa[3], -1, fa[5]);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid30, midf0, mid23, no[3],</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                                  mid74, midf5, mid67, no[7], attr,</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                  fa[0], -1, -1, fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[0], no[1], no[5], no[4], mid01, mid45);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[1], no[2], no[6], no[5], mid12, mid56);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[2], no[3], no[7], no[6], mid23, mid67);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[3], no[0], no[4], no[7], mid30, mid74);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[3], no[2], no[1], no[0], mid23, mid12, mid01, mid30, midf0);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[4], no[5], no[6], no[7], mid45, mid56, mid67, mid74, midf5);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 5) <span class="comment">// XZ split</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;         <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[3]);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;         <span class="keywordtype">int</span> mid45 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[4], no[5]);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;         <span class="keywordtype">int</span> mid67 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[6], no[7]);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;         <span class="keywordtype">int</span> mid04 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[4]);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;         <span class="keywordtype">int</span> mid15 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[5]);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;         <span class="keywordtype">int</span> mid26 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[6]);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;         <span class="keywordtype">int</span> mid37 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[7]);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;         <span class="keywordtype">int</span> midf1 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid01, mid15, mid45, mid04);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;         <span class="keywordtype">int</span> midf3 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid23, mid37, mid67, mid26);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], mid01, mid23, no[3],</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                                  mid04, midf1, midf3, mid37, attr,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                  fa[0], fa[1], -1, fa[3], fa[4], -1);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid01, no[1], no[2], mid23,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                  midf1, mid15, mid26, midf3, attr,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                  fa[0], fa[1], fa[2], fa[3], -1, -1);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midf1, mid15, mid26, midf3,</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                  mid45, no[5], no[6], mid67, attr,</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                  -1, fa[1], fa[2], fa[3], -1, fa[5]);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid04, midf1, midf3, mid37,</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                                  no[4], mid45, mid67, no[7], attr,</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                  -1, fa[1], -1, fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[3], no[2], no[1], no[0], mid23, mid01);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[2], no[6], no[5], no[1], mid26, mid15);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[6], no[7], no[4], no[5], mid67, mid45);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[7], no[3], no[0], no[4], mid37, mid04);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[0], no[1], no[5], no[4], mid01, mid15, mid45, mid04, midf1);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[2], no[3], no[7], no[6], mid23, mid37, mid67, mid26, midf3);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 6) <span class="comment">// YZ split</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;         <span class="keywordtype">int</span> mid30 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[0]);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;         <span class="keywordtype">int</span> mid56 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[5], no[6]);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;         <span class="keywordtype">int</span> mid74 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[7], no[4]);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;         <span class="keywordtype">int</span> mid04 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[4]);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;         <span class="keywordtype">int</span> mid15 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[5]);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;         <span class="keywordtype">int</span> mid26 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[6]);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;         <span class="keywordtype">int</span> mid37 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[7]);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;         <span class="keywordtype">int</span> midf2 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid12, mid26, mid56, mid15);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;         <span class="keywordtype">int</span> midf4 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid30, mid04, mid74, mid37);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], no[1], mid12, mid30,</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                  mid04, mid15, midf2, midf4, attr,</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                  fa[0], fa[1], fa[2], -1, fa[4], -1);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid30, mid12, no[2], no[3],</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                  midf4, midf2, mid26, mid37, attr,</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                  fa[0], -1, fa[2], fa[3], fa[4], -1);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid04, mid15, midf2, midf4,</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                  no[4], no[5], mid56, mid74, attr,</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                  -1, fa[1], fa[2], -1, fa[4], fa[5]);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midf4, midf2, mid26, mid37,</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                  mid74, mid56, no[6], no[7], attr,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                                  -1, -1, fa[2], fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[4], no[0], no[1], no[5], mid04, mid15);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[0], no[3], no[2], no[1], mid30, mid12);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[3], no[7], no[6], no[2], mid37, mid26);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[7], no[4], no[5], no[6], mid74, mid56);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[1], no[2], no[6], no[5], mid12, mid26, mid56, mid15, midf2);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[3], no[0], no[4], no[7], mid30, mid04, mid74, mid37, midf4);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 7) <span class="comment">// full isotropic refinement</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;         <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[3]);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;         <span class="keywordtype">int</span> mid30 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[0]);</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;         <span class="keywordtype">int</span> mid45 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[4], no[5]);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;         <span class="keywordtype">int</span> mid56 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[5], no[6]);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;         <span class="keywordtype">int</span> mid67 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[6], no[7]);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         <span class="keywordtype">int</span> mid74 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[7], no[4]);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;         <span class="keywordtype">int</span> mid04 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[4]);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;         <span class="keywordtype">int</span> mid15 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[5]);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;         <span class="keywordtype">int</span> mid26 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[6]);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;         <span class="keywordtype">int</span> mid37 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[7]);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;         <span class="keywordtype">int</span> midf0 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid23, mid12, mid01, mid30);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;         <span class="keywordtype">int</span> midf1 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid01, mid15, mid45, mid04);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;         <span class="keywordtype">int</span> midf2 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid12, mid26, mid56, mid15);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;         <span class="keywordtype">int</span> midf3 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid23, mid37, mid67, mid26);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;         <span class="keywordtype">int</span> midf4 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid30, mid04, mid74, mid37);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;         <span class="keywordtype">int</span> midf5 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid45, mid56, mid67, mid74);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;         <span class="keywordtype">int</span> midel = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(midf1, midf3);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(no[0], mid01, midf0, mid30,</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                  mid04, midf1, midel, midf4, attr,</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                                  fa[0], fa[1], -1, -1, fa[4], -1);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid01, no[1], mid12, midf0,</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                                  midf1, mid15, midf2, midel, attr,</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                  fa[0], fa[1], fa[2], -1, -1, -1);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midf0, mid12, no[2], mid23,</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                                  midel, midf2, mid26, midf3, attr,</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                                  fa[0], -1, fa[2], fa[3], -1, -1);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid30, midf0, mid23, no[3],</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                                  midf4, midel, midf3, mid37, attr,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                                  fa[0], -1, -1, fa[3], fa[4], -1);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;         child[4] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(mid04, midf1, midel, midf4,</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                  no[4], mid45, midf5, mid74, attr,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                  -1, fa[1], -1, -1, fa[4], fa[5]);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         child[5] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midf1, mid15, midf2, midel,</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                  mid45, no[5], mid56, midf5, attr,</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                  -1, fa[1], fa[2], -1, -1, fa[5]);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;         child[6] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midel, midf2, mid26, midf3,</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                  midf5, mid56, no[6], mid67, attr,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                  -1, -1, fa[2], fa[3], -1, fa[5]);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;         child[7] = <a class="code" href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">NewHexahedron</a>(midf4, midel, midf3, mid37,</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                  mid74, midf5, mid67, no[7], attr,</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                  -1, -1, -1, fa[3], fa[4], fa[5]);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[3], no[2], no[1], no[0], mid23, mid12, mid01, mid30, midf0);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[0], no[1], no[5], no[4], mid01, mid15, mid45, mid04, midf1);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[1], no[2], no[6], no[5], mid12, mid26, mid56, mid15, midf2);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[2], no[3], no[7], no[6], mid23, mid37, mid67, mid26, midf3);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[3], no[0], no[4], no[7], mid30, mid04, mid74, mid37, midf4);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[4], no[5], no[6], no[7], mid45, mid56, mid67, mid74, midf5);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      }</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;      {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;invalid refinement type.&quot;</span>);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordflow">if</span> (ref_type != 7) { <a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a> = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;   }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>)</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;   {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="comment">// Wedge vertex numbering:</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="comment">//          5</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="comment">//         _+_</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="comment">//       _/ | \_                    Faces: 0 bottom</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      <span class="comment">//    3 /   |   \ 4                        1 top</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="comment">//     +---------+                         2 front</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="comment">//     |    |    |                         3 right (1 2 5 4)</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">//     |   _+_   |                         4 left (2 0 3 5)</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      <span class="comment">//     | _/ 2 \_ |           Z  Y</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="comment">//     |/       \|           | /</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="comment">//     +---------+           *--X</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      <span class="comment">//    0           1</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keywordflow">if</span> (ref_type &lt; 4) <span class="comment">// XY refinement (split in 4 wedges)</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;         ref_type = 3; <span class="comment">// for consistence</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;         <span class="keywordtype">int</span> mid20 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[0]);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         <span class="keywordtype">int</span> mid34 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[4]);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;         <span class="keywordtype">int</span> mid45 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[4], no[5]);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         <span class="keywordtype">int</span> mid53 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[5], no[3]);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(no[0], mid01, mid20,</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                             no[3], mid34, mid53, attr,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                             fa[0], fa[1], fa[2], -1, fa[4]);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid01, no[1], mid12,</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                             mid34, no[4], mid45, attr,</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                             fa[0], fa[1], fa[2], fa[3], -1);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid20, mid12, no[2],</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                             mid53, mid45, no[5], attr,</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                             fa[0], fa[1], -1, fa[3], fa[4]);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid12, mid20, mid01,</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                             mid45, mid53, mid34, attr,</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                             fa[0], fa[1], -1, -1, -1);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[0], no[1], no[4], no[3], mid01, mid34);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[1], no[2], no[5], no[4], mid12, mid45);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[2], no[0], no[3], no[5], mid20, mid53);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 4) <span class="comment">// Z refinement only (split in 2 wedges)</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;         <span class="keywordtype">int</span> mid03 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[3]);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;         <span class="keywordtype">int</span> mid14 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[4]);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;         <span class="keywordtype">int</span> mid25 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[5]);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(no[0], no[1], no[2],</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                             mid03, mid14, mid25, attr,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                             fa[0], -1, fa[2], fa[3], fa[4]);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid03, mid14, mid25,</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                             no[3], no[4], no[5], attr,</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                             -1, fa[1], fa[2], fa[3], fa[4]);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[3], no[0], no[1], no[4], mid03, mid14);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[4], no[1], no[2], no[5], mid14, mid25);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">CheckAnisoFace</a>(no[5], no[2], no[0], no[3], mid25, mid03);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      }</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type &gt; 4) <span class="comment">// full isotropic refinement (split in 8 wedges)</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;         ref_type = 7; <span class="comment">// for consistence</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;         <span class="keywordtype">int</span> mid20 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[0]);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;         <span class="keywordtype">int</span> mid34 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[3], no[4]);</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;         <span class="keywordtype">int</span> mid45 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[4], no[5]);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;         <span class="keywordtype">int</span> mid53 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[5], no[3]);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;         <span class="keywordtype">int</span> mid03 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[3]);</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;         <span class="keywordtype">int</span> mid14 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[4]);</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;         <span class="keywordtype">int</span> mid25 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[5]);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;         <span class="keywordtype">int</span> midf2 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid01, mid14, mid34, mid03);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;         <span class="keywordtype">int</span> midf3 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid12, mid25, mid45, mid14);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;         <span class="keywordtype">int</span> midf4 = <a class="code" href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">GetMidFaceNode</a>(mid20, mid03, mid53, mid25);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(no[0], mid01, mid20,</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                             mid03, midf2, midf4, attr,</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                             fa[0], -1, fa[2], -1, fa[4]);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid01, no[1], mid12,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                             midf2, mid14, midf3, attr,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                             fa[0], -1, fa[2], fa[3], -1);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid20, mid12, no[2],</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                             midf4, midf3, mid25, attr,</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                             fa[0], -1, -1, fa[3], fa[4]);</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid12, mid20, mid01,</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                             midf3, midf4, midf2, attr,</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                             fa[0], -1, -1, -1, -1);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;         child[4] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(mid03, midf2, midf4,</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                             no[3], mid34, mid53, attr,</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                             -1, fa[1], fa[2], -1, fa[4]);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;         child[5] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(midf2, mid14, midf3,</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                             mid34, no[4], mid45, attr,</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                             -1, fa[1], fa[2], fa[3], -1);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;         child[6] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(midf4, midf3, mid25,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                             mid53, mid45, no[5], attr,</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                             -1, fa[1], -1, fa[3], fa[4]);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;         child[7] = <a class="code" href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">NewWedge</a>(midf3, midf4, midf2,</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                             mid45, mid53, mid34, attr,</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                             -1, fa[1], -1, -1, -1);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[0], no[1], no[4], no[3], mid01, mid14, mid34, mid03, midf2);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[1], no[2], no[5], no[4], mid12, mid25, mid45, mid14, midf3);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">CheckIsoFace</a>(no[2], no[0], no[3], no[5], mid20, mid03, mid53, mid25, midf4);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;invalid refinement type.&quot;</span>);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      }</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">if</span> (ref_type != 7) { <a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a> = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;   }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;   {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="comment">// Tetrahedron vertex numbering:</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="comment">//    3</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="comment">//     +                         Faces: 0 back (1, 2, 3)</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;      <span class="comment">//     |\\_                             1 left (0, 3, 2)</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;      <span class="comment">//     ||  \_                           2 front (0, 1, 3)</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="comment">//     | \   \_                         3 bottom (0, 1, 2)</span></div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <span class="comment">//     |  +__  \_</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="comment">//     | /2  \__ \_       Z  Y</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;      <span class="comment">//     |/       \__\      | /</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="comment">//     +------------+     *--X</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      <span class="comment">//    0              1</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      ref_type = 7; <span class="comment">// for consistence</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[1]);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[2]);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keywordtype">int</span> mid02 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[0]);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordtype">int</span> mid03 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[0], no[3]);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordtype">int</span> mid13 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[1], no[3]);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">GetMidEdgeNode</a>(no[2], no[3]);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      child[0] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(no[0], mid01, mid02, mid03, attr,</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                                -1, fa[1], fa[2], fa[3]);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      child[1] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid01, no[1], mid12, mid13, attr,</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                fa[0], -1, fa[2], fa[3]);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      child[2] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid02, mid12, no[2], mid23, attr,</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                fa[0], fa[1], -1, fa[3]);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      child[3] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid03, mid13, mid23, no[3], attr,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                fa[0], fa[1], fa[2], -1);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;      <span class="comment">// There are three ways to split the inner octahedron. A good strategy is</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;      <span class="comment">// to use the shortest diagonal. At the moment we don&#39;t have the geometric</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="comment">// information in this class to determine which diagonal is the shortest,</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="comment">// but it seems that with reasonable shapes of the coarse tets and MFEM&#39;s</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="comment">// default tet orientation, always using tet_type == 0 produces stable</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="comment">// refinements. Types 1 and 2 are unused for now.</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6e218801d53e2b1a3cdb68a9128e5079">tet_type</a> = 0;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6e218801d53e2b1a3cdb68a9128e5079">tet_type</a> == 0) <span class="comment">// shortest diagonal mid01--mid23</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;         child[4] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid01, mid23, mid02, mid03, attr,</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                   fa[1], -1, -1, -1);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;         child[5] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid01, mid23, mid03, mid13, attr,</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                   -1, fa[2], -1, -1);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;         child[6] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid01, mid23, mid13, mid12, attr,</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                   fa[0], -1, -1, -1);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;         child[7] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid01, mid23, mid12, mid02, attr,</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                   -1, fa[3], -1, -1);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6e218801d53e2b1a3cdb68a9128e5079">tet_type</a> == 1) <span class="comment">// shortest diagonal mid12--mid03</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;         child[4] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid03, mid01, mid02, mid12, attr,</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                   fa[3], -1, -1, -1);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;         child[5] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid03, mid02, mid23, mid12, attr,</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                   -1, -1, -1, fa[1]);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;         child[6] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid03, mid23, mid13, mid12, attr,</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                   fa[0], -1, -1, -1);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;         child[7] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid03, mid13, mid01, mid12, attr,</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                   -1, -1, -1, fa[2]);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// el.tet_type == 2, shortest diagonal mid02--mid13</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;         child[4] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid02, mid01, mid13, mid03, attr,</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                   fa[2], -1, -1, -1);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;         child[5] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid02, mid03, mid13, mid23, attr,</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                   -1, -1, fa[1], -1);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;         child[6] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid02, mid23, mid13, mid12, attr,</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                   fa[0], -1, -1, -1);</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;         child[7] = <a class="code" href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">NewTetrahedron</a>(mid02, mid12, mid13, mid01, attr,</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                                   -1, -1, fa[3], -1);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;   }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;   {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;      ref_type &amp;= 0x3; <span class="comment">// ignore Z bit</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keywordflow">if</span> (ref_type == 1) <span class="comment">// X split</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[0], no[1]);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;         <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[2], no[3]);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(no[0], mid01, mid23, no[3],</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                     attr, fa[0], -1, fa[2], fa[3]);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(mid01, no[1], no[2], mid23,</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                                     attr, fa[0], fa[1], fa[2], -1);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 2) <span class="comment">// Y split</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      {</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[1], no[2]);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;         <span class="keywordtype">int</span> mid30 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[3], no[0]);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(no[0], no[1], mid12, mid30,</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                     attr, fa[0], fa[1], -1, fa[3]);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(mid30, mid12, no[2], no[3],</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                     attr, -1, fa[1], fa[2], fa[3]);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 3) <span class="comment">// iso split</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      {</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;         <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[0], no[1]);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;         <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[1], no[2]);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;         <span class="keywordtype">int</span> mid23 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[2], no[3]);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;         <span class="keywordtype">int</span> mid30 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[3], no[0]);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;         <span class="keywordtype">int</span> midel = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(mid01, mid23);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;         child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(no[0], mid01, midel, mid30,</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                                     attr, fa[0], -1, -1, fa[3]);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;         child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(mid01, no[1], mid12, midel,</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                                     attr, fa[0], fa[1], -1, -1);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;         child[2] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(midel, mid12, no[2], mid23,</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                                     attr, -1, fa[1], fa[2], -1);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;         child[3] = <a class="code" href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">NewQuadrilateral</a>(mid30, midel, mid23, no[3],</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                                     attr, -1, -1, fa[2], fa[3]);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;Invalid refinement type.&quot;</span>);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="keywordflow">if</span> (ref_type != 3) { <a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a> = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;   }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>)</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;   {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      ref_type = 3; <span class="comment">// for consistence</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      <span class="comment">// isotropic split - the only ref_type available for triangles</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordtype">int</span> mid01 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[0], no[1]);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordtype">int</span> mid12 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[1], no[2]);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordtype">int</span> mid20 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.GetId(no[2], no[0]);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      child[0] = <a class="code" href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">NewTriangle</a>(no[0], mid01, mid20, attr, fa[0], -1, fa[2]);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      child[1] = <a class="code" href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">NewTriangle</a>(mid01, no[1], mid12, attr, fa[0], fa[1], -1);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;      child[2] = <a class="code" href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">NewTriangle</a>(mid20, mid12, no[2], attr, -1, fa[1], fa[2]);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      child[3] = <a class="code" href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">NewTriangle</a>(mid12, mid20, mid01, attr, -1, -1, -1);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;   }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;   {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Unsupported element geometry.&quot;</span>);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;   }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;   <span class="comment">// start using the nodes of the children, create edges &amp; faces</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; child[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a50d302c196f491e537ba4b90bb8a5757">ReferenceElement</a>(child[i]);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;   }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;   <span class="keywordtype">int</span> buf[6];</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> parentFaces(buf, 6);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;   parentFaces.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;   <span class="comment">// sign off of all nodes of the parent, clean up unused nodes, but keep faces</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ad15b9629acb977820834b2d18e82887c">UnreferenceElement</a>(elem, parentFaces);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;   <span class="comment">// register the children in their faces</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; child[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;   {</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ada5cef66827a6ed2955d6897f853328e">RegisterFaces</a>(child[i]);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;   }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;   <span class="comment">// clean up parent faces, if unused</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a312b400d5c21f539cbec01f81e4ba813">DeleteUnusedFaces</a>(parentFaces);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;   <span class="comment">// make the children inherit our rank; set the parent element</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; child[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;   {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[i]];</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a> = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a>;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">parent</a> = elem;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;   }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;   <span class="comment">// finish the refinement</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> = ref_type;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;   std::memcpy(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>, child, <span class="keyword">sizeof</span>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>));</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;}</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div>
<div class="line"><a name="l01492"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#af2de6a703ab8986d06a9269f1d562b76"> 1492</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#af2de6a703ab8986d06a9269f1d562b76">NCMesh::Refine</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;Refinement&gt;</a>&amp; refinements)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;{</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;   <span class="comment">// push all refinements on the stack in reverse order</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Reserve(refinements.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>());</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = refinements.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>()-1; i &gt;= 0; i--)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;   {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1Refinement.html">Refinement</a>&amp; ref = refinements[i];</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Append(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[ref.<a class="code" href="structmfem_1_1Refinement.html#a384f0346a131fcf3a9c40d223e376b9d">index</a>], ref.<a class="code" href="structmfem_1_1Refinement.html#a0824689ac239cd12c39657e4ad3e4644">ref_type</a>));</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;   }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;   <span class="comment">// keep refining as long as the stack contains something</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;   <span class="keywordtype">int</span> nforced = 0;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;   <span class="keywordflow">while</span> (<a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Size())</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;   {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <a class="code" href="structmfem_1_1Refinement.html">Refinement</a> ref = <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Last();</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.DeleteLast();</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="keywordtype">int</span> size = <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Size();</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a8f84e1390b55bdcaed1cd413c20f72c8">RefineElement</a>(ref.<a class="code" href="structmfem_1_1Refinement.html#a384f0346a131fcf3a9c40d223e376b9d">index</a>, ref.<a class="code" href="structmfem_1_1Refinement.html#a0824689ac239cd12c39657e4ad3e4644">ref_type</a>);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      nforced += <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.Size() - size;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;   }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;   <span class="comment">/* TODO: the current algorithm of forced refinements is not optimal. As</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">      forced refinements spread through the mesh, some may not be necessary</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">      in the end, since the affected elements may still be scheduled for</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">      refinement that could stop the propagation. We should introduce the</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">      member Element::ref_pending that would show the intended refinement in</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">      the batch. A forced refinement would be combined with ref_pending to</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">      (possibly) stop the propagation earlier.</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">      Update: what about a FIFO instead of ref_stack? */</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="preprocessor">#if defined(MFEM_DEBUG) &amp;&amp; !defined(MFEM_USE_MPI)</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="preprocessor"></span>   <a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot;Refined &quot;</span> &lt;&lt; refinements.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt;&lt; <span class="stringliteral">&quot; + &quot;</span> &lt;&lt; nforced</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; elements&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.DeleteAll();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">shadow</a>.DeleteAll();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">Update</a>();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;}</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">//// Derefinement //////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc"> 1538</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc">NCMesh::RetrieveNode</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el, <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;{</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;   <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>) { <span class="keywordflow">return</span> el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>]; }</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;   <span class="comment">// need to retrieve node from a child element (there is always a child</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;   <span class="comment">// that inherited the parent&#39;s corner under the same index)</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;   <span class="keywordtype">int</span> ch;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;   <span class="keywordflow">switch</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>())</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;   {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>:</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;         ch = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[hex_deref_table[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> - 1][<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>]];</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>:</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;         ch = prism_deref_table[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> - 1][<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>];</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;         MFEM_ASSERT(ch != -1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;         ch = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[ch];</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>:</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;         ch = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[quad_deref_table[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> - 1][<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>]];</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>:</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>:</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;         ch = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>];</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;         ch = 0; <span class="comment">// suppress compiler warning</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;Unsupported element geometry.&quot;</span>);</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;   }</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc">RetrieveNode</a>(<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[ch], index);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;}</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div>
<div class="line"><a name="l01574"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#af134176d2bc3db50d4d3ee610ccd7bd6"> 1574</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#af134176d2bc3db50d4d3ee610ccd7bd6">NCMesh::DerefineElement</a>(<span class="keywordtype">int</span> elem)</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;{</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;   <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;   <span class="keywordtype">int</span> child[8];</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;   std::memcpy(child, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>, <span class="keyword">sizeof</span>(child));</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <span class="comment">// first make sure that all children are leaves, derefine them if not</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; child[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;   {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[i]].ref_type)</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      {</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#af134176d2bc3db50d4d3ee610ccd7bd6">DerefineElement</a>(child[i]);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;   }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;   <span class="keywordtype">int</span> fa[6];</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;   <span class="keywordtype">int</span> rt1 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> - 1;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++) { el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = -1; }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;   <span class="comment">// retrieve original corner nodes and face attributes from the children</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>)</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;   {</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[hex_deref_table[rt1][i]]];</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i];</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;      }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++)</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[hex_deref_table[rt1][i + 8]]];</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;         fa[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                            ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]])-&gt;attribute;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      }</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;   }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;   {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      MFEM_ASSERT(prism_deref_table[rt1][0] != -1, <span class="stringliteral">&quot;invalid prism refinement&quot;</span>);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[prism_deref_table[rt1][i]]];</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i];</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[6] = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[7] = -1;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; i++)</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;      {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[prism_deref_table[rt1][i + 6]]];</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;         fa[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                            ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]])-&gt;attribute;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;   }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;   {</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>&amp; ch1 = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[i]];</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>&amp; ch2 = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[(i+1) &amp; 0x3]];</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = ch1.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i];</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;         fa[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(ch2.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], ch2.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                            ch2.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], ch2.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]])-&gt;attribute;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;      }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;   {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[quad_deref_table[rt1][i]]];</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i];</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      {</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[quad_deref_table[rt1][i + 4]]];</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;         fa[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                            ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]])-&gt;attribute;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      }</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;   }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>)</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;   {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>&amp; ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[i]];</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] = ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i];</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;         fa[i] = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                            ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]])-&gt;attribute;</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;   }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;   {</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Unsupported element geometry.&quot;</span>);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;   }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   <span class="comment">// sign in to all nodes</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a50d302c196f491e537ba4b90bb8a5757">ReferenceElement</a>(elem);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;   <span class="keywordtype">int</span> buf[8*6];</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> childFaces(buf, 8*6);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;   childFaces.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;   <span class="comment">// delete children, determine rank</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a> = INT_MAX;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; child[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;   {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a> = std::min(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a>, <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[child[i]].rank);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#ad15b9629acb977820834b2d18e82887c">UnreferenceElement</a>(child[i], childFaces);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a098aa084b66fd0f4fdf30e25ff522645">FreeElement</a>(child[i]);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;   }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ada5cef66827a6ed2955d6897f853328e">RegisterFaces</a>(elem, fa);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   <span class="comment">// delete unused faces</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;   childFaces.<a class="code" href="classmfem_1_1Array.html#a370c68671fe785d87d9bf2b5b1f4b152">Sort</a>();</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;   childFaces.<a class="code" href="classmfem_1_1Array.html#aab5094e73ef3cc50816b8f6122b33bba">Unique</a>();</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a312b400d5c21f539cbec01f81e4ba813">DeleteUnusedFaces</a>(childFaces);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> = 0;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;}</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a8ab8b2b634477c27d33094bb19e10ffd"> 1700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a8ab8b2b634477c27d33094bb19e10ffd">NCMesh::CollectDerefinements</a>(<span class="keywordtype">int</span> elem, <a class="code" href="classmfem_1_1Array.html">Array&lt;Connection&gt;</a> &amp;list)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;{</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;   <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;   <span class="keywordtype">int</span> total = 0, ref = 0, ghost = 0;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;   {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      total++;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i]];</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="keywordflow">if</span> (ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>) { ref++; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a453021f5db847ddb6b3374a4b20e2d05">IsGhost</a>(ch)) { ghost++; }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;   <span class="keywordflow">if</span> (!ref &amp;&amp; ghost &lt; total)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;   {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;      <span class="comment">// can be derefined, add to list</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <span class="keywordtype">int</span> next_row = list.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() ? (list.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>().from + 1) : 0;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      {</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i]];</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;         list.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="structmfem_1_1Connection.html">Connection</a>(next_row, ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>));</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      }</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;   }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;   {</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a8ab8b2b634477c27d33094bb19e10ffd">CollectDerefinements</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i], list);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;   }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;}</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div>
<div class="line"><a name="l01733"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae86d604004fdde2ac62d7ad82cdb11b8"> 1733</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">Table</a>&amp; <a class="code" href="classmfem_1_1NCMesh.html#ae86d604004fdde2ac62d7ad82cdb11b8">NCMesh::GetDerefinementTable</a>()</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;{</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Connection&gt;</a> list;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;   list.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>());</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;   {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a8ab8b2b634477c27d33094bb19e10ffd">CollectDerefinements</a>(i, list);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;   }</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;   <span class="keywordtype">int</span> size = list.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() ? (list.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>().from + 1) : 0;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">derefinements</a>.<a class="code" href="classmfem_1_1Table.html#ada741de79bb4fc473a307a9d7d05a9f6">MakeFromList</a>(size, list);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">derefinements</a>;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div>
<div class="line"><a name="l01748"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#adf2b80cd1f59b280d19f154fd6cb8e91"> 1748</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#adf2b80cd1f59b280d19f154fd6cb8e91">NCMesh::CheckDerefinementNCLevel</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;deref_table,</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;                                      <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;level_ok, <span class="keywordtype">int</span> max_nc_level)</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;{</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;   level_ok.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(deref_table.<a class="code" href="classmfem_1_1Table.html#a5e312e3907089115194dceef2d0c81c5">Size</a>());</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; deref_table.<a class="code" href="classmfem_1_1Table.html#a5e312e3907089115194dceef2d0c81c5">Size</a>(); i++)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;   {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fine = deref_table.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(i), size = deref_table.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(i);</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;parent = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[fine[0]]].parent];</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="keywordtype">int</span> ok = 1;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; size; j++)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;      {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;         <span class="keywordtype">int</span> splits[3];</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a81d95f8c25fc3480d13762f709ceb8fe">CountSplits</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[fine[j]], splits);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>; k++)</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;         {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;            <span class="keywordflow">if</span> ((parent.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> &amp; (1 &lt;&lt; k)) &amp;&amp;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                splits[k] &gt;= max_nc_level)</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            {</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;               ok = 0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            }</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;         }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;         <span class="keywordflow">if</span> (!ok) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      }</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      level_ok[i] = ok;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;   }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;}</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aa9d21a5c05107c9c209a3cce8919a5fc"> 1777</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aa9d21a5c05107c9c209a3cce8919a5fc">NCMesh::Derefine</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;derefs)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;{</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;   MFEM_VERIFY(<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &lt; 3 || <a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a>,</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;               <span class="stringliteral">&quot;derefinement of 3D anisotropic meshes not implemented yet.&quot;</span>);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a712c5717817070bcfab89beee0c74051">InitDerefTransforms</a>();</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> fine_coarse;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a94260d1bd2800d7912b35e372a5cf7e3">Copy</a>(fine_coarse);</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;   <span class="comment">// perform the derefinements</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; derefs.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;   {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;      <span class="keywordtype">int</span> row = derefs[i];</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      MFEM_VERIFY(row &gt;= 0 &amp;&amp; row &lt; <a class="code" href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">derefinements</a>.<a class="code" href="classmfem_1_1Table.html#a5e312e3907089115194dceef2d0c81c5">Size</a>(),</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;                  <span class="stringliteral">&quot;invalid derefinement number.&quot;</span>);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fine = <a class="code" href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">derefinements</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(row);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <span class="keywordtype">int</span> parent = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[fine[0]]].parent;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      <span class="comment">// record the relation of the fine elements to their parent</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a0c847bdc9ee4714829bfb9d2478feb81">SetDerefMatrixCodes</a>(parent, fine_coarse);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#af134176d2bc3db50d4d3ee610ccd7bd6">DerefineElement</a>(parent);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;   }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;   <span class="comment">// update leaf_elements, Element::index etc.</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">Update</a>();</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;   <span class="comment">// link old fine elements to the new coarse elements</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fine_coarse.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;   {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[i].parent = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[fine_coarse[i]].index;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;   }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;}</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div>
<div class="line"><a name="l01813"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a712c5717817070bcfab89beee0c74051"> 1813</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a712c5717817070bcfab89beee0c74051">NCMesh::InitDerefTransforms</a>()</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;{</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;   <span class="keywordtype">int</span> nfine = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;   <span class="comment">// this will tell GetDerefinementTransforms that transforms are not finished</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a33e61c443f5c4bd61647a74959a8e84d">Clear</a>();</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.SetSize(nfine);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nfine; i++)</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;   {</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[i].parent = -1;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[i].matrix = 0;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;   }</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;}</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div>
<div class="line"><a name="l01828"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a0c847bdc9ee4714829bfb9d2478feb81"> 1828</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a0c847bdc9ee4714829bfb9d2478feb81">NCMesh::SetDerefMatrixCodes</a>(<span class="keywordtype">int</span> parent, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;fine_coarse)</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;{</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;   <span class="comment">// encode the ref_type and child number for GetDerefinementTransforms()</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;prn = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[parent];</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; prn.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;   {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;ch = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[prn.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i]];</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keywordflow">if</span> (ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a> &gt;= 0)</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;         <span class="keywordtype">int</span> code = (prn.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> &lt;&lt; 8) | (i &lt;&lt; 4) | prn.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a>;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>].matrix = code;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;         fine_coarse[ch.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>] = parent;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;      }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;   }</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;}</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;<span class="comment">//// Mesh Interface ////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01847"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae0f0e73c140a3ada22fb00151860bd08"> 1847</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ae0f0e73c140a3ada22fb00151860bd08">NCMesh::UpdateVertices</a>()</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;{</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;   <span class="comment">// (overridden in ParNCMesh to assign special indices to ghost vertices)</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">NVertices</a> = 0;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1iterator.html">node_iterator</a> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.begin(); node != <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.end(); ++node)</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;   {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">if</span> (node-&gt;HasVertex()) { node-&gt;vert_index = <a class="code" href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">NVertices</a>++; }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;   }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">NVertices</a>);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">NVertices</a> = 0;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1iterator.html">node_iterator</a> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.begin(); node != <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.end(); ++node)</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;   {</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keywordflow">if</span> (node-&gt;HasVertex()) { <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[<a class="code" href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">NVertices</a>++] = node.index(); }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;   }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;}</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div>
<div class="line"><a name="l01865"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397"> 1865</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397">NCMesh::CollectLeafElements</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> state)</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;{</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;   <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;   {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a> &gt;= 0) <span class="comment">// skip elements beyond ghost layer in parallel</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(elem);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;   }</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;   {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      <span class="comment">// try to order elements along a space-filling curve</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a> &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> == 3)</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;      {</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;         {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            <span class="keywordtype">int</span> ch = quad_hilbert_child_order[state][i];</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="keywordtype">int</span> st = quad_hilbert_child_state[state][i];</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397">CollectLeafElements</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[ch], st);</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;         }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a> &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> == 7)</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;      {</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;         {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            <span class="keywordtype">int</span> ch = hex_hilbert_child_order[state][i];</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            <span class="keywordtype">int</span> st = hex_hilbert_child_state[state][i];</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397">CollectLeafElements</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[ch], st);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;         }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;      }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;         {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0) { <a class="code" href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397">CollectLeafElements</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i], state); }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;         }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      }</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;   }</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;   el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a> = -1;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;}</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;</div>
<div class="line"><a name="l01907"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#af6a595c367e485f7c913617931bd6fa3"> 1907</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#af6a595c367e485f7c913617931bd6fa3">NCMesh::UpdateLeafElements</a>()</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;{</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;   <span class="comment">// collect leaf elements from all roots</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;   {</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397">CollectLeafElements</a>(i, <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>[i]);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;   }</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a1a66b8c36823d7660121861430e335cf">AssignLeafIndices</a>();</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;}</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div>
<div class="line"><a name="l01918"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a1a66b8c36823d7660121861430e335cf"> 1918</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a1a66b8c36823d7660121861430e335cf">NCMesh::AssignLeafIndices</a>()</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;{</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;   <span class="comment">// (overridden in ParNCMesh to handle ghost elements)</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;   {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]].index = i;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;   }</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;}</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;</div>
<div class="line"><a name="l01927"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a902bc877ac5ae36802f5540d5ad3bcf8"> 1927</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a902bc877ac5ae36802f5540d5ad3bcf8">NCMesh::InitRootState</a>(<span class="keywordtype">int</span> root_count)</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;{</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(root_count);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a> = 0;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;   <span class="keywordtype">char</span>* node_order;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;   <span class="keywordtype">int</span> nch;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[0].Geom()) <span class="comment">// TODO: mixed meshes</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;   {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>:</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;         nch = 4;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;         node_order = (<span class="keywordtype">char</span>*) quad_hilbert_child_order;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>:</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;         nch = 8;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;         node_order = (<span class="keywordtype">char</span>*) hex_hilbert_child_order;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;         <span class="keywordflow">return</span>; <span class="comment">// do nothing, all states stay zero</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;   <span class="keywordtype">int</span> entry_node = -2;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;   <span class="comment">// process the root element sequence</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; root_count; i++)</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;   {</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[i];</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      <span class="keywordtype">int</span> v_in = <a class="code" href="classmfem_1_1NCMesh.html#a59357a4af171acdb72039db96e5de76f">FindNodeExt</a>(el, entry_node, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;      <span class="keywordflow">if</span> (v_in &lt; 0) { v_in = 0; }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <span class="comment">// determine which nodes are shared with the next element</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;      <span class="keywordtype">bool</span> shared[8] = { 0, 0, 0, 0, 0, 0, 0, 0 };</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keywordflow">if</span> (i+1 &lt; root_count)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;      {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;next = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[i+1];</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nch; j++)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;         {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            <span class="keywordtype">int</span> node = <a class="code" href="classmfem_1_1NCMesh.html#a59357a4af171acdb72039db96e5de76f">FindNodeExt</a>(el, <a class="code" href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc">RetrieveNode</a>(next, j), <span class="keyword">false</span>);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <span class="keywordflow">if</span> (node &gt;= 0) { shared[node] = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;         }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      }</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;      <span class="comment">// select orientation that starts in v_in and exits in shared node</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      <span class="keywordtype">int</span> state = <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>*v_in;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>; j++)</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;         <span class="keywordflow">if</span> (shared[(<span class="keywordtype">int</span>) node_order[nch*(state + j) + nch-1]])</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;         {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            state += j;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;         }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>[i] = state;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      entry_node = <a class="code" href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc">RetrieveNode</a>(el, node_order[nch*state + nch-1]);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;   }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;}</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div>
<div class="line"><a name="l01990"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aed9aab2bb38bacecad378bc472268c5c"> 1990</a></span>&#160;<a class="code" href="classmfem_1_1Element.html">mfem::Element</a>* <a class="code" href="classmfem_1_1NCMesh.html#aed9aab2bb38bacecad378bc472268c5c">NCMesh::NewMeshElement</a>(<span class="keywordtype">int</span> <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;   <span class="keywordflow">switch</span> (geom)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;   {</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>: <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classmfem_1_1Hexahedron.html">mfem::Hexahedron</a>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>: <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classmfem_1_1Wedge.html">mfem::Wedge</a>;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>: <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classmfem_1_1Tetrahedron.html">mfem::Tetrahedron</a>;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>: <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classmfem_1_1Quadrilateral.html">mfem::Quadrilateral</a>;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>: <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classmfem_1_1Triangle.html">mfem::Triangle</a>;</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;   }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;   MFEM_ABORT(<span class="stringliteral">&quot;invalid geometry&quot;</span>);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;   <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;}</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div>
<div class="line"><a name="l02004"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654"> 2004</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>* <a class="code" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">NCMesh::CalcVertexPos</a>(<span class="keywordtype">int</span> node)<span class="keyword"> const</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node];</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;   <span class="keywordflow">if</span> (nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a> == nd.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a>) <span class="comment">// top-level vertex</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;   {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>[3*nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a>];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;   }</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="preprocessor"></span>   <a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html">TmpVertex</a> &amp;tv = <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a>[node]; <span class="comment">// to make DebugDump work</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="preprocessor"></span>   <a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html">TmpVertex</a> &amp;tv = <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a>[nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#afe002bd1fe00597001783e3bfeb54d80">vert_index</a>];</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="preprocessor"></span>   <span class="keywordflow">if</span> (tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a8c023f59572ae21534906345c03913db">valid</a>) { <span class="keywordflow">return</span> tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a74b162a4f4aac4ee12b4d7fba12dee97">pos</a>; }</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;   MFEM_VERIFY(tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a9033ef4e504c10203dfdb2d227c1166f">visited</a> == <span class="keyword">false</span>, <span class="stringliteral">&quot;cyclic vertex dependencies.&quot;</span>);</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;   tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a9033ef4e504c10203dfdb2d227c1166f">visited</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span>* pos1 = <a class="code" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">CalcVertexPos</a>(nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a>);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">double</span>* pos2 = <a class="code" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">CalcVertexPos</a>(nd.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a>);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;   {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a74b162a4f4aac4ee12b4d7fba12dee97">pos</a>[i] = (pos1[i] + pos2[i]) * 0.5;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;   }</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;   tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a8c023f59572ae21534906345c03913db">valid</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;   <span class="keywordflow">return</span> tv.<a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html#a74b162a4f4aac4ee12b4d7fba12dee97">pos</a>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;}</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div>
<div class="line"><a name="l02033"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a7c1030878adb5665d5587fd235aa8047"> 2033</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a7c1030878adb5665d5587fd235aa8047">NCMesh::GetMeshComponents</a>(<a class="code" href="classmfem_1_1Mesh.html">Mesh</a> &amp;mesh)<span class="keyword"> const</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;   mesh.<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.SetSize(<a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>());</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>())</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;   {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="comment">// calculate vertex positions from stored top-level vertex coordinates</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a> = <span class="keyword">new</span> <a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html">TmpVertex</a>[<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds()];</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; mesh.<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>.Size(); i++)</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;      {</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;         mesh.<a class="code" href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">vertices</a>[i].SetCoords(<a class="code" href="classmfem_1_1NCMesh.html#acf99393a0d32a11cca34ae65980b7848">spaceDim</a>, <a class="code" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">CalcVertexPos</a>(<a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[i]));</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a>;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;   }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;   <span class="comment">// NOTE: if the mesh is curved (top_vertex_pos is empty), mesh.vertices are</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;   <span class="comment">// left uninitialized here; they will be initialized later by the Mesh from</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;   <span class="comment">// Nodes -- here we just make sure mesh.vertices has the correct size.</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;   mesh.<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>.SetSize(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() - <a class="code" href="classmfem_1_1NCMesh.html#a99866202164a4896d193bda383e3427d">GetNumGhostElements</a>());</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;   mesh.<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>.SetSize(0);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;   mesh.<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.SetSize(0);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;   <span class="comment">// create an mfem::Element for each leaf Element</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;   {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;nc_elem = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]];</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a453021f5db847ddb6b3374a4b20e2d05">IsGhost</a>(nc_elem)) { <span class="keywordflow">continue</span>; } <span class="comment">// ParNCMesh</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* node = nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[(int) nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a>];</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <a class="code" href="classmfem_1_1Element.html">mfem::Element</a>* elem = mesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a>);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;      mesh.<a class="code" href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">elements</a>.Append(elem);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      elem-&gt;SetAttribute(nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#aea98bd2662eb60edfce0ed01f98085b8">attribute</a>);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; j++)</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;         elem-&gt;GetVertices()[j] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[j]].vert_index;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      }</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="comment">// create boundary elements</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; k++)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[k];</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> nfv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[k];</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;         <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(node[fv[0]], node[fv[1]],</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;                                       node[fv[2]], node[fv[3]]);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;         <span class="keywordflow">if</span> (face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ac617ad0add1cc5dc349515ddc4647680">Boundary</a>())</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;         {</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            <span class="keywordflow">if</span> ((nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a> == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>) ||</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                (nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a> == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a> &amp;&amp; nfv == 4))</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;               <span class="keyword">auto</span>* quad = (<a class="code" href="classmfem_1_1Quadrilateral.html">Quadrilateral</a>*) mesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;               quad-&gt;SetAttribute(face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a>);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 4; j++)</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;               {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                  quad-&gt;GetVertices()[j] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[fv[j]]].vert_index;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;               }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;               mesh.<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.Append(quad);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            }</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a> == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a> ||</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                     nc_elem.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a> == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>)</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;            {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;               MFEM_ASSERT(nfv == 3, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;               <span class="keyword">auto</span>* tri = (<a class="code" href="classmfem_1_1Triangle.html">Triangle</a>*) mesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;               tri-&gt;SetAttribute(face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a>);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 3; j++)</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;               {</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                  tri-&gt;GetVertices()[j] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[fv[j]]].vert_index;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;               }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;               mesh.<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.Append(tri);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            }</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;               <span class="keyword">auto</span>* segment = (<a class="code" href="classmfem_1_1Segment.html">Segment</a>*) mesh.<a class="code" href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">NewElement</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;               segment-&gt;SetAttribute(face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a>);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;               {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                  segment-&gt;GetVertices()[j] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[fv[2*j]]].vert_index;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;               }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;               mesh.<a class="code" href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">boundary</a>.Append(segment);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;         }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;   }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;}</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;</div>
<div class="line"><a name="l02120"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c"> 2120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">NCMesh::OnMeshUpdated</a>(<a class="code" href="classmfem_1_1Mesh.html">Mesh</a> *mesh)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;{</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0ba413eb308e08053bbf1ab2a987fcd0">NEdges</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a23afea537d770acba9004cc8b52b2eea">GetNEdges</a>();</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a3776a06230f8be7daaddbf2b7259a6e8">NFaces</a> = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#ab022e7d065b35d9b2ba7b3cc2b0ccb14">GetNumFaces</a>();</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;   <a class="code" href="classmfem_1_1Table.html">Table</a> *edge_vertex = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a6d617367eb29c399680134231b12a20b">GetEdgeVertexTable</a>();</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;   <span class="comment">// get edge enumeration from the Mesh</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; edge_vertex-&gt;<a class="code" href="classmfem_1_1Table.html#a5e312e3907089115194dceef2d0c81c5">Size</a>(); i++)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;   {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> *ev = edge_vertex-&gt;<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(i);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a>* node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Find(<a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[ev[0]], <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[ev[1]]);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      MFEM_ASSERT(node &amp;&amp; node-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">HasEdge</a>(),</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                  <span class="stringliteral">&quot;edge (&quot;</span> &lt;&lt; ev[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; ev[1] &lt;&lt; <span class="stringliteral">&quot;) not found, &quot;</span></div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                  <span class="stringliteral">&quot;node = &quot;</span> &lt;&lt; node);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      node-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a> = i;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;   }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;   <span class="comment">// get face enumeration from the Mesh, initialize &#39;face_geom&#39;</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a5dd7435aedd532b0135b65cac0a2a89e">face_geom</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1NCMesh.html#a3776a06230f8be7daaddbf2b7259a6e8">NFaces</a>);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a3776a06230f8be7daaddbf2b7259a6e8">NFaces</a>; i++)</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;   {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a1bea8a25d6c6673b122d7e16aca8327d">GetFace</a>(i)-&gt;GetVertices();</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nfv = mesh-&gt;<a class="code" href="classmfem_1_1Mesh.html#a1bea8a25d6c6673b122d7e16aca8327d">GetFace</a>(i)-&gt;GetNVertices();</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* face;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> == 3)</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;         <span class="keywordflow">if</span> (nfv == 4)</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;         {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a5dd7435aedd532b0135b65cac0a2a89e">face_geom</a>[i] = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(<a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[0]], <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[1]],</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                              <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[2]], <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[3]]);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;         }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;         {</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            MFEM_ASSERT(nfv == 3, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a5dd7435aedd532b0135b65cac0a2a89e">face_geom</a>[i] = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(<a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[0]], <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[1]],</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                              <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[2]]);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;         }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;         MFEM_ASSERT(nfv == 2, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a5dd7435aedd532b0135b65cac0a2a89e">face_geom</a>[i] = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;         <span class="keywordtype">int</span> n0 = <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[0]], n1 = <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[fv[1]];</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;         face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(n0, n0, n1, n1); <span class="comment">// look up degenerate face</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="preprocessor"></span>         <span class="comment">// (non-ghost) edge and face numbers must match in 2D</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> *ev = edge_vertex-&gt;<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(i);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;         MFEM_ASSERT((ev[0] == fv[0] &amp;&amp; ev[1] == fv[1]) ||</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                     (ev[1] == fv[0] &amp;&amp; ev[0] == fv[1]), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      MFEM_VERIFY(face, <span class="stringliteral">&quot;face not found.&quot;</span>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a> = i;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;   }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;}</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="comment">//// Face/edge lists ///////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02186"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e"> 2186</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e">NCMesh::QuadFaceSplitType</a>(<span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2, <span class="keywordtype">int</span> v3, <span class="keywordtype">int</span> v4,</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                              <span class="keywordtype">int</span> mid[5])<span class="keyword"> const</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &gt;= 3, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;   <span class="comment">// find edge nodes</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;   <span class="keywordtype">int</span> e1 = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(v1, v2);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;   <span class="keywordtype">int</span> e2 = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(v2, v3);</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;   <span class="keywordtype">int</span> e3 = (e1 &gt;= 0 &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[e1].HasVertex()) ? <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(v3, v4) : -1;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;   <span class="keywordtype">int</span> e4 = (e2 &gt;= 0 &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[e2].HasVertex()) ? <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(v4, v1) : -1;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;   <span class="comment">// optional: return the mid-edge nodes if requested</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;   <span class="keywordflow">if</span> (mid) { mid[0] = e1, mid[1] = e2, mid[2] = e3, mid[3] = e4; }</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;   <span class="comment">// try to get a mid-face node, either by (e1, e3) or by (e2, e4)</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;   <span class="keywordtype">int</span> midf1 = -1, midf2 = -1;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;   <span class="keywordflow">if</span> (e1 &gt;= 0 &amp;&amp; e3 &gt;= 0) { midf1 = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(e1, e3); }</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;   <span class="keywordflow">if</span> (e2 &gt;= 0 &amp;&amp; e4 &gt;= 0) { midf2 = <a class="code" href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">FindMidEdgeNode</a>(e2, e4); }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;   <span class="comment">// get proper node if shadow node exists</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;   <span class="keywordflow">if</span> (midf1 &gt;= 0 &amp;&amp; midf1 == midf2)</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;   {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[midf1];</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      <span class="keywordflow">if</span> (nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a> != e1 &amp;&amp; nd.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a> != e1) { midf1 = -1; }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      <span class="keywordflow">if</span> (nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a> != e2 &amp;&amp; nd.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a> != e2) { midf2 = -1; }</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;   }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;   <span class="comment">// only one way to access the mid-face node must always exist</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;   MFEM_ASSERT(!(midf1 &gt;= 0 &amp;&amp; midf2 &gt;= 0), <span class="stringliteral">&quot;incorrectly split face!&quot;</span>);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;   <span class="keywordflow">if</span> (midf1 &lt; 0 &amp;&amp; midf2 &lt; 0) <span class="comment">// face not split</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;   {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <span class="keywordflow">if</span> (mid) { mid[4] = -1; }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;   }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (midf1 &gt;= 0) <span class="comment">// face split &quot;vertically&quot;</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;   {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordflow">if</span> (mid) { mid[4] = midf1; }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;      <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;   }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;   <span class="keywordflow">else</span> <span class="comment">// face split &quot;horizontally&quot;</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;   {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keywordflow">if</span> (mid) { mid[4] = midf2; }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;      <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;   }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;}</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;</div>
<div class="line"><a name="l02233"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ac84ca7ecad973da2a711fd786d73a23e"> 2233</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmfem_1_1NCMesh.html#ac84ca7ecad973da2a711fd786d73a23e">NCMesh::TriFaceSplit</a>(<span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2, <span class="keywordtype">int</span> v3, <span class="keywordtype">int</span> mid[3])<span class="keyword"> const</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;   <span class="keywordtype">int</span> e1 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(v1, v2);</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;   <span class="keywordflow">if</span> (e1 &lt; 0 || !<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[e1].HasVertex()) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;   <span class="keywordtype">int</span> e2 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(v2, v3);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;   <span class="keywordflow">if</span> (e2 &lt; 0 || !<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[e2].HasVertex()) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;   <span class="keywordtype">int</span> e3 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(v3, v1);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;   <span class="keywordflow">if</span> (e3 &lt; 0 || !<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[e3].HasVertex()) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;   <span class="keywordflow">if</span> (mid) { mid[0] = e1, mid[1] = e2, mid[2] = e3; }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;   <span class="comment">// NOTE: face (v1, v2, v3) still needs to be checked</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;}</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div>
<div class="line"><a name="l02250"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62"> 2250</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">NCMesh::find_node</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el, <span class="keywordtype">int</span> node)</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;{</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;   {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i] == node) { <span class="keywordflow">return</span> i; }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;   }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;   MFEM_ABORT(<span class="stringliteral">&quot;Node not found.&quot;</span>);</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;   <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;}</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;</div>
<div class="line"><a name="l02260"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a59357a4af171acdb72039db96e5de76f"> 2260</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a59357a4af171acdb72039db96e5de76f">NCMesh::FindNodeExt</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el, <span class="keywordtype">int</span> node, <span class="keywordtype">bool</span> abort)</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;{</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; i++)</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;   {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc">RetrieveNode</a>(el, i) == node) { <span class="keywordflow">return</span> i; }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;   }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;   <span class="keywordflow">if</span> (abort) { MFEM_ABORT(<span class="stringliteral">&quot;Node not found.&quot;</span>); }</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;   <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;}</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div>
<div class="line"><a name="l02270"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a3b5f570f87003bca08f366ee279b19cf"> 2270</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a3b5f570f87003bca08f366ee279b19cf">NCMesh::find_element_edge</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el, <span class="keywordtype">int</span> vn0, <span class="keywordtype">int</span> vn1, <span class="keywordtype">bool</span> abort)</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;{</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;   MFEM_ASSERT(!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; i++)</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;   {</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i];</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <span class="keywordtype">int</span> n0 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[0]];</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keywordtype">int</span> n1 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[1]];</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordflow">if</span> ((n0 == vn0 &amp;&amp; n1 == vn1) ||</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;          (n0 == vn1 &amp;&amp; n1 == vn0)) { <span class="keywordflow">return</span> i; }</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;   }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;   <span class="keywordflow">if</span> (abort) { MFEM_ABORT(<span class="stringliteral">&quot;Edge (&quot;</span> &lt;&lt; vn0 &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; vn1 &lt;&lt; <span class="stringliteral">&quot;) not found&quot;</span>); }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;   <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;}</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div>
<div class="line"><a name="l02288"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#afd473a17fba9e83c68615747cfec296c"> 2288</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#afd473a17fba9e83c68615747cfec296c">NCMesh::find_local_face</a>(<span class="keywordtype">int</span> <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>, <span class="keywordtype">int</span> <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <span class="keywordtype">int</span> <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, <span class="keywordtype">int</span> c)</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;{</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a> &amp;gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>];</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;   {</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      <span class="keywordflow">if</span> ((a == fv[0] || a == fv[1] || a == fv[2] || a == fv[3]) &amp;&amp;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;          (b == fv[0] || b == fv[1] || b == fv[2] || b == fv[3]) &amp;&amp;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;          (c == fv[0] || c == fv[1] || c == fv[2] || c == fv[3]))</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;         <span class="keywordflow">return</span> i;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      }</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;   }</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;   MFEM_ABORT(<span class="stringliteral">&quot;Face not found.&quot;</span>);</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;   <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;}</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div>
<div class="line"><a name="l02305"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a39a4ec0a951332753137a5b5b6b745aa"> 2305</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a39a4ec0a951332753137a5b5b6b745aa">NCMesh::ReorderFacePointMat</a>(<span class="keywordtype">int</span> v0, <span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2, <span class="keywordtype">int</span> v3,</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                                <span class="keywordtype">int</span> elem, <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a>&amp; mat)<span class="keyword"> const</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;   <span class="keywordtype">int</span> master[4] =</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;   {</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, v0), <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, v1), <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, v2),</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      (v3 &gt;= 0) ? <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, v3) : -1</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;   };</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;   <span class="keywordtype">int</span> nfv = (v3 &gt;= 0) ? 4 : 3;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;   <span class="keywordtype">int</span> local = <a class="code" href="classmfem_1_1NCMesh.html#afd473a17fba9e83c68615747cfec296c">find_local_face</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>(), master[0], master[1], master[2]);</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[local];</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;   <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> tmp(mat);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, j; i &lt; nfv; i++)</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;   {</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      <span class="keywordflow">for</span> (j = 0; j &lt; nfv; j++)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;      {</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;         <span class="keywordflow">if</span> (fv[i] == master[j])</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;         {</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <span class="comment">// &quot;pm.column(i) = tmp.column(j)&quot;</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; mat.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>(); k++)</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;               mat(k,i) = tmp(k,j);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;         }</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      MFEM_ASSERT(j != nfv, <span class="stringliteral">&quot;node not found.&quot;</span>);</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;   }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;   <span class="keywordflow">return</span> local;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;}</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div>
<div class="line"><a name="l02339"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8"> 2339</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">NCMesh::TraverseQuadFace</a>(<span class="keywordtype">int</span> vn0, <span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3,</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                              <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>&amp; pm, <span class="keywordtype">int</span> level,</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                              <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* eface[4])</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;{</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;   <span class="keywordflow">if</span> (level &gt; 0)</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;   {</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <span class="comment">// check if we made it to a face that is not split further</span></div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* fa = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(vn0, vn1, vn2, vn3);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <span class="keywordflow">if</span> (fa)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;         <span class="comment">// we have a slave face, add it to the list</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;         <span class="keywordtype">int</span> elem = fa-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">GetSingleElement</a>();</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.push_back(</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a>(fa-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a>, elem, -1, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>));</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;         <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;mat = <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back().point_matrix;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;         pm.<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html#abad6e9611bc85e85ae7c58ccc030df19">GetMatrix</a>(mat);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;         <span class="comment">// reorder the point matrix according to slave face orientation</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;         <span class="keywordtype">int</span> local = <a class="code" href="classmfem_1_1NCMesh.html#a39a4ec0a951332753137a5b5b6b745aa">ReorderFacePointMat</a>(vn0, vn1, vn2, vn3, elem, mat);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back().local = local;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;         eface[0] = eface[2] = fa;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;         eface[1] = eface[3] = fa;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;         <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;   }</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;   <span class="comment">// we need to recurse deeper</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;   <span class="keywordtype">int</span> mid[5];</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;   <span class="keywordtype">int</span> split = <a class="code" href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e">QuadFaceSplitType</a>(vn0, vn1, vn2, vn3, mid);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a> *ef[2][4];</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;   <span class="keywordflow">if</span> (split == 1) <span class="comment">// &quot;X&quot; split face</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;   {</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> pmid0(pm(0), pm(1)), pmid2(pm(2), pm(3));</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">TraverseQuadFace</a>(vn0, mid[0], mid[2], vn3,</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                       <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pmid0, pmid2, pm(3)), level+1, ef[0]);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">TraverseQuadFace</a>(mid[0], vn1, vn2, mid[2],</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                       <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pmid0, pm(1), pm(2), pmid2), level+1, ef[1]);</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      eface[1] = ef[1][1];</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      eface[3] = ef[0][3];</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;      eface[0] = eface[2] = NULL;</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;   }</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (split == 2) <span class="comment">// &quot;Y&quot; split face</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;   {</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> pmid1(pm(1), pm(2)), pmid3(pm(3), pm(0));</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">TraverseQuadFace</a>(vn0, vn1, mid[1], mid[3],</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                       <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pm(1), pmid1, pmid3), level+1, ef[0]);</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">TraverseQuadFace</a>(mid[3], mid[1], vn2, vn3,</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                       <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pmid3, pmid1, pm(2), pm(3)), level+1, ef[1]);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;      eface[0] = ef[0][0];</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      eface[2] = ef[1][2];</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      eface[1] = eface[3] = NULL;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;   }</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;   <span class="comment">// check for a prism edge constrained by the master face</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ae6fb3d0a6bb5a292fb5bcae8c116f0bf">HavePrisms</a>() &amp;&amp; mid[4] &gt;= 0)</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;   {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a>&amp; enode = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid[4]];</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;      <span class="keywordflow">if</span> (enode.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">HasEdge</a>())</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;      {</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;         <span class="comment">// process the edge only if it&#39;s not shared by slave faces</span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;         <span class="comment">// within this master face (i.e. the edge is &quot;hidden&quot;)</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> fi[3][2] = {{0, 0}, {1, 3}, {2, 0}};</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;         <span class="keywordflow">if</span> (!ef[0][fi[split][0]] &amp;&amp; !ef[1][fi[split][1]])</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;         {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            MFEM_ASSERT(enode.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a7108f596104c940792b0a71fa085d812">edge_refc</a> == 1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a> buf[4];</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <a class="code" href="classmfem_1_1Array.html">Array&lt;MeshId&gt;</a> eid(buf, 4);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            (split == 1) ? <a class="code" href="classmfem_1_1NCMesh.html#a6db73bae7fda9aef6dd839dd237e21f3">FindEdgeElements</a>(mid[0], vn1, vn2, mid[2], eid)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;            <span class="comment">/*        */</span> : <a class="code" href="classmfem_1_1NCMesh.html#a6db73bae7fda9aef6dd839dd237e21f3">FindEdgeElements</a>(mid[3], vn0, vn1, mid[1], eid);</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;            MFEM_ASSERT(eid.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &gt; 0, <span class="stringliteral">&quot;edge prism not found&quot;</span>);</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            MFEM_ASSERT(eid.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt; 2, <span class="stringliteral">&quot;non-unique edge prism&quot;</span>);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <span class="comment">// create a slave face record with a degenerate point matrix</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.push_back(</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;               <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a>(-1 - enode.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>,</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                     eid[0].element, eid[0].local, eid[0].geom));</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;mat = <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back().point_matrix;</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            <span class="keywordflow">if</span> (split == 1)</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;               <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid0(pm(0), pm(1)), mid2(pm(2), pm(3));</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;               <span class="keywordtype">int</span> v1 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid[0]].vert_index;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;               <span class="keywordtype">int</span> v2 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid[2]].vert_index;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;               ((v1 &lt; v2) ? <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid0, mid2, mid2, mid0) :</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                <span class="comment">/*       */</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid2, mid0, mid0, mid2)).GetMatrix(mat);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;            }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;            {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;               <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid1(pm(1), pm(2)), mid3(pm(3), pm(0));</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;               <span class="keywordtype">int</span> v1 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid[1]].vert_index;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;               <span class="keywordtype">int</span> v2 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid[3]].vert_index;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;               ((v1 &lt; v2) ? <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid1, mid3, mid3, mid1) :</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                <span class="comment">/*       */</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid3, mid1, mid1, mid3)).GetMatrix(mat);</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;         }</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;   }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;}</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div>
<div class="line"><a name="l02451"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286"> 2451</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">NCMesh::TraverseTetEdge</a>(<span class="keywordtype">int</span> vn0, <span class="keywordtype">int</span> vn1, <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> &amp;p0, <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> &amp;p1)</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;{</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;   <span class="keywordtype">int</span> mid = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(vn0, vn1);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;   <span class="keywordflow">if</span> (mid &lt; 0) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid];</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;   <span class="keywordflow">if</span> (nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">HasEdge</a>())</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;   {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      <span class="comment">// check if the edge is already a master in &#39;edge_list&#39;</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;      <span class="keywordtype">int</span> type;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a> &amp;eid = <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a479784242168cb520f1969ea343a6928">LookUp</a>(nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>, &amp;type);</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      <span class="keywordflow">if</span> (type == 1)</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;      {</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;         <span class="comment">// in this case we need to add an edge-face constraint, because the</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;         <span class="comment">// master edge is really a (face-)slave itself</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.push_back(</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a>(-1 - eid.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a357fd304340aa413744e8ef7e0652ad8">index</a>, eid.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a1a0eeb9da226cf3dcc4640017f5f9e90">element</a>, eid.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">local</a>, eid.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ac5c46c728b3fee20e8bb62ef2da95dd1">geom</a>));</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;         <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;mat = <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back().point_matrix;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;         <span class="keywordtype">int</span> v0index = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[vn0].vert_index;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;         <span class="keywordtype">int</span> v1index = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[vn1].vert_index;</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;         ((v0index &lt; v1index) ? <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(p0, p1, p0)</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;          <span class="comment">/*               */</span> : <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(p1, p0, p1)).GetMatrix(mat);</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;         <span class="keywordflow">return</span>; <span class="comment">// no need to continue deeper</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      }</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;   }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;   <span class="comment">// recurse deeper</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> pmid(p0, p1);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">TraverseTetEdge</a>(vn0, mid, p0, pmid);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">TraverseTetEdge</a>(mid, vn1, pmid, p1);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;}</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;</div>
<div class="line"><a name="l02487"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a"> 2487</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">NCMesh::TraverseTriFace</a>(<span class="keywordtype">int</span> vn0, <span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2,</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                             <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>&amp; pm, <span class="keywordtype">int</span> level)</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;{</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;   <span class="keywordflow">if</span> (level &gt; 0)</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;   {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      <span class="comment">// check if we made it to a face that is not split further</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* fa = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Find(vn0, vn1, vn2);</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      <span class="keywordflow">if</span> (fa)</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      {</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;         <span class="comment">// we have a slave face, add it to the list</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;         <span class="keywordtype">int</span> elem = fa-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">GetSingleElement</a>();</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.push_back(</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a>(fa-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a>, elem, -1, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>));</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;         <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;mat = <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back().point_matrix;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;         pm.<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html#abad6e9611bc85e85ae7c58ccc030df19">GetMatrix</a>(mat);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;         <span class="comment">// reorder the point matrix according to slave face orientation</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;         <span class="keywordtype">int</span> local = <a class="code" href="classmfem_1_1NCMesh.html#a39a4ec0a951332753137a5b5b6b745aa">ReorderFacePointMat</a>(vn0, vn1, vn2, -1, elem, mat);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back().local = local;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;         <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;   }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;   <span class="keywordtype">int</span> mid[3];</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ac84ca7ecad973da2a711fd786d73a23e">TriFaceSplit</a>(vn0, vn1, vn2, mid))</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;   {</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> pmid0(pm(0), pm(1)), pmid1(pm(1), pm(2)), pmid2(pm(2), pm(0));</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>[4];</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      b[0] = <a class="code" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">TraverseTriFace</a>(vn0, mid[0], mid[2],</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                             <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pmid0, pmid2), level+1);</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;      b[1] = <a class="code" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">TraverseTriFace</a>(mid[0], vn1, mid[1],</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                             <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pmid0, pm(1), pmid1), level+1);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      b[2] = <a class="code" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">TraverseTriFace</a>(mid[2], mid[1], vn2,</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                             <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pmid2, pmid1, pm(2)), level+1);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      b[3] = <a class="code" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">TraverseTriFace</a>(mid[1], mid[2], mid[0],</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                             <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pmid1, pmid2, pmid0), level+1);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      <span class="comment">// traverse possible tet edges constrained by the master face</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a4c4e5cacfd78818b55d0c86a1b30523a">HaveTets</a>() &amp;&amp; !b[3])</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;         <span class="keywordflow">if</span> (!b[1]) { <a class="code" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">TraverseTetEdge</a>(mid[0], mid[1], pmid0, pmid1); }</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;         <span class="keywordflow">if</span> (!b[2]) { <a class="code" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">TraverseTetEdge</a>(mid[1], mid[2], pmid1, pmid2); }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;         <span class="keywordflow">if</span> (!b[0]) { <a class="code" href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">TraverseTetEdge</a>(mid[2], mid[0], pmid2, pmid0); }</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      }</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;   }</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;}</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div>
<div class="line"><a name="l02542"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a63bb269853d5f9aa5312d2629f25d0c4"> 2542</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a63bb269853d5f9aa5312d2629f25d0c4">NCMesh::BuildFaceList</a>()</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;{</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>();</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &lt; 3) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a4c4e5cacfd78818b55d0c86a1b30523a">HaveTets</a>()) { <a class="code" href="classmfem_1_1NCMesh.html#a66a55c978781ac29f1d6e380cd79e28b">GetEdgeList</a>(); } <span class="comment">// needed by TraverseTetEdge()</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> processed_faces(<a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.NumIds());</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;   processed_faces = 0;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;   <span class="comment">// visit faces of leaf elements</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;   {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      MFEM_ASSERT(!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>, <span class="stringliteral">&quot;not a leaf element.&quot;</span>);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; j++)</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      {</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;         <span class="comment">// get nodes for this face</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;         <span class="keywordtype">int</span> node[4];</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 4; k++)</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;         {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            node[k] = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[j][k]];</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;         }</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;         <span class="keywordtype">int</span> face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.FindId(node[0], node[1], node[2], node[3]);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;         MFEM_ASSERT(face &gt;= 0, <span class="stringliteral">&quot;face not found!&quot;</span>);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;         <span class="comment">// tell ParNCMesh about the face</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a3eb175d0c72d5865edc5fbbdf14e9adb">ElementSharesFace</a>(elem, j, face);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;         <span class="comment">// have we already processed this face? skip if yes</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;         <span class="keywordflow">if</span> (processed_faces[face]) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;         processed_faces[face] = 1;</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;         <span class="keywordtype">char</span> fgeom = (node[3] &gt;= 0) ? <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a> : <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a> &amp;fa = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[face];</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;         <span class="keywordflow">if</span> (fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a1a76a2a0b519ad0aab8710895d0b928b">elem</a>[0] &gt;= 0 &amp;&amp; fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a1a76a2a0b519ad0aab8710895d0b928b">elem</a>[1] &gt;= 0)</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;         {</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            <span class="comment">// this is a conforming face, add it to the list</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>.push_back(<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a>(fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a>, elem, j, fgeom));</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;         }</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;         {</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;            <span class="comment">// this is either a master face or a slave face, but we can&#39;t</span></div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            <span class="comment">// tell until we traverse the face refinement &#39;tree&#39;...</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            <span class="keywordtype">int</span> sb = <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size();</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            <span class="keywordflow">if</span> (fgeom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>)</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;            {</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;               <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a>* dummy[4];</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">TraverseQuadFace</a>(node[0], node[1], node[2], node[3],</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                                <a class="code" href="classmfem_1_1NCMesh.html#a509686371a908c7d100910c2548978f0">pm_quad_identity</a>, 0, dummy);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;            {</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">TraverseTriFace</a>(node[0], node[1], node[2],</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                               <a class="code" href="classmfem_1_1NCMesh.html#af61c2d357a89d2e73404e68e469e3383">pm_tri_identity</a>, 0);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;            }</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            <span class="keywordtype">int</span> se = <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size();</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            <span class="keywordflow">if</span> (sb &lt; se)</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            {</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;               <span class="comment">// found slaves, so this is a master face; add it to the list</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a8de451b39a43064e52f8bfc24b664ccf">masters</a>.push_back(</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                  <a class="code" href="structmfem_1_1NCMesh_1_1Master.html">Master</a>(fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a>, elem, j, fgeom, sb, se));</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;               <span class="comment">// also, set the master index for the slaves</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = sb; i &lt; se; i++)</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;               {</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                  <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>[i].master = fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a>;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;               }</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;         }</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;         <span class="keywordflow">if</span> (fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ac617ad0add1cc5dc349515ddc4647680">Boundary</a>()) { <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face); }</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;      }</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;   }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;}</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div>
<div class="line"><a name="l02626"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a2e70df882689c55e19fa9b7de5982363"> 2626</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a2e70df882689c55e19fa9b7de5982363">NCMesh::TraverseEdge</a>(<span class="keywordtype">int</span> vn0, <span class="keywordtype">int</span> vn1, <span class="keywordtype">double</span> t0, <span class="keywordtype">double</span> t1, <span class="keywordtype">int</span> flags,</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                          <span class="keywordtype">int</span> level)</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;{</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;   <span class="keywordtype">int</span> mid = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(vn0, vn1);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;   <span class="keywordflow">if</span> (mid &lt; 0) { <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid];</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;   <span class="keywordflow">if</span> (nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">HasEdge</a>() &amp;&amp; level &gt; 0)</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;   {</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;      <span class="comment">// we have a slave edge, add it to the list</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.push_back(<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a>(nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>, -1, -1, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>));</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a> &amp;sl = <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.back();</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;      sl.<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html#a4d7499a4b971ae7b4effaac4d657631f">point_matrix</a>.<a class="code" href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">SetSize</a>(1, 2);</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;      sl.<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html#a4d7499a4b971ae7b4effaac4d657631f">point_matrix</a>(0,0) = t0;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      sl.<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html#a4d7499a4b971ae7b4effaac4d657631f">point_matrix</a>(0,1) = t1;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;      <span class="comment">// handle slave edge orientation</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;      sl.<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html#ae73dd01726e605574a62e7c8b6b7e8ca">edge_flags</a> = flags;</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;      <span class="keywordtype">int</span> v0index = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[vn0].vert_index;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      <span class="keywordtype">int</span> v1index = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[vn1].vert_index;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      <span class="keywordflow">if</span> (v0index &gt; v1index) { sl.<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html#ae73dd01726e605574a62e7c8b6b7e8ca">edge_flags</a> |= 2; }</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;   }</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;   <span class="comment">// recurse deeper</span></div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;   <span class="keywordtype">double</span> tmid = (t0 + t1) / 2;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a2e70df882689c55e19fa9b7de5982363">TraverseEdge</a>(vn0, mid, t0, tmid, flags, level+1);</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a2e70df882689c55e19fa9b7de5982363">TraverseEdge</a>(mid, vn1, tmid, t1, flags, level+1);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;}</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;</div>
<div class="line"><a name="l02656"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a9c479270fa12d2b9f9aeb38bcbb27e64"> 2656</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a9c479270fa12d2b9f9aeb38bcbb27e64">NCMesh::BuildEdgeList</a>()</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;{</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>();</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &lt;= 2)</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;   {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;   }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> processed_edges(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds());</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;   processed_edges = 0;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> edge_element(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds());</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;signed char&gt;</a> edge_local(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds());</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;   edge_local = -1;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;   <span class="comment">// visit edges of leaf elements</span></div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;   {</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      MFEM_ASSERT(!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>, <span class="stringliteral">&quot;not a leaf element.&quot;</span>);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; j++)</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;         <span class="comment">// get nodes for this edge</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[j];</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;         <span class="keywordtype">int</span> node[2] = { el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[1]] };</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;         <span class="keywordtype">int</span> enode = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(node[0], node[1]);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;         MFEM_ASSERT(enode &gt;= 0, <span class="stringliteral">&quot;edge node not found!&quot;</span>);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[enode];</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;         MFEM_ASSERT(nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">HasEdge</a>(), <span class="stringliteral">&quot;edge not found!&quot;</span>);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;         <span class="comment">// tell ParNCMesh about the edge</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a8d4354e9a3a97c335e7b8b788c66486e">ElementSharesEdge</a>(elem, j, enode);</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;         <span class="comment">// (2D only, store boundary faces)</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &lt;= 2)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;         {</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;            <span class="keywordtype">int</span> face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.FindId(node[0], node[0], node[1], node[1]);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            MFEM_ASSERT(face &gt;= 0, <span class="stringliteral">&quot;face not found!&quot;</span>);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[face].<a class="code" href="namespacemfem.html#af736ce0d62a2894982a1eda9dbe93fb7ae234de581c9c5ef91322f1469a585f9e">Boundary</a>()) { <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(face); }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;         }</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;         <span class="comment">// store element/local for later</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;         edge_element[nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>] = elem;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;         edge_local[nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>] = j;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;         <span class="comment">// skip slave edges here, they will be reached from their masters</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">GetEdgeMaster</a>(enode) &gt;= 0) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;         <span class="comment">// have we already processed this edge? skip if yes</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;         <span class="keywordflow">if</span> (processed_edges[enode]) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;         processed_edges[enode] = 1;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;         <span class="comment">// prepare edge interval for slave traversal, handle orientation</span></div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;         <span class="keywordtype">double</span> t0 = 0.0, t1 = 1.0;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;         <span class="keywordtype">int</span> v0index = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[0]].vert_index;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;         <span class="keywordtype">int</span> v1index = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[1]].vert_index;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;         <span class="keywordtype">int</span> flags = (v0index &gt; v1index) ? 1 : 0;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;         <span class="comment">// try traversing the edge to find slave edges</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;         <span class="keywordtype">int</span> sb = <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size();</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a2e70df882689c55e19fa9b7de5982363">TraverseEdge</a>(node[0], node[1], t0, t1, flags, 0);</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;         <span class="keywordtype">int</span> se = <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size();</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;         <span class="keywordflow">if</span> (sb &lt; se)</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;         {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            <span class="comment">// found slaves, this is a master face; add it to the list</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a8de451b39a43064e52f8bfc24b664ccf">masters</a>.push_back(</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;               <a class="code" href="structmfem_1_1NCMesh_1_1Master.html">Master</a>(nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>, elem, j, <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">Geometry::SEGMENT</a>, sb, se));</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;            <span class="comment">// also, set the master index for the slaves</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = sb; i &lt; se; i++)</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            {</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>[i].master = nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;         }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;         {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;            <span class="comment">// no slaves, this is a conforming edge</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>.push_back(<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a>(nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>, elem, j));</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;         }</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;      }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;   }</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;   <span class="comment">// fix up slave edge element/local</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size(); i++)</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;   {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a> &amp;sl = <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>[i];</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="keywordtype">int</span> local = edge_local[sl.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a357fd304340aa413744e8ef7e0652ad8">index</a>];</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <span class="keywordflow">if</span> (local &gt;= 0)</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      {</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;         sl.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">local</a> = local;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;         sl.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a1a0eeb9da226cf3dcc4640017f5f9e90">element</a> = edge_element[sl.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a357fd304340aa413744e8ef7e0652ad8">index</a>];</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;   }</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;}</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div>
<div class="line"><a name="l02757"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab015470342061d0be5cd829206973793"> 2757</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ab015470342061d0be5cd829206973793">NCMesh::BuildVertexList</a>()</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;{</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;   <span class="keywordtype">int</span> total = <a class="code" href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">NVertices</a> + <a class="code" href="classmfem_1_1NCMesh.html#ac8a721da76292361ab8781e292e0a87b">GetNumGhostVertices</a>();</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>();</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>.reserve(total);</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> processed_vertices(total);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;   processed_vertices = 0;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;   <span class="comment">// analogously to above, visit vertices of leaf elements</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;   {</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; j++)</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      {</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;         <span class="keywordtype">int</span> node = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j];</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node];</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;         <span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a> = nd.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#afe002bd1fe00597001783e3bfeb54d80">vert_index</a>;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;         <span class="keywordflow">if</span> (index &gt;= 0)</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;         {</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a0bd3d8f770cc1387feeaea376cedfa4d">ElementSharesVertex</a>(elem, j, node);</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            <span class="keywordflow">if</span> (processed_vertices[index]) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            processed_vertices[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>] = 1;</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>.push_back(<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a>(index, elem, j));</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;         }</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;   }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;}</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;</div>
<div class="line"><a name="l02792"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1Slave.html#a2639da00114322f7f3ab149db220b373"> 2792</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1NCMesh_1_1Slave.html#a2639da00114322f7f3ab149db220b373">NCMesh::Slave::OrientedPointMatrix</a>(<a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a> &amp;oriented_matrix)<span class="keyword"> const</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;   oriented_matrix = point_matrix;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;   <span class="keywordflow">if</span> (edge_flags)</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;   {</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      MFEM_ASSERT(oriented_matrix.<a class="code" href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">Height</a>() == 1 &amp;&amp;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                  oriented_matrix.<a class="code" href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">Width</a>() == 2, <span class="stringliteral">&quot;not an edge point matrix&quot;</span>);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      <span class="keywordflow">if</span> (edge_flags &amp; 1) <span class="comment">// master inverted</span></div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      {</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;         oriented_matrix(0,0) = 1.0 - oriented_matrix(0,0);</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;         oriented_matrix(0,1) = 1.0 - oriented_matrix(0,1);</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      }</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      <span class="keywordflow">if</span> (edge_flags &amp; 2) <span class="comment">// slave inverted</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;      {</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;         std::swap(oriented_matrix(0,0), oriented_matrix(0,1));</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;      }</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;   }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;}</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;</div>
<div class="line"><a name="l02813"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f"> 2813</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">NCMesh::NCList::Clear</a>(<span class="keywordtype">bool</span> hard)</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;{</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;   <span class="keywordflow">if</span> (!hard)</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;   {</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;      conforming.clear();</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;      masters.clear();</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      slaves.clear();</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;   }</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;   {</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html">NCList</a> empty;</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      conforming.swap(empty.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;      masters.swap(empty.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a8de451b39a43064e52f8bfc24b664ccf">masters</a>);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      slaves.swap(empty.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;   }</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;   inv_index.DeleteAll();</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;}</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;</div>
<div class="line"><a name="l02831"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1NCList.html#a0d6f2335b6dc74495af661073dded1ea"> 2831</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a0d6f2335b6dc74495af661073dded1ea">NCMesh::NCList::TotalSize</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;   <span class="keywordflow">return</span> conforming.size() + masters.size() + slaves.size();</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;}</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;</div>
<div class="line"><a name="l02836"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1NCList.html#a479784242168cb520f1969ea343a6928"> 2836</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">NCMesh::MeshId</a>&amp; <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a479784242168cb520f1969ea343a6928">NCMesh::NCList::LookUp</a>(<span class="keywordtype">int</span> <a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>, <span class="keywordtype">int</span> *type)<span class="keyword"> const</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;   <span class="keywordflow">if</span> (!inv_index.Size())</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;   {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;      <span class="keywordtype">int</span> max_index = -1;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; conforming.size(); i++)</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;         max_index = std::max(conforming[i].index, max_index);</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      }</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; masters.size(); i++)</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      {</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;         max_index = std::max(masters[i].index, max_index);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      }</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; slaves.size(); i++)</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;      {</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;         <span class="keywordflow">if</span> (slaves[i].index &lt; 0) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;         max_index = std::max(slaves[i].index, max_index);</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;      }</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      inv_index.SetSize(max_index + 1);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      inv_index = -1;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; conforming.size(); i++)</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      {</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;         inv_index[conforming[i].index] = (i &lt;&lt; 2);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; masters.size(); i++)</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;      {</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;         inv_index[masters[i].index] = (i &lt;&lt; 2) + 1;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; slaves.size(); i++)</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;      {</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;         <span class="keywordflow">if</span> (slaves[i].index &lt; 0) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;         inv_index[slaves[i].index] = (i &lt;&lt; 2) + 2;</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;      }</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;   }</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;   MFEM_ASSERT(index &gt;= 0 &amp;&amp; index &lt; inv_index.Size(), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;   <span class="keywordtype">int</span> key = inv_index[<a class="code" href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a>];</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;   <span class="keywordflow">if</span> (!type)</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;   {</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      MFEM_VERIFY(key &gt;= 0, <span class="stringliteral">&quot;entity not found.&quot;</span>);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;   }</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;   <span class="keywordflow">else</span> <span class="comment">// return entity type if requested, don&#39;t abort when not found</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;   {</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      *type = (key &gt;= 0) ? (key &amp; 0x3) : -1;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="keyword">static</span> <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a> invalid;</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;      <span class="keywordflow">if</span> (*type &lt; 0) { <span class="keywordflow">return</span> invalid; } <span class="comment">// not found</span></div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;   }</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;   <span class="comment">// return found entity MeshId</span></div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;   <span class="keywordflow">switch</span> (key &amp; 0x3)</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;   {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;      <span class="keywordflow">case</span> 0: <span class="keywordflow">return</span> conforming[key &gt;&gt; 2];</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;      <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> masters[key &gt;&gt; 2];</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;      <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> slaves[key &gt;&gt; 2];</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;      <span class="keywordflow">default</span>: MFEM_ABORT(<span class="stringliteral">&quot;internal error&quot;</span>); <span class="keywordflow">return</span> conforming[0];</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;   }</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;}</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;<span class="comment">//// Neighbors /////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l02901"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c"> 2901</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">NCMesh::CollectEdgeVertices</a>(<span class="keywordtype">int</span> v0, <span class="keywordtype">int</span> v1, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;indices)</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;{</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;   <span class="keywordtype">int</span> mid = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(v0, v1);</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;   <span class="keywordflow">if</span> (mid &gt;= 0 &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid].HasVertex())</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;   {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      indices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(mid);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(v0, mid, indices);</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(mid, v1, indices);</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;   }</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;}</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;</div>
<div class="line"><a name="l02913"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0"> 2913</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">NCMesh::CollectTriFaceVertices</a>(<span class="keywordtype">int</span> v0, <span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;indices)</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;{</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;   <span class="keywordtype">int</span> mid[3];</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ac84ca7ecad973da2a711fd786d73a23e">TriFaceSplit</a>(v0, v1, v2, mid))</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;   {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      {</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;         indices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(mid[i]);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      }</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">CollectTriFaceVertices</a>(v0, mid[0], mid[2], indices);</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">CollectTriFaceVertices</a>(mid[0], v1, mid[1], indices);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">CollectTriFaceVertices</a>(mid[2], mid[1], v2, indices);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">CollectTriFaceVertices</a>(mid[0], mid[1], mid[2], indices);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a4c4e5cacfd78818b55d0c86a1b30523a">HaveTets</a>()) <span class="comment">// possible edge-face contact</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      {</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(mid[0], mid[1], indices);</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(mid[1], mid[2], indices);</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(mid[2], mid[0], indices);</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;      }</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;   }</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;}</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div>
<div class="line"><a name="l02937"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c"> 2937</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">NCMesh::CollectQuadFaceVertices</a>(<span class="keywordtype">int</span> v0, <span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2, <span class="keywordtype">int</span> v3,</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                                     <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;indices)</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;{</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;   <span class="keywordtype">int</span> mid[5];</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e">QuadFaceSplitType</a>(v0, v1, v2, v3, mid))</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;   {</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;         indices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(mid[0]);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;         indices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(mid[2]);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">CollectQuadFaceVertices</a>(v0, mid[0], mid[2], v3, indices);</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">CollectQuadFaceVertices</a>(mid[0], v1, v2, mid[2], indices);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ae6fb3d0a6bb5a292fb5bcae8c116f0bf">HavePrisms</a>()) <span class="comment">// possible edge-face contact</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;         {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(mid[0], mid[2], indices);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;         }</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;         indices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(mid[1]);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;         indices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(mid[3]);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">CollectQuadFaceVertices</a>(v0, v1, mid[1], mid[3], indices);</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">CollectQuadFaceVertices</a>(mid[3], mid[1], v2, v3, indices);</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ae6fb3d0a6bb5a292fb5bcae8c116f0bf">HavePrisms</a>()) <span class="comment">// possible edge-face contact</span></div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;         {</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(mid[1], mid[3], indices);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;         }</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;   }</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;}</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;</div>
<div class="line"><a name="l02971"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a365c960ba9c3554188c8f67a720ea0ac"> 2971</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a365c960ba9c3554188c8f67a720ea0ac">NCMesh::BuildElementToVertexTable</a>()</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;{</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;   <span class="keywordtype">int</span> nrows = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;   <span class="keywordtype">int</span>* I = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(nrows + 1);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;   <span class="keywordtype">int</span>** JJ = <span class="keyword">new</span> <span class="keywordtype">int</span>*[nrows];</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> indices;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;   indices.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(128);</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;   <span class="comment">// collect vertices coinciding with each element, including hanging vertices</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;   {</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;      MFEM_ASSERT(!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>, <span class="stringliteral">&quot;not a leaf element.&quot;</span>);</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;      <span class="keywordtype">int</span>* node = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      indices.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; j++)</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      {</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[j];</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">CollectEdgeVertices</a>(node[ev[0]], node[ev[1]], indices);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &gt;= 3)</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      {</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; j++)</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;         {</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[j];</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;            <span class="keywordflow">if</span> (gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[j] == 4)</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            {</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">CollectQuadFaceVertices</a>(node[fv[0]], node[fv[1]],</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                                       node[fv[2]], node[fv[3]], indices);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;            }</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            {</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">CollectTriFaceVertices</a>(node[fv[0]], node[fv[1]], node[fv[2]],</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                                      indices);</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            }</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;         }</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      }</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;      <span class="comment">// temporarily store one row of the table</span></div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      indices.<a class="code" href="classmfem_1_1Array.html#a370c68671fe785d87d9bf2b5b1f4b152">Sort</a>();</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;      indices.<a class="code" href="classmfem_1_1Array.html#aab5094e73ef3cc50816b8f6122b33bba">Unique</a>();</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      <span class="keywordtype">int</span> size = indices.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;      I[i] = size;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      JJ[i] = <span class="keyword">new</span> <span class="keywordtype">int</span>[size];</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      std::memcpy(JJ[i], indices.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>(), size * <span class="keyword">sizeof</span>(int));</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;   }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;   <span class="comment">// finalize the I array of the table</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;   <span class="keywordtype">int</span> nnz = 0;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nrows; i++)</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;   {</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <span class="keywordtype">int</span> cnt = I[i];</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      I[i] = nnz;</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      nnz += cnt;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;   }</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;   I[nrows] = nnz;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;   <span class="comment">// copy the temporarily stored rows into one J array</span></div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;   <span class="keywordtype">int</span> *J = <a class="code" href="classmfem_1_1Memory.html">Memory&lt;int&gt;</a>(nnz);</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;   nnz = 0;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nrows; i++)</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;   {</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      <span class="keywordtype">int</span> cnt = I[i+1] - I[i];</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      std::memcpy(J+nnz, JJ[i], cnt * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      <span class="keyword">delete</span> [] JJ[i];</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      nnz += cnt;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;   }</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">SetIJ</a>(I, J, nrows);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;   <span class="keyword">delete</span> [] JJ;</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;}</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;</div>
<div class="line"><a name="l03051"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aeb42afcff5d15ae4d8e246d5fc999547"> 3051</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aeb42afcff5d15ae4d8e246d5fc999547">NCMesh::FindSetNeighbors</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> &amp;elem_set,</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;                              <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> *neighbors,</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;                              <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> *neighbor_set)</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;{</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;   <span class="comment">// If A is the element-to-vertex table (see &#39;element_vertex&#39;) listing all</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;   <span class="comment">// vertices touching each element, including hanging vertices, then A*A^T is</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;   <span class="comment">// the element-to-neighbor table. Multiplying the element set with A*A^T</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;   <span class="comment">// gives the neighbor set. To save memory, this function only computes the</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;   <span class="comment">// action of A*A^T, the product itself is not stored anywhere.</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;   <span class="comment">// Optimization: the &#39;element_vertex&#39; table does not store the obvious</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;   <span class="comment">// corner nodes in it. The table is therefore empty for conforming meshes.</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a516369f29717e0a850773e5bc30ee68d">UpdateElementToVertexTable</a>();</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;   <span class="keywordtype">int</span> nleaves = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;   MFEM_VERIFY(elem_set.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() == nleaves, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a5e312e3907089115194dceef2d0c81c5">Size</a>() == nleaves, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;   <span class="comment">// step 1: vertices = A^T * elem_set, i.e, find all vertices touching the</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;   <span class="comment">// element set</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> vmark(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds());</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;   vmark = 0;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nleaves; i++)</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;   {</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;      <span class="keywordflow">if</span> (elem_set[i])</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      {</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(i);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;         <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(i);</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;         {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;            vmark[v[j]] = 1;</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;         }</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]];</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;         nv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;         {</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;            vmark[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j]] = 1;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;         }</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;      }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;   }</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;   <span class="comment">// step 2: neighbors = A * vertices, i.e., find all elements coinciding with</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;   <span class="comment">// vertices from step 1; NOTE: in the result we don&#39;t include elements from</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;   <span class="comment">// the original set</span></div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;   <span class="keywordflow">if</span> (neighbor_set)</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;   {</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      neighbor_set-&gt;<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(nleaves);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      *neighbor_set = 0;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;   }</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nleaves; i++)</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;   {</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;      <span class="keywordflow">if</span> (!elem_set[i])</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;      {</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;         <span class="keywordtype">bool</span> hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(i);</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;         <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(i);</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;         {</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;            <span class="keywordflow">if</span> (vmark[v[j]]) { hit = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;         }</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;         <span class="keywordflow">if</span> (!hit)</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;         {</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]];</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;            nv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>;</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;            {</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;               <span class="keywordflow">if</span> (vmark[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j]]) { hit = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            }</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;         }</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;         <span class="keywordflow">if</span> (hit)</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;         {</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;            <span class="keywordflow">if</span> (neighbors) { neighbors-&gt;<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]); }</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;            <span class="keywordflow">if</span> (neighbor_set) { (*neighbor_set)[i] = 1; }</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;         }</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      }</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;   }</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;}</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> sorted_lists_intersect(<span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a>, <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code" href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>, <span class="keywordtype">int</span> na, <span class="keywordtype">int</span> nb)</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;{</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;   <span class="keywordflow">if</span> (!na || !nb) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;   <span class="keywordtype">int</span> a_last = a[na-1], b_last = b[nb-1];</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;   <span class="keywordflow">if</span> (*b &lt; *a) { <span class="keywordflow">goto</span> l2; }  <span class="comment">// woo-hoo! I always wanted to use a goto! :)</span></div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;l1:</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;   <span class="keywordflow">if</span> (a_last &lt; *b) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;   <span class="keywordflow">while</span> (*a &lt; *b) { a++; }</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;   <span class="keywordflow">if</span> (*a == *b) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;l2:</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;   <span class="keywordflow">if</span> (b_last &lt; *a) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;   <span class="keywordflow">while</span> (*b &lt; *a) { b++; }</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;   <span class="keywordflow">if</span> (*a == *b) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;   <span class="keywordflow">goto</span> l1;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;}</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;</div>
<div class="line"><a name="l03154"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a088a33d266f1ff532b49e6a0f8d8aa94"> 3154</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a088a33d266f1ff532b49e6a0f8d8aa94">NCMesh::FindNeighbors</a>(<span class="keywordtype">int</span> elem, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;neighbors,</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> *search_set)</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;{</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;   <span class="comment">// TODO future: this function is inefficient. For a single element, an</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;   <span class="comment">// octree neighbor search algorithm would be better. However, the octree</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;   <span class="comment">// neighbor algorithm is hard to get right in the multi-octree case due to</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;   <span class="comment">// the different orientations of the octrees (i.e., the root elements).</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a516369f29717e0a850773e5bc30ee68d">UpdateElementToVertexTable</a>();</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;   <span class="comment">// sorted list of all vertex nodes touching &#39;elem&#39;</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> vert;</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;   vert.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(128);</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;   <span class="comment">// support for non-leaf &#39;elem&#39;, collect vertices of all children</span></div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> stack;</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;   stack.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(64);</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;   stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(elem);</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;   <span class="keywordflow">while</span> (stack.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>())</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;   {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[stack.<a class="code" href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">Last</a>()];</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;      stack.<a class="code" href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">DeleteLast</a>();</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      {</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;         <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;         <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nv; i++)</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;         {</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;            vert.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(v[i]);</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;         }</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;         nv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nv; i++)</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;         {</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;            vert.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[i]);</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;         }</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;      {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;         {</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;            stack.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i]);</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;         }</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;   }</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;   vert.<a class="code" href="classmfem_1_1Array.html#a370c68671fe785d87d9bf2b5b1f4b152">Sort</a>();</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;   vert.<a class="code" href="classmfem_1_1Array.html#aab5094e73ef3cc50816b8f6122b33bba">Unique</a>();</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;   <span class="keywordtype">int</span> *v1 = vert.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>();</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;   <span class="keywordtype">int</span> nv1 = vert.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;   <span class="keywordflow">if</span> (!search_set) { search_set = &amp;<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>; }</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;   <span class="comment">// test *all* potential neighbors from the search set</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; search_set-&gt;<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;   {</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;      <span class="keywordtype">int</span> testme = (*search_set)[i];</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      <span class="keywordflow">if</span> (testme != elem)</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      {</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[testme];</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;         <span class="keywordtype">int</span> *v2 = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;         <span class="keywordtype">int</span> nv2 = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;         <span class="keywordtype">bool</span> hit = sorted_lists_intersect(v1, v2, nv1, nv2);</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;         <span class="keywordflow">if</span> (!hit)</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;         {</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;            <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            {</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;               hit = sorted_lists_intersect(&amp;el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j], v1, 1, nv1);</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;               <span class="keywordflow">if</span> (hit) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;            }</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;         }</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;         <span class="keywordflow">if</span> (hit) { neighbors.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(testme); }</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;   }</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;}</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;</div>
<div class="line"><a name="l03237"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a288fdd4bddc6764be0d569288049f567"> 3237</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a288fdd4bddc6764be0d569288049f567">NCMesh::NeighborExpand</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;elems,</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;                            <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;expanded,</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> *search_set)</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;{</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a516369f29717e0a850773e5bc30ee68d">UpdateElementToVertexTable</a>();</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;char&gt;</a> vmark(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds());</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;   vmark = 0;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; elems.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;   {</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elems[i]];</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;      <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;      <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;      {</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;         vmark[v[j]] = 1;</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;      }</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;      nv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>;</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;      {</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;         vmark[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j]] = 1;</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;      }</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;   }</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;   <span class="keywordflow">if</span> (!search_set)</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;   {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;      search_set = &amp;<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>;</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;   }</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;   expanded.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; search_set-&gt;<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;   {</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      <span class="keywordtype">int</span> testme = (*search_set)[i];</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[testme];</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="keywordtype">bool</span> hit = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      <span class="keywordtype">int</span> *v = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">GetRow</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      <span class="keywordtype">int</span> nv = <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">RowSize</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>);</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      {</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;         <span class="keywordflow">if</span> (vmark[v[j]]) { hit = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;      }</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;      <span class="keywordflow">if</span> (!hit)</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;      {</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;         nv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>;</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nv; j++)</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;         {</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;            <span class="keywordflow">if</span> (vmark[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j]]) { hit = <span class="keyword">true</span>; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;         }</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;      }</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;      <span class="keywordflow">if</span> (hit) { expanded.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(testme); }</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;   }</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;}</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;</div>
<div class="line"><a name="l03296"></a><span class="lineno"><a class="line" href="structmfem_1_1RefTrf.html#a4306c8ed8c80e192a3ac63943afac98a"> 3296</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1RefTrf.html#a4306c8ed8c80e192a3ac63943afac98a">RefTrf::Apply</a>(<span class="keyword">const</span> <a class="code" href="namespacemfem.html#aba8d560521a8c41b02479acc42e45f02">RefCoord</a> src[3], <a class="code" href="namespacemfem.html#aba8d560521a8c41b02479acc42e45f02">RefCoord</a> dst[3])<span class="keyword"> const</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;   {</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      dst[i] = (src[i]*s[i] &gt;&gt; 1) + t[i];</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;   }</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;}</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;</div>
<div class="line"><a name="l03304"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#afa8b1cc928da42cf74d56207cbd1daa3"> 3304</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#afa8b1cc928da42cf74d56207cbd1daa3">NCMesh::GetVertexRootCoord</a>(<span class="keywordtype">int</span> elem, <a class="code" href="classmfem_1_1NCMesh.html#a9803d9f8c7027d9f7d691f85f5e2ba4f">RefCoord</a> coord[3])<span class="keyword"> const</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;   <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;   {</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;      <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">parent</a> &lt; 0) { <span class="keywordflow">return</span> elem; }</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;pa = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">parent</a>];</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      MFEM_ASSERT(pa.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>, <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;      <span class="keywordtype">int</span> ch = 0;</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      <span class="keywordflow">while</span> (ch &lt; 8 &amp;&amp; pa.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[ch] != elem) { ch++; }</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;      MFEM_ASSERT(ch &lt; 8, <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      MFEM_ASSERT(geom_parent[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()], <span class="stringliteral">&quot;unsupported geometry&quot;</span>);</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1RefTrf.html">RefTrf</a> &amp;tr = geom_parent[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()][(int) pa.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>][ch];</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      tr.<a class="code" href="structmfem_1_1RefTrf.html#a4306c8ed8c80e192a3ac63943afac98a">Apply</a>(coord, coord);</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      elem = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">parent</a>;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;   }</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;}</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> RefPointInside(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>, <span class="keyword">const</span> <a class="code" href="namespacemfem.html#aba8d560521a8c41b02479acc42e45f02">RefCoord</a> pt[3])</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;{</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;   <span class="keywordflow">switch</span> (geom)</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;   {</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>:</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;         <span class="keywordflow">return</span> (pt[0] &gt;= 0) &amp;&amp; (pt[0] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>) &amp;&amp;</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                (pt[1] &gt;= 0) &amp;&amp; (pt[1] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>);</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>:</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;         <span class="keywordflow">return</span> (pt[0] &gt;= 0) &amp;&amp; (pt[0] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>) &amp;&amp;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;                (pt[1] &gt;= 0) &amp;&amp; (pt[1] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>) &amp;&amp;</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                (pt[2] &gt;= 0) &amp;&amp; (pt[2] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>);</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>:</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;         <span class="keywordflow">return</span> (pt[0] &gt;= 0) &amp;&amp; (pt[1] &gt;= 0) &amp;&amp; (pt[0] + pt[1] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>:</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;         <span class="keywordflow">return</span> (pt[0] &gt;= 0) &amp;&amp; (pt[1] &gt;= 0) &amp;&amp; (pt[0] + pt[1] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>) &amp;&amp;</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;                (pt[2] &gt;= 0) &amp;&amp; (pt[2] &lt;= <a class="code" href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">T_ONE</a>);</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;unsupported geometry&quot;</span>);</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;         <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;   }</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;}</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;</div>
<div class="line"><a name="l03352"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a8996fd1c5aedb5f941f86de85fdd1541"> 3352</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a8996fd1c5aedb5f941f86de85fdd1541">NCMesh::CollectIncidentElements</a>(<span class="keywordtype">int</span> elem, <span class="keyword">const</span> <a class="code" href="classmfem_1_1NCMesh.html#a9803d9f8c7027d9f7d691f85f5e2ba4f">RefCoord</a> coord[3],</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;                                     <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;list)<span class="keyword"> const</span></div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;   <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;   {</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;      list.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(elem);</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;   }</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a9803d9f8c7027d9f7d691f85f5e2ba4f">RefCoord</a> tcoord[3];</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[ch] &gt;= 0; ch++)</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;   {</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1RefTrf.html">RefTrf</a> &amp;tr = geom_child[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()][(int) el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>][ch];</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;      tr.<a class="code" href="structmfem_1_1RefTrf.html#a4306c8ed8c80e192a3ac63943afac98a">Apply</a>(coord, tcoord);</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;      <span class="keywordflow">if</span> (RefPointInside(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>(), tcoord))</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;      {</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a8996fd1c5aedb5f941f86de85fdd1541">CollectIncidentElements</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[ch], tcoord, list);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;      }</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;   }</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;}</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;</div>
<div class="line"><a name="l03375"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a6f17fc9b7fe7f861ed146b9c12d711fe"> 3375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a6f17fc9b7fe7f861ed146b9c12d711fe">NCMesh::FindVertexCousins</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> local, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;cousins)<span class="keyword"> const</span></div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a9803d9f8c7027d9f7d691f85f5e2ba4f">RefCoord</a> coord[3];</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;   MFEM_ASSERT(geom_corners[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()], <span class="stringliteral">&quot;unsupported geometry&quot;</span>);</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;   std::memcpy(coord, geom_corners[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()][local], <span class="keyword">sizeof</span>(coord));</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;   <span class="keywordtype">int</span> root = <a class="code" href="classmfem_1_1NCMesh.html#afa8b1cc928da42cf74d56207cbd1daa3">GetVertexRootCoord</a>(elem, coord);</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;   cousins.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a8996fd1c5aedb5f941f86de85fdd1541">CollectIncidentElements</a>(root, coord, cousins);</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;}</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;<span class="comment">//// Coarse/fine transformations ///////////////////////////////////////////////</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l03392"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1PointMatrix.html#abad6e9611bc85e85ae7c58ccc030df19"> 3392</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html#abad6e9611bc85e85ae7c58ccc030df19">NCMesh::PointMatrix::GetMatrix</a>(<a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a>&amp; point_matrix)<span class="keyword"> const</span></div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;   point_matrix.<a class="code" href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">SetSize</a>(points[0].<a class="code" href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a>, np);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; np; i++)</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;   {</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; points[0].dim; j++)</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;      {</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;         point_matrix(j, i) = points[i].coord[j];</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;      }</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;   }</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;}</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">NCMesh::PointMatrix</a> <a class="code" href="classmfem_1_1NCMesh.html#af61c2d357a89d2e73404e68e469e3383">NCMesh::pm_tri_identity</a>(</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1)</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">NCMesh::PointMatrix</a> <a class="code" href="classmfem_1_1NCMesh.html#a509686371a908c7d100910c2548978f0">NCMesh::pm_quad_identity</a>(</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 1), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1)</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;);</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">NCMesh::PointMatrix</a> <a class="code" href="classmfem_1_1NCMesh.html#a02ca6f7a503b2587f58121402a17c620">NCMesh::pm_tet_identity</a>(</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0, 1)</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;);</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">NCMesh::PointMatrix</a> <a class="code" href="classmfem_1_1NCMesh.html#a2dbe28d9401556e7d53f19dbcb2193ad">NCMesh::pm_prism_identity</a>(</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1, 0),</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0, 1), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0, 1), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1, 1)</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;);</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">NCMesh::PointMatrix</a> <a class="code" href="classmfem_1_1NCMesh.html#af64380c06b9ff471f9ade1a948a66c84">NCMesh::pm_hex_identity</a>(</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 1, 0), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1, 0),</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 0, 1), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 0, 1), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(1, 1, 1), <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a>(0, 1, 1)</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;);</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;</div>
<div class="line"><a name="l03422"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab0249551c32f6f4348b9d3c75580e150"> 3422</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">NCMesh::PointMatrix</a>&amp; <a class="code" href="classmfem_1_1NCMesh.html#ab0249551c32f6f4348b9d3c75580e150">NCMesh::GetGeomIdentity</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom)</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;{</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;   <span class="keywordflow">switch</span> (geom)</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;   {</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>:    <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#af61c2d357a89d2e73404e68e469e3383">pm_tri_identity</a>;</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>:      <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a509686371a908c7d100910c2548978f0">pm_quad_identity</a>;</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>: <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a02ca6f7a503b2587f58121402a17c620">pm_tet_identity</a>;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>:       <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a2dbe28d9401556e7d53f19dbcb2193ad">pm_prism_identity</a>;</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>:        <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#af64380c06b9ff471f9ade1a948a66c84">pm_hex_identity</a>;</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;         MFEM_ABORT(<span class="stringliteral">&quot;unsupported geometry &quot;</span> &lt;&lt; geom);</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#af61c2d357a89d2e73404e68e469e3383">pm_tri_identity</a>;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;   }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;}</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;</div>
<div class="line"><a name="l03437"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a6048ffc8429397e0e3aac8e6b2424b13"> 3437</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a6048ffc8429397e0e3aac8e6b2424b13">NCMesh::GetPointMatrix</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom, <span class="keyword">const</span> <span class="keywordtype">char</span>* ref_path,</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;                            <a class="code" href="classmfem_1_1DenseMatrix.html">DenseMatrix</a>&amp; matrix)</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;{</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a> pm = <a class="code" href="classmfem_1_1NCMesh.html#ab0249551c32f6f4348b9d3c75580e150">GetGeomIdentity</a>(geom);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;   <span class="keywordflow">while</span> (*ref_path)</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;   {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <span class="keywordtype">int</span> ref_type = *ref_path++;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;      <span class="keywordtype">int</span> child = *ref_path++;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;      <span class="comment">// TODO: do this with the new child transform tables</span></div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;      <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>)</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;      {</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;         <span class="keywordflow">if</span> (ref_type == 1) <span class="comment">// split along X axis</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;         {</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid23(pm(2), pm(3));</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid67(pm(6), pm(7)), mid45(pm(4), pm(5));</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;            {</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid23, pm(3),</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                                pm(4), mid45, mid67, pm(7));</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;            }</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;            {</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), pm(2), mid23,</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;                                mid45, pm(5), pm(6), mid67);</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;            }</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;         }</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 2) <span class="comment">// split along Y axis</span></div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;         {</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid12(pm(1), pm(2)), mid30(pm(3), pm(0));</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid56(pm(5), pm(6)), mid74(pm(7), pm(4));</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;            {</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pm(1), mid12, mid30,</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                                pm(4), pm(5), mid56, mid74);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;            }</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;            {</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid30, mid12, pm(2), pm(3),</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;                                mid74, mid56, pm(6), pm(7));</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;            }</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;         }</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 4) <span class="comment">// split along Z axis</span></div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;         {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid04(pm(0), pm(4)), mid15(pm(1), pm(5));</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid26(pm(2), pm(6)), mid37(pm(3), pm(7));</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;            {</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pm(1), pm(2), pm(3),</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                                mid04, mid15, mid26, mid37);</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            }</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            {</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid04, mid15, mid26, mid37,</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                                pm(4), pm(5), pm(6), pm(7));</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            }</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;         }</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 3) <span class="comment">// XY split</span></div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;         {</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2));</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid23(pm(2), pm(3)), mid30(pm(3), pm(0));</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid45(pm(4), pm(5)), mid56(pm(5), pm(6));</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid67(pm(6), pm(7)), mid74(pm(7), pm(4));</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf0(mid23, mid12, mid01, mid30);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf5(mid45, mid56, mid67, mid74);</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            {</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, midf0, mid30,</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;                                pm(4), mid45, midf5, mid74);</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;            }</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;            {</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12, midf0,</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;                                mid45, pm(5), mid56, midf5);</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;            }</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            {</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf0, mid12, pm(2), mid23,</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;                                midf5, mid56, pm(6), mid67);</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;            }</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;            {</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid30, midf0, mid23, pm(3),</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;                                mid74, midf5, mid67, pm(7));</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;            }</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;         }</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 5) <span class="comment">// XZ split</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;         {</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid23(pm(2), pm(3));</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid45(pm(4), pm(5)), mid67(pm(6), pm(7));</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid04(pm(0), pm(4)), mid15(pm(1), pm(5));</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid26(pm(2), pm(6)), mid37(pm(3), pm(7));</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf1(mid01, mid15, mid45, mid04);</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf3(mid23, mid37, mid67, mid26);</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            {</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid23, pm(3),</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;                                mid04, midf1, midf3, mid37);</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;            }</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;            {</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), pm(2), mid23,</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;                                midf1, mid15, mid26, midf3);</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;            }</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;            {</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf1, mid15, mid26, midf3,</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;                                mid45, pm(5), pm(6), mid67);</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            }</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid04, midf1, midf3, mid37,</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;                                pm(4), mid45, mid67, pm(7));</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            }</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;         }</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 6) <span class="comment">// YZ split</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;         {</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid12(pm(1), pm(2)), mid30(pm(3), pm(0));</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid56(pm(5), pm(6)), mid74(pm(7), pm(4));</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid04(pm(0), pm(4)), mid15(pm(1), pm(5));</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid26(pm(2), pm(6)), mid37(pm(3), pm(7));</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf2(mid12, mid26, mid56, mid15);</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf4(mid30, mid04, mid74, mid37);</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;            {</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pm(1), mid12, mid30,</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                                mid04, mid15, midf2, midf4);</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;            }</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            {</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid30, mid12, pm(2), pm(3),</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;                                midf4, midf2, mid26, mid37);</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            }</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;            {</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid04, mid15, midf2, midf4,</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;                                pm(4), pm(5), mid56, mid74);</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;            }</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;            {</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf4, midf2, mid26, mid37,</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                                mid74, mid56, pm(6), pm(7));</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;            }</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;         }</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 7) <span class="comment">// full isotropic refinement</span></div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;         {</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2));</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid23(pm(2), pm(3)), mid30(pm(3), pm(0));</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid45(pm(4), pm(5)), mid56(pm(5), pm(6));</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid67(pm(6), pm(7)), mid74(pm(7), pm(4));</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid04(pm(0), pm(4)), mid15(pm(1), pm(5));</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid26(pm(2), pm(6)), mid37(pm(3), pm(7));</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf0(mid23, mid12, mid01, mid30);</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf1(mid01, mid15, mid45, mid04);</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf2(mid12, mid26, mid56, mid15);</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf3(mid23, mid37, mid67, mid26);</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf4(mid30, mid04, mid74, mid37);</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf5(mid45, mid56, mid67, mid74);</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midel(midf1, midf3);</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;            {</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, midf0, mid30,</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                                mid04, midf1, midel, midf4);</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;            }</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;            {</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12, midf0,</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                                midf1, mid15, midf2, midel);</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;            }</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;            {</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf0, mid12, pm(2), mid23,</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                                midel, midf2, mid26, midf3);</div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;            }</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;            {</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid30, midf0, mid23, pm(3),</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                                midf4, midel, midf3, mid37);</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;            }</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 4)</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;            {</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid04, midf1, midel, midf4,</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                                pm(4), mid45, midf5, mid74);</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;            }</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 5)</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;            {</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf1, mid15, midf2, midel,</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;                                mid45, pm(5), mid56, midf5);</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 6)</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;            {</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midel, midf2, mid26, midf3,</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                                midf5, mid56, pm(6), mid67);</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;            }</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 7)</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;            {</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf4, midel, midf3, mid37,</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                                mid74, midf5, mid67, pm(7));</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;            }</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;         }</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;      }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>)</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      {</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;         <span class="keywordflow">if</span> (ref_type &lt; 4) <span class="comment">// XY split</span></div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;         {</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2));</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid20(pm(2), pm(0)), mid34(pm(3), pm(4));</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid45(pm(4), pm(5)), mid53(pm(5), pm(3));</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;            {</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid20, pm(3), mid34, mid53);</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;            }</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;            {</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12, mid34, pm(4), mid45);</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;            }</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;            {</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid20, mid12, pm(2), mid53, mid45, pm(5));</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            }</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;            {</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid12, mid20, mid01, mid45, mid53, mid34);</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;            }</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;         }</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 4) <span class="comment">// Z split</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;         {</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid03(pm(0), pm(3)), mid14(pm(1), pm(4)), mid25(pm(2), pm(5));</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;            {</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pm(1), pm(2), mid03, mid14, mid25);</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;            }</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;            {</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid03, mid14, mid25, pm(3), pm(4), pm(5));</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;            }</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;         }</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type &gt; 4) <span class="comment">// iso split</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;         {</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2)), mid20(pm(2), pm(0));</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid34(pm(3), pm(4)), mid45(pm(4), pm(5)), mid53(pm(5), pm(3));</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid03(pm(0), pm(3)), mid14(pm(1), pm(4)), mid25(pm(2), pm(5));</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf2(mid01, mid14, mid34, mid03);</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf3(mid12, mid25, mid45, mid14);</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midf4(mid20, mid03, mid53, mid25);</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;            {</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid20, mid03, midf2, midf4);</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;            }</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;            {</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12, midf2, mid14, midf3);</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;            }</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;            {</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid20, mid12, pm(2), midf4, midf3, mid25);</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;            }</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;            {</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid12, mid20, mid01, midf3, midf4, midf2);</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;            }</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 4)</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;            {</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid03, midf2, midf4, pm(3), mid34, mid53);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;            }</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 5)</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;            {</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf2, mid14, midf3, mid34, pm(4), mid45);</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;            }</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 6)</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;            {</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf4, midf3, mid25, mid53, mid45, pm(5));</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;            }</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 7)</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            {</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midf3, midf4, midf2, mid45, mid53, mid34);</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;            }</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;         }</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;      }</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>)</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;      {</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2)), mid02(pm(2), pm(0));</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid03(pm(0), pm(3)), mid13(pm(1), pm(3)), mid23(pm(2), pm(3));</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;         <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;         {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid02, mid03);</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;         }</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;         {</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12, mid13);</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;         }</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;         {</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid02, mid12, pm(2), mid23);</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;         }</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;         {</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid03, mid13, mid23, pm(3));</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;         }</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 4)</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;         {</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, mid23, mid02, mid03);</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;         }</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 5)</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;         {</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, mid23, mid03, mid13);</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;         }</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 6)</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;         {</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, mid23, mid13, mid12);</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;         }</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 7)</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;         {</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, mid23, mid12, mid02);</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;         }</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;      }</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>)</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;      {</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;         <span class="keywordflow">if</span> (ref_type == 1) <span class="comment">// X split</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;         {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid23(pm(2), pm(3));</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;            {</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid23, pm(3));</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;            }</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;            {</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), pm(2), mid23);</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;            }</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;         }</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 2) <span class="comment">// Y split</span></div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;         {</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid12(pm(1), pm(2)), mid30(pm(3), pm(0));</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;            {</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), pm(1), mid12, mid30);</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;            }</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;            {</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid30, mid12, pm(2), pm(3));</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;            }</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;         }</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ref_type == 3) <span class="comment">// iso split</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;         {</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2));</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid23(pm(2), pm(3)), mid30(pm(3), pm(0));</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> midel(mid01, mid23);</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;            <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;            {</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, midel, mid30);</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            }</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;            {</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12, midel);</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;            }</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;            {</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(midel, mid12, pm(2), mid23);</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;            }</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;            {</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;               pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid30, midel, mid23, pm(3));</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;            }</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;         }</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;      }</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (geom == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>)</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;      {</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Point.html">Point</a> mid01(pm(0), pm(1)), mid12(pm(1), pm(2)), mid20(pm(2), pm(0));</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;         <span class="keywordflow">if</span> (child == 0)</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;         {</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(pm(0), mid01, mid20);</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;         }</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 1)</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;         {</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid01, pm(1), mid12);</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;         }</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 2)</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;         {</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid20, mid12, pm(2));</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;         }</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (child == 3)</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;         {</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            pm = <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a>(mid12, mid20, mid01);</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;         }</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;      }</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;   }</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;   <span class="comment">// write the points to the matrix</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pm.<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html#a0935af69710ea13cfb92f3fce01b39f6">np</a>; i++)</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;   {</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; pm(i).dim; j++)</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;      {</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;         matrix(j, i) = pm(i).coord[j];</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;      }</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;   }</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;}</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;</div>
<div class="line"><a name="l03857"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#adbdecc1f97835142cdf9dbb52743d083"> 3857</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#adbdecc1f97835142cdf9dbb52743d083">NCMesh::MarkCoarseLevel</a>()</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;{</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>());</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;   {</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1NCMesh.html#a453021f5db847ddb6b3374a4b20e2d05">IsGhost</a>(<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem])) { <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(elem); }</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;   }</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.DeleteAll();</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;}</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;</div>
<div class="line"><a name="l03871"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a00b1e30f76a2ca307a1f496d15a26d03"> 3871</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a00b1e30f76a2ca307a1f496d15a26d03">NCMesh::TraverseRefinements</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> coarse_index,</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                                 std::string &amp;ref_path, <a class="code" href="classmfem_1_1NCMesh.html#abdfac962041dc7075255c9736d42e2b8">RefPathMap</a> &amp;map)</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;{</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;   <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;   {</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;      <span class="keywordtype">int</span> &amp;matrix = map[ref_path];</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;      <span class="keywordflow">if</span> (!matrix) { matrix = map.size(); }</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;      <a class="code" href="structmfem_1_1Embedding.html">Embedding</a> &amp;emb = <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>];</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;      emb.<a class="code" href="structmfem_1_1Embedding.html#a6c0f09cfd83c6463c30c48ca598dd00d">parent</a> = coarse_index;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;      emb.<a class="code" href="structmfem_1_1Embedding.html#a7c0c0065f2d81a736e03ff36e2a85807">matrix</a> = matrix - 1;</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;   }</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;   {</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      MFEM_ASSERT(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6e218801d53e2b1a3cdb68a9128e5079">tet_type</a> == 0, <span class="stringliteral">&quot;not implemented&quot;</span>);</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;      ref_path.push_back(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>);</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      ref_path.push_back(0);</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8; i++)</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;      {</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;         <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0)</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;         {</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;            ref_path[ref_path.length()-1] = i;</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a00b1e30f76a2ca307a1f496d15a26d03">TraverseRefinements</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i], coarse_index, ref_path, map);</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;         }</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;      }</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;      ref_path.resize(ref_path.length()-2);</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;   }</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;}</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;</div>
<div class="line"><a name="l03903"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a53e1966c61327fe693e377b40f090ffe"> 3903</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structmfem_1_1CoarseFineTransformations.html">CoarseFineTransformations</a>&amp; <a class="code" href="classmfem_1_1NCMesh.html#a53e1966c61327fe693e377b40f090ffe">NCMesh::GetRefinementTransforms</a>()</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;{</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;   MFEM_VERIFY(<a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() || !<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(),</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;               <span class="stringliteral">&quot;GetRefinementTransforms() must be preceded by MarkCoarseLevel()&quot;</span></div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;               <span class="stringliteral">&quot; and Refine().&quot;</span>);</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.Size())</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;   {</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a33e61c443f5c4bd61647a74959a8e84d">Clear</a>();</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.SetSize(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>());</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;      std::string ref_path;</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;      ref_path.reserve(100);</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#abdfac962041dc7075255c9736d42e2b8">RefPathMap</a> path_map[<a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>];</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; g++)</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;      {</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;         path_map[g][ref_path] = 1; <span class="comment">// empty path == identity</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      }</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;      <span class="keywordtype">int</span> used_geoms = 0;</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      {</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;         <span class="keywordtype">int</span> geom = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>[i]].geom;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a00b1e30f76a2ca307a1f496d15a26d03">TraverseRefinements</a>(<a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>[i], i, ref_path, path_map[geom]);</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;         used_geoms |= (1 &lt;&lt; <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>);</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      }</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; g++)</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      {</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;         <span class="keywordflow">if</span> (used_geoms &amp; (1 &lt;&lt; g))</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;         {</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;            <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a>(g);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;            <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a> &amp;identity = <a class="code" href="classmfem_1_1NCMesh.html#ab0249551c32f6f4348b9d3c75580e150">GetGeomIdentity</a>(geom);</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">point_matrices</a>[g]</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;            .<a class="code" href="classmfem_1_1DenseTensor.html#a2606b2ad26ea8bafed3c67300a5a6143">SetSize</a>(<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>, identity.<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html#a0935af69710ea13cfb92f3fce01b39f6">np</a>, path_map[g].size());</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;            <span class="comment">// calculate the point matrices</span></div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;            RefPathMap::iterator it;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;            <span class="keywordflow">for</span> (it = path_map[g].begin(); it != path_map[g].end(); ++it)</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;            {</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a6048ffc8429397e0e3aac8e6b2424b13">GetPointMatrix</a>(geom, it-&gt;first.c_str(),</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                              <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">point_matrices</a>[g](it-&gt;second-1));</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;            }</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;         }</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;      }</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;   }</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>;</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;}</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;</div>
<div class="line"><a name="l03954"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a64e177f4c546df656e2644ad8a451e2c"> 3954</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structmfem_1_1CoarseFineTransformations.html">CoarseFineTransformations</a>&amp; <a class="code" href="classmfem_1_1NCMesh.html#a64e177f4c546df656e2644ad8a451e2c">NCMesh::GetDerefinementTransforms</a>()</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;{</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;   MFEM_VERIFY(<a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.Size() || !<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(),</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;               <span class="stringliteral">&quot;GetDerefinementTransforms() must be preceded by Derefine().&quot;</span>);</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#af3a0759397426baab1b1032b5160c235">IsInitialized</a>())</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;   {</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      std::map&lt;int, int&gt; mat_no[<a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>];</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; g++)</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      {</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;         mat_no[g][0] = 1; <span class="comment">// 0 == identity</span></div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      }</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;      <span class="comment">// assign numbers to the different matrices used</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>.Size(); i++)</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;      {</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;         <span class="keywordtype">int</span> code = <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[i].matrix;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;         <span class="keywordflow">if</span> (code)</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;         {</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;            <span class="keywordtype">int</span> geom = code &amp; 0xf; <span class="comment">// see SetDerefMatrixCodes()</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;            <span class="keywordtype">int</span> ref_type_child = code &gt;&gt; 4;</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;            <span class="keywordtype">int</span> &amp;matrix = mat_no[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>][ref_type_child];</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;            <span class="keywordflow">if</span> (!matrix) { matrix = mat_no[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>].size(); }</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">embeddings</a>[i].matrix = matrix - 1;</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;         }</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      }</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> g = 0; g &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; g++)</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;      {</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a6cd4a8f03e1f476f953f4f72bbe27f7e">Geoms</a> &amp; (1 &lt;&lt; g))</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;         {</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;            <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a>(g);</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;            <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html">PointMatrix</a> &amp;identity = <a class="code" href="classmfem_1_1NCMesh.html#ab0249551c32f6f4348b9d3c75580e150">GetGeomIdentity</a>(geom);</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">point_matrices</a>[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>]</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;            .<a class="code" href="classmfem_1_1DenseTensor.html#a2606b2ad26ea8bafed3c67300a5a6143">SetSize</a>(<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>, identity.<a class="code" href="structmfem_1_1NCMesh_1_1PointMatrix.html#a0935af69710ea13cfb92f3fce01b39f6">np</a>, mat_no[geom].size());</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;            <span class="comment">// calculate point matrices</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = mat_no[geom].begin(); it != mat_no[<a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>].end(); ++it)</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;            {</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;               <span class="keywordtype">char</span> path[3] = { 0, 0, 0 };</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;               <span class="keywordtype">int</span> code = it-&gt;first;</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;               <span class="keywordflow">if</span> (code)</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;               {</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;                  path[0] = code &gt;&gt; 4;  <span class="comment">// ref_type (see SetDerefMatrixCodes())</span></div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;                  path[1] = code &amp; 0xf; <span class="comment">// child</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;               }</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#a6048ffc8429397e0e3aac8e6b2424b13">GetPointMatrix</a>(geom, path,</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                              <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">point_matrices</a>[geom](it-&gt;second-1));</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;            }</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;         }</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;      }</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;   }</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>;</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;}</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="keyword">namespace </span>internal</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;{</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;<span class="comment">// Used in CoarseFineTransformations::GetCoarseToFineMap() below.</span></div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;<span class="keyword">struct </span>RefType</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;{</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;   <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> <a class="code" href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a>;</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;   <span class="keywordtype">int</span> num_children;</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Pair.html">Pair&lt;int,int&gt;</a> *children;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;   RefType(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> g, <span class="keywordtype">int</span> n, <span class="keyword">const</span> <a class="code" href="classmfem_1_1Pair.html">Pair&lt;int,int&gt;</a> *c)</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      : geom(g), num_children(n), children(c) { }</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;   <span class="keywordtype">bool</span> <a class="code" href="namespacemfem.html#af6942d72f9167002282f8345461578d6">operator&lt;</a>(<span class="keyword">const</span> RefType &amp;other)<span class="keyword"> const</span></div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;<span class="keyword">   </span>{</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      <span class="keywordflow">if</span> (geom &lt; other.geom) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;      <span class="keywordflow">if</span> (geom &gt; other.geom) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;      <span class="keywordflow">if</span> (num_children &lt; other.num_children) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;      <span class="keywordflow">if</span> (num_children &gt; other.num_children) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_children; i++)</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;      {</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;         <span class="keywordflow">if</span> (children[i].one &lt; other.children[i].one) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;         <span class="keywordflow">if</span> (children[i].one &gt; other.children[i].one) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;      }</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// everything is equal</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;   }</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;};</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;} <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;</div>
<div class="line"><a name="l04043"></a><span class="lineno"><a class="line" href="structmfem_1_1CoarseFineTransformations.html#a67fde7ae8d4b601f4dab7ec4e4281f12"> 4043</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1CoarseFineTransformations.html#a67fde7ae8d4b601f4dab7ec4e4281f12">CoarseFineTransformations::GetCoarseToFineMap</a>(</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;   <span class="keyword">const</span> <a class="code" href="classmfem_1_1Mesh.html">mfem::Mesh</a> &amp;fine_mesh, <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;coarse_to_fine,</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;coarse_to_ref_type, <a class="code" href="classmfem_1_1Table.html">Table</a> &amp;ref_type_to_matrix,</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;mfem::Geometry::Type&gt;</a> &amp;ref_type_to_geom)<span class="keyword"> const</span></div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> fine_ne = embeddings.Size();</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;   <span class="keywordtype">int</span> coarse_ne = -1;</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fine_ne; i++)</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;   {</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;      coarse_ne = std::max(coarse_ne, embeddings[i].parent);</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;   }</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;   coarse_ne++;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;   coarse_to_ref_type.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(coarse_ne);</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;   coarse_to_fine.<a class="code" href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">SetDims</a>(coarse_ne, fine_ne);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> cf_i(coarse_to_fine.<a class="code" href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">GetI</a>(), coarse_ne+1);</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;Pair&lt;int,int&gt;</a> &gt; cf_j(fine_ne);</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;   cf_i = 0;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fine_ne; i++)</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;   {</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      cf_i[embeddings[i].parent+1]++;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;   }</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;   cf_i.PartialSum();</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;   MFEM_ASSERT(cf_i.Last() == cf_j.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(), <span class="stringliteral">&quot;internal error&quot;</span>);</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fine_ne; i++)</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;   {</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1Embedding.html">Embedding</a> &amp;e = embeddings[i];</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;      cf_j[cf_i[e.<a class="code" href="structmfem_1_1Embedding.html#a6c0f09cfd83c6463c30c48ca598dd00d">parent</a>]].one = e.<a class="code" href="structmfem_1_1Embedding.html#a7c0c0065f2d81a736e03ff36e2a85807">matrix</a>; <span class="comment">// used as sort key below</span></div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;      cf_j[cf_i[e.<a class="code" href="structmfem_1_1Embedding.html#a6c0f09cfd83c6463c30c48ca598dd00d">parent</a>]].two = i;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;      cf_i[e.<a class="code" href="structmfem_1_1Embedding.html#a6c0f09cfd83c6463c30c48ca598dd00d">parent</a>]++;</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;   }</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;   std::copy_backward(cf_i.begin(), cf_i.end()-1, cf_i.end());</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;   cf_i[0] = 0;</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; coarse_ne; i++)</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;   {</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;      std::sort(&amp;cf_j[cf_i[i]], cf_j.<a class="code" href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">GetData</a>() + cf_i[i+1]);</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;   }</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; fine_ne; i++)</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;   {</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;      coarse_to_fine.<a class="code" href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">GetJ</a>()[i] = cf_j[i].two;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;   }</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;   <span class="keyword">using</span> internal::RefType;</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;   <span class="keyword">using</span> std::map;</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;   <span class="keyword">using</span> std::pair;</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;   map&lt;RefType,int&gt; ref_type_map;</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; coarse_ne; i++)</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;   {</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> num_children = cf_i[i+1]-cf_i[i];</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;      MFEM_ASSERT(num_children &gt; 0, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> fine_el = cf_j[cf_i[i]].two;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;      <span class="comment">// Assuming the coarse and the fine elements have the same geometry:</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;      <span class="keyword">const</span> <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">Geometry::Type</a> geom = fine_mesh.<a class="code" href="classmfem_1_1Mesh.html#afeb5f7203337f0d9e5122456d7ec8fb4">GetElementBaseGeometry</a>(fine_el);</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;      <span class="keyword">const</span> RefType ref_type(geom, num_children, &amp;cf_j[cf_i[i]]);</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;      pair&lt;map&lt;RefType,int&gt;::iterator,<span class="keywordtype">bool</span>&gt; res =</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;         ref_type_map.insert(</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;            pair&lt;const RefType,int&gt;(ref_type, (<span class="keywordtype">int</span>)ref_type_map.size()));</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;      coarse_to_ref_type[i] = res.first-&gt;second;</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;   }</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;   ref_type_to_matrix.<a class="code" href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">MakeI</a>((<span class="keywordtype">int</span>)ref_type_map.size());</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;   ref_type_to_geom.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>((<span class="keywordtype">int</span>)ref_type_map.size());</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;   <span class="keywordflow">for</span> (map&lt;RefType,int&gt;::iterator it = ref_type_map.begin();</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;        it != ref_type_map.end(); ++it)</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;   {</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;      ref_type_to_matrix.<a class="code" href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">AddColumnsInRow</a>(it-&gt;second, it-&gt;first.num_children);</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;      ref_type_to_geom[it-&gt;second] = it-&gt;first.geom;</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;   }</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;   ref_type_to_matrix.<a class="code" href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">MakeJ</a>();</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;   <span class="keywordflow">for</span> (map&lt;RefType,int&gt;::iterator it = ref_type_map.begin();</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;        it != ref_type_map.end(); ++it)</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;   {</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;      <span class="keyword">const</span> RefType &amp;rt = it-&gt;first;</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; rt.num_children; j++)</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;      {</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;         ref_type_to_matrix.<a class="code" href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">AddConnection</a>(it-&gt;second, rt.children[j].one);</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;      }</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;   }</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;   ref_type_to_matrix.<a class="code" href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">ShiftUpI</a>();</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;}</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;</div>
<div class="line"><a name="l04127"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aea2756eb16b68912fdcd63ea5f21806d"> 4127</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aea2756eb16b68912fdcd63ea5f21806d">NCMesh::ClearTransforms</a>()</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;{</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">DeleteAll</a>();</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#a33e61c443f5c4bd61647a74959a8e84d">Clear</a>();</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;}</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;</div>
<div class="line"><a name="l04133"></a><span class="lineno"><a class="line" href="structmfem_1_1CoarseFineTransformations.html#a33e61c443f5c4bd61647a74959a8e84d"> 4133</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="structmfem_1_1CoarseFineTransformations.html#a33e61c443f5c4bd61647a74959a8e84d">CoarseFineTransformations::Clear</a>()</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;{</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; i++)</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;   {</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      point_matrices[i].SetSize(0, 0, 0);</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;   }</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;   embeddings.DeleteAll();</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;}</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;</div>
<div class="line"><a name="l04142"></a><span class="lineno"><a class="line" href="structmfem_1_1CoarseFineTransformations.html#af3a0759397426baab1b1032b5160c235"> 4142</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="structmfem_1_1CoarseFineTransformations.html#af3a0759397426baab1b1032b5160c235">CoarseFineTransformations::IsInitialized</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;   <span class="comment">// return true if point matrices are present for any geometry</span></div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; i++)</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;   {</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;      <span class="keywordflow">if</span> (point_matrices[i].SizeK()) { <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;   }</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;   <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;}</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="comment">//// SFC Ordering //////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> sgn(<span class="keywordtype">int</span> x)</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;{</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;   <span class="keywordflow">return</span> (x &lt; 0) ? -1 : (x &gt; 0) ? 1 : 0;</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;}</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> HilbertSfc2D(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> ax, <span class="keywordtype">int</span> ay, <span class="keywordtype">int</span> bx, <span class="keywordtype">int</span> by,</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;                         Array&lt;int&gt; &amp;coords)</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;{</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;   <span class="keywordtype">int</span> w = std::abs(ax + ay);</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;   <span class="keywordtype">int</span> h = std::abs(bx + by);</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;   <span class="keywordtype">int</span> dax = sgn(ax), day = sgn(ay); <span class="comment">// unit major direction (&quot;right&quot;)</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;   <span class="keywordtype">int</span> dbx = sgn(bx), dby = sgn(by); <span class="comment">// unit orthogonal direction (&quot;up&quot;)</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;   <span class="keywordflow">if</span> (h == 1) <span class="comment">// trivial row fill</span></div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;   {</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++, x += dax, y += day)</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      {</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;         coords.Append(x);</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;         coords.Append(y);</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      }</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;   }</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;   <span class="keywordflow">if</span> (w == 1) <span class="comment">// trivial column fill</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;   {</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; h; i++, x += dbx, y += dby)</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;      {</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;         coords.Append(x);</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;         coords.Append(y);</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      }</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;   }</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;   <span class="keywordtype">int</span> ax2 = ax/2, ay2 = ay/2;</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;   <span class="keywordtype">int</span> bx2 = bx/2, by2 = by/2;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;   <span class="keywordtype">int</span> w2 = std::abs(ax2 + ay2);</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;   <span class="keywordtype">int</span> h2 = std::abs(bx2 + by2);</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;   <span class="keywordflow">if</span> (2*w &gt; 3*h) <span class="comment">// long case: split in two parts only</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;   {</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;      <span class="keywordflow">if</span> ((w2 &amp; 0x1) &amp;&amp; (w &gt; 2))</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;      {</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;         ax2 += dax, ay2 += day; <span class="comment">// prefer even steps</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;      }</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;      HilbertSfc2D(x, y, ax2, ay2, bx, by, coords);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;      HilbertSfc2D(x+ax2, y+ay2, ax-ax2, ay-ay2, bx, by, coords);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;   }</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;   <span class="keywordflow">else</span> <span class="comment">// standard case: one step up, one long horizontal step, one step down</span></div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;   {</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;      <span class="keywordflow">if</span> ((h2 &amp; 0x1) &amp;&amp; (h &gt; 2))</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;      {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;         bx2 += dbx, by2 += dby; <span class="comment">// prefer even steps</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;      }</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;      HilbertSfc2D(x, y, bx2, by2, ax2, ay2, coords);</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      HilbertSfc2D(x+bx2, y+by2, ax, ay, bx-bx2, by-by2, coords);</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;      HilbertSfc2D(x+(ax-dax)+(bx2-dbx), y+(ay-day)+(by2-dby),</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                   -bx2, -by2, -(ax-ax2), -(ay-ay2), coords);</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;   }</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;}</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> HilbertSfc3D(<span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> z,</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                         <span class="keywordtype">int</span> ax, <span class="keywordtype">int</span> ay, <span class="keywordtype">int</span> az,</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                         <span class="keywordtype">int</span> bx, <span class="keywordtype">int</span> by, <span class="keywordtype">int</span> bz,</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                         <span class="keywordtype">int</span> cx, <span class="keywordtype">int</span> cy, <span class="keywordtype">int</span> cz,</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                         Array&lt;int&gt; &amp;coords)</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;{</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;   <span class="keywordtype">int</span> w = std::abs(ax + ay + az);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;   <span class="keywordtype">int</span> h = std::abs(bx + by + bz);</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;   <span class="keywordtype">int</span> d = std::abs(cx + cy + cz);</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;   <span class="keywordtype">int</span> dax = sgn(ax), day = sgn(ay), daz = sgn(az); <span class="comment">// unit major dir (&quot;right&quot;)</span></div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;   <span class="keywordtype">int</span> dbx = sgn(bx), dby = sgn(by), dbz = sgn(bz); <span class="comment">// unit ortho dir (&quot;forward&quot;)</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;   <span class="keywordtype">int</span> dcx = sgn(cx), dcy = sgn(cy), dcz = sgn(cz); <span class="comment">// unit ortho dir (&quot;up&quot;)</span></div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;   <span class="comment">// trivial row/column fills</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;   <span class="keywordflow">if</span> (h == 1 &amp;&amp; d == 1)</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;   {</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++, x += dax, y += day, z += daz)</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;      {</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;         coords.Append(x);</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;         coords.Append(y);</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;         coords.Append(z);</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;      }</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;   }</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;   <span class="keywordflow">if</span> (w == 1 &amp;&amp; d == 1)</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;   {</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; h; i++, x += dbx, y += dby, z += dbz)</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;      {</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;         coords.Append(x);</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;         coords.Append(y);</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;         coords.Append(z);</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;      }</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;   }</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;   <span class="keywordflow">if</span> (w == 1 &amp;&amp; h == 1)</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;   {</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; d; i++, x += dcx, y += dcy, z += dcz)</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;      {</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;         coords.Append(x);</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;         coords.Append(y);</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;         coords.Append(z);</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;      }</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;   }</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;   <span class="keywordtype">int</span> ax2 = ax/2, ay2 = ay/2, az2 = az/2;</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;   <span class="keywordtype">int</span> bx2 = bx/2, by2 = by/2, bz2 = bz/2;</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;   <span class="keywordtype">int</span> cx2 = cx/2, cy2 = cy/2, cz2 = cz/2;</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;   <span class="keywordtype">int</span> w2 = std::abs(ax2 + ay2 + az2);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;   <span class="keywordtype">int</span> h2 = std::abs(bx2 + by2 + bz2);</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;   <span class="keywordtype">int</span> d2 = std::abs(cx2 + cy2 + cz2);</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;   <span class="comment">// prefer even steps</span></div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;   <span class="keywordflow">if</span> ((w2 &amp; 0x1) &amp;&amp; (w &gt; 2))</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;   {</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      ax2 += dax, ay2 += day, az2 += daz;</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;   }</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;   <span class="keywordflow">if</span> ((h2 &amp; 0x1) &amp;&amp; (h &gt; 2))</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;   {</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;      bx2 += dbx, by2 += dby, bz2 += dbz;</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;   }</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;   <span class="keywordflow">if</span> ((d2 &amp; 0x1) &amp;&amp; (d &gt; 2))</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;   {</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;      cx2 += dcx, cy2 += dcy, cz2 += dcz;</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;   }</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;</div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;   <span class="comment">// wide case, split in w only</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;   <span class="keywordflow">if</span> ((2*w &gt; 3*h) &amp;&amp; (2*w &gt; 3*d))</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;   {</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;      HilbertSfc3D(x, y, z,</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                   ax2, ay2, az2,</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                   bx, by, bz,</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                   cx, cy, cz, coords);</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;      HilbertSfc3D(x+ax2, y+ay2, z+az2,</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                   ax-ax2, ay-ay2, az-az2,</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                   bx, by, bz,</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                   cx, cy, cz, coords);</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;   }</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;   <span class="comment">// do not split in d</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (3*h &gt; 4*d)</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;   {</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;      HilbertSfc3D(x, y, z,</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                   bx2, by2, bz2,</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                   cx, cy, cz,</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                   ax2, ay2, az2, coords);</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;      HilbertSfc3D(x+bx2, y+by2, z+bz2,</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                   ax, ay, az,</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                   bx-bx2, by-by2, bz-bz2,</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                   cx, cy, cz, coords);</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;      HilbertSfc3D(x+(ax-dax)+(bx2-dbx),</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                   y+(ay-day)+(by2-dby),</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                   z+(az-daz)+(bz2-dbz),</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;                   -bx2, -by2, -bz2,</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                   cx, cy, cz,</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                   -(ax-ax2), -(ay-ay2), -(az-az2), coords);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;   }</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;   <span class="comment">// do not split in h</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (3*d &gt; 4*h)</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;   {</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      HilbertSfc3D(x, y, z,</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;                   cx2, cy2, cz2,</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;                   ax2, ay2, az2,</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;                   bx, by, bz, coords);</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      HilbertSfc3D(x+cx2, y+cy2, z+cz2,</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;                   ax, ay, az,</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;                   bx, by, bz,</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;                   cx-cx2, cy-cy2, cz-cz2, coords);</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;      HilbertSfc3D(x+(ax-dax)+(cx2-dcx),</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                   y+(ay-day)+(cy2-dcy),</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;                   z+(az-daz)+(cz2-dcz),</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;                   -cx2, -cy2, -cz2,</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;                   -(ax-ax2), -(ay-ay2), -(az-az2),</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;                   bx, by, bz, coords);</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;   }</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;   <span class="comment">// regular case, split in all w/h/d</span></div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;   {</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;      HilbertSfc3D(x, y, z,</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;                   bx2, by2, bz2,</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;                   cx2, cy2, cz2,</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;                   ax2, ay2, az2, coords);</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;      HilbertSfc3D(x+bx2, y+by2, z+bz2,</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;                   cx, cy, cz,</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;                   ax2, ay2, az2,</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;                   bx-bx2, by-by2, bz-bz2, coords);</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;      HilbertSfc3D(x+(bx2-dbx)+(cx-dcx),</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;                   y+(by2-dby)+(cy-dcy),</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;                   z+(bz2-dbz)+(cz-dcz),</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;                   ax, ay, az,</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;                   -bx2, -by2, -bz2,</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;                   -(cx-cx2), -(cy-cy2), -(cz-cz2), coords);</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;      HilbertSfc3D(x+(ax-dax)+bx2+(cx-dcx),</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;                   y+(ay-day)+by2+(cy-dcy),</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;                   z+(az-daz)+bz2+(cz-dcz),</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;                   -cx, -cy, -cz,</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;                   -(ax-ax2), -(ay-ay2), -(az-az2),</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;                   bx-bx2, by-by2, bz-bz2, coords);</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;      HilbertSfc3D(x+(ax-dax)+(bx2-dbx),</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;                   y+(ay-day)+(by2-dby),</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                   z+(az-daz)+(bz2-dbz),</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;                   -bx2, -by2, -bz2,</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;                   cx2, cy2, cz2,</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;                   -(ax-ax2), -(ay-ay2), -(az-az2), coords);</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;   }</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;}</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;</div>
<div class="line"><a name="l04375"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#afab9002751a6ab7d1ffa29039ad816ef"> 4375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#afab9002751a6ab7d1ffa29039ad816ef">NCMesh::GridSfcOrdering2D</a>(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;coords)</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;{</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;   coords.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;   coords.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(2*width*height);</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;   <span class="keywordflow">if</span> (width &gt;= height)</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;   {</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;      HilbertSfc2D(0, 0, width, 0, 0, height, coords);</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;   }</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;   {</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;      HilbertSfc2D(0, 0, 0, height, width, 0, coords);</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;   }</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;}</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;</div>
<div class="line"><a name="l04390"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a64b5d88025cba19a073f76529df1d807"> 4390</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a64b5d88025cba19a073f76529df1d807">NCMesh::GridSfcOrdering3D</a>(<span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">int</span> depth,</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                               <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;coords)</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;{</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;   coords.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;   coords.<a class="code" href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">Reserve</a>(3*width*height*depth);</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;   <span class="keywordflow">if</span> (width &gt;= height &amp;&amp; width &gt;= depth)</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;   {</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;      HilbertSfc3D(0, 0, 0,</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                   width, 0, 0,</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                   0, height, 0,</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                   0, 0, depth, coords);</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;   }</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (height &gt;= width &amp;&amp; height &gt;= depth)</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;   {</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      HilbertSfc3D(0, 0, 0,</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;                   0, height, 0,</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;                   width, 0, 0,</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;                   0, 0, depth, coords);</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;   }</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;   <span class="keywordflow">else</span> <span class="comment">// depth &gt;= width &amp;&amp; depth &gt;= height</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;   {</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;      HilbertSfc3D(0, 0, 0,</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;                   0, 0, depth,</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;                   width, 0, 0,</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;                   0, height, 0, coords);</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;   }</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;}</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="comment">//// Utility ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l04422"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a47928516e152d376a46fb5fb141b2e7f"> 4422</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a47928516e152d376a46fb5fb141b2e7f">NCMesh::GetEdgeVertices</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a> &amp;edge_id, <span class="keywordtype">int</span> vert_index[2],</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;                             <span class="keywordtype">bool</span> oriented)<span class="keyword"> const</span></div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[edge_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a1a0eeb9da226cf3dcc4640017f5f9e90">element</a>];</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[(int) edge_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">local</a>];</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;   <span class="keywordtype">int</span> n0 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[0]], n1 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[1]];</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;   if (n0 &gt; n1) { std::swap(n0, n1); }</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;   vert_index[0] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[n0].vert_index;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;   vert_index[1] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[n1].vert_index;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;   <span class="keywordflow">if</span> (oriented &amp;&amp; vert_index[0] &gt; vert_index[1])</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;   {</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;      std::swap(vert_index[0], vert_index[1]);</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;   }</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;}</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;</div>
<div class="line"><a name="l04441"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aa9ee69c2b18d6a2f964aa74d27c053d5"> 4441</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#aa9ee69c2b18d6a2f964aa74d27c053d5">NCMesh::GetEdgeNCOrientation</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">NCMesh::MeshId</a> &amp;edge_id)<span class="keyword"> const</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[edge_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a1a0eeb9da226cf3dcc4640017f5f9e90">element</a>];</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[(int) edge_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">local</a>];</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;   <span class="keywordtype">int</span> v0 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[0]]].vert_index;</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;   <span class="keywordtype">int</span> v1 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[ev[1]]].vert_index;</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;   return ((v0 &lt; v1 &amp;&amp; ev[0] &gt; ev[1]) || (v0 &gt; v1 &amp;&amp; ev[0] &lt; ev[1])) ? -1 : 1;</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;}</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;</div>
<div class="line"><a name="l04453"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae878ee91f13a301143d30ae16b8739af"> 4453</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#ae878ee91f13a301143d30ae16b8739af">NCMesh::GetFaceVerticesEdges</a>(<span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a> &amp;face_id,</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;                                 <span class="keywordtype">int</span> vert_index[4], <span class="keywordtype">int</span> edge_index[4],</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;                                 <span class="keywordtype">int</span> edge_orientation[4])<span class="keyword"> const</span></div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;   MFEM_ASSERT(<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &gt;= 3, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[face_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#a1a0eeb9da226cf3dcc4640017f5f9e90">element</a>];</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> *fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[(int) face_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">local</a>];</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span> nfv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[(<span class="keywordtype">int</span>) face_id.<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">local</a>];</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;   vert_index[3] = edge_index[3] = -1;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;   edge_orientation[3] = 0;</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nfv; i++)</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;   {</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      vert_index[i] = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[i]]].vert_index;</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;   }</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nfv; i++)</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;   {</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <span class="keywordtype">int</span> j = i+1;</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;      <span class="keywordflow">if</span> (j &gt;= nfv) { j = 0; }</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;      <span class="keywordtype">int</span> n1 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[i]];</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;      <span class="keywordtype">int</span> n2 = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[j]];</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a>* en = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Find(n1, n2);</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;      MFEM_ASSERT(en != NULL, <span class="stringliteral">&quot;edge not found.&quot;</span>);</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;      edge_index[i] = en-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">edge_index</a>;</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;      edge_orientation[i] = (vert_index[i] &lt; vert_index[j]) ? 1 : -1;</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;   }</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;   <span class="keywordflow">return</span> nfv;</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;}</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;</div>
<div class="line"><a name="l04491"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a0059a4a867dccaaf56ec2e8972342377"> 4491</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">NCMesh::GetEdgeMaster</a>(<span class="keywordtype">int</span> node)<span class="keyword"> const</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;   MFEM_ASSERT(node &gt;= 0, <span class="stringliteral">&quot;edge node not found.&quot;</span>);</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;nd = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node];</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;   <span class="keywordtype">int</span> p1 = nd.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a>, p2 = nd.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a>;</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;   MFEM_ASSERT(p1 != p2, <span class="stringliteral">&quot;invalid edge node.&quot;</span>);</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;n1 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[p1], &amp;n2 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[p2];</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;   <span class="keywordtype">int</span> n1p1 = n1.<a class="code" href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">p1</a>, n1p2 = n1.<a class="code" href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">p2</a>;</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;   <span class="keywordtype">int</span> n2p1 = n2.p1, n2p2 = n2.p2;</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;   <span class="keywordflow">if</span> ((n2p1 != n2p2) &amp;&amp; (p1 == n2p1 || p1 == n2p2))</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;   {</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;      <span class="comment">// n1 is parent of n2:</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;      <span class="comment">// (n1)--(nd)--(n2)------(*)</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;      <span class="keywordflow">if</span> (n2.HasEdge()) { <span class="keywordflow">return</span> p2; }</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;      <span class="keywordflow">else</span> { <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">GetEdgeMaster</a>(p2); }</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;   }</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;   <span class="keywordflow">if</span> ((n1p1 != n1p2) &amp;&amp; (p2 == n1p1 || p2 == n1p2))</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;   {</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;      <span class="comment">// n2 is parent of n1:</span></div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;      <span class="comment">// (n2)--(nd)--(n1)------(*)</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;      <span class="keywordflow">if</span> (n1.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">HasEdge</a>()) { <span class="keywordflow">return</span> p1; }</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;      <span class="keywordflow">else</span> { <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">GetEdgeMaster</a>(p1); }</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;   }</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;   <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;}</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;</div>
<div class="line"><a name="l04523"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971"> 4523</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">NCMesh::GetEdgeMaster</a>(<span class="keywordtype">int</span> v1, <span class="keywordtype">int</span> v2)<span class="keyword"> const</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;   <span class="keywordtype">int</span> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(<a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[v1], <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>[v2]);</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;   MFEM_ASSERT(node &gt;= 0 &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node].HasEdge(), <span class="stringliteral">&quot;(v1, v2) is not an edge.&quot;</span>);</div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;</div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;   <span class="keywordtype">int</span> master = <a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">GetEdgeMaster</a>(node);</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;   <span class="keywordflow">return</span> (master &gt;= 0) ? <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[master].edge_index : -1;</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;}</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;</div>
<div class="line"><a name="l04532"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a279712688518fa4be7f6d76ea0be34ee"> 4532</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a279712688518fa4be7f6d76ea0be34ee">NCMesh::GetElementDepth</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span></div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;   <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;   <span class="keywordtype">int</span> depth = 0, parent;</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;   <span class="keywordflow">while</span> ((parent = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem].parent) != -1)</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;   {</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;      elem = parent;</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      depth++;</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;   }</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;   <span class="keywordflow">return</span> depth;</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;}</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;</div>
<div class="line"><a name="l04544"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a2de836759b06734cdf6129ecd5fc9560"> 4544</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a2de836759b06734cdf6129ecd5fc9560">NCMesh::GetElementSizeReduction</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span></div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;   <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i];</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;   <span class="keywordtype">int</span> parent, reduction = 1;</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;   <span class="keywordflow">while</span> ((parent = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem].parent) != -1)</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;   {</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[parent].ref_type &amp; 1) { reduction *= 2; }</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[parent].ref_type &amp; 2) { reduction *= 2; }</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[parent].ref_type &amp; 4) { reduction *= 2; }</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;      elem = parent;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;   }</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;   <span class="keywordflow">return</span> reduction;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;}</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;</div>
<div class="line"><a name="l04558"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a71b287a7b416c142047f12c114c71f04"> 4558</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a71b287a7b416c142047f12c114c71f04">NCMesh::GetElementFacesAttributes</a>(<span class="keywordtype">int</span> i,</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                                       <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;<a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>,</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                                       <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;fattr)<span class="keyword"> const</span></div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]];</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;   faces.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>);</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;   fattr.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>);</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;   {</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a> *face = this-&gt;faces.<a class="code" href="classmfem_1_1Array.html#ae34ff5104ab26897a75d09b4f0452d04">Find</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[0]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[1]],</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;                                          el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[2]], el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[3]]);</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;      MFEM_ASSERT(face, <span class="stringliteral">&quot;face not found&quot;</span>);</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;      faces[i] = face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">index</a>;</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;      fattr[i] = face-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a>;</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;   }</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;}</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;</div>
<div class="line"><a name="l04579"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a05db1b202d1989758fb4a1cb87389dbe"> 4579</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a05db1b202d1989758fb4a1cb87389dbe">NCMesh::FindFaceNodes</a>(<span class="keywordtype">int</span> face, <span class="keywordtype">int</span> node[4])</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;{</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;   <span class="comment">// Obtain face nodes from one of its elements (note that face-&gt;p1, p2, p3</span></div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;   <span class="comment">// cannot be used directly since they are not in order and p4 is missing).</span></div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a> &amp;fa = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[face];</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;   <span class="keywordtype">int</span> elem = fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a1a76a2a0b519ad0aab8710895d0b928b">elem</a>[0];</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;   <span class="keywordflow">if</span> (elem &lt; 0) { elem = fa.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#a1a76a2a0b519ad0aab8710895d0b928b">elem</a>[1]; }</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;   MFEM_ASSERT(elem &gt;= 0, <span class="stringliteral">&quot;Face has no elements?&quot;</span>);</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;   <span class="keywordtype">int</span> f = <a class="code" href="classmfem_1_1NCMesh.html#afd473a17fba9e83c68615747cfec296c">find_local_face</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>(),</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;                           <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, fa.<a class="code" href="structmfem_1_1Hashed4.html#ac4f859c8886967c443f65c5db8bf281a">p1</a>),</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;                           <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, fa.<a class="code" href="structmfem_1_1Hashed4.html#a94085f4a13f7fb9b991924b19ebdd2f4">p2</a>),</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;                           <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, fa.<a class="code" href="structmfem_1_1Hashed4.html#a6d70fbc117b45c99aa71936612c3c712">p3</a>));</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[f];</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;   {</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;      node[i] = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[i]];</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;   }</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;}</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;</div>
<div class="line"><a name="l04603"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a196539a6ae81741e71e6095bea6d4aef"> 4603</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a196539a6ae81741e71e6095bea6d4aef">NCMesh::GetBoundaryClosure</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;bdr_attr_is_ess,</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;                                <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;bdr_vertices, <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;bdr_edges)</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;{</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;   bdr_vertices.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;   bdr_edges.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> == 3)</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;   {</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a0666aba4aa9e055c0f4cb604457212cc">GetFaceList</a>(); <span class="comment">// make sure &#39;boundary_faces&#39; is up to date</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;      {</div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;         <span class="keywordtype">int</span> face = <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>[i];</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;         <span class="keywordflow">if</span> (bdr_attr_is_ess[<a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[face].attribute - 1])</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;         {</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;            <span class="keywordtype">int</span> node[4];</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#a05db1b202d1989758fb4a1cb87389dbe">FindFaceNodes</a>(face, node);</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;            <span class="keywordtype">int</span> nfv = (node[3] &lt; 0) ? 3 : 4;</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nfv; j++)</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;            {</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;               bdr_vertices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node[j]].vert_index);</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;               <span class="keywordtype">int</span> enode = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(node[j], node[(j+1) % nfv]);</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;               MFEM_ASSERT(enode &gt;= 0 &amp;&amp; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[enode].HasEdge(), <span class="stringliteral">&quot;Edge not found.&quot;</span>);</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;               bdr_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[enode].edge_index);</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;               <span class="keywordflow">while</span> ((enode = <a class="code" href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">GetEdgeMaster</a>(enode)) &gt;= 0)</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;               {</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;                  <span class="comment">// append master edges that may not be accessible from any</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;                  <span class="comment">// boundary element, this happens in 3D in re-entrant corners</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;                  bdr_edges.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[enode].edge_index);</div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;               }</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;            }</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;         }</div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;      }</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;   }</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> == 2)</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;   {</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a66a55c978781ac29f1d6e380cd79e28b">GetEdgeList</a>(); <span class="comment">// make sure &#39;boundary_faces&#39; is up to date</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;      {</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;         <span class="keywordtype">int</span> face = <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>[i];</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Face.html">Face</a> &amp;fc = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>[face];</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;         <span class="keywordflow">if</span> (bdr_attr_is_ess[fc.<a class="code" href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">attribute</a> - 1])</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;         {</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;            bdr_vertices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[fc.<a class="code" href="structmfem_1_1Hashed4.html#ac4f859c8886967c443f65c5db8bf281a">p1</a>].vert_index);</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;            bdr_vertices.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[fc.<a class="code" href="structmfem_1_1Hashed4.html#a6d70fbc117b45c99aa71936612c3c712">p3</a>].vert_index);</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;         }</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;      }</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;   }</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;   bdr_vertices.<a class="code" href="classmfem_1_1Array.html#a370c68671fe785d87d9bf2b5b1f4b152">Sort</a>();</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;   bdr_vertices.<a class="code" href="classmfem_1_1Array.html#aab5094e73ef3cc50816b8f6122b33bba">Unique</a>();</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;   bdr_edges.<a class="code" href="classmfem_1_1Array.html#a370c68671fe785d87d9bf2b5b1f4b152">Sort</a>();</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;   bdr_edges.<a class="code" href="classmfem_1_1Array.html#aab5094e73ef3cc50816b8f6122b33bba">Unique</a>();</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;}</div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> max4(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> c, <span class="keywordtype">int</span> d)</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;{</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;   <span class="keywordflow">return</span> std::max(std::max(a, b), std::max(c, d));</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;}</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> max6(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> c, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> e, <span class="keywordtype">int</span> f)</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;{</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;   <span class="keywordflow">return</span> std::max(max4(a, b, c, d), std::max(e, f));</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;}</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> max8(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b, <span class="keywordtype">int</span> c, <span class="keywordtype">int</span> d, <span class="keywordtype">int</span> e, <span class="keywordtype">int</span> f, <span class="keywordtype">int</span> g, <span class="keywordtype">int</span> h)</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;{</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;   <span class="keywordflow">return</span> std::max(max4(a, b, c, d), max4(e, f, g, h));</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;}</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;</div>
<div class="line"><a name="l04676"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aca33fe3034ec45c49451541b76f4cb0d"> 4676</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#aca33fe3034ec45c49451541b76f4cb0d">NCMesh::EdgeSplitLevel</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2)<span class="keyword"> const</span></div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;   <span class="keywordtype">int</span> mid = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.FindId(vn1, vn2);</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;   <span class="keywordflow">if</span> (mid &lt; 0 || !<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[mid].HasVertex()) { <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;   <span class="keywordflow">return</span> 1 + std::max(<a class="code" href="classmfem_1_1NCMesh.html#aca33fe3034ec45c49451541b76f4cb0d">EdgeSplitLevel</a>(vn1, mid), <a class="code" href="classmfem_1_1NCMesh.html#aca33fe3034ec45c49451541b76f4cb0d">EdgeSplitLevel</a>(mid, vn2));</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;}</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;</div>
<div class="line"><a name="l04683"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30"> 4683</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">NCMesh::TriFaceSplitLevel</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3)<span class="keyword"> const</span></div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;   <span class="keywordtype">int</span> mid[3];</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#ac84ca7ecad973da2a711fd786d73a23e">TriFaceSplit</a>(vn1, vn2, vn3, mid) &amp;&amp;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;       <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.FindId(vn1, vn2, vn3) &lt; 0)</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;   {</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;      <span class="keywordflow">return</span> 1 + max4(<a class="code" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">TriFaceSplitLevel</a>(vn1, mid[0], mid[2]),</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;                      <a class="code" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">TriFaceSplitLevel</a>(mid[0], vn2, mid[1]),</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                      <a class="code" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">TriFaceSplitLevel</a>(mid[2], mid[1], vn3),</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                      <a class="code" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">TriFaceSplitLevel</a>(mid[0], mid[1], mid[2]));</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;   }</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;   <span class="keywordflow">else</span> <span class="comment">// not split</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;   {</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;   }</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;}</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;</div>
<div class="line"><a name="l04700"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6"> 4700</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">NCMesh::QuadFaceSplitLevel</a>(<span class="keywordtype">int</span> vn1, <span class="keywordtype">int</span> vn2, <span class="keywordtype">int</span> vn3, <span class="keywordtype">int</span> vn4,</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                                <span class="keywordtype">int</span>&amp; h_level, <span class="keywordtype">int</span>&amp; v_level)<span class="keyword"> const</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;   <span class="keywordtype">int</span> hl1, hl2, vl1, vl2;</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;   <span class="keywordtype">int</span> mid[5];</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e">QuadFaceSplitType</a>(vn1, vn2, vn3, vn4, mid))</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;   {</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;      <span class="keywordflow">case</span> 0: <span class="comment">// not split</span></div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;         h_level = v_level = 0;</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;      <span class="keywordflow">case</span> 1: <span class="comment">// vertical</span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">QuadFaceSplitLevel</a>(vn1, mid[0], mid[2], vn4, hl1, vl1);</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">QuadFaceSplitLevel</a>(mid[0], vn2, vn3, mid[2], hl2, vl2);</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;         h_level = std::max(hl1, hl2);</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;         v_level = std::max(vl1, vl2) + 1;</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;      <span class="keywordflow">default</span>: <span class="comment">// horizontal</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">QuadFaceSplitLevel</a>(vn1, vn2, mid[1], mid[3], hl1, vl1);</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">QuadFaceSplitLevel</a>(mid[3], mid[1], vn3, vn4, hl2, vl2);</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;         h_level = std::max(hl1, hl2) + 1;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;         v_level = std::max(vl1, vl2);</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;   }</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;}</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;</div>
<div class="line"><a name="l04727"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a81d95f8c25fc3480d13762f709ceb8fe"> 4727</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a81d95f8c25fc3480d13762f709ceb8fe">NCMesh::CountSplits</a>(<span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> splits[3])<span class="keyword"> const</span></div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">int</span>* node = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>;</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;   <span class="keywordtype">int</span> elevel[12];</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">ne</a>; i++)</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;   {</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* ev = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">edges</a>[i];</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;      elevel[i] = <a class="code" href="classmfem_1_1NCMesh.html#aca33fe3034ec45c49451541b76f4cb0d">EdgeSplitLevel</a>(node[ev[0]], node[ev[1]]);</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;   }</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;   <span class="keywordtype">int</span> flevel[6][2];</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &gt;= 3)</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;   {</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">nf</a>; i++)</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;      {</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[i];</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;         <span class="keywordflow">if</span> (gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[i] == 4)</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;         {</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;            <a class="code" href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">QuadFaceSplitLevel</a>(node[fv[0]], node[fv[1]],</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                               node[fv[2]], node[fv[3]],</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;                               flevel[i][1], flevel[i][0]);</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;         }</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;         <span class="keywordflow">else</span></div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;         {</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;            flevel[i][1] = 0;</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;            flevel[i][0] =</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;               <a class="code" href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">TriFaceSplitLevel</a>(node[fv[0]], node[fv[1]], node[fv[2]]);</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;         }</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;      }</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;   }</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">Geometry::CUBE</a>)</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;   {</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;      splits[0] = max8(flevel[0][0], flevel[1][0], flevel[3][0], flevel[5][0],</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;                       elevel[0], elevel[2], elevel[4], elevel[6]);</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;      splits[1] = max8(flevel[0][1], flevel[2][0], flevel[4][0], flevel[5][1],</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;                       elevel[1], elevel[3], elevel[5], elevel[7]);</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;      splits[2] = max8(flevel[1][1], flevel[2][1], flevel[3][1], flevel[4][1],</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;                       elevel[8], elevel[9], elevel[10], elevel[11]);</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;   }</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">Geometry::PRISM</a>)</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;   {</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;      splits[0] = splits[1] =</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                     std::max(</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;                        max6(flevel[0][0], flevel[1][0], 0,</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                             flevel[2][0], flevel[3][0], flevel[4][0]),</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;                        max6(elevel[0], elevel[1], elevel[2],</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                             elevel[3], elevel[4], elevel[5]));</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;      splits[2] = max6(flevel[2][1], flevel[3][1], flevel[4][1],</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;                       elevel[6], elevel[7], elevel[8]);</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;   }</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">Geometry::TETRAHEDRON</a>)</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;   {</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;      splits[0] = std::max(</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;                     max4(flevel[0][0], flevel[1][0], flevel[2][0], flevel[3][0]),</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;                     max6(elevel[0], elevel[1], elevel[2],</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;                          elevel[3], elevel[4], elevel[5]));</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;      splits[1] = splits[0];</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;      splits[2] = splits[0];</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;   }</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">Geometry::SQUARE</a>)</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;   {</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;      splits[0] = std::max(elevel[0], elevel[2]);</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;      splits[1] = std::max(elevel[1], elevel[3]);</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;   }</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>() == <a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">Geometry::TRIANGLE</a>)</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;   {</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;      splits[0] = std::max(elevel[0], std::max(elevel[1], elevel[2]));</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;      splits[1] = splits[0];</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;   }</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;   {</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;      MFEM_ABORT(<span class="stringliteral">&quot;Unsupported element geometry.&quot;</span>);</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;   }</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;}</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;</div>
<div class="line"><a name="l04810"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#aa75e7521210568451137c65e11afeea5"> 4810</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#aa75e7521210568451137c65e11afeea5">NCMesh::GetLimitRefinements</a>(<a class="code" href="classmfem_1_1Array.html">Array&lt;Refinement&gt;</a> &amp;refinements, <span class="keywordtype">int</span> max_level)</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;{</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;   {</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#a453021f5db847ddb6b3374a4b20e2d05">IsGhost</a>(<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]])) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      <span class="keywordtype">int</span> splits[3];</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a81d95f8c25fc3480d13762f709ceb8fe">CountSplits</a>(<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i], splits);</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;      <span class="keywordtype">char</span> ref_type = 0;</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>; k++)</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;      {</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;         <span class="keywordflow">if</span> (splits[k] &gt; max_level)</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;         {</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;            ref_type |= (1 &lt;&lt; k);</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;         }</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      }</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;      <span class="keywordflow">if</span> (ref_type)</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;      {</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a>)</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;         {</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;            <span class="comment">// iso meshes should only be modified by iso refinements</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;            ref_type = 7;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;         }</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;         refinements.<a class="code" href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">Append</a>(<a class="code" href="structmfem_1_1Refinement.html">Refinement</a>(i, ref_type));</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      }</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;   }</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;}</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;</div>
<div class="line"><a name="l04840"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a7255eda516a5f617b3fe6567bc40ee23"> 4840</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a7255eda516a5f617b3fe6567bc40ee23">NCMesh::LimitNCLevel</a>(<span class="keywordtype">int</span> max_nc_level)</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;{</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;   MFEM_VERIFY(max_nc_level &gt;= 1, <span class="stringliteral">&quot;&#39;max_nc_level&#39; must be 1 or greater.&quot;</span>);</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;   <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;   {</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      <a class="code" href="classmfem_1_1Array.html">Array&lt;Refinement&gt;</a> refinements;</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#aa75e7521210568451137c65e11afeea5">GetLimitRefinements</a>(refinements, max_nc_level);</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <span class="keywordflow">if</span> (!refinements.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>()) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#af2de6a703ab8986d06a9269f1d562b76">Refine</a>(refinements);</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;   }</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;}</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;</div>
<div class="line"><a name="l04855"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a72869feda95885f216153f15cc3fcfa0"> 4855</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a72869feda95885f216153f15cc3fcfa0">NCMesh::PrintVertexParents</a>(std::ostream &amp;<a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;   <span class="comment">// count vertices with parents</span></div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;   <span class="keywordtype">int</span> nv = 0;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1const__iterator.html">node_const_iterator</a> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.cbegin(); node != <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.cend(); ++node)</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;   {</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      <span class="keywordflow">if</span> (node-&gt;HasVertex() &amp;&amp; node-&gt;p1 != node-&gt;p2) { nv++; }</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;   }</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;   out &lt;&lt; nv &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;   <span class="comment">// print the relations</span></div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1const__iterator.html">node_const_iterator</a> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.cbegin(); node != <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.cend(); ++node)</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;   {</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;      <span class="keywordflow">if</span> (node-&gt;HasVertex() &amp;&amp; node-&gt;p1 != node-&gt;p2)</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;      {</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;         <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;p1 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node-&gt;p1];</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;         <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Node.html">Node</a> &amp;p2 = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>[node-&gt;p2];</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;         MFEM_ASSERT(p1.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a1465dc90d418bd1abfdfa42e19372e99">HasVertex</a>(), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;         MFEM_ASSERT(p2.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#a1465dc90d418bd1abfdfa42e19372e99">HasVertex</a>(), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;         out &lt;&lt; node-&gt;vert_index &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;             &lt;&lt; p1.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#afe002bd1fe00597001783e3bfeb54d80">vert_index</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; p2.<a class="code" href="structmfem_1_1NCMesh_1_1Node.html#afe002bd1fe00597001783e3bfeb54d80">vert_index</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;      }</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;   }</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;}</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;</div>
<div class="line"><a name="l04882"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a643c2de4d2ae90eca9672838aebd6d14"> 4882</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a643c2de4d2ae90eca9672838aebd6d14">NCMesh::LoadVertexParents</a>(std::istream &amp;input)</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;{</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;   <span class="keywordtype">int</span> nv;</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;   input &gt;&gt; nv;</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;   <span class="keywordflow">while</span> (nv--)</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;   {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;      <span class="keywordtype">int</span> id, p1, p2;</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;      input &gt;&gt; <span class="keywordtype">id</span> &gt;&gt; p1 &gt;&gt; p2;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;      MFEM_VERIFY(input, <span class="stringliteral">&quot;problem reading vertex parents.&quot;</span>);</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;      MFEM_VERIFY(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.IdExists(<span class="keywordtype">id</span>), <span class="stringliteral">&quot;vertex &quot;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; not found.&quot;</span>);</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;      MFEM_VERIFY(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.IdExists(p1), <span class="stringliteral">&quot;parent &quot;</span> &lt;&lt; p1 &lt;&lt; <span class="stringliteral">&quot; not found.&quot;</span>);</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;      MFEM_VERIFY(<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.IdExists(p2), <span class="stringliteral">&quot;parent &quot;</span> &lt;&lt; p2 &lt;&lt; <span class="stringliteral">&quot; not found.&quot;</span>);</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      <span class="comment">// assign new parents for the node</span></div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Reparent(<span class="keywordtype">id</span>, p1, p2);</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;      <span class="comment">// NOTE: when loading an AMR mesh, node indices are guaranteed to have</span></div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;      <span class="comment">// the same indices as vertices, see NCMesh::NCMesh.</span></div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;   }</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;}</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;</div>
<div class="line"><a name="l04904"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a9c1f23c6196ace208449f20902343f74"> 4904</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a9c1f23c6196ace208449f20902343f74">NCMesh::SetVertexPositions</a>(<span class="keyword">const</span> <a class="code" href="classmfem_1_1Array.html">Array&lt;mfem::Vertex&gt;</a> &amp;mvertices)</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;{</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;   <span class="keywordtype">int</span> num_top_level = 0;</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1iterator.html">node_iterator</a> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.begin(); node != <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.end(); ++node)</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;   {</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;      <span class="keywordflow">if</span> (node-&gt;p1 == node-&gt;p2) <span class="comment">// see NCMesh::NCMesh</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;      {</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;         MFEM_VERIFY(node.index() == node-&gt;p1, <span class="stringliteral">&quot;invalid top-level vertex.&quot;</span>);</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;         MFEM_VERIFY(node-&gt;HasVertex(), <span class="stringliteral">&quot;top-level vertex not found.&quot;</span>);</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;         MFEM_VERIFY(node-&gt;vert_index == node-&gt;p1, <span class="stringliteral">&quot;bad top-level vertex index&quot;</span>);</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;         num_top_level = std::max(num_top_level, node-&gt;p1 + 1);</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;      }</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;   }</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(3*num_top_level);</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_top_level; i++)</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;   {</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;      std::memcpy(&amp;<a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>[3*i], mvertices[i](), 3*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;   }</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;}</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;</div>
<div class="line"><a name="l04925"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a1dd44115871614d94f5ccb48530efb69"> 4925</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#a1dd44115871614d94f5ccb48530efb69">NCMesh::PrintElements</a>(std::ostream &amp;<a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">out</a>, <span class="keywordtype">int</span> elem, <span class="keywordtype">int</span> &amp;coarse_id)<span class="keyword"> const</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;   <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;   {</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;      <span class="keywordtype">int</span> child_id[8], nch = 0;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;      {</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;         child_id[nch++] = <a class="code" href="classmfem_1_1NCMesh.html#a1dd44115871614d94f5ccb48530efb69">PrintElements</a>(out, el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i], coarse_id);</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;      }</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;      MFEM_ASSERT(nch == ref_type_num_children[(<span class="keywordtype">int</span>) el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>], <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;      out &lt;&lt; (int) el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>;</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;      for (<span class="keywordtype">int</span> i = 0; i &lt; nch; i++)</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;      {</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;         out &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; child_id[i];</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;      }</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;      out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;      <span class="keywordflow">return</span> coarse_id++; <span class="comment">// return new id for this coarse element</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;   }</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;   {</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;      <span class="keywordflow">return</span> el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">index</a>;</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;   }</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;}</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;</div>
<div class="line"><a name="l04951"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a84c94efb0598219f239132ec87867f8d"> 4951</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a84c94efb0598219f239132ec87867f8d">NCMesh::PrintCoarseElements</a>(std::ostream &amp;<a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;   <span class="comment">// print the number of non-leaf elements</span></div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;   out &lt;&lt; (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size() - <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() - <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>())</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;   <span class="comment">// print the hierarchy recursively</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;   <span class="keywordtype">int</span> coarse_id = <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;   {</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a1dd44115871614d94f5ccb48530efb69">PrintElements</a>(out, i, coarse_id);</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;   }</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;}</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;</div>
<div class="line"><a name="l04965"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a702405685b5acdbb2df588141d18ba74"> 4965</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a702405685b5acdbb2df588141d18ba74">NCMesh::CopyElements</a>(<span class="keywordtype">int</span> elem,</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;                          <span class="keyword">const</span> <a class="code" href="classmfem_1_1BlockArray.html">BlockArray&lt;Element&gt;</a> &amp;tmp_elements,</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;                          <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> &amp;index_map)</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;{</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;   <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;   <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a>)</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;   {</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8 &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] &gt;= 0; i++)</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;      {</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;         <span class="keywordtype">int</span> old_id = el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i];</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;         <span class="comment">// here, we do not use the content of &#39;free_element_ids&#39;, if any</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;         <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Append(tmp_elements[old_id]);</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;         index_map[old_id] = new_id;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] = new_id;</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[new_id].parent = elem;</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;         <a class="code" href="classmfem_1_1NCMesh.html#a702405685b5acdbb2df588141d18ba74">CopyElements</a>(new_id, tmp_elements, index_map);</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;      }</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;   }</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;}</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;</div>
<div class="line"><a name="l04985"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a273c22e88f72026d2d1e1522505f476b"> 4985</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a273c22e88f72026d2d1e1522505f476b">NCMesh::LoadCoarseElements</a>(std::istream &amp;input)</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;{</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;   <span class="keywordtype">int</span> ne;</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;   input &gt;&gt; ne;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;   <span class="keywordtype">bool</span> iso = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;   <span class="comment">// load the coarse elements</span></div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;   <span class="keywordflow">while</span> (ne--)</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;   {</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <span class="keywordtype">int</span> ref_type;</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      input &gt;&gt; ref_type;</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;      <span class="keywordtype">int</span> elem = <a class="code" href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">AddElement</a>(<a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>(<a class="code" href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a5ae699bb2bc0c842ef374bf37a8e73ae">Geometry::INVALID</a>, 0));</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;      el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> = ref_type;</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> == 3 &amp;&amp; ref_type != 7) { iso = <span class="keyword">false</span>; }</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;      <span class="comment">// load child IDs and make parent-child links</span></div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;      <span class="keywordtype">int</span> nch = ref_type_num_children[ref_type];</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, <span class="keywordtype">id</span>; i &lt; nch; i++)</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;      {</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;         input &gt;&gt; id;</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;         MFEM_VERIFY(<span class="keywordtype">id</span> &gt;= 0, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;         MFEM_VERIFY(<span class="keywordtype">id</span> &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() ||</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;                     <span class="keywordtype">id</span> &lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size()-<a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(),</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;                     <span class="stringliteral">&quot;coarse element cannot be referenced before it is &quot;</span></div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;                     <span class="stringliteral">&quot;defined (id=&quot;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>);</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;         <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;child = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[id];</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;         MFEM_VERIFY(child.parent == -1,</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;                     <span class="stringliteral">&quot;element &quot;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; cannot have two parents.&quot;</span>);</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;         el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">child</a>[i] = id;</div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;         child.parent = elem;</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;         <span class="keywordflow">if</span> (!i) <span class="comment">// copy geom and attribute from first child</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;         {</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;            el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">geom</a> = child.geom;</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;            el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#aea98bd2662eb60edfce0ed01f98085b8">attribute</a> = child.attribute;</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;         }</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      }</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;   }</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;   <span class="comment">// prepare for reordering the elements</span></div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;   <a class="code" href="classmfem_1_1BlockArray.html">BlockArray&lt;Element&gt;</a> tmp_elements;</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Swap(tmp_elements);</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">SetSize</a>(0);</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;   <a class="code" href="classmfem_1_1Array.html">Array&lt;int&gt;</a> index_map(tmp_elements.<a class="code" href="classmfem_1_1BlockArray.html#ae612faa528d17e632a27a04319d7f37b">Size</a>());</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;   index_map = -1;</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;   <span class="comment">// copy roots, they need to be at the beginning of &#39;elements&#39;</span></div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;   <span class="keywordtype">int</span> root_count = 0;</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1BlockArray_1_1iterator.html">elem_iterator</a> el = tmp_elements.<a class="code" href="classmfem_1_1BlockArray.html#a5120895466f8b74d7423fb3720e6e447">begin</a>(); el != tmp_elements.<a class="code" href="classmfem_1_1BlockArray.html#a7d6fc9d341615ed5e63e5de88d930ce5">end</a>(); ++el)</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;   {</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      <span class="keywordflow">if</span> (el-&gt;parent == -1)</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      {</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;         <span class="keywordtype">int</span> new_id = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Append(*el); <span class="comment">// same as AddElement()</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;         index_map[el.index()] = new_id;</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;         root_count++;</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;      }</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;   }</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;   <span class="comment">// copy the rest of the hierarchy</span></div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; root_count; i++)</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;   {</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;      <a class="code" href="classmfem_1_1NCMesh.html#a702405685b5acdbb2df588141d18ba74">CopyElements</a>(i, tmp_elements, index_map);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;   }</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;   <span class="comment">// we also need to renumber element links in Face::elem[]</span></div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1iterator.html">face_iterator</a> face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.begin(); face != <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.end(); ++face)</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;   {</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;      {</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;         <span class="keywordflow">if</span> (face-&gt;elem[i] &gt;= 0)</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;         {</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;            face-&gt;elem[i] = index_map[face-&gt;elem[i]];</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;            MFEM_ASSERT(face-&gt;elem[i] &gt;= 0, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;         }</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;      }</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;   }</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;   <span class="comment">// set the Iso flag (must be false if there are 3D aniso refinements)</span></div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a> = iso;</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a902bc877ac5ae36802f5540d5ad3bcf8">InitRootState</a>(root_count);</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae4dfc79d23b8ae298504f35e8dfdcdf2">InitGeomFlags</a>();</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">Update</a>();</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;}</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;</div>
<div class="line"><a name="l05078"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a0a1527ca37e7107a32ced3f823e6e3d0"> 5078</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a0a1527ca37e7107a32ced3f823e6e3d0">NCMesh::Trim</a>()</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;{</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">Clear</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">DeleteAll</a>();</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">Clear</a>();</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#aea2756eb16b68912fdcd63ea5f21806d">ClearTransforms</a>();</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;}</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;</div>
<div class="line"><a name="l05090"></a><span class="lineno"><a class="line" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845"> 5090</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">NCMesh::NCList::MemoryUsage</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;   <span class="keywordtype">int</span> pmsize = 0;</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;   <span class="keywordflow">if</span> (slaves.size())</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;   {</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;      pmsize = slaves[0].point_matrix.MemoryUsage();</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;   }</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;   <span class="keywordflow">return</span> conforming.capacity() * <span class="keyword">sizeof</span>(<a class="code" href="structmfem_1_1NCMesh_1_1MeshId.html">MeshId</a>) +</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;          masters.capacity() * <span class="keyword">sizeof</span>(<a class="code" href="structmfem_1_1NCMesh_1_1Master.html">Master</a>) +</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;          slaves.capacity() * <span class="keyword">sizeof</span>(<a class="code" href="structmfem_1_1NCMesh_1_1Slave.html">Slave</a>) +</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;          slaves.size() * pmsize;</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;}</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;</div>
<div class="line"><a name="l05104"></a><span class="lineno"><a class="line" href="structmfem_1_1CoarseFineTransformations.html#ac9de427ce790fe47f209ca0682d0e23c"> 5104</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="structmfem_1_1CoarseFineTransformations.html#ac9de427ce790fe47f209ca0682d0e23c">CoarseFineTransformations::MemoryUsage</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;   <span class="keywordtype">long</span> mem = embeddings.MemoryUsage();</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">Geometry::NumGeom</a>; i++)</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;   {</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;      mem += point_matrices[i].MemoryUsage();</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;   }</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;   <span class="keywordflow">return</span> mem;</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;}</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;</div>
<div class="line"><a name="l05114"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a41cccc67d8ab0a070b103b83ba8e450c"> 5114</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="classmfem_1_1NCMesh.html#a41cccc67d8ab0a070b103b83ba8e450c">NCMesh::MemoryUsage</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.MemoryUsage() +</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.MemoryUsage() +</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.MemoryUsage() +</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>() +</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>() +</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>() +</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#add6de476a3eded16ee0eccdaf08c973b">MemoryUsage</a>() +</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.MemoryUsage() +</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">derefinements</a>.<a class="code" href="classmfem_1_1Table.html#add6de476a3eded16ee0eccdaf08c973b">MemoryUsage</a>() +</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ac9de427ce790fe47f209ca0682d0e23c">MemoryUsage</a>() +</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;          <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() +</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;          <span class="keyword">sizeof</span>(*this);</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;}</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;</div>
<div class="line"><a name="l05136"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#afb27e53bef16128ae6b9363a61825a74"> 5136</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="classmfem_1_1NCMesh.html#afb27e53bef16128ae6b9363a61825a74">NCMesh::PrintMemoryDetail</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.PrintMemoryDetail(); <a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot; nodes\n&quot;</span>;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.PrintMemoryDetail(); <a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">mfem::out</a> &lt;&lt; <span class="stringliteral">&quot; faces\n&quot;</span>;</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;   <a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">mfem::out</a> &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.MemoryUsage() &lt;&lt; <span class="stringliteral">&quot; elements\n&quot;</span></div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; free_element_ids\n&quot;</span></div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; root_state\n&quot;</span></div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">top_vertex_pos</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; top_vertex_pos\n&quot;</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; leaf_elements\n&quot;</span></div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; vertex_nodeId\n&quot;</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; face_list\n&quot;</span></div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; edge_list\n&quot;</span></div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">vertex_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; vertex_list\n&quot;</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">boundary_faces</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; boundary_faces\n&quot;</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">element_vertex</a>.<a class="code" href="classmfem_1_1Table.html#add6de476a3eded16ee0eccdaf08c973b">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; element_vertex\n&quot;</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">ref_stack</a>.MemoryUsage() &lt;&lt; <span class="stringliteral">&quot; ref_stack\n&quot;</span></div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">derefinements</a>.<a class="code" href="classmfem_1_1Table.html#add6de476a3eded16ee0eccdaf08c973b">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; derefinements\n&quot;</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">transforms</a>.<a class="code" href="structmfem_1_1CoarseFineTransformations.html#ac9de427ce790fe47f209ca0682d0e23c">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; transforms\n&quot;</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;             &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">coarse_elements</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>() &lt;&lt; <span class="stringliteral">&quot; coarse_elements\n&quot;</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;             &lt;&lt; <span class="keyword">sizeof</span>(*this) &lt;&lt; <span class="stringliteral">&quot; NCMesh&quot;</span></div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;             &lt;&lt; std::endl;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;   <span class="keywordflow">return</span> <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size() - <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>();</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;}</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;</div>
<div class="line"><a name="l05162"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#ae4a688fad31590e4b7d1f82ef9991011"> 5162</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#ae4a688fad31590e4b7d1f82ef9991011">NCMesh::PrintStats</a>(std::ostream &amp;<a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> MiB = 1024.*1024.;</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;   out &lt;&lt;</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;       <span class="stringliteral">&quot;NCMesh statistics:\n&quot;</span></div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;       <span class="stringliteral">&quot;------------------\n&quot;</span></div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;       <span class="stringliteral">&quot;   mesh and space dimensions : &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#acf99393a0d32a11cca34ae65980b7848">spaceDim</a> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;       <span class="stringliteral">&quot;   isotropic only            : &quot;</span> &lt;&lt; (<a class="code" href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">Iso</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;       <span class="stringliteral">&quot;   number of Nodes           : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Size() &lt;&lt; <span class="stringliteral">&quot; +    [ &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.MemoryUsage()/MiB &lt;&lt; <span class="stringliteral">&quot; MiB ]\n&quot;</span></div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;       <span class="stringliteral">&quot;      free                     &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumFreeIds() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;       <span class="stringliteral">&quot;   number of Faces           : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Size() &lt;&lt; <span class="stringliteral">&quot; +    [ &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.MemoryUsage()/MiB &lt;&lt; <span class="stringliteral">&quot; MiB ]\n&quot;</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;       <span class="stringliteral">&quot;      free                     &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.NumFreeIds() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;       <span class="stringliteral">&quot;   number of Elements        : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size()-<a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt;&lt; <span class="stringliteral">&quot; +    [ &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;       &lt;&lt; (<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.MemoryUsage() +</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;           <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">MemoryUsage</a>())/MiB &lt;&lt; <span class="stringliteral">&quot; MiB ]\n&quot;</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;       <span class="stringliteral">&quot;      free                     &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">free_element_ids</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;       <span class="stringliteral">&quot;   number of root elements   : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">root_state</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;       <span class="stringliteral">&quot;   number of leaf elements   : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;       <span class="stringliteral">&quot;   number of vertices        : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">vertex_nodeId</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;       <span class="stringliteral">&quot;   number of faces           : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a0d6f2335b6dc74495af661073dded1ea">TotalSize</a>() &lt;&lt; <span class="stringliteral">&quot; =    [ &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>()/MiB &lt;&lt; <span class="stringliteral">&quot; MiB ]\n&quot;</span></div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;       <span class="stringliteral">&quot;      conforming               &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>.size() &lt;&lt; <span class="stringliteral">&quot; +\n&quot;</span></div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;       <span class="stringliteral">&quot;      master                   &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a8de451b39a43064e52f8bfc24b664ccf">masters</a>.size() &lt;&lt; <span class="stringliteral">&quot; +\n&quot;</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;       <span class="stringliteral">&quot;      slave                    &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">face_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;       <span class="stringliteral">&quot;   number of edges           : &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a0d6f2335b6dc74495af661073dded1ea">TotalSize</a>() &lt;&lt; <span class="stringliteral">&quot; =    [ &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">MemoryUsage</a>()/MiB &lt;&lt; <span class="stringliteral">&quot; MiB ]\n&quot;</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;       <span class="stringliteral">&quot;      conforming               &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">conforming</a>.size() &lt;&lt; <span class="stringliteral">&quot; +\n&quot;</span></div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;       <span class="stringliteral">&quot;      master                   &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a8de451b39a43064e52f8bfc24b664ccf">masters</a>.size() &lt;&lt; <span class="stringliteral">&quot; +\n&quot;</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;       <span class="stringliteral">&quot;      slave                    &quot;</span> &lt;&lt; std::setw(9)</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;       &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">edge_list</a>.<a class="code" href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">slaves</a>.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;       <span class="stringliteral">&quot;   total memory              : &quot;</span> &lt;&lt; std::setw(17)</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;[ &quot;</span> &lt;&lt; std::setw(9) &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a41cccc67d8ab0a070b103b83ba8e450c">MemoryUsage</a>()/MiB &lt;&lt; <span class="stringliteral">&quot; MiB ]\n&quot;</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;       ;</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;}</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;<span class="preprocessor">#ifdef MFEM_DEBUG</span></div>
<div class="line"><a name="l05216"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a3a0e1b1dfb45602dce1388dd18a8947d"> 5216</a></span>&#160;<span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a3a0e1b1dfb45602dce1388dd18a8947d">NCMesh::DebugLeafOrder</a>(std::ostream &amp;<a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a> = <span class="keyword">new</span> <a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html">TmpVertex</a>[<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds()];</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>.<a class="code" href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">Size</a>(); i++)</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;   {</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a>* elem = &amp;<a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[<a class="code" href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">leaf_elements</a>[i]];</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">Dim</a>; j++)</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;      {</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;         <span class="keywordtype">double</span> sum = 0.0;</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;         <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 8; k++)</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;         {</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;            <span class="keywordflow">if</span> (elem-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[k] &gt;= 0)</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;            {</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;               sum += <a class="code" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">CalcVertexPos</a>(elem-&gt;<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[k])[j];</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;               count++;</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;            }</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;         }</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;         out &lt;&lt; sum / count &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;      }</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;      out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;   }</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a>;</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;}</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;</div>
<div class="line"><a name="l05241"></a><span class="lineno"><a class="line" href="classmfem_1_1NCMesh.html#a6f84755a52bed89f6e008d157e1c7fb1"> 5241</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classmfem_1_1NCMesh.html#a6f84755a52bed89f6e008d157e1c7fb1">NCMesh::DebugDump</a>(std::ostream &amp;<a class="code" href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;   <span class="comment">// dump nodes</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;   <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a> = <span class="keyword">new</span> <a class="code" href="structmfem_1_1NCMesh_1_1TmpVertex.html">TmpVertex</a>[<a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.NumIds()];</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;   out &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.Size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1const__iterator.html">node_const_iterator</a> node = <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.cbegin(); node != <a class="code" href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">nodes</a>.cend(); ++node)</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;   {</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> *pos = <a class="code" href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">CalcVertexPos</a>(node.index());</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;      out &lt;&lt; node.index() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;          &lt;&lt; pos[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; pos[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;          &lt;&lt; node-&gt;p1 &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; node-&gt;p2 &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;          &lt;&lt; node-&gt;vert_index &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; node-&gt;edge_index &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;          &lt;&lt; 0 &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;   }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;   <span class="keyword">delete</span> [] <a class="code" href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">tmp_vertex</a>;</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;   out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;   <span class="comment">// dump elements</span></div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;   <span class="keywordtype">int</span> nleaves = 0;</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size(); i++)</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;   {</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[i];</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <span class="keywordflow">if</span> (!el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> &amp;&amp; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">parent</a> != -2 <span class="comment">/*freed*/</span>) { nleaves++; }</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;   }</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;   out &lt;&lt; nleaves &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>.Size(); i++)</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;   {</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[i];</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;      <span class="keywordflow">if</span> (el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">ref_type</a> || el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">parent</a> == -2) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html">GeomInfo</a>&amp; gi = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()];</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;      out &lt;&lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; gi.<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">nv</a>; j++)</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      {</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;         out &lt;&lt; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[j] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;      }</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      out &lt;&lt; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#aea98bd2662eb60edfce0ed01f98085b8">attribute</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">rank</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;   }</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;   out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;   <span class="comment">// dump faces</span></div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;   out &lt;&lt; <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.Size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;   <span class="keywordflow">for</span> (<a class="code" href="classmfem_1_1HashTable_1_1const__iterator.html">face_const_iterator</a> face = <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.cbegin(); face != <a class="code" href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">faces</a>.cend(); ++face)</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;   {</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;      <span class="keywordtype">int</span> elem = face-&gt;elem[0];</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;      <span class="keywordflow">if</span> (elem &lt; 0) { elem = face-&gt;elem[1]; }</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;      MFEM_ASSERT(elem &gt;= 0, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;      <span class="keyword">const</span> <a class="code" href="structmfem_1_1NCMesh_1_1Element.html">Element</a> &amp;el = <a class="code" href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">elements</a>[elem];</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;      <span class="keywordtype">int</span> lf = <a class="code" href="classmfem_1_1NCMesh.html#afd473a17fba9e83c68615747cfec296c">find_local_face</a>(el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>(),</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;                               <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, face-&gt;p1),</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;                               <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, face-&gt;p2),</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;                               <a class="code" href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">find_node</a>(el, face-&gt;p3));</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>* fv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">faces</a>[lf];</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nfv = <a class="code" href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">GI</a>[el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">Geom</a>()].<a class="code" href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">nfv</a>[lf];</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;      out &lt;&lt; nfv;</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nfv; i++)</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;      {</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;         out &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; el.<a class="code" href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">node</a>[fv[i]];</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;      }</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;      <span class="comment">//out &lt;&lt; &quot; # face &quot; &lt;&lt; face.index() &lt;&lt; &quot;, index &quot; &lt;&lt; face-&gt;index &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;      out &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;   }</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;}</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;} <span class="comment">// namespace mfem</span></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1TmpVertex_html_a9033ef4e504c10203dfdb2d227c1166f"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1TmpVertex.html#a9033ef4e504c10203dfdb2d227c1166f">mfem::NCMesh::TmpVertex::visited</a></div><div class="ttdeci">bool visited</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00803">ncmesh.hpp:803</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_af1edef0f62170bbbcb9a82baf4bf5341"><div class="ttname"><a href="classmfem_1_1NCMesh.html#af1edef0f62170bbbcb9a82baf4bf5341">mfem::NCMesh::face_list</a></div><div class="ttdeci">NCList face_list</div><div class="ttdoc">lazy-initialized list of faces, see GetFaceList </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00495">ncmesh.hpp:495</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a3d15c1a2d32eace7004f7ce96f9c3397"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a3d15c1a2d32eace7004f7ce96f9c3397">mfem::NCMesh::CollectLeafElements</a></div><div class="ttdeci">void CollectLeafElements(int elem, int state)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01865">ncmesh.cpp:1865</a></div></div>
<div class="ttc" id="namespacemfem_html_af7011f8797a2fd1a474c1567c538aa86"><div class="ttname"><a href="namespacemfem.html#af7011f8797a2fd1a474c1567c538aa86">mfem::CubeFaceTop</a></div><div class="ttdeci">bool CubeFaceTop(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00607">ncmesh.cpp:607</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a94f5d79c10d23fe03c8ea9cb2158dde3"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a94f5d79c10d23fe03c8ea9cb2158dde3">mfem::NCMesh::edge_list</a></div><div class="ttdeci">NCList edge_list</div><div class="ttdoc">lazy-initialized list of edges, see GetEdgeList </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00496">ncmesh.hpp:496</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1PointMatrix_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1PointMatrix.html">mfem::NCMesh::PointMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00740">ncmesh.hpp:740</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab37530e175b27f8da95cab738bfaf59c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab37530e175b27f8da95cab738bfaf59c">mfem::NCMesh::NCMesh</a></div><div class="ttdeci">NCMesh(const Mesh *mesh, std::istream *vertex_parents=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00072">ncmesh.cpp:72</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a8f7e0d60f1bd0d6fb536dd2ab2536ed5">mfem::Geometry::SEGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00037">geom.hpp:37</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a873271d869a8aa0413a50ba3f84a4fe2"><div class="ttname"><a href="classmfem_1_1Element.html#a873271d869a8aa0413a50ba3f84a4fe2">mfem::Element::GetGeometryType</a></div><div class="ttdeci">Geometry::Type GetGeometryType() const </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00052">element.hpp:52</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae2d4ac5d2b80b469be47ed9d982e221a"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae2d4ac5d2b80b469be47ed9d982e221a">mfem::NCMesh::TraverseTriFace</a></div><div class="ttdeci">bool TraverseTriFace(int vn0, int vn1, int vn2, const PointMatrix &amp;pm, int level)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02487">ncmesh.cpp:2487</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a53e8c9c7ef521e07b0613d4a552fe0e2">mfem::Element::SEGMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a813eda5c8de9bfcbf06f89adaff1f8ff"><div class="ttname"><a href="classmfem_1_1Array.html#a813eda5c8de9bfcbf06f89adaff1f8ff">mfem::Array::Size</a></div><div class="ttdeci">int Size() const </div><div class="ttdoc">Logical size of the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00124">array.hpp:124</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a64b5d88025cba19a073f76529df1d807"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a64b5d88025cba19a073f76529df1d807">mfem::NCMesh::GridSfcOrdering3D</a></div><div class="ttdeci">static void GridSfcOrdering3D(int width, int height, int depth, Array&lt; int &gt; &amp;coords)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04390">ncmesh.cpp:4390</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78a436c656492d91d8a836913e8c1b8bf68">mfem::Element::QUADRILATERAL</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a63d2470bbec7b28dd9bdb1a7eba1c6eb"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a63d2470bbec7b28dd9bdb1a7eba1c6eb">mfem::NCMesh::CheckAnisoPrism</a></div><div class="ttdeci">void CheckAnisoPrism(int vn1, int vn2, int vn3, int vn4, const Refinement *refs, int nref)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00722">ncmesh.cpp:722</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_adb350ad2dc92d5726c5f16518a8464f5"><div class="ttname"><a href="classmfem_1_1NCMesh.html#adb350ad2dc92d5726c5f16518a8464f5">mfem::NCMesh::transforms</a></div><div class="ttdeci">CoarseFineTransformations transforms</div><div class="ttdoc">storage for data returned by Get[De]RefinementTransforms() </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00790">ncmesh.hpp:790</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_afab9002751a6ab7d1ffa29039ad816ef"><div class="ttname"><a href="classmfem_1_1NCMesh.html#afab9002751a6ab7d1ffa29039ad816ef">mfem::NCMesh::GridSfcOrdering2D</a></div><div class="ttdeci">static void GridSfcOrdering2D(int width, int height, Array&lt; int &gt; &amp;coords)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04375">ncmesh.cpp:4375</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_acdd1374257e763275b960e0bc3306fc5"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#acdd1374257e763275b960e0bc3306fc5">mfem::NCMesh::GeomInfo::nf</a></div><div class="ttdeci">int nf</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00837">ncmesh.hpp:837</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a925302b78a99b9e693ff78e6e14c4548"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a925302b78a99b9e693ff78e6e14c4548">mfem::NCMesh::NewQuadrilateral</a></div><div class="ttdeci">int NewQuadrilateral(int n0, int n1, int n2, int n3, int attr, int eattr0, int eattr1, int eattr2, int eattr3)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00541">ncmesh.cpp:541</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a2649ebd417db36c5c29371e59bbd65fa"><div class="ttname"><a href="classmfem_1_1Table.html#a2649ebd417db36c5c29371e59bbd65fa">mfem::Table::GetJ</a></div><div class="ttdeci">int * GetJ()</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00114">table.hpp:114</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html"><div class="ttname"><a href="classmfem_1_1Mesh.html">mfem::Mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00049">mesh.hpp:49</a></div></div>
<div class="ttc" id="namespacemfem_html_a67e7a0fda75e3e06b69d5ef218f8b2b5"><div class="ttname"><a href="namespacemfem.html#a67e7a0fda75e3e06b69d5ef218f8b2b5">mfem::CubeFaceLeft</a></div><div class="ttdeci">bool CubeFaceLeft(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00592">ncmesh.cpp:592</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_a1a76a2a0b519ad0aab8710895d0b928b"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#a1a76a2a0b519ad0aab8710895d0b928b">mfem::NCMesh::Face::elem</a></div><div class="ttdeci">int elem[2]</div><div class="ttdoc">up to 2 elements sharing the face </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00418">ncmesh.hpp:418</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a4d75bf981d1dbb2420598422d4dffcc7"><div class="ttname"><a href="classmfem_1_1Mesh.html#a4d75bf981d1dbb2420598422d4dffcc7">mfem::Mesh::GetVertex</a></div><div class="ttdeci">const double * GetVertex(int i) const </div><div class="ttdoc">Return pointer to vertex i&amp;#39;s coordinates. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00750">mesh.hpp:750</a></div></div>
<div class="ttc" id="structmfem_1_1Refinement_html_a0824689ac239cd12c39657e4ad3e4644"><div class="ttname"><a href="structmfem_1_1Refinement.html#a0824689ac239cd12c39657e4ad3e4644">mfem::Refinement::ref_type</a></div><div class="ttdeci">char ref_type</div><div class="ttdoc">refinement XYZ bit mask (7 = full isotropic) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00038">ncmesh.hpp:38</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae878ee91f13a301143d30ae16b8739af"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae878ee91f13a301143d30ae16b8739af">mfem::NCMesh::GetFaceVerticesEdges</a></div><div class="ttdeci">int GetFaceVerticesEdges(const MeshId &amp;face_id, int vert_index[4], int edge_index[4], int edge_orientation[4]) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04453">ncmesh.cpp:4453</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a647cb91da90550756d65f1fb74fe371a"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a647cb91da90550756d65f1fb74fe371a">mfem::NCMesh::tmp_vertex</a></div><div class="ttdeci">TmpVertex * tmp_vertex</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00808">ncmesh.hpp:808</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a804083bef22db7316909eaafd496bde7"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a804083bef22db7316909eaafd496bde7">mfem::NCMesh::top_vertex_pos</a></div><div class="ttdeci">Array&lt; double &gt; top_vertex_pos</div><div class="ttdoc">coordinates of top-level vertices (organized as triples) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00471">ncmesh.hpp:471</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_aab5094e73ef3cc50816b8f6122b33bba"><div class="ttname"><a href="classmfem_1_1Array.html#aab5094e73ef3cc50816b8f6122b33bba">mfem::Array::Unique</a></div><div class="ttdeci">void Unique()</div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00237">array.hpp:237</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a6d617367eb29c399680134231b12a20b"><div class="ttname"><a href="classmfem_1_1Mesh.html#a6d617367eb29c399680134231b12a20b">mfem::Mesh::GetEdgeVertexTable</a></div><div class="ttdeci">Table * GetEdgeVertexTable() const </div><div class="ttdoc">Returns the edge-to-vertex Table (3D) </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l04468">mesh.cpp:4468</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ac84ca7ecad973da2a711fd786d73a23e"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ac84ca7ecad973da2a711fd786d73a23e">mfem::NCMesh::TriFaceSplit</a></div><div class="ttdeci">bool TriFaceSplit(int v1, int v2, int v3, int mid[3]=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02233">ncmesh.cpp:2233</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0c847bdc9ee4714829bfb9d2478feb81"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0c847bdc9ee4714829bfb9d2478feb81">mfem::NCMesh::SetDerefMatrixCodes</a></div><div class="ttdeci">void SetDerefMatrixCodes(int parent, Array&lt; int &gt; &amp;fine_coarse)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01828">ncmesh.cpp:1828</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_a231083c3edc17bc071f1c4495d391729"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#a231083c3edc17bc071f1c4495d391729">mfem::NCMesh::GeomInfo::faces</a></div><div class="ttdeci">int faces[6][4]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00839">ncmesh.hpp:839</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a64e177f4c546df656e2644ad8a451e2c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a64e177f4c546df656e2644ad8a451e2c">mfem::NCMesh::GetDerefinementTransforms</a></div><div class="ttdeci">const CoarseFineTransformations &amp; GetDerefinementTransforms()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03954">ncmesh.cpp:3954</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_1_1iterator_html"><div class="ttname"><a href="classmfem_1_1HashTable_1_1iterator.html">mfem::HashTable::iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00128">hash.hpp:128</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaf1732b41042d72dcdb835546bace3d3"><div class="ttname"><a href="classmfem_1_1Element.html#aaf1732b41042d72dcdb835546bace3d3">mfem::Element::GetNEdges</a></div><div class="ttdeci">virtual int GetNEdges() const =0</div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_adfe18b34ead4080989a9a99a5e5dec71"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#adfe18b34ead4080989a9a99a5e5dec71">mfem::NCMesh::Node::HasEdge</a></div><div class="ttdeci">bool HasEdge() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00403">ncmesh.hpp:403</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_ad236e8d8798e2e67a1565e14b023bf08"><div class="ttname"><a href="classmfem_1_1Table.html#ad236e8d8798e2e67a1565e14b023bf08">mfem::Table::AddColumnsInRow</a></div><div class="ttdeci">void AddColumnsInRow(int r, int ncol)</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00078">table.hpp:78</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html">mfem::NCMesh::GeomInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00835">ncmesh.hpp:835</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a62e52da15fef484c22a6a63a55324c1a"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a62e52da15fef484c22a6a63a55324c1a">mfem::NCMesh::reparents</a></div><div class="ttdeci">Array&lt; Triple&lt; int, int, int &gt; &gt; reparents</div><div class="ttdoc">scheduled node reparents (tmp) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00532">ncmesh.hpp:532</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a9c1892b82511e32df40ef8210d81d9f7"><div class="ttname"><a href="classmfem_1_1Table.html#a9c1892b82511e32df40ef8210d81d9f7">mfem::Table::MakeI</a></div><div class="ttdeci">void MakeI(int nrows)</div><div class="ttdoc">Next 7 methods are used together with the default constructor. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00085">table.cpp:85</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a249826641c64c2cada3c9567da802fc6"><div class="ttname"><a href="classmfem_1_1Element.html#a249826641c64c2cada3c9567da802fc6">mfem::Element::GetVertices</a></div><div class="ttdeci">virtual void GetVertices(Array&lt; int &gt; &amp;v) const =0</div><div class="ttdoc">Returns element&amp;#39;s vertices. </div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a07cb10cb32e9f1ec00b59f909352a38e"><div class="ttname"><a href="classmfem_1_1Geometry.html#a07cb10cb32e9f1ec00b59f909352a38e">mfem::Geometry::NumGeom</a></div><div class="ttdeci">static const int NumGeom</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00041">geom.hpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a72869feda95885f216153f15cc3fcfa0"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a72869feda95885f216153f15cc3fcfa0">mfem::NCMesh::PrintVertexParents</a></div><div class="ttdeci">void PrintVertexParents(std::ostream &amp;out) const </div><div class="ttdoc">I/O: Print the &amp;quot;vertex_parents&amp;quot; section of the mesh file (ver. &amp;gt;= 1.1). </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04855">ncmesh.cpp:4855</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ac9063d444be89252ed9479011d01fa08"><div class="ttname"><a href="classmfem_1_1Mesh.html#ac9063d444be89252ed9479011d01fa08">mfem::Mesh::boundary</a></div><div class="ttdeci">Array&lt; Element * &gt; boundary</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00084">mesh.hpp:84</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a9899711bbbf8d6e8d15e24da8e8135d0"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a9899711bbbf8d6e8d15e24da8e8135d0">mfem::NCMesh::CollectTriFaceVertices</a></div><div class="ttdeci">void CollectTriFaceVertices(int v0, int v1, int v2, Array&lt; int &gt; &amp;indices)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02913">ncmesh.cpp:2913</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_a6e218801d53e2b1a3cdb68a9128e5079"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#a6e218801d53e2b1a3cdb68a9128e5079">mfem::NCMesh::Element::tet_type</a></div><div class="ttdeci">char tet_type</div><div class="ttdoc">tetrahedron split type, currently always 0 </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00440">ncmesh.hpp:440</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a7255eda516a5f617b3fe6567bc40ee23"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a7255eda516a5f617b3fe6567bc40ee23">mfem::NCMesh::LimitNCLevel</a></div><div class="ttdeci">virtual void LimitNCLevel(int max_nc_level)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04840">ncmesh.cpp:4840</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ad207cd78e4d4cf8732938c7226a66f58"><div class="ttname"><a href="classmfem_1_1Mesh.html#ad207cd78e4d4cf8732938c7226a66f58">mfem::Mesh::GetNBE</a></div><div class="ttdeci">int GetNBE() const </div><div class="ttdoc">Returns number of boundary elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00696">mesh.hpp:696</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0a1527ca37e7107a32ced3f823e6e3d0"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0a1527ca37e7107a32ced3f823e6e3d0">mfem::NCMesh::Trim</a></div><div class="ttdeci">virtual void Trim()</div><div class="ttdoc">Save memory by releasing all non-essential and cached data. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05078">ncmesh.cpp:5078</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_ae0dff4502238a51f894b011f8f3a6bee"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#ae0dff4502238a51f894b011f8f3a6bee">mfem::NCMesh::Element::index</a></div><div class="ttdeci">int index</div><div class="ttdoc">element number in the Mesh, -1 if refined </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00442">ncmesh.hpp:442</a></div></div>
<div class="ttc" id="classmfem_1_1HashTable_1_1const__iterator_html"><div class="ttname"><a href="classmfem_1_1HashTable_1_1const__iterator.html">mfem::HashTable::const_iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00148">hash.hpp:148</a></div></div>
<div class="ttc" id="miniapps_2performance_2ex1_8cpp_html_a784b7cbb4c28f5c0b15e7c6f949b24d0"><div class="ttname"><a href="miniapps_2performance_2ex1_8cpp.html#a784b7cbb4c28f5c0b15e7c6f949b24d0">geom</a></div><div class="ttdeci">const Geometry::Type geom</div><div class="ttdef"><b>Definition:</b> <a href="miniapps_2performance_2ex1_8cpp_source.html#l00040">ex1.cpp:40</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a702405685b5acdbb2df588141d18ba74"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a702405685b5acdbb2df588141d18ba74">mfem::NCMesh::CopyElements</a></div><div class="ttdeci">void CopyElements(int elem, const BlockArray&lt; Element &gt; &amp;tmp_elements, Array&lt; int &gt; &amp;index_map)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04965">ncmesh.cpp:4965</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a93a9e86595e6b4d6ad5b08d3841cbc98"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a93a9e86595e6b4d6ad5b08d3841cbc98">mfem::NCMesh::ForceRefinement</a></div><div class="ttdeci">void ForceRefinement(int vn1, int vn2, int vn3, int vn4)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00617">ncmesh.cpp:617</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a99866202164a4896d193bda383e3427d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a99866202164a4896d193bda383e3427d">mfem::NCMesh::GetNumGhostElements</a></div><div class="ttdeci">virtual int GetNumGhostElements() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00519">ncmesh.hpp:519</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html">mfem::NCMesh::NCList</a></div><div class="ttdoc">Lists all edges/faces in the nonconforming mesh. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00193">ncmesh.hpp:193</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aea513065f28f9f2c54efaf83533f83b8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aea513065f28f9f2c54efaf83533f83b8">mfem::NCMesh::TraverseQuadFace</a></div><div class="ttdeci">void TraverseQuadFace(int vn0, int vn1, int vn2, int vn3, const PointMatrix &amp;pm, int level, Face *eface[4])</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02339">ncmesh.cpp:2339</a></div></div>
<div class="ttc" id="classmfem_1_1BlockArray_html_ae612faa528d17e632a27a04319d7f37b"><div class="ttname"><a href="classmfem_1_1BlockArray.html#ae612faa528d17e632a27a04319d7f37b">mfem::BlockArray::Size</a></div><div class="ttdeci">int Size() const </div><div class="ttdoc">Return the number of items actually stored. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00464">array.hpp:464</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_ab0eaacccbad37071f14d9bc9431acbce"><div class="ttname"><a href="classmfem_1_1Operator.html#ab0eaacccbad37071f14d9bc9431acbce">mfem::Operator::Width</a></div><div class="ttdeci">int Width() const </div><div class="ttdoc">Get the width (size of input) of the Operator. Synonym with NumCols(). </div><div class="ttdef"><b>Definition:</b> <a href="operator_8hpp_source.html#l00063">operator.hpp:63</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_af7fae6773c6dfe98a9bc8b10a23c9720"><div class="ttname"><a href="classmfem_1_1Table.html#af7fae6773c6dfe98a9bc8b10a23c9720">mfem::Table::SetDims</a></div><div class="ttdeci">void SetDims(int rows, int nnz)</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00144">table.cpp:144</a></div></div>
<div class="ttc" id="classmfem_1_1Triple_html"><div class="ttname"><a href="classmfem_1_1Triple.html">mfem::Triple&lt; int, int, int &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1BlockArray_html"><div class="ttname"><a href="classmfem_1_1BlockArray.html">mfem::BlockArray</a></div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00434">array.hpp:434</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a94260d1bd2800d7912b35e372a5cf7e3"><div class="ttname"><a href="classmfem_1_1Array.html#a94260d1bd2800d7912b35e372a5cf7e3">mfem::Array::Copy</a></div><div class="ttdeci">void Copy(Array &amp;copy) const </div><div class="ttdoc">Create a copy of the current array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00812">array.hpp:812</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a2e70df882689c55e19fa9b7de5982363"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a2e70df882689c55e19fa9b7de5982363">mfem::NCMesh::TraverseEdge</a></div><div class="ttdeci">void TraverseEdge(int vn0, int vn1, double t0, double t1, int flags, int level)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02626">ncmesh.cpp:2626</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a1af753cbbc613bd5d225114e1ba9961d"><div class="ttname"><a href="classmfem_1_1Array.html#a1af753cbbc613bd5d225114e1ba9961d">mfem::Array::GetData</a></div><div class="ttdeci">T * GetData()</div><div class="ttdoc">Returns the data. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00098">array.hpp:98</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a89852725e2162ee47a8955e9df0761d1"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a89852725e2162ee47a8955e9df0761d1">mfem::NCMesh::NVertices</a></div><div class="ttdeci">int NVertices</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00489">ncmesh.hpp:489</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a7c1030878adb5665d5587fd235aa8047"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a7c1030878adb5665d5587fd235aa8047">mfem::NCMesh::GetMeshComponents</a></div><div class="ttdeci">void GetMeshComponents(Mesh &amp;mesh) const </div><div class="ttdoc">Fill Mesh::{vertices,elements,boundary} for the current finest level. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02033">ncmesh.cpp:2033</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aea2756eb16b68912fdcd63ea5f21806d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aea2756eb16b68912fdcd63ea5f21806d">mfem::NCMesh::ClearTransforms</a></div><div class="ttdeci">void ClearTransforms()</div><div class="ttdoc">Free all internal data created by the above three functions. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04127">ncmesh.cpp:4127</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a59215194f3a6187e54f80add675bbef7"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a59215194f3a6187e54f80add675bbef7">mfem::NCMesh::derefinements</a></div><div class="ttdeci">Table derefinements</div><div class="ttdoc">possible derefinements, see GetDerefinementTable </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00534">ncmesh.hpp:534</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html">mfem::DenseMatrix</a></div><div class="ttdoc">Data type dense matrix using column-major storage. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00023">densemat.hpp:23</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae34253eea14f4d003b7ddb459df26a84"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae34253eea14f4d003b7ddb459df26a84">mfem::NCMesh::vertex_list</a></div><div class="ttdeci">NCList vertex_list</div><div class="ttdoc">lazy-initialized list of vertices, see GetVertexList </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00497">ncmesh.hpp:497</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a712c5717817070bcfab89beee0c74051"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a712c5717817070bcfab89beee0c74051">mfem::NCMesh::InitDerefTransforms</a></div><div class="ttdeci">void InitDerefTransforms()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01813">ncmesh.cpp:1813</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a2dbe28d9401556e7d53f19dbcb2193ad"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a2dbe28d9401556e7d53f19dbcb2193ad">mfem::NCMesh::pm_prism_identity</a></div><div class="ttdeci">static PointMatrix pm_prism_identity</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00776">ncmesh.hpp:776</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a84acfac1f4f46ad26d5273d9e1f79a9d"><div class="ttname"><a href="classmfem_1_1Table.html#a84acfac1f4f46ad26d5273d9e1f79a9d">mfem::Table::GetRow</a></div><div class="ttdeci">void GetRow(int i, Array&lt; int &gt; &amp;row) const </div><div class="ttdoc">Return row i in array row (the Table must be finalized) </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00191">table.cpp:191</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_ad1252f75eb42dc7df608bda9d2c1e0f2"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#ad1252f75eb42dc7df608bda9d2c1e0f2">mfem::NCMesh::Element::geom</a></div><div class="ttdeci">char geom</div><div class="ttdoc">Geometry::Type of the element (char for storage only) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00438">ncmesh.hpp:438</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a902bc877ac5ae36802f5540d5ad3bcf8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a902bc877ac5ae36802f5540d5ad3bcf8">mfem::NCMesh::InitRootState</a></div><div class="ttdeci">void InitRootState(int root_count)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01927">ncmesh.cpp:1927</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a0d6f2335b6dc74495af661073dded1ea"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a0d6f2335b6dc74495af661073dded1ea">mfem::NCMesh::NCList::TotalSize</a></div><div class="ttdeci">long TotalSize() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02831">ncmesh.cpp:2831</a></div></div>
<div class="ttc" id="structmfem_1_1Hashed4_html_a94085f4a13f7fb9b991924b19ebdd2f4"><div class="ttname"><a href="structmfem_1_1Hashed4.html#a94085f4a13f7fb9b991924b19ebdd2f4">mfem::Hashed4::p2</a></div><div class="ttdeci">int p2</div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00036">hash.hpp:36</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aa9ee69c2b18d6a2f964aa74d27c053d5"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aa9ee69c2b18d6a2f964aa74d27c053d5">mfem::NCMesh::GetEdgeNCOrientation</a></div><div class="ttdeci">int GetEdgeNCOrientation(const MeshId &amp;edge_id) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04441">ncmesh.cpp:4441</a></div></div>
<div class="ttc" id="classmfem_1_1DenseTensor_html_a2606b2ad26ea8bafed3c67300a5a6143"><div class="ttname"><a href="classmfem_1_1DenseTensor.html#a2606b2ad26ea8bafed3c67300a5a6143">mfem::DenseTensor::SetSize</a></div><div class="ttdeci">void SetSize(int i, int j, int k)</div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00768">densemat.hpp:768</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af1d1c5110a2cd10105c3ae093c9f7b51"><div class="ttname"><a href="classmfem_1_1Mesh.html#af1d1c5110a2cd10105c3ae093c9f7b51">mfem::Mesh::GetNE</a></div><div class="ttdeci">int GetNE() const </div><div class="ttdoc">Returns number of elements. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00693">mesh.hpp:693</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Slave_html_a2639da00114322f7f3ab149db220b373"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Slave.html#a2639da00114322f7f3ab149db220b373">mfem::NCMesh::Slave::OrientedPointMatrix</a></div><div class="ttdeci">void OrientedPointMatrix(DenseMatrix &amp;oriented_matrix) const </div><div class="ttdoc">Return the point matrix oriented according to the master and slave edges. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02792">ncmesh.cpp:2792</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a1bea8a25d6c6673b122d7e16aca8327d"><div class="ttname"><a href="classmfem_1_1Mesh.html#a1bea8a25d6c6673b122d7e16aca8327d">mfem::Mesh::GetFace</a></div><div class="ttdeci">const Element * GetFace(int i) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00783">mesh.hpp:783</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae5ffc4d29ef367e1e3f7139e6da470b6"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae5ffc4d29ef367e1e3f7139e6da470b6">mfem::NCMesh::NewTetrahedron</a></div><div class="ttdeci">int NewTetrahedron(int n0, int n1, int n2, int n3, int attr, int fattr0, int fattr1, int fattr2, int fattr3)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00515">ncmesh.cpp:515</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab5adb92a136c093ae22469a8c0f2d400"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab5adb92a136c093ae22469a8c0f2d400">mfem::NCMesh::CheckAnisoFace</a></div><div class="ttdeci">void CheckAnisoFace(int vn1, int vn2, int vn3, int vn4, int mid12, int mid34, int level=0)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00747">ncmesh.cpp:747</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ac8a721da76292361ab8781e292e0a87b"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ac8a721da76292361ab8781e292e0a87b">mfem::NCMesh::GetNumGhostVertices</a></div><div class="ttdeci">virtual int GetNumGhostVertices() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00520">ncmesh.hpp:520</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_af61c2d357a89d2e73404e68e469e3383"><div class="ttname"><a href="classmfem_1_1NCMesh.html#af61c2d357a89d2e73404e68e469e3383">mfem::NCMesh::pm_tri_identity</a></div><div class="ttdeci">static PointMatrix pm_tri_identity</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00773">ncmesh.hpp:773</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_a76fbfb09f5ffbac48e602eddc40d7b4c"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#a76fbfb09f5ffbac48e602eddc40d7b4c">mfem::NCMesh::GeomInfo::ne</a></div><div class="ttdeci">int ne</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00837">ncmesh.hpp:837</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a098aa084b66fd0f4fdf30e25ff522645"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a098aa084b66fd0f4fdf30e25ff522645">mfem::NCMesh::FreeElement</a></div><div class="ttdeci">void FreeElement(int id)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00550">ncmesh.hpp:550</a></div></div>
<div class="ttc" id="namespacemfem_html_af6942d72f9167002282f8345461578d6"><div class="ttname"><a href="namespacemfem.html#af6942d72f9167002282f8345461578d6">mfem::operator&lt;</a></div><div class="ttdeci">bool operator&lt;(const Pair&lt; A, B &gt; &amp;p, const Pair&lt; A, B &gt; &amp;q)</div><div class="ttdoc">Comparison operator for class Pair, based on the first element only. </div><div class="ttdef"><b>Definition:</b> <a href="sort__pairs_8hpp_source.html#l00036">sort_pairs.hpp:36</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a81d95f8c25fc3480d13762f709ceb8fe"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a81d95f8c25fc3480d13762f709ceb8fe">mfem::NCMesh::CountSplits</a></div><div class="ttdeci">void CountSplits(int elem, int splits[3]) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04727">ncmesh.cpp:4727</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_a6d9899e784830ab588ae5431d63b73c5"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#a6d9899e784830ab588ae5431d63b73c5">mfem::NCMesh::Element::Geom</a></div><div class="ttdeci">Geometry::Type Geom() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00454">ncmesh.hpp:454</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a8ab8b2b634477c27d33094bb19e10ffd"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a8ab8b2b634477c27d33094bb19e10ffd">mfem::NCMesh::CollectDerefinements</a></div><div class="ttdeci">void CollectDerefinements(int elem, Array&lt; Connection &gt; &amp;list)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01700">ncmesh.cpp:1700</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_ae1fc31b8c4b35491b0c20f23b43aa3c2"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#ae1fc31b8c4b35491b0c20f23b43aa3c2">mfem::NCMesh::NCList::conforming</a></div><div class="ttdeci">std::vector&lt; MeshId &gt; conforming</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00195">ncmesh.hpp:195</a></div></div>
<div class="ttc" id="classmfem_1_1Quadrilateral_html"><div class="ttname"><a href="classmfem_1_1Quadrilateral.html">mfem::Quadrilateral</a></div><div class="ttdoc">Data type quadrilateral element. </div><div class="ttdef"><b>Definition:</b> <a href="quadrilateral_8hpp_source.html#l00022">quadrilateral.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aa75e7521210568451137c65e11afeea5"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aa75e7521210568451137c65e11afeea5">mfem::NCMesh::GetLimitRefinements</a></div><div class="ttdeci">void GetLimitRefinements(Array&lt; Refinement &gt; &amp;refinements, int max_level)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04810">ncmesh.cpp:4810</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_afb27e53bef16128ae6b9363a61825a74"><div class="ttname"><a href="classmfem_1_1NCMesh.html#afb27e53bef16128ae6b9363a61825a74">mfem::NCMesh::PrintMemoryDetail</a></div><div class="ttdeci">int PrintMemoryDetail() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05136">ncmesh.cpp:5136</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html"><div class="ttname"><a href="classmfem_1_1Table.html">mfem::Table</a></div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00043">table.hpp:43</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_afeb5f7203337f0d9e5122456d7ec8fb4"><div class="ttname"><a href="classmfem_1_1Mesh.html#afeb5f7203337f0d9e5122456d7ec8fb4">mfem::Mesh::GetElementBaseGeometry</a></div><div class="ttdeci">Geometry::Type GetElementBaseGeometry(int i) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00790">mesh.hpp:790</a></div></div>
<div class="ttc" id="classmfem_1_1Wedge_html"><div class="ttname"><a href="classmfem_1_1Wedge.html">mfem::Wedge</a></div><div class="ttdoc">Data type Wedge element. </div><div class="ttdef"><b>Definition:</b> <a href="wedge_8hpp_source.html#l00022">wedge.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_acf99393a0d32a11cca34ae65980b7848"><div class="ttname"><a href="classmfem_1_1NCMesh.html#acf99393a0d32a11cca34ae65980b7848">mfem::NCMesh::spaceDim</a></div><div class="ttdeci">int spaceDim</div><div class="ttdoc">dimensions of the elements and the vertex coordinates </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00382">ncmesh.hpp:382</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae6fb3d0a6bb5a292fb5bcae8c116f0bf"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae6fb3d0a6bb5a292fb5bcae8c116f0bf">mfem::NCMesh::HavePrisms</a></div><div class="ttdeci">bool HavePrisms() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00524">ncmesh.hpp:524</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a78e18a036c8860a7f9daafa868d052eb"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a78e18a036c8860a7f9daafa868d052eb">mfem::NCMesh::vertex_nodeId</a></div><div class="ttdeci">Array&lt; int &gt; vertex_nodeId</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00493">ncmesh.hpp:493</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_ab5335d4fac164e8fa809537dc4b21967"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#ab5335d4fac164e8fa809537dc4b21967">mfem::NCMesh::Face::attribute</a></div><div class="ttdeci">int attribute</div><div class="ttdoc">boundary element attribute, -1 if internal face </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00416">ncmesh.hpp:416</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a6f84755a52bed89f6e008d157e1c7fb1"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a6f84755a52bed89f6e008d157e1c7fb1">mfem::NCMesh::DebugDump</a></div><div class="ttdeci">void DebugDump(std::ostream &amp;out) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05241">ncmesh.cpp:5241</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a05db1b202d1989758fb4a1cb87389dbe"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a05db1b202d1989758fb4a1cb87389dbe">mfem::NCMesh::FindFaceNodes</a></div><div class="ttdeci">void FindFaceNodes(int face, int node[4])</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04579">ncmesh.cpp:4579</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_af3a0759397426baab1b1032b5160c235"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#af3a0759397426baab1b1032b5160c235">mfem::CoarseFineTransformations::IsInitialized</a></div><div class="ttdeci">bool IsInitialized() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04142">ncmesh.cpp:4142</a></div></div>
<div class="ttc" id="namespacemfem_html_a5835b1a237cb964604b52bc3a84f95e1"><div class="ttname"><a href="namespacemfem.html#a5835b1a237cb964604b52bc3a84f95e1">mfem::CubeFaceBack</a></div><div class="ttdeci">bool CubeFaceBack(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00601">ncmesh.cpp:601</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a963824135bea25a510534eabc9bce879"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a963824135bea25a510534eabc9bce879">mfem::NCMesh::root_state</a></div><div class="ttdeci">Array&lt; int &gt; root_state</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00468">ncmesh.hpp:468</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab0249551c32f6f4348b9d3c75580e150"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab0249551c32f6f4348b9d3c75580e150">mfem::NCMesh::GetGeomIdentity</a></div><div class="ttdeci">static const PointMatrix &amp; GetGeomIdentity(Geometry::Type geom)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03422">ncmesh.cpp:3422</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a857a050fe403ce45e0b7cc7912c4a3fe"><div class="ttname"><a href="classmfem_1_1Array.html#a857a050fe403ce45e0b7cc7912c4a3fe">mfem::Array::DeleteAll</a></div><div class="ttdeci">void DeleteAll()</div><div class="ttdoc">Delete whole array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00802">array.hpp:802</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a3b5f570f87003bca08f366ee279b19cf"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a3b5f570f87003bca08f366ee279b19cf">mfem::NCMesh::find_element_edge</a></div><div class="ttdeci">static int find_element_edge(const Element &amp;el, int vn0, int vn1, bool abort=true)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02270">ncmesh.cpp:2270</a></div></div>
<div class="ttc" id="structmfem_1_1Refinement_html_a384f0346a131fcf3a9c40d223e376b9d"><div class="ttname"><a href="structmfem_1_1Refinement.html#a384f0346a131fcf3a9c40d223e376b9d">mfem::Refinement::index</a></div><div class="ttdeci">int index</div><div class="ttdoc">Mesh element number. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00037">ncmesh.hpp:37</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_ab72183e81a4378f7eb3e528882b61a8c"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#ab72183e81a4378f7eb3e528882b61a8c">mfem::NCMesh::GeomInfo::edges</a></div><div class="ttdeci">int edges[12][2]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00838">ncmesh.hpp:838</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0666aba4aa9e055c0f4cb604457212cc"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0666aba4aa9e055c0f4cb604457212cc">mfem::NCMesh::GetFaceList</a></div><div class="ttdeci">const NCList &amp; GetFaceList()</div><div class="ttdoc">Return the current list of conforming and nonconforming faces. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00212">ncmesh.hpp:212</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a479784242168cb520f1969ea343a6928"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a479784242168cb520f1969ea343a6928">mfem::NCMesh::NCList::LookUp</a></div><div class="ttdeci">const MeshId &amp; LookUp(int index, int *type=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02836">ncmesh.cpp:2836</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0333c5d35901cd957d7fb56df0801b1c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0333c5d35901cd957d7fb56df0801b1c">mfem::NCMesh::OnMeshUpdated</a></div><div class="ttdeci">virtual void OnMeshUpdated(Mesh *mesh)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02120">ncmesh.cpp:2120</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a3a0e1b1dfb45602dce1388dd18a8947d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a3a0e1b1dfb45602dce1388dd18a8947d">mfem::NCMesh::DebugLeafOrder</a></div><div class="ttdeci">void DebugLeafOrder(std::ostream &amp;out) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05216">ncmesh.cpp:5216</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a085464fbf2a801f2a98a724af938b5ba"><div class="ttname"><a href="classmfem_1_1Mesh.html#a085464fbf2a801f2a98a724af938b5ba">mfem::Mesh::NewElement</a></div><div class="ttdeci">Element * NewElement(int geom)</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l03064">mesh.cpp:3064</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab73461fb1107b4ba0fe2d91fbaf02296"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab73461fb1107b4ba0fe2d91fbaf02296">mfem::NCMesh::NewWedge</a></div><div class="ttdeci">int NewWedge(int n0, int n1, int n2, int n3, int n4, int n5, int attr, int fattr0, int fattr1, int fattr2, int fattr3, int fattr4)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00483">ncmesh.cpp:483</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a93aaf370deffa738b2913c698787b74c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a93aaf370deffa738b2913c698787b74c">mfem::NCMesh::CollectEdgeVertices</a></div><div class="ttdeci">void CollectEdgeVertices(int v0, int v1, Array&lt; int &gt; &amp;indices)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02901">ncmesh.cpp:2901</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_afd473a17fba9e83c68615747cfec296c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#afd473a17fba9e83c68615747cfec296c">mfem::NCMesh::find_local_face</a></div><div class="ttdeci">static int find_local_face(int geom, int a, int b, int c)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02288">ncmesh.cpp:2288</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0f0007423bcde898cd3c8cbb4aa9bae6"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0f0007423bcde898cd3c8cbb4aa9bae6">mfem::NCMesh::ref_stack</a></div><div class="ttdeci">Array&lt; Refinement &gt; ref_stack</div><div class="ttdoc">stack of scheduled refinements (temporary) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00530">ncmesh.hpp:530</a></div></div>
<div class="ttc" id="classmfem_1_1BlockArray_html_a5120895466f8b74d7423fb3720e6e447"><div class="ttname"><a href="classmfem_1_1BlockArray.html#a5120895466f8b74d7423fb3720e6e447">mfem::BlockArray::begin</a></div><div class="ttdeci">iterator begin()</div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00558">array.hpp:558</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a8996fd1c5aedb5f941f86de85fdd1541"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a8996fd1c5aedb5f941f86de85fdd1541">mfem::NCMesh::CollectIncidentElements</a></div><div class="ttdeci">void CollectIncidentElements(int elem, const RefCoord coord[3], Array&lt; int &gt; &amp;list) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03352">ncmesh.cpp:3352</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a50d302c196f491e537ba4b90bb8a5757"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a50d302c196f491e537ba4b90bb8a5757">mfem::NCMesh::ReferenceElement</a></div><div class="ttdeci">void ReferenceElement(int elem)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00303">ncmesh.cpp:303</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ab022e7d065b35d9b2ba7b3cc2b0ccb14"><div class="ttname"><a href="classmfem_1_1Mesh.html#ab022e7d065b35d9b2ba7b3cc2b0ccb14">mfem::Mesh::GetNumFaces</a></div><div class="ttdeci">int GetNumFaces() const </div><div class="ttdoc">Return the number of faces (3D), edges (2D) or vertices (1D). </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8cpp_source.html#l03943">mesh.cpp:3943</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a453021f5db847ddb6b3374a4b20e2d05"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a453021f5db847ddb6b3374a4b20e2d05">mfem::NCMesh::IsGhost</a></div><div class="ttdeci">virtual bool IsGhost(const Element &amp;el) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00518">ncmesh.hpp:518</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_a1bb0f07039a5cb56ab79ad93cd9e4691"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#a1bb0f07039a5cb56ab79ad93cd9e4691">mfem::NCMesh::GeomInfo::nfv</a></div><div class="ttdeci">int nfv[6]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00840">ncmesh.hpp:840</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a6048ffc8429397e0e3aac8e6b2424b13"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a6048ffc8429397e0e3aac8e6b2424b13">mfem::NCMesh::GetPointMatrix</a></div><div class="ttdeci">void GetPointMatrix(Geometry::Type geom, const char *ref_path, DenseMatrix &amp;matrix)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03437">ncmesh.cpp:3437</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aa651ccc00f3d44ef5680c1d1db1b280b"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aa651ccc00f3d44ef5680c1d1db1b280b">mfem::NCMesh::CheckIsoFace</a></div><div class="ttdeci">void CheckIsoFace(int vn1, int vn2, int vn3, int vn4, int en1, int en2, int en3, int en4, int midf)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00842">ncmesh.cpp:842</a></div></div>
<div class="ttc" id="classmfem_1_1Hexahedron_html"><div class="ttname"><a href="classmfem_1_1Hexahedron.html">mfem::Hexahedron</a></div><div class="ttdoc">Data type hexahedron element. </div><div class="ttdef"><b>Definition:</b> <a href="hexahedron_8hpp_source.html#l00022">hexahedron.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae4dfc79d23b8ae298504f35e8dfdcdf2"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae4dfc79d23b8ae298504f35e8dfdcdf2">mfem::NCMesh::InitGeomFlags</a></div><div class="ttdeci">void InitGeomFlags()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00204">ncmesh.cpp:204</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1TmpVertex_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1TmpVertex.html">mfem::NCMesh::TmpVertex</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00801">ncmesh.hpp:801</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a4f05bd8272240c0b8f47d03a8f7d1b9a"><div class="ttname"><a href="classmfem_1_1Element.html#a4f05bd8272240c0b8f47d03a8f7d1b9a">mfem::Element::GetNFaceVertices</a></div><div class="ttdeci">virtual int GetNFaceVertices(int fi) const =0</div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aba5477e5a86ff703ae1ccdad4728081f"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aba5477e5a86ff703ae1ccdad4728081f">mfem::NCMesh::GetFace</a></div><div class="ttdeci">Face * GetFace(Element &amp;elem, int face_no)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00416">ncmesh.cpp:416</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a00b1e30f76a2ca307a1f496d15a26d03"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a00b1e30f76a2ca307a1f496d15a26d03">mfem::NCMesh::TraverseRefinements</a></div><div class="ttdeci">void TraverseRefinements(int elem, int coarse_index, std::string &amp;ref_path, RefPathMap &amp;map)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03871">ncmesh.cpp:3871</a></div></div>
<div class="ttc" id="namespacemfem_html_a839d3a7984f1c355ace995961b486f18"><div class="ttname"><a href="namespacemfem.html#a839d3a7984f1c355ace995961b486f18">mfem::CubeFaceRight</a></div><div class="ttdeci">bool CubeFaceRight(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00595">ncmesh.cpp:595</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805abbe96d7ec4feeeeaf8fcb297e3f196ed">mfem::Geometry::SQUARE</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00037">geom.hpp:37</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a2e79b56354be74789e8ca64a7e5883cd"><div class="ttname"><a href="classmfem_1_1Element.html#a2e79b56354be74789e8ca64a7e5883cd">mfem::Element::GetEdgeVertices</a></div><div class="ttdeci">virtual const int * GetEdgeVertices(int) const =0</div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a9c277d1137fc02fc9026f582048f18b2"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a9c277d1137fc02fc9026f582048f18b2">mfem::NCMesh::GetMidEdgeNode</a></div><div class="ttdeci">int GetMidEdgeNode(int node1, int node2)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00288">ncmesh.cpp:288</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_a742e8e8aae7e3ff2988691e4ec1023e2"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#a742e8e8aae7e3ff2988691e4ec1023e2">mfem::NCMesh::Element::Element</a></div><div class="ttdeci">Element(Geometry::Type geom, int attr)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00441">ncmesh.cpp:441</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a1dd44115871614d94f5ccb48530efb69"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a1dd44115871614d94f5ccb48530efb69">mfem::NCMesh::PrintElements</a></div><div class="ttdeci">int PrintElements(std::ostream &amp;out, int elem, int &amp;coarse_id) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04925">ncmesh.cpp:4925</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_afe002bd1fe00597001783e3bfeb54d80"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#afe002bd1fe00597001783e3bfeb54d80">mfem::NCMesh::Node::vert_index</a></div><div class="ttdeci">int vert_index</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00397">ncmesh.hpp:397</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aca9b36e87d22d52742a2793282e8c77d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aca9b36e87d22d52742a2793282e8c77d">mfem::NCMesh::Dim</a></div><div class="ttdeci">int Dim</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00382">ncmesh.hpp:382</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_a72cda57a9af2037716df9621b7324a2b"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#a72cda57a9af2037716df9621b7324a2b">mfem::NCMesh::Face::index</a></div><div class="ttdeci">int index</div><div class="ttdoc">face number in the Mesh </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00417">ncmesh.hpp:417</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae86d604004fdde2ac62d7ad82cdb11b8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae86d604004fdde2ac62d7ad82cdb11b8">mfem::NCMesh::GetDerefinementTable</a></div><div class="ttdeci">const Table &amp; GetDerefinementTable()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01733">ncmesh.cpp:1733</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_ada741de79bb4fc473a307a9d7d05a9f6"><div class="ttname"><a href="classmfem_1_1Table.html#ada741de79bb4fc473a307a9d7d05a9f6">mfem::Table::MakeFromList</a></div><div class="ttdeci">void MakeFromList(int nrows, const Array&lt; Connection &gt; &amp;list)</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00280">table.cpp:280</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a61510cd65ba91bcac7b5e4cc56c633fe"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a61510cd65ba91bcac7b5e4cc56c633fe">mfem::NCMesh::element_vertex</a></div><div class="ttdeci">Table element_vertex</div><div class="ttdoc">leaf-element to vertex table, see FindSetNeighbors </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00502">ncmesh.hpp:502</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_ae2fb5ee4728cb19a548a37ff910da239"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#ae2fb5ee4728cb19a548a37ff910da239">mfem::CoarseFineTransformations::point_matrices</a></div><div class="ttdeci">DenseTensor point_matrices[Geometry::NumGeom]</div><div class="ttdoc">Matrices for IsoparametricTransformation organized by Geometry::Type. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00063">ncmesh.hpp:63</a></div></div>
<div class="ttc" id="classmfem_1_1Operator_html_afbea58230a3ed2a23908cab4551ff583"><div class="ttname"><a href="classmfem_1_1Operator.html#afbea58230a3ed2a23908cab4551ff583">mfem::Operator::Height</a></div><div class="ttdeci">int Height() const </div><div class="ttdoc">Get the height (size of output) of the Operator. Synonym with NumRows(). </div><div class="ttdef"><b>Definition:</b> <a href="operator_8hpp_source.html#l00057">operator.hpp:57</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a89b4efb149e79a30a8dd194279154dd6"><div class="ttname"><a href="classmfem_1_1Array.html#a89b4efb149e79a30a8dd194279154dd6">mfem::Array::Append</a></div><div class="ttdeci">int Append(const T &amp;el)</div><div class="ttdoc">Append element to array, resize if necessary. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00707">array.hpp:707</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1PointMatrix_html_abad6e9611bc85e85ae7c58ccc030df19"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1PointMatrix.html#abad6e9611bc85e85ae7c58ccc030df19">mfem::NCMesh::PointMatrix::GetMatrix</a></div><div class="ttdeci">void GetMatrix(DenseMatrix &amp;point_matrix) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03392">ncmesh.cpp:3392</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ac6434e979a23f12a45af12181ee64927"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ac6434e979a23f12a45af12181ee64927">mfem::NCMesh::AddElement</a></div><div class="ttdeci">int AddElement(const Element &amp;el)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00539">ncmesh.hpp:539</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a733476790603d8d4cbafc238fcc4d215"><div class="ttname"><a href="classmfem_1_1Table.html#a733476790603d8d4cbafc238fcc4d215">mfem::Table::Clear</a></div><div class="ttdeci">void Clear()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00381">table.cpp:381</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aa9d21a5c05107c9c209a3cce8919a5fc"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aa9d21a5c05107c9c209a3cce8919a5fc">mfem::NCMesh::Derefine</a></div><div class="ttdeci">virtual void Derefine(const Array&lt; int &gt; &amp;derefs)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01777">ncmesh.cpp:1777</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="lissajous_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00042">lissajous.cpp:42</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ad10d147e7a0d7bcfe4d5f6952c9d1fa6"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ad10d147e7a0d7bcfe4d5f6952c9d1fa6">mfem::NCMesh::QuadFaceSplitLevel</a></div><div class="ttdeci">void QuadFaceSplitLevel(int vn1, int vn2, int vn3, int vn4, int &amp;h_level, int &amp;v_level) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04700">ncmesh.cpp:4700</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a088a33d266f1ff532b49e6a0f8d8aa94"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a088a33d266f1ff532b49e6a0f8d8aa94">mfem::NCMesh::FindNeighbors</a></div><div class="ttdeci">void FindNeighbors(int elem, Array&lt; int &gt; &amp;neighbors, const Array&lt; int &gt; *search_set=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03154">ncmesh.cpp:3154</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html"><div class="ttname"><a href="classmfem_1_1Array.html">mfem::Array&lt; int &gt;</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a8de451b39a43064e52f8bfc24b664ccf"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a8de451b39a43064e52f8bfc24b664ccf">mfem::NCMesh::NCList::masters</a></div><div class="ttdeci">std::vector&lt; Master &gt; masters</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00196">ncmesh.hpp:196</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a55b473aff78e719df577a232a4908e86"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a55b473aff78e719df577a232a4908e86">mfem::NCMesh::coarse_elements</a></div><div class="ttdeci">Array&lt; int &gt; coarse_elements</div><div class="ttdoc">state of leaf_elements before Refine(), set by MarkCoarseLevel() </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00793">ncmesh.hpp:793</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae0f0e73c140a3ada22fb00151860bd08"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae0f0e73c140a3ada22fb00151860bd08">mfem::NCMesh::UpdateVertices</a></div><div class="ttdeci">virtual void UpdateVertices()</div><div class="ttdoc">update Vertex::index and vertex_nodeId </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01847">ncmesh.cpp:1847</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a85ceb86ba1a12bf26a614ea92e4abe2c"><div class="ttname"><a href="classmfem_1_1Table.html#a85ceb86ba1a12bf26a614ea92e4abe2c">mfem::Table::AddConnection</a></div><div class="ttdeci">void AddConnection(int r, int c)</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00080">table.hpp:80</a></div></div>
<div class="ttc" id="classmfem_1_1Pair_html"><div class="ttname"><a href="classmfem_1_1Pair.html">mfem::Pair</a></div><div class="ttdoc">A pair of objects. </div><div class="ttdef"><b>Definition:</b> <a href="sort__pairs_8hpp_source.html#l00023">sort_pairs.hpp:23</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_a67fde7ae8d4b601f4dab7ec4e4281f12"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#a67fde7ae8d4b601f4dab7ec4e4281f12">mfem::CoarseFineTransformations::GetCoarseToFineMap</a></div><div class="ttdeci">void GetCoarseToFineMap(const Mesh &amp;fine_mesh, Table &amp;coarse_to_fine, Array&lt; int &gt; &amp;coarse_to_ref_type, Table &amp;ref_type_to_matrix, Array&lt; Geometry::Type &gt; &amp;ref_type_to_geom) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04043">ncmesh.cpp:4043</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_add6de476a3eded16ee0eccdaf08c973b"><div class="ttname"><a href="classmfem_1_1Table.html#add6de476a3eded16ee0eccdaf08c973b">mfem::Table::MemoryUsage</a></div><div class="ttdeci">long MemoryUsage() const </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00402">table.cpp:402</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ada5cef66827a6ed2955d6897f853328e"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ada5cef66827a6ed2955d6897f853328e">mfem::NCMesh::RegisterFaces</a></div><div class="ttdeci">void RegisterFaces(int elem, int *fattr=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00377">ncmesh.cpp:377</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_a090b58d9aeb08b4b7dff10f3bbb74d18"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#a090b58d9aeb08b4b7dff10f3bbb74d18">mfem::NCMesh::Node::~Node</a></div><div class="ttdeci">~Node()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00249">ncmesh.cpp:249</a></div></div>
<div class="ttc" id="mesh__headers_8hpp_html"><div class="ttname"><a href="mesh__headers_8hpp.html">mesh_headers.hpp</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a517f198ce22ea84654640e65c940d5e2"><div class="ttname"><a href="classmfem_1_1Array.html#a517f198ce22ea84654640e65c940d5e2">mfem::Array::Reserve</a></div><div class="ttdeci">void Reserve(int capacity)</div><div class="ttdoc">Ensures that the allocated size is at least the given size. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00142">array.hpp:142</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_a80848ad38edd381b91b7d40e583d1c03"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#a80848ad38edd381b91b7d40e583d1c03">mfem::CoarseFineTransformations::embeddings</a></div><div class="ttdeci">Array&lt; Embedding &gt; embeddings</div><div class="ttdoc">Fine element positions in their parents. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00065">ncmesh.hpp:65</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a9c479270fa12d2b9f9aeb38bcbb27e64"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a9c479270fa12d2b9f9aeb38bcbb27e64">mfem::NCMesh::BuildEdgeList</a></div><div class="ttdeci">virtual void BuildEdgeList()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02656">ncmesh.cpp:2656</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_a5aaaeebb7bf8f3e4975d2ea7b7588f5f"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5aaaeebb7bf8f3e4975d2ea7b7588f5f">mfem::NCMesh::GeomInfo::initialized</a></div><div class="ttdeci">bool initialized</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00842">ncmesh.hpp:842</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a53e1966c61327fe693e377b40f090ffe"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a53e1966c61327fe693e377b40f090ffe">mfem::NCMesh::GetRefinementTransforms</a></div><div class="ttdeci">const CoarseFineTransformations &amp; GetRefinementTransforms()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03903">ncmesh.cpp:3903</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aca7d190fc3cbc6aee75e9e288f836b52"><div class="ttname"><a href="classmfem_1_1Element.html#aca7d190fc3cbc6aee75e9e288f836b52">mfem::Element::GetAttribute</a></div><div class="ttdeci">int GetAttribute() const </div><div class="ttdoc">Return element&amp;#39;s attribute. </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00055">element.hpp:55</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a273c22e88f72026d2d1e1522505f476b"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a273c22e88f72026d2d1e1522505f476b">mfem::NCMesh::LoadCoarseElements</a></div><div class="ttdeci">void LoadCoarseElements(std::istream &amp;input)</div><div class="ttdoc">I/O: Load the element refinement hierarchy from a mesh file. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04985">ncmesh.cpp:4985</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1MeshId_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1MeshId.html">mfem::NCMesh::MeshId</a></div><div class="ttdoc">Identifies a vertex/edge/face in both Mesh and NCMesh. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00151">ncmesh.hpp:151</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html">mfem::NCMesh::Face</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00414">ncmesh.hpp:414</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab108aa25e61b80452bd70aa4181b329a"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab108aa25e61b80452bd70aa4181b329a">mfem::NCMesh::FindMidEdgeNode</a></div><div class="ttdeci">int FindMidEdgeNode(int node1, int node2) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00272">ncmesh.cpp:272</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_ae56d019524c1d846f35c9ba1dc434389"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#ae56d019524c1d846f35c9ba1dc434389">mfem::NCMesh::Element::parent</a></div><div class="ttdeci">int parent</div><div class="ttdoc">parent element, -1 if this is a root element, -2 if free </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00450">ncmesh.hpp:450</a></div></div>
<div class="ttc" id="classmfem_1_1Triangle_html"><div class="ttname"><a href="classmfem_1_1Triangle.html">mfem::Triangle</a></div><div class="ttdoc">Data type triangle element. </div><div class="ttdef"><b>Definition:</b> <a href="triangle_8hpp_source.html#l00023">triangle.hpp:23</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_adbdecc1f97835142cdf9dbb52743d083"><div class="ttname"><a href="classmfem_1_1NCMesh.html#adbdecc1f97835142cdf9dbb52743d083">mfem::NCMesh::MarkCoarseLevel</a></div><div class="ttdeci">void MarkCoarseLevel()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03857">ncmesh.cpp:3857</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aa0dd948fe43b96918ea9eabfd29f30ca"><div class="ttname"><a href="classmfem_1_1Mesh.html#aa0dd948fe43b96918ea9eabfd29f30ca">mfem::Mesh::GetElement</a></div><div class="ttdeci">const Element * GetElement(int i) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00775">mesh.hpp:775</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1PointMatrix_html_a0935af69710ea13cfb92f3fce01b39f6"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1PointMatrix.html#a0935af69710ea13cfb92f3fce01b39f6">mfem::NCMesh::PointMatrix::np</a></div><div class="ttdeci">int np</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00742">ncmesh.hpp:742</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a3ada4c57e881a84fd055e2b792eb5879"><div class="ttname"><a href="classmfem_1_1Array.html#a3ada4c57e881a84fd055e2b792eb5879">mfem::Array::MemoryUsage</a></div><div class="ttdeci">long MemoryUsage() const </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00270">array.hpp:270</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1MeshId_html_ace78fb66e41074d0029e82130419a12e"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1MeshId.html#ace78fb66e41074d0029e82130419a12e">mfem::NCMesh::MeshId::local</a></div><div class="ttdeci">signed char local</div><div class="ttdoc">local number within &amp;#39;element&amp;#39; </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00155">ncmesh.hpp:155</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a3eb175d0c72d5865edc5fbbdf14e9adb"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a3eb175d0c72d5865edc5fbbdf14e9adb">mfem::NCMesh::ElementSharesFace</a></div><div class="ttdeci">virtual void ElementSharesFace(int elem, int local, int face)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00642">ncmesh.hpp:642</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a370c68671fe785d87d9bf2b5b1f4b152"><div class="ttname"><a href="classmfem_1_1Array.html#a370c68671fe785d87d9bf2b5b1f4b152">mfem::Array::Sort</a></div><div class="ttdeci">void Sort()</div><div class="ttdoc">Sorts the array. This requires operator&amp;lt; to be defined for T. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00229">array.hpp:229</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0bd3d8f770cc1387feeaea376cedfa4d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0bd3d8f770cc1387feeaea376cedfa4d">mfem::NCMesh::ElementSharesVertex</a></div><div class="ttdeci">virtual void ElementSharesVertex(int elem, int local, int vnode)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00644">ncmesh.hpp:644</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a5e312e3907089115194dceef2d0c81c5"><div class="ttname"><a href="classmfem_1_1Table.html#a5e312e3907089115194dceef2d0c81c5">mfem::Table::Size</a></div><div class="ttdeci">int Size() const </div><div class="ttdoc">Returns the number of TYPE I elements. </div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00092">table.hpp:92</a></div></div>
<div class="ttc" id="namespacemfem_html_a9996e1e72dfb50224ea762b5a5b81e62"><div class="ttname"><a href="namespacemfem.html#a9996e1e72dfb50224ea762b5a5b81e62">mfem::CubeFaceFront</a></div><div class="ttdeci">bool CubeFaceFront(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00598">ncmesh.cpp:598</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html"><div class="ttname"><a href="classmfem_1_1NCMesh.html">mfem::NCMesh</a></div><div class="ttdoc">A class for non-conforming AMR on higher-order hexahedral, prismatic, quadrilateral or triangular mes...</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00100">ncmesh.hpp:100</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a2de836759b06734cdf6129ecd5fc9560"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a2de836759b06734cdf6129ecd5fc9560">mfem::NCMesh::GetElementSizeReduction</a></div><div class="ttdeci">int GetElementSizeReduction(int i) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04544">ncmesh.cpp:4544</a></div></div>
<div class="ttc" id="structmfem_1_1Refinement_html"><div class="ttname"><a href="structmfem_1_1Refinement.html">mfem::Refinement</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00035">ncmesh.hpp:35</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_a7108f596104c940792b0a71fa085d812"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#a7108f596104c940792b0a71fa085d812">mfem::NCMesh::Node::edge_refc</a></div><div class="ttdeci">char edge_refc</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00396">ncmesh.hpp:396</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a61f9ae762eb6e61a0a2df018d5e90c94"><div class="ttname"><a href="classmfem_1_1Mesh.html#a61f9ae762eb6e61a0a2df018d5e90c94">mfem::Mesh::Dimension</a></div><div class="ttdeci">int Dimension() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00744">mesh.hpp:744</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a8735be51233ecbfd04a6ad4866480273"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a8735be51233ecbfd04a6ad4866480273">mfem::NCMesh::~NCMesh</a></div><div class="ttdeci">virtual ~NCMesh()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00225">ncmesh.cpp:225</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a196539a6ae81741e71e6095bea6d4aef"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a196539a6ae81741e71e6095bea6d4aef">mfem::NCMesh::GetBoundaryClosure</a></div><div class="ttdeci">virtual void GetBoundaryClosure(const Array&lt; int &gt; &amp;bdr_attr_is_ess, Array&lt; int &gt; &amp;bdr_vertices, Array&lt; int &gt; &amp;bdr_edges)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04603">ncmesh.cpp:4603</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1MeshId_html_a1a0eeb9da226cf3dcc4640017f5f9e90"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1MeshId.html#a1a0eeb9da226cf3dcc4640017f5f9e90">mfem::NCMesh::MeshId::element</a></div><div class="ttdeci">int element</div><div class="ttdoc">NCMesh::Element containing this vertex/edge/face. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00154">ncmesh.hpp:154</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805aa33f4004c01f4f9f4a1763d73f97c88c">mfem::Geometry::TRIANGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00037">geom.hpp:37</a></div></div>
<div class="ttc" id="namespacemfem_html_a2a4185632f978e56accdfbaeadb3c2ac"><div class="ttname"><a href="namespacemfem.html#a2a4185632f978e56accdfbaeadb3c2ac">mfem::PrismFaceTop</a></div><div class="ttdeci">bool PrismFaceTop(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00613">ncmesh.cpp:613</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0ae4e5f9382fdc8beb40e97cedfcc286"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0ae4e5f9382fdc8beb40e97cedfcc286">mfem::NCMesh::TraverseTetEdge</a></div><div class="ttdeci">void TraverseTetEdge(int vn0, int vn1, const Point &amp;p0, const Point &amp;p1)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02451">ncmesh.cpp:2451</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a054d4e4827069db2fe385d4f48e4bcc2"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a054d4e4827069db2fe385d4f48e4bcc2">mfem::NCMesh::GI</a></div><div class="ttdeci">static GeomInfo GI[Geometry::NumGeom]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00847">ncmesh.hpp:847</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_ae704775348d6d1fe34df6aee42fb1a5f"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#ae704775348d6d1fe34df6aee42fb1a5f">mfem::NCMesh::NCList::Clear</a></div><div class="ttdeci">void Clear(bool hard=false)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02813">ncmesh.cpp:2813</a></div></div>
<div class="ttc" id="classmfem_1_1Tetrahedron_html"><div class="ttname"><a href="classmfem_1_1Tetrahedron.html">mfem::Tetrahedron</a></div><div class="ttdoc">Data type tetrahedron element. </div><div class="ttdef"><b>Definition:</b> <a href="tetrahedron_8hpp_source.html#l00022">tetrahedron.hpp:22</a></div></div>
<div class="ttc" id="namespacemfem_html_aba8d560521a8c41b02479acc42e45f02"><div class="ttname"><a href="namespacemfem.html#aba8d560521a8c41b02479acc42e45f02">mfem::RefCoord</a></div><div class="ttdeci">NCMesh::RefCoord RefCoord</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh__tables_8hpp_source.html#l00091">ncmesh_tables.hpp:91</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a5291a9d4b39abb9378f0106b0c66626c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a5291a9d4b39abb9378f0106b0c66626c">mfem::NCMesh::ReparentNode</a></div><div class="ttdeci">void ReparentNode(int node, int new_p1, int new_p2)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00256">ncmesh.cpp:256</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_aea98bd2662eb60edfce0ed01f98085b8"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#aea98bd2662eb60edfce0ed01f98085b8">mfem::NCMesh::Element::attribute</a></div><div class="ttdeci">int attribute</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00444">ncmesh.hpp:444</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a1fb3951ad14d95e07d00a8ee8b6edefc"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a1fb3951ad14d95e07d00a8ee8b6edefc">mfem::NCMesh::NewTriangle</a></div><div class="ttdeci">int NewTriangle(int n0, int n1, int n2, int attr, int eattr0, int eattr1, int eattr2)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00567">ncmesh.cpp:567</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a312b400d5c21f539cbec01f81e4ba813"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a312b400d5c21f539cbec01f81e4ba813">mfem::NCMesh::DeleteUnusedFaces</a></div><div class="ttdeci">void DeleteUnusedFaces(const Array&lt; int &gt; &amp;elemFaces)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00391">ncmesh.cpp:391</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_ada2086bdd3f3125dfc1b55ce0090695d"><div class="ttname"><a href="classmfem_1_1Mesh.html#ada2086bdd3f3125dfc1b55ce0090695d">mfem::Mesh::SpaceDimension</a></div><div class="ttdeci">int SpaceDimension() const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00745">mesh.hpp:745</a></div></div>
<div class="ttc" id="classmfem_1_1Triple_html_a3ed46ed614c1bee6dd0b71c30e905eb9"><div class="ttname"><a href="classmfem_1_1Triple.html#a3ed46ed614c1bee6dd0b71c30e905eb9">mfem::Triple::two</a></div><div class="ttdeci">B two</div><div class="ttdef"><b>Definition:</b> <a href="sort__pairs_8hpp_source.html#l00061">sort_pairs.hpp:61</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aaa0be85240a691ff6a224f53d2d10727"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aaa0be85240a691ff6a224f53d2d10727">mfem::NCMesh::Iso</a></div><div class="ttdeci">bool Iso</div><div class="ttdoc">true if the mesh only contains isotropic refinements </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00383">ncmesh.hpp:383</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_a1465dc90d418bd1abfdfa42e19372e99"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#a1465dc90d418bd1abfdfa42e19372e99">mfem::NCMesh::Node::HasVertex</a></div><div class="ttdeci">bool HasVertex() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00402">ncmesh.hpp:402</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_abdfac962041dc7075255c9736d42e2b8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#abdfac962041dc7075255c9736d42e2b8">mfem::NCMesh::RefPathMap</a></div><div class="ttdeci">std::map&lt; std::string, int &gt; RefPathMap</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00784">ncmesh.hpp:784</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a19c3e3f129686abc1c899d81cef53f5e"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a19c3e3f129686abc1c899d81cef53f5e">mfem::NCMesh::NCList::slaves</a></div><div class="ttdeci">std::vector&lt; Slave &gt; slaves</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00197">ncmesh.hpp:197</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a63bb269853d5f9aa5312d2629f25d0c4"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a63bb269853d5f9aa5312d2629f25d0c4">mfem::NCMesh::BuildFaceList</a></div><div class="ttdeci">virtual void BuildFaceList()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02542">ncmesh.cpp:2542</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Slave_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Slave.html">mfem::NCMesh::Slave</a></div><div class="ttdoc">Nonconforming edge/face within a bigger edge/face. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00178">ncmesh.hpp:178</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_af134176d2bc3db50d4d3ee610ccd7bd6"><div class="ttname"><a href="classmfem_1_1NCMesh.html#af134176d2bc3db50d4d3ee610ccd7bd6">mfem::NCMesh::DerefineElement</a></div><div class="ttdeci">void DerefineElement(int elem)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01574">ncmesh.cpp:1574</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a71b287a7b416c142047f12c114c71f04"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a71b287a7b416c142047f12c114c71f04">mfem::NCMesh::GetElementFacesAttributes</a></div><div class="ttdeci">void GetElementFacesAttributes(int i, Array&lt; int &gt; &amp;faces, Array&lt; int &gt; &amp;fattr) const </div><div class="ttdoc">Return the faces and face attributes of leaf element &amp;#39;i&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04558">ncmesh.cpp:4558</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a39a4ec0a951332753137a5b5b6b745aa"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a39a4ec0a951332753137a5b5b6b745aa">mfem::NCMesh::ReorderFacePointMat</a></div><div class="ttdeci">int ReorderFacePointMat(int v0, int v1, int v2, int v3, int elem, DenseMatrix &amp;mat) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02305">ncmesh.cpp:2305</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a9c1f23c6196ace208449f20902343f74"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a9c1f23c6196ace208449f20902343f74">mfem::NCMesh::SetVertexPositions</a></div><div class="ttdeci">void SetVertexPositions(const Array&lt; mfem::Vertex &gt; &amp;vertices)</div><div class="ttdoc">I/O: Set positions of all vertices (used by mesh loader). </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04904">ncmesh.cpp:4904</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Slave_html_ae73dd01726e605574a62e7c8b6b7e8ca"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Slave.html#ae73dd01726e605574a62e7c8b6b7e8ca">mfem::NCMesh::Slave::edge_flags</a></div><div class="ttdeci">int edge_flags</div><div class="ttdoc">edge orientation flags </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00181">ncmesh.hpp:181</a></div></div>
<div class="ttc" id="structmfem_1_1Hashed4_html_a6d70fbc117b45c99aa71936612c3c712"><div class="ttname"><a href="structmfem_1_1Hashed4.html#a6d70fbc117b45c99aa71936612c3c712">mfem::Hashed4::p3</a></div><div class="ttdeci">int p3</div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00036">hash.hpp:36</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_ac617ad0add1cc5dc349515ddc4647680"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#ac617ad0add1cc5dc349515ddc4647680">mfem::NCMesh::Face::Boundary</a></div><div class="ttdeci">bool Boundary() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00422">ncmesh.hpp:422</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_ae34ff5104ab26897a75d09b4f0452d04"><div class="ttname"><a href="classmfem_1_1Array.html#ae34ff5104ab26897a75d09b4f0452d04">mfem::Array::Find</a></div><div class="ttdeci">int Find(const T &amp;el) const </div><div class="ttdoc">Return the first index where &amp;#39;el&amp;#39; is found; return -1 if not found. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00766">array.hpp:766</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_a616b9884255409166ce5984241da3059"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#a616b9884255409166ce5984241da3059">mfem::NCMesh::Face::RegisterElement</a></div><div class="ttdeci">void RegisterElement(int e)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00402">ncmesh.cpp:402</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_a566edbabee3d4f0d7ce15cbc638021ca"><div class="ttname"><a href="classmfem_1_1Array.html#a566edbabee3d4f0d7ce15cbc638021ca">mfem::Array::SetSize</a></div><div class="ttdeci">void SetSize(int nsize)</div><div class="ttdoc">Change logical size of the array, keep existing entries. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00635">array.hpp:635</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a004c7eff16b8b8a5e4a2a055dbe1eef2"><div class="ttname"><a href="classmfem_1_1Mesh.html#a004c7eff16b8b8a5e4a2a055dbe1eef2">mfem::Mesh::vertices</a></div><div class="ttdeci">Array&lt; Vertex &gt; vertices</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00083">mesh.hpp:83</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a3776a06230f8be7daaddbf2b7259a6e8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a3776a06230f8be7daaddbf2b7259a6e8">mfem::NCMesh::NFaces</a></div><div class="ttdeci">int NFaces</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00490">ncmesh.hpp:490</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1TmpVertex_html_a8c023f59572ae21534906345c03913db"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1TmpVertex.html#a8c023f59572ae21534906345c03913db">mfem::NCMesh::TmpVertex::valid</a></div><div class="ttdeci">bool valid</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00803">ncmesh.hpp:803</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aed9aab2bb38bacecad378bc472268c5c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aed9aab2bb38bacecad378bc472268c5c">mfem::NCMesh::NewMeshElement</a></div><div class="ttdeci">mfem::Element * NewMeshElement(int geom) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01990">ncmesh.cpp:1990</a></div></div>
<div class="ttc" id="namespacemfem_html_a0e04453b8fa0bc8e33fe5e2dca1e6b0f"><div class="ttname"><a href="namespacemfem.html#a0e04453b8fa0bc8e33fe5e2dca1e6b0f">mfem::PrismFaceBottom</a></div><div class="ttdeci">bool PrismFaceBottom(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00610">ncmesh.cpp:610</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_af67880b1b972e03d96ae38624a625d71"><div class="ttname"><a href="classmfem_1_1Array.html#af67880b1b972e03d96ae38624a625d71">mfem::Array::DeleteLast</a></div><div class="ttdeci">void DeleteLast()</div><div class="ttdoc">Delete the last entry. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00177">array.hpp:177</a></div></div>
<div class="ttc" id="structmfem_1_1Connection_html"><div class="ttname"><a href="structmfem_1_1Connection.html">mfem::Connection</a></div><div class="ttdoc">Helper struct for defining a connectivity table, see Table::MakeFromList. </div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00027">table.hpp:27</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_af6a595c367e485f7c913617931bd6fa3"><div class="ttname"><a href="classmfem_1_1NCMesh.html#af6a595c367e485f7c913617931bd6fa3">mfem::NCMesh::UpdateLeafElements</a></div><div class="ttdeci">void UpdateLeafElements()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01907">ncmesh.cpp:1907</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_ad0e734911a34827252537528a81c0cc1"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#ad0e734911a34827252537528a81c0cc1">mfem::NCMesh::Node::vert_refc</a></div><div class="ttdeci">char vert_refc</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00396">ncmesh.hpp:396</a></div></div>
<div class="ttc" id="classmfem_1_1Triple_html_a3e6931ad67b30ff75c3a66aab786fa66"><div class="ttname"><a href="classmfem_1_1Triple.html#a3e6931ad67b30ff75c3a66aab786fa66">mfem::Triple::three</a></div><div class="ttdeci">C three</div><div class="ttdef"><b>Definition:</b> <a href="sort__pairs_8hpp_source.html#l00062">sort_pairs.hpp:62</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_af9007b5f05f3309bb84ec20d133eeea7"><div class="ttname"><a href="classmfem_1_1Mesh.html#af9007b5f05f3309bb84ec20d133eeea7">mfem::Mesh::elements</a></div><div class="ttdeci">Array&lt; Element * &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00078">mesh.hpp:78</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab945d36cffd9ce895feee6ae1da6ab30"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab945d36cffd9ce895feee6ae1da6ab30">mfem::NCMesh::TriFaceSplitLevel</a></div><div class="ttdeci">int TriFaceSplitLevel(int vn1, int vn2, int vn3) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04683">ncmesh.cpp:4683</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a7112fda7d2fa9debbaa06099b31ec911"><div class="ttname"><a href="classmfem_1_1Table.html#a7112fda7d2fa9debbaa06099b31ec911">mfem::Table::ShiftUpI</a></div><div class="ttdeci">void ShiftUpI()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00119">table.cpp:119</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a81c0a07d265dd9e55590ad9a30a90dbc"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a81c0a07d265dd9e55590ad9a30a90dbc">mfem::NCMesh::RetrieveNode</a></div><div class="ttdeci">int RetrieveNode(const Element &amp;el, int index)</div><div class="ttdoc">Return el.node[index] correctly, even if the element is refined. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01538">ncmesh.cpp:1538</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a6cd4a8f03e1f476f953f4f72bbe27f7e"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a6cd4a8f03e1f476f953f4f72bbe27f7e">mfem::NCMesh::Geoms</a></div><div class="ttdeci">int Geoms</div><div class="ttdoc">bit mask of element geometries present, see InitGeomFlags() </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00384">ncmesh.hpp:384</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html_a42d46a8d55838e334a57bd27e3179dd8"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html#a42d46a8d55838e334a57bd27e3179dd8">mfem::NCMesh::Node::edge_index</a></div><div class="ttdeci">int edge_index</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00397">ncmesh.hpp:397</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1NCList_html_a18649edb0df8174bf4fcd3dcc787c845"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1NCList.html#a18649edb0df8174bf4fcd3dcc787c845">mfem::NCMesh::NCList::MemoryUsage</a></div><div class="ttdeci">long MemoryUsage() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05090">ncmesh.cpp:5090</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a365c960ba9c3554188c8f67a720ea0ac"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a365c960ba9c3554188c8f67a720ea0ac">mfem::NCMesh::BuildElementToVertexTable</a></div><div class="ttdeci">void BuildElementToVertexTable()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02971">ncmesh.cpp:2971</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a29e6e5adbb44404859ded75e308c8f56"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a29e6e5adbb44404859ded75e308c8f56">mfem::NCMesh::nodes</a></div><div class="ttdeci">HashTable&lt; Node &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00459">ncmesh.hpp:459</a></div></div>
<div class="ttc" id="lissajous_8cpp_html_a1031d0e0a97a340abfe0a6ab9e831045"><div class="ttname"><a href="lissajous_8cpp.html#a1031d0e0a97a340abfe0a6ab9e831045">a</a></div><div class="ttdeci">double a</div><div class="ttdef"><b>Definition:</b> <a href="lissajous_8cpp_source.html#l00041">lissajous.cpp:41</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_aa03c147984578b13beaf10c603487588"><div class="ttname"><a href="classmfem_1_1Mesh.html#aa03c147984578b13beaf10c603487588">mfem::Mesh::GetNV</a></div><div class="ttdeci">int GetNV() const </div><div class="ttdoc">Returns number of vertices. Vertices are only at the corners of elements, where you would expect them...</div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00690">mesh.hpp:690</a></div></div>
<div class="ttc" id="structmfem_1_1RefTrf_html_a4306c8ed8c80e192a3ac63943afac98a"><div class="ttname"><a href="structmfem_1_1RefTrf.html#a4306c8ed8c80e192a3ac63943afac98a">mfem::RefTrf::Apply</a></div><div class="ttdeci">void Apply(const RefCoord src[3], RefCoord dst[3]) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03296">ncmesh.cpp:3296</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_a193fa55ea20cd64f604c78542fcdcaa5"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#a193fa55ea20cd64f604c78542fcdcaa5">mfem::NCMesh::Face::ForgetElement</a></div><div class="ttdeci">void ForgetElement(int e)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00409">ncmesh.cpp:409</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a02ca6f7a503b2587f58121402a17c620"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a02ca6f7a503b2587f58121402a17c620">mfem::NCMesh::pm_tet_identity</a></div><div class="ttdeci">static PointMatrix pm_tet_identity</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00775">ncmesh.hpp:775</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aefa2863ef4f316b85199ced26a6d22d5"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aefa2863ef4f316b85199ced26a6d22d5">mfem::NCMesh::GetMidFaceNode</a></div><div class="ttdeci">int GetMidFaceNode(int en1, int en2, int en3, int en4)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00295">ncmesh.cpp:295</a></div></div>
<div class="ttc" id="structmfem_1_1Hashed2_html_aea9dde0b0f6080909cf39dd7af094fcf"><div class="ttname"><a href="structmfem_1_1Hashed2.html#aea9dde0b0f6080909cf39dd7af094fcf">mfem::Hashed2::p2</a></div><div class="ttdeci">int p2</div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00027">hash.hpp:27</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a8f84e1390b55bdcaed1cd413c20f72c8"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a8f84e1390b55bdcaed1cd413c20f72c8">mfem::NCMesh::RefineElement</a></div><div class="ttdeci">void RefineElement(int elem, char ref_type)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00859">ncmesh.cpp:859</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_a33e61c443f5c4bd61647a74959a8e84d"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#a33e61c443f5c4bd61647a74959a8e84d">mfem::CoarseFineTransformations::Clear</a></div><div class="ttdeci">void Clear()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04133">ncmesh.cpp:4133</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a1038282255f14f1056c8cde9247b0864">mfem::Geometry::TETRAHEDRON</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00037">geom.hpp:37</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a7412ab7ae0feb6018148d7a947fa0716"><div class="ttname"><a href="classmfem_1_1Element.html#a7412ab7ae0feb6018148d7a947fa0716">mfem::Element::GetNFaces</a></div><div class="ttdeci">virtual int GetNFaces(int &amp;nFaceVertices) const =0</div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a427bb64e4c1d76b656a035346c45050f"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a427bb64e4c1d76b656a035346c45050f">mfem::NCMesh::NewHexahedron</a></div><div class="ttdeci">int NewHexahedron(int n0, int n1, int n2, int n3, int n4, int n5, int n6, int n7, int attr, int fattr0, int fattr1, int fattr2, int fattr3, int fattr4, int fattr5)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00453">ncmesh.cpp:453</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a4d06c644e6281f36db77ff4cede065f3"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a4d06c644e6281f36db77ff4cede065f3">mfem::NCMesh::boundary_faces</a></div><div class="ttdeci">Array&lt; int &gt; boundary_faces</div><div class="ttdoc">subset of all faces, set by BuildFaceList </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00499">ncmesh.hpp:499</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_a7b31cd819f05b872bac50a1473848943"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#a7b31cd819f05b872bac50a1473848943">mfem::NCMesh::Element::child</a></div><div class="ttdeci">int child[8]</div><div class="ttdoc">2-8 children (if ref_type != 0) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00448">ncmesh.hpp:448</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html">mfem::NCMesh::Element</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00436">ncmesh.hpp:436</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Node_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Node.html">mfem::NCMesh::Node</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00394">ncmesh.hpp:394</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a6603ae91d6e852c9576ab98ea2074d85"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a6603ae91d6e852c9576ab98ea2074d85">mfem::NCMesh::leaf_elements</a></div><div class="ttdeci">Array&lt; int &gt; leaf_elements</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00492">ncmesh.hpp:492</a></div></div>
<div class="ttc" id="classmfem_1_1Triple_html_adbdb3b87212f05e20f71bdf9bd0c2306"><div class="ttname"><a href="classmfem_1_1Triple.html#adbdb3b87212f05e20f71bdf9bd0c2306">mfem::Triple::one</a></div><div class="ttdeci">A one</div><div class="ttdef"><b>Definition:</b> <a href="sort__pairs_8hpp_source.html#l00060">sort_pairs.hpp:60</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a509686371a908c7d100910c2548978f0"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a509686371a908c7d100910c2548978f0">mfem::NCMesh::pm_quad_identity</a></div><div class="ttdeci">static PointMatrix pm_quad_identity</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00774">ncmesh.hpp:774</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805a5ae699bb2bc0c842ef374bf37a8e73ae"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805a5ae699bb2bc0c842ef374bf37a8e73ae">mfem::Geometry::INVALID</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00036">geom.hpp:36</a></div></div>
<div class="ttc" id="classmfem_1_1BlockArray_1_1iterator_html"><div class="ttname"><a href="classmfem_1_1BlockArray_1_1iterator.html">mfem::BlockArray::iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00524">array.hpp:524</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aca33fe3034ec45c49451541b76f4cb0d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aca33fe3034ec45c49451541b76f4cb0d">mfem::NCMesh::EdgeSplitLevel</a></div><div class="ttdeci">int EdgeSplitLevel(int vn1, int vn2) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04676">ncmesh.cpp:4676</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_aa3f81cd02927bc59a02a9aeff61ffe9e"><div class="ttname"><a href="classmfem_1_1Table.html#aa3f81cd02927bc59a02a9aeff61ffe9e">mfem::Table::SetIJ</a></div><div class="ttdeci">void SetIJ(int *newI, int *newJ, int newsize=-1)</div><div class="ttdoc">Replace the I and J arrays with the given newI and newJ arrays. </div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00208">table.cpp:208</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_ae88fd62884438bb24d7f77102a96ccec"><div class="ttname"><a href="classmfem_1_1Table.html#ae88fd62884438bb24d7f77102a96ccec">mfem::Table::MakeJ</a></div><div class="ttdeci">void MakeJ()</div><div class="ttdef"><b>Definition:</b> <a href="table_8cpp_source.html#l00095">table.cpp:95</a></div></div>
<div class="ttc" id="ex24_8cpp_html_a70b5e28b5bc3d1b63a7435c5fe50b837"><div class="ttname"><a href="ex24_8cpp.html#a70b5e28b5bc3d1b63a7435c5fe50b837">dim</a></div><div class="ttdeci">int dim</div><div class="ttdef"><b>Definition:</b> <a href="ex24_8cpp_source.html#l00043">ex24.cpp:43</a></div></div>
<div class="ttc" id="structmfem_1_1Hashed2_html_ae12aa48df8ab019dd4bc9da795dd4996"><div class="ttname"><a href="structmfem_1_1Hashed2.html#ae12aa48df8ab019dd4bc9da795dd4996">mfem::Hashed2::p1</a></div><div class="ttdeci">int p1</div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00027">hash.hpp:27</a></div></div>
<div class="ttc" id="namespacemfem_html_af736ce0d62a2894982a1eda9dbe93fb7ae234de581c9c5ef91322f1469a585f9e"><div class="ttname"><a href="namespacemfem.html#af736ce0d62a2894982a1eda9dbe93fb7ae234de581c9c5ef91322f1469a585f9e">mfem::FaceType::Boundary</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29"><div class="ttname"><a href="classmfem_1_1Element.html#aaac293c18ce91216ee202754eed37a78ac6425c3d59a68d90138f90df797fda29">mfem::Element::TRIANGLE</a></div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00041">element.hpp:41</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_af8bd69a06325f7b404c0525b30df3502"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#af8bd69a06325f7b404c0525b30df3502">mfem::NCMesh::GeomInfo::Initialize</a></div><div class="ttdeci">void Initialize(const mfem::Element *elem)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00030">ncmesh.cpp:30</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a6f17fc9b7fe7f861ed146b9c12d711fe"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a6f17fc9b7fe7f861ed146b9c12d711fe">mfem::NCMesh::FindVertexCousins</a></div><div class="ttdeci">void FindVertexCousins(int elem, int local, Array&lt; int &gt; &amp;cousins) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03375">ncmesh.cpp:3375</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Point_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Point.html">mfem::NCMesh::Point</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00699">ncmesh.hpp:699</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1MeshId_html_ac5c46c728b3fee20e8bb62ef2da95dd1"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1MeshId.html#ac5c46c728b3fee20e8bb62ef2da95dd1">mfem::NCMesh::MeshId::geom</a></div><div class="ttdeci">signed char geom</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00156">ncmesh.hpp:156</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aed9a87d8e4733fb563b16443963e580e"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aed9a87d8e4733fb563b16443963e580e">mfem::NCMesh::QuadFaceSplitType</a></div><div class="ttdeci">int QuadFaceSplitType(int v1, int v2, int v3, int v4, int mid[5]=NULL) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02186">ncmesh.cpp:2186</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a3babdde3ea37f91dac489ef048ee645b"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a3babdde3ea37f91dac489ef048ee645b">mfem::NCMesh::free_element_ids</a></div><div class="ttdeci">Array&lt; int &gt; free_element_ids</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00463">ncmesh.hpp:463</a></div></div>
<div class="ttc" id="namespacemfem_html_a40e1a9b833ee3d3cae4145bb3b267333"><div class="ttname"><a href="namespacemfem.html#a40e1a9b833ee3d3cae4145bb3b267333">mfem::CubeFaceBottom</a></div><div class="ttdeci">bool CubeFaceBottom(int node, int *n)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00604">ncmesh.cpp:604</a></div></div>
<div class="ttc" id="life_8cpp_html_a3b0ebfb1ea55d7ef281731142fe7e93d"><div class="ttname"><a href="life_8cpp.html#a3b0ebfb1ea55d7ef281731142fe7e93d">index</a></div><div class="ttdeci">int index(int i, int j, int nx, int ny)</div><div class="ttdef"><b>Definition:</b> <a href="life_8cpp_source.html#l00241">life.cpp:241</a></div></div>
<div class="ttc" id="ncmesh__tables_8hpp_html"><div class="ttname"><a href="ncmesh__tables_8hpp.html">ncmesh_tables.hpp</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Master_html"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Master.html">mfem::NCMesh::Master</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00168">ncmesh.hpp:168</a></div></div>
<div class="ttc" id="structmfem_1_1Hashed4_html_ac4f859c8886967c443f65c5db8bf281a"><div class="ttname"><a href="structmfem_1_1Hashed4.html#ac4f859c8886967c443f65c5db8bf281a">mfem::Hashed4::p1</a></div><div class="ttdeci">int p1</div><div class="ttdef"><b>Definition:</b> <a href="hash_8hpp_source.html#l00036">hash.hpp:36</a></div></div>
<div class="ttc" id="classmfem_1_1Memory_html"><div class="ttname"><a href="classmfem_1_1Memory.html">mfem::Memory&lt; int &gt;</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_ad8ec08b2b1213643206fdd5a9aab5931"><div class="ttname"><a href="classmfem_1_1Element.html#ad8ec08b2b1213643206fdd5a9aab5931">mfem::Element::GetNVertices</a></div><div class="ttdeci">virtual int GetNVertices() const =0</div></div>
<div class="ttc" id="structmfem_1_1Embedding_html_a6c0f09cfd83c6463c30c48ca598dd00d"><div class="ttname"><a href="structmfem_1_1Embedding.html#a6c0f09cfd83c6463c30c48ca598dd00d">mfem::Embedding::parent</a></div><div class="ttdeci">int parent</div><div class="ttdoc">Element index in the coarse mesh. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00049">ncmesh.hpp:49</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a1a66b8c36823d7660121861430e335cf"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a1a66b8c36823d7660121861430e335cf">mfem::NCMesh::AssignLeafIndices</a></div><div class="ttdeci">virtual void AssignLeafIndices()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01918">ncmesh.cpp:1918</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_af64380c06b9ff471f9ade1a948a66c84"><div class="ttname"><a href="classmfem_1_1NCMesh.html#af64380c06b9ff471f9ade1a948a66c84">mfem::NCMesh::pm_hex_identity</a></div><div class="ttdeci">static PointMatrix pm_hex_identity</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00777">ncmesh.hpp:777</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a6db73bae7fda9aef6dd839dd237e21f3"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a6db73bae7fda9aef6dd839dd237e21f3">mfem::NCMesh::FindEdgeElements</a></div><div class="ttdeci">void FindEdgeElements(int vn1, int vn2, int vn3, int vn4, Array&lt; MeshId &gt; &amp;prisms) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00675">ncmesh.cpp:675</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_a4cafe67f741771384f4725ed7f4cf8a5"><div class="ttname"><a href="classmfem_1_1Element.html#a4cafe67f741771384f4725ed7f4cf8a5">mfem::Element::GetFaceVertices</a></div><div class="ttdeci">virtual const int * GetFaceVertices(int fi) const =0</div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1TmpVertex_html_a74b162a4f4aac4ee12b4d7fba12dee97"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1TmpVertex.html#a74b162a4f4aac4ee12b4d7fba12dee97">mfem::NCMesh::TmpVertex::pos</a></div><div class="ttdeci">double pos[3]</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00804">ncmesh.hpp:804</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_adf2b80cd1f59b280d19f154fd6cb8e91"><div class="ttname"><a href="classmfem_1_1NCMesh.html#adf2b80cd1f59b280d19f154fd6cb8e91">mfem::NCMesh::CheckDerefinementNCLevel</a></div><div class="ttdeci">virtual void CheckDerefinementNCLevel(const Table &amp;deref_table, Array&lt; int &gt; &amp;level_ok, int max_nc_level)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01748">ncmesh.cpp:1748</a></div></div>
<div class="ttc" id="classmfem_1_1Array_html_afc37a6b99ec8f6dbda516d33384a1f01"><div class="ttname"><a href="classmfem_1_1Array.html#afc37a6b99ec8f6dbda516d33384a1f01">mfem::Array::Last</a></div><div class="ttdeci">T &amp; Last()</div><div class="ttdoc">Return the last element in the array. </div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00740">array.hpp:740</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a288fdd4bddc6764be0d569288049f567"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a288fdd4bddc6764be0d569288049f567">mfem::NCMesh::NeighborExpand</a></div><div class="ttdeci">void NeighborExpand(const Array&lt; int &gt; &amp;elems, Array&lt; int &gt; &amp;expanded, const Array&lt; int &gt; *search_set=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03237">ncmesh.cpp:3237</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a52de15077df362665239cd6645feadfb"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a52de15077df362665239cd6645feadfb">mfem::NCMesh::elements</a></div><div class="ttdeci">BlockArray&lt; Element &gt; elements</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00462">ncmesh.hpp:462</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aeb42afcff5d15ae4d8e246d5fc999547"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aeb42afcff5d15ae4d8e246d5fc999547">mfem::NCMesh::FindSetNeighbors</a></div><div class="ttdeci">void FindSetNeighbors(const Array&lt; char &gt; &amp;elem_set, Array&lt; int &gt; *neighbors, Array&lt; char &gt; *neighbor_set=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03051">ncmesh.cpp:3051</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a23afea537d770acba9004cc8b52b2eea"><div class="ttname"><a href="classmfem_1_1Mesh.html#a23afea537d770acba9004cc8b52b2eea">mfem::Mesh::GetNEdges</a></div><div class="ttdeci">int GetNEdges() const </div><div class="ttdoc">Return the number of edges. </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00699">mesh.hpp:699</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a47928516e152d376a46fb5fb141b2e7f"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a47928516e152d376a46fb5fb141b2e7f">mfem::NCMesh::GetEdgeVertices</a></div><div class="ttdeci">void GetEdgeVertices(const MeshId &amp;edge_id, int vert_index[2], bool oriented=true) const </div><div class="ttdoc">Return Mesh vertex indices of an edge identified by &amp;#39;edge_id&amp;#39;. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04422">ncmesh.cpp:4422</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a083effe1fd091d5058a4dac371738ece"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a083effe1fd091d5058a4dac371738ece">mfem::NCMesh::Update</a></div><div class="ttdeci">virtual void Update()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00213">ncmesh.cpp:213</a></div></div>
<div class="ttc" id="classmfem_1_1BlockArray_html_a7d6fc9d341615ed5e63e5de88d930ce5"><div class="ttname"><a href="classmfem_1_1BlockArray.html#a7d6fc9d341615ed5e63e5de88d930ce5">mfem::BlockArray::end</a></div><div class="ttdeci">iterator end()</div><div class="ttdef"><b>Definition:</b> <a href="array_8hpp_source.html#l00559">array.hpp:559</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a4c4e5cacfd78818b55d0c86a1b30523a"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a4c4e5cacfd78818b55d0c86a1b30523a">mfem::NCMesh::HaveTets</a></div><div class="ttdeci">bool HaveTets() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00525">ncmesh.hpp:525</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ae1d2a82c44cce8bd65fa68ac3a8788f3">mfem::Geometry::PRISM</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00037">geom.hpp:37</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a41cccc67d8ab0a070b103b83ba8e450c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a41cccc67d8ab0a070b103b83ba8e450c">mfem::NCMesh::MemoryUsage</a></div><div class="ttdeci">long MemoryUsage() const </div><div class="ttdoc">Return total number of bytes allocated. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05114">ncmesh.cpp:5114</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a1f6835099238cd350794c812622c68f4"><div class="ttname"><a href="classmfem_1_1Table.html#a1f6835099238cd350794c812622c68f4">mfem::Table::GetI</a></div><div class="ttdeci">int * GetI()</div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00113">table.hpp:113</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html_ac9de427ce790fe47f209ca0682d0e23c"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html#ac9de427ce790fe47f209ca0682d0e23c">mfem::CoarseFineTransformations::MemoryUsage</a></div><div class="ttdeci">long MemoryUsage() const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05104">ncmesh.cpp:5104</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a84c94efb0598219f239132ec87867f8d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a84c94efb0598219f239132ec87867f8d">mfem::NCMesh::PrintCoarseElements</a></div><div class="ttdeci">void PrintCoarseElements(std::ostream &amp;out) const </div><div class="ttdoc">I/O: Print the &amp;quot;coarse_elements&amp;quot; section of the mesh file (ver. &amp;gt;= 1.1). </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04951">ncmesh.cpp:4951</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0c6180975447aca4b74416dac196bbe1"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0c6180975447aca4b74416dac196bbe1">mfem::NCMesh::shadow</a></div><div class="ttdeci">HashTable&lt; Node &gt; shadow</div><div class="ttdoc">temporary storage for reparented nodes </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00531">ncmesh.hpp:531</a></div></div>
<div class="ttc" id="structmfem_1_1CoarseFineTransformations_html"><div class="ttname"><a href="structmfem_1_1CoarseFineTransformations.html">mfem::CoarseFineTransformations</a></div><div class="ttdoc">Defines the coarse-fine transformations of all fine elements. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00060">ncmesh.hpp:60</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ab015470342061d0be5cd829206973793"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ab015470342061d0be5cd829206973793">mfem::NCMesh::BuildVertexList</a></div><div class="ttdeci">virtual void BuildVertexList()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02757">ncmesh.cpp:2757</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a66a55c978781ac29f1d6e380cd79e28b"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a66a55c978781ac29f1d6e380cd79e28b">mfem::NCMesh::GetEdgeList</a></div><div class="ttdeci">const NCList &amp; GetEdgeList()</div><div class="ttdoc">Return the current list of conforming and nonconforming edges. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00219">ncmesh.hpp:219</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a516369f29717e0a850773e5bc30ee68d"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a516369f29717e0a850773e5bc30ee68d">mfem::NCMesh::UpdateElementToVertexTable</a></div><div class="ttdeci">void UpdateElementToVertexTable()</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00682">ncmesh.hpp:682</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1GeomInfo_html_a5a2230e62a46febd2bea4afecb58e631"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1GeomInfo.html#a5a2230e62a46febd2bea4afecb58e631">mfem::NCMesh::GeomInfo::nv</a></div><div class="ttdeci">int nv</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00837">ncmesh.hpp:837</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a8d4354e9a3a97c335e7b8b788c66486e"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a8d4354e9a3a97c335e7b8b788c66486e">mfem::NCMesh::ElementSharesEdge</a></div><div class="ttdeci">virtual void ElementSharesEdge(int elem, int local, int enode)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00643">ncmesh.hpp:643</a></div></div>
<div class="ttc" id="classmfem_1_1Table_html_a7b2a7ca70cafddc5742421c83e97515d"><div class="ttname"><a href="classmfem_1_1Table.html#a7b2a7ca70cafddc5742421c83e97515d">mfem::Table::RowSize</a></div><div class="ttdeci">int RowSize(int i) const </div><div class="ttdef"><b>Definition:</b> <a href="table_8hpp_source.html#l00108">table.hpp:108</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a279712688518fa4be7f6d76ea0be34ee"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a279712688518fa4be7f6d76ea0be34ee">mfem::NCMesh::GetElementDepth</a></div><div class="ttdeci">int GetElementDepth(int i) const </div><div class="ttdoc">Return the distance of leaf &amp;#39;i&amp;#39; from the root. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04532">ncmesh.cpp:4532</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a59357a4af171acdb72039db96e5de76f"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a59357a4af171acdb72039db96e5de76f">mfem::NCMesh::FindNodeExt</a></div><div class="ttdeci">int FindNodeExt(const Element &amp;el, int node, bool abort=true)</div><div class="ttdoc">Extended version of find_node: works if &amp;#39;el&amp;#39; is refined. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02260">ncmesh.cpp:2260</a></div></div>
<div class="ttc" id="classmfem_1_1DenseMatrix_html_a5c62b399e1c6408e5f1903f6cab5dfbb"><div class="ttname"><a href="classmfem_1_1DenseMatrix.html#a5c62b399e1c6408e5f1903f6cab5dfbb">mfem::DenseMatrix::SetSize</a></div><div class="ttdeci">void SetSize(int s)</div><div class="ttdoc">Change the size of the DenseMatrix to s x s. </div><div class="ttdef"><b>Definition:</b> <a href="densemat_8hpp_source.html#l00090">densemat.hpp:90</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_ac78f28a99fd0fec4564daa376501d83c"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#ac78f28a99fd0fec4564daa376501d83c">mfem::NCMesh::Element::ref_type</a></div><div class="ttdeci">char ref_type</div><div class="ttdoc">bit mask of X,Y,Z refinements (bits 0,1,2 respectively) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00439">ncmesh.hpp:439</a></div></div>
<div class="ttc" id="namespacemfem_html_a0e01b55edfba5e7b3e4d6913cee6be45"><div class="ttname"><a href="namespacemfem.html#a0e01b55edfba5e7b3e4d6913cee6be45">mfem::out</a></div><div class="ttdeci">OutStream out(std::cout)</div><div class="ttdoc">Global stream used by the library for standard output. Initially it uses the same std::streambuf as s...</div><div class="ttdef"><b>Definition:</b> <a href="globals_8hpp_source.html#l00066">globals.hpp:66</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_aec895373049cac0f8bdc76ff49763f5c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#aec895373049cac0f8bdc76ff49763f5c">mfem::NCMesh::CollectQuadFaceVertices</a></div><div class="ttdeci">void CollectQuadFaceVertices(int v0, int v1, int v2, int v3, Array&lt; int &gt; &amp;indices)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02937">ncmesh.cpp:2937</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a30cfbc14e490f22644ca105bd4c24e62"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a30cfbc14e490f22644ca105bd4c24e62">mfem::NCMesh::find_node</a></div><div class="ttdeci">static int find_node(const Element &amp;el, int node)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02250">ncmesh.cpp:2250</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ad15b9629acb977820834b2d18e82887c"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ad15b9629acb977820834b2d18e82887c">mfem::NCMesh::UnreferenceElement</a></div><div class="ttdeci">void UnreferenceElement(int elem, Array&lt; int &gt; &amp;elemFaces)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00334">ncmesh.cpp:334</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1MeshId_html_a357fd304340aa413744e8ef7e0652ad8"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1MeshId.html#a357fd304340aa413744e8ef7e0652ad8">mfem::NCMesh::MeshId::index</a></div><div class="ttdeci">int index</div><div class="ttdoc">Mesh number. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00153">ncmesh.hpp:153</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a643c2de4d2ae90eca9672838aebd6d14"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a643c2de4d2ae90eca9672838aebd6d14">mfem::NCMesh::LoadVertexParents</a></div><div class="ttdeci">void LoadVertexParents(std::istream &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04882">ncmesh.cpp:4882</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805ac812b0ab34c8feda27273aeb7d9f6cfb">mfem::Geometry::CUBE</a></div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00037">geom.hpp:37</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html"><div class="ttname"><a href="classmfem_1_1Element.html">mfem::Element</a></div><div class="ttdoc">Abstract data type element. </div><div class="ttdef"><b>Definition:</b> <a href="element_8hpp_source.html#l00028">element.hpp:28</a></div></div>
<div class="ttc" id="structmfem_1_1RefTrf_html"><div class="ttname"><a href="structmfem_1_1RefTrf.html">mfem::RefTrf</a></div><div class="ttdef"><b>Definition:</b> <a href="ncmesh__tables_8hpp_source.html#l00153">ncmesh_tables.hpp:153</a></div></div>
<div class="ttc" id="classmfem_1_1Segment_html"><div class="ttname"><a href="classmfem_1_1Segment.html">mfem::Segment</a></div><div class="ttdoc">Data type line segment element. </div><div class="ttdef"><b>Definition:</b> <a href="segment_8hpp_source.html#l00022">segment.hpp:22</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_ae4a688fad31590e4b7d1f82ef9991011"><div class="ttname"><a href="classmfem_1_1NCMesh.html#ae4a688fad31590e4b7d1f82ef9991011">mfem::NCMesh::PrintStats</a></div><div class="ttdeci">void PrintStats(std::ostream &amp;out=mfem::out) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l05162">ncmesh.cpp:5162</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Face_html_aecaa403c267d898d2a6c3155950c1744"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Face.html#aecaa403c267d898d2a6c3155950c1744">mfem::NCMesh::Face::GetSingleElement</a></div><div class="ttdeci">int GetSingleElement() const </div><div class="ttdoc">Return one of elem[0] or elem[1] and make sure the other is -1. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l00424">ncmesh.cpp:424</a></div></div>
<div class="ttc" id="classmfem_1_1Element_html_aaa7b6a988fd7eb10928cc14ba0f47543"><div class="ttname"><a href="classmfem_1_1Element.html#aaa7b6a988fd7eb10928cc14ba0f47543">mfem::Element::GetType</a></div><div class="ttdeci">virtual Type GetType() const =0</div><div class="ttdoc">Returns element&amp;#39;s type. </div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a90bd902613bfeeed107d7858d53d1654"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a90bd902613bfeeed107d7858d53d1654">mfem::NCMesh::CalcVertexPos</a></div><div class="ttdeci">const double * CalcVertexPos(int node) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l02004">ncmesh.cpp:2004</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_a4948edcc4202f9cdde6c73137b81d6e7"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#a4948edcc4202f9cdde6c73137b81d6e7">mfem::NCMesh::Element::rank</a></div><div class="ttdeci">int rank</div><div class="ttdoc">processor number (ParNCMesh), -1 if undefined/unknown </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00443">ncmesh.hpp:443</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Element_html_ae8c0700a9b31202bfc1721c0485ce5d9"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Element.html#ae8c0700a9b31202bfc1721c0485ce5d9">mfem::NCMesh::Element::node</a></div><div class="ttdeci">int node[8]</div><div class="ttdoc">element corners (if ref_type == 0) </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00447">ncmesh.hpp:447</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_afa8b1cc928da42cf74d56207cbd1daa3"><div class="ttname"><a href="classmfem_1_1NCMesh.html#afa8b1cc928da42cf74d56207cbd1daa3">mfem::NCMesh::GetVertexRootCoord</a></div><div class="ttdeci">int GetVertexRootCoord(int elem, RefCoord coord[3]) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l03304">ncmesh.cpp:3304</a></div></div>
<div class="ttc" id="classmfem_1_1Mesh_html_a072de140d33089ffaff2d016a48137ba"><div class="ttname"><a href="classmfem_1_1Mesh.html#a072de140d33089ffaff2d016a48137ba">mfem::Mesh::GetBdrElement</a></div><div class="ttdeci">const Element * GetBdrElement(int i) const </div><div class="ttdef"><b>Definition:</b> <a href="mesh_8hpp_source.html#l00779">mesh.hpp:779</a></div></div>
<div class="ttc" id="structmfem_1_1NCMesh_1_1Slave_html_a4d7499a4b971ae7b4effaac4d657631f"><div class="ttname"><a href="structmfem_1_1NCMesh_1_1Slave.html#a4d7499a4b971ae7b4effaac4d657631f">mfem::NCMesh::Slave::point_matrix</a></div><div class="ttdeci">DenseMatrix point_matrix</div><div class="ttdoc">position within the master edge/face </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00182">ncmesh.hpp:182</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a450ca38b2c425eef740b2c0730c8e3d5"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a450ca38b2c425eef740b2c0730c8e3d5">mfem::NCMesh::faces</a></div><div class="ttdeci">HashTable&lt; Face &gt; faces</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00460">ncmesh.hpp:460</a></div></div>
<div class="ttc" id="structmfem_1_1Embedding_html"><div class="ttname"><a href="structmfem_1_1Embedding.html">mfem::Embedding</a></div><div class="ttdoc">Defines the position of a fine element within a coarse element. </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00046">ncmesh.hpp:46</a></div></div>
<div class="ttc" id="namespacemfem_html_a6fa0782cff1da4c5e46b151ba047ebcd"><div class="ttname"><a href="namespacemfem.html#a6fa0782cff1da4c5e46b151ba047ebcd">mfem::T_ONE</a></div><div class="ttdeci">const RefCoord T_ONE</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh__tables_8hpp_source.html#l00095">ncmesh_tables.hpp:95</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_af2de6a703ab8986d06a9269f1d562b76"><div class="ttname"><a href="classmfem_1_1NCMesh.html#af2de6a703ab8986d06a9269f1d562b76">mfem::NCMesh::Refine</a></div><div class="ttdeci">virtual void Refine(const Array&lt; Refinement &gt; &amp;refinements)</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l01492">ncmesh.cpp:1492</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a0ba413eb308e08053bbf1ab2a987fcd0"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a0ba413eb308e08053bbf1ab2a987fcd0">mfem::NCMesh::NEdges</a></div><div class="ttdeci">int NEdges</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00490">ncmesh.hpp:490</a></div></div>
<div class="ttc" id="structmfem_1_1Embedding_html_a7c0c0065f2d81a736e03ff36e2a85807"><div class="ttname"><a href="structmfem_1_1Embedding.html#a7c0c0065f2d81a736e03ff36e2a85807">mfem::Embedding::matrix</a></div><div class="ttdeci">int matrix</div><div class="ttdoc">Index into the DenseTensor corresponding to the parent Geometry::Type stored in CoarseFineTransformat...</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00052">ncmesh.hpp:52</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a9803d9f8c7027d9f7d691f85f5e2ba4f"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a9803d9f8c7027d9f7d691f85f5e2ba4f">mfem::NCMesh::RefCoord</a></div><div class="ttdeci">int64_t RefCoord</div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00365">ncmesh.hpp:365</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a5dd7435aedd532b0135b65cac0a2a89e"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a5dd7435aedd532b0135b65cac0a2a89e">mfem::NCMesh::face_geom</a></div><div class="ttdeci">Array&lt; char &gt; face_geom</div><div class="ttdoc">face geometry by face index, set by OnMeshUpdated </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8hpp_source.html#l00500">ncmesh.hpp:500</a></div></div>
<div class="ttc" id="classmfem_1_1Geometry_html_a2c101bb5c270ab5eeffb510e2c274805"><div class="ttname"><a href="classmfem_1_1Geometry.html#a2c101bb5c270ab5eeffb510e2c274805">mfem::Geometry::Type</a></div><div class="ttdeci">Type</div><div class="ttdef"><b>Definition:</b> <a href="geom_8hpp_source.html#l00034">geom.hpp:34</a></div></div>
<div class="ttc" id="classmfem_1_1NCMesh_html_a122c33a1fe4949e8b77de98afe107971"><div class="ttname"><a href="classmfem_1_1NCMesh.html#a122c33a1fe4949e8b77de98afe107971">mfem::NCMesh::GetEdgeMaster</a></div><div class="ttdeci">int GetEdgeMaster(int v1, int v2) const </div><div class="ttdef"><b>Definition:</b> <a href="ncmesh_8cpp_source.html#l04523">ncmesh.cpp:4523</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 10 2020 19:56:14 for MFEM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
