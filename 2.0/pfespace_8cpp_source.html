<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MFEM: pfespace.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM&#160;<span id="projectnumber">v2.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_22e7892454e350ae265aec98296a27f7.html">mfem</a>      </li>
      <li class="navelem"><a class="el" href="dir_69750015eed5bb6fc5e8920de8ff3573.html">fem</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">pfespace.cpp</div>  </div>
</div>
<div class="contents">
<a href="pfespace_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (c) 2010, Lawrence Livermore National Security, LLC. Produced at</span>
<a name="l00002"></a>00002 <span class="comment">// the Lawrence Livermore National Laboratory. LLNL-CODE-443211. All Rights</span>
<a name="l00003"></a>00003 <span class="comment">// reserved. See file COPYRIGHT for details.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This file is part of the MFEM library. For more information and source code</span>
<a name="l00006"></a>00006 <span class="comment">// availability see http://mfem.googlecode.com.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span>
<a name="l00009"></a>00009 <span class="comment">// terms of the GNU Lesser General Public License (as published by the Free</span>
<a name="l00010"></a>00010 <span class="comment">// Software Foundation) version 2.1 dated February 1999.</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#ifdef MFEM_USE_MPI</span>
<a name="l00013"></a>00013 <span class="preprocessor"></span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="fem_8hpp.html">fem.hpp</a>&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;../general/sort_pairs.hpp&quot;</span>
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <a class="code" href="classParFiniteElementSpace.html#a5970b102b70a22eed9153252a8a43e8d">ParFiniteElementSpace::ParFiniteElementSpace</a>(<a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> &amp;pf)
<a name="l00018"></a>00018    : <a class="code" href="classFiniteElementSpace.html" title="Abstract finite element space.">FiniteElementSpace</a>(pf)
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020    MyComm = pf.<a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>;
<a name="l00021"></a>00021    NRanks = pf.<a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>;
<a name="l00022"></a>00022    MyRank = pf.<a class="code" href="classParFiniteElementSpace.html#a54e3fbf715a2bce6aee288c4d897f31e">MyRank</a>;
<a name="l00023"></a>00023    pmesh = pf.<a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>;
<a name="l00024"></a>00024    gcomm = pf.<a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>;
<a name="l00025"></a>00025    pf.<a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a> = NULL;
<a name="l00026"></a>00026    ltdof_size = pf.<a class="code" href="classParFiniteElementSpace.html#a1257bfa2f8a5852a6f19891d9dec7e35" title="Number of true dofs in this processor (local true dofs).">ltdof_size</a>;
<a name="l00027"></a>00027    <a class="code" href="array_8hpp.html#a48b96070f3028a645b10cebfd15a14d2">Swap</a>(ldof_group, pf.<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>);
<a name="l00028"></a>00028    <a class="code" href="array_8hpp.html#a48b96070f3028a645b10cebfd15a14d2">Swap</a>(ldof_ltdof, pf.<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>);
<a name="l00029"></a>00029    <a class="code" href="array_8hpp.html#a48b96070f3028a645b10cebfd15a14d2">Swap</a>(dof_offsets, pf.<a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>);
<a name="l00030"></a>00030    <a class="code" href="array_8hpp.html#a48b96070f3028a645b10cebfd15a14d2">Swap</a>(tdof_offsets, pf.<a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>);
<a name="l00031"></a>00031    <a class="code" href="array_8hpp.html#a48b96070f3028a645b10cebfd15a14d2">Swap</a>(tdof_nb_offsets, pf.<a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>);
<a name="l00032"></a>00032    <a class="code" href="array_8hpp.html#a48b96070f3028a645b10cebfd15a14d2">Swap</a>(ldof_sign, pf.<a class="code" href="classParFiniteElementSpace.html#ac8cab176d4f0a56c869bca624f613dc4" title="The sign of the basis functions at the scalar local dofs.">ldof_sign</a>);
<a name="l00033"></a>00033    P = pf.<a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>;
<a name="l00034"></a>00034    pf.<a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a> = NULL;
<a name="l00035"></a>00035 }
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <a class="code" href="classParFiniteElementSpace.html#a5970b102b70a22eed9153252a8a43e8d">ParFiniteElementSpace::ParFiniteElementSpace</a>(
<a name="l00038"></a>00038    <a class="code" href="classParMesh.html" title="Class for parallel meshes.">ParMesh</a> *pm, <a class="code" href="classFiniteElementCollection.html">FiniteElementCollection</a> *f, <span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> order)
<a name="l00039"></a>00039    : <a class="code" href="classFiniteElementSpace.html" title="Abstract finite element space.">FiniteElementSpace</a>(pm, f, dim, order)
<a name="l00040"></a>00040 {
<a name="l00041"></a>00041    mesh = pmesh = pm;
<a name="l00042"></a>00042 
<a name="l00043"></a>00043    MyComm = pmesh-&gt;<a class="code" href="classParMesh.html#a71fc1b1cb00f15b8ecbd0e7914fae4e9">GetComm</a>();
<a name="l00044"></a>00044    MPI_Comm_size(MyComm, &amp;NRanks);
<a name="l00045"></a>00045    MPI_Comm_rank(MyComm, &amp;MyRank);
<a name="l00046"></a>00046 
<a name="l00047"></a>00047    P = NULL;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049    <span class="keywordflow">if</span> (NURBSext)
<a name="l00050"></a>00050    {
<a name="l00051"></a>00051       <span class="keywordflow">if</span> (own_ext)
<a name="l00052"></a>00052       {
<a name="l00053"></a>00053          <span class="comment">// the FiniteElementSpace constructor created a serial</span>
<a name="l00054"></a>00054          <span class="comment">// NURBSExtension of higher order than the mesh NURBSExtension</span>
<a name="l00055"></a>00055 
<a name="l00056"></a>00056          ParNURBSExtension *pNe = <span class="keyword">new</span> ParNURBSExtension(
<a name="l00057"></a>00057             NURBSext, dynamic_cast&lt;ParNURBSExtension *&gt;(pmesh-&gt;NURBSext));
<a name="l00058"></a>00058          <span class="comment">// serial NURBSext is destroyed by the above constructor</span>
<a name="l00059"></a>00059          NURBSext = pNe;
<a name="l00060"></a>00060          UpdateNURBS();
<a name="l00061"></a>00061       }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063       ConstructTrueNURBSDofs();
<a name="l00064"></a>00064    }
<a name="l00065"></a>00065    <span class="keywordflow">else</span>
<a name="l00066"></a>00066    {
<a name="l00067"></a>00067       ConstructTrueDofs();
<a name="l00068"></a>00068    }
<a name="l00069"></a>00069 
<a name="l00070"></a>00070    GenerateGlobalOffsets();
<a name="l00071"></a>00071 }
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#af0ef01b86c6dbe824849711500447048">ParFiniteElementSpace::GetGroupComm</a>(
<a name="l00074"></a>00074    <a class="code" href="classGroupCommunicator.html">GroupCommunicator</a> &amp;gc, <span class="keywordtype">int</span> ldof_type, <a class="code" href="classArray.html">Array&lt;int&gt;</a> *ldof_sign)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076    <span class="keywordtype">int</span> gr;
<a name="l00077"></a>00077    <span class="keywordtype">int</span> ng = <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#ac24f718f58975ee802ebd86c02c410b4">GetNGroups</a>();
<a name="l00078"></a>00078    <span class="keywordtype">int</span> nvd, ned, nfd;
<a name="l00079"></a>00079    <a class="code" href="classArray.html">Array&lt;int&gt;</a> dofs;
<a name="l00080"></a>00080 
<a name="l00081"></a>00081    <span class="keywordtype">int</span> group_ldof_counter;
<a name="l00082"></a>00082    <a class="code" href="classTable.html">Table</a> &amp;group_ldof = gc.<a class="code" href="classGroupCommunicator.html#a1b82cb58c0d0180fda64e9480a6b4f44">GroupLDofTable</a>();
<a name="l00083"></a>00083 
<a name="l00084"></a>00084    nvd = <a class="code" href="classFiniteElementSpace.html#a76383f67555102ed45076a7a68c5ac3f">fec</a>-&gt;<a class="code" href="classFiniteElementCollection.html#abdf2413cbf2640a90f3af4a247e5dea3">DofForGeometry</a>(<a class="code" href="classGeometry.html#a242844653d28499f6eaeb3e60616b942a410b024c33dddc256cde201aa4a29309">Geometry::POINT</a>);
<a name="l00085"></a>00085    ned = <a class="code" href="classFiniteElementSpace.html#a76383f67555102ed45076a7a68c5ac3f">fec</a>-&gt;<a class="code" href="classFiniteElementCollection.html#abdf2413cbf2640a90f3af4a247e5dea3">DofForGeometry</a>(<a class="code" href="classGeometry.html#a242844653d28499f6eaeb3e60616b942aecc350b144d8875079df9d9b5edf3e71">Geometry::SEGMENT</a>);
<a name="l00086"></a>00086    nfd = (<a class="code" href="classFiniteElementSpace.html#ac881b1fbf560ee8ea3ebd055425259e3">fdofs</a>) ? (<a class="code" href="classFiniteElementSpace.html#ac881b1fbf560ee8ea3ebd055425259e3">fdofs</a>[1]-<a class="code" href="classFiniteElementSpace.html#ac881b1fbf560ee8ea3ebd055425259e3">fdofs</a>[0]) : (0);
<a name="l00087"></a>00087 
<a name="l00088"></a>00088    <span class="keywordflow">if</span> (ldof_sign)
<a name="l00089"></a>00089    {
<a name="l00090"></a>00090       ldof_sign-&gt;<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classFiniteElementSpace.html#ae293470899299c43e748d098e0a0e9f8" title="Returns number of degrees of freedom.">GetNDofs</a>());
<a name="l00091"></a>00091       *ldof_sign = 1;
<a name="l00092"></a>00092    }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094    <span class="comment">// count the number of ldofs in all groups (excluding the local group 0)</span>
<a name="l00095"></a>00095    group_ldof_counter = 0;
<a name="l00096"></a>00096    <span class="keywordflow">for</span> (gr = 1; gr &lt; ng; gr++)
<a name="l00097"></a>00097    {
<a name="l00098"></a>00098       group_ldof_counter += nvd * <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#ad4e58f8df50370fb220740b58a4b6f95">GroupNVertices</a>(gr);
<a name="l00099"></a>00099       group_ldof_counter += ned * <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#adad92bfeb3ed21f1f1d52df7e6f9025c">GroupNEdges</a>(gr);
<a name="l00100"></a>00100       group_ldof_counter += nfd * <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#a8a5bf7aecf0b65c3b0be36e37f7604d1">GroupNFaces</a>(gr);
<a name="l00101"></a>00101    }
<a name="l00102"></a>00102    <span class="keywordflow">if</span> (ldof_type)
<a name="l00103"></a>00103       group_ldof_counter *= <a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>;
<a name="l00104"></a>00104    <span class="comment">// allocate the I and J arrays in group_ldof</span>
<a name="l00105"></a>00105    group_ldof.<a class="code" href="classTable.html#acad273b1522ca032ae343c20a42db3d3">SetDims</a>(ng, group_ldof_counter);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107    <span class="comment">// build the full group_ldof table</span>
<a name="l00108"></a>00108    group_ldof_counter = 0;
<a name="l00109"></a>00109    group_ldof.<a class="code" href="classTable.html#af3cf9697d71afed14f9b2997f7a5ee84">GetI</a>()[0] = group_ldof.<a class="code" href="classTable.html#af3cf9697d71afed14f9b2997f7a5ee84">GetI</a>()[1] = 0;
<a name="l00110"></a>00110    <span class="keywordflow">for</span> (gr = 1; gr &lt; ng; gr++)
<a name="l00111"></a>00111    {
<a name="l00112"></a>00112       <span class="keywordtype">int</span> j, k, l, m, o, nv, ne, nf;
<a name="l00113"></a>00113       <span class="keyword">const</span> <span class="keywordtype">int</span> *ind;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115       nv = <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#ad4e58f8df50370fb220740b58a4b6f95">GroupNVertices</a>(gr);
<a name="l00116"></a>00116       ne = <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#adad92bfeb3ed21f1f1d52df7e6f9025c">GroupNEdges</a>(gr);
<a name="l00117"></a>00117       nf = <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#a8a5bf7aecf0b65c3b0be36e37f7604d1">GroupNFaces</a>(gr);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119       <span class="comment">// vertices</span>
<a name="l00120"></a>00120       <span class="keywordflow">if</span> (nvd &gt; 0)
<a name="l00121"></a>00121          <span class="keywordflow">for</span> (j = 0; j &lt; nv; j++)
<a name="l00122"></a>00122          {
<a name="l00123"></a>00123             k = <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#a94eb264912e3fcca9fdb16e6b0083096">GroupVertex</a>(gr, j);
<a name="l00124"></a>00124 
<a name="l00125"></a>00125             dofs.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nvd);
<a name="l00126"></a>00126             m = nvd * k;
<a name="l00127"></a>00127             <span class="keywordflow">for</span> (l = 0; l &lt; nvd; l++, m++)
<a name="l00128"></a>00128                dofs[l] = m;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130             <span class="keywordflow">if</span> (ldof_type)
<a name="l00131"></a>00131                <a class="code" href="classFiniteElementSpace.html#a63878019dbf570017682644afd699171">DofsToVDofs</a>(dofs);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133             <span class="keywordflow">for</span> (l = 0; l &lt; dofs.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); l++)
<a name="l00134"></a>00134                group_ldof.<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>()[group_ldof_counter++] = dofs[l];
<a name="l00135"></a>00135          }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137       <span class="comment">// edges</span>
<a name="l00138"></a>00138       <span class="keywordflow">if</span> (ned &gt; 0)
<a name="l00139"></a>00139          <span class="keywordflow">for</span> (j = 0; j &lt; ne; j++)
<a name="l00140"></a>00140          {
<a name="l00141"></a>00141             <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#a53add0cd48917b2d9bd5d2ef7ab3a48b">GroupEdge</a>(gr, j, k, o);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143             dofs.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(ned);
<a name="l00144"></a>00144             m = <a class="code" href="classFiniteElementSpace.html#acaf2f1d8782617ae3d8339f9f2605885">nvdofs</a>+k*ned;
<a name="l00145"></a>00145             ind = <a class="code" href="classFiniteElementSpace.html#a76383f67555102ed45076a7a68c5ac3f">fec</a>-&gt;<a class="code" href="classFiniteElementCollection.html#a67d56ef98ced102ee763257d64e1d414">DofOrderForOrientation</a>(<a class="code" href="classGeometry.html#a242844653d28499f6eaeb3e60616b942aecc350b144d8875079df9d9b5edf3e71">Geometry::SEGMENT</a>, o);
<a name="l00146"></a>00146             <span class="keywordflow">for</span> (l = 0; l &lt; ned; l++)
<a name="l00147"></a>00147                <span class="keywordflow">if</span> (ind[l] &lt; 0)
<a name="l00148"></a>00148                {
<a name="l00149"></a>00149                   dofs[l] = m + (-1-ind[l]);
<a name="l00150"></a>00150                   <span class="keywordflow">if</span> (ldof_sign)
<a name="l00151"></a>00151                      (*ldof_sign)[dofs[l]] = -1;
<a name="l00152"></a>00152                }
<a name="l00153"></a>00153                <span class="keywordflow">else</span>
<a name="l00154"></a>00154                   dofs[l] = m + ind[l];
<a name="l00155"></a>00155 
<a name="l00156"></a>00156             <span class="keywordflow">if</span> (ldof_type)
<a name="l00157"></a>00157                <a class="code" href="classFiniteElementSpace.html#a63878019dbf570017682644afd699171">DofsToVDofs</a>(dofs);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159             <span class="keywordflow">for</span> (l = 0; l &lt; dofs.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); l++)
<a name="l00160"></a>00160                group_ldof.<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>()[group_ldof_counter++] = dofs[l];
<a name="l00161"></a>00161          }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163       <span class="comment">// faces</span>
<a name="l00164"></a>00164       <span class="keywordflow">if</span> (nfd &gt; 0)
<a name="l00165"></a>00165          <span class="keywordflow">for</span> (j = 0; j &lt; nf; j++)
<a name="l00166"></a>00166          {
<a name="l00167"></a>00167             <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#a4f8b0965f4cfdf03a78e2366a169d1e0">GroupFace</a>(gr, j, k, o);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169             dofs.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nfd);
<a name="l00170"></a>00170             m = <a class="code" href="classFiniteElementSpace.html#acaf2f1d8782617ae3d8339f9f2605885">nvdofs</a>+<a class="code" href="classFiniteElementSpace.html#a9e1f9e016a3d4c6729281376730901ea">nedofs</a>+<a class="code" href="classFiniteElementSpace.html#ac881b1fbf560ee8ea3ebd055425259e3">fdofs</a>[k];
<a name="l00171"></a>00171             ind = <a class="code" href="classFiniteElementSpace.html#a76383f67555102ed45076a7a68c5ac3f">fec</a>-&gt;<a class="code" href="classFiniteElementCollection.html#a67d56ef98ced102ee763257d64e1d414">DofOrderForOrientation</a>(
<a name="l00172"></a>00172                <a class="code" href="classFiniteElementSpace.html#a7d135150d5b911e245dd6786ffb7a76b" title="The mesh that FE space lives on.">mesh</a>-&gt;<a class="code" href="classMesh.html#a559e9e66d389124f1066d2be965d8831">GetFaceBaseGeometry</a>(k), o);
<a name="l00173"></a>00173             <span class="keywordflow">for</span> (l = 0; l &lt; nfd; l++)
<a name="l00174"></a>00174                <span class="keywordflow">if</span> (ind[l] &lt; 0)
<a name="l00175"></a>00175                {
<a name="l00176"></a>00176                   dofs[l] = m + (-1-ind[l]);
<a name="l00177"></a>00177                   <span class="keywordflow">if</span> (ldof_sign)
<a name="l00178"></a>00178                      (*ldof_sign)[dofs[l]] = -1;
<a name="l00179"></a>00179                }
<a name="l00180"></a>00180                <span class="keywordflow">else</span>
<a name="l00181"></a>00181                   dofs[l] = m + ind[l];
<a name="l00182"></a>00182 
<a name="l00183"></a>00183             <span class="keywordflow">if</span> (ldof_type)
<a name="l00184"></a>00184                <a class="code" href="classFiniteElementSpace.html#a63878019dbf570017682644afd699171">DofsToVDofs</a>(dofs);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186             <span class="keywordflow">for</span> (l = 0; l &lt; dofs.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); l++)
<a name="l00187"></a>00187                group_ldof.<a class="code" href="classTable.html#a3dc46885dc380faf9aabc62e23a55ba8">GetJ</a>()[group_ldof_counter++] = dofs[l];
<a name="l00188"></a>00188          }
<a name="l00189"></a>00189 
<a name="l00190"></a>00190       group_ldof.<a class="code" href="classTable.html#af3cf9697d71afed14f9b2997f7a5ee84">GetI</a>()[gr+1] = group_ldof_counter;
<a name="l00191"></a>00191    }
<a name="l00192"></a>00192 
<a name="l00193"></a>00193    gc.<a class="code" href="classGroupCommunicator.html#a7c42e5002f165added964ac5b96fd6de" title="Allocate internal buffers after the GroupLDofTable is defined.">Finalize</a>();
<a name="l00194"></a>00194 }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#af7017413548b468bbff868957aaf0e32" title="Returns indexes of degrees of freedom in array dofs for i&#39;th element.">ParFiniteElementSpace::GetElementDofs</a>(<span class="keywordtype">int</span> i, <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00197"></a>00197 <span class="keyword"></span>{
<a name="l00198"></a>00198    <span class="keywordflow">if</span> (<a class="code" href="classFiniteElementSpace.html#a0203e19bd51e97aeda5f7f480bf5fa47">elem_dof</a>)
<a name="l00199"></a>00199    {
<a name="l00200"></a>00200       <a class="code" href="classFiniteElementSpace.html#a0203e19bd51e97aeda5f7f480bf5fa47">elem_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(i, dofs);
<a name="l00201"></a>00201       <span class="keywordflow">return</span>;
<a name="l00202"></a>00202    }
<a name="l00203"></a>00203    <a class="code" href="classParFiniteElementSpace.html#af7017413548b468bbff868957aaf0e32" title="Returns indexes of degrees of freedom in array dofs for i&#39;th element.">FiniteElementSpace::GetElementDofs</a>(i, dofs);
<a name="l00204"></a>00204    <span class="keywordflow">for</span> (i = 0; i &lt; dofs.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00205"></a>00205       <span class="keywordflow">if</span> (dofs[i] &lt; 0)
<a name="l00206"></a>00206       {
<a name="l00207"></a>00207          <span class="keywordflow">if</span> (ldof_sign[-1-dofs[i]] &lt; 0)
<a name="l00208"></a>00208             dofs[i] = -1-dofs[i];
<a name="l00209"></a>00209       }
<a name="l00210"></a>00210       <span class="keywordflow">else</span>
<a name="l00211"></a>00211       {
<a name="l00212"></a>00212          <span class="keywordflow">if</span> (ldof_sign[dofs[i]] &lt; 0)
<a name="l00213"></a>00213             dofs[i] = -1-dofs[i];
<a name="l00214"></a>00214       }
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#aad87d65382339cc2b6fa44085ae44a42" title="Returns indexes of degrees of freedom for i&#39;th boundary element.">ParFiniteElementSpace::GetBdrElementDofs</a>(<span class="keywordtype">int</span> i, <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;dofs)<span class="keyword"> const</span>
<a name="l00218"></a>00218 <span class="keyword"></span>{
<a name="l00219"></a>00219    <span class="keywordflow">if</span> (<a class="code" href="classFiniteElementSpace.html#a55158dcddeba424e46dda9518e7c5c50">bdrElem_dof</a>)
<a name="l00220"></a>00220    {
<a name="l00221"></a>00221       <a class="code" href="classFiniteElementSpace.html#a55158dcddeba424e46dda9518e7c5c50">bdrElem_dof</a>-&gt;<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(i, dofs);
<a name="l00222"></a>00222       <span class="keywordflow">return</span>;
<a name="l00223"></a>00223    }
<a name="l00224"></a>00224    <a class="code" href="classParFiniteElementSpace.html#aad87d65382339cc2b6fa44085ae44a42" title="Returns indexes of degrees of freedom for i&#39;th boundary element.">FiniteElementSpace::GetBdrElementDofs</a>(i, dofs);
<a name="l00225"></a>00225    <span class="keywordflow">for</span> (i = 0; i &lt; dofs.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00226"></a>00226       <span class="keywordflow">if</span> (dofs[i] &lt; 0)
<a name="l00227"></a>00227       {
<a name="l00228"></a>00228          <span class="keywordflow">if</span> (ldof_sign[-1-dofs[i]] &lt; 0)
<a name="l00229"></a>00229             dofs[i] = -1-dofs[i];
<a name="l00230"></a>00230       }
<a name="l00231"></a>00231       <span class="keywordflow">else</span>
<a name="l00232"></a>00232       {
<a name="l00233"></a>00233          <span class="keywordflow">if</span> (ldof_sign[dofs[i]] &lt; 0)
<a name="l00234"></a>00234             dofs[i] = -1-dofs[i];
<a name="l00235"></a>00235       }
<a name="l00236"></a>00236 }
<a name="l00237"></a>00237 
<a name="l00238"></a>00238 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#ab2fde2167ddae36c1943ada027639b7f" title="Construct dof_offsets and tdof_offsets using global communication.">ParFiniteElementSpace::GenerateGlobalOffsets</a>()
<a name="l00239"></a>00239 {
<a name="l00240"></a>00240    <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00241"></a>00241    {
<a name="l00242"></a>00242       <span class="keywordtype">int</span> ldof[2];
<a name="l00243"></a>00243 
<a name="l00244"></a>00244       ldof[0] = <a class="code" href="classFiniteElementSpace.html#aa2c0e931af3bfbb8bb31bc4907fd4771">GetVSize</a>();
<a name="l00245"></a>00245       ldof[1] = <a class="code" href="classParFiniteElementSpace.html#a3e1b91a7bc861cf5457f3635bc304941">TrueVSize</a>();
<a name="l00246"></a>00246 
<a name="l00247"></a>00247       <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(3);
<a name="l00248"></a>00248       <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(3);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250       MPI_Scan(&amp;ldof, &amp;<a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[0], 2, MPI_INT, MPI_SUM, <a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252       <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[1] = <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[1];
<a name="l00253"></a>00253       <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[0] = <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[1] - ldof[1];
<a name="l00254"></a>00254 
<a name="l00255"></a>00255       <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[1] = <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[0];
<a name="l00256"></a>00256       <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[0] = <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[1] - ldof[0];
<a name="l00257"></a>00257 
<a name="l00258"></a>00258       <span class="comment">// get the global sizes in (t)dof_offsets[2]</span>
<a name="l00259"></a>00259       <span class="keywordflow">if</span> (<a class="code" href="classParFiniteElementSpace.html#a54e3fbf715a2bce6aee288c4d897f31e">MyRank</a> == <a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>-1)
<a name="l00260"></a>00260       {
<a name="l00261"></a>00261          ldof[0] = <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[1];
<a name="l00262"></a>00262          ldof[1] = <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[1];
<a name="l00263"></a>00263       }
<a name="l00264"></a>00264 
<a name="l00265"></a>00265       MPI_Bcast(&amp;ldof, 2, MPI_INT, <a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>-1, <a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>);
<a name="l00266"></a>00266       <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[2] = ldof[0];
<a name="l00267"></a>00267       <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[2] = ldof[1];
<a name="l00268"></a>00268    }
<a name="l00269"></a>00269    <span class="keywordflow">else</span>
<a name="l00270"></a>00270    {
<a name="l00271"></a>00271       <span class="keywordtype">int</span> i;
<a name="l00272"></a>00272       <span class="keywordtype">int</span> ldof  = <a class="code" href="classFiniteElementSpace.html#aa2c0e931af3bfbb8bb31bc4907fd4771">GetVSize</a>();
<a name="l00273"></a>00273       <span class="keywordtype">int</span> ltdof = <a class="code" href="classParFiniteElementSpace.html#a3e1b91a7bc861cf5457f3635bc304941">TrueVSize</a>();
<a name="l00274"></a>00274 
<a name="l00275"></a>00275       <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a> (<a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>+1);
<a name="l00276"></a>00276       <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(<a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>+1);
<a name="l00277"></a>00277 
<a name="l00278"></a>00278       MPI_Allgather(&amp;ldof, 1, MPI_INT, &amp;<a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[1], 1, MPI_INT, <a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>);
<a name="l00279"></a>00279       MPI_Allgather(&amp;ltdof, 1, MPI_INT, &amp;<a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[1], 1, MPI_INT, <a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>);
<a name="l00280"></a>00280 
<a name="l00281"></a>00281       <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>[0] = <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[0] = 0;
<a name="l00282"></a>00282       <span class="keywordflow">for</span> (i = 1; i &lt; <a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>; i++)
<a name="l00283"></a>00283       {
<a name="l00284"></a>00284          <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a> [i+1] += <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a> [i];
<a name="l00285"></a>00285          <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[i+1] += <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[i];
<a name="l00286"></a>00286       }
<a name="l00287"></a>00287    }
<a name="l00288"></a>00288 }
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a> *<a class="code" href="classParFiniteElementSpace.html#aef050d1bb1c2239e4e31085e3a8d5b67" title="The true dof-to-dof interpolation matrix.">ParFiniteElementSpace::Dof_TrueDof_Matrix</a>() <span class="comment">// matrix P</span>
<a name="l00291"></a>00291 {
<a name="l00292"></a>00292    <span class="keywordtype">int</span>  i;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294    <span class="keywordflow">if</span> (<a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>)
<a name="l00295"></a>00295       <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297    <span class="keywordtype">int</span>  ldof = <a class="code" href="classFiniteElementSpace.html#aa2c0e931af3bfbb8bb31bc4907fd4771">GetVSize</a>();
<a name="l00298"></a>00298    <span class="keywordtype">int</span>  ltdof = <a class="code" href="classParFiniteElementSpace.html#a3e1b91a7bc861cf5457f3635bc304941">TrueVSize</a>();
<a name="l00299"></a>00299 
<a name="l00300"></a>00300    <a class="code" href="classGroupTopology.html">GroupTopology</a> &amp;gt = <a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>();
<a name="l00301"></a>00301 
<a name="l00302"></a>00302    <span class="keywordtype">int</span> *i_diag;
<a name="l00303"></a>00303    <span class="keywordtype">int</span> *j_diag;
<a name="l00304"></a>00304    <span class="keywordtype">int</span>  diag_counter;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306    <span class="keywordtype">int</span> *i_offd;
<a name="l00307"></a>00307    <span class="keywordtype">int</span> *j_offd;
<a name="l00308"></a>00308    <span class="keywordtype">int</span>  offd_counter;
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    <span class="keywordtype">int</span> *cmap;
<a name="l00311"></a>00311    <span class="keywordtype">int</span> *col_starts;
<a name="l00312"></a>00312    <span class="keywordtype">int</span> *row_starts;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314    col_starts = <a class="code" href="classParFiniteElementSpace.html#a0374b1b4bafc9184871e6f149564d3c1">GetTrueDofOffsets</a>();
<a name="l00315"></a>00315    row_starts = <a class="code" href="classParFiniteElementSpace.html#a803693dc975ace96da8d8daab926f514">GetDofOffsets</a>();
<a name="l00316"></a>00316 
<a name="l00317"></a>00317    i_diag = hypre_TAlloc(HYPRE_Int, ldof+1);
<a name="l00318"></a>00318    j_diag = hypre_TAlloc(HYPRE_Int, ltdof);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320    i_offd = hypre_TAlloc(HYPRE_Int, ldof+1);
<a name="l00321"></a>00321    j_offd = hypre_TAlloc(HYPRE_Int, ldof-ltdof);
<a name="l00322"></a>00322 
<a name="l00323"></a>00323    cmap   = hypre_TAlloc(HYPRE_Int, ldof-ltdof);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325    <a class="code" href="classArray.html">Array&lt;Pair&lt;int, int&gt;</a> &gt; cmap_j_offd(ldof-ltdof);
<a name="l00326"></a>00326 
<a name="l00327"></a>00327    <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00328"></a>00328    {
<a name="l00329"></a>00329       <span class="keywordtype">int</span> nsize = gt.<a class="code" href="classGroupTopology.html#a389e1c7b8759b24ef7ca9df137570810">GetNumNeighbors</a>()-1;
<a name="l00330"></a>00330       MPI_Request *requests = <span class="keyword">new</span> MPI_Request[2*nsize];
<a name="l00331"></a>00331       MPI_Status  *statuses = <span class="keyword">new</span> MPI_Status[2*nsize];
<a name="l00332"></a>00332       <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(nsize+1);
<a name="l00333"></a>00333       <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[0] = col_starts[0];
<a name="l00334"></a>00334 
<a name="l00335"></a>00335       <span class="keywordtype">int</span> request_counter = 0;
<a name="l00336"></a>00336       <span class="comment">// send and receive neighbors&#39; local tdof offsets</span>
<a name="l00337"></a>00337       <span class="keywordflow">for</span> (i = 1; i &lt;= nsize; i++)
<a name="l00338"></a>00338          MPI_Irecv(&amp;<a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[i], 1, MPI_INT, gt.<a class="code" href="classGroupTopology.html#a4c68a9f5dc8be3c1f688ef3877df1d27">GetNeighborRank</a>(i), 5365,
<a name="l00339"></a>00339                    <a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>, &amp;requests[request_counter++]);
<a name="l00340"></a>00340 
<a name="l00341"></a>00341       <span class="keywordflow">for</span> (i = 1; i &lt;= nsize; i++)
<a name="l00342"></a>00342          MPI_Isend(&amp;<a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[0], 1, MPI_INT, gt.<a class="code" href="classGroupTopology.html#a4c68a9f5dc8be3c1f688ef3877df1d27">GetNeighborRank</a>(i), 5365,
<a name="l00343"></a>00343                    <a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>, &amp;requests[request_counter++]);
<a name="l00344"></a>00344 
<a name="l00345"></a>00345       MPI_Waitall(request_counter, requests, statuses);
<a name="l00346"></a>00346 
<a name="l00347"></a>00347       <span class="keyword">delete</span> [] statuses;
<a name="l00348"></a>00348       <span class="keyword">delete</span> [] requests;
<a name="l00349"></a>00349    }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351    i_diag[0] = i_offd[0] = 0;
<a name="l00352"></a>00352    diag_counter = offd_counter = 0;
<a name="l00353"></a>00353    <span class="keywordflow">for</span> (i = 0; i &lt; ldof; i++)
<a name="l00354"></a>00354    {
<a name="l00355"></a>00355       <span class="keywordtype">int</span> proc = gt.<a class="code" href="classGroupTopology.html#a71fd0503cd9e551a1192882b87690fff">GetGroupMasterRank</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[i]);
<a name="l00356"></a>00356       <span class="keywordflow">if</span> (proc == <a class="code" href="classParFiniteElementSpace.html#a54e3fbf715a2bce6aee288c4d897f31e">MyRank</a>)
<a name="l00357"></a>00357       {
<a name="l00358"></a>00358          j_diag[diag_counter++] = <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i];
<a name="l00359"></a>00359       }
<a name="l00360"></a>00360       <span class="keywordflow">else</span>
<a name="l00361"></a>00361       {
<a name="l00362"></a>00362          <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00363"></a>00363             cmap_j_offd[offd_counter].one =
<a name="l00364"></a>00364                <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[gt.<a class="code" href="classGroupTopology.html#afe66b2bf045428812a4e0627b4895000">GetGroupMaster</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[i])] + <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i];
<a name="l00365"></a>00365          <span class="keywordflow">else</span>
<a name="l00366"></a>00366             cmap_j_offd[offd_counter].one = col_starts[proc] + ldof_ltdof[i];
<a name="l00367"></a>00367          cmap_j_offd[offd_counter].two = offd_counter;
<a name="l00368"></a>00368          offd_counter++;
<a name="l00369"></a>00369       }
<a name="l00370"></a>00370       i_diag[i+1] = diag_counter;
<a name="l00371"></a>00371       i_offd[i+1] = offd_counter;
<a name="l00372"></a>00372    }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374    <a class="code" href="sort__pairs_8cpp.html#ab4296aae31784b55ea1bd63ecf1c0587">SortPairs&lt;int, int&gt;</a>(cmap_j_offd, offd_counter);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376    <span class="keywordflow">for</span> (i = 0; i &lt; offd_counter; i++)
<a name="l00377"></a>00377    {
<a name="l00378"></a>00378       cmap[i] = cmap_j_offd[i].one;
<a name="l00379"></a>00379       j_offd[cmap_j_offd[i].two] = i;
<a name="l00380"></a>00380    }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382    <a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a> = <span class="keyword">new</span> <a class="code" href="classHypreParMatrix.html" title="Wrapper for hypre&#39;s ParCSR matrix class.">HypreParMatrix</a>(<a class="code" href="classParFiniteElementSpace.html#ad1f69f464b90b4f574cea282ceab8c41" title="MPI data.">MyComm</a>, <a class="code" href="classParFiniteElementSpace.html#a54e3fbf715a2bce6aee288c4d897f31e">MyRank</a>, <a class="code" href="classParFiniteElementSpace.html#aa59cdc23595cecc35f599db066fe778d">NRanks</a>, row_starts, col_starts,
<a name="l00383"></a>00383                           i_diag, j_diag, i_offd, j_offd, cmap, offd_counter);
<a name="l00384"></a>00384 
<a name="l00385"></a>00385    <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>;
<a name="l00386"></a>00386 }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#a848b6e7a2824c64d08ae6ae1b9e8fcc9" title="Scale a vector of true dofs.">ParFiniteElementSpace::DivideByGroupSize</a>(<span class="keywordtype">double</span> *vec)
<a name="l00389"></a>00389 {
<a name="l00390"></a>00390    <a class="code" href="classGroupTopology.html">GroupTopology</a> &amp;gt = <a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>();
<a name="l00391"></a>00391 
<a name="l00392"></a>00392    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>(); i++)
<a name="l00393"></a>00393       <span class="keywordflow">if</span> (gt.<a class="code" href="classGroupTopology.html#a82200280ff22c73cc63ed6aa2bee85be">IAmMaster</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[i])) <span class="comment">// we are the master</span>
<a name="l00394"></a>00394          vec[<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i]] /= gt.<a class="code" href="classGroupTopology.html#aa635dbc2ecf5b7da14a579a4eaa33c01">GetGroupSize</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[i]);
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <a class="code" href="classGroupCommunicator.html">GroupCommunicator</a> *<a class="code" href="classParFiniteElementSpace.html#ab0fbe709f2ef78cb6b29bd46936a291c" title="Return a new GroupCommunicator on Dofs.">ParFiniteElementSpace::ScalarGroupComm</a>()
<a name="l00398"></a>00398 {
<a name="l00399"></a>00399    <a class="code" href="classGroupCommunicator.html">GroupCommunicator</a> *gc = <span class="keyword">new</span> <a class="code" href="classGroupCommunicator.html">GroupCommunicator</a>(<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>());
<a name="l00400"></a>00400    <span class="keywordflow">if</span> (<a class="code" href="classFiniteElementSpace.html#ac74fbef7942b2840253155c2c38d3984">NURBSext</a>)
<a name="l00401"></a>00401       gc-&gt;<a class="code" href="classGroupCommunicator.html#aab9b69bc2f749bd07263d090fcd0ede6">Create</a>(<a class="code" href="classParFiniteElementSpace.html#ac04af439cb5b0d230b8115055f34d00f">pNURBSext</a>()-&gt;<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>);
<a name="l00402"></a>00402    <span class="keywordflow">else</span>
<a name="l00403"></a>00403       <a class="code" href="classParFiniteElementSpace.html#af0ef01b86c6dbe824849711500447048">GetGroupComm</a>(*gc, 0);
<a name="l00404"></a>00404    <span class="keywordflow">return</span> gc;
<a name="l00405"></a>00405 }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#a16af1e5b2ec0f643ba09cd722e4b87c1">ParFiniteElementSpace::Synchronize</a>(<a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;ldof_marker)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409    <span class="keywordflow">if</span> (ldof_marker.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() != <a class="code" href="classFiniteElementSpace.html#aa2c0e931af3bfbb8bb31bc4907fd4771">GetVSize</a>())
<a name="l00410"></a>00410       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;ParFiniteElementSpace::Synchronize&quot;</span>);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412    <span class="comment">// implement allreduce(|) as reduce(|) + broadcast</span>
<a name="l00413"></a>00413    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>-&gt;<a class="code" href="classGroupCommunicator.html#a6ecc47f3807275e0502a707c33125844">Reduce</a>(ldof_marker);
<a name="l00414"></a>00414    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>-&gt;<a class="code" href="classGroupCommunicator.html#ad82b66f66f4593f62558c2eef28c163f" title="Broadcast within each group where the master is the root.">Bcast</a>(ldof_marker);
<a name="l00415"></a>00415 }
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#a52ad4bd0e4e7302f8cc3702d9f16cd08" title="Determine the boundary degrees of freedom.">ParFiniteElementSpace::GetEssentialVDofs</a>(<a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;bdr_attr_is_ess,
<a name="l00418"></a>00418                                               <a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;ess_dofs)
<a name="l00419"></a>00419 {
<a name="l00420"></a>00420    <a class="code" href="classParFiniteElementSpace.html#a52ad4bd0e4e7302f8cc3702d9f16cd08" title="Determine the boundary degrees of freedom.">FiniteElementSpace::GetEssentialVDofs</a>(bdr_attr_is_ess, ess_dofs);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422    <span class="comment">// Make sure that processors without boundary elements mark</span>
<a name="l00423"></a>00423    <span class="comment">// their boundary dofs (if they have any).</span>
<a name="l00424"></a>00424    <a class="code" href="classParFiniteElementSpace.html#a16af1e5b2ec0f643ba09cd722e4b87c1">Synchronize</a>(ess_dofs);
<a name="l00425"></a>00425 }
<a name="l00426"></a>00426 
<a name="l00427"></a>00427 <span class="keywordtype">int</span> <a class="code" href="classParFiniteElementSpace.html#a48cd2c79673b97dbb62c1e39dcd17849">ParFiniteElementSpace::GetLocalTDofNumber</a>(<span class="keywordtype">int</span> ldof)
<a name="l00428"></a>00428 {
<a name="l00429"></a>00429    <span class="keywordflow">if</span> (<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().IAmMaster(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[ldof]))
<a name="l00430"></a>00430       <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[ldof];
<a name="l00431"></a>00431    <span class="keywordflow">else</span>
<a name="l00432"></a>00432       <span class="keywordflow">return</span> -1;
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="keywordtype">int</span> <a class="code" href="classParFiniteElementSpace.html#aa3554b373a52386d80f7e1a439abcd03" title="Returns the global tdof number of the given local degree of freedom.">ParFiniteElementSpace::GetGlobalTDofNumber</a>(<span class="keywordtype">int</span> ldof)
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437    <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00438"></a>00438    {
<a name="l00439"></a>00439       <span class="keywordflow">if</span> (!<a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>)
<a name="l00440"></a>00440          <a class="code" href="classParFiniteElementSpace.html#aef050d1bb1c2239e4e31085e3a8d5b67" title="The true dof-to-dof interpolation matrix.">Dof_TrueDof_Matrix</a>();
<a name="l00441"></a>00441       <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[ldof] +
<a name="l00442"></a>00442          <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().<a class="code" href="classGroupTopology.html#afe66b2bf045428812a4e0627b4895000">GetGroupMaster</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[ldof])];
<a name="l00443"></a>00443    }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445    <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[ldof] +
<a name="l00446"></a>00446       <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().<a class="code" href="classGroupTopology.html#a71fd0503cd9e551a1192882b87690fff">GetGroupMasterRank</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[ldof])];
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="keywordtype">int</span> <a class="code" href="classParFiniteElementSpace.html#a27ee259d3a0edf76d85bd2505d17d56b">ParFiniteElementSpace::GetGlobalScalarTDofNumber</a>(<span class="keywordtype">int</span> sldof)
<a name="l00450"></a>00450 {
<a name="l00451"></a>00451    <span class="keywordflow">if</span> (HYPRE_AssumedPartitionCheck())
<a name="l00452"></a>00452    {
<a name="l00453"></a>00453       <span class="keywordflow">if</span> (!<a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>)
<a name="l00454"></a>00454          <a class="code" href="classParFiniteElementSpace.html#aef050d1bb1c2239e4e31085e3a8d5b67" title="The true dof-to-dof interpolation matrix.">Dof_TrueDof_Matrix</a>();
<a name="l00455"></a>00455       <span class="keywordflow">if</span> (<a class="code" href="classFiniteElementSpace.html#ac957565b80aa77524c285e365f374ba8">ordering</a> == <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8a4c0f58e61480fb4ce67b96175571dd78">Ordering::byNODES</a>)
<a name="l00456"></a>00456          <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[sldof] +
<a name="l00457"></a>00457             <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().<a class="code" href="classGroupTopology.html#afe66b2bf045428812a4e0627b4895000">GetGroupMaster</a>(
<a name="l00458"></a>00458                <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[sldof])] / <a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>;
<a name="l00459"></a>00459       <span class="keywordflow">else</span>
<a name="l00460"></a>00460          <span class="keywordflow">return</span> (<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[sldof*<a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>] +
<a name="l00461"></a>00461                  <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>[<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().GetGroupMaster(
<a name="l00462"></a>00462                        <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[sldof*<a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>])]) / <a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>;
<a name="l00463"></a>00463    }
<a name="l00464"></a>00464 
<a name="l00465"></a>00465    <span class="keywordflow">if</span> (<a class="code" href="classFiniteElementSpace.html#ac957565b80aa77524c285e365f374ba8">ordering</a> == <a class="code" href="classOrdering.html#a400843ea597f458cc1a8b802fe83b4c8a4c0f58e61480fb4ce67b96175571dd78">Ordering::byNODES</a>)
<a name="l00466"></a>00466       <span class="keywordflow">return</span> <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[sldof] +
<a name="l00467"></a>00467          <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().<a class="code" href="classGroupTopology.html#a71fd0503cd9e551a1192882b87690fff">GetGroupMasterRank</a>(
<a name="l00468"></a>00468             <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[sldof])] / <a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>;
<a name="l00469"></a>00469    <span class="keywordflow">else</span>
<a name="l00470"></a>00470       <span class="keywordflow">return</span> (<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[sldof*<a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>] +
<a name="l00471"></a>00471               <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>[<a class="code" href="classParFiniteElementSpace.html#a773178e98199f63639b30e053710da7b">GetGroupTopo</a>().GetGroupMasterRank(
<a name="l00472"></a>00472                     <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[sldof*<a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>])]) / <a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a>;
<a name="l00473"></a>00473 }
<a name="l00474"></a>00474 
<a name="l00475"></a>00475 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#acef97b719388a6e16a85bd12472397ad">ParFiniteElementSpace::Lose_Dof_TrueDof_Matrix</a>()
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477    hypre_ParCSRMatrix *csrP = (hypre_ParCSRMatrix*)(*<a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>);
<a name="l00478"></a>00478    hypre_ParCSRMatrixOwnsRowStarts(csrP) = 1;
<a name="l00479"></a>00479    hypre_ParCSRMatrixOwnsColStarts(csrP) = 1;
<a name="l00480"></a>00480    <a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a> -&gt; StealData();
<a name="l00481"></a>00481    <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>.<a class="code" href="classArray.html#a6504668e4c714c312d80dd9c5e0437b1" title="NULL-ifies the data.">LoseData</a>();
<a name="l00482"></a>00482    <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>.<a class="code" href="classArray.html#a6504668e4c714c312d80dd9c5e0437b1" title="NULL-ifies the data.">LoseData</a>();
<a name="l00483"></a>00483 }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#a561823a1efc232af6371b16d2839951c" title="Construct ldof_group and ldof_ltdof.">ParFiniteElementSpace::ConstructTrueDofs</a>()
<a name="l00486"></a>00486 {
<a name="l00487"></a>00487    <span class="keywordtype">int</span> i, gr, n = <a class="code" href="classFiniteElementSpace.html#aa2c0e931af3bfbb8bb31bc4907fd4771">GetVSize</a>();
<a name="l00488"></a>00488    <a class="code" href="classGroupTopology.html">GroupTopology</a> &amp;gt = <a class="code" href="classParFiniteElementSpace.html#a96929a80465ebb93fbb2ef2cc4415665" title="Parallel mesh.">pmesh</a>-&gt;<a class="code" href="classParMesh.html#ae9b4e0ae48df51b3bf2b9bb6d8800e9b">gtopo</a>;
<a name="l00489"></a>00489    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a> = <span class="keyword">new</span> <a class="code" href="classGroupCommunicator.html">GroupCommunicator</a>(gt);
<a name="l00490"></a>00490    <a class="code" href="classTable.html">Table</a> &amp;group_ldof = <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>-&gt;<a class="code" href="classGroupCommunicator.html#a1b82cb58c0d0180fda64e9480a6b4f44">GroupLDofTable</a>();
<a name="l00491"></a>00491 
<a name="l00492"></a>00492    <a class="code" href="classParFiniteElementSpace.html#af0ef01b86c6dbe824849711500447048">GetGroupComm</a>(*<a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>, 1, &amp;ldof_sign);
<a name="l00493"></a>00493 
<a name="l00494"></a>00494    <span class="comment">// Define ldof_group and mark ldof_ltdof with</span>
<a name="l00495"></a>00495    <span class="comment">//   -1 for ldof that is ours</span>
<a name="l00496"></a>00496    <span class="comment">//   -2 for ldof that is in a group with another master</span>
<a name="l00497"></a>00497    <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(n);
<a name="l00498"></a>00498    <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(n);
<a name="l00499"></a>00499    <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a> = 0;
<a name="l00500"></a>00500    <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a> = -1;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502    <span class="keywordflow">for</span> (gr = 1; gr &lt; group_ldof.<a class="code" href="classTable.html#aebd928bf244520ae94bd2867044b1ae2" title="Returns the number of TYPE I elements.">Size</a>(); gr++)
<a name="l00503"></a>00503    {
<a name="l00504"></a>00504       <span class="keyword">const</span> <span class="keywordtype">int</span> *ldofs = group_ldof.<a class="code" href="classTable.html#afc7bf4d8b63073f7283268191fe5760e" title="Return row i in array row (the Table must be finalized)">GetRow</a>(gr);
<a name="l00505"></a>00505       <span class="keyword">const</span> <span class="keywordtype">int</span> nldofs = group_ldof.<a class="code" href="classTable.html#aa545ece6d05545a66cf42810e158c489">RowSize</a>(gr);
<a name="l00506"></a>00506       <span class="keywordflow">for</span> (i = 0; i &lt; nldofs; i++)
<a name="l00507"></a>00507          <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[ldofs[i]] = gr;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509       <span class="keywordflow">if</span> (!gt.<a class="code" href="classGroupTopology.html#a82200280ff22c73cc63ed6aa2bee85be">IAmMaster</a>(gr)) <span class="comment">// we are not the master</span>
<a name="l00510"></a>00510          <span class="keywordflow">for</span> (i = 0; i &lt; nldofs; i++)
<a name="l00511"></a>00511             <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[ldofs[i]] = -2;
<a name="l00512"></a>00512    }
<a name="l00513"></a>00513 
<a name="l00514"></a>00514    <span class="comment">// count ltdof_size</span>
<a name="l00515"></a>00515    <a class="code" href="classParFiniteElementSpace.html#a1257bfa2f8a5852a6f19891d9dec7e35" title="Number of true dofs in this processor (local true dofs).">ltdof_size</a> = 0;
<a name="l00516"></a>00516    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00517"></a>00517       <span class="keywordflow">if</span> (<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i] == -1)
<a name="l00518"></a>00518          <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i] = <a class="code" href="classParFiniteElementSpace.html#a1257bfa2f8a5852a6f19891d9dec7e35" title="Number of true dofs in this processor (local true dofs).">ltdof_size</a>++;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520    <span class="comment">// have the group masters broadcast their ltdofs to the rest of the group</span>
<a name="l00521"></a>00521    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>-&gt;<a class="code" href="classGroupCommunicator.html#ad82b66f66f4593f62558c2eef28c163f" title="Broadcast within each group where the master is the root.">Bcast</a>(<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>);
<a name="l00522"></a>00522 }
<a name="l00523"></a>00523 
<a name="l00524"></a>00524 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#a399e068fdd99b0e8e47edb78e18009a6">ParFiniteElementSpace::ConstructTrueNURBSDofs</a>()
<a name="l00525"></a>00525 {
<a name="l00526"></a>00526    <span class="keywordtype">int</span> n = <a class="code" href="classFiniteElementSpace.html#aa2c0e931af3bfbb8bb31bc4907fd4771">GetVSize</a>();
<a name="l00527"></a>00527    <a class="code" href="classGroupTopology.html">GroupTopology</a> &amp;gt = <a class="code" href="classParFiniteElementSpace.html#ac04af439cb5b0d230b8115055f34d00f">pNURBSext</a>()-&gt;gtopo;
<a name="l00528"></a>00528    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a> = <span class="keyword">new</span> <a class="code" href="classGroupCommunicator.html">GroupCommunicator</a>(gt);
<a name="l00529"></a>00529 
<a name="l00530"></a>00530    <span class="comment">// pNURBSext()-&gt;ldof_group is for scalar space!</span>
<a name="l00531"></a>00531    <span class="keywordflow">if</span> (<a class="code" href="classFiniteElementSpace.html#a789248de25a86b346066a7787b1cdf5f" title="Vector dimension (number of unknowns per degree of freedom).">vdim</a> == 1)
<a name="l00532"></a>00532    {
<a name="l00533"></a>00533       <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>.<a class="code" href="classArray.html#af667f4d6ec70d3150cd41e6d328ea4cf" title="Make this Array a reference to &#39;master&#39;.">MakeRef</a>(<a class="code" href="classParFiniteElementSpace.html#ac04af439cb5b0d230b8115055f34d00f">pNURBSext</a>()-&gt;<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>);
<a name="l00534"></a>00534    }
<a name="l00535"></a>00535    <span class="keywordflow">else</span>
<a name="l00536"></a>00536    {
<a name="l00537"></a>00537       <span class="keyword">const</span> <span class="keywordtype">int</span> *scalar_ldof_group = <a class="code" href="classParFiniteElementSpace.html#ac04af439cb5b0d230b8115055f34d00f">pNURBSext</a>()-&gt;ldof_group;
<a name="l00538"></a>00538       <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(n);
<a name="l00539"></a>00539       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l00540"></a>00540          <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[i] = scalar_ldof_group[<a class="code" href="classFiniteElementSpace.html#a6e1b08a8bf1e7f88748d254c19d06e6f">VDofToDof</a>(i)];
<a name="l00541"></a>00541    }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>-&gt;<a class="code" href="classGroupCommunicator.html#aab9b69bc2f749bd07263d090fcd0ede6">Create</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>);
<a name="l00544"></a>00544 
<a name="l00545"></a>00545    <span class="comment">// ldof_sign.SetSize(n);</span>
<a name="l00546"></a>00546    <span class="comment">// ldof_sign = 1;</span>
<a name="l00547"></a>00547    ldof_sign.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00548"></a>00548 
<a name="l00549"></a>00549    <a class="code" href="classParFiniteElementSpace.html#a1257bfa2f8a5852a6f19891d9dec7e35" title="Number of true dofs in this processor (local true dofs).">ltdof_size</a> = 0;
<a name="l00550"></a>00550    <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>.<a class="code" href="classArray.html#a471447bf48b64b0b7a08d15994fbbc97" title="Change logical size of the array, keep existing entries.">SetSize</a>(n);
<a name="l00551"></a>00551    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l00552"></a>00552    {
<a name="l00553"></a>00553       <span class="keywordflow">if</span> (gt.<a class="code" href="classGroupTopology.html#a82200280ff22c73cc63ed6aa2bee85be">IAmMaster</a>(<a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>[i]))
<a name="l00554"></a>00554       {
<a name="l00555"></a>00555          <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i] = <a class="code" href="classParFiniteElementSpace.html#a1257bfa2f8a5852a6f19891d9dec7e35" title="Number of true dofs in this processor (local true dofs).">ltdof_size</a>;
<a name="l00556"></a>00556          <a class="code" href="classParFiniteElementSpace.html#a1257bfa2f8a5852a6f19891d9dec7e35" title="Number of true dofs in this processor (local true dofs).">ltdof_size</a>++;
<a name="l00557"></a>00557       }
<a name="l00558"></a>00558       <span class="keywordflow">else</span>
<a name="l00559"></a>00559       {
<a name="l00560"></a>00560          <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>[i] = -2;
<a name="l00561"></a>00561       }
<a name="l00562"></a>00562    }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564    <span class="comment">// have the group masters broadcast their ltdofs to the rest of the group</span>
<a name="l00565"></a>00565    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>-&gt;<a class="code" href="classGroupCommunicator.html#ad82b66f66f4593f62558c2eef28c163f" title="Broadcast within each group where the master is the root.">Bcast</a>(<a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>);
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568 <span class="keywordtype">void</span> <a class="code" href="classParFiniteElementSpace.html#ab7350abe21d23d12fdc2b22151e28c6a">ParFiniteElementSpace::Update</a>()
<a name="l00569"></a>00569 {
<a name="l00570"></a>00570    <a class="code" href="classParFiniteElementSpace.html#ab7350abe21d23d12fdc2b22151e28c6a">FiniteElementSpace::Update</a>();
<a name="l00571"></a>00571 
<a name="l00572"></a>00572    <a class="code" href="classParFiniteElementSpace.html#a7c4c3989d08d2cc4f6f3b3474929e9b6" title="The group of each local dof.">ldof_group</a>.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00573"></a>00573    <a class="code" href="classParFiniteElementSpace.html#abda8fb81b1b4b6b09c0bedcb0f65c40a" title="For a local dof: the local true dof number in the master of its group.">ldof_ltdof</a>.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00574"></a>00574    <a class="code" href="classParFiniteElementSpace.html#af21e143b29a2c76f639b5018fa94bc5b" title="Offsets for the dofs in each processor in global numbering.">dof_offsets</a>.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00575"></a>00575    <a class="code" href="classParFiniteElementSpace.html#a00a9f7bb6b98f0dfa2b409912982e987" title="Offsets for the true dofs in each processor in global numbering.">tdof_offsets</a>.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00576"></a>00576    <a class="code" href="classParFiniteElementSpace.html#a9395611746fb372ab3aa70270666e3b4" title="Offsets for the true dofs in neighbor processor in global numbering.">tdof_nb_offsets</a>.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00577"></a>00577    ldof_sign.<a class="code" href="classArray.html#a8a5eccc7a3ea1df118176cc36daefd74" title="Delete whole array.">DeleteAll</a>();
<a name="l00578"></a>00578    <span class="keyword">delete</span> <a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a>;
<a name="l00579"></a>00579    <a class="code" href="classParFiniteElementSpace.html#adf39b4b8bf053fe0132b5b827259f40f" title="The matrix P (interpolation from true dof to dof).">P</a> = NULL;
<a name="l00580"></a>00580    <span class="keyword">delete</span> <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a>;
<a name="l00581"></a>00581    <a class="code" href="classParFiniteElementSpace.html#a0be76355314e82890e7146f4751215cd" title="GroupCommunicator on the local VDofs.">gcomm</a> = NULL;
<a name="l00582"></a>00582    <a class="code" href="classParFiniteElementSpace.html#a561823a1efc232af6371b16d2839951c" title="Construct ldof_group and ldof_ltdof.">ConstructTrueDofs</a>();
<a name="l00583"></a>00583    <a class="code" href="classParFiniteElementSpace.html#ab2fde2167ddae36c1943ada027639b7f" title="Construct dof_offsets and tdof_offsets using global communication.">GenerateGlobalOffsets</a>();
<a name="l00584"></a>00584 }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586 <a class="code" href="classFiniteElementSpace.html" title="Abstract finite element space.">FiniteElementSpace</a> *<a class="code" href="classParFiniteElementSpace.html#a52fd01ab630e470713411c138c5cf8de" title="Return a copy of the current FE space and update.">ParFiniteElementSpace::SaveUpdate</a>()
<a name="l00587"></a>00587 {
<a name="l00588"></a>00588    <a class="code" href="classParFiniteElementSpace.html" title="Abstract parallel finite element space.">ParFiniteElementSpace</a> *cpfes = <span class="keyword">new</span> <a class="code" href="classParFiniteElementSpace.html#a5970b102b70a22eed9153252a8a43e8d">ParFiniteElementSpace</a>(*<span class="keyword">this</span>);
<a name="l00589"></a>00589    <a class="code" href="classFiniteElementSpace.html#a909098cea60aa107399f735f712acb6d">Constructor</a>();
<a name="l00590"></a>00590    <a class="code" href="classParFiniteElementSpace.html#a561823a1efc232af6371b16d2839951c" title="Construct ldof_group and ldof_ltdof.">ConstructTrueDofs</a>();
<a name="l00591"></a>00591    <a class="code" href="classParFiniteElementSpace.html#ab2fde2167ddae36c1943ada027639b7f" title="Construct dof_offsets and tdof_offsets using global communication.">GenerateGlobalOffsets</a>();
<a name="l00592"></a>00592    <span class="keywordflow">return</span> cpfes;
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Nov 18 2011 12:16:45 for MFEM by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
