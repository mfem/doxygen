<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MFEM: densemat.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MFEM&#160;<span id="projectnumber">v2.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_22e7892454e350ae265aec98296a27f7.html">mfem</a>      </li>
      <li class="navelem"><a class="el" href="dir_a28d2400c06ca1f168b29dc351700a81.html">linalg</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">densemat.cpp</div>  </div>
</div>
<div class="contents">
<a href="densemat_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// Copyright (c) 2010, Lawrence Livermore National Security, LLC. Produced at</span>
<a name="l00002"></a>00002 <span class="comment">// the Lawrence Livermore National Laboratory. LLNL-CODE-443211. All Rights</span>
<a name="l00003"></a>00003 <span class="comment">// reserved. See file COPYRIGHT for details.</span>
<a name="l00004"></a>00004 <span class="comment">//</span>
<a name="l00005"></a>00005 <span class="comment">// This file is part of the MFEM library. For more information and source code</span>
<a name="l00006"></a>00006 <span class="comment">// availability see http://mfem.googlecode.com.</span>
<a name="l00007"></a>00007 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment">// MFEM is free software; you can redistribute it and/or modify it under the</span>
<a name="l00009"></a>00009 <span class="comment">// terms of the GNU Lesser General Public License (as published by the Free</span>
<a name="l00010"></a>00010 <span class="comment">// Software Foundation) version 2.1 dated February 1999.</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="comment">// Implementation of data types dense matrix, inverse dense matrix</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;iomanip&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="vector_8hpp.html">vector.hpp</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="matrix_8hpp.html">matrix.hpp</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="densemat_8hpp.html">densemat.hpp</a>&quot;</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="classDenseMatrix.html#a962f1cca43a07753de96c8b9e413db06">00026</a> <a class="code" href="classDenseMatrix.html#a962f1cca43a07753de96c8b9e413db06">DenseMatrix::DenseMatrix</a>() : <a class="code" href="classMatrix.html" title="Abstract data type matrix.">Matrix</a>(0)
<a name="l00027"></a>00027 {
<a name="l00028"></a>00028    <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = 0;
<a name="l00029"></a>00029    <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = NULL;
<a name="l00030"></a>00030 }
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="classDenseMatrix.html#a2d9a839e616135ed83f8cf9dd1af2bbb">00032</a> <a class="code" href="classDenseMatrix.html#a962f1cca43a07753de96c8b9e413db06">DenseMatrix::DenseMatrix</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;m) : <a class="code" href="classMatrix.html" title="Abstract data type matrix.">Matrix</a>(m.size)
<a name="l00033"></a>00033 {
<a name="l00034"></a>00034    <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = m.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l00035"></a>00035    <span class="keywordtype">int</span> hw = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> * <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l00036"></a>00036    <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[hw];
<a name="l00037"></a>00037    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hw; i++)
<a name="l00038"></a>00038       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = m.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i];
<a name="l00039"></a>00039 }
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classDenseMatrix.html#a6ee48e719709820552135d9cc942dd1b">00041</a> <a class="code" href="classDenseMatrix.html#a962f1cca43a07753de96c8b9e413db06">DenseMatrix::DenseMatrix</a>(<span class="keywordtype">int</span> s) : <a class="code" href="classMatrix.html" title="Abstract data type matrix.">Matrix</a>(s)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043    <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = s;
<a name="l00044"></a>00044 
<a name="l00045"></a>00045    <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[s*s];
<a name="l00046"></a>00046 
<a name="l00047"></a>00047    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s; i++)
<a name="l00048"></a>00048       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; s; j++)
<a name="l00049"></a>00049          (*<span class="keyword">this</span>)(i,j) = 0;
<a name="l00050"></a>00050 }
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="classDenseMatrix.html#a70e967b6e077cb2c4dda6f21f630ccd3">00052</a> <a class="code" href="classDenseMatrix.html#a962f1cca43a07753de96c8b9e413db06">DenseMatrix::DenseMatrix</a>(<span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n) : <a class="code" href="classMatrix.html" title="Abstract data type matrix.">Matrix</a>(n)
<a name="l00053"></a>00053 {
<a name="l00054"></a>00054    <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = m;
<a name="l00055"></a>00055 
<a name="l00056"></a>00056    <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[m*n];
<a name="l00057"></a>00057 
<a name="l00058"></a>00058    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; i++)
<a name="l00059"></a>00059       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)
<a name="l00060"></a>00060          (*<span class="keyword">this</span>)(i,j) = 0;
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classDenseMatrix.html#ad946363949af97b2b83d6bbe1daaae3b">00063</a> <a class="code" href="classDenseMatrix.html#a962f1cca43a07753de96c8b9e413db06">DenseMatrix::DenseMatrix</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;mat, <span class="keywordtype">char</span> ch) : <a class="code" href="classMatrix.html" title="Abstract data type matrix.">Matrix</a>(mat.height)
<a name="l00064"></a>00064 {
<a name="l00065"></a>00065    <span class="keywordflow">if</span> (ch == <span class="charliteral">&#39;t&#39;</span>)
<a name="l00066"></a>00066    {
<a name="l00067"></a>00067       <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = mat.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>*<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>];
<a name="l00070"></a>00070 
<a name="l00071"></a>00071       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l00072"></a>00072          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00073"></a>00073             (*<span class="keyword">this</span>)(i,j) = mat(j,i);
<a name="l00074"></a>00074    }
<a name="l00075"></a>00075 }
<a name="l00076"></a>00076 
<a name="l00077"></a><a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610">00077</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">DenseMatrix::SetSize</a>(<span class="keywordtype">int</span> s)
<a name="l00078"></a>00078 {
<a name="l00079"></a>00079    <span class="keywordflow">if</span> (<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() == s &amp;&amp; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == s)
<a name="l00080"></a>00080       <span class="keywordflow">return</span>;
<a name="l00081"></a>00081    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> != NULL)
<a name="l00082"></a>00082       <span class="keyword">delete</span> [] <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l00083"></a>00083    <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> = <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = s;
<a name="l00084"></a>00084    <span class="keywordflow">if</span> (s &gt; 0)
<a name="l00085"></a>00085    {
<a name="l00086"></a>00086       <span class="keywordtype">int</span> ss = s*s;
<a name="l00087"></a>00087       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[ss];
<a name="l00088"></a>00088       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ss; i++)
<a name="l00089"></a>00089          <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = 0.0;
<a name="l00090"></a>00090    }
<a name="l00091"></a>00091    <span class="keywordflow">else</span>
<a name="l00092"></a>00092       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = 0;
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00095"></a><a class="code" href="classDenseMatrix.html#a965ec7b33167b4505d8e5ce220ed67bc">00095</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">DenseMatrix::SetSize</a>(<span class="keywordtype">int</span> h, <span class="keywordtype">int</span> w)
<a name="l00096"></a>00096 {
<a name="l00097"></a>00097    <span class="keywordflow">if</span> (<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() == w &amp;&amp; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == h)
<a name="l00098"></a>00098       <span class="keywordflow">return</span>;
<a name="l00099"></a>00099    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> != NULL)
<a name="l00100"></a>00100       <span class="keyword">delete</span> [] <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l00101"></a>00101    <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> = w;
<a name="l00102"></a>00102    <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> = h;
<a name="l00103"></a>00103    <span class="keywordflow">if</span> (h &gt; 0 &amp;&amp; w &gt; 0)
<a name="l00104"></a>00104    {
<a name="l00105"></a>00105       <span class="keywordtype">int</span> hw = h*w;
<a name="l00106"></a>00106       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[hw];
<a name="l00107"></a>00107       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hw; i++)
<a name="l00108"></a>00108          <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = 0.0;
<a name="l00109"></a>00109    }
<a name="l00110"></a>00110    <span class="keywordflow">else</span>
<a name="l00111"></a>00111       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> = 0;
<a name="l00112"></a>00112 }
<a name="l00113"></a>00113 
<a name="l00114"></a><a class="code" href="classDenseMatrix.html#a036fdb032ac4b42ce8035aa124cab698">00114</a> <span class="keywordtype">double</span> &amp;<a class="code" href="classDenseMatrix.html#a036fdb032ac4b42ce8035aa124cab698" title="Returns reference to a_{ij}. Index i, j = 0 .. size-1.">DenseMatrix::Elem</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j)
<a name="l00115"></a>00115 {
<a name="l00116"></a>00116    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)(i,j);
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="classDenseMatrix.html#a2479596fe4e185d59163d09274a1d116">00119</a> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="classDenseMatrix.html#a036fdb032ac4b42ce8035aa124cab698" title="Returns reference to a_{ij}. Index i, j = 0 .. size-1.">DenseMatrix::Elem</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j)<span class="keyword"> const</span>
<a name="l00120"></a>00120 <span class="keyword"></span>{
<a name="l00121"></a>00121    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)(i,j);
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classDenseMatrix.html#a69919b10fa83b79bfd269a77dc1ceccb">00124</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">DenseMatrix::Mult</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *y)<span class="keyword"> const</span>
<a name="l00125"></a>00125 <span class="keyword"></span>{
<a name="l00126"></a>00126    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l00127"></a>00127    {
<a name="l00128"></a>00128       <span class="keywordtype">double</span> a = 0.;
<a name="l00129"></a>00129       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00130"></a>00130          a += (*<span class="keyword">this</span>)(i,j) * x[j];
<a name="l00131"></a>00131       y[i] = a;
<a name="l00132"></a>00132    }
<a name="l00133"></a>00133 }
<a name="l00134"></a>00134 
<a name="l00135"></a><a class="code" href="classDenseMatrix.html#ac3a43415a1174d0edf592392f568de97">00135</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">DenseMatrix::Mult</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;y)<span class="keyword"> const</span>
<a name="l00136"></a>00136 <span class="keyword"></span>{
<a name="l00137"></a>00137 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00138"></a>00138 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ( <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> != x.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() || <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> != y.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() )
<a name="l00139"></a>00139       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Mult&quot;</span>);
<a name="l00140"></a>00140 <span class="preprocessor">#endif</span>
<a name="l00141"></a>00141 <span class="preprocessor"></span>
<a name="l00142"></a>00142    <a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">Mult</a>((<span class="keyword">const</span> <span class="keywordtype">double</span> *)x, (<span class="keywordtype">double</span> *)y);
<a name="l00143"></a>00143 }
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="classDenseMatrix.html#aef17bbfb2f8d174221fa3c8fd5e45bd5">00145</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#aef17bbfb2f8d174221fa3c8fd5e45bd5" title="Matrix inner product: tr(A^t B)">DenseMatrix::operator *</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;m)<span class="keyword"> const</span>
<a name="l00146"></a>00146 <span class="keyword"></span>{
<a name="l00147"></a>00147 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00148"></a>00148 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != m.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() || <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != m.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>())
<a name="l00149"></a>00149       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::operator *(...)&quot;</span>);
<a name="l00150"></a>00150 <span class="preprocessor">#endif</span>
<a name="l00151"></a>00151 <span class="preprocessor"></span>
<a name="l00152"></a>00152    <span class="keywordtype">int</span> hw = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> * <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l00153"></a>00153    <span class="keywordtype">double</span> a = 0.0;
<a name="l00154"></a>00154    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hw; i++)
<a name="l00155"></a>00155       a += <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] * m.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i];
<a name="l00156"></a>00156 
<a name="l00157"></a>00157    <span class="keywordflow">return</span> a;
<a name="l00158"></a>00158 }
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="classDenseMatrix.html#af19199b8bc7bfc254e72732f0cb7c008">00160</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#af19199b8bc7bfc254e72732f0cb7c008" title="Multiply a vector with the transpose matrix.">DenseMatrix::MultTranspose</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;y)<span class="keyword"> const</span>
<a name="l00161"></a>00161 <span class="keyword"></span>{
<a name="l00162"></a>00162 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00163"></a>00163 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ( <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> != x.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() || <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> != y.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() )
<a name="l00164"></a>00164       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::MultTranspose&quot;</span>);
<a name="l00165"></a>00165 <span class="preprocessor">#endif</span>
<a name="l00166"></a>00166 <span class="preprocessor"></span>
<a name="l00167"></a>00167    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; i++)
<a name="l00168"></a>00168    {
<a name="l00169"></a>00169       <span class="keywordtype">double</span> d = 0.0;
<a name="l00170"></a>00170       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; j++)
<a name="l00171"></a>00171          d += (*<span class="keyword">this</span>)(j,i) * x(j);
<a name="l00172"></a>00172       y(i) = d;
<a name="l00173"></a>00173    }
<a name="l00174"></a>00174 }
<a name="l00175"></a>00175 
<a name="l00176"></a><a class="code" href="classDenseMatrix.html#ae89e2638dc1b276d21ff583b1f743d82">00176</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ae89e2638dc1b276d21ff583b1f743d82" title="y += A.x">DenseMatrix::AddMult</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;y)<span class="keyword"> const</span>
<a name="l00177"></a>00177 <span class="keyword"></span>{
<a name="l00178"></a>00178 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00179"></a>00179 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ( <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> != x.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() || <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> != y.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() )
<a name="l00180"></a>00180       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::AddMult&quot;</span>);
<a name="l00181"></a>00181 <span class="preprocessor">#endif</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span>
<a name="l00183"></a>00183    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l00184"></a>00184       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00185"></a>00185          y(i) += (*this)(i,j) * x(j);
<a name="l00186"></a>00186 }
<a name="l00187"></a>00187 
<a name="l00188"></a><a class="code" href="classDenseMatrix.html#a4c8ba579e74434cd8904501caceb0a14">00188</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#a4c8ba579e74434cd8904501caceb0a14" title="Compute y^t A x.">DenseMatrix::InnerProduct</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *x, <span class="keyword">const</span> <span class="keywordtype">double</span> *y)<span class="keyword"> const</span>
<a name="l00189"></a>00189 <span class="keyword"></span>{
<a name="l00190"></a>00190    <span class="keywordtype">double</span> prod = 0.0;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l00193"></a>00193    {
<a name="l00194"></a>00194       <span class="keywordtype">double</span> Axi = 0.0;
<a name="l00195"></a>00195       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00196"></a>00196          Axi += (*<span class="keyword">this</span>)(i,j) * x[j];
<a name="l00197"></a>00197       prod += y[i] * Axi;
<a name="l00198"></a>00198    }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200    <span class="keywordflow">return</span> prod;
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00203"></a><a class="code" href="classDenseMatrix.html#afe4b157ed431bfb0202aef15e592d0cf">00203</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#afe4b157ed431bfb0202aef15e592d0cf" title="Trace of a square matrix.">DenseMatrix::Trace</a>()<span class="keyword"> const</span>
<a name="l00204"></a>00204 <span class="keyword"></span>{
<a name="l00205"></a>00205 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00206"></a>00206 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l00207"></a>00207       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Trace() : not a square matrix!&quot;</span>);
<a name="l00208"></a>00208 <span class="preprocessor">#endif</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>
<a name="l00210"></a>00210    <span class="keywordtype">double</span> t = 0.0;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; i++)
<a name="l00213"></a>00213       t += (*<span class="keyword">this</span>)(i, i);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215    <span class="keywordflow">return</span> t;
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="classDenseMatrix.html#ae618148364920b2f36493766d61dcfb4">00218</a> <a class="code" href="classMatrixInverse.html" title="Abstract data type for matrix inverse.">MatrixInverse</a> *<a class="code" href="classDenseMatrix.html#ae618148364920b2f36493766d61dcfb4" title="Returns a pointer to the inverse matrix.">DenseMatrix::Inverse</a>()<span class="keyword"> const</span>
<a name="l00219"></a>00219 <span class="keyword"></span>{
<a name="l00220"></a>00220    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classDenseMatrix.html#a63af23bd04c8ba44868344162caddaf0">DenseMatrixInverse</a>(*<span class="keyword">this</span>);
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00223"></a><a class="code" href="classDenseMatrix.html#ac0f94a551ae3bc6d01ad6a39d323c31c">00223</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#ac0f94a551ae3bc6d01ad6a39d323c31c" title="Calculates the determinant of the matrix (for 2x2 or 3x3 matrices)">DenseMatrix::Det</a>()<span class="keyword"> const</span>
<a name="l00224"></a>00224 <span class="keyword"></span>{
<a name="l00225"></a>00225 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00226"></a>00226 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() || <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &lt; 1 || <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &gt; 3)
<a name="l00227"></a>00227       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Det&quot;</span>);
<a name="l00228"></a>00228 <span class="preprocessor">#endif</span>
<a name="l00229"></a>00229 <span class="preprocessor"></span>
<a name="l00230"></a>00230    <span class="keywordflow">switch</span> (<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l00231"></a>00231    {
<a name="l00232"></a>00232    <span class="keywordflow">case</span> 1:
<a name="l00233"></a>00233       <span class="keywordflow">return</span> <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[0];
<a name="l00234"></a>00234 
<a name="l00235"></a>00235    <span class="keywordflow">case</span> 2:
<a name="l00236"></a>00236       <span class="keywordflow">return</span> <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[0] * <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[3] - <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[1] * <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[2];
<a name="l00237"></a>00237 
<a name="l00238"></a>00238    <span class="keywordflow">case</span> 3:
<a name="l00239"></a>00239    {
<a name="l00240"></a>00240       <span class="keyword">const</span> <span class="keywordtype">double</span> *d = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l00241"></a>00241       <span class="keywordflow">return</span>
<a name="l00242"></a>00242          d[0] * (d[4] * d[8] - d[5] * d[7]) +
<a name="l00243"></a>00243          d[3] * (d[2] * d[7] - d[1] * d[8]) +
<a name="l00244"></a>00244          d[6] * (d[1] * d[5] - d[2] * d[4]);
<a name="l00245"></a>00245    }
<a name="l00246"></a>00246    }
<a name="l00247"></a>00247    <span class="keywordflow">return</span> 0.0;
<a name="l00248"></a>00248 }
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="classDenseMatrix.html#a7472bc9d0377db8aee25d05db28f1d3c">00250</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#a7472bc9d0377db8aee25d05db28f1d3c">DenseMatrix::Weight</a>()<span class="keyword"> const</span>
<a name="l00251"></a>00251 <span class="keyword"></span>{
<a name="l00252"></a>00252    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>())
<a name="l00253"></a>00253    {
<a name="l00254"></a>00254       <span class="comment">// return fabs(Det());</span>
<a name="l00255"></a>00255       <span class="keywordflow">return</span> <a class="code" href="classDenseMatrix.html#ac0f94a551ae3bc6d01ad6a39d323c31c" title="Calculates the determinant of the matrix (for 2x2 or 3x3 matrices)">Det</a>();
<a name="l00256"></a>00256    }
<a name="l00257"></a>00257    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == 2) &amp;&amp; (<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() == 1))
<a name="l00258"></a>00258    {
<a name="l00259"></a>00259       <span class="keywordflow">return</span> sqrt(<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[0] * <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[0] + <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[1] * <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[1]);
<a name="l00260"></a>00260    }
<a name="l00261"></a>00261    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == 3) &amp;&amp; (<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() == 2))
<a name="l00262"></a>00262    {
<a name="l00263"></a>00263       <span class="keyword">const</span> <span class="keywordtype">double</span> *d = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l00264"></a>00264       <span class="keywordtype">double</span> E = d[0] * d[0] + d[1] * d[1] + d[2] * d[2];
<a name="l00265"></a>00265       <span class="keywordtype">double</span> G = d[3] * d[3] + d[4] * d[4] + d[5] * d[5];
<a name="l00266"></a>00266       <span class="keywordtype">double</span> F = d[0] * d[3] + d[1] * d[4] + d[2] * d[5];
<a name="l00267"></a>00267       <span class="keywordflow">return</span> sqrt(E * G - F * F);
<a name="l00268"></a>00268    }
<a name="l00269"></a>00269    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Weight()&quot;</span>);
<a name="l00270"></a>00270    <span class="keywordflow">return</span> 0.0;
<a name="l00271"></a>00271 }
<a name="l00272"></a>00272 
<a name="l00273"></a><a class="code" href="classDenseMatrix.html#af49d8b366113658f878645e163cce152">00273</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#af49d8b366113658f878645e163cce152" title="Adds the matrix A multiplied by the number c to the matrix.">DenseMatrix::Add</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> c, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A)
<a name="l00274"></a>00274 {
<a name="l00275"></a>00275    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l00276"></a>00276       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l00277"></a>00277          (*<span class="keyword">this</span>)(i,j) += c * A(i,j);
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a><a class="code" href="classDenseMatrix.html#a3ec2857c4d328dcede25f6b6855ee24c">00280</a> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;<a class="code" href="classDenseMatrix.html#a3ec2857c4d328dcede25f6b6855ee24c" title="Sets the matrix elements equal to constant c.">DenseMatrix::operator=</a>(<span class="keywordtype">double</span> c)
<a name="l00281"></a>00281 {
<a name="l00282"></a>00282    <span class="keywordtype">int</span> s = <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>()*<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l00283"></a>00283    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> != NULL)
<a name="l00284"></a>00284       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s; i++)
<a name="l00285"></a>00285          <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = c;
<a name="l00286"></a>00286    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00287"></a>00287 }
<a name="l00288"></a>00288 
<a name="l00289"></a><a class="code" href="classDenseMatrix.html#a7ecb186d743ea631f35cb1b1f358d399">00289</a> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;<a class="code" href="classDenseMatrix.html#a3ec2857c4d328dcede25f6b6855ee24c" title="Sets the matrix elements equal to constant c.">DenseMatrix::operator=</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;m)
<a name="l00290"></a>00290 {
<a name="l00291"></a>00291    <span class="keywordtype">int</span> i, hw;
<a name="l00292"></a>00292 
<a name="l00293"></a>00293    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(m.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>, m.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295    hw = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> * <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l00296"></a>00296    <span class="keywordflow">for</span> (i = 0; i &lt; hw; i++)
<a name="l00297"></a>00297       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = m.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i];
<a name="l00298"></a>00298 
<a name="l00299"></a>00299    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00300"></a>00300 }
<a name="l00301"></a>00301 
<a name="l00302"></a><a class="code" href="classDenseMatrix.html#adeaa4b3d08394355ba33b8f3d2000501">00302</a> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;<a class="code" href="classDenseMatrix.html#adeaa4b3d08394355ba33b8f3d2000501">DenseMatrix::operator+=</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;m)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304    <span class="keywordtype">int</span> i, j;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l00307"></a>00307       <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00308"></a>00308          (*<span class="keyword">this</span>)(i, j) += m(i, j);
<a name="l00309"></a>00309 
<a name="l00310"></a>00310    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00311"></a>00311 }
<a name="l00312"></a>00312 
<a name="l00313"></a><a class="code" href="classDenseMatrix.html#acd6d482364ced3e104a596a8d48f1a4c">00313</a> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;<a class="code" href="classDenseMatrix.html#acd6d482364ced3e104a596a8d48f1a4c">DenseMatrix::operator-=</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;m)
<a name="l00314"></a>00314 {
<a name="l00315"></a>00315    <span class="keywordtype">int</span> i, j;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l00318"></a>00318       <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l00319"></a>00319          (*<span class="keyword">this</span>)(i, j) -= m(i, j);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00322"></a>00322 }
<a name="l00323"></a>00323 
<a name="l00324"></a><a class="code" href="classDenseMatrix.html#a6fb191509ac689bb692c4e20eed9165c">00324</a> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;<a class="code" href="classDenseMatrix.html#a6fb191509ac689bb692c4e20eed9165c">DenseMatrix::operator*=</a>(<span class="keywordtype">double</span> c)
<a name="l00325"></a>00325 {
<a name="l00326"></a>00326    <span class="keywordtype">int</span> s = <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>()*<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l00327"></a>00327    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> != NULL)
<a name="l00328"></a>00328       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; s; i++)
<a name="l00329"></a>00329          <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] *= c;
<a name="l00330"></a>00330    <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00331"></a>00331 }
<a name="l00332"></a>00332 
<a name="l00333"></a><a class="code" href="classDenseMatrix.html#a3b834d4aa18b444182035e8223deb986">00333</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a3b834d4aa18b444182035e8223deb986" title="(*this) = -(*this)">DenseMatrix::Neg</a>()
<a name="l00334"></a>00334 {
<a name="l00335"></a>00335    <span class="keywordtype">int</span> i, hw = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() * <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>();
<a name="l00336"></a>00336 
<a name="l00337"></a>00337    <span class="keywordflow">for</span> (i = 0; i &lt; hw; i++)
<a name="l00338"></a>00338       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = -<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i];
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00342"></a>00342 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l00343"></a>00343 dgetrf_(<span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *);
<a name="l00344"></a>00344 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l00345"></a>00345 dgetrs_(<span class="keywordtype">char</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *);
<a name="l00346"></a>00346 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l00347"></a>00347 dgetri_(<span class="keywordtype">int</span> *N, <span class="keywordtype">double</span> *A, <span class="keywordtype">int</span> *LDA, <span class="keywordtype">int</span> *IPIV, <span class="keywordtype">double</span> *WORK,
<a name="l00348"></a>00348         <span class="keywordtype">int</span> *LWORK, <span class="keywordtype">int</span> *INFO);
<a name="l00349"></a>00349 <span class="preprocessor">#endif</span>
<a name="l00350"></a>00350 <span class="preprocessor"></span>
<a name="l00351"></a><a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3">00351</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">DenseMatrix::Invert</a>()
<a name="l00352"></a>00352 {
<a name="l00353"></a>00353 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00354"></a>00354 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() &lt;= 0 || <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() != <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l00355"></a>00355       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Invert()&quot;</span>);
<a name="l00356"></a>00356 <span class="preprocessor">#endif</span>
<a name="l00357"></a>00357 <span class="preprocessor"></span>
<a name="l00358"></a>00358 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00359"></a>00359 <span class="preprocessor"></span>   <span class="keywordtype">int</span>   *ipiv = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>];
<a name="l00360"></a>00360    <span class="keywordtype">int</span>    lwork = -1;
<a name="l00361"></a>00361    <span class="keywordtype">double</span> qwork, *work;
<a name="l00362"></a>00362    <span class="keywordtype">int</span>    info;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364    dgetrf_(&amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, &amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>, &amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, ipiv, &amp;info);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366    <span class="keywordflow">if</span> (info)
<a name="l00367"></a>00367       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Invert() : Error in DGETRF&quot;</span>);
<a name="l00368"></a>00368 
<a name="l00369"></a>00369    dgetri_(&amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>, &amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, ipiv, &amp;qwork, &amp;lwork, &amp;info);
<a name="l00370"></a>00370 
<a name="l00371"></a>00371    lwork = (int) qwork;
<a name="l00372"></a>00372    work = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];
<a name="l00373"></a>00373 
<a name="l00374"></a>00374    dgetri_(&amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>, &amp;<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>, ipiv, work, &amp;lwork, &amp;info);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376    <span class="keywordflow">if</span> (info)
<a name="l00377"></a>00377       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Invert() : Error in DGETRI&quot;</span>);
<a name="l00378"></a>00378 
<a name="l00379"></a>00379    <span class="keyword">delete</span> [] work;
<a name="l00380"></a>00380    <span class="keyword">delete</span> [] ipiv;
<a name="l00381"></a>00381 <span class="preprocessor">#else</span>
<a name="l00382"></a>00382 <span class="preprocessor"></span>   <span class="keywordtype">int</span> c, i, j, n = <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>();
<a name="l00383"></a>00383    <span class="keywordtype">double</span> a, b;
<a name="l00384"></a>00384    <a class="code" href="classArray.html">Array&lt;int&gt;</a> piv(n);
<a name="l00385"></a>00385 
<a name="l00386"></a>00386    <span class="keywordflow">for</span> (c = 0; c &lt; n; c++)
<a name="l00387"></a>00387    {
<a name="l00388"></a>00388       a = fabs((*<span class="keyword">this</span>)(c, c));
<a name="l00389"></a>00389       i = c;
<a name="l00390"></a>00390       <span class="keywordflow">for</span> (j = c + 1; j &lt; n; j++)
<a name="l00391"></a>00391       {
<a name="l00392"></a>00392          b = fabs((*<span class="keyword">this</span>)(j, c));
<a name="l00393"></a>00393          <span class="keywordflow">if</span> (a &lt; b)
<a name="l00394"></a>00394          {
<a name="l00395"></a>00395             a = b;
<a name="l00396"></a>00396             i = j;
<a name="l00397"></a>00397          }
<a name="l00398"></a>00398       }
<a name="l00399"></a>00399       <span class="keywordflow">if</span> (a == 0.0)
<a name="l00400"></a>00400          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Invert() : singular matrix&quot;</span>);
<a name="l00401"></a>00401       piv[c] = i;
<a name="l00402"></a>00402       <span class="keywordflow">for</span> (j = 0; j &lt; n; j++)
<a name="l00403"></a>00403          Swap&lt;double&gt;((*<span class="keyword">this</span>)(c, j), (*<span class="keyword">this</span>)(i, j));
<a name="l00404"></a>00404 
<a name="l00405"></a>00405       a = (*this)(c, c) = 1.0 / (*<span class="keyword">this</span>)(c, c);
<a name="l00406"></a>00406       <span class="keywordflow">for</span> (j = 0; j &lt; c; j++)
<a name="l00407"></a>00407          (*<span class="keyword">this</span>)(c, j) *= a;
<a name="l00408"></a>00408       <span class="keywordflow">for</span> (j++; j &lt; n; j++)
<a name="l00409"></a>00409          (*<span class="keyword">this</span>)(c, j) *= a;
<a name="l00410"></a>00410       <span class="keywordflow">for</span> (i = 0; i &lt; c; i++)
<a name="l00411"></a>00411       {
<a name="l00412"></a>00412          (*this)(i, c) = a * (b = -(*<span class="keyword">this</span>)(i, c));
<a name="l00413"></a>00413          <span class="keywordflow">for</span> (j = 0; j &lt; c; j++)
<a name="l00414"></a>00414             (*<span class="keyword">this</span>)(i, j) += b * (*<span class="keyword">this</span>)(c, j);
<a name="l00415"></a>00415          <span class="keywordflow">for</span> (j++; j &lt; n; j++)
<a name="l00416"></a>00416             (*<span class="keyword">this</span>)(i, j) += b * (*<span class="keyword">this</span>)(c, j);
<a name="l00417"></a>00417       }
<a name="l00418"></a>00418       <span class="keywordflow">for</span> (i++; i &lt; n; i++)
<a name="l00419"></a>00419       {
<a name="l00420"></a>00420          (*this)(i, c) = a * (b = -(*<span class="keyword">this</span>)(i, c));
<a name="l00421"></a>00421          <span class="keywordflow">for</span> (j = 0; j &lt; c; j++)
<a name="l00422"></a>00422             (*<span class="keyword">this</span>)(i, j) += b * (*<span class="keyword">this</span>)(c, j);
<a name="l00423"></a>00423          <span class="keywordflow">for</span> (j++; j &lt; n; j++)
<a name="l00424"></a>00424             (*<span class="keyword">this</span>)(i, j) += b * (*<span class="keyword">this</span>)(c, j);
<a name="l00425"></a>00425       }
<a name="l00426"></a>00426    }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428    <span class="keywordflow">for</span> (c = n - 1; c &gt;= 0; c--)
<a name="l00429"></a>00429    {
<a name="l00430"></a>00430       j = piv[c];
<a name="l00431"></a>00431       <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l00432"></a>00432          Swap&lt;double&gt;((*<span class="keyword">this</span>)(i, c), (*<span class="keyword">this</span>)(i, j));
<a name="l00433"></a>00433    }
<a name="l00434"></a>00434 <span class="preprocessor">#endif</span>
<a name="l00435"></a>00435 <span class="preprocessor"></span>}
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="classDenseMatrix.html#aa13fb1313df14d7b6db59d3a13bec6c8">00437</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#aa13fb1313df14d7b6db59d3a13bec6c8" title="Take the 2-norm of the columns of A and store in v.">DenseMatrix::Norm2</a>(<span class="keywordtype">double</span> *v)<span class="keyword"> const</span>
<a name="l00438"></a>00438 <span class="keyword"></span>{
<a name="l00439"></a>00439    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l00440"></a>00440    {
<a name="l00441"></a>00441       v[j] = 0.0;
<a name="l00442"></a>00442       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l00443"></a>00443          v[j] += (*<span class="keyword">this</span>)(i,j)*(*<span class="keyword">this</span>)(i,j);
<a name="l00444"></a>00444       v[j] = sqrt(v[j]);
<a name="l00445"></a>00445    }
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00448"></a><a class="code" href="classDenseMatrix.html#ae77bd4a36c9ba5800654b3e3b78e6a09">00448</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#ae77bd4a36c9ba5800654b3e3b78e6a09">DenseMatrix::FNorm</a>()<span class="keyword"> const</span>
<a name="l00449"></a>00449 <span class="keyword"></span>{
<a name="l00450"></a>00450    <span class="keywordtype">int</span> i, hw = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() * <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>();
<a name="l00451"></a>00451    <span class="keywordtype">double</span> max_norm = 0.0, entry, fnorm2;
<a name="l00452"></a>00452 
<a name="l00453"></a>00453    <span class="keywordflow">for</span> (i = 0; i &lt; hw; i++)
<a name="l00454"></a>00454    {
<a name="l00455"></a>00455       entry = fabs(<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i]);
<a name="l00456"></a>00456       <span class="keywordflow">if</span> (entry &gt; max_norm)
<a name="l00457"></a>00457          max_norm = entry;
<a name="l00458"></a>00458    }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460    <span class="keywordflow">if</span> (max_norm == 0.0)
<a name="l00461"></a>00461       <span class="keywordflow">return</span> 0.0;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463    fnorm2 = 0.0;
<a name="l00464"></a>00464    <span class="keywordflow">for</span> (i = 0; i &lt; hw; i++)
<a name="l00465"></a>00465    {
<a name="l00466"></a>00466       entry = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] / max_norm;
<a name="l00467"></a>00467       fnorm2 += entry * entry;
<a name="l00468"></a>00468    }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470    <span class="keywordflow">return</span> max_norm * sqrt(fnorm2);
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00474"></a>00474 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l00475"></a>00475 dsyevr_(<span class="keywordtype">char</span> *JOBZ, <span class="keywordtype">char</span> *RANGE, <span class="keywordtype">char</span> *UPLO, <span class="keywordtype">int</span> *N, <span class="keywordtype">double</span> *A, <span class="keywordtype">int</span> *LDA,
<a name="l00476"></a>00476         <span class="keywordtype">double</span> *VL, <span class="keywordtype">double</span> *VU, <span class="keywordtype">int</span> *IL, <span class="keywordtype">int</span> *IU, <span class="keywordtype">double</span> *ABSTOL, <span class="keywordtype">int</span> *M,
<a name="l00477"></a>00477         <span class="keywordtype">double</span> *W, <span class="keywordtype">double</span> *Z, <span class="keywordtype">int</span> *LDZ, <span class="keywordtype">int</span> *ISUPPZ, <span class="keywordtype">double</span> *WORK, <span class="keywordtype">int</span> *LWORK,
<a name="l00478"></a>00478         <span class="keywordtype">int</span> *IWORK, <span class="keywordtype">int</span> *LIWORK, <span class="keywordtype">int</span> *INFO);
<a name="l00479"></a>00479 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l00480"></a>00480 dsyev_(<span class="keywordtype">char</span> *JOBZ, <span class="keywordtype">char</span> *UPLO, <span class="keywordtype">int</span> *N, <span class="keywordtype">double</span> *A, <span class="keywordtype">int</span> *LDA, <span class="keywordtype">double</span> *W,
<a name="l00481"></a>00481        <span class="keywordtype">double</span> *WORK, <span class="keywordtype">int</span> *LWORK, <span class="keywordtype">int</span> *INFO);
<a name="l00482"></a>00482 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l00483"></a>00483 dgesvd_(<span class="keywordtype">char</span> *JOBU, <span class="keywordtype">char</span> *JOBVT, <span class="keywordtype">int</span> *M, <span class="keywordtype">int</span> *N, <span class="keywordtype">double</span> *A, <span class="keywordtype">int</span> *LDA,
<a name="l00484"></a>00484         <span class="keywordtype">double</span> *S, <span class="keywordtype">double</span> *U, <span class="keywordtype">int</span> *LDU, <span class="keywordtype">double</span> *VT, <span class="keywordtype">int</span> *LDVT, <span class="keywordtype">double</span> *WORK,
<a name="l00485"></a>00485         <span class="keywordtype">int</span> *LWORK, <span class="keywordtype">int</span> *INFO);
<a name="l00486"></a>00486 <span class="preprocessor">#endif</span>
<a name="l00487"></a>00487 <span class="preprocessor"></span>
<a name="l00488"></a><a class="code" href="densemat_8cpp.html#a2b60a21e6c95bb0446b2aa521c7d06d0">00488</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a2b60a21e6c95bb0446b2aa521c7d06d0">dsyevr_Eigensystem</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;ev, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> *evect)
<a name="l00489"></a>00489 {
<a name="l00490"></a>00490 
<a name="l00491"></a>00491 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00492"></a>00492 <span class="preprocessor"></span>
<a name="l00493"></a>00493    ev.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>());
<a name="l00494"></a>00494 
<a name="l00495"></a>00495    <span class="keywordtype">char</span>      JOBZ     = <span class="charliteral">&#39;N&#39;</span>;
<a name="l00496"></a>00496    <span class="keywordtype">char</span>      RANGE    = <span class="charliteral">&#39;A&#39;</span>;
<a name="l00497"></a>00497    <span class="keywordtype">char</span>      UPLO     = <span class="charliteral">&#39;U&#39;</span>;
<a name="l00498"></a>00498    <span class="keywordtype">int</span>       N        = a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>();
<a name="l00499"></a>00499    <span class="keywordtype">double</span>   *A        = <span class="keyword">new</span> <span class="keywordtype">double</span>[N*N];
<a name="l00500"></a>00500    <span class="keywordtype">int</span>       LDA      = N;
<a name="l00501"></a>00501    <span class="keywordtype">double</span>    VL       = 0.0;
<a name="l00502"></a>00502    <span class="keywordtype">double</span>    VU       = 1.0;
<a name="l00503"></a>00503    <span class="keywordtype">int</span>       IL       = 0;
<a name="l00504"></a>00504    <span class="keywordtype">int</span>       IU       = 1;
<a name="l00505"></a>00505    <span class="keywordtype">double</span>    ABSTOL   = 0.0;
<a name="l00506"></a>00506    <span class="keywordtype">int</span>       M;
<a name="l00507"></a>00507    <span class="keywordtype">double</span>   *W        = ev.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>();
<a name="l00508"></a>00508    <span class="keywordtype">double</span>   *Z        = NULL;
<a name="l00509"></a>00509    <span class="keywordtype">int</span>       LDZ      = 1;
<a name="l00510"></a>00510    <span class="keywordtype">int</span>      *ISUPPZ   = <span class="keyword">new</span> <span class="keywordtype">int</span>[2*N];
<a name="l00511"></a>00511    <span class="keywordtype">int</span>       LWORK    = -1; <span class="comment">// query optimal (double) workspace size</span>
<a name="l00512"></a>00512    <span class="keywordtype">double</span>    QWORK;
<a name="l00513"></a>00513    <span class="keywordtype">double</span>   *WORK     = NULL;
<a name="l00514"></a>00514    <span class="keywordtype">int</span>       LIWORK   = -1; <span class="comment">// query optimal (int) workspace size</span>
<a name="l00515"></a>00515    <span class="keywordtype">int</span>       QIWORK;
<a name="l00516"></a>00516    <span class="keywordtype">int</span>      *IWORK    = NULL;
<a name="l00517"></a>00517    <span class="keywordtype">int</span>       INFO;
<a name="l00518"></a>00518 
<a name="l00519"></a>00519    <span class="keywordflow">if</span> (evect) <span class="comment">// Compute eigenvectors too</span>
<a name="l00520"></a>00520    {
<a name="l00521"></a>00521       evect-&gt;<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(N);
<a name="l00522"></a>00522 
<a name="l00523"></a>00523       JOBZ     = <span class="charliteral">&#39;V&#39;</span>;
<a name="l00524"></a>00524       Z        = evect-&gt;<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l00525"></a>00525       LDZ      = N;
<a name="l00526"></a>00526    }
<a name="l00527"></a>00527 
<a name="l00528"></a>00528    <span class="keywordtype">int</span> hw = a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() * a.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l00529"></a>00529    <span class="keywordtype">double</span> *data = a.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l00530"></a>00530 
<a name="l00531"></a>00531    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hw; i++)
<a name="l00532"></a>00532       A[i] = data[i];
<a name="l00533"></a>00533 
<a name="l00534"></a>00534    dsyevr_( &amp;JOBZ, &amp;RANGE, &amp;UPLO, &amp;N, A, &amp;LDA, &amp;VL, &amp;VU, &amp;IL, &amp;IU,
<a name="l00535"></a>00535             &amp;ABSTOL, &amp;M, W, Z, &amp;LDZ, ISUPPZ, &amp;QWORK, &amp;LWORK,
<a name="l00536"></a>00536             &amp;QIWORK, &amp;LIWORK, &amp;INFO );
<a name="l00537"></a>00537 
<a name="l00538"></a>00538    LWORK  = (int) QWORK;
<a name="l00539"></a>00539    LIWORK = QIWORK;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541    WORK  = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
<a name="l00542"></a>00542    IWORK = <span class="keyword">new</span> <span class="keywordtype">int</span>[LIWORK];
<a name="l00543"></a>00543 
<a name="l00544"></a>00544    dsyevr_( &amp;JOBZ, &amp;RANGE, &amp;UPLO, &amp;N, A, &amp;LDA, &amp;VL, &amp;VU, &amp;IL, &amp;IU,
<a name="l00545"></a>00545             &amp;ABSTOL, &amp;M, W, Z, &amp;LDZ, ISUPPZ, WORK, &amp;LWORK,
<a name="l00546"></a>00546             IWORK, &amp;LIWORK, &amp;INFO );
<a name="l00547"></a>00547 
<a name="l00548"></a>00548    <span class="keywordflow">if</span> (INFO != 0)
<a name="l00549"></a>00549    {
<a name="l00550"></a>00550       cerr &lt;&lt; <span class="stringliteral">&quot;dsyevr_Eigensystem(...): DSYEVR error code: &quot;</span>
<a name="l00551"></a>00551            &lt;&lt; INFO &lt;&lt; endl;
<a name="l00552"></a>00552       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00553"></a>00553    }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00556"></a>00556 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (M &lt; N)
<a name="l00557"></a>00557    {
<a name="l00558"></a>00558       cerr &lt;&lt; <span class="stringliteral">&quot;dsyevr_Eigensystem(...):\n&quot;</span>
<a name="l00559"></a>00559            &lt;&lt; <span class="stringliteral">&quot; DSYEVR did not find all eigenvalues &quot;</span>
<a name="l00560"></a>00560            &lt;&lt; M &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; N &lt;&lt; endl;
<a name="l00561"></a>00561       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00562"></a>00562    }
<a name="l00563"></a>00563    <span class="keywordflow">for</span> (IL = 0; IL &lt; N; IL++)
<a name="l00564"></a>00564       <span class="keywordflow">if</span> (!finite(W[IL]))
<a name="l00565"></a>00565          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;dsyevr_Eigensystem(...): !finite value in W&quot;</span>);
<a name="l00566"></a>00566    <span class="keywordflow">for</span> (IL = 0; IL &lt; N*N; IL++)
<a name="l00567"></a>00567       <span class="keywordflow">if</span> (!finite(Z[IL]))
<a name="l00568"></a>00568          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;dsyevr_Eigensystem(...): !finite value in Z&quot;</span>);
<a name="l00569"></a>00569    VU = 0.0;
<a name="l00570"></a>00570    <span class="keywordflow">for</span> (IL = 0; IL &lt; N; IL++)
<a name="l00571"></a>00571       <span class="keywordflow">for</span> (IU = 0; IU &lt;= IL; IU++)
<a name="l00572"></a>00572       {
<a name="l00573"></a>00573          VL = 0.0;
<a name="l00574"></a>00574          <span class="keywordflow">for</span> (M = 0; M &lt; N; M++)
<a name="l00575"></a>00575             VL += Z[M+IL*N] * Z[M+IU*N];
<a name="l00576"></a>00576          <span class="keywordflow">if</span> (IU &lt; IL)
<a name="l00577"></a>00577             VL = fabs(VL);
<a name="l00578"></a>00578          <span class="keywordflow">else</span>
<a name="l00579"></a>00579             VL = fabs(VL-1.0);
<a name="l00580"></a>00580          <span class="keywordflow">if</span> (VL &gt; VU)
<a name="l00581"></a>00581             VU = VL;
<a name="l00582"></a>00582          <span class="keywordflow">if</span> (VU &gt; 0.5)
<a name="l00583"></a>00583          {
<a name="l00584"></a>00584             cerr &lt;&lt; <span class="stringliteral">&quot;dsyevr_Eigensystem(...):&quot;</span>
<a name="l00585"></a>00585                  &lt;&lt; <span class="stringliteral">&quot; Z^t Z - I deviation = &quot;</span> &lt;&lt; VU
<a name="l00586"></a>00586                  &lt;&lt; <span class="stringliteral">&quot;\n W[max] = &quot;</span> &lt;&lt; W[N-1] &lt;&lt; <span class="stringliteral">&quot;, W[min] = &quot;</span>
<a name="l00587"></a>00587                  &lt;&lt; W[0] &lt;&lt; <span class="stringliteral">&quot;, N = &quot;</span> &lt;&lt; N &lt;&lt; endl;
<a name="l00588"></a>00588             <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00589"></a>00589          }
<a name="l00590"></a>00590       }
<a name="l00591"></a>00591    <span class="keywordflow">if</span> (VU &gt; 1e-9)
<a name="l00592"></a>00592    {
<a name="l00593"></a>00593       cerr &lt;&lt; <span class="stringliteral">&quot;dsyevr_Eigensystem(...):&quot;</span>
<a name="l00594"></a>00594            &lt;&lt; <span class="stringliteral">&quot; Z^t Z - I deviation = &quot;</span> &lt;&lt; VU
<a name="l00595"></a>00595            &lt;&lt; <span class="stringliteral">&quot;\n W[max] = &quot;</span> &lt;&lt; W[N-1] &lt;&lt; <span class="stringliteral">&quot;, W[min] = &quot;</span>
<a name="l00596"></a>00596            &lt;&lt; W[0] &lt;&lt; <span class="stringliteral">&quot;, N = &quot;</span> &lt;&lt; N &lt;&lt; endl;
<a name="l00597"></a>00597    }
<a name="l00598"></a>00598    <span class="keywordflow">if</span> (VU &gt; 1e-5)
<a name="l00599"></a>00599       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;dsyevr_Eigensystem(...): ERROR: ...&quot;</span>);
<a name="l00600"></a>00600    VU = 0.0;
<a name="l00601"></a>00601    <span class="keywordflow">for</span> (IL = 0; IL &lt; N; IL++)
<a name="l00602"></a>00602       <span class="keywordflow">for</span> (IU = 0; IU &lt; N; IU++)
<a name="l00603"></a>00603       {
<a name="l00604"></a>00604          VL = 0.0;
<a name="l00605"></a>00605          <span class="keywordflow">for</span> (M = 0; M &lt; N; M++)
<a name="l00606"></a>00606             VL += Z[IL+M*N] * W[M] * Z[IU+M*N];
<a name="l00607"></a>00607          VL = fabs(VL-data[IL+N*IU]);
<a name="l00608"></a>00608          <span class="keywordflow">if</span> (VL &gt; VU)
<a name="l00609"></a>00609             VU = VL;
<a name="l00610"></a>00610       }
<a name="l00611"></a>00611    <span class="keywordflow">if</span> (VU &gt; 1e-9)
<a name="l00612"></a>00612    {
<a name="l00613"></a>00613       cerr &lt;&lt; <span class="stringliteral">&quot;dsyevr_Eigensystem(...):&quot;</span>
<a name="l00614"></a>00614            &lt;&lt; <span class="stringliteral">&quot; max matrix deviation = &quot;</span> &lt;&lt; VU
<a name="l00615"></a>00615            &lt;&lt; <span class="stringliteral">&quot;\n W[max] = &quot;</span> &lt;&lt; W[N-1] &lt;&lt; <span class="stringliteral">&quot;, W[min] = &quot;</span>
<a name="l00616"></a>00616            &lt;&lt; W[0] &lt;&lt; <span class="stringliteral">&quot;, N = &quot;</span> &lt;&lt; N &lt;&lt; endl;
<a name="l00617"></a>00617    }
<a name="l00618"></a>00618    <span class="keywordflow">if</span> (VU &gt; 1e-5)
<a name="l00619"></a>00619       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;dsyevr_Eigensystem(...): ERROR: ...&quot;</span>);
<a name="l00620"></a>00620 <span class="preprocessor">#endif</span>
<a name="l00621"></a>00621 <span class="preprocessor"></span>
<a name="l00622"></a>00622    <span class="keyword">delete</span> [] IWORK;
<a name="l00623"></a>00623    <span class="keyword">delete</span> [] WORK;
<a name="l00624"></a>00624    <span class="keyword">delete</span> [] ISUPPZ;
<a name="l00625"></a>00625    <span class="keyword">delete</span> [] A;
<a name="l00626"></a>00626 
<a name="l00627"></a>00627 <span class="preprocessor">#endif</span>
<a name="l00628"></a>00628 <span class="preprocessor"></span>}
<a name="l00629"></a>00629 
<a name="l00630"></a><a class="code" href="densemat_8cpp.html#ae6b278df1dc84ce930e2b6a2c19eb397">00630</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#ae6b278df1dc84ce930e2b6a2c19eb397">dsyev_Eigensystem</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;ev, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> *evect)
<a name="l00631"></a>00631 {
<a name="l00632"></a>00632 
<a name="l00633"></a>00633 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00634"></a>00634 <span class="preprocessor"></span>
<a name="l00635"></a>00635    <span class="keywordtype">int</span>   N      = a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>();
<a name="l00636"></a>00636    <span class="keywordtype">char</span>  JOBZ   = <span class="charliteral">&#39;N&#39;</span>;
<a name="l00637"></a>00637    <span class="keywordtype">char</span>  UPLO   = <span class="charliteral">&#39;U&#39;</span>;
<a name="l00638"></a>00638    <span class="keywordtype">int</span>   LDA    = N;
<a name="l00639"></a>00639    <span class="keywordtype">int</span>   LWORK  = -1; <span class="comment">/* query optimal workspace size */</span>
<a name="l00640"></a>00640    <span class="keywordtype">int</span>   INFO;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642    ev.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(N);
<a name="l00643"></a>00643 
<a name="l00644"></a>00644    <span class="keywordtype">double</span> *A    = NULL;
<a name="l00645"></a>00645    <span class="keywordtype">double</span> *W    = ev.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>();
<a name="l00646"></a>00646    <span class="keywordtype">double</span> *WORK = NULL;
<a name="l00647"></a>00647    <span class="keywordtype">double</span>  QWORK;
<a name="l00648"></a>00648 
<a name="l00649"></a>00649    <span class="keywordflow">if</span> (evect)
<a name="l00650"></a>00650    {
<a name="l00651"></a>00651       JOBZ = <span class="charliteral">&#39;V&#39;</span>;
<a name="l00652"></a>00652       evect-&gt;<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(N);
<a name="l00653"></a>00653       A = evect-&gt;<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l00654"></a>00654    }
<a name="l00655"></a>00655    <span class="keywordflow">else</span>
<a name="l00656"></a>00656    {
<a name="l00657"></a>00657       A = <span class="keyword">new</span> <span class="keywordtype">double</span>[N*N];
<a name="l00658"></a>00658    }
<a name="l00659"></a>00659 
<a name="l00660"></a>00660    <span class="keywordtype">int</span> hw = a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() * a.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l00661"></a>00661    <span class="keywordtype">double</span> *data = a.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l00662"></a>00662    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; hw; i++)
<a name="l00663"></a>00663       A[i] = data[i];
<a name="l00664"></a>00664 
<a name="l00665"></a>00665    dsyev_(&amp;JOBZ, &amp;UPLO, &amp;N, A, &amp;LDA, W, &amp;QWORK, &amp;LWORK, &amp;INFO);
<a name="l00666"></a>00666 
<a name="l00667"></a>00667    LWORK = (int) QWORK;
<a name="l00668"></a>00668    WORK = <span class="keyword">new</span> <span class="keywordtype">double</span>[LWORK];
<a name="l00669"></a>00669 
<a name="l00670"></a>00670    dsyev_(&amp;JOBZ, &amp;UPLO, &amp;N, A, &amp;LDA, W, WORK, &amp;LWORK, &amp;INFO);
<a name="l00671"></a>00671 
<a name="l00672"></a>00672    <span class="keywordflow">if</span> (INFO != 0)
<a name="l00673"></a>00673    {
<a name="l00674"></a>00674       cerr &lt;&lt; <span class="stringliteral">&quot;dsyev_Eigensystem: DSYEV error code: &quot;</span> &lt;&lt; INFO &lt;&lt; endl;
<a name="l00675"></a>00675       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00676"></a>00676    }
<a name="l00677"></a>00677 
<a name="l00678"></a>00678    <span class="keyword">delete</span> [] WORK;
<a name="l00679"></a>00679    <span class="keywordflow">if</span> (evect == NULL)  <span class="keyword">delete</span> [] A;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 <span class="preprocessor">#endif</span>
<a name="l00682"></a>00682 <span class="preprocessor"></span>}
<a name="l00683"></a>00683 
<a name="l00684"></a><a class="code" href="classDenseMatrix.html#aba54d0abd058402307d2b0b072eef7ac">00684</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#aba54d0abd058402307d2b0b072eef7ac">DenseMatrix::Eigensystem</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;ev, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> *evect)
<a name="l00685"></a>00685 {
<a name="l00686"></a>00686 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00687"></a>00687 <span class="preprocessor"></span>
<a name="l00688"></a>00688    <span class="comment">// dsyevr_Eigensystem(*this, ev, evect);</span>
<a name="l00689"></a>00689 
<a name="l00690"></a>00690    <a class="code" href="densemat_8cpp.html#ae6b278df1dc84ce930e2b6a2c19eb397">dsyev_Eigensystem</a>(*<span class="keyword">this</span>, ev, evect);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692 <span class="preprocessor">#else</span>
<a name="l00693"></a>00693 <span class="preprocessor"></span>
<a name="l00694"></a>00694    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Eigensystem&quot;</span>);
<a name="l00695"></a>00695 
<a name="l00696"></a>00696 <span class="preprocessor">#endif</span>
<a name="l00697"></a>00697 <span class="preprocessor"></span>}
<a name="l00698"></a>00698 
<a name="l00699"></a><a class="code" href="classDenseMatrix.html#a2f7ef749eddbaa3fef50ba1f6713f05a">00699</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a2f7ef749eddbaa3fef50ba1f6713f05a">DenseMatrix::SingularValues</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;sv)<span class="keyword"> const</span>
<a name="l00700"></a>00700 <span class="keyword"></span>{
<a name="l00701"></a>00701 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> copy_of_this = *<span class="keyword">this</span>;
<a name="l00703"></a>00703    <span class="keywordtype">char</span>        jobu         = <span class="charliteral">&#39;N&#39;</span>;
<a name="l00704"></a>00704    <span class="keywordtype">char</span>        jobvt        = <span class="charliteral">&#39;N&#39;</span>;
<a name="l00705"></a>00705    <span class="keywordtype">int</span>         m            = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l00706"></a>00706    <span class="keywordtype">int</span>         n            = <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l00707"></a>00707    <span class="keywordtype">double</span>      *a           = copy_of_this.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l00708"></a>00708    sv.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(min(m, n));
<a name="l00709"></a>00709    <span class="keywordtype">double</span>      *s           = sv;
<a name="l00710"></a>00710    <span class="keywordtype">double</span>      *u           = NULL;
<a name="l00711"></a>00711    <span class="keywordtype">double</span>      *vt          = NULL;
<a name="l00712"></a>00712    <span class="keywordtype">double</span>      *work        = NULL;
<a name="l00713"></a>00713    <span class="keywordtype">int</span>         lwork        = -1;
<a name="l00714"></a>00714    <span class="keywordtype">int</span>         info;
<a name="l00715"></a>00715    <span class="keywordtype">double</span>      qwork;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717    dgesvd_(&amp;jobu, &amp;jobvt, &amp;m, &amp;n, a, &amp;m,
<a name="l00718"></a>00718            s, u, &amp;m, vt, &amp;n, &amp;qwork, &amp;lwork, &amp;info);
<a name="l00719"></a>00719 
<a name="l00720"></a>00720    lwork = (int) qwork;
<a name="l00721"></a>00721    work = <span class="keyword">new</span> <span class="keywordtype">double</span>[lwork];
<a name="l00722"></a>00722 
<a name="l00723"></a>00723    dgesvd_(&amp;jobu, &amp;jobvt, &amp;m, &amp;n, a, &amp;m,
<a name="l00724"></a>00724            s, u, &amp;m, vt, &amp;n, work, &amp;lwork, &amp;info);
<a name="l00725"></a>00725 
<a name="l00726"></a>00726    <span class="keyword">delete</span> [] work;
<a name="l00727"></a>00727    <span class="keywordflow">if</span> (info)
<a name="l00728"></a>00728    {
<a name="l00729"></a>00729       cerr &lt;&lt; <span class="stringliteral">&quot;DenseMatrix::SingularValues : info = &quot;</span> &lt;&lt; info &lt;&lt; endl;
<a name="l00730"></a>00730       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l00731"></a>00731    }
<a name="l00732"></a>00732 <span class="preprocessor">#else</span>
<a name="l00733"></a>00733 <span class="preprocessor"></span>   <span class="comment">// compiling without lapack</span>
<a name="l00734"></a>00734    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::SingularValues&quot;</span>);
<a name="l00735"></a>00735 <span class="preprocessor">#endif</span>
<a name="l00736"></a>00736 <span class="preprocessor"></span>}
<a name="l00737"></a>00737 
<a name="l00738"></a><a class="code" href="classDenseMatrix.html#ac2529e478e78de3e8b2f9565c1b19374">00738</a> <span class="keywordtype">double</span> <a class="code" href="classDenseMatrix.html#ac2529e478e78de3e8b2f9565c1b19374" title="Return the i-th singular value (decreasing order) of a 2x2 or 3x3 matrix.">DenseMatrix::CalcSingularvalue</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00739"></a>00739 <span class="keyword"></span>{
<a name="l00740"></a>00740 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l00741"></a>00741 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() || <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &lt; 2 || <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &gt; 3)
<a name="l00742"></a>00742       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::CalcSingularvalue&quot;</span>);
<a name="l00743"></a>00743 <span class="preprocessor">#endif</span>
<a name="l00744"></a>00744 <span class="preprocessor"></span>
<a name="l00745"></a>00745    <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l00746"></a>00746    <span class="keyword">const</span> <span class="keywordtype">double</span> *d = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748    <span class="keywordflow">if</span> (n == 2)
<a name="l00749"></a>00749    {
<a name="l00750"></a>00750 <span class="preprocessor">#if 0</span>
<a name="l00751"></a>00751 <span class="preprocessor"></span>      <span class="keywordtype">double</span> b11 = d[0]*d[0] + d[1]*d[1];
<a name="l00752"></a>00752       <span class="keywordtype">double</span> b12 = d[0]*d[2] + d[1]*d[3];
<a name="l00753"></a>00753       <span class="keywordtype">double</span> b22 = d[2]*d[2] + d[3]*d[3];
<a name="l00754"></a>00754 
<a name="l00755"></a>00755       <span class="keywordtype">double</span> tmp     = 0.5*(b11 - b22);
<a name="l00756"></a>00756       <span class="keywordtype">double</span> sqrtD_2 = sqrt(tmp*tmp + b12*b12);
<a name="l00757"></a>00757       <span class="keywordtype">double</span> mid     = 0.5*(b11 + b22);
<a name="l00758"></a>00758       <span class="keywordflow">if</span> (i == 0)
<a name="l00759"></a>00759          <span class="keywordflow">return</span> sqrt(mid + sqrtD_2);
<a name="l00760"></a>00760       <span class="keywordflow">if</span> ((mid -= sqrtD_2) &lt;= 0.0)
<a name="l00761"></a>00761          <span class="keywordflow">return</span> 0.0;
<a name="l00762"></a>00762       <span class="keywordflow">return</span> sqrt(mid);
<a name="l00763"></a>00763 <span class="preprocessor">#else</span>
<a name="l00764"></a>00764 <span class="preprocessor"></span>      <span class="keyword">register</span> <span class="keywordtype">double</span> d0, d1, d2, d3;
<a name="l00765"></a>00765       d0 = d[0];
<a name="l00766"></a>00766       d1 = d[1];
<a name="l00767"></a>00767       d2 = d[2];
<a name="l00768"></a>00768       d3 = d[3];
<a name="l00769"></a>00769       <span class="comment">// double b11 = d[0]*d[0] + d[1]*d[1];</span>
<a name="l00770"></a>00770       <span class="comment">// double b12 = d[0]*d[2] + d[1]*d[3];</span>
<a name="l00771"></a>00771       <span class="comment">// double b22 = d[2]*d[2] + d[3]*d[3];</span>
<a name="l00772"></a>00772       <span class="comment">// t = 0.5*(a+b).(a-b) = 0.5*(|a|^2-|b|^2)</span>
<a name="l00773"></a>00773       <span class="comment">// with a,b - the columns of (*this)</span>
<a name="l00774"></a>00774       <span class="comment">// double t = 0.5*(b11 - b22);</span>
<a name="l00775"></a>00775       <span class="keywordtype">double</span> t = 0.5*((d0+d2)*(d0-d2)+(d1-d3)*(d1+d3));
<a name="l00776"></a>00776       <span class="comment">// double s = sqrt(0.5*(b11 + b22) + sqrt(t*t + b12*b12));</span>
<a name="l00777"></a>00777       <span class="keywordtype">double</span> s = d0*d2 + d1*d3;
<a name="l00778"></a>00778       s = sqrt(0.5*(d0*d0 + d1*d1 + d2*d2 + d3*d3) + sqrt(t*t + s*s));
<a name="l00779"></a>00779       <span class="keywordflow">if</span> (s == 0.0)
<a name="l00780"></a>00780          <span class="keywordflow">return</span> 0.0;
<a name="l00781"></a>00781       t = fabs(d0*d3 - d1*d2) / s;
<a name="l00782"></a>00782 <span class="comment">// #ifdef MFEM_DEBUG</span>
<a name="l00783"></a>00783       <span class="keywordflow">if</span> (t &gt; s)
<a name="l00784"></a>00784       {
<a name="l00785"></a>00785          <span class="keywordflow">if</span> (i == 0)
<a name="l00786"></a>00786             <span class="keywordflow">return</span> t;
<a name="l00787"></a>00787          <span class="keywordflow">return</span> s;
<a name="l00788"></a>00788          <span class="comment">// mfem_error(&quot;DenseMatrix::CalcSingularvalue : 2x2&quot;);</span>
<a name="l00789"></a>00789       }
<a name="l00790"></a>00790 <span class="comment">// #endif</span>
<a name="l00791"></a>00791       <span class="keywordflow">if</span> (i == 0)
<a name="l00792"></a>00792          <span class="keywordflow">return</span> s;
<a name="l00793"></a>00793       <span class="keywordflow">return</span> t;
<a name="l00794"></a>00794 <span class="preprocessor">#endif</span>
<a name="l00795"></a>00795 <span class="preprocessor"></span>   }
<a name="l00796"></a>00796    <span class="keywordflow">else</span>
<a name="l00797"></a>00797    {
<a name="l00798"></a>00798       <span class="keywordtype">double</span> b11 = d[0]*d[0] + d[1]*d[1] + d[2]*d[2];
<a name="l00799"></a>00799       <span class="keywordtype">double</span> b12 = d[0]*d[3] + d[1]*d[4] + d[2]*d[5];
<a name="l00800"></a>00800       <span class="keywordtype">double</span> b13 = d[0]*d[6] + d[1]*d[7] + d[2]*d[8];
<a name="l00801"></a>00801       <span class="keywordtype">double</span> b22 = d[3]*d[3] + d[4]*d[4] + d[5]*d[5];
<a name="l00802"></a>00802       <span class="keywordtype">double</span> b23 = d[3]*d[6] + d[4]*d[7] + d[5]*d[8];
<a name="l00803"></a>00803       <span class="keywordtype">double</span> b33 = d[6]*d[6] + d[7]*d[7] + d[8]*d[8];
<a name="l00804"></a>00804 
<a name="l00805"></a>00805       <span class="comment">// double a, b, c;</span>
<a name="l00806"></a>00806       <span class="comment">// a = -(b11 + b22 + b33);</span>
<a name="l00807"></a>00807       <span class="comment">// b = b11*(b22 + b33) + b22*b33 - b12*b12 - b13*b13 - b23*b23;</span>
<a name="l00808"></a>00808       <span class="comment">// c = b11*(b23*b23 - b22*b33) + b12*(b12*b33 - 2*b13*b23) + b13*b13*b22;</span>
<a name="l00809"></a>00809 
<a name="l00810"></a>00810       <span class="comment">// double Q = (a * a - 3 * b) / 9;</span>
<a name="l00811"></a>00811       <span class="comment">// double Q = (b12*b12 + b13*b13 + b23*b23 +</span>
<a name="l00812"></a>00812       <span class="comment">//             ((b11 - b22)*(b11 - b22) +</span>
<a name="l00813"></a>00813       <span class="comment">//              (b11 - b33)*(b11 - b33) +</span>
<a name="l00814"></a>00814       <span class="comment">//              (b22 - b33)*(b22 - b33))/6)/3;</span>
<a name="l00815"></a>00815       <span class="comment">// Q = (3*(b12^2 + b13^2 + b23^2) +</span>
<a name="l00816"></a>00816       <span class="comment">//      ((b11 - b22)^2 + (b11 - b33)^2 + (b22 - b33)^2)/2)/9</span>
<a name="l00817"></a>00817       <span class="comment">//   or</span>
<a name="l00818"></a>00818       <span class="comment">// Q = (1/6)*|B-tr(B)/3|_F^2</span>
<a name="l00819"></a>00819       <span class="comment">// Q &gt;= 0 and</span>
<a name="l00820"></a>00820       <span class="comment">// Q = 0  &lt;==&gt; B = scalar * I</span>
<a name="l00821"></a>00821       <span class="comment">// double R = (2 * a * a * a - 9 * a * b + 27 * c) / 54;</span>
<a name="l00822"></a>00822       <span class="keywordtype">double</span> aa = (b11 + b22 + b33)/3;  <span class="comment">// aa = tr(B)/3</span>
<a name="l00823"></a>00823       <span class="keywordtype">double</span> c1, c2, c3;
<a name="l00824"></a>00824       <span class="comment">// c1 = b11 - aa; // ((b11 - b22) + (b11 - b33))/3</span>
<a name="l00825"></a>00825       <span class="comment">// c2 = b22 - aa; // ((b22 - b11) + (b22 - b33))/3</span>
<a name="l00826"></a>00826       <span class="comment">// c3 = b33 - aa; // ((b33 - b11) + (b33 - b22))/3</span>
<a name="l00827"></a>00827       {
<a name="l00828"></a>00828          <span class="keywordtype">double</span> b11_b22 = ((d[0]-d[3])*(d[0]+d[3])+
<a name="l00829"></a>00829                            (d[1]-d[4])*(d[1]+d[4])+
<a name="l00830"></a>00830                            (d[2]-d[5])*(d[2]+d[5]));
<a name="l00831"></a>00831          <span class="keywordtype">double</span> b22_b33 = ((d[3]-d[6])*(d[3]+d[6])+
<a name="l00832"></a>00832                            (d[4]-d[7])*(d[4]+d[7])+
<a name="l00833"></a>00833                            (d[5]-d[8])*(d[5]+d[8]));
<a name="l00834"></a>00834          <span class="keywordtype">double</span> b33_b11 = ((d[6]-d[0])*(d[6]+d[0])+
<a name="l00835"></a>00835                            (d[7]-d[1])*(d[7]+d[1])+
<a name="l00836"></a>00836                            (d[8]-d[2])*(d[8]+d[2]));
<a name="l00837"></a>00837          c1 = (b11_b22 - b33_b11)/3;
<a name="l00838"></a>00838          c2 = (b22_b33 - b11_b22)/3;
<a name="l00839"></a>00839          c3 = (b33_b11 - b22_b33)/3;
<a name="l00840"></a>00840       }
<a name="l00841"></a>00841       <span class="keywordtype">double</span> Q = (2*(b12*b12 + b13*b13 + b23*b23) +
<a name="l00842"></a>00842                   c1*c1 + c2*c2 + c3*c3)/6;
<a name="l00843"></a>00843       <span class="keywordtype">double</span> R = (c1*(b23*b23 - c2*c3)+ b12*(b12*c3 - 2*b13*b23) +
<a name="l00844"></a>00844                   b13*b13*c2)/2;
<a name="l00845"></a>00845       <span class="comment">// R = (-1/2)*det(B-(tr(B)/3)*I)</span>
<a name="l00846"></a>00846       <span class="comment">// Note: 54*(det(S))^2 &lt;= |S|_F^6, when S^t=S and tr(S)=0, S is 3x3</span>
<a name="l00847"></a>00847       <span class="comment">// Therefore: R^2 &lt;= Q^3</span>
<a name="l00848"></a>00848 
<a name="l00849"></a>00849       <span class="keywordflow">if</span> (Q &lt;= 0.)
<a name="l00850"></a>00850       {
<a name="l00851"></a>00851          ;
<a name="l00852"></a>00852       }
<a name="l00853"></a>00853 
<a name="l00854"></a>00854       <span class="comment">// else if (fabs(R) &gt;= sqrtQ3)</span>
<a name="l00855"></a>00855       <span class="comment">// {</span>
<a name="l00856"></a>00856       <span class="comment">//    double det = (d[0] * (d[4] * d[8] - d[5] * d[7]) +</span>
<a name="l00857"></a>00857       <span class="comment">//                  d[3] * (d[2] * d[7] - d[1] * d[8]) +</span>
<a name="l00858"></a>00858       <span class="comment">//                  d[6] * (d[1] * d[5] - d[2] * d[4]));</span>
<a name="l00859"></a>00859       <span class="comment">//</span>
<a name="l00860"></a>00860       <span class="comment">//    if (R &gt; 0.)</span>
<a name="l00861"></a>00861       <span class="comment">//    {</span>
<a name="l00862"></a>00862       <span class="comment">//       if (i == 2)</span>
<a name="l00863"></a>00863       <span class="comment">//          // aa -= 2*sqrtQ;</span>
<a name="l00864"></a>00864       <span class="comment">//          return fabs(det)/(aa + sqrtQ);</span>
<a name="l00865"></a>00865       <span class="comment">//       else</span>
<a name="l00866"></a>00866       <span class="comment">//          aa += sqrtQ;</span>
<a name="l00867"></a>00867       <span class="comment">//    }</span>
<a name="l00868"></a>00868       <span class="comment">//    else</span>
<a name="l00869"></a>00869       <span class="comment">//    {</span>
<a name="l00870"></a>00870       <span class="comment">//       if (i != 0)</span>
<a name="l00871"></a>00871       <span class="comment">//          aa -= sqrtQ;</span>
<a name="l00872"></a>00872       <span class="comment">//          // aa = fabs(det)/sqrt(aa + 2*sqrtQ);</span>
<a name="l00873"></a>00873       <span class="comment">//       else</span>
<a name="l00874"></a>00874       <span class="comment">//          aa += 2*sqrtQ;</span>
<a name="l00875"></a>00875       <span class="comment">//    }</span>
<a name="l00876"></a>00876       <span class="comment">// }</span>
<a name="l00877"></a>00877 
<a name="l00878"></a>00878       <span class="keywordflow">else</span>
<a name="l00879"></a>00879       {
<a name="l00880"></a>00880          <span class="keywordtype">double</span> sqrtQ = sqrt(Q);
<a name="l00881"></a>00881          <span class="keywordtype">double</span> sqrtQ3 = Q*sqrtQ;
<a name="l00882"></a>00882          <span class="comment">// double sqrtQ3 = sqrtQ*sqrtQ*sqrtQ;</span>
<a name="l00883"></a>00883          <span class="comment">// double sqrtQ3 = pow(Q, 1.5);</span>
<a name="l00884"></a>00884          <span class="keywordtype">double</span> r;
<a name="l00885"></a>00885 
<a name="l00886"></a>00886          <span class="keywordflow">if</span> (fabs(R) &gt;= sqrtQ3)
<a name="l00887"></a>00887          {
<a name="l00888"></a>00888             <span class="keywordflow">if</span> (R &lt; 0.)
<a name="l00889"></a>00889             {
<a name="l00890"></a>00890                R = -1.;
<a name="l00891"></a>00891                r = 2*sqrtQ;
<a name="l00892"></a>00892             }
<a name="l00893"></a>00893             <span class="keywordflow">else</span>
<a name="l00894"></a>00894             {
<a name="l00895"></a>00895                R = 1.;
<a name="l00896"></a>00896                r = -2*sqrtQ;
<a name="l00897"></a>00897             }
<a name="l00898"></a>00898          }
<a name="l00899"></a>00899          <span class="keywordflow">else</span>
<a name="l00900"></a>00900          {
<a name="l00901"></a>00901             R = R/sqrtQ3;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903             <span class="comment">// if (fabs(R) &lt;= 0.95)</span>
<a name="l00904"></a>00904             <span class="keywordflow">if</span> (fabs(R) &lt;= 0.9)
<a name="l00905"></a>00905             {
<a name="l00906"></a>00906                <span class="keywordflow">if</span> (i == 2)
<a name="l00907"></a>00907                   aa -= 2*sqrtQ*cos(acos(R)/3); <span class="comment">// min</span>
<a name="l00908"></a>00908                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0)
<a name="l00909"></a>00909                   aa -= 2*sqrtQ*cos((acos(R) + 2.0*M_PI)/3); <span class="comment">// max</span>
<a name="l00910"></a>00910                <span class="keywordflow">else</span>
<a name="l00911"></a>00911                   aa -= 2*sqrtQ*cos((acos(R) - 2.0*M_PI)/3); <span class="comment">// mid</span>
<a name="l00912"></a>00912                <span class="keywordflow">goto</span> have_aa;
<a name="l00913"></a>00913             }
<a name="l00914"></a>00914 
<a name="l00915"></a>00915             <span class="keywordflow">if</span> (R &lt; 0.)
<a name="l00916"></a>00916             {
<a name="l00917"></a>00917                r = -2*sqrtQ*cos((acos(R) + 2.0*M_PI)/3); <span class="comment">// max</span>
<a name="l00918"></a>00918                <span class="keywordflow">if</span> (i == 0)
<a name="l00919"></a>00919                {
<a name="l00920"></a>00920                   aa += r;
<a name="l00921"></a>00921                   <span class="keywordflow">goto</span> have_aa;
<a name="l00922"></a>00922                }
<a name="l00923"></a>00923             }
<a name="l00924"></a>00924             <span class="keywordflow">else</span>
<a name="l00925"></a>00925             {
<a name="l00926"></a>00926                r = -2*sqrtQ*cos(acos(R)/3); <span class="comment">// min</span>
<a name="l00927"></a>00927                <span class="keywordflow">if</span> (i == 2)
<a name="l00928"></a>00928                {
<a name="l00929"></a>00929                   aa += r;
<a name="l00930"></a>00930                   <span class="keywordflow">goto</span> have_aa;
<a name="l00931"></a>00931                }
<a name="l00932"></a>00932             }
<a name="l00933"></a>00933          }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935          <span class="comment">// (tr(B)/3 + r) is the root which is separated from the other</span>
<a name="l00936"></a>00936          <span class="comment">// two roots which are close to each other when |R| is close to 1</span>
<a name="l00937"></a>00937 
<a name="l00938"></a>00938          c1 -= r;
<a name="l00939"></a>00939          c2 -= r;
<a name="l00940"></a>00940          c3 -= r;
<a name="l00941"></a>00941 
<a name="l00942"></a>00942          <span class="comment">// QR factorization of</span>
<a name="l00943"></a>00943          <span class="comment">//   c1  b12  b13</span>
<a name="l00944"></a>00944          <span class="comment">//  b12   c2  b23</span>
<a name="l00945"></a>00945          <span class="comment">//  b13  b23   c3</span>
<a name="l00946"></a>00946          <span class="comment">// to find an eigenvector (z1,z2,z3) for [tr(B)/3 + r]</span>
<a name="l00947"></a>00947          <span class="keywordtype">double</span> z1, z2, z3;
<a name="l00948"></a>00948          <span class="keywordtype">double</span> sigma = b12*b12 + b13*b13;
<a name="l00949"></a>00949          <span class="keywordtype">double</span> mu, gamma, u1;
<a name="l00950"></a>00950          <span class="keywordtype">double</span> c12, c13, c23, c32, w1, w2, w3;
<a name="l00951"></a>00951          <span class="keywordflow">if</span> (sigma == 0.)
<a name="l00952"></a>00952          {
<a name="l00953"></a>00953             z1 = 1.;
<a name="l00954"></a>00954             z2 = z3 = 0.;
<a name="l00955"></a>00955          }
<a name="l00956"></a>00956          <span class="keywordflow">else</span>
<a name="l00957"></a>00957          {
<a name="l00958"></a>00958             mu = copysign(sqrt(c1*c1 + sigma), c1);
<a name="l00959"></a>00959             u1 = -sigma/(c1 + mu); <span class="comment">// = c1 - mu</span>
<a name="l00960"></a>00960             gamma = 2./(sigma + u1*u1);
<a name="l00961"></a>00961             <span class="comment">// u = (u1, b12, b13),  gamma = 2/(u^t u)</span>
<a name="l00962"></a>00962             <span class="comment">// Q = I - 2/(u^t u) u u^t,  Q (c1, b12, b13) = mu e_1</span>
<a name="l00963"></a>00963             c1 = mu;
<a name="l00964"></a>00964             w2  = gamma*(b12*(u1 + c2) + b23*b13);
<a name="l00965"></a>00965             w3  = gamma*(b13*(u1 + c3) + b23*b12);
<a name="l00966"></a>00966             c12 = b12 - u1 *w2;
<a name="l00967"></a>00967             c2  = c2  - b12*w2;
<a name="l00968"></a>00968             c32 = b23 - b13*w2;
<a name="l00969"></a>00969             c13 = b13 - u1 *w3;
<a name="l00970"></a>00970             c23 = b23 - b12*w3;
<a name="l00971"></a>00971             c3  = c3  - b13*w3;
<a name="l00972"></a>00972 
<a name="l00973"></a>00973             sigma = c32*c32;
<a name="l00974"></a>00974             <span class="keywordflow">if</span> (sigma == 0.)
<a name="l00975"></a>00975             {
<a name="l00976"></a>00976                ;
<a name="l00977"></a>00977             }
<a name="l00978"></a>00978             <span class="keywordflow">else</span>
<a name="l00979"></a>00979             {
<a name="l00980"></a>00980                mu = copysign(sqrt(c2*c2 + sigma), c2);
<a name="l00981"></a>00981                u1 = -sigma/(c2 + mu); <span class="comment">// = c2 - mu</span>
<a name="l00982"></a>00982                gamma = 2./(sigma + u1*u1);
<a name="l00983"></a>00983                <span class="comment">// u = (0, u1, c32),  gamma = 2/(u^t u)</span>
<a name="l00984"></a>00984                <span class="comment">// Q = I - 2/(u^t u) u u^t,  Q (c12, c2, c32) = (c12, mu, 0)</span>
<a name="l00985"></a>00985                c2 = mu;
<a name="l00986"></a>00986                w3 = gamma*(u1*c23 + c32*c3);
<a name="l00987"></a>00987                c23 = c23 - u1 *w3;
<a name="l00988"></a>00988                c3  = c3  - c32*w3;
<a name="l00989"></a>00989             }
<a name="l00990"></a>00990             <span class="comment">//     solve:</span>
<a name="l00991"></a>00991             <span class="comment">// | c1 c12 c13 | | z1 |   | 0 |</span>
<a name="l00992"></a>00992             <span class="comment">// | 0   c2 c23 | | z2 | = | 0 |</span>
<a name="l00993"></a>00993             <span class="comment">// | 0   0   c3 | | z3 |   | 0 |</span>
<a name="l00994"></a>00994             <span class="comment">//  either c2 or c3 must be 0</span>
<a name="l00995"></a>00995             <span class="keywordflow">if</span> (fabs(c3) &lt; fabs(c2))
<a name="l00996"></a>00996             {
<a name="l00997"></a>00997                <span class="comment">// c3 ~ 0?  --&gt;  set z3 = 1</span>
<a name="l00998"></a>00998                <span class="comment">//           c2*z2 + c23 = 0  ==&gt;  z2 = -c23/c2</span>
<a name="l00999"></a>00999                <span class="comment">//  c1*z1 + c12*z2 + c13 = 0  ==&gt;  z1 = (-c13 - c12*z2)/c1</span>
<a name="l01000"></a>01000                z3 = 1.;
<a name="l01001"></a>01001                z2 = -c23/c2;
<a name="l01002"></a>01002                z1 = -(c13 + c12*z2)/c1;
<a name="l01003"></a>01003             }
<a name="l01004"></a>01004             <span class="keywordflow">else</span>
<a name="l01005"></a>01005             {
<a name="l01006"></a>01006                <span class="comment">// c2 ~ 0?</span>
<a name="l01007"></a>01007                z3 = 0.;
<a name="l01008"></a>01008                z2 = 1.;
<a name="l01009"></a>01009                z1 = -c12/c1;
<a name="l01010"></a>01010             }
<a name="l01011"></a>01011          }
<a name="l01012"></a>01012 
<a name="l01013"></a>01013          <span class="comment">// using the eigenvector z=(z1,z2,z3) transform B into</span>
<a name="l01014"></a>01014          <span class="comment">//         | *   0   0 |</span>
<a name="l01015"></a>01015          <span class="comment">// Q B Q = | 0  c2 c23 |</span>
<a name="l01016"></a>01016          <span class="comment">//         | 0 c23  c3 |</span>
<a name="l01017"></a>01017          sigma = z2*z2 + z3*z3;
<a name="l01018"></a>01018          <span class="keywordflow">if</span> (sigma == 0.)
<a name="l01019"></a>01019          {
<a name="l01020"></a>01020             c2  = b22;
<a name="l01021"></a>01021             c23 = b23;
<a name="l01022"></a>01022             c3  = b33;
<a name="l01023"></a>01023          }
<a name="l01024"></a>01024          <span class="keywordflow">else</span>
<a name="l01025"></a>01025          {
<a name="l01026"></a>01026             mu = copysign(sqrt(z1*z1 + sigma), z1);
<a name="l01027"></a>01027             u1 = -sigma/(z1 + mu); <span class="comment">// = z1 - mu</span>
<a name="l01028"></a>01028             gamma = 2./(sigma + u1*u1);
<a name="l01029"></a>01029             <span class="comment">// u = (u1, z2, z3),  gamma = 2/(u^t u)</span>
<a name="l01030"></a>01030             <span class="comment">// Q = I - 2/(u^t u) u u^t,  Q (z1, z2, z3) = mu e_1</span>
<a name="l01031"></a>01031             <span class="comment">// Compute Q B Q</span>
<a name="l01032"></a>01032             <span class="comment">// w = gamma*B u</span>
<a name="l01033"></a>01033             w1 = gamma*(b11*u1 + b12*z2 + b13*z3);
<a name="l01034"></a>01034             w2 = gamma*(b12*u1 + b22*z2 + b23*z3);
<a name="l01035"></a>01035             w3 = gamma*(b13*u1 + b23*z2 + b33*z3);
<a name="l01036"></a>01036             <span class="comment">// w &lt;-  w - (gamma*(u^t w)/2) u</span>
<a name="l01037"></a>01037             <span class="keywordtype">double</span> gutw2 = gamma*(u1*w1 + z2*w2 + z3*w3)/2;
<a name="l01038"></a>01038             w2 -= gutw2*z2;
<a name="l01039"></a>01039             w3 -= gutw2*z3;
<a name="l01040"></a>01040             c2  = b22 - 2*z2*w2;
<a name="l01041"></a>01041             c23 = b23 - z2*w3 - z3*w2;
<a name="l01042"></a>01042             c3  = b33 - 2*z3*w3;
<a name="l01043"></a>01043 
<a name="l01044"></a>01044 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01045"></a>01045 <span class="preprocessor"></span>            <span class="comment">// for debugger testing</span>
<a name="l01046"></a>01046             <span class="comment">// is z close to an eigenvector?</span>
<a name="l01047"></a>01047             w1 -= gutw2*u1;
<a name="l01048"></a>01048             c1  = b11 - 2*u1*w1; <span class="comment">// is c1 more accurate than (aa + r)?</span>
<a name="l01049"></a>01049             c12 = b12 - u1*w2 - z2*w1;
<a name="l01050"></a>01050             c13 = b13 - u1*w3 - z3*w1;
<a name="l01051"></a>01051 <span class="preprocessor">#endif</span>
<a name="l01052"></a>01052 <span class="preprocessor"></span>         }
<a name="l01053"></a>01053 
<a name="l01054"></a>01054          <span class="comment">// find the eigenvalues of</span>
<a name="l01055"></a>01055          <span class="comment">//  |  c2 c23 |</span>
<a name="l01056"></a>01056          <span class="comment">//  | c23  c3 |</span>
<a name="l01057"></a>01057          w1 = 0.5*(c3 - c2);
<a name="l01058"></a>01058          w2 = 0.5*(c2 + c3) + sqrt(w1*w1 + c23*c23);
<a name="l01059"></a>01059          <span class="keywordflow">if</span> (w2 == 0.0)
<a name="l01060"></a>01060          {
<a name="l01061"></a>01061             w1 = 0.0;
<a name="l01062"></a>01062          }
<a name="l01063"></a>01063          <span class="keywordflow">else</span>
<a name="l01064"></a>01064          {
<a name="l01065"></a>01065             w1 = (c2*c3 - c23*c23)/w2;
<a name="l01066"></a>01066          }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068          <span class="keywordflow">if</span> (R &lt; 0.)
<a name="l01069"></a>01069          {
<a name="l01070"></a>01070             <span class="comment">// order is w1 &lt;= w2 &lt;= aa + r</span>
<a name="l01071"></a>01071             <span class="keywordflow">if</span> (i == 2)
<a name="l01072"></a>01072                aa = w1;
<a name="l01073"></a>01073             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0)
<a name="l01074"></a>01074                aa += r;
<a name="l01075"></a>01075             <span class="keywordflow">else</span>
<a name="l01076"></a>01076                aa = w2;
<a name="l01077"></a>01077          }
<a name="l01078"></a>01078          <span class="keywordflow">else</span>
<a name="l01079"></a>01079          {
<a name="l01080"></a>01080             <span class="comment">// order is aa + r &lt;= w1 &lt;= w2</span>
<a name="l01081"></a>01081             <span class="keywordflow">if</span> (i == 2)
<a name="l01082"></a>01082                aa += r;
<a name="l01083"></a>01083             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i == 0)
<a name="l01084"></a>01084                aa = w2;
<a name="l01085"></a>01085             <span class="keywordflow">else</span>
<a name="l01086"></a>01086                aa = w1;
<a name="l01087"></a>01087          }
<a name="l01088"></a>01088 
<a name="l01089"></a>01089          <span class="comment">// double theta = acos(R / sqrtQ3);</span>
<a name="l01090"></a>01090          <span class="comment">// double A = -2 * sqrt(Q);</span>
<a name="l01091"></a>01091          <span class="comment">//</span>
<a name="l01092"></a>01092          <span class="comment">// if (i == 2)</span>
<a name="l01093"></a>01093          <span class="comment">// {</span>
<a name="l01094"></a>01094          <span class="comment">//    aa += A * cos(theta / 3); // min</span>
<a name="l01095"></a>01095          <span class="comment">// }</span>
<a name="l01096"></a>01096          <span class="comment">// else if (i == 0)</span>
<a name="l01097"></a>01097          <span class="comment">// {</span>
<a name="l01098"></a>01098          <span class="comment">//    aa += A * cos((theta + 2.0 * M_PI) / 3); // max</span>
<a name="l01099"></a>01099          <span class="comment">// }</span>
<a name="l01100"></a>01100          <span class="comment">// else</span>
<a name="l01101"></a>01101          <span class="comment">// {</span>
<a name="l01102"></a>01102          <span class="comment">//    aa += A * cos((theta - 2.0 * M_PI) / 3); // mid</span>
<a name="l01103"></a>01103          <span class="comment">// }</span>
<a name="l01104"></a>01104       }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106    have_aa:
<a name="l01107"></a>01107       <span class="keywordflow">if</span> (aa &lt; 0.0)
<a name="l01108"></a>01108       {
<a name="l01109"></a>01109          cerr &lt;&lt; <span class="stringliteral">&quot;DenseMatrix::CalcSingularvalue (3x3) : aa = &quot;</span> &lt;&lt; aa &lt;&lt; endl;
<a name="l01110"></a>01110          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l01111"></a>01111          <span class="keywordflow">return</span> 0.0;
<a name="l01112"></a>01112       }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114       <span class="keywordflow">return</span> sqrt(aa);
<a name="l01115"></a>01115    }
<a name="l01116"></a>01116 
<a name="l01117"></a>01117 <span class="comment">//   return 0.0;</span>
<a name="l01118"></a>01118 }
<a name="l01119"></a>01119 
<a name="l01120"></a><a class="code" href="classDenseMatrix.html#a757fd334ae629deaa8ffdb18181aa42e">01120</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a757fd334ae629deaa8ffdb18181aa42e">DenseMatrix::CalcEigenvalues</a>(<span class="keywordtype">double</span> *lambda, <span class="keywordtype">double</span> *vec)<span class="keyword"> const</span>
<a name="l01121"></a>01121 <span class="keyword"></span>{
<a name="l01122"></a>01122 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01123"></a>01123 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() || <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &lt; 2 || <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &gt; 3)
<a name="l01124"></a>01124       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::CalcEigenvalues&quot;</span>);
<a name="l01125"></a>01125 <span class="preprocessor">#endif</span>
<a name="l01126"></a>01126 <span class="preprocessor"></span>
<a name="l01127"></a>01127    <span class="keyword">const</span> <span class="keywordtype">int</span> n = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01128"></a>01128    <span class="keyword">const</span> <span class="keywordtype">double</span> *d = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01129"></a>01129 
<a name="l01130"></a>01130    <span class="keywordflow">if</span> (n == 2)
<a name="l01131"></a>01131    {
<a name="l01132"></a>01132       <span class="keyword">const</span> <span class="keywordtype">double</span> d0 = d[0];
<a name="l01133"></a>01133       <span class="keyword">const</span> <span class="keywordtype">double</span> d2 = d[2]; <span class="comment">// use the upper triangular entry</span>
<a name="l01134"></a>01134       <span class="keyword">const</span> <span class="keywordtype">double</span> d3 = d[3];
<a name="l01135"></a>01135 
<a name="l01136"></a>01136       <span class="keywordtype">double</span> c, s, l0, l1;
<a name="l01137"></a>01137       <span class="keywordflow">if</span> (d2 == 0.)
<a name="l01138"></a>01138       {
<a name="l01139"></a>01139          c = 1.;
<a name="l01140"></a>01140          s = 0.;
<a name="l01141"></a>01141          l0 = d0;
<a name="l01142"></a>01142          l1 = d3;
<a name="l01143"></a>01143       }
<a name="l01144"></a>01144       <span class="keywordflow">else</span>
<a name="l01145"></a>01145       {
<a name="l01146"></a>01146          <span class="comment">// &quot;The Symmetric Eigenvalue Problem&quot;, B. N. Parlett, pp.189-190</span>
<a name="l01147"></a>01147          <span class="keywordtype">double</span> zeta = (d3 - d0)/(2*d2);
<a name="l01148"></a>01148          <span class="keywordtype">double</span> t = copysign(1./(fabs(zeta) + sqrt(1. + zeta*zeta)), zeta);
<a name="l01149"></a>01149          c = 1./sqrt(1. + t*t);
<a name="l01150"></a>01150          s = c*t;
<a name="l01151"></a>01151          l0 = d0 - d2*t;
<a name="l01152"></a>01152          l1 = d3 + d2*t;
<a name="l01153"></a>01153       }
<a name="l01154"></a>01154       <span class="keywordflow">if</span> (l0 &lt;= l1)
<a name="l01155"></a>01155       {
<a name="l01156"></a>01156          lambda[0] = l0;
<a name="l01157"></a>01157          lambda[1] = l1;
<a name="l01158"></a>01158          vec[0] =  c;
<a name="l01159"></a>01159          vec[1] = -s;
<a name="l01160"></a>01160          vec[2] =  s;
<a name="l01161"></a>01161          vec[3] =  c;
<a name="l01162"></a>01162       }
<a name="l01163"></a>01163       <span class="keywordflow">else</span>
<a name="l01164"></a>01164       {
<a name="l01165"></a>01165          lambda[0] = l1;
<a name="l01166"></a>01166          lambda[1] = l0;
<a name="l01167"></a>01167          vec[0] =  s;
<a name="l01168"></a>01168          vec[1] =  c;
<a name="l01169"></a>01169          vec[2] =  c;
<a name="l01170"></a>01170          vec[3] = -s;
<a name="l01171"></a>01171       }
<a name="l01172"></a>01172    }
<a name="l01173"></a>01173    <span class="keywordflow">else</span>
<a name="l01174"></a>01174    {
<a name="l01175"></a>01175       <span class="keyword">const</span> <span class="keywordtype">double</span> d11 = d[0];
<a name="l01176"></a>01176       <span class="keyword">const</span> <span class="keywordtype">double</span> d22 = d[4];
<a name="l01177"></a>01177       <span class="keyword">const</span> <span class="keywordtype">double</span> d33 = d[8];
<a name="l01178"></a>01178       <span class="keyword">const</span> <span class="keywordtype">double</span> d12 = d[3]; <span class="comment">// use the upper triangular entries</span>
<a name="l01179"></a>01179       <span class="keyword">const</span> <span class="keywordtype">double</span> d13 = d[6];
<a name="l01180"></a>01180       <span class="keyword">const</span> <span class="keywordtype">double</span> d23 = d[7];
<a name="l01181"></a>01181 
<a name="l01182"></a>01182       <span class="keywordtype">double</span> aa = (d11 + d22 + d33)/3;  <span class="comment">// aa = tr(A)/3</span>
<a name="l01183"></a>01183       <span class="keywordtype">double</span> c1 = d11 - aa;
<a name="l01184"></a>01184       <span class="keywordtype">double</span> c2 = d22 - aa;
<a name="l01185"></a>01185       <span class="keywordtype">double</span> c3 = d33 - aa;
<a name="l01186"></a>01186 
<a name="l01187"></a>01187       <span class="keywordtype">double</span> Q = (2*(d12*d12 + d13*d13 + d23*d23) +
<a name="l01188"></a>01188                   c1*c1 + c2*c2 + c3*c3)/6;
<a name="l01189"></a>01189       <span class="keywordtype">double</span> R = (c1*(d23*d23 - c2*c3)+ d12*(d12*c3 - 2*d13*d23) +
<a name="l01190"></a>01190                   d13*d13*c2)/2;
<a name="l01191"></a>01191 
<a name="l01192"></a>01192       <span class="keywordflow">if</span> (Q &lt;= 0.)
<a name="l01193"></a>01193       {
<a name="l01194"></a>01194          lambda[0] = lambda[1] = lambda[2] = aa;
<a name="l01195"></a>01195          vec[0] = 1.; vec[3] = 0.; vec[6] = 0.;
<a name="l01196"></a>01196          vec[1] = 0.; vec[4] = 1.; vec[7] = 0.;
<a name="l01197"></a>01197          vec[2] = 0.; vec[5] = 0.; vec[8] = 1.;
<a name="l01198"></a>01198       }
<a name="l01199"></a>01199       <span class="keywordflow">else</span>
<a name="l01200"></a>01200       {
<a name="l01201"></a>01201          <span class="keywordtype">double</span> sqrtQ = sqrt(Q);
<a name="l01202"></a>01202          <span class="keywordtype">double</span> sqrtQ3 = Q*sqrtQ;
<a name="l01203"></a>01203          <span class="comment">// double sqrtQ3 = sqrtQ*sqrtQ*sqrtQ;</span>
<a name="l01204"></a>01204          <span class="comment">// double sqrtQ3 = pow(Q, 1.5);</span>
<a name="l01205"></a>01205          <span class="keywordtype">double</span> r;
<a name="l01206"></a>01206          <span class="keywordflow">if</span> (fabs(R) &gt;= sqrtQ3)
<a name="l01207"></a>01207          {
<a name="l01208"></a>01208             <span class="keywordflow">if</span> (R &lt; 0.)
<a name="l01209"></a>01209             {
<a name="l01210"></a>01210                R = -1.;
<a name="l01211"></a>01211                r = 2*sqrtQ;
<a name="l01212"></a>01212             }
<a name="l01213"></a>01213             <span class="keywordflow">else</span>
<a name="l01214"></a>01214             {
<a name="l01215"></a>01215                R = 1.;
<a name="l01216"></a>01216                r = -2*sqrtQ;
<a name="l01217"></a>01217             }
<a name="l01218"></a>01218          }
<a name="l01219"></a>01219          <span class="keywordflow">else</span>
<a name="l01220"></a>01220          {
<a name="l01221"></a>01221             R = R/sqrtQ3;
<a name="l01222"></a>01222 
<a name="l01223"></a>01223             <span class="keywordflow">if</span> (R &lt; 0.)
<a name="l01224"></a>01224             {
<a name="l01225"></a>01225                r = -2*sqrtQ*cos((acos(R) + 2.0*M_PI)/3); <span class="comment">// max</span>
<a name="l01226"></a>01226             }
<a name="l01227"></a>01227             <span class="keywordflow">else</span>
<a name="l01228"></a>01228             {
<a name="l01229"></a>01229                r = -2*sqrtQ*cos(acos(R)/3); <span class="comment">// min</span>
<a name="l01230"></a>01230             }
<a name="l01231"></a>01231          }
<a name="l01232"></a>01232 
<a name="l01233"></a>01233          c1 -= r;
<a name="l01234"></a>01234          c2 -= r;
<a name="l01235"></a>01235          c3 -= r;
<a name="l01236"></a>01236 
<a name="l01237"></a>01237          <span class="comment">// QR factorization of</span>
<a name="l01238"></a>01238          <span class="comment">//   c1  d12  d13</span>
<a name="l01239"></a>01239          <span class="comment">//  d12   c2  d23</span>
<a name="l01240"></a>01240          <span class="comment">//  d13  d23   c3</span>
<a name="l01241"></a>01241          <span class="comment">// to find an eigenvector (z1,z2,z3) for [tr(A)/3 + r]</span>
<a name="l01242"></a>01242          <span class="keywordtype">double</span> z1, z2, z3;
<a name="l01243"></a>01243          <span class="keywordtype">double</span> sigma = d12*d12 + d13*d13;
<a name="l01244"></a>01244          <span class="keywordtype">double</span> mu, gamma, u1;
<a name="l01245"></a>01245          <span class="keywordtype">double</span> c12, c13, c23, c32, w1, w2, w3;
<a name="l01246"></a>01246          <span class="keywordflow">if</span> (sigma == 0.)
<a name="l01247"></a>01247          {
<a name="l01248"></a>01248             z1 = 1.;
<a name="l01249"></a>01249             z2 = z3 = 0.;
<a name="l01250"></a>01250          }
<a name="l01251"></a>01251          <span class="keywordflow">else</span>
<a name="l01252"></a>01252          {
<a name="l01253"></a>01253             mu = copysign(sqrt(c1*c1 + sigma), c1);
<a name="l01254"></a>01254             u1 = -sigma/(c1 + mu);
<a name="l01255"></a>01255             gamma = 2./(sigma + u1*u1);
<a name="l01256"></a>01256             c1 = mu;
<a name="l01257"></a>01257             w2  = gamma*(d12*(u1 + c2) + d23*d13);
<a name="l01258"></a>01258             w3  = gamma*(d13*(u1 + c3) + d23*d12);
<a name="l01259"></a>01259             c12 = d12 - u1 *w2;
<a name="l01260"></a>01260             c2  = c2  - d12*w2;
<a name="l01261"></a>01261             c32 = d23 - d13*w2;
<a name="l01262"></a>01262             c13 = d13 - u1 *w3;
<a name="l01263"></a>01263             c23 = d23 - d12*w3;
<a name="l01264"></a>01264             c3  = c3  - d13*w3;
<a name="l01265"></a>01265 
<a name="l01266"></a>01266             sigma = c32*c32;
<a name="l01267"></a>01267             <span class="keywordflow">if</span> (sigma == 0.)
<a name="l01268"></a>01268             {
<a name="l01269"></a>01269                ;
<a name="l01270"></a>01270             }
<a name="l01271"></a>01271             <span class="keywordflow">else</span>
<a name="l01272"></a>01272             {
<a name="l01273"></a>01273                mu = copysign(sqrt(c2*c2 + sigma), c2);
<a name="l01274"></a>01274                u1 = -sigma/(c2 + mu);
<a name="l01275"></a>01275                gamma = 2./(sigma + u1*u1);
<a name="l01276"></a>01276                c2 = mu;
<a name="l01277"></a>01277                w3 = gamma*(u1*c23 + c32*c3);
<a name="l01278"></a>01278                c23 = c23 - u1 *w3;
<a name="l01279"></a>01279                c3  = c3  - c32*w3;
<a name="l01280"></a>01280             }
<a name="l01281"></a>01281             <span class="keywordflow">if</span> (fabs(c3) &lt; fabs(c2))
<a name="l01282"></a>01282             {
<a name="l01283"></a>01283                z3 = 1.;
<a name="l01284"></a>01284                z2 = -c23/c2;
<a name="l01285"></a>01285                z1 = -(c13 + c12*z2)/c1;
<a name="l01286"></a>01286             }
<a name="l01287"></a>01287             <span class="keywordflow">else</span>
<a name="l01288"></a>01288             {
<a name="l01289"></a>01289                z3 = 0.;
<a name="l01290"></a>01290                z2 = 1.;
<a name="l01291"></a>01291                z1 = -c12/c1;
<a name="l01292"></a>01292             }
<a name="l01293"></a>01293          }
<a name="l01294"></a>01294 
<a name="l01295"></a>01295          <span class="comment">// using the eigenvector z=(z1,z2,z3) transform A into</span>
<a name="l01296"></a>01296          <span class="comment">//         | *   0   0 |</span>
<a name="l01297"></a>01297          <span class="comment">// Q A Q = | 0  c2 c23 |</span>
<a name="l01298"></a>01298          <span class="comment">//         | 0 c23  c3 |</span>
<a name="l01299"></a>01299          sigma = z2*z2 + z3*z3;
<a name="l01300"></a>01300          <span class="keywordflow">if</span> (sigma == 0.)
<a name="l01301"></a>01301          {
<a name="l01302"></a>01302             c2  = d22;
<a name="l01303"></a>01303             c23 = d23;
<a name="l01304"></a>01304             c3  = d33;
<a name="l01305"></a>01305          }
<a name="l01306"></a>01306          <span class="keywordflow">else</span>
<a name="l01307"></a>01307          {
<a name="l01308"></a>01308             mu = copysign(sqrt(z1*z1 + sigma), z1);
<a name="l01309"></a>01309             u1 = -sigma/(z1 + mu);
<a name="l01310"></a>01310             gamma = 2./(sigma + u1*u1);
<a name="l01311"></a>01311             w1 = gamma*(d11*u1 + d12*z2 + d13*z3);
<a name="l01312"></a>01312             w2 = gamma*(d12*u1 + d22*z2 + d23*z3);
<a name="l01313"></a>01313             w3 = gamma*(d13*u1 + d23*z2 + d33*z3);
<a name="l01314"></a>01314             <span class="keywordtype">double</span> gutw2 = gamma*(u1*w1 + z2*w2 + z3*w3)/2;
<a name="l01315"></a>01315             w2 -= gutw2*z2;
<a name="l01316"></a>01316             w3 -= gutw2*z3;
<a name="l01317"></a>01317             c2  = d22 - 2*z2*w2;
<a name="l01318"></a>01318             c23 = d23 - z2*w3 - z3*w2;
<a name="l01319"></a>01319             c3  = d33 - 2*z3*w3;
<a name="l01320"></a>01320 
<a name="l01321"></a>01321 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01322"></a>01322 <span class="preprocessor"></span>            <span class="comment">// for debugger testing</span>
<a name="l01323"></a>01323             <span class="comment">// is z close to an eigenvector?</span>
<a name="l01324"></a>01324             w1 -= gutw2*u1;
<a name="l01325"></a>01325             c1  = d11 - 2*u1*w1; <span class="comment">// is c1 more accurate than (aa + r)?</span>
<a name="l01326"></a>01326             c12 = d12 - u1*w2 - z2*w1;
<a name="l01327"></a>01327             c13 = d13 - u1*w3 - z3*w1;
<a name="l01328"></a>01328 <span class="preprocessor">#endif</span>
<a name="l01329"></a>01329 <span class="preprocessor"></span>         }
<a name="l01330"></a>01330 
<a name="l01331"></a>01331          <span class="comment">// find the eigenvalues and eigenvectors for</span>
<a name="l01332"></a>01332          <span class="comment">// |  c2 c23 |</span>
<a name="l01333"></a>01333          <span class="comment">// | c23  c3 |</span>
<a name="l01334"></a>01334          <span class="keywordtype">double</span> c, s;
<a name="l01335"></a>01335          <span class="keywordflow">if</span> (c23 == 0.)
<a name="l01336"></a>01336          {
<a name="l01337"></a>01337             c = 1.;
<a name="l01338"></a>01338             s = 0.;
<a name="l01339"></a>01339             w1 = c2;
<a name="l01340"></a>01340             w2 = c3;
<a name="l01341"></a>01341          }
<a name="l01342"></a>01342          <span class="keywordflow">else</span>
<a name="l01343"></a>01343          {
<a name="l01344"></a>01344             <span class="keywordtype">double</span> zeta = (c3 - c2)/(2*c23);
<a name="l01345"></a>01345             <span class="keywordtype">double</span> t = copysign(1./(fabs(zeta) + sqrt(1. + zeta*zeta)), zeta);
<a name="l01346"></a>01346             c = 1./sqrt(1. + t*t);
<a name="l01347"></a>01347             s = c*t;
<a name="l01348"></a>01348             w1 = c2 - c23*t;
<a name="l01349"></a>01349             w2 = c3 + c23*t;
<a name="l01350"></a>01350          }
<a name="l01351"></a>01351          <span class="comment">// w1 &lt;-&gt; Q (0, c, -s), w2 &lt;-&gt; Q (0, s, c)</span>
<a name="l01352"></a>01352          <span class="comment">// Q = I, when sigma = 0</span>
<a name="l01353"></a>01353          <span class="comment">// Q = I - gamma* u u^t,  u = (u1, z2, z3)</span>
<a name="l01354"></a>01354 
<a name="l01355"></a>01355          <span class="keywordtype">double</span> *vec_ar, *vec_w1, *vec_w2;
<a name="l01356"></a>01356          <span class="keywordflow">if</span> (R &lt; 0.)
<a name="l01357"></a>01357          {
<a name="l01358"></a>01358             <span class="comment">// (aa + r) is max</span>
<a name="l01359"></a>01359             lambda[2] = aa + r;
<a name="l01360"></a>01360             vec_ar = vec + 6;
<a name="l01361"></a>01361             <span class="keywordflow">if</span> (w1 &lt;= w2)
<a name="l01362"></a>01362             {
<a name="l01363"></a>01363                lambda[0] = w1;  vec_w1 = vec;
<a name="l01364"></a>01364                lambda[1] = w2;  vec_w2 = vec + 3;
<a name="l01365"></a>01365             }
<a name="l01366"></a>01366             <span class="keywordflow">else</span>
<a name="l01367"></a>01367             {
<a name="l01368"></a>01368                lambda[0] = w2;  vec_w2 = vec;
<a name="l01369"></a>01369                lambda[1] = w1;  vec_w1 = vec + 3;
<a name="l01370"></a>01370             }
<a name="l01371"></a>01371          }
<a name="l01372"></a>01372          <span class="keywordflow">else</span>
<a name="l01373"></a>01373          {
<a name="l01374"></a>01374             <span class="comment">// (aa + r) is min</span>
<a name="l01375"></a>01375             lambda[0] = aa + r;
<a name="l01376"></a>01376             vec_ar = vec;
<a name="l01377"></a>01377             <span class="keywordflow">if</span> (w1 &lt;= w2)
<a name="l01378"></a>01378             {
<a name="l01379"></a>01379                lambda[1] = w1;  vec_w1 = vec + 3;
<a name="l01380"></a>01380                lambda[2] = w2;  vec_w2 = vec + 6;
<a name="l01381"></a>01381             }
<a name="l01382"></a>01382             <span class="keywordflow">else</span>
<a name="l01383"></a>01383             {
<a name="l01384"></a>01384                lambda[1] = w2;  vec_w2 = vec + 3;
<a name="l01385"></a>01385                lambda[2] = w1;  vec_w1 = vec + 6;
<a name="l01386"></a>01386             }
<a name="l01387"></a>01387          }
<a name="l01388"></a>01388 
<a name="l01389"></a>01389          <span class="keywordflow">if</span> (sigma == 0.)
<a name="l01390"></a>01390          {
<a name="l01391"></a>01391             mu = fabs(z1);
<a name="l01392"></a>01392             vec_w1[0] = 0.;  vec_w2[0] = 0.;
<a name="l01393"></a>01393             vec_w1[1] =  c;  vec_w2[1] = s;
<a name="l01394"></a>01394             vec_w1[2] = -s;  vec_w2[2] = c;
<a name="l01395"></a>01395          }
<a name="l01396"></a>01396          <span class="keywordflow">else</span>
<a name="l01397"></a>01397          {
<a name="l01398"></a>01398             mu = fabs(mu);
<a name="l01399"></a>01399             w1 = gamma*(z2*c - z3*s);
<a name="l01400"></a>01400             w2 = gamma*(z2*s + z3*c);
<a name="l01401"></a>01401             vec_w1[0] =    - u1*w1;  vec_w2[0] =   - u1*w2;
<a name="l01402"></a>01402             vec_w1[1] =  c - z2*w1;  vec_w2[1] = s - z2*w2;
<a name="l01403"></a>01403             vec_w1[2] = -s - z3*w1;  vec_w2[2] = c - z3*w2;
<a name="l01404"></a>01404          }
<a name="l01405"></a>01405          vec_ar[0] = z1/mu;
<a name="l01406"></a>01406          vec_ar[1] = z2/mu;
<a name="l01407"></a>01407          vec_ar[2] = z3/mu;
<a name="l01408"></a>01408       }
<a name="l01409"></a>01409    }
<a name="l01410"></a>01410 }
<a name="l01411"></a>01411 
<a name="l01412"></a><a class="code" href="classDenseMatrix.html#a92248f3e0139029efa8095e66d67b785">01412</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a92248f3e0139029efa8095e66d67b785">DenseMatrix::GetColumn</a>(<span class="keywordtype">int</span> c, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;col)
<a name="l01413"></a>01413 {
<a name="l01414"></a>01414    <span class="keywordtype">int</span> n;
<a name="l01415"></a>01415    <span class="keywordtype">double</span> *cp, *vp;
<a name="l01416"></a>01416 
<a name="l01417"></a>01417    n = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01418"></a>01418    col.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(n);
<a name="l01419"></a>01419    cp = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> + c * n;
<a name="l01420"></a>01420    vp = col.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>();
<a name="l01421"></a>01421 
<a name="l01422"></a>01422    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01423"></a>01423       vp[i] = cp[i];
<a name="l01424"></a>01424 }
<a name="l01425"></a>01425 
<a name="l01426"></a><a class="code" href="classDenseMatrix.html#ad2275d2697fcfaf827a4aa0cfdcb22c9">01426</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ad2275d2697fcfaf827a4aa0cfdcb22c9" title="Creates n x n diagonal matrix with diagonal elements c.">DenseMatrix::Diag</a>(<span class="keywordtype">double</span> c, <span class="keywordtype">int</span> n)
<a name="l01427"></a>01427 {
<a name="l01428"></a>01428    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(n);
<a name="l01429"></a>01429 
<a name="l01430"></a>01430    <span class="keywordtype">int</span> i, N = n*n;
<a name="l01431"></a>01431    <span class="keywordflow">for</span> (i = 0; i &lt; N; i++)
<a name="l01432"></a>01432       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = 0.0;
<a name="l01433"></a>01433    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01434"></a>01434       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i*(n+1)] = c;
<a name="l01435"></a>01435 }
<a name="l01436"></a>01436 
<a name="l01437"></a><a class="code" href="classDenseMatrix.html#a4749f1b86b576539128aeed58e72c473">01437</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ad2275d2697fcfaf827a4aa0cfdcb22c9" title="Creates n x n diagonal matrix with diagonal elements c.">DenseMatrix::Diag</a>(<span class="keywordtype">double</span> *diag, <span class="keywordtype">int</span> n)
<a name="l01438"></a>01438 {
<a name="l01439"></a>01439    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(n);
<a name="l01440"></a>01440 
<a name="l01441"></a>01441    <span class="keywordtype">int</span> i, N = n*n;
<a name="l01442"></a>01442    <span class="keywordflow">for</span> (i = 0; i &lt; N; i++)
<a name="l01443"></a>01443       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = 0.0;
<a name="l01444"></a>01444    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01445"></a>01445       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i*(n+1)] = diag[i];
<a name="l01446"></a>01446 }
<a name="l01447"></a>01447 
<a name="l01448"></a><a class="code" href="classDenseMatrix.html#a0b9f800320c7a70ce6a5130e9c9c27b0">01448</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a0b9f800320c7a70ce6a5130e9c9c27b0" title="(*this) = (*this)^t">DenseMatrix::Transpose</a>()
<a name="l01449"></a>01449 {
<a name="l01450"></a>01450    <span class="keywordtype">int</span> i, j;
<a name="l01451"></a>01451    <span class="keywordtype">double</span> t;
<a name="l01452"></a>01452 
<a name="l01453"></a>01453    <span class="keywordflow">if</span> (<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() == <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l01454"></a>01454    {
<a name="l01455"></a>01455       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01456"></a>01456          <span class="keywordflow">for</span> (j = i+1; j &lt; <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l01457"></a>01457          {
<a name="l01458"></a>01458             t = (*this)(i,j);
<a name="l01459"></a>01459             (*this)(i,j) = (*<span class="keyword">this</span>)(j,i);
<a name="l01460"></a>01460             (*this)(j,i) = t;
<a name="l01461"></a>01461          }
<a name="l01462"></a>01462    }
<a name="l01463"></a>01463    <span class="keywordflow">else</span>
<a name="l01464"></a>01464    {
<a name="l01465"></a>01465       <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> T(*<span class="keyword">this</span>,<span class="charliteral">&#39;t&#39;</span>);
<a name="l01466"></a>01466       (*this) = T;
<a name="l01467"></a>01467    }
<a name="l01468"></a>01468 }
<a name="l01469"></a>01469 
<a name="l01470"></a><a class="code" href="classDenseMatrix.html#a86bba84c6025d6ac3b60e45ed2b441c6">01470</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a0b9f800320c7a70ce6a5130e9c9c27b0" title="(*this) = (*this)^t">DenseMatrix::Transpose</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A)
<a name="l01471"></a>01471 {
<a name="l01472"></a>01472    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(A.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(),A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>());
<a name="l01473"></a>01473 
<a name="l01474"></a>01474    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01475"></a>01475       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l01476"></a>01476          (*<span class="keyword">this</span>)(i,j) = A(j,i);
<a name="l01477"></a>01477 }
<a name="l01478"></a>01478 
<a name="l01479"></a><a class="code" href="classDenseMatrix.html#a9461b2333a876d768623912d4207814c">01479</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a9461b2333a876d768623912d4207814c" title="(*this) = 1/2 ((*this) + (*this)^t)">DenseMatrix::Symmetrize</a>()
<a name="l01480"></a>01480 {
<a name="l01481"></a>01481 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01482"></a>01482 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l01483"></a>01483       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::Symmetrize() : not a square matrix!&quot;</span>);
<a name="l01484"></a>01484 <span class="preprocessor">#endif</span>
<a name="l01485"></a>01485 <span class="preprocessor"></span>
<a name="l01486"></a>01486    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01487"></a>01487       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l01488"></a>01488       {
<a name="l01489"></a>01489          <span class="keywordtype">double</span> a = 0.5 * ((*this)(i,j) + (*<span class="keyword">this</span>)(j,i));
<a name="l01490"></a>01490          (*this)(j,i) = (*<span class="keyword">this</span>)(i,j) = a;
<a name="l01491"></a>01491       }
<a name="l01492"></a>01492 }
<a name="l01493"></a>01493 
<a name="l01494"></a><a class="code" href="classDenseMatrix.html#a77a13cfe8bd699cd8d64a6685897ea78">01494</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a77a13cfe8bd699cd8d64a6685897ea78">DenseMatrix::Lump</a>()
<a name="l01495"></a>01495 {
<a name="l01496"></a>01496    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01497"></a>01497    {
<a name="l01498"></a>01498       <span class="keywordtype">double</span> L = 0.0;
<a name="l01499"></a>01499       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); j++)
<a name="l01500"></a>01500       {
<a name="l01501"></a>01501          L += (*this)(i, j);
<a name="l01502"></a>01502          (*this)(i, j) = 0.0;
<a name="l01503"></a>01503       }
<a name="l01504"></a>01504       (*this)(i, i) = L;
<a name="l01505"></a>01505    }
<a name="l01506"></a>01506 }
<a name="l01507"></a>01507 
<a name="l01508"></a><a class="code" href="classDenseMatrix.html#a5a01b9ba86ed4e9b5a79d5d56c9801d3">01508</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a5a01b9ba86ed4e9b5a79d5d56c9801d3">DenseMatrix::GradToCurl</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;curl)
<a name="l01509"></a>01509 {
<a name="l01510"></a>01510    <span class="keywordtype">int</span> n = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01511"></a>01511 
<a name="l01512"></a>01512 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01513"></a>01513 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != 3 || curl.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != 3 || 3*n != curl.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l01514"></a>01514       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::GradToCurl(...)&quot;</span>);
<a name="l01515"></a>01515 <span class="preprocessor">#endif</span>
<a name="l01516"></a>01516 <span class="preprocessor"></span>
<a name="l01517"></a>01517    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01518"></a>01518    {
<a name="l01519"></a>01519       <span class="comment">// (x,y,z) is grad of Ui</span>
<a name="l01520"></a>01520       <span class="keywordtype">double</span> x = (*this)(i,0);
<a name="l01521"></a>01521       <span class="keywordtype">double</span> y = (*this)(i,1);
<a name="l01522"></a>01522       <span class="keywordtype">double</span> z = (*this)(i,2);
<a name="l01523"></a>01523 
<a name="l01524"></a>01524       <span class="keywordtype">int</span> j = i+n;
<a name="l01525"></a>01525       <span class="keywordtype">int</span> k = j+n;
<a name="l01526"></a>01526 
<a name="l01527"></a>01527       <span class="comment">// curl of (Ui,0,0)</span>
<a name="l01528"></a>01528       curl(i,0) =  0.;
<a name="l01529"></a>01529       curl(i,1) =  z;
<a name="l01530"></a>01530       curl(i,2) = -y;
<a name="l01531"></a>01531 
<a name="l01532"></a>01532       <span class="comment">// curl of (0,Ui,0)</span>
<a name="l01533"></a>01533       curl(j,0) = -z;
<a name="l01534"></a>01534       curl(j,1) =  0.;
<a name="l01535"></a>01535       curl(j,2) =  x;
<a name="l01536"></a>01536 
<a name="l01537"></a>01537       <span class="comment">// curl of (0,0,Ui)</span>
<a name="l01538"></a>01538       curl(k,0) =  y;
<a name="l01539"></a>01539       curl(k,1) = -x;
<a name="l01540"></a>01540       curl(k,2) =  0.;
<a name="l01541"></a>01541    }
<a name="l01542"></a>01542 }
<a name="l01543"></a>01543 
<a name="l01544"></a><a class="code" href="classDenseMatrix.html#a79965cd4c08ff682aaea8cfdd0b135cd">01544</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a79965cd4c08ff682aaea8cfdd0b135cd">DenseMatrix::GradToDiv</a>(<a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;div)
<a name="l01545"></a>01545 {
<a name="l01546"></a>01546 
<a name="l01547"></a>01547 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01548"></a>01548 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>()*<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != div.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>())
<a name="l01549"></a>01549       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::GradToDiv(...)&quot;</span>);
<a name="l01550"></a>01550 <span class="preprocessor">#endif</span>
<a name="l01551"></a>01551 <span class="preprocessor"></span>
<a name="l01552"></a>01552    <span class="comment">// div(dof*j+i) &lt;-- (*this)(i,j)</span>
<a name="l01553"></a>01553 
<a name="l01554"></a>01554    <span class="keywordtype">int</span> n = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> * <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l01555"></a>01555    <span class="keywordtype">double</span> *ddata = div.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>();
<a name="l01556"></a>01556 
<a name="l01557"></a>01557    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l01558"></a>01558       ddata[i] = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i];
<a name="l01559"></a>01559 }
<a name="l01560"></a>01560 
<a name="l01561"></a><a class="code" href="classDenseMatrix.html#a1f8a11be5139f1193683060c6bf824d5">01561</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a1f8a11be5139f1193683060c6bf824d5" title="Copy rows row1 through row2 from A to *this.">DenseMatrix::CopyRows</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> row1, <span class="keywordtype">int</span> row2)
<a name="l01562"></a>01562 {
<a name="l01563"></a>01563    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(row2 - row1 + 1, A.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>());
<a name="l01564"></a>01564 
<a name="l01565"></a>01565    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = row1; i &lt;= row2; i++)
<a name="l01566"></a>01566       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l01567"></a>01567          (*<span class="keyword">this</span>)(i-row1,j) = A(i,j);
<a name="l01568"></a>01568 }
<a name="l01569"></a>01569 
<a name="l01570"></a><a class="code" href="classDenseMatrix.html#a9faa9c7f0ceb312758ec88e29f1d224d">01570</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a9faa9c7f0ceb312758ec88e29f1d224d" title="Copy columns col1 through col2 from A to *this.">DenseMatrix::CopyCols</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> col1, <span class="keywordtype">int</span> col2)
<a name="l01571"></a>01571 {
<a name="l01572"></a>01572    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(), col2 - col1 + 1);
<a name="l01573"></a>01573 
<a name="l01574"></a>01574    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01575"></a>01575       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = col1; j &lt;= col2; j++)
<a name="l01576"></a>01576          (*<span class="keyword">this</span>)(i,j-col1) = A(i,j);
<a name="l01577"></a>01577 }
<a name="l01578"></a>01578 
<a name="l01579"></a><a class="code" href="classDenseMatrix.html#a1177868a2dedc2569d82c082874d1828">01579</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a1177868a2dedc2569d82c082874d1828" title="Copy the m x n submatrix of A at (Aro)ffset, (Aco)loffset to *this.">DenseMatrix::CopyMN</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> m, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> Aro, <span class="keywordtype">int</span> Aco)
<a name="l01580"></a>01580 {
<a name="l01581"></a>01581    <span class="keywordtype">int</span> i, j;
<a name="l01582"></a>01582 
<a name="l01583"></a>01583    <a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(m,n);
<a name="l01584"></a>01584 
<a name="l01585"></a>01585    <span class="keywordflow">for</span> (j = 0; j &lt; n; j++)
<a name="l01586"></a>01586       <span class="keywordflow">for</span> (i = 0; i &lt; m; i++)
<a name="l01587"></a>01587          (*<span class="keyword">this</span>)(i,j) = A(Aro+i,Aco+j);
<a name="l01588"></a>01588 }
<a name="l01589"></a>01589 
<a name="l01590"></a><a class="code" href="classDenseMatrix.html#ad0d2cf7ee3263391e33512e8fe8a9170">01590</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a1177868a2dedc2569d82c082874d1828" title="Copy the m x n submatrix of A at (Aro)ffset, (Aco)loffset to *this.">DenseMatrix::CopyMN</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> row_offset, <span class="keywordtype">int</span> col_offset)
<a name="l01591"></a>01591 {
<a name="l01592"></a>01592    <span class="keywordtype">int</span> i, j;
<a name="l01593"></a>01593    <span class="keywordtype">double</span> *v = A.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01594"></a>01594 
<a name="l01595"></a>01595    <span class="keywordflow">for</span> (j = 0; j &lt; A.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l01596"></a>01596       <span class="keywordflow">for</span> (i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01597"></a>01597          (*<span class="keyword">this</span>)(row_offset+i,col_offset+j) = *(v++);
<a name="l01598"></a>01598 }
<a name="l01599"></a>01599 
<a name="l01600"></a><a class="code" href="classDenseMatrix.html#ad251c00d71171c9c9805e877f9decf93">01600</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ad251c00d71171c9c9805e877f9decf93" title="Copy matrix A^t to the location in *this at row_offset, col_offset.">DenseMatrix::CopyMNt</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> row_offset, <span class="keywordtype">int</span> col_offset)
<a name="l01601"></a>01601 {
<a name="l01602"></a>01602    <span class="keywordtype">int</span> i, j;
<a name="l01603"></a>01603    <span class="keywordtype">double</span> *v = A.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01604"></a>01604 
<a name="l01605"></a>01605    <span class="keywordflow">for</span> (i = 0; i &lt; A.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); i++)
<a name="l01606"></a>01606       <span class="keywordflow">for</span> (j = 0; j &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); j++)
<a name="l01607"></a>01607          (*<span class="keyword">this</span>)(row_offset+i,col_offset+j) = *(v++);
<a name="l01608"></a>01608 }
<a name="l01609"></a>01609 
<a name="l01610"></a><a class="code" href="classDenseMatrix.html#ae71fc54cc96e87a964d5cb9820db7d69">01610</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ae71fc54cc96e87a964d5cb9820db7d69" title="Copy c on the diagonal of size n to *this at row_offset, col_offset.">DenseMatrix::CopyMNDiag</a>(<span class="keywordtype">double</span> c, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> row_offset, <span class="keywordtype">int</span> col_offset)
<a name="l01611"></a>01611 {
<a name="l01612"></a>01612    <span class="keywordtype">int</span> i, j;
<a name="l01613"></a>01613 
<a name="l01614"></a>01614    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01615"></a>01615       <span class="keywordflow">for</span> (j = i+1; j &lt; n; j++)
<a name="l01616"></a>01616          (*<span class="keyword">this</span>)(row_offset+i,col_offset+j) =
<a name="l01617"></a>01617             (*<span class="keyword">this</span>)(row_offset+j,col_offset+i) = 0.0;
<a name="l01618"></a>01618 
<a name="l01619"></a>01619    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01620"></a>01620       (*<span class="keyword">this</span>)(row_offset+i,col_offset+i) = c;
<a name="l01621"></a>01621 }
<a name="l01622"></a>01622 
<a name="l01623"></a><a class="code" href="classDenseMatrix.html#abece26ecf4b85b150f00b2a258ed438e">01623</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ae71fc54cc96e87a964d5cb9820db7d69" title="Copy c on the diagonal of size n to *this at row_offset, col_offset.">DenseMatrix::CopyMNDiag</a>(<span class="keywordtype">double</span> *diag, <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> row_offset,
<a name="l01624"></a>01624                              <span class="keywordtype">int</span> col_offset)
<a name="l01625"></a>01625 {
<a name="l01626"></a>01626    <span class="keywordtype">int</span> i, j;
<a name="l01627"></a>01627 
<a name="l01628"></a>01628    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01629"></a>01629       <span class="keywordflow">for</span> (j = i+1; j &lt; n; j++)
<a name="l01630"></a>01630          (*<span class="keyword">this</span>)(row_offset+i,col_offset+j) =
<a name="l01631"></a>01631             (*<span class="keyword">this</span>)(row_offset+j,col_offset+i) = 0.0;
<a name="l01632"></a>01632 
<a name="l01633"></a>01633    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01634"></a>01634       (*<span class="keyword">this</span>)(row_offset+i,col_offset+i) = diag[i];
<a name="l01635"></a>01635 }
<a name="l01636"></a>01636 
<a name="l01637"></a><a class="code" href="classDenseMatrix.html#a34b008f6fc33abf8a9bfb13d54b8f6b4">01637</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a34b008f6fc33abf8a9bfb13d54b8f6b4" title="Perform (ro+i,co+j)+=A(i,j) for 0&lt;=i&lt;A.Height, 0&lt;=j&lt;A.Width.">DenseMatrix::AddMatrix</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> ro, <span class="keywordtype">int</span> co)
<a name="l01638"></a>01638 {
<a name="l01639"></a>01639    <span class="keywordtype">int</span> h, ah, aw;
<a name="l01640"></a>01640    <span class="keywordtype">double</span> *p, *ap;
<a name="l01641"></a>01641 
<a name="l01642"></a>01642    h  = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01643"></a>01643    ah = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01644"></a>01644    aw = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l01645"></a>01645 
<a name="l01646"></a>01646 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01647"></a>01647 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (co+aw &gt; <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() || ro+ah &gt; h)
<a name="l01648"></a>01648       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::AddMatrix(...) 1&quot;</span>);
<a name="l01649"></a>01649 <span class="preprocessor">#endif</span>
<a name="l01650"></a>01650 <span class="preprocessor"></span>
<a name="l01651"></a>01651    p  = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> + ro + co * h;
<a name="l01652"></a>01652    ap = A.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01653"></a>01653 
<a name="l01654"></a>01654    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; aw; c++)
<a name="l01655"></a>01655    {
<a name="l01656"></a>01656       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; ah; r++)
<a name="l01657"></a>01657          p[r] += ap[r];
<a name="l01658"></a>01658       p  += h;
<a name="l01659"></a>01659       ap += ah;
<a name="l01660"></a>01660    }
<a name="l01661"></a>01661 }
<a name="l01662"></a>01662 
<a name="l01663"></a><a class="code" href="classDenseMatrix.html#af41bd92836b9abec33e50557ea121e42">01663</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a34b008f6fc33abf8a9bfb13d54b8f6b4" title="Perform (ro+i,co+j)+=A(i,j) for 0&lt;=i&lt;A.Height, 0&lt;=j&lt;A.Width.">DenseMatrix::AddMatrix</a>(<span class="keywordtype">double</span> a, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keywordtype">int</span> ro, <span class="keywordtype">int</span> co)
<a name="l01664"></a>01664 {
<a name="l01665"></a>01665    <span class="keywordtype">int</span> h, ah, aw;
<a name="l01666"></a>01666    <span class="keywordtype">double</span> *p, *ap;
<a name="l01667"></a>01667 
<a name="l01668"></a>01668    h  = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01669"></a>01669    ah = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01670"></a>01670    aw = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l01671"></a>01671 
<a name="l01672"></a>01672 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01673"></a>01673 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (co+aw &gt; <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() || ro+ah &gt; h)
<a name="l01674"></a>01674       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::AddMatrix(...) 2&quot;</span>);
<a name="l01675"></a>01675 <span class="preprocessor">#endif</span>
<a name="l01676"></a>01676 <span class="preprocessor"></span>
<a name="l01677"></a>01677    p  = <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> + ro + co * h;
<a name="l01678"></a>01678    ap = A.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01679"></a>01679 
<a name="l01680"></a>01680    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; aw; c++)
<a name="l01681"></a>01681    {
<a name="l01682"></a>01682       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; ah; r++)
<a name="l01683"></a>01683          p[r] += a * ap[r];
<a name="l01684"></a>01684       p  += h;
<a name="l01685"></a>01685       ap += ah;
<a name="l01686"></a>01686    }
<a name="l01687"></a>01687 }
<a name="l01688"></a>01688 
<a name="l01689"></a><a class="code" href="classDenseMatrix.html#a298d0f2d78e61e6d4fa42eaf0bceffaa">01689</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a298d0f2d78e61e6d4fa42eaf0bceffaa" title="Add the matrix &#39;data&#39; to the Vector &#39;v&#39; at the given &#39;offset&#39;.">DenseMatrix::AddToVector</a>(<span class="keywordtype">int</span> offset, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;v)<span class="keyword"> const</span>
<a name="l01690"></a>01690 <span class="keyword"></span>{
<a name="l01691"></a>01691    <span class="keywordtype">int</span> i, n = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> * <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l01692"></a>01692    <span class="keywordtype">double</span> *vdata = v.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>() + offset;
<a name="l01693"></a>01693 
<a name="l01694"></a>01694    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01695"></a>01695       vdata[i] += <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i];
<a name="l01696"></a>01696 }
<a name="l01697"></a>01697 
<a name="l01698"></a><a class="code" href="classDenseMatrix.html#ae3ab94d4fdde682e69cb65474afdcf58">01698</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#ae3ab94d4fdde682e69cb65474afdcf58" title="Get the matrix &#39;data&#39; from the Vector &#39;v&#39; at the given &#39;offset&#39;.">DenseMatrix::GetFromVector</a>(<span class="keywordtype">int</span> offset, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;v)
<a name="l01699"></a>01699 {
<a name="l01700"></a>01700    <span class="keywordtype">int</span> i, n = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> * <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l01701"></a>01701    <span class="keyword">const</span> <span class="keywordtype">double</span> *vdata = v.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>() + offset;
<a name="l01702"></a>01702 
<a name="l01703"></a>01703    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)
<a name="l01704"></a>01704       <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>[i] = vdata[i];
<a name="l01705"></a>01705 }
<a name="l01706"></a>01706 
<a name="l01707"></a><a class="code" href="classDenseMatrix.html#aedf31d5543691ccbbaa52bfc277abe6c">01707</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#aedf31d5543691ccbbaa52bfc277abe6c">DenseMatrix::AdjustDofDirection</a>(<a class="code" href="classArray.html">Array&lt;int&gt;</a> &amp;dofs)
<a name="l01708"></a>01708 {
<a name="l01709"></a>01709    <span class="keywordtype">int</span> n = <a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l01710"></a>01710 
<a name="l01711"></a>01711 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01712"></a>01712 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (dofs.<a class="code" href="classArray.html#a1800462052b7d06f99f29eba9da74ba9" title="Logical size of the array.">Size</a>() != n || <a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != n)
<a name="l01713"></a>01713       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::AdjustDofDirection(...)&quot;</span>);
<a name="l01714"></a>01714 <span class="preprocessor">#endif</span>
<a name="l01715"></a>01715 <span class="preprocessor"></span>
<a name="l01716"></a>01716    <span class="keywordtype">int</span> *dof = dofs;
<a name="l01717"></a>01717    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n-1; i++)
<a name="l01718"></a>01718    {
<a name="l01719"></a>01719       <span class="keywordtype">int</span> s = (dof[i] &lt; 0) ? (-1) : (1);
<a name="l01720"></a>01720       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i+1; j &lt; n; j++)
<a name="l01721"></a>01721       {
<a name="l01722"></a>01722          <span class="keywordtype">int</span> t = (dof[j] &lt; 0) ? (-s) : (s);
<a name="l01723"></a>01723          <span class="keywordflow">if</span> (t &lt; 0)
<a name="l01724"></a>01724          {
<a name="l01725"></a>01725             (*this)(i,j) = -(*<span class="keyword">this</span>)(i,j);
<a name="l01726"></a>01726             (*this)(j,i) = -(*<span class="keyword">this</span>)(j,i);
<a name="l01727"></a>01727          }
<a name="l01728"></a>01728       }
<a name="l01729"></a>01729    }
<a name="l01730"></a>01730 }
<a name="l01731"></a>01731 
<a name="l01732"></a>01732 
<a name="l01733"></a><a class="code" href="classDenseMatrix.html#a121686877262cd82f5396ed541493dc6">01733</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a121686877262cd82f5396ed541493dc6" title="Prints matrix to stream out.">DenseMatrix::Print</a>(ostream &amp;out, <span class="keywordtype">int</span> width)<span class="keyword"> const</span>
<a name="l01734"></a>01734 <span class="keyword"></span>{
<a name="l01735"></a>01735    <span class="comment">// output flags = scientific + show sign</span>
<a name="l01736"></a>01736    out &lt;&lt; setiosflags(ios::scientific | ios::showpos);
<a name="l01737"></a>01737    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l01738"></a>01738    {
<a name="l01739"></a>01739       out &lt;&lt; <span class="stringliteral">&quot;[row &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;
<a name="l01740"></a>01740       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l01741"></a>01741       {
<a name="l01742"></a>01742          out &lt;&lt; (*this)(i,j);
<a name="l01743"></a>01743          <span class="keywordflow">if</span> (j+1 == size || (j+1) % width == 0)
<a name="l01744"></a>01744             out &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01745"></a>01745          <span class="keywordflow">else</span>
<a name="l01746"></a>01746             out &lt;&lt; <span class="charliteral">&#39; &#39;</span>;
<a name="l01747"></a>01747       }
<a name="l01748"></a>01748    }
<a name="l01749"></a>01749 }
<a name="l01750"></a>01750 
<a name="l01751"></a><a class="code" href="classDenseMatrix.html#a8ff93bdd9fee019dd25bf66fcb0cc986">01751</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a8ff93bdd9fee019dd25bf66fcb0cc986" title="Prints the transpose matrix to stream out.">DenseMatrix::PrintT</a>(ostream &amp;out, <span class="keywordtype">int</span> width)<span class="keyword"> const</span>
<a name="l01752"></a>01752 <span class="keyword"></span>{
<a name="l01753"></a>01753    <span class="comment">// output flags = scientific + show sign</span>
<a name="l01754"></a>01754    out &lt;&lt; setiosflags(ios::scientific | ios::showpos);
<a name="l01755"></a>01755    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l01756"></a>01756    {
<a name="l01757"></a>01757       out &lt;&lt; <span class="stringliteral">&quot;[col &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;
<a name="l01758"></a>01758       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>; i++)
<a name="l01759"></a>01759       {
<a name="l01760"></a>01760          out &lt;&lt; (*this)(i,j);
<a name="l01761"></a>01761          <span class="keywordflow">if</span> (i+1 == height || (i+1) % width == 0)
<a name="l01762"></a>01762             out &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;
<a name="l01763"></a>01763          <span class="keywordflow">else</span>
<a name="l01764"></a>01764             out &lt;&lt; <span class="charliteral">&#39; &#39;</span>;
<a name="l01765"></a>01765       }
<a name="l01766"></a>01766    }
<a name="l01767"></a>01767 }
<a name="l01768"></a>01768 
<a name="l01769"></a><a class="code" href="classDenseMatrix.html#a7457b454040de5a8b2f727eb69b0e5fe">01769</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrix.html#a7457b454040de5a8b2f727eb69b0e5fe" title="Invert and print the numerical conditioning of the inversion.">DenseMatrix::TestInversion</a>()
<a name="l01770"></a>01770 {
<a name="l01771"></a>01771    <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> copy(*<span class="keyword">this</span>), C(<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>);
<a name="l01772"></a>01772    <a class="code" href="classDenseMatrix.html#aebb728dba84eab2ba6b8d21d43b650c3" title="Replaces the current matrix with its inverse.">Invert</a>();<a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C."></a>
<a name="l01773"></a>01773 <a class="code" href="classDenseMatrix.html#a551f543a298eeabe7d83e1b738838db6" title="Matrix matrix multiplication. A = B * C.">   ::Mult</a>(*<span class="keyword">this</span>, copy, C);
<a name="l01774"></a>01774 
<a name="l01775"></a>01775    <span class="keywordtype">double</span> i_max = 0.;
<a name="l01776"></a>01776    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l01777"></a>01777       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; i++)
<a name="l01778"></a>01778       {
<a name="l01779"></a>01779          <span class="keywordflow">if</span> (i == j)
<a name="l01780"></a>01780             C(i,j) -= 1.;
<a name="l01781"></a>01781          i_max = fmax(i_max, fabs(C(i, j)));
<a name="l01782"></a>01782       }
<a name="l01783"></a>01783    cout &lt;&lt; <span class="stringliteral">&quot;size = &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot;, i_max = &quot;</span> &lt;&lt; i_max
<a name="l01784"></a>01784         &lt;&lt; <span class="stringliteral">&quot;, cond_F = &quot;</span> &lt;&lt; <a class="code" href="classDenseMatrix.html#ae77bd4a36c9ba5800654b3e3b78e6a09">FNorm</a>()*copy.FNorm() &lt;&lt; endl;
<a name="l01785"></a>01785 }
<a name="l01786"></a>01786 
<a name="l01787"></a><a class="code" href="classDenseMatrix.html#a7c920f60470d6a862624c7632fec5e4b">01787</a> <a class="code" href="classDenseMatrix.html#a7c920f60470d6a862624c7632fec5e4b" title="Destroys dense matrix.">DenseMatrix::~DenseMatrix</a>()
<a name="l01788"></a>01788 {
<a name="l01789"></a>01789    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a> != NULL)
<a name="l01790"></a>01790       <span class="keyword">delete</span> [] <a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01791"></a>01791 }
<a name="l01792"></a>01792 
<a name="l01793"></a>01793 
<a name="l01794"></a>01794 
<a name="l01795"></a><a class="code" href="densemat_8hpp.html#a00f1742fc9481ac7b9d314d2163a8732">01795</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a00f1742fc9481ac7b9d314d2163a8732" title="C = A + alpha*B.">Add</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;B,
<a name="l01796"></a>01796          <span class="keywordtype">double</span> alpha, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;C)
<a name="l01797"></a>01797 {
<a name="l01798"></a>01798    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; C.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l01799"></a>01799       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; C.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l01800"></a>01800          C(i,j) = A(i,j) + alpha * B(i,j);
<a name="l01801"></a>01801 }
<a name="l01802"></a>01802 
<a name="l01803"></a>01803 
<a name="l01804"></a><a class="code" href="densemat_8hpp.html#a551f543a298eeabe7d83e1b738838db6">01804</a> <span class="keywordtype">void</span> <a class="code" href="table_8cpp.html#a640d9bfa0f77dd502a095e13431e1ab4" title="C = A * B (as boolean matrices)">Mult</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;b, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;c, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a)
<a name="l01805"></a>01805 {
<a name="l01806"></a>01806 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01807"></a>01807 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> != b.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> || a.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> != c.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> || b.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> != c.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>)
<a name="l01808"></a>01808       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;Mult (product of DenseMatrices)&quot;</span>);
<a name="l01809"></a>01809 <span class="preprocessor">#endif</span>
<a name="l01810"></a>01810 <span class="preprocessor"></span>
<a name="l01811"></a>01811    <span class="keyword">register</span> <span class="keywordtype">int</span> ah = a.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a>;
<a name="l01812"></a>01812    <span class="keyword">register</span> <span class="keywordtype">int</span> as = a.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>;
<a name="l01813"></a>01813    <span class="keyword">register</span> <span class="keywordtype">int</span> bs = b.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>;
<a name="l01814"></a>01814    <span class="keyword">register</span> <span class="keywordtype">double</span> *ad = a.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01815"></a>01815    <span class="keyword">register</span> <span class="keywordtype">double</span> *bd = b.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01816"></a>01816    <span class="keyword">register</span> <span class="keywordtype">double</span> *cd = c.<a class="code" href="classDenseMatrix.html#a828ee8ab70a7d8b081d3357012b8b2f6">data</a>;
<a name="l01817"></a>01817    <span class="keyword">register</span> <span class="keywordtype">int</span> i, j, k;
<a name="l01818"></a>01818    <span class="keyword">register</span> <span class="keywordtype">double</span> d, *bdd, *cdd;
<a name="l01819"></a>01819 
<a name="l01820"></a>01820    <span class="keywordflow">for</span> (j = 0; j &lt; as; j++, cd += bs)
<a name="l01821"></a>01821    {
<a name="l01822"></a>01822       <span class="keywordflow">for</span> (i = 0; i &lt; ah; i++, ad++)
<a name="l01823"></a>01823       {
<a name="l01824"></a>01824          d = 0.0;
<a name="l01825"></a>01825          bdd = bd+i;
<a name="l01826"></a>01826          cdd = cd;
<a name="l01827"></a>01827          <span class="keywordflow">for</span> (k = 0 ; k &lt; bs; k++)
<a name="l01828"></a>01828          {
<a name="l01829"></a>01829             d += (*bdd) * (*cdd);
<a name="l01830"></a>01830             cdd++;
<a name="l01831"></a>01831             bdd += ah;
<a name="l01832"></a>01832          }
<a name="l01833"></a>01833          *ad = d;
<a name="l01834"></a>01834       }
<a name="l01835"></a>01835    }
<a name="l01836"></a>01836 }
<a name="l01837"></a>01837 
<a name="l01838"></a><a class="code" href="densemat_8hpp.html#aa277ac8940fbea0e2218599d85e08a55">01838</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#aa277ac8940fbea0e2218599d85e08a55" title="Calculate the adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugate</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;adja)
<a name="l01839"></a>01839 {
<a name="l01840"></a>01840 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01841"></a>01841 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() || adja.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != adja.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() ||
<a name="l01842"></a>01842        a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() != adja.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() || a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() &lt; 2 || a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() &gt; 3)
<a name="l01843"></a>01843       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::CalcAdjugate(...)&quot;</span>);
<a name="l01844"></a>01844 <span class="preprocessor">#endif</span>
<a name="l01845"></a>01845 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() == 2)
<a name="l01846"></a>01846    {
<a name="l01847"></a>01847       adja(0,0) =  a(1,1);
<a name="l01848"></a>01848       adja(0,1) = -a(0,1);
<a name="l01849"></a>01849       adja(1,0) = -a(1,0);
<a name="l01850"></a>01850       adja(1,1) =  a(0,0);
<a name="l01851"></a>01851    }
<a name="l01852"></a>01852    <span class="keywordflow">else</span>
<a name="l01853"></a>01853    {
<a name="l01854"></a>01854       adja(0,0) = a(1,1)*a(2,2)-a(1,2)*a(2,1);
<a name="l01855"></a>01855       adja(0,1) = a(0,2)*a(2,1)-a(0,1)*a(2,2);
<a name="l01856"></a>01856       adja(0,2) = a(0,1)*a(1,2)-a(0,2)*a(1,1);
<a name="l01857"></a>01857 
<a name="l01858"></a>01858       adja(1,0) = a(1,2)*a(2,0)-a(1,0)*a(2,2);
<a name="l01859"></a>01859       adja(1,1) = a(0,0)*a(2,2)-a(0,2)*a(2,0);
<a name="l01860"></a>01860       adja(1,2) = a(0,2)*a(1,0)-a(0,0)*a(1,2);
<a name="l01861"></a>01861 
<a name="l01862"></a>01862       adja(2,0) = a(1,0)*a(2,1)-a(1,1)*a(2,0);
<a name="l01863"></a>01863       adja(2,1) = a(0,1)*a(2,0)-a(0,0)*a(2,1);
<a name="l01864"></a>01864       adja(2,2) = a(0,0)*a(1,1)-a(0,1)*a(1,0);
<a name="l01865"></a>01865    }
<a name="l01866"></a>01866 }
<a name="l01867"></a>01867 
<a name="l01868"></a><a class="code" href="densemat_8hpp.html#a7b40a1c38433459a55082cc3d916b38e">01868</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a7b40a1c38433459a55082cc3d916b38e" title="Calculate the transposed adjugate of a matrix (for 2x2 or 3x3 matrices)">CalcAdjugateTranspose</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;adjat)
<a name="l01869"></a>01869 {
<a name="l01870"></a>01870 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01871"></a>01871 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() || adjat.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != adjat.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() ||
<a name="l01872"></a>01872        a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() != adjat.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() || a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() &lt; 2 || a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() &gt; 3)
<a name="l01873"></a>01873       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::CalcAdjugateTranspose(...)&quot;</span>);
<a name="l01874"></a>01874 <span class="preprocessor">#endif</span>
<a name="l01875"></a>01875 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() == 2)
<a name="l01876"></a>01876    {
<a name="l01877"></a>01877       adjat(0,0) =  a(1,1);
<a name="l01878"></a>01878       adjat(1,0) = -a(0,1);
<a name="l01879"></a>01879       adjat(0,1) = -a(1,0);
<a name="l01880"></a>01880       adjat(1,1) =  a(0,0);
<a name="l01881"></a>01881    }
<a name="l01882"></a>01882    <span class="keywordflow">else</span>
<a name="l01883"></a>01883    {
<a name="l01884"></a>01884       adjat(0,0) = a(1,1)*a(2,2)-a(1,2)*a(2,1);
<a name="l01885"></a>01885       adjat(1,0) = a(0,2)*a(2,1)-a(0,1)*a(2,2);
<a name="l01886"></a>01886       adjat(2,0) = a(0,1)*a(1,2)-a(0,2)*a(1,1);
<a name="l01887"></a>01887 
<a name="l01888"></a>01888       adjat(0,1) = a(1,2)*a(2,0)-a(1,0)*a(2,2);
<a name="l01889"></a>01889       adjat(1,1) = a(0,0)*a(2,2)-a(0,2)*a(2,0);
<a name="l01890"></a>01890       adjat(2,1) = a(0,2)*a(1,0)-a(0,0)*a(1,2);
<a name="l01891"></a>01891 
<a name="l01892"></a>01892       adjat(0,2) = a(1,0)*a(2,1)-a(1,1)*a(2,0);
<a name="l01893"></a>01893       adjat(1,2) = a(0,1)*a(2,0)-a(0,0)*a(2,1);
<a name="l01894"></a>01894       adjat(2,2) = a(0,0)*a(1,1)-a(0,1)*a(1,0);
<a name="l01895"></a>01895    }
<a name="l01896"></a>01896 }
<a name="l01897"></a>01897 
<a name="l01898"></a><a class="code" href="densemat_8hpp.html#a09d751eab1fcea49b9ea5ef04ee9ab39">01898</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a09d751eab1fcea49b9ea5ef04ee9ab39">CalcInverse</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;inva)
<a name="l01899"></a>01899 {
<a name="l01900"></a>01900 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01901"></a>01901 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() &gt; a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() || a.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() &lt; 1 || a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() &gt; 3)
<a name="l01902"></a>01902       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::CalcInverse(...)&quot;</span>);
<a name="l01903"></a>01903 <span class="preprocessor">#endif</span>
<a name="l01904"></a>01904 <span class="preprocessor"></span>
<a name="l01905"></a>01905    <span class="keywordtype">double</span> t;
<a name="l01906"></a>01906 
<a name="l01907"></a>01907    <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() &lt; a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l01908"></a>01908    {
<a name="l01909"></a>01909       <span class="keyword">const</span> <span class="keywordtype">double</span> *d = a.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l01910"></a>01910       <span class="keywordtype">double</span> *<span class="keywordtype">id</span> = inva.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l01911"></a>01911       <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() == 2)
<a name="l01912"></a>01912       {
<a name="l01913"></a>01913          t = 1.0 / (d[0]*d[0] + d[1]*d[1]);
<a name="l01914"></a>01914          <span class="keywordtype">id</span>[0] = d[0] * t;
<a name="l01915"></a>01915          <span class="keywordtype">id</span>[1] = d[1] * t;
<a name="l01916"></a>01916       }
<a name="l01917"></a>01917       <span class="keywordflow">else</span>
<a name="l01918"></a>01918       {
<a name="l01919"></a>01919          <span class="keywordflow">if</span> (a.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() == 1)
<a name="l01920"></a>01920          {
<a name="l01921"></a>01921             t = 1.0 / (d[0]*d[0] + d[1]*d[1] + d[2]*d[2]);
<a name="l01922"></a>01922             <span class="keywordtype">id</span>[0] = d[0] * t;
<a name="l01923"></a>01923             <span class="keywordtype">id</span>[1] = d[1] * t;
<a name="l01924"></a>01924             <span class="keywordtype">id</span>[2] = d[2] * t;
<a name="l01925"></a>01925          }
<a name="l01926"></a>01926          <span class="keywordflow">else</span>
<a name="l01927"></a>01927          {
<a name="l01928"></a>01928             <span class="keywordtype">double</span> e, g, f;
<a name="l01929"></a>01929             e = d[0]*d[0] + d[1]*d[1] + d[2]*d[2];
<a name="l01930"></a>01930             g = d[3]*d[3] + d[4]*d[4] + d[5]*d[5];
<a name="l01931"></a>01931             f = d[0]*d[3] + d[1]*d[4] + d[2]*d[5];
<a name="l01932"></a>01932             t = 1.0 / (e*g - f*f);
<a name="l01933"></a>01933             e *= t; g *= t; f *= t;
<a name="l01934"></a>01934 
<a name="l01935"></a>01935             <span class="keywordtype">id</span>[0] = d[0]*g - d[3]*f;
<a name="l01936"></a>01936             <span class="keywordtype">id</span>[1] = d[3]*e - d[0]*f;
<a name="l01937"></a>01937             <span class="keywordtype">id</span>[2] = d[1]*g - d[4]*f;
<a name="l01938"></a>01938             <span class="keywordtype">id</span>[3] = d[4]*e - d[1]*f;
<a name="l01939"></a>01939             <span class="keywordtype">id</span>[4] = d[2]*g - d[5]*f;
<a name="l01940"></a>01940             <span class="keywordtype">id</span>[5] = d[5]*e - d[2]*f;
<a name="l01941"></a>01941          }
<a name="l01942"></a>01942       }
<a name="l01943"></a>01943       <span class="keywordflow">return</span>;
<a name="l01944"></a>01944    }
<a name="l01945"></a>01945 
<a name="l01946"></a>01946 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01947"></a>01947 <span class="preprocessor"></span>   t = a.<a class="code" href="classDenseMatrix.html#ac0f94a551ae3bc6d01ad6a39d323c31c" title="Calculates the determinant of the matrix (for 2x2 or 3x3 matrices)">Det</a>();
<a name="l01948"></a>01948    <span class="keywordflow">if</span> (fabs(t) &lt; 1.0e-12 * a.<a class="code" href="classDenseMatrix.html#ae77bd4a36c9ba5800654b3e3b78e6a09">FNorm</a>())
<a name="l01949"></a>01949       cerr &lt;&lt; <span class="stringliteral">&quot;DenseMatrix::CalcInverse(...) : singular matrix!&quot;</span>
<a name="l01950"></a>01950            &lt;&lt; endl;
<a name="l01951"></a>01951    t = 1. / t;
<a name="l01952"></a>01952 <span class="preprocessor">#else</span>
<a name="l01953"></a>01953 <span class="preprocessor"></span>   t = 1.0 / a.<a class="code" href="classDenseMatrix.html#ac0f94a551ae3bc6d01ad6a39d323c31c" title="Calculates the determinant of the matrix (for 2x2 or 3x3 matrices)">Det</a>();
<a name="l01954"></a>01954 <span class="preprocessor">#endif</span>
<a name="l01955"></a>01955 <span class="preprocessor"></span>
<a name="l01956"></a>01956    <span class="keywordflow">switch</span> (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l01957"></a>01957    {
<a name="l01958"></a>01958    <span class="keywordflow">case</span> 1:
<a name="l01959"></a>01959       inva(0,0) = t;
<a name="l01960"></a>01960       <span class="keywordflow">break</span>;
<a name="l01961"></a>01961    <span class="keywordflow">case</span> 2:
<a name="l01962"></a>01962       inva(0,0) = a(1,1) * t ;
<a name="l01963"></a>01963       inva(0,1) = -a(0,1) * t ;
<a name="l01964"></a>01964       inva(1,0) = -a(1,0) * t ;
<a name="l01965"></a>01965       inva(1,1) = a(0,0) * t ;
<a name="l01966"></a>01966       <span class="keywordflow">break</span>;
<a name="l01967"></a>01967    <span class="keywordflow">case</span> 3:
<a name="l01968"></a>01968       inva(0,0) = (a(1,1)*a(2,2)-a(1,2)*a(2,1))*t;
<a name="l01969"></a>01969       inva(0,1) = (a(0,2)*a(2,1)-a(0,1)*a(2,2))*t;
<a name="l01970"></a>01970       inva(0,2) = (a(0,1)*a(1,2)-a(0,2)*a(1,1))*t;
<a name="l01971"></a>01971 
<a name="l01972"></a>01972       inva(1,0) = (a(1,2)*a(2,0)-a(1,0)*a(2,2))*t;
<a name="l01973"></a>01973       inva(1,1) = (a(0,0)*a(2,2)-a(0,2)*a(2,0))*t;
<a name="l01974"></a>01974       inva(1,2) = (a(0,2)*a(1,0)-a(0,0)*a(1,2))*t;
<a name="l01975"></a>01975 
<a name="l01976"></a>01976       inva(2,0) = (a(1,0)*a(2,1)-a(1,1)*a(2,0))*t;
<a name="l01977"></a>01977       inva(2,1) = (a(0,1)*a(2,0)-a(0,0)*a(2,1))*t;
<a name="l01978"></a>01978       inva(2,2) = (a(0,0)*a(1,1)-a(0,1)*a(1,0))*t;
<a name="l01979"></a>01979       <span class="keywordflow">break</span>;
<a name="l01980"></a>01980    }
<a name="l01981"></a>01981 }
<a name="l01982"></a>01982 
<a name="l01983"></a><a class="code" href="densemat_8hpp.html#a277e0c290fb45d3053264c45f672619f">01983</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a277e0c290fb45d3053264c45f672619f" title="Calculate the inverse transpose of a matrix (for 2x2 or 3x3 matrices)">CalcInverseTranspose</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;inva)
<a name="l01984"></a>01984 {
<a name="l01985"></a>01985 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l01986"></a>01986 <span class="preprocessor"></span>   <span class="keywordflow">if</span> ( (a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() != a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>()) || ( (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>()!= 1) &amp;&amp; (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>()!= 2)
<a name="l01987"></a>01987                                       &amp;&amp; (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>()!= 3) ) )
<a name="l01988"></a>01988       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrix::CalcInverse(...)&quot;</span>);
<a name="l01989"></a>01989 <span class="preprocessor">#endif</span>
<a name="l01990"></a>01990 <span class="preprocessor"></span>
<a name="l01991"></a>01991    <span class="keywordtype">double</span> t = 1. / a.<a class="code" href="classDenseMatrix.html#ac0f94a551ae3bc6d01ad6a39d323c31c" title="Calculates the determinant of the matrix (for 2x2 or 3x3 matrices)">Det</a>() ;
<a name="l01992"></a>01992 
<a name="l01993"></a>01993    <span class="keywordflow">switch</span> (a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l01994"></a>01994    {
<a name="l01995"></a>01995    <span class="keywordflow">case</span> 1:
<a name="l01996"></a>01996       inva(0,0) = 1.0 / a(0,0);
<a name="l01997"></a>01997       <span class="keywordflow">break</span>;
<a name="l01998"></a>01998    <span class="keywordflow">case</span> 2:
<a name="l01999"></a>01999       inva(0,0) = a(1,1) * t ;
<a name="l02000"></a>02000       inva(1,0) = -a(0,1) * t ;
<a name="l02001"></a>02001       inva(0,1) = -a(1,0) * t ;
<a name="l02002"></a>02002       inva(1,1) = a(0,0) * t ;
<a name="l02003"></a>02003       <span class="keywordflow">break</span>;
<a name="l02004"></a>02004    <span class="keywordflow">case</span> 3:
<a name="l02005"></a>02005       inva(0,0) = (a(1,1)*a(2,2)-a(1,2)*a(2,1))*t;
<a name="l02006"></a>02006       inva(1,0) = (a(0,2)*a(2,1)-a(0,1)*a(2,2))*t;
<a name="l02007"></a>02007       inva(2,0) = (a(0,1)*a(1,2)-a(0,2)*a(1,1))*t;
<a name="l02008"></a>02008 
<a name="l02009"></a>02009       inva(0,1) = (a(1,2)*a(2,0)-a(1,0)*a(2,2))*t;
<a name="l02010"></a>02010       inva(1,1) = (a(0,0)*a(2,2)-a(0,2)*a(2,0))*t;
<a name="l02011"></a>02011       inva(2,1) = (a(0,2)*a(1,0)-a(0,0)*a(1,2))*t;
<a name="l02012"></a>02012 
<a name="l02013"></a>02013       inva(0,2) = (a(1,0)*a(2,1)-a(1,1)*a(2,0))*t;
<a name="l02014"></a>02014       inva(1,2) = (a(0,1)*a(2,0)-a(0,0)*a(2,1))*t;
<a name="l02015"></a>02015       inva(2,2) = (a(0,0)*a(1,1)-a(0,1)*a(1,0))*t;
<a name="l02016"></a>02016       <span class="keywordflow">break</span>;
<a name="l02017"></a>02017    }
<a name="l02018"></a>02018 }
<a name="l02019"></a>02019 
<a name="l02020"></a><a class="code" href="densemat_8hpp.html#ad60cedeb0e91cf718dcad6c96f803920">02020</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#ad60cedeb0e91cf718dcad6c96f803920" title="Calculate the matrix A.At.">MultAAt</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;a, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;aat)
<a name="l02021"></a>02021 {
<a name="l02022"></a>02022    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; a.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02023"></a>02023       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)
<a name="l02024"></a>02024       {
<a name="l02025"></a>02025          <span class="keywordtype">double</span> temp = 0.;
<a name="l02026"></a>02026          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; a.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); k++)
<a name="l02027"></a>02027             temp += a(i,k) * a(j,k);
<a name="l02028"></a>02028          aat(j,i) = aat(i,j) = temp;
<a name="l02029"></a>02029       }
<a name="l02030"></a>02030 }
<a name="l02031"></a>02031 
<a name="l02032"></a><a class="code" href="densemat_8hpp.html#a027b22c5067c2ae3c7f71659b344d73a">02032</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a027b22c5067c2ae3c7f71659b344d73a" title="ADAt += A D A^t, where D is diagonal.">AddMultADAt</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;D, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;ADAt)
<a name="l02033"></a>02033 {
<a name="l02034"></a>02034    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02035"></a>02035    {
<a name="l02036"></a>02036       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l02037"></a>02037       {
<a name="l02038"></a>02038          <span class="keywordtype">double</span> t = 0.;
<a name="l02039"></a>02039          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02040"></a>02040             t += D(k) * A(i, k) * A(j, k);
<a name="l02041"></a>02041          ADAt(i, j) += t;
<a name="l02042"></a>02042          ADAt(j, i) += t;
<a name="l02043"></a>02043       }
<a name="l02044"></a>02044    }
<a name="l02045"></a>02045 
<a name="l02046"></a>02046    <span class="comment">// process diagonal</span>
<a name="l02047"></a>02047    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02048"></a>02048    {
<a name="l02049"></a>02049       <span class="keywordtype">double</span> t = 0.;
<a name="l02050"></a>02050       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02051"></a>02051          t += D(k) * A(i, k) * A(i, k);
<a name="l02052"></a>02052       ADAt(i, i) += t;
<a name="l02053"></a>02053    }
<a name="l02054"></a>02054 }
<a name="l02055"></a>02055 
<a name="l02056"></a><a class="code" href="densemat_8hpp.html#a86579dfb3746ca81325b5004131503fd">02056</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a86579dfb3746ca81325b5004131503fd" title="ADAt = A D A^t, where D is diagonal.">MultADAt</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;D, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;ADAt)
<a name="l02057"></a>02057 {
<a name="l02058"></a>02058    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02059"></a>02059    {
<a name="l02060"></a>02060       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)
<a name="l02061"></a>02061       {
<a name="l02062"></a>02062          <span class="keywordtype">double</span> t = 0.;
<a name="l02063"></a>02063          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02064"></a>02064             t += D(k) * A(i, k) * A(j, k);
<a name="l02065"></a>02065          ADAt(j, i) = ADAt(i, j) = t;
<a name="l02066"></a>02066       }
<a name="l02067"></a>02067    }
<a name="l02068"></a>02068 }
<a name="l02069"></a>02069 
<a name="l02070"></a>02070 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02071"></a>02071 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span>
<a name="l02072"></a>02072 dgemm_(<span class="keywordtype">char</span> *, <span class="keywordtype">char</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">double</span> *,
<a name="l02073"></a>02073        <span class="keywordtype">int</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">int</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">double</span> *, <span class="keywordtype">int</span> *);
<a name="l02074"></a>02074 <span class="preprocessor">#endif</span>
<a name="l02075"></a>02075 <span class="preprocessor"></span>
<a name="l02076"></a><a class="code" href="densemat_8hpp.html#a3dc24d8ce5abb3ec8b6a55ff524cb0f5">02076</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a3dc24d8ce5abb3ec8b6a55ff524cb0f5" title="Multiply a matrix A with the transpose of a matrix B: A*Bt.">MultABt</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;B, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;ABt)
<a name="l02077"></a>02077 {
<a name="l02078"></a>02078 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02079"></a>02079 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != ABt.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() || B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != ABt.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() ||
<a name="l02080"></a>02080        A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != B.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>())
<a name="l02081"></a>02081       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;MultABt(...)&quot;</span>);
<a name="l02082"></a>02082 <span class="preprocessor">#endif</span>
<a name="l02083"></a>02083 <span class="preprocessor"></span>
<a name="l02084"></a>02084 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02085"></a>02085 <span class="preprocessor"></span>   <span class="keyword">static</span> <span class="keywordtype">char</span> transa = <span class="charliteral">&#39;N&#39;</span>, transb = <span class="charliteral">&#39;T&#39;</span>;
<a name="l02086"></a>02086    <span class="keyword">static</span> <span class="keywordtype">double</span> alpha = 1.0, beta = 0.0;
<a name="l02087"></a>02087    <span class="keywordtype">int</span> m = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(), n = B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(), k = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l02088"></a>02088 
<a name="l02089"></a>02089    dgemm_(&amp;transa, &amp;transb, &amp;m, &amp;n, &amp;k, &amp;alpha, A.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;m,
<a name="l02090"></a>02090           B.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;n, &amp;beta, ABt.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;m);
<a name="l02091"></a>02091 <span class="preprocessor">#elif 1</span>
<a name="l02092"></a>02092 <span class="preprocessor"></span>   <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> ah = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02093"></a>02093    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> bh = B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02094"></a>02094    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> aw = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l02095"></a>02095    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *ad = A.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02096"></a>02096    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *bd = B.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02097"></a>02097    <span class="keyword">register</span> <span class="keywordtype">double</span> *cd = ABt.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02098"></a>02098    <span class="keyword">register</span> <span class="keywordtype">double</span> *cp;
<a name="l02099"></a>02099 
<a name="l02100"></a>02100    cp = cd;
<a name="l02101"></a>02101    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0, s = ah*bh; i &lt; s; i++)
<a name="l02102"></a>02102       *(cp++) = 0.0;
<a name="l02103"></a>02103    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; aw; k++)
<a name="l02104"></a>02104    {
<a name="l02105"></a>02105       cp = cd;
<a name="l02106"></a>02106       <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; bh; j++)
<a name="l02107"></a>02107       {
<a name="l02108"></a>02108          <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> bjk = bd[j];
<a name="l02109"></a>02109          <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; ah; i++)
<a name="l02110"></a>02110          {
<a name="l02111"></a>02111             *(cp++) += ad[i] * bjk;
<a name="l02112"></a>02112          }
<a name="l02113"></a>02113       }
<a name="l02114"></a>02114       ad += ah;
<a name="l02115"></a>02115       bd += bh;
<a name="l02116"></a>02116    }
<a name="l02117"></a>02117 <span class="preprocessor">#elif 1</span>
<a name="l02118"></a>02118 <span class="preprocessor"></span>   <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> ah = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02119"></a>02119    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> bh = B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02120"></a>02120    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> aw = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l02121"></a>02121    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *ad = A.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02122"></a>02122    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *bd = B.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02123"></a>02123    <span class="keyword">register</span> <span class="keywordtype">double</span> *cd = ABt.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02124"></a>02124 
<a name="l02125"></a>02125    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; bh; j++)
<a name="l02126"></a>02126       <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; ah; i++)
<a name="l02127"></a>02127       {
<a name="l02128"></a>02128          <span class="keyword">register</span> <span class="keywordtype">double</span> d = 0.0;
<a name="l02129"></a>02129          <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *ap = ad + i;
<a name="l02130"></a>02130          <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *bp = bd + j;
<a name="l02131"></a>02131          <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; aw; k++)
<a name="l02132"></a>02132          {
<a name="l02133"></a>02133             d += (*ap) * (*bp);
<a name="l02134"></a>02134             ap += ah;
<a name="l02135"></a>02135             bp += bh;
<a name="l02136"></a>02136          }
<a name="l02137"></a>02137          *(cd++) = d;
<a name="l02138"></a>02138       }
<a name="l02139"></a>02139 <span class="preprocessor">#else</span>
<a name="l02140"></a>02140 <span class="preprocessor"></span>   <span class="keywordtype">int</span> i, j, k;
<a name="l02141"></a>02141    <span class="keywordtype">double</span> d;
<a name="l02142"></a>02142 
<a name="l02143"></a>02143    <span class="keywordflow">for</span> (i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02144"></a>02144       <span class="keywordflow">for</span> (j = 0; j &lt; B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); j++)
<a name="l02145"></a>02145       {
<a name="l02146"></a>02146          d = 0.0;
<a name="l02147"></a>02147          <span class="keywordflow">for</span> (k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02148"></a>02148             d += A(i, k) * B(j, k);
<a name="l02149"></a>02149          ABt(i, j) = d;
<a name="l02150"></a>02150       }
<a name="l02151"></a>02151 <span class="preprocessor">#endif</span>
<a name="l02152"></a>02152 <span class="preprocessor"></span>}
<a name="l02153"></a>02153 
<a name="l02154"></a><a class="code" href="densemat_8hpp.html#aad4bacb40bfbd4ed8dcf78d8370d44ea">02154</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#aad4bacb40bfbd4ed8dcf78d8370d44ea" title="ABt += A * B^t.">AddMultABt</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;B, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;ABt)
<a name="l02155"></a>02155 {
<a name="l02156"></a>02156    <span class="keywordtype">int</span> i, j, k;
<a name="l02157"></a>02157    <span class="keywordtype">double</span> d;
<a name="l02158"></a>02158 
<a name="l02159"></a>02159 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02160"></a>02160 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != ABt.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() || B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != ABt.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>())
<a name="l02161"></a>02161       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;AddMultABt(...)&quot;</span>);
<a name="l02162"></a>02162 <span class="preprocessor">#endif</span>
<a name="l02163"></a>02163 <span class="preprocessor"></span>
<a name="l02164"></a>02164    <span class="keywordflow">for</span> (i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02165"></a>02165       <span class="keywordflow">for</span> (j = 0; j &lt; B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); j++)
<a name="l02166"></a>02166       {
<a name="l02167"></a>02167          d = 0.0;
<a name="l02168"></a>02168          <span class="keywordflow">for</span> (k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02169"></a>02169             d += A(i, k) * B(j, k);
<a name="l02170"></a>02170          ABt(i, j) += d;
<a name="l02171"></a>02171       }
<a name="l02172"></a>02172 }
<a name="l02173"></a>02173 
<a name="l02174"></a><a class="code" href="densemat_8hpp.html#ab5e9af25642e02de2f742fb7f364ae90">02174</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#ab5e9af25642e02de2f742fb7f364ae90" title="Multiply the transpose of a matrix A with a matrix B: At*B.">MultAtB</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;B, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;AtB)
<a name="l02175"></a>02175 {
<a name="l02176"></a>02176 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02177"></a>02177 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != AtB.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() || B.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != AtB.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() ||
<a name="l02178"></a>02178        A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != B.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>())
<a name="l02179"></a>02179       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;MultAtB(...)&quot;</span>);
<a name="l02180"></a>02180 <span class="preprocessor">#endif</span>
<a name="l02181"></a>02181 <span class="preprocessor"></span>
<a name="l02182"></a>02182 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02183"></a>02183 <span class="preprocessor"></span>   <span class="keyword">static</span> <span class="keywordtype">char</span> transa = <span class="charliteral">&#39;T&#39;</span>, transb = <span class="charliteral">&#39;N&#39;</span>;
<a name="l02184"></a>02184    <span class="keyword">static</span> <span class="keywordtype">double</span> alpha = 1.0, beta = 0.0;
<a name="l02185"></a>02185    <span class="keywordtype">int</span> m = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(), n = B.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(), k = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02186"></a>02186 
<a name="l02187"></a>02187    dgemm_(&amp;transa, &amp;transb, &amp;m, &amp;n, &amp;k, &amp;alpha, A.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;k,
<a name="l02188"></a>02188           B.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;k, &amp;beta, AtB.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;m);
<a name="l02189"></a>02189 <span class="preprocessor">#elif 1</span>
<a name="l02190"></a>02190 <span class="preprocessor"></span>   <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> ah = A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02191"></a>02191    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> aw = A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l02192"></a>02192    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">int</span> bw = B.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l02193"></a>02193    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *ad = A.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02194"></a>02194    <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *bd = B.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02195"></a>02195    <span class="keyword">register</span> <span class="keywordtype">double</span> *cd = AtB.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>();
<a name="l02196"></a>02196 
<a name="l02197"></a>02197    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; bw; j++)
<a name="l02198"></a>02198    {
<a name="l02199"></a>02199       <span class="keyword">register</span> <span class="keyword">const</span> <span class="keywordtype">double</span> *ap = ad;
<a name="l02200"></a>02200       <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; aw; i++)
<a name="l02201"></a>02201       {
<a name="l02202"></a>02202          <span class="keyword">register</span> <span class="keywordtype">double</span> d = 0.0;
<a name="l02203"></a>02203          <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; ah; k++)
<a name="l02204"></a>02204          {
<a name="l02205"></a>02205             d += *(ap++) * bd[k];
<a name="l02206"></a>02206          }
<a name="l02207"></a>02207          *(cd++) = d;
<a name="l02208"></a>02208       }
<a name="l02209"></a>02209       bd += ah;
<a name="l02210"></a>02210    }
<a name="l02211"></a>02211 <span class="preprocessor">#else</span>
<a name="l02212"></a>02212 <span class="preprocessor"></span>   <span class="keywordtype">int</span> i, j, k;
<a name="l02213"></a>02213    <span class="keywordtype">double</span> d;
<a name="l02214"></a>02214 
<a name="l02215"></a>02215    <span class="keywordflow">for</span> (i = 0; i &lt; A.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); i++)
<a name="l02216"></a>02216       <span class="keywordflow">for</span> (j = 0; j &lt; B.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>(); j++)
<a name="l02217"></a>02217       {
<a name="l02218"></a>02218          d = 0.0;
<a name="l02219"></a>02219          <span class="keywordflow">for</span> (k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); k++)
<a name="l02220"></a>02220             d += A(k, i) * B(k, j);
<a name="l02221"></a>02221          AtB(i, j) = d;
<a name="l02222"></a>02222       }
<a name="l02223"></a>02223 <span class="preprocessor">#endif</span>
<a name="l02224"></a>02224 <span class="preprocessor"></span>}
<a name="l02225"></a>02225 
<a name="l02226"></a><a class="code" href="densemat_8hpp.html#a13773d3c31a8e06bda3d59bd9b7f99fc">02226</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a13773d3c31a8e06bda3d59bd9b7f99fc" title="AAt += a * A * A^t.">AddMult_a_AAt</a>(<span class="keywordtype">double</span> a, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;AAt)
<a name="l02227"></a>02227 {
<a name="l02228"></a>02228    <span class="keywordtype">double</span> d;
<a name="l02229"></a>02229 
<a name="l02230"></a>02230    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02231"></a>02231    {
<a name="l02232"></a>02232       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l02233"></a>02233       {
<a name="l02234"></a>02234          d = 0.;
<a name="l02235"></a>02235          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02236"></a>02236             d += A(i,k) * A(j,k);
<a name="l02237"></a>02237          AAt(i, j) += (d *= a);
<a name="l02238"></a>02238          AAt(j, i) += d;
<a name="l02239"></a>02239       }
<a name="l02240"></a>02240       d = 0.;
<a name="l02241"></a>02241       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02242"></a>02242          d += A(i,k) * A(i,k);
<a name="l02243"></a>02243       AAt(i, i) += a * d;
<a name="l02244"></a>02244    }
<a name="l02245"></a>02245 }
<a name="l02246"></a>02246 
<a name="l02247"></a><a class="code" href="densemat_8hpp.html#ab71985675dbd3f7b1598dc7e4198d1a2">02247</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#ab71985675dbd3f7b1598dc7e4198d1a2" title="AAt = a * A * A^t.">Mult_a_AAt</a>(<span class="keywordtype">double</span> a, <span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;A, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;AAt)
<a name="l02248"></a>02248 {
<a name="l02249"></a>02249    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; A.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>(); i++)
<a name="l02250"></a>02250       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)
<a name="l02251"></a>02251       {
<a name="l02252"></a>02252          <span class="keywordtype">double</span> d = 0.;
<a name="l02253"></a>02253          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; A.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>(); k++)
<a name="l02254"></a>02254             d += A(i,k) * A(j,k);
<a name="l02255"></a>02255          AAt(i, j) = AAt(j, i) = a * d;
<a name="l02256"></a>02256       }
<a name="l02257"></a>02257 }
<a name="l02258"></a>02258 
<a name="l02259"></a><a class="code" href="densemat_8hpp.html#a4c6dffb3b62d5d9843e142375f2af40e">02259</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a4c6dffb3b62d5d9843e142375f2af40e" title="Make a matrix from a vector V.Vt.">MultVVt</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;v, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;vvt)
<a name="l02260"></a>02260 {
<a name="l02261"></a>02261    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; v.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>(); i++)
<a name="l02262"></a>02262       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt;= i; j++)
<a name="l02263"></a>02263       {
<a name="l02264"></a>02264          vvt(i,j) = vvt(j,i) = v(i) * v(j);
<a name="l02265"></a>02265       }
<a name="l02266"></a>02266 }
<a name="l02267"></a>02267 
<a name="l02268"></a><a class="code" href="densemat_8hpp.html#ab8d01bf39a678567c9f74987a9c2d1e4">02268</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#ab8d01bf39a678567c9f74987a9c2d1e4">MultVWt</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;v, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;w, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;VWt)
<a name="l02269"></a>02269 {
<a name="l02270"></a>02270    <span class="keywordtype">int</span> i, j;
<a name="l02271"></a>02271    <span class="keywordtype">double</span> vi;
<a name="l02272"></a>02272 
<a name="l02273"></a>02273 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02274"></a>02274 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (v.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() != VWt.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() || w.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>() != VWt.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>())
<a name="l02275"></a>02275       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;MultVWt(...)&quot;</span>);
<a name="l02276"></a>02276 <span class="preprocessor">#endif</span>
<a name="l02277"></a>02277 <span class="preprocessor"></span>
<a name="l02278"></a>02278    <span class="keywordflow">for</span> (i = 0; i &lt; v.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>(); i++)
<a name="l02279"></a>02279    {
<a name="l02280"></a>02280       vi = v(i);
<a name="l02281"></a>02281       <span class="keywordflow">for</span> (j = 0; j &lt; w.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>(); j++)
<a name="l02282"></a>02282          VWt(i, j) = vi * w(j);
<a name="l02283"></a>02283    }
<a name="l02284"></a>02284 }
<a name="l02285"></a>02285 
<a name="l02286"></a><a class="code" href="densemat_8hpp.html#a6aefbeb6382656ee29a30cba50f49c98">02286</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a6aefbeb6382656ee29a30cba50f49c98" title="VWt += v w^t.">AddMultVWt</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;v, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;w, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;VWt)
<a name="l02287"></a>02287 {
<a name="l02288"></a>02288    <span class="keywordtype">int</span> m = v.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>(), n = w.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>();
<a name="l02289"></a>02289 
<a name="l02290"></a>02290 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02291"></a>02291 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (VWt.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != m || VWt.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != n)
<a name="l02292"></a>02292       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;AddMultVWt(...)&quot;</span>);
<a name="l02293"></a>02293 <span class="preprocessor">#endif</span>
<a name="l02294"></a>02294 <span class="preprocessor"></span>
<a name="l02295"></a>02295    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; m; i++)
<a name="l02296"></a>02296    {
<a name="l02297"></a>02297       <span class="keywordtype">double</span> vi = v(i);
<a name="l02298"></a>02298       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n; j++)
<a name="l02299"></a>02299          VWt(i, j) += vi * w(j);
<a name="l02300"></a>02300    }
<a name="l02301"></a>02301 }
<a name="l02302"></a>02302 
<a name="l02303"></a><a class="code" href="densemat_8hpp.html#a02b56736b87727ace4a864bcd12b6b28">02303</a> <span class="keywordtype">void</span> <a class="code" href="densemat_8cpp.html#a02b56736b87727ace4a864bcd12b6b28" title="VVt += a * v v^t.">AddMult_a_VVt</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> a, <span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;v, <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;VVt)
<a name="l02304"></a>02304 {
<a name="l02305"></a>02305    <span class="keywordtype">int</span> n = v.<a class="code" href="classVector.html#ab0f88720c5589e49c8d84b26ff8640a1" title="Returns the size of the vector.">Size</a>();
<a name="l02306"></a>02306 
<a name="l02307"></a>02307 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02308"></a>02308 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (VVt.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != n || VVt.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != n)
<a name="l02309"></a>02309       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;AddMult_a_VVt(...)&quot;</span>);
<a name="l02310"></a>02310 <span class="preprocessor">#endif</span>
<a name="l02311"></a>02311 <span class="preprocessor"></span>
<a name="l02312"></a>02312    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++)
<a name="l02313"></a>02313    {
<a name="l02314"></a>02314       <span class="keywordtype">double</span> avi = a * v(i);
<a name="l02315"></a>02315       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; i; j++)
<a name="l02316"></a>02316       {
<a name="l02317"></a>02317          <span class="keywordtype">double</span> avivj = avi * v(j);
<a name="l02318"></a>02318          VVt(i, j) += avivj;
<a name="l02319"></a>02319          VVt(j, i) += avivj;
<a name="l02320"></a>02320       }
<a name="l02321"></a>02321       VVt(i, i) += avi * v(i);
<a name="l02322"></a>02322    }
<a name="l02323"></a>02323 }
<a name="l02324"></a>02324 
<a name="l02325"></a>02325 
<a name="l02326"></a><a class="code" href="classDenseMatrixInverse.html#a506acfec2a640580350e5b0b94ba0494">02326</a> <a class="code" href="classDenseMatrixInverse.html#a506acfec2a640580350e5b0b94ba0494">DenseMatrixInverse::DenseMatrixInverse</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;mat)
<a name="l02327"></a>02327    : <a class="code" href="classMatrixInverse.html" title="Abstract data type for matrix inverse.">MatrixInverse</a>(mat)
<a name="l02328"></a>02328 {
<a name="l02329"></a>02329    <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>*<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>];
<a name="l02330"></a>02330 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02331"></a>02331 <span class="preprocessor"></span>   ipiv = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>];
<a name="l02332"></a>02332 <span class="preprocessor">#endif</span>
<a name="l02333"></a>02333 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrixInverse.html#a6f16213ac013ce62a2d554684f201bfb" title="Factor the current DenseMatrix, *a.">Factor</a>();
<a name="l02334"></a>02334 }
<a name="l02335"></a>02335 
<a name="l02336"></a><a class="code" href="classDenseMatrixInverse.html#ab9c90f4056a6b301f16d07d96191d4a0">02336</a> <a class="code" href="classDenseMatrixInverse.html#a506acfec2a640580350e5b0b94ba0494">DenseMatrixInverse::DenseMatrixInverse</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> *mat)
<a name="l02337"></a>02337    : <a class="code" href="classMatrixInverse.html" title="Abstract data type for matrix inverse.">MatrixInverse</a>(*mat)
<a name="l02338"></a>02338 {
<a name="l02339"></a>02339    <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>*<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>];
<a name="l02340"></a>02340 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02341"></a>02341 <span class="preprocessor"></span>   ipiv = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>];
<a name="l02342"></a>02342 <span class="preprocessor">#endif</span>
<a name="l02343"></a>02343 <span class="preprocessor"></span>}
<a name="l02344"></a>02344 
<a name="l02345"></a><a class="code" href="classDenseMatrixInverse.html#a6f16213ac013ce62a2d554684f201bfb">02345</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrixInverse.html#a6f16213ac013ce62a2d554684f201bfb" title="Factor the current DenseMatrix, *a.">DenseMatrixInverse::Factor</a>()
<a name="l02346"></a>02346 {
<a name="l02347"></a>02347    <span class="keyword">const</span> <span class="keywordtype">double</span> *adata = ((<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> *)<a class="code" href="classMatrixInverse.html#a10913d3ede19d2948a310c05adc26b25">a</a>)-&gt;data;
<a name="l02348"></a>02348 
<a name="l02349"></a>02349 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02350"></a>02350 <span class="preprocessor"></span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>*<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; i++)
<a name="l02351"></a>02351       <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i] = adata[i];
<a name="l02352"></a>02352 
<a name="l02353"></a>02353    <span class="keywordtype">int</span> info;
<a name="l02354"></a>02354    dgetrf_(&amp;size, &amp;size, <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>, &amp;size, ipiv, &amp;info);
<a name="l02355"></a>02355 
<a name="l02356"></a>02356    <span class="keywordflow">if</span> (info)
<a name="l02357"></a>02357       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixInverse::Factor : Error in DGETRF&quot;</span>);
<a name="l02358"></a>02358 <span class="preprocessor">#else</span>
<a name="l02359"></a>02359 <span class="preprocessor"></span>   <span class="comment">// compiling without LAPACK</span>
<a name="l02360"></a>02360    <span class="keywordtype">int</span> i, j, k;
<a name="l02361"></a>02361 
<a name="l02362"></a>02362    <span class="comment">// perform LU factorization.</span>
<a name="l02363"></a>02363    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; i++)
<a name="l02364"></a>02364    {
<a name="l02365"></a>02365 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02366"></a>02366 <span class="preprocessor"></span>      <span class="keywordflow">if</span> (i &gt; 0 &amp;&amp; <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i-1+size*(i-1)] == 0.0)
<a name="l02367"></a>02367          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixInverse::Factor()&quot;</span>);
<a name="l02368"></a>02368 <span class="preprocessor">#endif</span>
<a name="l02369"></a>02369 <span class="preprocessor"></span>      <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)
<a name="l02370"></a>02370       {
<a name="l02371"></a>02371          <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] = adata[i+size*j];
<a name="l02372"></a>02372          <span class="keywordflow">for</span> (k = 0; k &lt; j; k++)
<a name="l02373"></a>02373             <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] -= <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*k] * <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[k+size*j];
<a name="l02374"></a>02374          <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] /= <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[j+size*j];
<a name="l02375"></a>02375       }
<a name="l02376"></a>02376 
<a name="l02377"></a>02377       <span class="keywordflow">for</span> (j = i; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l02378"></a>02378       {
<a name="l02379"></a>02379          <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] = adata[i+size*j];
<a name="l02380"></a>02380          <span class="keywordflow">for</span> (k = 0; k &lt; i; k++)
<a name="l02381"></a>02381             <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] -= <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*k] * <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[k+size*j];
<a name="l02382"></a>02382       }
<a name="l02383"></a>02383    }
<a name="l02384"></a>02384 <span class="preprocessor">#endif</span>
<a name="l02385"></a>02385 <span class="preprocessor"></span>}
<a name="l02386"></a>02386 
<a name="l02387"></a><a class="code" href="classDenseMatrixInverse.html#a811f5758c1b7abb47b953c8f8f3359c7">02387</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrixInverse.html#a6f16213ac013ce62a2d554684f201bfb" title="Factor the current DenseMatrix, *a.">DenseMatrixInverse::Factor</a>(<span class="keyword">const</span> <a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;mat)
<a name="l02388"></a>02388 {
<a name="l02389"></a>02389 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02390"></a>02390 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (mat.<a class="code" href="classDenseMatrix.html#a3f0992eda0283d43426308ed3d4258e6">height</a> != mat.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>)
<a name="l02391"></a>02391       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixInverse::Factor #1&quot;</span>);
<a name="l02392"></a>02392    <span class="keywordflow">if</span> (<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a> != mat.<a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>)
<a name="l02393"></a>02393       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixInverse::Factor #2&quot;</span>);
<a name="l02394"></a>02394 <span class="preprocessor">#endif</span>
<a name="l02395"></a>02395 <span class="preprocessor"></span>   <a class="code" href="classMatrixInverse.html#a10913d3ede19d2948a310c05adc26b25">a</a> = &amp;mat;
<a name="l02396"></a>02396 
<a name="l02397"></a>02397    <a class="code" href="classDenseMatrixInverse.html#a6f16213ac013ce62a2d554684f201bfb" title="Factor the current DenseMatrix, *a.">Factor</a>();
<a name="l02398"></a>02398 }
<a name="l02399"></a>02399 
<a name="l02400"></a><a class="code" href="classDenseMatrixInverse.html#af7233c21d3a6d75ce9c5a23f4b5ef86b">02400</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrixInverse.html#af7233c21d3a6d75ce9c5a23f4b5ef86b" title="Matrix vector multiplication with inverse of dense matrix.">DenseMatrixInverse::Mult</a>(<span class="keyword">const</span> <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;x, <a class="code" href="classVector.html" title="Vector data type.">Vector</a> &amp;y)<span class="keyword"> const</span>
<a name="l02401"></a>02401 <span class="keyword"></span>{
<a name="l02402"></a>02402 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02403"></a>02403 <span class="preprocessor"></span>   <span class="keywordtype">char</span> trans = <span class="charliteral">&#39;N&#39;</span>;
<a name="l02404"></a>02404    <span class="keywordtype">int</span>  n     = <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>;
<a name="l02405"></a>02405    <span class="keywordtype">int</span>  nrhs  = 1;
<a name="l02406"></a>02406    <span class="keywordtype">int</span>  info;
<a name="l02407"></a>02407    y = x;
<a name="l02408"></a>02408    dgetrs_(&amp;trans, &amp;n, &amp;nrhs, <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>, &amp;n, ipiv, y.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(), &amp;n, &amp;info);
<a name="l02409"></a>02409 
<a name="l02410"></a>02410    <span class="keywordflow">if</span> (info)
<a name="l02411"></a>02411       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixInverse::Mult #1&quot;</span>);
<a name="l02412"></a>02412 <span class="preprocessor">#else</span>
<a name="l02413"></a>02413 <span class="preprocessor"></span>   <span class="comment">// compiling without LAPACK</span>
<a name="l02414"></a>02414    <span class="keywordtype">int</span> i, j;
<a name="l02415"></a>02415 
<a name="l02416"></a>02416    <span class="comment">// y &lt;- L^{-1} x</span>
<a name="l02417"></a>02417    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; i++)
<a name="l02418"></a>02418    {
<a name="l02419"></a>02419       y(i) = x(i);
<a name="l02420"></a>02420       <span class="keywordflow">for</span> (j = 0; j &lt; i; j++)
<a name="l02421"></a>02421          y(i) -= <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] * y(j);
<a name="l02422"></a>02422    }
<a name="l02423"></a>02423 
<a name="l02424"></a>02424    <span class="comment">// y &lt;- U^{-1} y</span>
<a name="l02425"></a>02425    <span class="keywordflow">for</span> (i = size-1; i &gt;= 0; i--)
<a name="l02426"></a>02426    {
<a name="l02427"></a>02427       <span class="keywordflow">for</span> (j = i+1; j &lt; <a class="code" href="classOperator.html#a1d380eda81675507b282a09a20a74b34">size</a>; j++)
<a name="l02428"></a>02428          y(i) -= <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*j] * y(j);
<a name="l02429"></a>02429 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02430"></a>02430 <span class="preprocessor"></span>      <span class="keywordflow">if</span> ((<a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*i]) == 0.0)
<a name="l02431"></a>02431          <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixInverse::Mult #2&quot;</span>);
<a name="l02432"></a>02432 <span class="preprocessor">#endif</span>
<a name="l02433"></a>02433 <span class="preprocessor"></span>      y(i) /= <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>[i+size*i];
<a name="l02434"></a>02434    }
<a name="l02435"></a>02435 <span class="preprocessor">#endif</span>
<a name="l02436"></a>02436 <span class="preprocessor"></span>}
<a name="l02437"></a>02437 
<a name="l02438"></a><a class="code" href="classDenseMatrixInverse.html#a0cab926657028ad0f4a0d9fe8eeba79f">02438</a> <a class="code" href="classDenseMatrixInverse.html#a0cab926657028ad0f4a0d9fe8eeba79f" title="Destroys dense inverse matrix.">DenseMatrixInverse::~DenseMatrixInverse</a>()
<a name="l02439"></a>02439 {
<a name="l02440"></a>02440    <span class="keyword">delete</span> [] <a class="code" href="classDenseMatrixInverse.html#a9c08986fb08ab635725cd8da36632db7">data</a>;
<a name="l02441"></a>02441 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02442"></a>02442 <span class="preprocessor"></span>   <span class="keyword">delete</span> [] ipiv;
<a name="l02443"></a>02443 <span class="preprocessor">#endif</span>
<a name="l02444"></a>02444 <span class="preprocessor"></span>}
<a name="l02445"></a>02445 
<a name="l02446"></a>02446 
<a name="l02447"></a><a class="code" href="classDenseMatrixEigensystem.html#aff1f1cd29562ab21f15a3fdb52b9c76b">02447</a> <a class="code" href="classDenseMatrixEigensystem.html#aff1f1cd29562ab21f15a3fdb52b9c76b">DenseMatrixEigensystem::DenseMatrixEigensystem</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;m)
<a name="l02448"></a>02448    : mat(m)
<a name="l02449"></a>02449 {
<a name="l02450"></a>02450    <a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a> = m.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>();
<a name="l02451"></a>02451    <a class="code" href="classDenseMatrixEigensystem.html#a6f1662ec292d9098f6d07fc6c6cfd7bb">EVal</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(<a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>);
<a name="l02452"></a>02452    <a class="code" href="classDenseMatrixEigensystem.html#a38794816577e2be7a938c625f622cd6d">EVect</a>.<a class="code" href="classDenseMatrix.html#a0c8c43b9645a20eaf034cc208ae4c610" title="If the matrix is not a square matrix of size s then recreate it.">SetSize</a>(<a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>);
<a name="l02453"></a>02453    <a class="code" href="classDenseMatrixEigensystem.html#a59b4f07584c7de34ed196312c57e3c4b">ev</a>.<a class="code" href="classVector.html#a35f720a71ee87fb26053c9b02f280d20">SetDataAndSize</a>(NULL, <a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>);
<a name="l02454"></a>02454    <a class="code" href="classDenseMatrixEigensystem.html#a7b4140328bc1462962130347bbbacc0e">jobz</a> = <span class="charliteral">&#39;V&#39;</span>;
<a name="l02455"></a>02455    <a class="code" href="classDenseMatrixEigensystem.html#a9684f446052303ba821e5e8e3ba41447">uplo</a> = <span class="charliteral">&#39;U&#39;</span>;
<a name="l02456"></a>02456 
<a name="l02457"></a>02457 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02458"></a>02458 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrixEigensystem.html#a14c7f3da4138cba2975f1bd15eae7ccd">lwork</a> = -1;
<a name="l02459"></a>02459    <span class="keywordtype">double</span> qwork;
<a name="l02460"></a>02460    dsyev_(&amp;<a class="code" href="classDenseMatrixEigensystem.html#a7b4140328bc1462962130347bbbacc0e">jobz</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a9684f446052303ba821e5e8e3ba41447">uplo</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>, <a class="code" href="classDenseMatrixEigensystem.html#a38794816577e2be7a938c625f622cd6d">EVect</a>.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;<a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>, <a class="code" href="classDenseMatrixEigensystem.html#a6f1662ec292d9098f6d07fc6c6cfd7bb">EVal</a>.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l02461"></a>02461           &amp;qwork, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a14c7f3da4138cba2975f1bd15eae7ccd">lwork</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a373b7adba22b993b6ddabef4af4bc2f7">info</a>);
<a name="l02462"></a>02462 
<a name="l02463"></a>02463    lwork = (int) qwork;
<a name="l02464"></a>02464    <a class="code" href="classDenseMatrixEigensystem.html#af5c54ffbf809a174b54b993aa51b3cc4">work</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classDenseMatrixEigensystem.html#a14c7f3da4138cba2975f1bd15eae7ccd">lwork</a>];
<a name="l02465"></a>02465 <span class="preprocessor">#endif</span>
<a name="l02466"></a>02466 <span class="preprocessor"></span>}
<a name="l02467"></a>02467 
<a name="l02468"></a><a class="code" href="classDenseMatrixEigensystem.html#a2f2614e37bbb87757e75214a679dc1f7">02468</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrixEigensystem.html#a2f2614e37bbb87757e75214a679dc1f7">DenseMatrixEigensystem::Eval</a>()
<a name="l02469"></a>02469 {
<a name="l02470"></a>02470 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02471"></a>02471 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrixEigensystem.html#a85ee98b6639af08d9ae85857410f7e90">mat</a>.<a class="code" href="classOperator.html#a27f7c4dfac134bd5f57055d43eaa025f" title="Returns the size of the input.">Size</a>() != <a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>)
<a name="l02472"></a>02472       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixEigensystem::Eval()&quot;</span>);
<a name="l02473"></a>02473 <span class="preprocessor">#endif</span>
<a name="l02474"></a>02474 <span class="preprocessor"></span>
<a name="l02475"></a>02475 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02476"></a>02476 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrixEigensystem.html#a38794816577e2be7a938c625f622cd6d">EVect</a> = <a class="code" href="classDenseMatrixEigensystem.html#a85ee98b6639af08d9ae85857410f7e90">mat</a>;
<a name="l02477"></a>02477    dsyev_(&amp;<a class="code" href="classDenseMatrixEigensystem.html#a7b4140328bc1462962130347bbbacc0e">jobz</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a9684f446052303ba821e5e8e3ba41447">uplo</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>, <a class="code" href="classDenseMatrixEigensystem.html#a38794816577e2be7a938c625f622cd6d">EVect</a>.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;<a class="code" href="classDenseMatrixEigensystem.html#a41e0f4f8c82ca0e73f981dbd8c87f9f2">n</a>, <a class="code" href="classDenseMatrixEigensystem.html#a6f1662ec292d9098f6d07fc6c6cfd7bb">EVal</a>.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(),
<a name="l02478"></a>02478           <a class="code" href="classDenseMatrixEigensystem.html#af5c54ffbf809a174b54b993aa51b3cc4">work</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a14c7f3da4138cba2975f1bd15eae7ccd">lwork</a>, &amp;<a class="code" href="classDenseMatrixEigensystem.html#a373b7adba22b993b6ddabef4af4bc2f7">info</a>);
<a name="l02479"></a>02479 
<a name="l02480"></a>02480    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrixEigensystem.html#a373b7adba22b993b6ddabef4af4bc2f7">info</a> != 0)
<a name="l02481"></a>02481    {
<a name="l02482"></a>02482       cerr &lt;&lt; <span class="stringliteral">&quot;DenseMatrixEigensystem::Eval(): DSYEV error code: &quot;</span>
<a name="l02483"></a>02483            &lt;&lt; <a class="code" href="classDenseMatrixEigensystem.html#a373b7adba22b993b6ddabef4af4bc2f7">info</a> &lt;&lt; endl;
<a name="l02484"></a>02484       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l02485"></a>02485    }
<a name="l02486"></a>02486 <span class="preprocessor">#else</span>
<a name="l02487"></a>02487 <span class="preprocessor"></span>   <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixEigensystem::Eval(): Compiled without LAPACK&quot;</span>);
<a name="l02488"></a>02488 <span class="preprocessor">#endif</span>
<a name="l02489"></a>02489 <span class="preprocessor"></span>}
<a name="l02490"></a>02490 
<a name="l02491"></a><a class="code" href="classDenseMatrixEigensystem.html#a4af23daac3825a4f36d198058401eadf">02491</a> <a class="code" href="classDenseMatrixEigensystem.html#a4af23daac3825a4f36d198058401eadf">DenseMatrixEigensystem::~DenseMatrixEigensystem</a>()
<a name="l02492"></a>02492 {
<a name="l02493"></a>02493    <span class="keyword">delete</span> [] <a class="code" href="classDenseMatrixEigensystem.html#af5c54ffbf809a174b54b993aa51b3cc4">work</a>;
<a name="l02494"></a>02494 }
<a name="l02495"></a>02495 
<a name="l02496"></a>02496 
<a name="l02497"></a><a class="code" href="classDenseMatrixSVD.html#a524f7c5118cd40f07a6f0d649052b188">02497</a> <a class="code" href="classDenseMatrixSVD.html#a524f7c5118cd40f07a6f0d649052b188">DenseMatrixSVD::DenseMatrixSVD</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;M)
<a name="l02498"></a>02498 {
<a name="l02499"></a>02499    <a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a> = M.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>();
<a name="l02500"></a>02500    <a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a> = M.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>();
<a name="l02501"></a>02501    <a class="code" href="classDenseMatrixSVD.html#a0a6649f7ad8b01b40f7b0d62a13e85b8">Init</a>();
<a name="l02502"></a>02502 }
<a name="l02503"></a>02503 
<a name="l02504"></a><a class="code" href="classDenseMatrixSVD.html#aae0a5f23fc5bde7e81540848ee07143a">02504</a> <a class="code" href="classDenseMatrixSVD.html#a524f7c5118cd40f07a6f0d649052b188">DenseMatrixSVD::DenseMatrixSVD</a>(<span class="keywordtype">int</span> h, <span class="keywordtype">int</span> w)
<a name="l02505"></a>02505 {
<a name="l02506"></a>02506    <a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a> = h;
<a name="l02507"></a>02507    <a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a> = w;
<a name="l02508"></a>02508    <a class="code" href="classDenseMatrixSVD.html#a0a6649f7ad8b01b40f7b0d62a13e85b8">Init</a>();
<a name="l02509"></a>02509 }
<a name="l02510"></a>02510 
<a name="l02511"></a><a class="code" href="classDenseMatrixSVD.html#a0a6649f7ad8b01b40f7b0d62a13e85b8">02511</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrixSVD.html#a0a6649f7ad8b01b40f7b0d62a13e85b8">DenseMatrixSVD::Init</a>()
<a name="l02512"></a>02512 {
<a name="l02513"></a>02513 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02514"></a>02514 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrixSVD.html#ab9f913ae976aa5cc5281ea40092134cf">sv</a>.<a class="code" href="classVector.html#a195961c95085ba0db54ebddbedf0412a" title="Resizes the vector if the new size is different.">SetSize</a>(min(<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>, <a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a>));
<a name="l02515"></a>02515 
<a name="l02516"></a>02516    <a class="code" href="classDenseMatrixSVD.html#a8b59916d6d9a14cb7940519134b7669a">jobu</a>  = <span class="charliteral">&#39;N&#39;</span>;
<a name="l02517"></a>02517    <a class="code" href="classDenseMatrixSVD.html#acb8b57067014b1d535ee7bfc4b7e11d7">jobvt</a> = <span class="charliteral">&#39;N&#39;</span>;
<a name="l02518"></a>02518 
<a name="l02519"></a>02519    <span class="keywordtype">double</span> qwork;
<a name="l02520"></a>02520    <a class="code" href="classDenseMatrixSVD.html#add0192e0880b875c1c42982a9e2b3786">lwork</a> = -1;
<a name="l02521"></a>02521    dgesvd_(&amp;<a class="code" href="classDenseMatrixSVD.html#a8b59916d6d9a14cb7940519134b7669a">jobu</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#acb8b57067014b1d535ee7bfc4b7e11d7">jobvt</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a>, NULL, &amp;<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>, <a class="code" href="classDenseMatrixSVD.html#ab9f913ae976aa5cc5281ea40092134cf">sv</a>.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(), NULL, &amp;<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>,
<a name="l02522"></a>02522            NULL, &amp;<a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a>, &amp;qwork, &amp;<a class="code" href="classDenseMatrixSVD.html#add0192e0880b875c1c42982a9e2b3786">lwork</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#a8d4958eb24d08b7883b6b52d2c4e6857">info</a>);
<a name="l02523"></a>02523 
<a name="l02524"></a>02524    lwork = (int) qwork;
<a name="l02525"></a>02525    <a class="code" href="classDenseMatrixSVD.html#acc774d923ba140441d583c37e371898e">work</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classDenseMatrixSVD.html#add0192e0880b875c1c42982a9e2b3786">lwork</a>];
<a name="l02526"></a>02526 <span class="preprocessor">#else</span>
<a name="l02527"></a>02527 <span class="preprocessor"></span>   <a class="code" href="classDenseMatrixSVD.html#acc774d923ba140441d583c37e371898e">work</a> = NULL;
<a name="l02528"></a>02528    <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixSVD::Init(): Compiled without LAPACK&quot;</span>);
<a name="l02529"></a>02529 <span class="preprocessor">#endif</span>
<a name="l02530"></a>02530 <span class="preprocessor"></span>}
<a name="l02531"></a>02531 
<a name="l02532"></a><a class="code" href="classDenseMatrixSVD.html#aceeae3d1444b957057583bffa39cc434">02532</a> <span class="keywordtype">void</span> <a class="code" href="classDenseMatrixSVD.html#aceeae3d1444b957057583bffa39cc434">DenseMatrixSVD::Eval</a>(<a class="code" href="classDenseMatrix.html" title="Data type dense matrix.">DenseMatrix</a> &amp;M)
<a name="l02533"></a>02533 {
<a name="l02534"></a>02534 <span class="preprocessor">#ifdef MFEM_DEBUG</span>
<a name="l02535"></a>02535 <span class="preprocessor"></span>   <span class="keywordflow">if</span> (M.<a class="code" href="classDenseMatrix.html#aed8c95856eec8c0b9b0d9ddfbdb4922c" title="Returns the height of the matrix.">Height</a>() != <a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a> || M.<a class="code" href="classDenseMatrix.html#ae9a077745804de542fb2acc2b81dfdb2" title="Returns the width of the matrix.">Width</a>() != <a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a>)
<a name="l02536"></a>02536       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixSVD::Eval()&quot;</span>);
<a name="l02537"></a>02537 <span class="preprocessor">#endif</span>
<a name="l02538"></a>02538 <span class="preprocessor"></span>
<a name="l02539"></a>02539 <span class="preprocessor">#ifdef MFEM_USE_LAPACK</span>
<a name="l02540"></a>02540 <span class="preprocessor"></span>   dgesvd_(&amp;<a class="code" href="classDenseMatrixSVD.html#a8b59916d6d9a14cb7940519134b7669a">jobu</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#acb8b57067014b1d535ee7bfc4b7e11d7">jobvt</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a>, M.<a class="code" href="classDenseMatrix.html#a9a993f7c323df43639b941052fe92263" title="Returns vector of the elements.">Data</a>(), &amp;<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>, <a class="code" href="classDenseMatrixSVD.html#ab9f913ae976aa5cc5281ea40092134cf">sv</a>.<a class="code" href="classVector.html#a789ef615634287c103a2fb111de8cab9">GetData</a>(), NULL, &amp;<a class="code" href="classDenseMatrixSVD.html#a05e949539997f236e81043d8206542fb">m</a>,
<a name="l02541"></a>02541            NULL, &amp;<a class="code" href="classDenseMatrixSVD.html#a444e2f021267ed3fcd4201f18ce9ce27">n</a>, <a class="code" href="classDenseMatrixSVD.html#acc774d923ba140441d583c37e371898e">work</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#add0192e0880b875c1c42982a9e2b3786">lwork</a>, &amp;<a class="code" href="classDenseMatrixSVD.html#a8d4958eb24d08b7883b6b52d2c4e6857">info</a>);
<a name="l02542"></a>02542 
<a name="l02543"></a>02543    <span class="keywordflow">if</span> (<a class="code" href="classDenseMatrixSVD.html#a8d4958eb24d08b7883b6b52d2c4e6857">info</a>)
<a name="l02544"></a>02544    {
<a name="l02545"></a>02545       cerr &lt;&lt; <span class="stringliteral">&quot;DenseMatrixSVD::Eval() : info = &quot;</span> &lt;&lt; <a class="code" href="classDenseMatrixSVD.html#a8d4958eb24d08b7883b6b52d2c4e6857">info</a> &lt;&lt; endl;
<a name="l02546"></a>02546       <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>();
<a name="l02547"></a>02547    }
<a name="l02548"></a>02548 <span class="preprocessor">#else</span>
<a name="l02549"></a>02549 <span class="preprocessor"></span>   <a class="code" href="error_8cpp.html#a102dfeb7150cf57c4931f2a91aad7bdd">mfem_error</a>(<span class="stringliteral">&quot;DenseMatrixSVD::Eval(): Compiled without LAPACK&quot;</span>);
<a name="l02550"></a>02550 <span class="preprocessor">#endif</span>
<a name="l02551"></a>02551 <span class="preprocessor"></span>}
<a name="l02552"></a>02552 
<a name="l02553"></a><a class="code" href="classDenseMatrixSVD.html#a05b6a78e53e674a4caa448eb782b1da7">02553</a> <a class="code" href="classDenseMatrixSVD.html#a05b6a78e53e674a4caa448eb782b1da7">DenseMatrixSVD::~DenseMatrixSVD</a>()
<a name="l02554"></a>02554 {
<a name="l02555"></a>02555    <span class="keyword">delete</span> [] <a class="code" href="classDenseMatrixSVD.html#acc774d923ba140441d583c37e371898e">work</a>;
<a name="l02556"></a>02556 }
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Fri Nov 18 2011 12:16:44 for MFEM by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
